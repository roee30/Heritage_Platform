\documentclass[12pt]{article}
\usepackage[latin1]{inputenc}
\usepackage[headings]{fullpage}
\usepackage[noweb]{ocamlweb}
\pagestyle{headings}
\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% This file has been automatically generated with the command
%% ocamlweb --noweb --tex ../DOC/docintro.tex control.ml version.ml date.ml canon.ml transduction.ml encode.ml order.ml padapatha.ml sanskrit.mli sanskrit.ml skt_lexer.ml test_stamp.ml dir.mli dir.ml paths.ml index.ml phonetics.ml int_sandhi.ml skt_morph.mli morphology.mli naming.ml inflected.mli inflected.ml sandhi.ml sandhier.ml pada.ml nouns.mli nouns.ml verbs.mli verbs.ml parts.ml conj_infos.mli morpho_string.ml morpho.ml declension.ml conjugation.ml indexer.ml indexerd.ml phases.ml lemmatizer.ml auto.mli load_transducers.ml dispatcher.mli dispatcher.ml segmenter.ml load_morphs.ml lexer.mli lexer.ml rank.ml scl_parser.ml reader.ml parser.ml constraints.mli constraints.ml multilingual.ml paraphrase.mli paraphrase.ml bank_lexer.ml regression.ml checkpoints.ml graph_segmenter.ml automaton.ml interface.mli interface.ml user_aid.ml reset_caches.ml params.mli params.ml html.ml web.ml css.ml cgi.ml morpho_html.ml chapters.ml morpho_scl.ml mk_index_page.ml mk_grammar_page.ml mk_reader_page.ml mk_sandhi_page.ml mk_corpus_page.ml corpus.mli corpus.ml web_corpus.mli web_corpus.ml corpus_manager.mli corpus_manager.ml corpus_manager_cgi.ml save_corpus_params.mli save_corpus_params.ml save_corpus_cgi.ml mkdir_corpus_params.mli mkdir_corpus_params.ml mkdir_corpus_cgi.ml mk_corpus.ml -o ../DOC/Heritage_Platform.tex 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% WARNING Do not edit manually docintro.tex, mechanically produced by configure from docintro 

\begin{center}
\vspace*{24pt}
{\Large The Sanskrit Platform Documentation}\\[10pt]
{\Large (Sanskrit Library V3.04; Zen toolkit V3.1)}\\[15pt] 
{\large 2018-01-08}\\[15pt]
{\large G\'erard Huet \& Pawan Goyal}\\[10pt]
{\large Copyright \copyright ~2000-2017 Inria}\\[20pt]
\end{center}

% Macros
\def\R{$\rightarrow$} % for Sandhi notation 
\def\Pan#1{{\bf P}\{#1\}}

\begin{abstract}

This document is the commented code of the Sanskrit Engine software package.
The programming language is Pidgin ML, implemented as Objective Caml (V4.02.2),
under the revised syntax offered by the Camlp4 preprocessor.
This documentation has been automatically generated by the Ocamlweb package
of Jean-Christophe Filli\^atre, using the {\LaTeX} package,
in the literate programming style pioneered by Don Knuth. 

This program uses the Zen Computational Linguistics Toolkit. The present
document is a companion volume to its documentation, available as\\
\verb|http://yquem.inria.fr/~huet/ZEN/zen.pdf| under the pdf format.

The Sanskrit Heritage site \verb|http://sanskrit.inria.fr/|
demonstrates various tools built with this package.
An article describing Sanskrit segmentation and tagging based on this package 
is available as 
\verb|http://yquem.inria.fr/~huet/PUBLIC/tagger.pdf| under the pdf format.

\end{abstract}


\typeout{OcamlWeb file Control.ml}
\ocwmodule{Control}
\label{control.ml:0}%
Module Control contains exceptions of global scope 
\ocweol
\label{control.ml:677}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Anomaly}~$\ocwkw{of}~\ocwbt{string}~\ocwbc{} deemed impossible by logic and ML semantics \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Warning}~$\ocwkw{of}~\ocwbt{string}~\ocwbc{} emits a warning \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Fatal}~$\ocwkw{of}~\ocwbt{string}~\ocwbc{} unrecoverable fatal error \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} error reporting \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{report\_mess}~=~$\ocwstring{"\symbol{45}\ocwvspace{}please\ocwvspace{}report\ocwvspace{}\symbol{45}\ocwvspace{}"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fatal\_err\_mess}~=~$\ocwstring{"Fatal\ocwvspace{}error\ocwvspace{}"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{anomaly\_err\_mess}~=~$\ocwstring{"Anomaly\ocwvspace{}"}~\^{}~$\ocwlowerid{report\_mess}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sys\_err\_mess}~=~$\ocwstring{"System\ocwvspace{}error\ocwvspace{}"}~\^{}~$\ocwlowerid{report\_mess}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{stream\_err\_mess}~=~$\ocwstring{"Stream\ocwvspace{}error\ocwvspace{}\symbol{45}\ocwvspace{}wrong\ocwvspace{}input\ocwvspace{}?\ocwvspace{}"}~\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
change if Morphology data type changes 
\ocweol
\label{control.ml:1180}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{data\_format\_version}~=~1$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Version.ml}
\ocwmodule{Version}
\label{version.ml:0}%
Generated by make version - see main Makefile 
\ocweol
\label{version.ml:671}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{version}=$\ocwstring{"3.04"}~\ocwkw{and}~$\ocwlowerid{version\_date}=$\ocwstring{"2018\symbol{45}01\symbol{45}08"};\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Date.ml}
\ocwmodule{Date}
\label{date.ml:0}%
Date utilities 
\ocweol
\label{date.ml:671}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{date\_iso}~=~\ocwupperid{Version.}\ocwlowerid{version\_date}~$\ocwbc{} \ocwstring{"YYYY\symbol{45}MM\symbol{45}DD"} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{version\_id}~=~\ocwupperid{Version.}\ocwlowerid{version}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{version}~=~$\ocwstring{"Version\ocwvspace{}"}~\^{}~$\ocwlowerid{version\_id}~$\^{}~\ocwstring{"\ocwvspace{}["}~\^{}~$\ocwlowerid{date\_iso}~$\^{}~\ocwstring{"]"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{dico\_date}~=~$\ocwbc{} for Sanskrit-French book form \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{year}~=~\ocwupperid{String.}\ocwlowerid{sub}~\ocwlowerid{date\_iso}~0~4$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{month}~=~\ocwupperid{String.}\ocwlowerid{sub}~\ocwlowerid{date\_iso}~5~2~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{day}~=~\ocwupperid{String.}\ocwlowerid{sub}~\ocwlowerid{date\_iso}~8~2~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$($\ocwkw{match}~$\ocwlowerid{int\_of\_string}~\ocwlowerid{day}~$\ocwkw{with}~$[~1~\rightarrow{}~$\ocwstring{"1er"}~$\mid{}~\ocwlowerid{n}~\rightarrow{}~\ocwlowerid{string\_of\_int}~\ocwlowerid{n}~])~$\^{}\ocweol
\ocwindent{1.00em}
$($\ocwkw{match}~$\ocwlowerid{month}~$\ocwkw{with}~$[~$\ocwstring{"01"}~$\rightarrow{}~$\ocwstring{"\ocwvspace{}Janvier\ocwvspace{}"}~\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"02"}~$\rightarrow{}~$\ocwstring{"\ocwvspace{}F\symbol{92}\symbol{92}'evrier\ocwvspace{}"}\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"03"}~$\rightarrow{}~$\ocwstring{"\ocwvspace{}Mars\ocwvspace{}"}\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"04"}~$\rightarrow{}~$\ocwstring{"\ocwvspace{}Avril\ocwvspace{}"}\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"05"}~$\rightarrow{}~$\ocwstring{"\ocwvspace{}Mai\ocwvspace{}"}\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"06"}~$\rightarrow{}~$\ocwstring{"\ocwvspace{}Juin\ocwvspace{}"}\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"07"}~$\rightarrow{}~$\ocwstring{"\ocwvspace{}Juillet\ocwvspace{}"}\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"08"}~$\rightarrow{}~$\ocwstring{"\ocwvspace{}Ao\symbol{92}\symbol{92}\^{}ut\ocwvspace{}"}\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"09"}~$\rightarrow{}~$\ocwstring{"\ocwvspace{}Septembre\ocwvspace{}"}\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"10"}~$\rightarrow{}~$\ocwstring{"\ocwvspace{}Octobre\ocwvspace{}"}\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"11"}~$\rightarrow{}~$\ocwstring{"\ocwvspace{}Novembre\ocwvspace{}"}\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"12"}~$\rightarrow{}~$\ocwstring{"\ocwvspace{}D\symbol{92}\symbol{92}'ecembre\ocwvspace{}"}\ocweol
\ocwindent{10.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Invalid\ocwvspace{}month\ocwvspace{}code\ocwvspace{}in\ocwvspace{}date"}\ocweol
\ocwindent{10.00em}
$])~$\^{}~$\ocwlowerid{year}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Canon.ml}
\ocwmodule{Canon}
\label{canon.ml:0}%
Inverse of \ocwbegindcode{}$\ocwupperid{Transduction}.\ocwlowerid{code\_raw}$\ocwenddcode{} - word to VH transliteration 
\ocweol
\label{canon.ml:720}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{canon}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~0~\rightarrow{}~$\ocwstring{"\symbol{45}"}~\ocwbc{} notation for suffixes and segmentation hint in compounds \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~1~\rightarrow{}~$\ocwstring{"a"}\ocweol
\ocwindent{1.00em}
$\mid{}~2~\rightarrow{}~$\ocwstring{"aa"}\ocweol
\ocwindent{1.00em}
$\mid{}~3~\rightarrow{}~$\ocwstring{"i"}\ocweol
\ocwindent{1.00em}
$\mid{}~4~\rightarrow{}~$\ocwstring{"ii"}\ocweol
\ocwindent{1.00em}
$\mid{}~5~\rightarrow{}~$\ocwstring{"u"}\ocweol
\ocwindent{1.00em}
$\mid{}~6~\rightarrow{}~$\ocwstring{"uu"}\ocweol
\ocwindent{1.00em}
$\mid{}~7~\rightarrow{}~$\ocwstring{".r"}\ocweol
\ocwindent{1.00em}
$\mid{}~8~\rightarrow{}~$\ocwstring{".rr"}\ocweol
\ocwindent{1.00em}
$\mid{}~9~\rightarrow{}~$\ocwstring{".l"}\ocweol
\ocwindent{1.00em}
$\mid{}~10~\rightarrow{}~$\ocwstring{"e"}\ocweol
\ocwindent{1.00em}
$\mid{}~11~\rightarrow{}~$\ocwstring{"ai"}\ocweol
\ocwindent{1.00em}
$\mid{}~12~\rightarrow{}~$\ocwstring{"o"}\ocweol
\ocwindent{1.00em}
$\mid{}~13~\rightarrow{}~$\ocwstring{"au"}\ocweol
\ocwindent{1.00em}
$\mid{}~14~\rightarrow{}~$\ocwstring{".m"}~\ocwbc{} anusvaara \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~15~\rightarrow{}~$\ocwstring{"\~{}\~{}"}~\ocwbc{} anunaasika candrabindu \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~16~\rightarrow{}~$\ocwstring{".h"}\ocweol
\ocwindent{1.00em}
$\mid{}~17~\rightarrow{}~$\ocwstring{"k"}\ocweol
\ocwindent{1.00em}
$\mid{}~18~\rightarrow{}~$\ocwstring{"kh"}\ocweol
\ocwindent{1.00em}
$\mid{}~19~\rightarrow{}~$\ocwstring{"g"}\ocweol
\ocwindent{1.00em}
$\mid{}~20~\rightarrow{}~$\ocwstring{"gh"}\ocweol
\ocwindent{1.00em}
$\mid{}~21~\rightarrow{}~$\ocwstring{"f"}~\ocwbc{} used to be \ocwstring{"\symbol{92}"n"} -- fragile \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~22~\rightarrow{}~$\ocwstring{"c"}\ocweol
\ocwindent{1.00em}
$\mid{}~23~\rightarrow{}~$\ocwstring{"ch"}\ocweol
\ocwindent{1.00em}
$\mid{}~24~\rightarrow{}~$\ocwstring{"j"}\ocweol
\ocwindent{1.00em}
$\mid{}~25~\rightarrow{}~$\ocwstring{"jh"}\ocweol
\ocwindent{1.00em}
$\mid{}~26~\rightarrow{}~$\ocwstring{"\~{}n"}\ocweol
\ocwindent{1.00em}
$\mid{}~27~\rightarrow{}~$\ocwstring{".t"}\ocweol
\ocwindent{1.00em}
$\mid{}~28~\rightarrow{}~$\ocwstring{".th"}\ocweol
\ocwindent{1.00em}
$\mid{}~29~\rightarrow{}~$\ocwstring{".d"}\ocweol
\ocwindent{1.00em}
$\mid{}~30~\rightarrow{}~$\ocwstring{".dh"}\ocweol
\ocwindent{1.00em}
$\mid{}~31~\rightarrow{}~$\ocwstring{".n"}\ocweol
\ocwindent{1.00em}
$\mid{}~32~\rightarrow{}~$\ocwstring{"t"}\ocweol
\ocwindent{1.00em}
$\mid{}~33~\rightarrow{}~$\ocwstring{"th"}\ocweol
\ocwindent{1.00em}
$\mid{}~34~\rightarrow{}~$\ocwstring{"d"}\ocweol
\ocwindent{1.00em}
$\mid{}~35~\rightarrow{}~$\ocwstring{"dh"}\ocweol
\ocwindent{1.00em}
$\mid{}~36~\rightarrow{}~$\ocwstring{"n"}\ocweol
\ocwindent{1.00em}
$\mid{}~37~\rightarrow{}~$\ocwstring{"p"}\ocweol
\ocwindent{1.00em}
$\mid{}~38~\rightarrow{}~$\ocwstring{"ph"}\ocweol
\ocwindent{1.00em}
$\mid{}~39~\rightarrow{}~$\ocwstring{"b"}\ocweol
\ocwindent{1.00em}
$\mid{}~40~\rightarrow{}~$\ocwstring{"bh"}\ocweol
\ocwindent{1.00em}
$\mid{}~41~\rightarrow{}~$\ocwstring{"m"}\ocweol
\ocwindent{1.00em}
$\mid{}~42~\rightarrow{}~$\ocwstring{"y"}\ocweol
\ocwindent{1.00em}
$\mid{}~43~\rightarrow{}~$\ocwstring{"r"}\ocweol
\ocwindent{1.00em}
$\mid{}~44~\rightarrow{}~$\ocwstring{"l"}~\ocwbc{} Vedic l not accommodated \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~45~\rightarrow{}~$\ocwstring{"v"}\ocweol
\ocwindent{1.00em}
$\mid{}~46~\rightarrow{}~$\ocwstring{"z"}~\ocwbc{} used to be \ocwstring{"\symbol{92}"s"} -- fragile \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~47~\rightarrow{}~$\ocwstring{".s"}\ocweol
\ocwindent{1.00em}
$\mid{}~48~\rightarrow{}~$\ocwstring{"s"}\ocweol
\ocwindent{1.00em}
$\mid{}~49~\rightarrow{}~$\ocwstring{"h"}\ocweol
\ocwindent{1.00em}
$\mid{}~50~\rightarrow{}~$\ocwstring{"\_"}~\ocwbc{} hiatus \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-1~\rightarrow{}~$\ocwstring{"'"}~\ocwbc{} avagraha \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-2~\rightarrow{}~$\ocwstring{"[\symbol{45}]"}~\ocwbc{} amuissement - lopa of a or aa in preceding preverb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-3~\rightarrow{}~$\ocwstring{"aa|a"}~\ocwbc{} sandhi of aa and a *a \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-4~\rightarrow{}~$\ocwstring{"aa|i"}~\ocwbc{} sandhi of aa and i *i \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-5~\rightarrow{}~$\ocwstring{"aa|u"}~\ocwbc{} sandhi of aa and u *u \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-6~\rightarrow{}~$\ocwstring{"aa|r"}~\ocwbc{} sandhi of aa and .r *r \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-7~\rightarrow{}~$\ocwstring{"aa|I"}~\ocwbc{} sandhi of aa and ii *I \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-8~\rightarrow{}~$\ocwstring{"aa|U"}~\ocwbc{} sandhi of aa and uu *U \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-9~\rightarrow{}~$\ocwstring{"aa|A"}~\ocwbc{} sandhi of aa and aa *A \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-10~\rightarrow{}~$\ocwstring{"+"}~\ocwbc{} notation for segmentation hint \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~124~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Canon:\ocwvspace{}Unrestored\ocwvspace{}special\ocwvspace{}phoneme\ocwvspace{}j'"}~\ocwbc{} j/z \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~149~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Canon:\ocwvspace{}Unrestored\ocwvspace{}special\ocwvspace{}phoneme\ocwvspace{}h'"}~\ocwbc{} h/gh \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~249~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Canon:\ocwvspace{}Unrestored\ocwvspace{}special\ocwvspace{}phoneme\ocwvspace{}h''"}~\ocwbc{} h/dh \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{n}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{n}<0~\lor{}~\ocwlowerid{n}>59~$\ocwkw{then}~$\ocwlowerid{failwith}~\ocwlowerid{mess}~$\ocweol
\ocwindent{6.00em}
$\ocwlowerid{where}~\ocwlowerid{mess}~=~$\ocwstring{"Canon:\ocwvspace{}Illegal\ocwvspace{}char\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{n}$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~\ocwstring{"\#"}~\^{}~$\ocwupperid{Char.}\ocwlowerid{escaped}~(\ocwupperid{Char.}\ocwlowerid{chr}~(\ocwlowerid{n}-2))~$\ocwbc{} homo index 1 to 9 \ocwec{}\ocweol
\ocwindent{16.50em}
\ocwbc{} n-2 above since (ASCII) Char.chr 48 = '0' \ocwec{}\medskip

\label{canon.ml:2652}%
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Hiatus-conscious catenation \ocwbegindcode{}$\ocwlowerid{b}=\ocwupperid{True}$\ocwenddcode{} iff \ocwbegindcode{}$\ocwlowerid{s}$\ocwenddcode{} starts with vowel \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{catenate}~\ocwlowerid{c}~(\ocwlowerid{s},\ocwlowerid{b})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{b'}=~\ocwlowerid{c}>0~\land{}~\ocwlowerid{c}<14~$\ocwbc{} Phonetics.vowel c \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{protected}~=~$\ocwkw{if}~$\ocwlowerid{b}~\land{}~\ocwlowerid{b'}~$\ocwkw{then}~\ocwstring{"\_"}~\^{}~$\ocwlowerid{s}~$\ocwkw{else}~$\ocwlowerid{s}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$(\ocwlowerid{canon}~\ocwlowerid{c}~$\^{}~$\ocwlowerid{protected}~,~\ocwlowerid{b'})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{decode}~:~\ocwlowerid{word}~\rightarrow{}~$\ocwbt{string}\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{decode}~\ocwlowerid{word}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{s},\ocwlowerid{\_})~=~\ocwupperid{List.}\ocwlowerid{fold\_right}~\ocwlowerid{catenate}~\ocwlowerid{word}~($\ocwstring{""},$\ocwupperid{False})~$\ocwkw{in}~$\ocwlowerid{s}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{robust\_decode}~\ocwlowerid{c}~=~$\ocwbc{} used in \ocwbegindcode{}$\ocwupperid{Morpho\_tex}.\ocwlowerid{print\_inverse\_map\_txt}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{render}~\ocwlowerid{n}~=~$\ocweol
\ocwindent{2.00em}
\ocwkw{try}~$\ocwlowerid{canon}~\ocwlowerid{n}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Failure}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{n}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~124~\rightarrow{}~$\ocwstring{"j'"}~$\mid{}~149~\rightarrow{}~$\ocwstring{"h'"}~$\mid{}~249~\rightarrow{}~$\ocwstring{"h''"}\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{string\_of\_int}~\ocwlowerid{n}~$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conc}~\ocwlowerid{s}~\ocwlowerid{s'}~=~\ocwlowerid{render}~\ocwlowerid{s}~$\^{}~$\ocwlowerid{s'}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{fold\_right}~\ocwlowerid{conc}~\ocwlowerid{c}~$\ocwstring{""}~\ocwbc{} note no hiatus computation \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rdecode}~\ocwlowerid{w}~=~\ocwlowerid{decode}~(\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{w})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{}************************************************************************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Important information for corpus processing                            \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}************************************************************************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Beware. \ocwbegindcode{}$\ocwlowerid{decode}~(\ocwlowerid{code\_raw}~\ocwlowerid{s})$\ocwenddcode{} is \ocwbegindcode{}$\ocwlowerid{s}$\ocwenddcode{} with spaces removed 
   but \ocwbegindcode{}$\ocwlowerid{code\_raw}~(\ocwlowerid{decode}~\ocwlowerid{c})$\ocwenddcode{} may not be \ocwbegindcode{}$\ocwlowerid{c}$\ocwenddcode{} because of VH ambiguities such as 
      \ocwbegindcode{}$\ocwlowerid{decode}~[1;3]~=~\ocwlowerid{decode}~[11]~=~$\ocwstring{"ai"}\ocwenddcode{}.
   Note that unsandhied text with spaces is wrongly parsed:
      \ocwbegindcode{}$\ocwlowerid{code\_raw}~$\ocwstring{"a\ocwvspace{}i"}~=~[11]\ocwenddcode{} and not \ocwbegindcode{}[1;~50;~3]\ocwenddcode{}. 
   Thus one should use underscore for hiatus in digitalised corpus: 
      \ocwbegindcode{}$\ocwlowerid{code\_raw}~$\ocwstring{"a\_i"}~=~[1;~3]\ocwenddcode{}. The chunking of text by interpreting spaces 
   is done in a preliminary pass by Sanskrit.padapatha. \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Support for other translitteration schemes 
\ocweol
\ocwindent{0.00em}
Wax decoding - University of Hyderabad 
\ocweol
\label{canon.ml:4346}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{canon\_WX}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~0~\rightarrow{}~$\ocwstring{"\symbol{45}"}\ocweol
\ocwindent{1.00em}
$\mid{}~1~\rightarrow{}~$\ocwstring{"a"}\ocweol
\ocwindent{1.00em}
$\mid{}~2~\rightarrow{}~$\ocwstring{"A"}\ocweol
\ocwindent{1.00em}
$\mid{}~3~\rightarrow{}~$\ocwstring{"i"}\ocweol
\ocwindent{1.00em}
$\mid{}~4~\rightarrow{}~$\ocwstring{"I"}\ocweol
\ocwindent{1.00em}
$\mid{}~5~\rightarrow{}~$\ocwstring{"u"}\ocweol
\ocwindent{1.00em}
$\mid{}~6~\rightarrow{}~$\ocwstring{"U"}\ocweol
\ocwindent{1.00em}
$\mid{}~7~\rightarrow{}~$\ocwstring{"q"}\ocweol
\ocwindent{1.00em}
$\mid{}~8~\rightarrow{}~$\ocwstring{"Q"}\ocweol
\ocwindent{1.00em}
$\mid{}~9~\rightarrow{}~$\ocwstring{"L"}\ocweol
\ocwindent{1.00em}
$\mid{}~10~\rightarrow{}~$\ocwstring{"e"}\ocweol
\ocwindent{1.00em}
$\mid{}~11~\rightarrow{}~$\ocwstring{"E"}\ocweol
\ocwindent{1.00em}
$\mid{}~12~\rightarrow{}~$\ocwstring{"o"}\ocweol
\ocwindent{1.00em}
$\mid{}~13~\rightarrow{}~$\ocwstring{"O"}\ocweol
\ocwindent{1.00em}
$\mid{}~14~\rightarrow{}~$\ocwstring{"M"}\ocweol
\ocwindent{1.00em}
$\mid{}~15~\rightarrow{}~$\ocwstring{"z"}\ocweol
\ocwindent{1.00em}
$\mid{}~16~\rightarrow{}~$\ocwstring{"H"}\ocweol
\ocwindent{1.00em}
$\mid{}~17~\rightarrow{}~$\ocwstring{"k"}\ocweol
\ocwindent{1.00em}
$\mid{}~18~\rightarrow{}~$\ocwstring{"K"}\ocweol
\ocwindent{1.00em}
$\mid{}~19~\rightarrow{}~$\ocwstring{"g"}\ocweol
\ocwindent{1.00em}
$\mid{}~20~\rightarrow{}~$\ocwstring{"G"}\ocweol
\ocwindent{1.00em}
$\mid{}~21~\rightarrow{}~$\ocwstring{"f"}\ocweol
\ocwindent{1.00em}
$\mid{}~22~\rightarrow{}~$\ocwstring{"c"}\ocweol
\ocwindent{1.00em}
$\mid{}~23~\rightarrow{}~$\ocwstring{"C"}\ocweol
\ocwindent{1.00em}
$\mid{}~24~\rightarrow{}~$\ocwstring{"j"}\ocweol
\ocwindent{1.00em}
$\mid{}~25~\rightarrow{}~$\ocwstring{"J"}\ocweol
\ocwindent{1.00em}
$\mid{}~26~\rightarrow{}~$\ocwstring{"F"}\ocweol
\ocwindent{1.00em}
$\mid{}~27~\rightarrow{}~$\ocwstring{"t"}\ocweol
\ocwindent{1.00em}
$\mid{}~28~\rightarrow{}~$\ocwstring{"T"}\ocweol
\ocwindent{1.00em}
$\mid{}~29~\rightarrow{}~$\ocwstring{"d"}\ocweol
\ocwindent{1.00em}
$\mid{}~30~\rightarrow{}~$\ocwstring{"D"}\ocweol
\ocwindent{1.00em}
$\mid{}~31~\rightarrow{}~$\ocwstring{"N"}\ocweol
\ocwindent{1.00em}
$\mid{}~32~\rightarrow{}~$\ocwstring{"w"}\ocweol
\ocwindent{1.00em}
$\mid{}~33~\rightarrow{}~$\ocwstring{"W"}\ocweol
\ocwindent{1.00em}
$\mid{}~34~\rightarrow{}~$\ocwstring{"x"}\ocweol
\ocwindent{1.00em}
$\mid{}~35~\rightarrow{}~$\ocwstring{"X"}\ocweol
\ocwindent{1.00em}
$\mid{}~36~\rightarrow{}~$\ocwstring{"n"}\ocweol
\ocwindent{1.00em}
$\mid{}~37~\rightarrow{}~$\ocwstring{"p"}\ocweol
\ocwindent{1.00em}
$\mid{}~38~\rightarrow{}~$\ocwstring{"P"}\ocweol
\ocwindent{1.00em}
$\mid{}~39~\rightarrow{}~$\ocwstring{"b"}\ocweol
\ocwindent{1.00em}
$\mid{}~40~\rightarrow{}~$\ocwstring{"B"}\ocweol
\ocwindent{1.00em}
$\mid{}~41~\rightarrow{}~$\ocwstring{"m"}\ocweol
\ocwindent{1.00em}
$\mid{}~42~\rightarrow{}~$\ocwstring{"y"}\ocweol
\ocwindent{1.00em}
$\mid{}~43~\rightarrow{}~$\ocwstring{"r"}\ocweol
\ocwindent{1.00em}
$\mid{}~44~\rightarrow{}~$\ocwstring{"l"}~\ocwbc{} Vedic l not accommodated \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~45~\rightarrow{}~$\ocwstring{"v"}\ocweol
\ocwindent{1.00em}
$\mid{}~46~\rightarrow{}~$\ocwstring{"S"}\ocweol
\ocwindent{1.00em}
$\mid{}~47~\rightarrow{}~$\ocwstring{"R"}\ocweol
\ocwindent{1.00em}
$\mid{}~48~\rightarrow{}~$\ocwstring{"s"}\ocweol
\ocwindent{1.00em}
$\mid{}~49~\rightarrow{}~$\ocwstring{"h"}\ocweol
\ocwindent{1.00em}
$\mid{}~50~\rightarrow{}~$\ocwstring{"\_"}~\ocwbc{} hiatus \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-1~\rightarrow{}~$\ocwstring{"Z"}~\ocwbc{} avagraha \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-2~\rightarrow{}~$\ocwstring{"[\symbol{45}]"}~\ocwbc{} amuissement - lopa of current aa- or preceding a- or aa- \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-3~\rightarrow{}~$\ocwstring{"A|a"}~\ocwbc{} sandhi of aa and (a,aa) *a \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-4~\rightarrow{}~$\ocwstring{"A|i"}~\ocwbc{} sandhi of aa and (i,ii) *e \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-5~\rightarrow{}~$\ocwstring{"A|u"}~\ocwbc{} sandhi of aa and (u,uu) *u \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-6~\rightarrow{}~$\ocwstring{"A|r"}~\ocwbc{} sandhi of aa and .r     *r \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-10~\rightarrow{}~$\ocwstring{"+"}~\ocwbc{} explicit compound with no sandhi - experimental \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{n}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{n}<0~\lor{}~\ocwlowerid{n}>59~$\ocwkw{then}~$\ocwlowerid{failwith}~\ocwlowerid{mess}$\ocweol
\ocwindent{6.00em}
$\ocwlowerid{where}~\ocwlowerid{mess}~=~$\ocwstring{"Canon:\ocwvspace{}Illegal\ocwvspace{}char\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{n}$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~\ocwstring{"\#"}~\^{}~$\ocwupperid{Char.}\ocwlowerid{escaped}~(\ocwupperid{Char.}\ocwlowerid{chr}~(\ocwlowerid{n}-2))~$\ocwbc{} homo index 1 to 9 \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{decode\_WX}~\ocwlowerid{word}~=$\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{fold\_right}~($\ocwkw{fun}~$\ocwlowerid{c}~\ocwlowerid{s}~\rightarrow{}~(\ocwlowerid{canon\_WX}~\ocwlowerid{c})~$\^{}~$\ocwlowerid{s})~\ocwlowerid{word}~$\ocwstring{""}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Sanskrit Library SLP1 decoding \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{canon\_SL}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~0~\rightarrow{}~$\ocwstring{"\symbol{45}"}\ocweol
\ocwindent{1.00em}
$\mid{}~-10~\rightarrow{}~$\ocwstring{"+"}\ocweol
\ocwindent{1.00em}
$\mid{}~1~\rightarrow{}~$\ocwstring{"a"}\ocweol
\ocwindent{1.00em}
$\mid{}~2~\rightarrow{}~$\ocwstring{"A"}\ocweol
\ocwindent{1.00em}
$\mid{}~3~\rightarrow{}~$\ocwstring{"i"}\ocweol
\ocwindent{1.00em}
$\mid{}~4~\rightarrow{}~$\ocwstring{"I"}\ocweol
\ocwindent{1.00em}
$\mid{}~5~\rightarrow{}~$\ocwstring{"u"}\ocweol
\ocwindent{1.00em}
$\mid{}~6~\rightarrow{}~$\ocwstring{"U"}\ocweol
\ocwindent{1.00em}
$\mid{}~7~\rightarrow{}~$\ocwstring{"f"}\ocweol
\ocwindent{1.00em}
$\mid{}~8~\rightarrow{}~$\ocwstring{"F"}\ocweol
\ocwindent{1.00em}
$\mid{}~9~\rightarrow{}~$\ocwstring{"x"}\ocweol
\ocwindent{1.00em}
$\mid{}~10~\rightarrow{}~$\ocwstring{"e"}\ocweol
\ocwindent{1.00em}
$\mid{}~11~\rightarrow{}~$\ocwstring{"E"}\ocweol
\ocwindent{1.00em}
$\mid{}~12~\rightarrow{}~$\ocwstring{"o"}\ocweol
\ocwindent{1.00em}
$\mid{}~13~\rightarrow{}~$\ocwstring{"O"}\ocweol
\ocwindent{1.00em}
$\mid{}~14~\rightarrow{}~$\ocwstring{"M"}\ocweol
\ocwindent{1.00em}
$\mid{}~15~\rightarrow{}~$\ocwstring{"\~{}"}\ocweol
\ocwindent{1.00em}
$\mid{}~16~\rightarrow{}~$\ocwstring{"H"}\ocweol
\ocwindent{1.00em}
$\mid{}~17~\rightarrow{}~$\ocwstring{"k"}\ocweol
\ocwindent{1.00em}
$\mid{}~18~\rightarrow{}~$\ocwstring{"K"}\ocweol
\ocwindent{1.00em}
$\mid{}~19~\rightarrow{}~$\ocwstring{"g"}\ocweol
\ocwindent{1.00em}
$\mid{}~20~\rightarrow{}~$\ocwstring{"G"}\ocweol
\ocwindent{1.00em}
$\mid{}~21~\rightarrow{}~$\ocwstring{"N"}\ocweol
\ocwindent{1.00em}
$\mid{}~22~\rightarrow{}~$\ocwstring{"c"}\ocweol
\ocwindent{1.00em}
$\mid{}~23~\rightarrow{}~$\ocwstring{"C"}\ocweol
\ocwindent{1.00em}
$\mid{}~24~\rightarrow{}~$\ocwstring{"j"}\ocweol
\ocwindent{1.00em}
$\mid{}~25~\rightarrow{}~$\ocwstring{"J"}\ocweol
\ocwindent{1.00em}
$\mid{}~26~\rightarrow{}~$\ocwstring{"Y"}\ocweol
\ocwindent{1.00em}
$\mid{}~27~\rightarrow{}~$\ocwstring{"w"}\ocweol
\ocwindent{1.00em}
$\mid{}~28~\rightarrow{}~$\ocwstring{"W"}\ocweol
\ocwindent{1.00em}
$\mid{}~29~\rightarrow{}~$\ocwstring{"q"}\ocweol
\ocwindent{1.00em}
$\mid{}~30~\rightarrow{}~$\ocwstring{"Q"}\ocweol
\ocwindent{1.00em}
$\mid{}~31~\rightarrow{}~$\ocwstring{"R"}\ocweol
\ocwindent{1.00em}
$\mid{}~32~\rightarrow{}~$\ocwstring{"t"}\ocweol
\ocwindent{1.00em}
$\mid{}~33~\rightarrow{}~$\ocwstring{"T"}\ocweol
\ocwindent{1.00em}
$\mid{}~34~\rightarrow{}~$\ocwstring{"d"}\ocweol
\ocwindent{1.00em}
$\mid{}~35~\rightarrow{}~$\ocwstring{"D"}\ocweol
\ocwindent{1.00em}
$\mid{}~36~\rightarrow{}~$\ocwstring{"n"}\ocweol
\ocwindent{1.00em}
$\mid{}~37~\rightarrow{}~$\ocwstring{"p"}\ocweol
\ocwindent{1.00em}
$\mid{}~38~\rightarrow{}~$\ocwstring{"P"}\ocweol
\ocwindent{1.00em}
$\mid{}~39~\rightarrow{}~$\ocwstring{"b"}\ocweol
\ocwindent{1.00em}
$\mid{}~40~\rightarrow{}~$\ocwstring{"B"}\ocweol
\ocwindent{1.00em}
$\mid{}~41~\rightarrow{}~$\ocwstring{"m"}\ocweol
\ocwindent{1.00em}
$\mid{}~42~\rightarrow{}~$\ocwstring{"y"}\ocweol
\ocwindent{1.00em}
$\mid{}~43~\rightarrow{}~$\ocwstring{"r"}\ocweol
\ocwindent{1.00em}
$\mid{}~44~\rightarrow{}~$\ocwstring{"l"}~\ocwbc{} Vedic l not accommodated \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~45~\rightarrow{}~$\ocwstring{"v"}\ocweol
\ocwindent{1.00em}
$\mid{}~46~\rightarrow{}~$\ocwstring{"S"}\ocweol
\ocwindent{1.00em}
$\mid{}~47~\rightarrow{}~$\ocwstring{"z"}\ocweol
\ocwindent{1.00em}
$\mid{}~48~\rightarrow{}~$\ocwstring{"s"}\ocweol
\ocwindent{1.00em}
$\mid{}~49~\rightarrow{}~$\ocwstring{"h"}\ocweol
\ocwindent{1.00em}
$\mid{}~50~\rightarrow{}~$\ocwstring{"\_"}~\ocwbc{} hiatus \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-1~\rightarrow{}~$\ocwstring{"Z"}~\ocwbc{} avagraha \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{n}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{n}<0~\lor{}~\ocwlowerid{n}>59~$\ocwkw{then}~$\ocwlowerid{failwith}~\ocwlowerid{mess}$\ocweol
\ocwindent{6.00em}
$\ocwlowerid{where}~\ocwlowerid{mess}~=~$\ocwstring{"Canon:\ocwvspace{}Illegal\ocwvspace{}char\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{n}$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~\ocwstring{"\#"}~\^{}~$\ocwupperid{Char.}\ocwlowerid{escaped}~(\ocwupperid{Char.}\ocwlowerid{chr}~(\ocwlowerid{n}-2))~$\ocwbc{} homo index 1 to 9 \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{decode\_SL}~\ocwlowerid{word}~=$\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{fold\_right}~($\ocwkw{fun}~$\ocwlowerid{c}~\ocwlowerid{s}~\rightarrow{}~(\ocwlowerid{canon\_SL}~\ocwlowerid{c})~$\^{}~$\ocwlowerid{s})~\ocwlowerid{word}~$\ocwstring{""}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Kyoto-Harvard decoding \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{canon\_KH}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~0~\rightarrow{}~$\ocwstring{"\symbol{45}"}\ocweol
\ocwindent{1.00em}
$\mid{}~-10~\rightarrow{}~$\ocwstring{"+"}\ocweol
\ocwindent{1.00em}
$\mid{}~1~\rightarrow{}~$\ocwstring{"a"}\ocweol
\ocwindent{1.00em}
$\mid{}~2~\rightarrow{}~$\ocwstring{"A"}\ocweol
\ocwindent{1.00em}
$\mid{}~3~\rightarrow{}~$\ocwstring{"i"}\ocweol
\ocwindent{1.00em}
$\mid{}~4~\rightarrow{}~$\ocwstring{"I"}\ocweol
\ocwindent{1.00em}
$\mid{}~5~\rightarrow{}~$\ocwstring{"u"}\ocweol
\ocwindent{1.00em}
$\mid{}~6~\rightarrow{}~$\ocwstring{"U"}\ocweol
\ocwindent{1.00em}
$\mid{}~7~\rightarrow{}~$\ocwstring{"R"}\ocweol
\ocwindent{1.00em}
$\mid{}~8~\rightarrow{}~$\ocwstring{"RR"}\ocweol
\ocwindent{1.00em}
$\mid{}~9~\rightarrow{}~$\ocwstring{"L"}\ocweol
\ocwindent{1.00em}
$\mid{}~10~\rightarrow{}~$\ocwstring{"e"}\ocweol
\ocwindent{1.00em}
$\mid{}~11~\rightarrow{}~$\ocwstring{"ai"}\ocweol
\ocwindent{1.00em}
$\mid{}~12~\rightarrow{}~$\ocwstring{"o"}\ocweol
\ocwindent{1.00em}
$\mid{}~13~\rightarrow{}~$\ocwstring{"au"}\ocweol
\ocwindent{1.00em}
$\mid{}~14~\rightarrow{}~$\ocwstring{"M"}\ocweol
\ocwindent{1.00em}
$\mid{}~15~\rightarrow{}~$\ocwstring{"M"}~\ocwbc{} candrabindu absent \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~16~\rightarrow{}~$\ocwstring{"H"}\ocweol
\ocwindent{1.00em}
$\mid{}~17~\rightarrow{}~$\ocwstring{"k"}\ocweol
\ocwindent{1.00em}
$\mid{}~18~\rightarrow{}~$\ocwstring{"kh"}\ocweol
\ocwindent{1.00em}
$\mid{}~19~\rightarrow{}~$\ocwstring{"g"}\ocweol
\ocwindent{1.00em}
$\mid{}~20~\rightarrow{}~$\ocwstring{"gh"}\ocweol
\ocwindent{1.00em}
$\mid{}~21~\rightarrow{}~$\ocwstring{"G"}\ocweol
\ocwindent{1.00em}
$\mid{}~22~\rightarrow{}~$\ocwstring{"c"}\ocweol
\ocwindent{1.00em}
$\mid{}~23~\rightarrow{}~$\ocwstring{"ch"}\ocweol
\ocwindent{1.00em}
$\mid{}~24~\rightarrow{}~$\ocwstring{"j"}\ocweol
\ocwindent{1.00em}
$\mid{}~25~\rightarrow{}~$\ocwstring{"jh"}\ocweol
\ocwindent{1.00em}
$\mid{}~26~\rightarrow{}~$\ocwstring{"J"}\ocweol
\ocwindent{1.00em}
$\mid{}~27~\rightarrow{}~$\ocwstring{".t"}\ocweol
\ocwindent{1.00em}
$\mid{}~28~\rightarrow{}~$\ocwstring{".th"}\ocweol
\ocwindent{1.00em}
$\mid{}~29~\rightarrow{}~$\ocwstring{".d"}\ocweol
\ocwindent{1.00em}
$\mid{}~30~\rightarrow{}~$\ocwstring{".dh"}\ocweol
\ocwindent{1.00em}
$\mid{}~31~\rightarrow{}~$\ocwstring{".n"}\ocweol
\ocwindent{1.00em}
$\mid{}~32~\rightarrow{}~$\ocwstring{"t"}\ocweol
\ocwindent{1.00em}
$\mid{}~33~\rightarrow{}~$\ocwstring{"th"}\ocweol
\ocwindent{1.00em}
$\mid{}~34~\rightarrow{}~$\ocwstring{"d"}\ocweol
\ocwindent{1.00em}
$\mid{}~35~\rightarrow{}~$\ocwstring{"dh"}\ocweol
\ocwindent{1.00em}
$\mid{}~36~\rightarrow{}~$\ocwstring{"n"}\ocweol
\ocwindent{1.00em}
$\mid{}~37~\rightarrow{}~$\ocwstring{"p"}\ocweol
\ocwindent{1.00em}
$\mid{}~38~\rightarrow{}~$\ocwstring{"ph"}\ocweol
\ocwindent{1.00em}
$\mid{}~39~\rightarrow{}~$\ocwstring{"b"}\ocweol
\ocwindent{1.00em}
$\mid{}~40~\rightarrow{}~$\ocwstring{"bh"}\ocweol
\ocwindent{1.00em}
$\mid{}~41~\rightarrow{}~$\ocwstring{"m"}\ocweol
\ocwindent{1.00em}
$\mid{}~42~\rightarrow{}~$\ocwstring{"y"}\ocweol
\ocwindent{1.00em}
$\mid{}~43~\rightarrow{}~$\ocwstring{"r"}\ocweol
\ocwindent{1.00em}
$\mid{}~44~\rightarrow{}~$\ocwstring{"l"}~\ocwbc{} Vedic l not accommodated \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~45~\rightarrow{}~$\ocwstring{"v"}\ocweol
\ocwindent{1.00em}
$\mid{}~46~\rightarrow{}~$\ocwstring{"z"}\ocweol
\ocwindent{1.00em}
$\mid{}~47~\rightarrow{}~$\ocwstring{"S"}\ocweol
\ocwindent{1.00em}
$\mid{}~48~\rightarrow{}~$\ocwstring{"s"}\ocweol
\ocwindent{1.00em}
$\mid{}~49~\rightarrow{}~$\ocwstring{"h"}\ocweol
\ocwindent{1.00em}
$\mid{}~50~\rightarrow{}~$\ocwstring{"\_"}~\ocwbc{} hiatus \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-1~\rightarrow{}~$\ocwstring{"'"}~\ocwbc{} avagraha \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{n}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{n}<0~\lor{}~\ocwlowerid{n}>59~$\ocwkw{then}~$\ocwlowerid{failwith}~\ocwlowerid{mess}$\ocweol
\ocwindent{6.00em}
$\ocwlowerid{where}~\ocwlowerid{mess}~=~$\ocwstring{"Canon:\ocwvspace{}Illegal\ocwvspace{}char\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{n}$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~\ocwstring{"\#"}~\^{}~$\ocwupperid{Char.}\ocwlowerid{escaped}~(\ocwupperid{Char.}\ocwlowerid{chr}~(\ocwlowerid{n}-2))~$\ocwbc{} homo index 1 to 9 \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{decode\_KH}~\ocwlowerid{word}~=$\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{fold\_right}~($\ocwkw{fun}~$\ocwlowerid{c}~\ocwlowerid{s}~\rightarrow{}~(\ocwlowerid{canon\_KH}~\ocwlowerid{c})~$\^{}~$\ocwlowerid{s})~\ocwlowerid{word}~$\ocwstring{""}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{switch\_decode}~=~$\ocwkw{fun}~\ocwbc{} normalizes anusvaara in its input \ocwec{}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"VH"}~$\rightarrow{}~\ocwlowerid{decode}~$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"WX"}~$\rightarrow{}~\ocwlowerid{decode\_WX}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"KH"}~$\rightarrow{}~\ocwlowerid{decode\_KH}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"SL"}~$\rightarrow{}~\ocwlowerid{decode\_SL}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unexpected\ocwvspace{}transliteration\ocwvspace{}scheme"}\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Decoding without double quotes \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{canon2}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~0~\rightarrow{}~$\ocwstring{"\symbol{45}"}\ocweol
\ocwindent{1.00em}
$\mid{}~-10~\rightarrow{}~$\ocwstring{"+"}\ocweol
\ocwindent{1.00em}
$\mid{}~1~\rightarrow{}~$\ocwstring{"a"}\ocweol
\ocwindent{1.00em}
$\mid{}~2~\rightarrow{}~$\ocwstring{"A"}\ocweol
\ocwindent{1.00em}
$\mid{}~3~\rightarrow{}~$\ocwstring{"i"}\ocweol
\ocwindent{1.00em}
$\mid{}~4~\rightarrow{}~$\ocwstring{"I"}\ocweol
\ocwindent{1.00em}
$\mid{}~5~\rightarrow{}~$\ocwstring{"u"}\ocweol
\ocwindent{1.00em}
$\mid{}~6~\rightarrow{}~$\ocwstring{"U"}\ocweol
\ocwindent{1.00em}
$\mid{}~7~\rightarrow{}~$\ocwstring{".r"}\ocweol
\ocwindent{1.00em}
$\mid{}~8~\rightarrow{}~$\ocwstring{".R"}\ocweol
\ocwindent{1.00em}
$\mid{}~9~\rightarrow{}~$\ocwstring{".l"}\ocweol
\ocwindent{1.00em}
$\mid{}~10~\rightarrow{}~$\ocwstring{"e"}\ocweol
\ocwindent{1.00em}
$\mid{}~11~\rightarrow{}~$\ocwstring{"E"}\ocweol
\ocwindent{1.00em}
$\mid{}~12~\rightarrow{}~$\ocwstring{"o"}\ocweol
\ocwindent{1.00em}
$\mid{}~13~\rightarrow{}~$\ocwstring{"O"}\ocweol
\ocwindent{1.00em}
$\mid{}~14~\rightarrow{}~$\ocwstring{".m"}\ocweol
\ocwindent{1.00em}
$\mid{}~15~\rightarrow{}~$\ocwstring{"M"}~\ocweol
\ocwindent{1.00em}
$\mid{}~16~\rightarrow{}~$\ocwstring{".h"}\ocweol
\ocwindent{1.00em}
$\mid{}~17~\rightarrow{}~$\ocwstring{"k"}\ocweol
\ocwindent{1.00em}
$\mid{}~18~\rightarrow{}~$\ocwstring{"K"}\ocweol
\ocwindent{1.00em}
$\mid{}~19~\rightarrow{}~$\ocwstring{"g"}\ocweol
\ocwindent{1.00em}
$\mid{}~20~\rightarrow{}~$\ocwstring{"G"}\ocweol
\ocwindent{1.00em}
$\mid{}~21~\rightarrow{}~$\ocwstring{"N"}\ocweol
\ocwindent{1.00em}
$\mid{}~22~\rightarrow{}~$\ocwstring{"c"}\ocweol
\ocwindent{1.00em}
$\mid{}~23~\rightarrow{}~$\ocwstring{"C"}\ocweol
\ocwindent{1.00em}
$\mid{}~24~\rightarrow{}~$\ocwstring{"j"}\ocweol
\ocwindent{1.00em}
$\mid{}~25~\rightarrow{}~$\ocwstring{"J"}\ocweol
\ocwindent{1.00em}
$\mid{}~26~\rightarrow{}~$\ocwstring{"\~{}n"}\ocweol
\ocwindent{1.00em}
$\mid{}~27~\rightarrow{}~$\ocwstring{".t"}\ocweol
\ocwindent{1.00em}
$\mid{}~28~\rightarrow{}~$\ocwstring{".T"}\ocweol
\ocwindent{1.00em}
$\mid{}~29~\rightarrow{}~$\ocwstring{".d"}\ocweol
\ocwindent{1.00em}
$\mid{}~30~\rightarrow{}~$\ocwstring{".D"}\ocweol
\ocwindent{1.00em}
$\mid{}~31~\rightarrow{}~$\ocwstring{".n"}\ocweol
\ocwindent{1.00em}
$\mid{}~32~\rightarrow{}~$\ocwstring{"t"}\ocweol
\ocwindent{1.00em}
$\mid{}~33~\rightarrow{}~$\ocwstring{"T"}\ocweol
\ocwindent{1.00em}
$\mid{}~34~\rightarrow{}~$\ocwstring{"d"}\ocweol
\ocwindent{1.00em}
$\mid{}~35~\rightarrow{}~$\ocwstring{"D"}\ocweol
\ocwindent{1.00em}
$\mid{}~36~\rightarrow{}~$\ocwstring{"n"}\ocweol
\ocwindent{1.00em}
$\mid{}~37~\rightarrow{}~$\ocwstring{"p"}\ocweol
\ocwindent{1.00em}
$\mid{}~38~\rightarrow{}~$\ocwstring{"P"}\ocweol
\ocwindent{1.00em}
$\mid{}~39~\rightarrow{}~$\ocwstring{"b"}\ocweol
\ocwindent{1.00em}
$\mid{}~40~\rightarrow{}~$\ocwstring{"B"}\ocweol
\ocwindent{1.00em}
$\mid{}~41~\rightarrow{}~$\ocwstring{"m"}\ocweol
\ocwindent{1.00em}
$\mid{}~42~\rightarrow{}~$\ocwstring{"y"}\ocweol
\ocwindent{1.00em}
$\mid{}~43~\rightarrow{}~$\ocwstring{"r"}\ocweol
\ocwindent{1.00em}
$\mid{}~44~\rightarrow{}~$\ocwstring{"l"}\ocweol
\ocwindent{1.00em}
$\mid{}~45~\rightarrow{}~$\ocwstring{"v"}\ocweol
\ocwindent{1.00em}
$\mid{}~46~\rightarrow{}~$\ocwstring{"z"}\ocweol
\ocwindent{1.00em}
$\mid{}~47~\rightarrow{}~$\ocwstring{".s"}\ocweol
\ocwindent{1.00em}
$\mid{}~48~\rightarrow{}~$\ocwstring{"s"}\ocweol
\ocwindent{1.00em}
$\mid{}~49~\rightarrow{}~$\ocwstring{"h"}\ocweol
\ocwindent{1.00em}
$\mid{}~50~\rightarrow{}~$\ocwstring{"\_"}~\ocwbc{} hiatus \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-1~\rightarrow{}~$\ocwstring{"'"}\ocweol
\ocwindent{1.00em}
$\mid{}~-2~\rightarrow{}~$\ocwstring{"[\symbol{45}]"}~\ocwbc{} Inconsistent with previous versions \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-3~\rightarrow{}~$\ocwstring{"A|a"}~\ocwbc{} sandhi of A and (a,A) - phantom phoneme \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-4~\rightarrow{}~$\ocwstring{"A|i"}~\ocwbc{} sandhi of A and (i,I) - phantom phoneme \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~-5~\rightarrow{}~$\ocwstring{"A|u"}~\ocwbc{} sandhi of A and (u,U) - phantom phoneme \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-6~\rightarrow{}~$\ocwstring{"A|.r"}~\ocwbc{} sandhi of A and .r) - phantom phoneme \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{n}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{n}<0~\lor{}~\ocwlowerid{n}>59~$\ocwkw{then}~$\ocwlowerid{failwith}~($\ocwstring{"canon2:\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{n})$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~$($\ocwstring{"\#"}~\^{}~$\ocwupperid{Char.}\ocwlowerid{escaped}~(\ocwupperid{Char.}\ocwlowerid{chr}~(\ocwlowerid{n}-2)))$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} hiatus-conscious catenation \ocwbegindcode{}$\ocwlowerid{b}=\ocwupperid{True}$\ocwenddcode{} iff \ocwbegindcode{}$\ocwlowerid{s}$\ocwenddcode{} starts with vowel \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{catenate2}~\ocwlowerid{c}~(\ocwlowerid{s},\ocwlowerid{b})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{b'}=~\ocwlowerid{c}>0~\land{}~\ocwlowerid{c}<14~$\ocwbc{} Phonetics.vowel c \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{protected}~=~$\ocwkw{if}~$\ocwlowerid{b}~\land{}~\ocwlowerid{b'}~$\ocwkw{then}~\ocwstring{"\_"}~\^{}~$\ocwlowerid{s}~$\ocwkw{else}~$\ocwlowerid{s}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$(\ocwlowerid{canon2}~\ocwlowerid{c}~$\^{}~$\ocwlowerid{protected}~,~\ocwlowerid{b'})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{decode2}~:~\ocwlowerid{word}~\rightarrow{}~$\ocwbt{string}\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{decode2}~\ocwlowerid{word}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~\ocwkw{let}~$(\ocwlowerid{s},\ocwlowerid{\_})~=~\ocwupperid{List.}\ocwlowerid{fold\_right}~\ocwlowerid{catenate2}~\ocwlowerid{word}~($\ocwstring{""},$\ocwupperid{False})~$\ocwkw{in}~$\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwupperid{Failure}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"decode2:\ocwvspace{}"}~\^{}~$\ocwlowerid{robust\_decode}~(\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{word}))~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{canon\_upper}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~101~\rightarrow{}~$\ocwstring{"A"}\ocweol
\ocwindent{1.00em}
$\mid{}~102~\rightarrow{}~$\ocwstring{"AA"}\ocweol
\ocwindent{1.00em}
$\mid{}~103~\rightarrow{}~$\ocwstring{"I"}\ocweol
\ocwindent{1.00em}
$\mid{}~104~\rightarrow{}~$\ocwstring{"II"}\ocweol
\ocwindent{1.00em}
$\mid{}~105~\rightarrow{}~$\ocwstring{"U"}\ocweol
\ocwindent{1.00em}
$\mid{}~106~\rightarrow{}~$\ocwstring{"UU"}\ocweol
\ocwindent{1.00em}
$\mid{}~107~\rightarrow{}~$\ocwstring{".R"}\ocweol
\ocwindent{1.00em}
$\mid{}~110~\rightarrow{}~$\ocwstring{"E"}\ocweol
\ocwindent{1.00em}
$\mid{}~111~\rightarrow{}~$\ocwstring{"Ai"}\ocweol
\ocwindent{1.00em}
$\mid{}~112~\rightarrow{}~$\ocwstring{"O"}\ocweol
\ocwindent{1.00em}
$\mid{}~113~\rightarrow{}~$\ocwstring{"Au"}\ocweol
\ocwindent{1.00em}
$\mid{}~117~\rightarrow{}~$\ocwstring{"K"}\ocweol
\ocwindent{1.00em}
$\mid{}~118~\rightarrow{}~$\ocwstring{"Kh"}\ocweol
\ocwindent{1.00em}
$\mid{}~119~\rightarrow{}~$\ocwstring{"G"}\ocweol
\ocwindent{1.00em}
$\mid{}~120~\rightarrow{}~$\ocwstring{"Gh"}\ocweol
\ocwindent{1.00em}
$\mid{}~122~\rightarrow{}~$\ocwstring{"C"}\ocweol
\ocwindent{1.00em}
$\mid{}~123~\rightarrow{}~$\ocwstring{"Ch"}\ocweol
\ocwindent{1.00em}
$\mid{}~124~\rightarrow{}~$\ocwstring{"J"}\ocweol
\ocwindent{1.00em}
$\mid{}~125~\rightarrow{}~$\ocwstring{"Jh"}\ocweol
\ocwindent{1.00em}
$\mid{}~127~\rightarrow{}~$\ocwstring{".T"}\ocweol
\ocwindent{1.00em}
$\mid{}~128~\rightarrow{}~$\ocwstring{".Th"}\ocweol
\ocwindent{1.00em}
$\mid{}~129~\rightarrow{}~$\ocwstring{".D"}\ocweol
\ocwindent{1.00em}
$\mid{}~130~\rightarrow{}~$\ocwstring{".Dh"}\ocweol
\ocwindent{1.00em}
$\mid{}~132~\rightarrow{}~$\ocwstring{"T"}\ocweol
\ocwindent{1.00em}
$\mid{}~133~\rightarrow{}~$\ocwstring{"Th"}\ocweol
\ocwindent{1.00em}
$\mid{}~134~\rightarrow{}~$\ocwstring{"D"}\ocweol
\ocwindent{1.00em}
$\mid{}~135~\rightarrow{}~$\ocwstring{"Dh"}\ocweol
\ocwindent{1.00em}
$\mid{}~136~\rightarrow{}~$\ocwstring{"N"}\ocweol
\ocwindent{1.00em}
$\mid{}~137~\rightarrow{}~$\ocwstring{"P"}\ocweol
\ocwindent{1.00em}
$\mid{}~138~\rightarrow{}~$\ocwstring{"Ph"}\ocweol
\ocwindent{1.00em}
$\mid{}~139~\rightarrow{}~$\ocwstring{"B"}\ocweol
\ocwindent{1.00em}
$\mid{}~140~\rightarrow{}~$\ocwstring{"Bh"}\ocweol
\ocwindent{1.00em}
$\mid{}~141~\rightarrow{}~$\ocwstring{"M"}\ocweol
\ocwindent{1.00em}
$\mid{}~142~\rightarrow{}~$\ocwstring{"Y"}\ocweol
\ocwindent{1.00em}
$\mid{}~143~\rightarrow{}~$\ocwstring{"R"}\ocweol
\ocwindent{1.00em}
$\mid{}~144~\rightarrow{}~$\ocwstring{"L"}\ocweol
\ocwindent{1.00em}
$\mid{}~145~\rightarrow{}~$\ocwstring{"V"}\ocweol
\ocwindent{1.00em}
$\mid{}~146~\rightarrow{}~$\ocwstring{"Z"}\ocweol
\ocwindent{1.00em}
$\mid{}~147~\rightarrow{}~$\ocwstring{".S"}\ocweol
\ocwindent{1.00em}
$\mid{}~148~\rightarrow{}~$\ocwstring{"S"}\ocweol
\ocwindent{1.00em}
$\mid{}~149~\rightarrow{}~$\ocwstring{"H"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{n}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Illegal\ocwvspace{}upper\ocwvspace{}case\ocwvspace{}code\ocwvspace{}:\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{n})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{decode\_ref}~:~\ocwlowerid{word}~\rightarrow{}~$\ocwbt{string}\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{decode\_ref}~\ocwlowerid{word}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{canon}~\ocwlowerid{c}~=~$\ocwkw{if}~$\ocwlowerid{c}>100~$\ocwkw{then}~$\ocwlowerid{canon\_upper}~\ocwlowerid{c}~$\ocwkw{else}~$\ocwlowerid{canon}~\ocwlowerid{c}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{canon\_catenate}~\ocwlowerid{c}~(\ocwlowerid{s},\ocwlowerid{b})~=~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{b'}=~\ocwlowerid{c}>0~\land{}~\ocwlowerid{c}<14~$\ocwbc{} Phonetics.vowel c \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{protected}~=~$\ocwkw{if}~$\ocwlowerid{b}~\land{}~\ocwlowerid{b'}~$\ocwkw{then}~\ocwstring{"\_"}~\^{}~$\ocwlowerid{s}~$\ocwkw{else}~$\ocwlowerid{s}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{canon}~\ocwlowerid{c}~$\^{}~$\ocwlowerid{protected}~,~\ocwlowerid{b'})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{s},\ocwlowerid{\_})~=~\ocwupperid{List.}\ocwlowerid{fold\_right}~\ocwlowerid{canon\_catenate}~\ocwlowerid{word}~($\ocwstring{""},$\ocwupperid{False})~$\ocwkw{in}~$\ocwlowerid{s}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{canon\_html}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~0~\rightarrow{}~$\ocwstring{"\symbol{45}"}\ocweol
\ocwindent{1.00em}
$\mid{}~-10~\rightarrow{}~$\ocwstring{"+"}\ocweol
\ocwindent{1.00em}
$\mid{}~1~\rightarrow{}~$\ocwstring{"a"}\ocweol
\ocwindent{1.00em}
$\mid{}~2~\rightarrow{}~$\ocwstring{"aa"}\ocweol
\ocwindent{1.00em}
$\mid{}~3~\rightarrow{}~$\ocwstring{"i"}\ocweol
\ocwindent{1.00em}
$\mid{}~4~\rightarrow{}~$\ocwstring{"ii"}\ocweol
\ocwindent{1.00em}
$\mid{}~5~\rightarrow{}~$\ocwstring{"u"}\ocweol
\ocwindent{1.00em}
$\mid{}~6~\rightarrow{}~$\ocwstring{"uu"}\ocweol
\ocwindent{1.00em}
$\mid{}~7~\rightarrow{}~$\ocwstring{".r"}\ocweol
\ocwindent{1.00em}
$\mid{}~8~\rightarrow{}~$\ocwstring{".rr"}\ocweol
\ocwindent{1.00em}
$\mid{}~9~\rightarrow{}~$\ocwstring{".l"}\ocweol
\ocwindent{1.00em}
$\mid{}~10~\rightarrow{}~$\ocwstring{"e"}\ocweol
\ocwindent{1.00em}
$\mid{}~11~\rightarrow{}~$\ocwstring{"ai"}\ocweol
\ocwindent{1.00em}
$\mid{}~12~\rightarrow{}~$\ocwstring{"o"}\ocweol
\ocwindent{1.00em}
$\mid{}~13~\rightarrow{}~$\ocwstring{"au"}\ocweol
\ocwindent{1.00em}
$\mid{}~14~\rightarrow{}~$\ocwstring{".m"}\ocweol
\ocwindent{1.00em}
$\mid{}~15~\rightarrow{}~$\ocwstring{"\~{}"}\ocweol
\ocwindent{1.00em}
$\mid{}~16~\rightarrow{}~$\ocwstring{".h"}\ocweol
\ocwindent{1.00em}
$\mid{}~17~\rightarrow{}~$\ocwstring{"k"}\ocweol
\ocwindent{1.00em}
$\mid{}~18~\rightarrow{}~$\ocwstring{"kh"}\ocweol
\ocwindent{1.00em}
$\mid{}~19~\rightarrow{}~$\ocwstring{"g"}\ocweol
\ocwindent{1.00em}
$\mid{}~20~\rightarrow{}~$\ocwstring{"gh"}\ocweol
\ocwindent{1.00em}
$\mid{}~21~\rightarrow{}~$\ocwstring{"f"}\ocweol
\ocwindent{1.00em}
$\mid{}~22~\rightarrow{}~$\ocwstring{"c"}\ocweol
\ocwindent{1.00em}
$\mid{}~23~\rightarrow{}~$\ocwstring{"ch"}\ocweol
\ocwindent{1.00em}
$\mid{}~24~\rightarrow{}~$\ocwstring{"j"}\ocweol
\ocwindent{1.00em}
$\mid{}~25~\rightarrow{}~$\ocwstring{"jh"}\ocweol
\ocwindent{1.00em}
$\mid{}~26~\rightarrow{}~$\ocwstring{"\~{}n"}\ocweol
\ocwindent{1.00em}
$\mid{}~27~\rightarrow{}~$\ocwstring{".t"}\ocweol
\ocwindent{1.00em}
$\mid{}~28~\rightarrow{}~$\ocwstring{".th"}\ocweol
\ocwindent{1.00em}
$\mid{}~29~\rightarrow{}~$\ocwstring{".d"}\ocweol
\ocwindent{1.00em}
$\mid{}~30~\rightarrow{}~$\ocwstring{".dh"}\ocweol
\ocwindent{1.00em}
$\mid{}~31~\rightarrow{}~$\ocwstring{".n"}\ocweol
\ocwindent{1.00em}
$\mid{}~32~\rightarrow{}~$\ocwstring{"t"}\ocweol
\ocwindent{1.00em}
$\mid{}~33~\rightarrow{}~$\ocwstring{"th"}\ocweol
\ocwindent{1.00em}
$\mid{}~34~\rightarrow{}~$\ocwstring{"d"}\ocweol
\ocwindent{1.00em}
$\mid{}~35~\rightarrow{}~$\ocwstring{"dh"}\ocweol
\ocwindent{1.00em}
$\mid{}~36~\rightarrow{}~$\ocwstring{"n"}\ocweol
\ocwindent{1.00em}
$\mid{}~37~\rightarrow{}~$\ocwstring{"p"}\ocweol
\ocwindent{1.00em}
$\mid{}~38~\rightarrow{}~$\ocwstring{"ph"}\ocweol
\ocwindent{1.00em}
$\mid{}~39~\rightarrow{}~$\ocwstring{"b"}\ocweol
\ocwindent{1.00em}
$\mid{}~40~\rightarrow{}~$\ocwstring{"bh"}\ocweol
\ocwindent{1.00em}
$\mid{}~41~\rightarrow{}~$\ocwstring{"m"}\ocweol
\ocwindent{1.00em}
$\mid{}~42~\rightarrow{}~$\ocwstring{"y"}\ocweol
\ocwindent{1.00em}
$\mid{}~43~\rightarrow{}~$\ocwstring{"r"}\ocweol
\ocwindent{1.00em}
$\mid{}~44~\rightarrow{}~$\ocwstring{"l"}\ocweol
\ocwindent{1.00em}
$\mid{}~45~\rightarrow{}~$\ocwstring{"v"}\ocweol
\ocwindent{1.00em}
$\mid{}~46~\rightarrow{}~$\ocwstring{"z"}\ocweol
\ocwindent{1.00em}
$\mid{}~47~\rightarrow{}~$\ocwstring{".s"}\ocweol
\ocwindent{1.00em}
$\mid{}~48~\rightarrow{}~$\ocwstring{"s"}\ocweol
\ocwindent{1.00em}
$\mid{}~49~\rightarrow{}~$\ocwstring{"h"}\ocweol
\ocwindent{1.00em}
$\mid{}~50~\rightarrow{}~$\ocwstring{"\_"}~\ocwbc{} hiatus \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{n}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{n}<0~$\ocwkw{then}~\ocweol
\ocwindent{6.00em}
$\ocwlowerid{failwith}~($\ocwstring{"Illegal\ocwvspace{}letter\ocwvspace{}to\ocwvspace{}canon\_html\ocwvspace{}:\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{n})$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~$($\ocwstring{"\#"}~\^{}~$\ocwupperid{Char.}\ocwlowerid{escaped}~(\ocwupperid{Char.}\ocwlowerid{chr}~(\ocwlowerid{n}-2)))$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{canon\_upper\_html}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~101~\rightarrow{}~$\ocwstring{"Ua"}\ocweol
\ocwindent{1.00em}
$\mid{}~102~\rightarrow{}~$\ocwstring{"Uaa"}\ocweol
\ocwindent{1.00em}
$\mid{}~103~\rightarrow{}~$\ocwstring{"Ui"}\ocweol
\ocwindent{1.00em}
$\mid{}~104~\rightarrow{}~$\ocwstring{"Uii"}\ocweol
\ocwindent{1.00em}
$\mid{}~105~\rightarrow{}~$\ocwstring{"Uu"}\ocweol
\ocwindent{1.00em}
$\mid{}~106~\rightarrow{}~$\ocwstring{"Uuu"}\ocweol
\ocwindent{1.00em}
$\mid{}~107~\rightarrow{}~$\ocwstring{"U.r"}\ocweol
\ocwindent{1.00em}
$\mid{}~110~\rightarrow{}~$\ocwstring{"Ue"}\ocweol
\ocwindent{1.00em}
$\mid{}~111~\rightarrow{}~$\ocwstring{"Uai"}\ocweol
\ocwindent{1.00em}
$\mid{}~112~\rightarrow{}~$\ocwstring{"Uo"}\ocweol
\ocwindent{1.00em}
$\mid{}~113~\rightarrow{}~$\ocwstring{"Uau"}\ocweol
\ocwindent{1.00em}
$\mid{}~117~\rightarrow{}~$\ocwstring{"Uk"}\ocweol
\ocwindent{1.00em}
$\mid{}~118~\rightarrow{}~$\ocwstring{"Ukh"}\ocweol
\ocwindent{1.00em}
$\mid{}~119~\rightarrow{}~$\ocwstring{"Ug"}\ocweol
\ocwindent{1.00em}
$\mid{}~120~\rightarrow{}~$\ocwstring{"Ugh"}\ocweol
\ocwindent{1.00em}
$\mid{}~122~\rightarrow{}~$\ocwstring{"Uc"}\ocweol
\ocwindent{1.00em}
$\mid{}~123~\rightarrow{}~$\ocwstring{"Uch"}\ocweol
\ocwindent{1.00em}
$\mid{}~124~\rightarrow{}~$\ocwstring{"Uj"}\ocweol
\ocwindent{1.00em}
$\mid{}~125~\rightarrow{}~$\ocwstring{"Ujh"}\ocweol
\ocwindent{1.00em}
$\mid{}~127~\rightarrow{}~$\ocwstring{"U.t"}\ocweol
\ocwindent{1.00em}
$\mid{}~128~\rightarrow{}~$\ocwstring{"U.th"}\ocweol
\ocwindent{1.00em}
$\mid{}~129~\rightarrow{}~$\ocwstring{"U.d"}\ocweol
\ocwindent{1.00em}
$\mid{}~130~\rightarrow{}~$\ocwstring{"U.dh"}\ocweol
\ocwindent{1.00em}
$\mid{}~132~\rightarrow{}~$\ocwstring{"Ut"}\ocweol
\ocwindent{1.00em}
$\mid{}~133~\rightarrow{}~$\ocwstring{"Uth"}\ocweol
\ocwindent{1.00em}
$\mid{}~134~\rightarrow{}~$\ocwstring{"Ud"}\ocweol
\ocwindent{1.00em}
$\mid{}~135~\rightarrow{}~$\ocwstring{"Udh"}\ocweol
\ocwindent{1.00em}
$\mid{}~136~\rightarrow{}~$\ocwstring{"Un"}\ocweol
\ocwindent{1.00em}
$\mid{}~137~\rightarrow{}~$\ocwstring{"Up"}\ocweol
\ocwindent{1.00em}
$\mid{}~138~\rightarrow{}~$\ocwstring{"Uph"}\ocweol
\ocwindent{1.00em}
$\mid{}~139~\rightarrow{}~$\ocwstring{"Ub"}\ocweol
\ocwindent{1.00em}
$\mid{}~140~\rightarrow{}~$\ocwstring{"Ubh"}\ocweol
\ocwindent{1.00em}
$\mid{}~141~\rightarrow{}~$\ocwstring{"Um"}\ocweol
\ocwindent{1.00em}
$\mid{}~142~\rightarrow{}~$\ocwstring{"Uy"}\ocweol
\ocwindent{1.00em}
$\mid{}~143~\rightarrow{}~$\ocwstring{"Ur"}\ocweol
\ocwindent{1.00em}
$\mid{}~144~\rightarrow{}~$\ocwstring{"Ul"}\ocweol
\ocwindent{1.00em}
$\mid{}~145~\rightarrow{}~$\ocwstring{"Uv"}\ocweol
\ocwindent{1.00em}
$\mid{}~146~\rightarrow{}~$\ocwstring{"Uz"}\ocweol
\ocwindent{1.00em}
$\mid{}~147~\rightarrow{}~$\ocwstring{"U.s"}\ocweol
\ocwindent{1.00em}
$\mid{}~148~\rightarrow{}~$\ocwstring{"Us"}\ocweol
\ocwindent{1.00em}
$\mid{}~149~\rightarrow{}~$\ocwstring{"Uh"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{n}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Illegal\ocwvspace{}upper\ocwvspace{}case\ocwvspace{}code\ocwvspace{}:\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{n})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Roman with diacritics Unicode - latin extended \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{canon\_uniromcode}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~0~\rightarrow{}~$\ocwstring{"\symbol{45}"}\ocweol
\ocwindent{1.00em}
$\mid{}~-10~\rightarrow{}~$\ocwstring{"+"}\ocweol
\ocwindent{1.00em}
$\mid{}~1~\rightarrow{}~$\ocwstring{"a"}\ocweol
\ocwindent{1.00em}
$\mid{}~2~\rightarrow{}~$\ocwstring{"\&\#257;"}\ocweol
\ocwindent{1.00em}
$\mid{}~3~\rightarrow{}~$\ocwstring{"i"}\ocweol
\ocwindent{1.00em}
$\mid{}~4~\rightarrow{}~$\ocwstring{"\&\#299;"}\ocweol
\ocwindent{1.00em}
$\mid{}~5~\rightarrow{}~$\ocwstring{"u"}\ocweol
\ocwindent{1.00em}
$\mid{}~6~\rightarrow{}~$\ocwstring{"\&\#363;"}\ocweol
\ocwindent{1.00em}
$\mid{}~7~\rightarrow{}~$\ocwstring{"\&\#7771;"}\ocweol
\ocwindent{1.00em}
$\mid{}~8~\rightarrow{}~$\ocwstring{"\&\#7773;"}\ocweol
\ocwindent{1.00em}
$\mid{}~9~\rightarrow{}~$\ocwstring{"\&\#7735;"}\ocweol
\ocwindent{1.00em}
$\mid{}~10~\rightarrow{}~$\ocwstring{"e"}\ocweol
\ocwindent{1.00em}
$\mid{}~11~\rightarrow{}~$\ocwstring{"ai"}\ocweol
\ocwindent{1.00em}
$\mid{}~12~\rightarrow{}~$\ocwstring{"o"}\ocweol
\ocwindent{1.00em}
$\mid{}~13~\rightarrow{}~$\ocwstring{"au"}\ocweol
\ocwindent{1.00em}
$\mid{}~14~\rightarrow{}~$\ocwstring{"\&\#7747;"}~\ocwbc{} anusvaara as m with dot below \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~15~\rightarrow{}~$\ocwstring{"\&\#7745;"}~\ocwbc{} candrabindu as m with dot above (?) \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~16~\rightarrow{}~$\ocwstring{"\&\#7717;"}\ocweol
\ocwindent{1.00em}
$\mid{}~17~\rightarrow{}~$\ocwstring{"k"}\ocweol
\ocwindent{1.00em}
$\mid{}~18~\rightarrow{}~$\ocwstring{"kh"}\ocweol
\ocwindent{1.00em}
$\mid{}~19~\rightarrow{}~$\ocwstring{"g"}\ocweol
\ocwindent{1.00em}
$\mid{}~20~\rightarrow{}~$\ocwstring{"gh"}\ocweol
\ocwindent{1.00em}
$\mid{}~21~\rightarrow{}~$\ocwstring{"\&\#7749;"}\ocweol
\ocwindent{1.00em}
$\mid{}~22~\rightarrow{}~$\ocwstring{"c"}\ocweol
\ocwindent{1.00em}
$\mid{}~23~\rightarrow{}~$\ocwstring{"ch"}\ocweol
\ocwindent{1.00em}
$\mid{}~24~\rightarrow{}~$\ocwstring{"j"}\ocweol
\ocwindent{1.00em}
$\mid{}~25~\rightarrow{}~$\ocwstring{"jh"}\ocweol
\ocwindent{1.00em}
$\mid{}~26~\rightarrow{}~$\ocwstring{"\&\#241;"}\ocweol
\ocwindent{1.00em}
$\mid{}~27~\rightarrow{}~$\ocwstring{"\&\#7789;"}\ocweol
\ocwindent{1.00em}
$\mid{}~28~\rightarrow{}~$\ocwstring{"\&\#7789;h"}\ocweol
\ocwindent{1.00em}
$\mid{}~29~\rightarrow{}~$\ocwstring{"\&\#7693;"}\ocweol
\ocwindent{1.00em}
$\mid{}~30~\rightarrow{}~$\ocwstring{"\&\#7693;h"}\ocweol
\ocwindent{1.00em}
$\mid{}~31~\rightarrow{}~$\ocwstring{"\&\#7751;"}\ocweol
\ocwindent{1.00em}
$\mid{}~32~\rightarrow{}~$\ocwstring{"t"}\ocweol
\ocwindent{1.00em}
$\mid{}~33~\rightarrow{}~$\ocwstring{"th"}\ocweol
\ocwindent{1.00em}
$\mid{}~34~\rightarrow{}~$\ocwstring{"d"}\ocweol
\ocwindent{1.00em}
$\mid{}~35~\rightarrow{}~$\ocwstring{"dh"}\ocweol
\ocwindent{1.00em}
$\mid{}~36~\rightarrow{}~$\ocwstring{"n"}\ocweol
\ocwindent{1.00em}
$\mid{}~37~\rightarrow{}~$\ocwstring{"p"}\ocweol
\ocwindent{1.00em}
$\mid{}~38~\rightarrow{}~$\ocwstring{"ph"}\ocweol
\ocwindent{1.00em}
$\mid{}~39~\rightarrow{}~$\ocwstring{"b"}\ocweol
\ocwindent{1.00em}
$\mid{}~40~\rightarrow{}~$\ocwstring{"bh"}\ocweol
\ocwindent{1.00em}
$\mid{}~41~\rightarrow{}~$\ocwstring{"m"}\ocweol
\ocwindent{1.00em}
$\mid{}~42~\rightarrow{}~$\ocwstring{"y"}\ocweol
\ocwindent{1.00em}
$\mid{}~43~\rightarrow{}~$\ocwstring{"r"}\ocweol
\ocwindent{1.00em}
$\mid{}~44~\rightarrow{}~$\ocwstring{"l"}\ocweol
\ocwindent{1.00em}
$\mid{}~45~\rightarrow{}~$\ocwstring{"v"}\ocweol
\ocwindent{1.00em}
$\mid{}~46~\rightarrow{}~$\ocwstring{"\&\#347;"}\ocweol
\ocwindent{1.00em}
$\mid{}~47~\rightarrow{}~$\ocwstring{"\&\#7779;"}\ocweol
\ocwindent{1.00em}
$\mid{}~48~\rightarrow{}~$\ocwstring{"s"}\ocweol
\ocwindent{1.00em}
$\mid{}~49~\rightarrow{}~$\ocwstring{"h"}\ocweol
\ocwindent{1.00em}
$\mid{}~50~\rightarrow{}~$\ocwstring{"\_"}\ocweol
\ocwindent{1.00em}
$\mid{}~-1~\rightarrow{}~$\ocwstring{"'"}\ocweol
\ocwindent{1.00em}
$\mid{}~-2~\rightarrow{}~$\ocwstring{"[\symbol{45}]"}~\ocwbc{} amuissement - lopa of current aa- or preceding a- or aa- \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-3~\rightarrow{}~$\ocwstring{"\&\#257;|a"}~\ocwbc{} sandhi of aa and (a,aa) *a \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-4~\rightarrow{}~$\ocwstring{"\&\#257;|i"}~\ocwbc{} sandhi of aa and (i,ii) *e \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-5~\rightarrow{}~$\ocwstring{"\&\#257;|u"}~\ocwbc{} sandhi of aa and (u,uu) *u \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-6~\rightarrow{}~$\ocwstring{"\&\#257;|r"}~\ocwbc{} sandhi of aa and .r     *r \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~124~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Canon:\ocwvspace{}Unrestored\ocwvspace{}special\ocwvspace{}phoneme\ocwvspace{}j'"}~\ocweol
\ocwindent{1.00em}
$\mid{}~149~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Canon:\ocwvspace{}Unrestored\ocwvspace{}special\ocwvspace{}phoneme\ocwvspace{}h'"}~\ocweol
\ocwindent{1.00em}
$\mid{}~249~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Canon:\ocwvspace{}Unrestored\ocwvspace{}special\ocwvspace{}phoneme\ocwvspace{}h''"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{n}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{n}<0~$\ocwkw{then}~\ocweol
\ocwindent{6.00em}
$\ocwlowerid{failwith}~($\ocwstring{"Illegal\ocwvspace{}code\ocwvspace{}to\ocwvspace{}canon\_unicode\ocwvspace{}:\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{n})$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~$($\ocwstring{"\_"}~\^{}~$\ocwupperid{Char.}\ocwlowerid{escaped}~(\ocwupperid{Char.}\ocwlowerid{chr}~(\ocwlowerid{n}-2)))$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Gives the Unicode representation of the romanisation of word \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{unicode}~:~\ocwlowerid{word}~\rightarrow{}~$\ocwbt{string}\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{uniromcode}~\ocwlowerid{word}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{catenate}~\ocwlowerid{c}~(\ocwlowerid{s},\ocwlowerid{b})~=~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{b'}=~\ocwlowerid{c}>0~\land{}~\ocwlowerid{c}<14~$\ocwbc{} Phonetics.vowel c \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{protected}~=~$\ocwkw{if}~$\ocwlowerid{b}~\land{}~\ocwlowerid{b'}~$\ocwkw{then}~\ocwstring{"\ocwvspace{}"}~\^{}~$\ocwlowerid{s}~$\ocwkw{else}~$\ocwlowerid{s}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{canon\_uniromcode}~\ocwlowerid{c}~$\^{}~$\ocwlowerid{protected}~,~\ocwlowerid{b'})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{s},\ocwlowerid{\_})~=~\ocwupperid{List.}\ocwlowerid{fold\_right}~\ocwlowerid{catenate}~\ocwlowerid{word}~($\ocwstring{""},$\ocwupperid{False})~$\ocwkw{in}~$\ocwlowerid{s}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{halant}~=~$\ocwstring{"\&\#x094D;"}\ocweol
\ocwindent{0.00em}
\ocwbc{} and avagraha = \ocwstring{"\&\#x093D;"}
   and candrabindu = \ocwstring{"\&\#x310;"} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Numerals to come: 1=\ocwstring{"x0967;"} ... 9=\ocwstring{"x0966F"} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} represents a stem word in romanization or VH transliteration \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{stem\_to\_string}~\ocwlowerid{html}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{html}~$\ocwkw{then}~$\ocwlowerid{uniromcode}~$\ocwbc{} UTF8 romanization with diacritics \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{decode}~$\ocwbc{} VH \ocwec{}\ocweol
\ocwindent{0.00em}
;\medskip

\label{canon.ml:15150}%
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Hiatus}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{indic\_unicode\_point}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~0~\mid{}~-10~\rightarrow{}~$\ocwbc{} - \ocwec{}~\ocwstring{"70"}\ocweol
\ocwindent{1.00em}
$\mid{}~1~\rightarrow{}~$\ocwbc{} a \ocwec{}~\ocwstring{"05"}\ocweol
\ocwindent{1.00em}
$\mid{}~2~\rightarrow{}~$\ocwbc{} aa \ocwec{}~\ocwstring{"06"}\ocweol
\ocwindent{1.00em}
$\mid{}~3~\rightarrow{}~$\ocwbc{} i \ocwec{}~\ocwstring{"07"}\ocweol
\ocwindent{1.00em}
$\mid{}~4~\rightarrow{}~$\ocwbc{} ii \ocwec{}~\ocwstring{"08"}\ocweol
\ocwindent{1.00em}
$\mid{}~5~\rightarrow{}~$\ocwbc{} u \ocwec{}~\ocwstring{"09"}\ocweol
\ocwindent{1.00em}
$\mid{}~6~\rightarrow{}~$\ocwbc{} uu \ocwec{}~\ocwstring{"0A"}\ocweol
\ocwindent{1.00em}
$\mid{}~7~\rightarrow{}~$\ocwbc{} .r \ocwec{}~\ocwstring{"0B"}\ocweol
\ocwindent{1.00em}
$\mid{}~8~\rightarrow{}~$\ocwbc{} .rr \ocwec{}\ocwstring{"60"}\ocweol
\ocwindent{1.00em}
$\mid{}~9~\rightarrow{}~$\ocwbc{} .l \ocwec{}~\ocwstring{"0C"}\ocweol
\ocwindent{1.00em}
$\mid{}~10~\rightarrow{}~$\ocwbc{} e \ocwec{}~\ocwstring{"0F"}\ocweol
\ocwindent{1.00em}
$\mid{}~11~\rightarrow{}~$\ocwbc{} ai \ocwec{}~\ocwstring{"10"}\ocweol
\ocwindent{1.00em}
$\mid{}~12~\rightarrow{}~$\ocwbc{} o \ocwec{}~\ocwstring{"13"}\ocweol
\ocwindent{1.00em}
$\mid{}~13~\rightarrow{}~$\ocwbc{} au \ocwec{}~\ocwstring{"14"}\ocweol
\ocwindent{1.00em}
$\mid{}~14~\rightarrow{}~$\ocwbc{} .m \ocwec{}~\ocwstring{"02"}\ocweol
\ocwindent{1.00em}
$\mid{}~15~\rightarrow{}~$\ocwbc{} ~~ \ocwec{}~\ocwstring{"01"}\ocweol
\ocwindent{1.00em}
$\mid{}~16~\rightarrow{}~$\ocwbc{} .h \ocwec{}~\ocwstring{"03"}~\ocweol
\ocwindent{1.00em}
$\mid{}~17~\rightarrow{}~$\ocwbc{} k \ocwec{}~\ocwstring{"15"}\ocweol
\ocwindent{1.00em}
$\mid{}~18~\rightarrow{}~$\ocwbc{} kh \ocwec{}~\ocwstring{"16"}\ocweol
\ocwindent{1.00em}
$\mid{}~19~\rightarrow{}~$\ocwbc{} g \ocwec{}~\ocwstring{"17"}\ocweol
\ocwindent{1.00em}
$\mid{}~20~\rightarrow{}~$\ocwbc{} gh \ocwec{}~\ocwstring{"18"}\ocweol
\ocwindent{1.00em}
$\mid{}~21~\rightarrow{}~$\ocwbc{} 'n \ocwec{}~\ocwstring{"19"}\ocweol
\ocwindent{1.00em}
$\mid{}~22~\rightarrow{}~$\ocwbc{} c \ocwec{}~\ocwstring{"1A"}\ocweol
\ocwindent{1.00em}
$\mid{}~23~\rightarrow{}~$\ocwbc{} ch \ocwec{}~\ocwstring{"1B"}\ocweol
\ocwindent{1.00em}
$\mid{}~24~\rightarrow{}~$\ocwbc{} j \ocwec{}~\ocwstring{"1C"}\ocweol
\ocwindent{1.00em}
$\mid{}~25~\rightarrow{}~$\ocwbc{} jh \ocwec{}~\ocwstring{"1D"}\ocweol
\ocwindent{1.00em}
$\mid{}~26~\rightarrow{}~$\ocwbc{} ~n \ocwec{}~\ocwstring{"1E"}\ocweol
\ocwindent{1.00em}
$\mid{}~27~\rightarrow{}~$\ocwbc{} .t \ocwec{}~\ocwstring{"1F"}\ocweol
\ocwindent{1.00em}
$\mid{}~28~\rightarrow{}~$\ocwbc{} .th \ocwec{}\ocwstring{"20"}\ocweol
\ocwindent{1.00em}
$\mid{}~29~\rightarrow{}~$\ocwbc{} .d \ocwec{}~\ocwstring{"21"}\ocweol
\ocwindent{1.00em}
$\mid{}~30~\rightarrow{}~$\ocwbc{} .dh \ocwec{}\ocwstring{"22"}\ocweol
\ocwindent{1.00em}
$\mid{}~31~\rightarrow{}~$\ocwbc{} .n \ocwec{}~\ocwstring{"23"}\ocweol
\ocwindent{1.00em}
$\mid{}~32~\rightarrow{}~$\ocwbc{} t \ocwec{}~\ocwstring{"24"}\ocweol
\ocwindent{1.00em}
$\mid{}~33~\rightarrow{}~$\ocwbc{} th \ocwec{}~\ocwstring{"25"}\ocweol
\ocwindent{1.00em}
$\mid{}~34~\rightarrow{}~$\ocwbc{} d \ocwec{}~\ocwstring{"26"}\ocweol
\ocwindent{1.00em}
$\mid{}~35~\rightarrow{}~$\ocwbc{} dh \ocwec{}~\ocwstring{"27"}\ocweol
\ocwindent{1.00em}
$\mid{}~36~\rightarrow{}~$\ocwbc{} n \ocwec{}~\ocwstring{"28"}\ocweol
\ocwindent{1.00em}
$\mid{}~37~\rightarrow{}~$\ocwbc{} p \ocwec{}~\ocwstring{"2A"}\ocweol
\ocwindent{1.00em}
$\mid{}~38~\rightarrow{}~$\ocwbc{} ph \ocwec{}~\ocwstring{"2B"}\ocweol
\ocwindent{1.00em}
$\mid{}~39~\rightarrow{}~$\ocwbc{} b \ocwec{}~\ocwstring{"2C"}\ocweol
\ocwindent{1.00em}
$\mid{}~40~\rightarrow{}~$\ocwbc{} bh \ocwec{}~\ocwstring{"2D"}\ocweol
\ocwindent{1.00em}
$\mid{}~41~\rightarrow{}~$\ocwbc{} m \ocwec{}~\ocwstring{"2E"}\ocweol
\ocwindent{1.00em}
$\mid{}~42~\rightarrow{}~$\ocwbc{} y \ocwec{}~\ocwstring{"2F"}\ocweol
\ocwindent{1.00em}
$\mid{}~43~\rightarrow{}~$\ocwbc{} r \ocwec{}~\ocwstring{"30"}\ocweol
\ocwindent{1.00em}
$\mid{}~44~\rightarrow{}~$\ocwbc{} l \ocwec{}~\ocwstring{"32"}\ocweol
\ocwindent{1.00em}
$\mid{}~45~\rightarrow{}~$\ocwbc{} v \ocwec{}~\ocwstring{"35"}\ocweol
\ocwindent{1.00em}
$\mid{}~46~\rightarrow{}~$\ocwbc{} z \ocwec{}~\ocwstring{"36"}\ocweol
\ocwindent{1.00em}
$\mid{}~47~\rightarrow{}~$\ocwbc{} .s \ocwec{}~\ocwstring{"37"}\ocweol
\ocwindent{1.00em}
$\mid{}~48~\rightarrow{}~$\ocwbc{} s \ocwec{}~\ocwstring{"38"}\ocweol
\ocwindent{1.00em}
$\mid{}~49~\rightarrow{}~$\ocwbc{} h \ocwec{}~\ocwstring{"39"}\ocweol
\ocwindent{1.00em}
$\mid{}~50~\rightarrow{}~$\ocwbc{} underscore \ocwec{}~$\ocwlowerid{raise}~\ocwupperid{Hiatus}$\ocweol
\ocwindent{1.00em}
$\mid{}~-1~\rightarrow{}~$\ocwbc{} avagraha \ocwec{}~\ocwstring{"3D"}\ocweol
\ocwindent{1.00em}
$\mid{}~-2~\rightarrow{}~$\ocwstring{""}~\ocwbc{} amuissement \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-3~\rightarrow{}~$\ocwstring{"06"}~\ocwbc{} \ocwstring{"aa|a"} sandhi of aa and (a,aa) \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-4~\rightarrow{}~$\ocwstring{"0F"}~\ocwbc{} \ocwstring{"aa|i"} sandhi of aa and (i,ii) \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-5~\rightarrow{}~$\ocwstring{"13"}~\ocwbc{} \ocwstring{"aa|u"} sandhi of aa and (u,uu) \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-6~\rightarrow{}~$\ocwstring{"06"}~\ocwbc{} sandhi of aa and .r \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}<0~\lor{}~\ocwlowerid{c}>59~$\ocweol
\ocwindent{6.00em}
\ocwkw{then}~$\ocwlowerid{failwith}~($\ocwstring{"Illegal\ocwvspace{}code\ocwvspace{}to\ocwvspace{}dev\_unicode:\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{c})$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~\ocwstring{""}~\ocwbc{} homo index dropped \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{matra\_indic\_unicode\_point}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~-10~$\ocwbc{} + \ocwec{}~\ocwbc{} necessary for word form ending in consonant \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~0~\rightarrow{}~$\ocwbc{} - \ocwec{}~\ocwstring{"70"}~\ocwbc{} id for iics \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~1~\rightarrow{}~$\ocwbc{} a \ocwec{}~\ocwstring{""}~\ocwbc{} default \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~2~\rightarrow{}~$\ocwbc{} aa \ocwec{}~\ocwstring{"3E"}\ocweol
\ocwindent{1.00em}
$\mid{}~3~\rightarrow{}~$\ocwbc{} i \ocwec{}~\ocwstring{"3F"}\ocweol
\ocwindent{1.00em}
$\mid{}~4~\rightarrow{}~$\ocwbc{} ii \ocwec{}~\ocwstring{"40"}\ocweol
\ocwindent{1.00em}
$\mid{}~5~\rightarrow{}~$\ocwbc{} u \ocwec{}~\ocwstring{"41"}\ocweol
\ocwindent{1.00em}
$\mid{}~6~\rightarrow{}~$\ocwbc{} uu \ocwec{}~\ocwstring{"42"}\ocweol
\ocwindent{1.00em}
$\mid{}~7~\rightarrow{}~$\ocwbc{} .r \ocwec{}~\ocwstring{"43"}\ocweol
\ocwindent{1.00em}
$\mid{}~8~\rightarrow{}~$\ocwbc{} .rr \ocwec{}\ocwstring{"44"}\ocweol
\ocwindent{1.00em}
$\mid{}~9~\rightarrow{}~$\ocwbc{} .l \ocwec{}~\ocwstring{"62"}\ocweol
\ocwindent{1.00em}
$\mid{}~10~\rightarrow{}~$\ocwbc{} e \ocwec{}~\ocwstring{"47"}\ocweol
\ocwindent{1.00em}
$\mid{}~11~\rightarrow{}~$\ocwbc{} ai \ocwec{}~\ocwstring{"48"}\ocweol
\ocwindent{1.00em}
$\mid{}~12~\rightarrow{}~$\ocwbc{} o \ocwec{}~\ocwstring{"4B"}\ocweol
\ocwindent{1.00em}
$\mid{}~13~\rightarrow{}~$\ocwbc{} au \ocwec{}~\ocwstring{"4C"}\ocweol
\ocwindent{1.00em}
$\mid{}~15~\rightarrow{}~$\ocwbc{} ~~ \ocwec{}~\ocwstring{"01"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Illegal\ocwvspace{}code\ocwvspace{}to\ocwvspace{}matra\_unicode\ocwvspace{}:\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{c})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} om 50 udatta 51 anudatta 52 grave 53 acute 54 avagraha 3D .ll 61 
   danda 64 ddanda 65 0 66 1 67 2 68 3 69 4 6A 5 6B 6 6C 7 6D 8 6E 9 6F ° 70 \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{inject\_point}~\ocwlowerid{s}~=~$\ocwstring{"\&\#x09"}~\^{}~$\ocwlowerid{s}~$\^{}~\ocwstring{";"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{deva\_unicode}~\ocwlowerid{c}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{s}~=~\ocwlowerid{indic\_unicode\_point}~\ocwlowerid{c}~$\ocwkw{in}~$\ocwlowerid{inject\_point}~\ocwlowerid{s}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{matra\_unicode}~\ocwlowerid{c}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{c}=1~$\ocwkw{then}~\ocwstring{""}~\ocwbc{} default \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwkw{let}~$\ocwlowerid{s}~=~\ocwlowerid{matra\_indic\_unicode\_point}~\ocwlowerid{c}~$\ocwkw{in}~$\ocwlowerid{inject\_point}~\ocwlowerid{s}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Gives the Unicode representation of devanagari form of word;          \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} ligature construction is left to the font manager handling of halant. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Beware : word should not carry homophony index - use \ocwbegindcode{}$\ocwlowerid{code\_strip}$\ocwenddcode{}.    \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{unidevcode}~:~\ocwlowerid{word}~\rightarrow{}~$\ocwbt{string}\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{unidevcode}~\ocwlowerid{word}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{ligature}~(\ocwlowerid{s},\ocwlowerid{b})~\ocwlowerid{c}~=~$\ocwbc{} b memorizes whether last char is consonant \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{code}~=~\ocwlowerid{deva\_unicode}~\ocwlowerid{c}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwkw{if}~$\ocwlowerid{c}>16~$\ocwbc{} Phonetics.consonant c \ocwec{}~\ocwkw{then}~\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{b}~$\ocwbc{} add glyph \ocwec{}~\ocwkw{then}~$(\ocwlowerid{s}~$\^{}~$\ocwlowerid{halant}~$\^{}~$\ocwlowerid{code},\ocwupperid{True})$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~$(\ocwlowerid{s}~$\^{}~$\ocwlowerid{code},\ocwupperid{True})~$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{b}~$\ocwkw{then}~\ocweol
\ocwindent{7.00em}
\ocwkw{if}~$\ocwlowerid{c}=0~$\ocwbc{} - \ocwec{}~\ocwkw{then}~$(\ocwlowerid{s}~$\^{}~$\ocwlowerid{halant}~$\^{}~$\ocwlowerid{code},\ocwupperid{False})$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~\ocwbc{} add matra \ocwec{}~\ocwkw{let}~$\ocwlowerid{m}~=~\ocwlowerid{matra\_unicode}~\ocwlowerid{c}~$\ocwkw{in}~$(\ocwlowerid{s}~$\^{}~$\ocwlowerid{m},\ocwupperid{False})$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~$(\ocwlowerid{s}~$\^{}~$\ocwlowerid{code},\ocwupperid{False})~$\ocweol
\ocwindent{2.50em}
\ocwkw{with}~\ocwbc{} hiatus represented by space in devanagarii output \ocwec{}\ocweol
\ocwindent{5.00em}
$[~\ocwupperid{Hiatus}~\rightarrow{}~(\ocwlowerid{s}~$\^{}~\ocwstring{"\ocwvspace{}"},$\ocwupperid{False})~]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{s},\ocwlowerid{b})~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{ligature}~($\ocwstring{""},$\ocwupperid{False})~\ocwlowerid{word}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{b}~$\ocwkw{then}~$\ocwlowerid{s}~$\^{}~$\ocwlowerid{halant}~$\ocwbc{} virama \ocwec{}~\ocwkw{else}~$\ocwlowerid{s}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Transduction.ml}
\ocwmodule{Transduction}
\label{transduction.ml:0}%
\label{transduction.ml:657}%
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Camlp4.PreCast};~$\ocwbc{} MakeGram Loc \ocwec{}\medskip

\label{transduction.ml:698}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Gram}~=~\ocwupperid{MakeGram}~\ocwupperid{Zen\_lexer}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Zen\_lexer.Token}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{transducer}~\ocwlowerid{trad}~\ocwlowerid{t}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gram.}\ocwlowerid{parse\_string}~\ocwlowerid{trad}~\ocwupperid{Loc.}\ocwlowerid{ghost}~\ocwlowerid{t}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~\ocwlowerid{e}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwupperid{Format.}\ocwlowerid{eprintf}~$\ocwstring{"In\ocwvspace{}string\ocwvspace{}\symbol{92}"\%s\symbol{92}",\ocwvspace{}at\ocwvspace{}location\ocwvspace{}\%a:@."}~$\ocwlowerid{t}~\ocwupperid{Loc.}\ocwlowerid{print}~\ocwlowerid{loc}~$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{raise}~\ocwlowerid{e}$\ocweol
\ocwindent{2.50em}
\}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Roman with diacritics, TeX encoding  
\ocweol
\label{transduction.ml:1099}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{tex}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"skt\ocwvspace{}to\ocwvspace{}tex"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{tex\_word}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"skt\ocwvspace{}to\ocwvspace{}tex\ocwvspace{}word"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwupperid{EXTEND}~\ocwupperid{Gram}~$\ocwbc{} skt to tex \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{tex}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}.n"}~\ocwbc{} deprecated \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"f"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}.n"}~\ocwbc{} recommended \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"F"}~$\rightarrow{}~$\ocwstring{"f"}~\ocwbc{} patch for latin \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}'s"}~\ocwbc{} deprecated \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"z"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}'s"}~\ocwbc{} recommended \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"S"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}'S"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"Z"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}'S"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}'a"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}'\symbol{92}\symbol{92}i\}"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}'u"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"e"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}'e"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"o"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}'o"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"};~\ocwstring{"|"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unexpected\ocwvspace{}phantom\ocwvspace{}phoneme"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"};~\ocwstring{"|"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unexpected\ocwvspace{}phantom\ocwvspace{}phoneme"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"};~\ocwstring{"|"};~$\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unexpected\ocwvspace{}phantom\ocwvspace{}phoneme"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}=a"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~$\ocwstring{"a"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"A"};~$\ocwupperid{LETTER}~$\ocwstring{"A"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}=A"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"A"}~$\rightarrow{}~$\ocwstring{"A"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}=\symbol{92}\symbol{92}i\}"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~$\ocwstring{"i"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"I"};~$\ocwupperid{LETTER}~$\ocwstring{"I"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}=I"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"I"}~$\rightarrow{}~$\ocwstring{"I"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}=u"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~$\ocwstring{"u"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"U"};~$\ocwupperid{LETTER}~$\ocwstring{"U"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}=U"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"U"}~$\rightarrow{}~$\ocwstring{"U"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\~{}"};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}\~{}n"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"l"};~\ocwstring{"\~{}"};~\ocwstring{"\~{}"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}\~{}l"}~\ocwbc{} candrabindu \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"y"};~\ocwstring{"\~{}"};~\ocwstring{"\~{}"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}\~{}y"}~\ocwbc{} candrabindu \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"v"};~\ocwstring{"\~{}"};~\ocwstring{"\~{}"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}\~{}v"}~\ocwbc{} candrabindu \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"+"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}\symbol{45}"}~\ocwbc{} hyphenation hint \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\$"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}\_"}~\ocwbc{} pra-uga \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\_"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}\_"}~\ocwbc{} hiatus \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\&"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}\&"}~\ocwbc{} reserved \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{45}"}~$\rightarrow{}~$\ocwstring{"\symbol{45}"}~\ocwbc{} prefix \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"}~$\rightarrow{}~$\ocwstring{"'"}~\ocwbc{} avagraha \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~\ocwstring{"."};~\ocwstring{"."}~$\rightarrow{}~$\ocwstring{"..."}~\ocwbc{} ... \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"t"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}d\ocwvspace{}t\}"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"d"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}d\ocwvspace{}d\}"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}d\ocwvspace{}s\}"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"S"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}d\ocwvspace{}S\}"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}d\ocwvspace{}n\}"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"r"};~$\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}RR\}"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}d\ocwvspace{}r\}"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"R"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}d\ocwvspace{}R\}"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"l"};~$\ocwupperid{LETTER}~$\ocwstring{"l"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}LL\}"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"l"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}d\ocwvspace{}l\}"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}d\ocwvspace{}m\}"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}d\ocwvspace{}h\}"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"T"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}d\ocwvspace{}T\}"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"D"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}d\ocwvspace{}D\}"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\#"};~$\ocwlowerid{i}~=~\ocwupperid{INT}~\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}(\_\{"}~\^{}~$\ocwlowerid{i}~$\^{}~\ocwstring{"\}\symbol{92}\symbol{92})"}~\ocwbc{} homonyms \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{i}~=~\ocwupperid{LETTER}~\rightarrow{}~\ocwlowerid{i}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{i}~=~\ocwupperid{INT}~\rightarrow{}~\ocwlowerid{i}$\ocweol
\ocwindent{2.00em}
$]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{tex\_word}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{w}~=~\ocwupperid{LIST0}~\ocwlowerid{tex};~`\ocwupperid{EOI}~\rightarrow{}~\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{""}~$\ocwlowerid{w}~]~];$\ocweol
\ocwindent{0.00em}
$\ocwupperid{END}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_to\_tex}~=~\ocwlowerid{transducer}~\ocwlowerid{tex\_word}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{}*****************************************************************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Roman with diacritics, HTML decimal encoding for Unicode points \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}*****************************************************************\ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{html\_code}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"skt\ocwvspace{}to\ocwvspace{}html\ocwvspace{}code"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{html}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"skt\ocwvspace{}to\ocwvspace{}html"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwupperid{EXTEND}~\ocwupperid{Gram}~$\ocwbc{} skt to HTML string \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{html\_code}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~$\ocwstring{"\&\#7749;"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"f"}~$\rightarrow{}~$\ocwstring{"\&\#7749;"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"F"}~$\rightarrow{}~$\ocwstring{"f"}~\ocwbc{} patch for latin \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~$\ocwstring{"\&\#347;"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"z"}~$\rightarrow{}~$\ocwstring{"\&\#347;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"S"}~$\rightarrow{}~$\ocwstring{"\&\#346;"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"Z"}~$\rightarrow{}~$\ocwstring{"\&\#346;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~$\ocwstring{"\&\#7745;"}~\ocwbc{} candrabindu as m with dot above \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~$\ocwstring{"a"}~\ocwbc{} we lose accents \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~$\ocwstring{"i"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~$\ocwstring{"u"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"e"}~$\rightarrow{}~$\ocwstring{"e"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"o"}~$\rightarrow{}~$\ocwstring{"o"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~$\ocwstring{"\&\#257;"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~$\ocwstring{"a"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"A"};~$\ocwupperid{LETTER}~$\ocwstring{"A"}~$\rightarrow{}~$\ocwstring{"\&\#256;"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"A"}~$\rightarrow{}~$\ocwstring{"A"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~$\ocwstring{"\&\#299;"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~$\ocwstring{"i"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"I"};~$\ocwupperid{LETTER}~$\ocwstring{"I"}~$\rightarrow{}~$\ocwstring{"\&\#298;"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"I"}~$\rightarrow{}~$\ocwstring{"I"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~$\ocwstring{"\&\#363;"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~$\ocwstring{"u"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"U"};~$\ocwupperid{LETTER}~$\ocwstring{"U"}~$\rightarrow{}~$\ocwstring{"\&\#362;"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"U"}~$\rightarrow{}~$\ocwstring{"U"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\~{}"};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~$\ocwstring{"\&\#241;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\~{}"};~\ocwstring{"\~{}"}~$\rightarrow{}~$\ocwstring{"\&\#7745;"}~\ocwbc{} candrabindu  \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"+"}~$\rightarrow{}~$\ocwstring{""}~\ocwbc{} \ocwstring{"\symbol{92}\&\#173;"} = \&shy; cesure prints - \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\$"}~$\rightarrow{}~$\ocwstring{"\_"}~\ocwbc{} pra-uga \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\_"}~$\rightarrow{}~$\ocwstring{"\_"}~\ocwbc{} hiatus \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{45}"}~$\rightarrow{}~$\ocwstring{"\symbol{45}"}~\ocwbc{} prefix \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\&"}~$\rightarrow{}~$\ocwstring{"\&amp;"}~\ocwbc{} reserved \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"}~$\rightarrow{}~$\ocwstring{"'"}~\ocwbc{} avagraha \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~\ocwstring{"."};~\ocwstring{"."}~$\rightarrow{}~$\ocwstring{"..."}~\ocwbc{} ... \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"t"}~$\rightarrow{}~$\ocwstring{"\&\#7789;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"d"}~$\rightarrow{}~$\ocwstring{"\&\#7693;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~$\ocwstring{"\&\#7779;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"S"}~$\rightarrow{}~$\ocwstring{"\&\#7778;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~$\ocwstring{"\&\#7751;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"r"};~$\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~$\ocwstring{"\&\#7773;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~$\ocwstring{"\&\#7771;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"R"}~$\rightarrow{}~$\ocwstring{"\&\#7770;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"l"};~$\ocwupperid{LETTER}~$\ocwstring{"l"}~$\rightarrow{}~$\ocwstring{"\&\#7737;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"l"}~$\rightarrow{}~$\ocwstring{"\&\#7735;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~$\ocwstring{"\&\#7747;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~$\ocwstring{"\&\#7717;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"T"}~$\rightarrow{}~$\ocwstring{"\&\#7788;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"D"}~$\rightarrow{}~$\ocwstring{"\&\#7692;"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\#"};~$\ocwlowerid{i}~=~\ocwupperid{INT}~\rightarrow{}~$\ocwstring{"\_"}~\^{}~$\ocwlowerid{i}~$\ocwbc{} homonymy index \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"|"};~$\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~$\ocwstring{"|a"}~\ocwbc{} phantom phoneme *a \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"|"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~$\ocwstring{"|i"}~\ocwbc{} phantom phoneme *i \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"|"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~$\ocwstring{"|u"}~\ocwbc{} phantom phoneme *u \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"|"};~$\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~$\ocwstring{"|\&\#7771;"}~\ocwbc{} phantom phoneme *r \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"["};~\ocwstring{"\symbol{45}"};~\ocwstring{"]"}~$\rightarrow{}~$\ocwstring{"[\symbol{45}]"}~\ocwbc{} amuissement \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{i}~=~\ocwupperid{LETTER}~\rightarrow{}~\ocwlowerid{i}~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{i}~=~\ocwupperid{INT}~\rightarrow{}~\ocwlowerid{i}~$\ocweol
\ocwindent{2.00em}
$]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{html}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{w}~=~\ocwupperid{LIST0}~\ocwlowerid{html\_code};~`\ocwupperid{EOI}~\rightarrow{}~\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{""}~$\ocwlowerid{w}~]~];$\ocweol
\ocwindent{0.00em}
$\ocwupperid{END}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_to\_html}~=~\ocwlowerid{transducer}~\ocwlowerid{html}$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Inverse to \ocwbegindcode{}$\ocwupperid{Cgi}.\ocwlowerid{decode\_url}$\ocwenddcode{} 
\ocweol
\label{transduction.ml:6404}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{url\_letter}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"skt\ocwvspace{}to\ocwvspace{}url\ocwvspace{}letter"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{url}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"skt\ocwvspace{}to\ocwvspace{}url"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Important: accents and avagraha are removed from the input stream \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Should be isomorphic to \ocwbegindcode{}$\ocwlowerid{code\_rawu}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwupperid{EXTEND}~\ocwupperid{Gram}~$\ocwbc{} skt to url \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{url\_letter}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"\symbol{92}""}~$\rightarrow{}~$\ocwstring{"\%22"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\~{}"}~$\rightarrow{}~$\ocwstring{"\%7E"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\#"};~$\ocwlowerid{i}~=~\ocwupperid{INT}~\rightarrow{}~$\ocwstring{"\%23"}~\^{}~$\ocwlowerid{i}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"}~$\rightarrow{}~$\ocwstring{""}~\ocwbc{} accents and avagraha hidden \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}    | \ocwstring{"'"} {\R} \ocwstring{"\%27"} \ocwbc{} if preserved \ocwec{} \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."}~$\rightarrow{}~$\ocwstring{"."}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"+"}~$\rightarrow{}~$\ocwstring{""}~\ocwbc{} \ocwstring{"\%2B"} \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{45}"}~$\rightarrow{}~$\ocwstring{"\symbol{45}"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\ocwvspace{}"}~$\rightarrow{}~$\ocwstring{"+"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\_"}~$\rightarrow{}~$\ocwstring{"\_"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\$"}~$\rightarrow{}~$\ocwstring{"\%24"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{i}~=~\ocwupperid{LETTER}~\rightarrow{}~\ocwlowerid{i}~$\ocweol
\ocwindent{2.00em}
$]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{url}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{w}~=~\ocwupperid{LIST0}~\ocwlowerid{url\_letter};~`\ocwupperid{EOI}~\rightarrow{}~\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{""}~$\ocwlowerid{w}~]~];$\ocweol
\ocwindent{0.00em}
$\ocwupperid{END}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{encode\_url}~=~\ocwlowerid{transducer}~\ocwlowerid{url}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{}***********************************************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Devanagari in Velthuis devnag transliteration \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}***********************************************\ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{dev}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"dev\ocwvspace{}symbol"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{dev\_word}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"dev\ocwvspace{}word"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwupperid{EXTEND}~\ocwupperid{Gram}~$\ocwbc{} skt to devnag \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{dev}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~$\ocwstring{"\symbol{92}"n"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"f"}~$\rightarrow{}~$\ocwstring{"\symbol{92}"n"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~$\ocwstring{"/"}~\ocwbc{} candrabindu \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~$\ocwstring{"\symbol{92}"s"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"z"}~$\rightarrow{}~$\ocwstring{"\symbol{92}"s"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~$\ocwstring{"a"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~$\ocwstring{"i"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~$\ocwstring{"u"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"e"}~$\rightarrow{}~$\ocwstring{"e"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"o"}~$\rightarrow{}~$\ocwstring{"o"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~$\ocwstring{"aa"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~$\ocwstring{"a"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~$\ocwstring{"ii"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~$\ocwstring{"i"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~$\ocwstring{"uu"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~$\ocwstring{"u"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\~{}"};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~$\ocwstring{"\~{}n"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\~{}"};~\ocwstring{"\~{}"}~$\rightarrow{}~$\ocwstring{"/"}~\ocwbc{} candrabindu \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"+"}~$\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\$"}~$\rightarrow{}~$\ocwstring{"\$\$"}~\ocwbc{} hiatus \ocwec{}~\ocwbc{} \ocwstring{"\{\}"} in devnag 1.6 \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{45}"}~$\rightarrow{}~$\ocwstring{"@"}~\ocwbc{} suffix \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"}~$\rightarrow{}~$\ocwstring{".a"}~\ocwbc{} avagraha \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"t"}~$\rightarrow{}~$\ocwstring{".t"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"d"}~$\rightarrow{}~$\ocwstring{".d"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~$\ocwstring{".s"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~$\ocwstring{".n"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"r"};~$\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~$\ocwstring{".R"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~$\ocwstring{".r"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"l"}~$\rightarrow{}~$\ocwstring{".l"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~$\ocwstring{".m"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~$\ocwstring{".h"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\#"};~$\ocwupperid{INT}~\rightarrow{}~$\ocwstring{""}~\ocwbc{} homo index ignored \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{i}~=~\ocwupperid{LETTER}~\rightarrow{}~\ocwlowerid{i}$\ocweol
\ocwindent{2.00em}
$]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{dev\_word}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{w}~=~\ocwupperid{LIST0}~\ocwlowerid{dev};~`\ocwupperid{EOI}~\rightarrow{}~\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{""}~$\ocwlowerid{w}~]~];$\ocweol
\ocwindent{0.00em}
$\ocwupperid{END}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_to\_dev}~=~\ocwlowerid{transducer}~\ocwlowerid{dev\_word}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{}**************************************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Greek and math symbols, TeX encoding \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}**************************************\ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{texmath}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"math\ocwvspace{}in\ocwvspace{}tex"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{texmath\_word}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"math\ocwvspace{}in\ocwvspace{}tex\ocwvspace{}word"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwupperid{EXTEND}~\ocwupperid{Gram}~$\ocwbc{} Greek and Math to TeX \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{texmath}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}alpha"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"b"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}beta"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"c"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}gamma"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"C"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}Gamma"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"d"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}delta"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"D"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}Delta"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"e"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}epsilon"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"f"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}phi"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"F"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}Phi"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"g"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}psi"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"G"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}Psi"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}theta"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"H"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}Theta"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}iota"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"k"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}kappa"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"K"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}rm\ocwvspace{}K\}"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"l"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}lambda"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"L"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}Lambda"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}mu"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}nu"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"o"}~$\rightarrow{}~$\ocwstring{"\ocwvspace{}o"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"O"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}rm\ocwvspace{}O\}"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"p"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}pi"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"P"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}Pi"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"q"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}chi"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}rho"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}sigma"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"S"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}Sigma"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"t"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}tau"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}upsilon"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"U"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}Upsilon"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"v"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}varsigma"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"w"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}omega"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"W"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}Omega"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"x"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}xi"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"X"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}Xi"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"y"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}eta"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"z"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}zeta"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"Z"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}rm\ocwvspace{}Z\}"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"*"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}times\}"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"+"}~$\rightarrow{}~$\ocwstring{"+"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"@"}~$\rightarrow{}~$\ocwstring{"\{\}\^{}\{\symbol{92}\symbol{92}circ\}"}~\ocwbc{} degree \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"}~$\rightarrow{}~$\ocwstring{"'"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"|"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}mid\}"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"!"}~$\rightarrow{}~$\ocwstring{"\symbol{92}\symbol{92}!"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\~{}"}~$\rightarrow{}~$\ocwstring{"\{\symbol{92}\symbol{92}sim\}"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"="}~$\rightarrow{}~$\ocwstring{"="}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{","}~$\rightarrow{}~$\ocwstring{",\ocwvspace{}"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{i}~=~\ocwupperid{INT}~\rightarrow{}~\ocwlowerid{i}$\ocweol
\ocwindent{2.00em}
$]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{texmath\_word}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{w}~=~\ocwupperid{LIST0}~\ocwlowerid{texmath};~`\ocwupperid{EOI}~\rightarrow{}~\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{""}~$\ocwlowerid{w}~]~];$\ocweol
\ocwindent{0.00em}
$\ocwupperid{END}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{math\_to\_tex}~=~\ocwlowerid{transducer}~\ocwlowerid{texmath\_word}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{}***************************************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Greek and math symbols, HTML encoding \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}***************************************\ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{htmlmath}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"math\ocwvspace{}in\ocwvspace{}html"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{htmlmath\_word}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"math\ocwvspace{}in\ocwvspace{}html\ocwvspace{}word"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwupperid{EXTEND}~\ocwupperid{Gram}~$\ocwbc{} greek and math to html \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{htmlmath}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~$\ocwstring{"\&\#945;"}~\ocwbc{} \ocwstring{"\symbol{92}\&alpha;"}   \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"b"}~$\rightarrow{}~$\ocwstring{"\&\#946;"}~\ocwbc{} \ocwstring{"\symbol{92}\&beta;"}    \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"c"}~$\rightarrow{}~$\ocwstring{"\&\#947;"}~\ocwbc{} \ocwstring{"\symbol{92}\&gamma;"}   \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"C"}~$\rightarrow{}~$\ocwstring{"\&\#915;"}~\ocwbc{} \ocwstring{"\symbol{92}\&Gamma;"}   \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"d"}~$\rightarrow{}~$\ocwstring{"\&\#948;"}~\ocwbc{} \ocwstring{"\symbol{92}\&delta;"}   \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"D"}~$\rightarrow{}~$\ocwstring{"\&\#916;"}~\ocwbc{} \ocwstring{"\symbol{92}\&Delta;"}   \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"e"}~$\rightarrow{}~$\ocwstring{"\&\#949;"}~\ocwbc{} \ocwstring{"\symbol{92}\&epsilon;"} \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"f"}~$\rightarrow{}~$\ocwstring{"\&\#966;"}~\ocwbc{} \ocwstring{"\symbol{92}\&phi;"}     \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"F"}~$\rightarrow{}~$\ocwstring{"\&\#934;"}~\ocwbc{} \ocwstring{"\symbol{92}\&Phi;"}     \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"g"}~$\rightarrow{}~$\ocwstring{"\&\#968;"}~\ocwbc{} \ocwstring{"\symbol{92}\&psi;"}     \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"G"}~$\rightarrow{}~$\ocwstring{"\&\#936;"}~\ocwbc{} \ocwstring{"\symbol{92}\&Psi;"}     \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~$\ocwstring{"\&\#952;"}~\ocwbc{} \ocwstring{"\symbol{92}\&theta;"}   \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"H"}~$\rightarrow{}~$\ocwstring{"\&\#920;"}~\ocwbc{} \ocwstring{"\symbol{92}\&Theta;"}   \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~$\ocwstring{"\&\#953;"}~\ocwbc{} \ocwstring{"\symbol{92}\&iota;"}    \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"k"}~$\rightarrow{}~$\ocwstring{"\&\#954;"}~\ocwbc{} \ocwstring{"\symbol{92}\&kappa;"}   \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"K"}~$\rightarrow{}~$\ocwstring{"\&\#922;"}~\ocwbc{} \ocwstring{"\symbol{92}\&Kappa;"}   \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"l"}~$\rightarrow{}~$\ocwstring{"\&\#955;"}~\ocwbc{} \ocwstring{"\symbol{92}\&lambda;"}  \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"L"}~$\rightarrow{}~$\ocwstring{"\&\#923;"}~\ocwbc{} \ocwstring{"\symbol{92}\&Lambda;"}  \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~$\ocwstring{"\&\#956;"}~\ocwbc{} \ocwstring{"\symbol{92}\&mu;"}      \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~$\ocwstring{"\&\#957;"}~\ocwbc{} \ocwstring{"\symbol{92}\&nu;"}      \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"o"}~$\rightarrow{}~$\ocwstring{"\&\#959;"}~\ocwbc{} \ocwstring{"\symbol{92}\&omicron;"} \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"O"}~$\rightarrow{}~$\ocwstring{"\&\#927;"}~\ocwbc{} \ocwstring{"\symbol{92}\&Omicron;"} \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"p"}~$\rightarrow{}~$\ocwstring{"\&\#960;"}~\ocwbc{} \ocwstring{"\symbol{92}\&pi;"}      \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"P"}~$\rightarrow{}~$\ocwstring{"\&\#960;"}~\ocwbc{} \ocwstring{"\symbol{92}\&Pi;"}      \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"q"}~$\rightarrow{}~$\ocwstring{"\&\#967;"}~\ocwbc{} \ocwstring{"\symbol{92}\&chi;"}     \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~$\ocwstring{"\&\#961;"}~\ocwbc{} \ocwstring{"\symbol{92}\&rho;"}     \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~$\ocwstring{"\&\#963;"}~\ocwbc{} \ocwstring{"\symbol{92}\&sigma;"}   \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"S"}~$\rightarrow{}~$\ocwstring{"\&\#931;"}~\ocwbc{} \ocwstring{"\symbol{92}\&Sigma;"}   \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"t"}~$\rightarrow{}~$\ocwstring{"\&\#964;"}~\ocwbc{} \ocwstring{"\symbol{92}\&tau;"}     \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~$\ocwstring{"\&\#965;"}~\ocwbc{} \ocwstring{"\symbol{92}\&upsilon;"} \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"U"}~$\rightarrow{}~$\ocwstring{"\&\#933;"}~\ocwbc{} \ocwstring{"\symbol{92}\&Upsilon;"} \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"v"}~$\rightarrow{}~$\ocwstring{"\&\#962;"}~\ocwbc{} \ocwstring{"\symbol{92}\&sigmaf"}   \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"w"}~$\rightarrow{}~$\ocwstring{"\&\#969;"}~\ocwbc{} \ocwstring{"\symbol{92}\&omega;"}   \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"W"}~$\rightarrow{}~$\ocwstring{"\&\#937;"}~\ocwbc{} \ocwstring{"\symbol{92}\&Omega;"}   \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"x"}~$\rightarrow{}~$\ocwstring{"\&\#958;"}~\ocwbc{} \ocwstring{"\symbol{92}\&xi;"}      \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"X"}~$\rightarrow{}~$\ocwstring{"\&\#926;"}~\ocwbc{} \ocwstring{"\symbol{92}\&Xi;"}      \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"y"}~$\rightarrow{}~$\ocwstring{"\&\#951;"}~\ocwbc{} \ocwstring{"\symbol{92}\&eta;"}     \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"z"}~$\rightarrow{}~$\ocwstring{"\&\#950;"}~\ocwbc{} \ocwstring{"\symbol{92}\&zeta;"}    \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"Z"}~$\rightarrow{}~$\ocwstring{"\&\#918;"}~\ocwbc{} \ocwstring{"\symbol{92}\&Zeta;"}    \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"*"}~$\rightarrow{}~$\ocwstring{"\&\#215;"}~\ocwbc{} \ocwstring{"\symbol{92}\&times;"}   \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"+"}~$\rightarrow{}~$\ocwstring{"+"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"@"}~$\rightarrow{}~$\ocwstring{"\&\#176;"}~\ocwbc{} \ocwstring{"\symbol{92}\&deg;"}     \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"}~$\rightarrow{}~$\ocwstring{"\&\#8242;"}~\ocwbc{} \ocwstring{"\symbol{92}\&prime;"}   \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"|"}~$\rightarrow{}~$\ocwstring{"|"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"!"}~$\rightarrow{}~$\ocwstring{"!"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\~{}"}~$\rightarrow{}~$\ocwstring{"\~{}"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"="}~$\rightarrow{}~$\ocwstring{"="}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{","}~$\rightarrow{}~$\ocwstring{",\ocwvspace{}"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{i}~=~\ocwupperid{INT}~\rightarrow{}~\ocwlowerid{i}$\ocweol
\ocwindent{2.00em}
$]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{htmlmath\_word}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{w}~=~\ocwupperid{LIST0}~\ocwlowerid{htmlmath};~`\ocwupperid{EOI}~\rightarrow{}~\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{""}~$\ocwlowerid{w}~]~];$\ocweol
\ocwindent{0.00em}
$\ocwupperid{END}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{math\_to\_html}~=~\ocwlowerid{transducer}~\ocwlowerid{htmlmath\_word}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{}********************************************************************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Numeric code encoding, for devanagari sorting and other processing \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}********************************************************************\ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{lower}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"lower\ocwvspace{}case\ocwvspace{}as\ocwvspace{}letter\ocwvspace{}VH"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{word}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"word\ocwvspace{}VH"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{wx}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"letter\ocwvspace{}WX"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{wordwx}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"word\ocwvspace{}WX"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{kh}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"letter\ocwvspace{}KH"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{wordkh}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"word\ocwvspace{}KH"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sl}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"letter\ocwvspace{}SL"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{wordsl}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"word\ocwvspace{}SL"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwupperid{EXTEND}~\ocwupperid{Gram}~$\ocwbc{} skt to nat \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{lower}:~$\ocwbc{} removes accents, keeps initial quote as avagraha \ocwec{}\ocweol
\ocwindent{2.00em}
$[~[~\ocwupperid{LETTER}~$\ocwstring{"f"}~$\rightarrow{}~21~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~21~$\ocwbc{} compat Velthuis \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"z"}~$\rightarrow{}~46~$\ocwbc{} ziva \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~46~$\ocwbc{} compat Velthuis \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"G"}~$\rightarrow{}~21~$\ocwbc{} compat KH \ocwec{}\ocwbc{} inconsistent with upper \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"M"}~$\rightarrow{}~14$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"H"}~$\rightarrow{}~16$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"R"}~$\rightarrow{}~7$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"S"}~$\rightarrow{}~47$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~15~$\ocwbc{} compat Velthuis \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\~{}"};~\ocwstring{"\~{}"}~$\rightarrow{}~15~$\ocwbc{} candrabindu \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\~{}"};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~26$\ocweol
\ocwindent{0.00em}
\ocwbc{} OBS | \ocwstring{"+"}; c=lower -> c \ocwbc{} prevent hyphenation in TeX \ocwec{} \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{45}"}~$\rightarrow{}~0~$\ocwbc{} notation for affixing \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"+"}~$\rightarrow{}~-10~$\ocwbc{} notation for compounding \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\&"}~$\rightarrow{}~-1~$\ocwbc{} \& = alternate avagraha preserved - legacy \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\_"}~$\rightarrow{}~50~$\ocwbc{} sentential hiatus \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~2~$\ocwbc{} accented vowels - accent is lost \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~11$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~13$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"a"};~\ocwstring{"\$"}~$\rightarrow{}~1~$\ocwbc{} pr'a-uga \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~1~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~3$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~5$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"e"}~$\rightarrow{}~10$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"o"};~\ocwstring{"\$"}~$\rightarrow{}~12~$\ocwbc{} g'o-agra \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwupperid{LETTER}~$\ocwstring{"o"}~$\rightarrow{}~12$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"}~$\rightarrow{}~-1~$\ocwbc{} avagraha \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~\ocwstring{"."};~\ocwstring{"."};~$\ocwlowerid{c}=\ocwlowerid{lower}~\rightarrow{}~\ocwlowerid{c}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"t"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~28$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"t"}~$\rightarrow{}~27$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"d"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~30$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"d"}~$\rightarrow{}~29$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~47$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~31$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"r"};~$\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~8$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~7$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"l"}~$\rightarrow{}~9$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~14$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~16$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{":"}~$\rightarrow{}~16~$\ocwbc{} alternate notation for vigraha \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"};~\ocwstring{"|"};~$\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~-3~$\ocwbc{} *a \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"};~\ocwstring{"|"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~-4~$\ocwbc{} *i \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"};~\ocwstring{"|"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~-5~$\ocwbc{} *u \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"};~\ocwstring{"|"};~$\ocwupperid{LETTER}~$\ocwstring{"A"}~$\rightarrow{}~-9~$\ocwbc{} *a \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"};~\ocwstring{"|"};~$\ocwupperid{LETTER}~$\ocwstring{"I"}~$\rightarrow{}~-7~$\ocwbc{} *i \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"};~\ocwstring{"|"};~$\ocwupperid{LETTER}~$\ocwstring{"U"}~$\rightarrow{}~-8~$\ocwbc{} *u \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"};~\ocwstring{"|"};~$\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~-6~$\ocwbc{} *r \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~2$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~11$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~13$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~\ocwstring{"\$"}~$\rightarrow{}~1~$\ocwbc{} pra-ucya \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~1$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~4$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~3$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~6$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~5$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"e"}~$\rightarrow{}~10$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"o"};~\ocwstring{"\$"}~$\rightarrow{}~12~$\ocwbc{} go-agraa \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"o"}~$\rightarrow{}~12$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"k"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~18$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"k"}~$\rightarrow{}~17$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"g"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~20$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"g"}~$\rightarrow{}~19$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"c"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~23$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"c"}~$\rightarrow{}~22$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"j"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~25$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"j"}~$\rightarrow{}~24$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"t"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~33$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"t"}~$\rightarrow{}~32$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"d"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~35$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"d"}~$\rightarrow{}~34$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"p"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~38$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"p"}~$\rightarrow{}~37$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"b"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~40$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"b"}~$\rightarrow{}~39$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~36$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~41$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"y"}~$\rightarrow{}~42$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~43$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"l"}~$\rightarrow{}~44$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"v"}~$\rightarrow{}~45$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~48$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~49$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\#"};~$\ocwlowerid{i}~=~\ocwupperid{INT}~\rightarrow{}~50+\ocwlowerid{int\_of\_string}~\ocwlowerid{i}~$\ocwbc{} 0 \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"["};~\ocwstring{"\symbol{45}"};~\ocwstring{"]"}~$\rightarrow{}~-2~$\ocwbc{} amuissement \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}   Special codes 
     code 50 hiatus Canon.decode \ocwbegindcode{}50\ocwenddcode{} = \ocwstring{"\_"} 
     codes 51 to 59 - 9 homonymy indexes 
     code -1 -> \ocwstring{"'"} \ocwbc{} avagraha \ocwec{}
     code -2 -> \ocwstring{"[\symbol{45}]"} \ocwbc{} amuissement \ocwec{}
     code -3 -> \ocwstring{"aa|a"} \ocwbc{} sandhi of aa and a \ocwec{}
     code -4 -> \ocwstring{"aa|i"} \ocwbc{} sandhi of aa and i \ocwec{}
     code -5 -> \ocwstring{"aa|u"} \ocwbc{} sandhi of aa and u \ocwec{}
     code -6 -> \ocwstring{"aa|r"} \ocwbc{} sandhi of aa and .r \ocwec{}
     code -7 -> \ocwstring{"aa|I"} \ocwbc{} sandhi of aa and ii \ocwec{}
     code -8 -> \ocwstring{"aa|U"} \ocwbc{} sandhi of aa and uu \ocwec{}
     code -9 -> \ocwstring{"aa|A"} \ocwbc{} sandhi of aa and aa \ocwec{}
     codes 101 to 149 reserved for upper case encodings in \ocwbegindcode{}$\ocwupperid{Canon}.\ocwlowerid{decode\_ref}$\ocwenddcode{}
     codes 124, 149, 249 used for variants resp. j' of j 24 and h',h'' of h 49 
           in \ocwbegindcode{}$\ocwupperid{Int\_sandhi}$\ocwenddcode{}  \ocwec{}\ocweol
\ocwindent{2.00em}
$]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{word}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{w}~=~\ocwupperid{LIST0}~\ocwlowerid{lower};~`\ocwupperid{EOI}~\rightarrow{}~\ocwlowerid{w}~]~];~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{wx}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~1$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"A"}~$\rightarrow{}~2~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~3$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"I"}~$\rightarrow{}~4$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~5$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"U"}~$\rightarrow{}~6$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"q"}~$\rightarrow{}~7$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"Q"}~$\rightarrow{}~8$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"L"}~$\rightarrow{}~9$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"e"}~$\rightarrow{}~10$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"E"}~$\rightarrow{}~11$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"o"}~$\rightarrow{}~12$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"O"}~$\rightarrow{}~13~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"M"}~$\rightarrow{}~14$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"z"}~$\rightarrow{}~15~$\ocwbc{} candrabindu \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"H"}~$\rightarrow{}~16$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"k"}~$\rightarrow{}~17$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"K"}~$\rightarrow{}~18~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"g"}~$\rightarrow{}~19$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"G"}~$\rightarrow{}~20~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"f"}~$\rightarrow{}~21$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"c"}~$\rightarrow{}~22$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"C"}~$\rightarrow{}~23$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"j"}~$\rightarrow{}~24$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"J"}~$\rightarrow{}~25~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"F"}~$\rightarrow{}~26$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"t"}~$\rightarrow{}~27~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"T"}~$\rightarrow{}~28$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"d"}~$\rightarrow{}~29$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"D"}~$\rightarrow{}~30~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"N"}~$\rightarrow{}~31~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"w"}~$\rightarrow{}~32$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"W"}~$\rightarrow{}~33$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"x"}~$\rightarrow{}~34$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"X"}~$\rightarrow{}~35$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~36$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"p"}~$\rightarrow{}~37$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"P"}~$\rightarrow{}~38$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"b"}~$\rightarrow{}~39$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"B"}~$\rightarrow{}~40$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~41$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"y"}~$\rightarrow{}~42$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~43$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"l"}~$\rightarrow{}~44$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"v"}~$\rightarrow{}~45$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"S"}~$\rightarrow{}~46$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"R"}~$\rightarrow{}~47$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~48$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~49$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{45}"}~$\rightarrow{}~0~$\ocwbc{} notation for affixing \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"+"}~$\rightarrow{}~-10~$\ocwbc{} notation for compounding \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\_"}~$\rightarrow{}~50~$\ocwbc{} sentential hiatus \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"Z"}~$\rightarrow{}~-1~$\ocwbc{} avagraha \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\#"};~$\ocwlowerid{i}~=~\ocwupperid{INT}~\rightarrow{}~50+\ocwlowerid{int\_of\_string}~\ocwlowerid{i}~$\ocwbc{} 0 \ocwec{}~\ocweol
\ocwindent{2.00em}
$]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{wordwx}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{w}~=~\ocwupperid{LIST0}~\ocwlowerid{wx};~`\ocwupperid{EOI}~\rightarrow{}~\ocwlowerid{w}~]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{kh}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwupperid{LETTER}~$\ocwstring{"A"}~$\rightarrow{}~2~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~3$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"I"}~$\rightarrow{}~4$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~5$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"U"}~$\rightarrow{}~6$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"R"};~$\ocwupperid{LETTER}~$\ocwstring{"R"}~$\rightarrow{}~8$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"R"}~$\rightarrow{}~7$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"L"}~$\rightarrow{}~9$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"e"}~$\rightarrow{}~10$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~11$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"o"}~$\rightarrow{}~12$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~13$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~1$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"M"}~$\rightarrow{}~14$\ocweol
\ocwindent{4.00em}
\ocwbc{} candrabindu absent \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"H"}~$\rightarrow{}~16$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"k"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~18$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"k"}~$\rightarrow{}~17$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"g"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~20$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"g"}~$\rightarrow{}~19$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"G"}~$\rightarrow{}~21$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"c"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~23$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"c"}~$\rightarrow{}~22$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"j"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~25$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"j"}~$\rightarrow{}~24$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"J"}~$\rightarrow{}~26$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"T"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~28$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"T"}~$\rightarrow{}~27~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"D"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~30$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"D"}~$\rightarrow{}~29$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"N"}~$\rightarrow{}~31$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"t"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~33$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"t"}~$\rightarrow{}~32~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"d"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~35$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"d"}~$\rightarrow{}~34$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~36$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"p"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~38$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"p"}~$\rightarrow{}~37$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"b"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~40$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"b"}~$\rightarrow{}~39$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~41$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"y"}~$\rightarrow{}~42$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~43$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"l"}~$\rightarrow{}~44$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"v"}~$\rightarrow{}~45$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"z"}~$\rightarrow{}~46$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"S"}~$\rightarrow{}~47$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~48$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~49$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"}~$\rightarrow{}~-1~$\ocwbc{} avagraha \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{45}"}~$\rightarrow{}~0~$\ocwbc{} notation for affixing \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"+"}~$\rightarrow{}~-10~$\ocwbc{} notation for compounding \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\_"}~$\rightarrow{}~50~$\ocwbc{} sentential hiatus \ocwec{}~\ocweol
\ocwindent{3.00em}
\ocwbc{} avagraha missing \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\#"};~$\ocwlowerid{i}~=~\ocwupperid{INT}~\rightarrow{}~50+\ocwlowerid{int\_of\_string}~\ocwlowerid{i}~$\ocwbc{} 0 \ocwec{}~\ocweol
\ocwindent{2.00em}
$]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{wordkh}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{w}~=~\ocwupperid{LIST0}~\ocwlowerid{kh};~`\ocwupperid{EOI}~\rightarrow{}~\ocwlowerid{w}~]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{sl}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~1$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"A"}~$\rightarrow{}~2~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~3$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"I"}~$\rightarrow{}~4$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~5$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"U"}~$\rightarrow{}~6$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"f"}~$\rightarrow{}~7$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"F"}~$\rightarrow{}~8$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"x"}~$\rightarrow{}~9$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"e"}~$\rightarrow{}~10$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"E"}~$\rightarrow{}~11$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"o"}~$\rightarrow{}~12$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"O"}~$\rightarrow{}~13$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"M"}~$\rightarrow{}~14$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\~{}"}~$\rightarrow{}~15$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"H"}~$\rightarrow{}~16$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"k"}~$\rightarrow{}~17$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"K"}~$\rightarrow{}~18$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"g"}~$\rightarrow{}~19$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"G"}~$\rightarrow{}~20$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"N"}~$\rightarrow{}~21$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"c"}~$\rightarrow{}~22$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"C"}~$\rightarrow{}~23$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"j"}~$\rightarrow{}~24$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"J"}~$\rightarrow{}~25$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"Y"}~$\rightarrow{}~26$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"w"}~$\rightarrow{}~27~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"W"}~$\rightarrow{}~28$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"q"}~$\rightarrow{}~29$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"Q"}~$\rightarrow{}~30$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"R"}~$\rightarrow{}~31$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"t"}~$\rightarrow{}~32$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"T"}~$\rightarrow{}~33$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"d"}~$\rightarrow{}~34$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"D"}~$\rightarrow{}~35$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~36$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"p"}~$\rightarrow{}~37$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"P"}~$\rightarrow{}~38$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"b"}~$\rightarrow{}~39$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"B"}~$\rightarrow{}~40$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~41$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"y"}~$\rightarrow{}~42$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~43$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"l"}~$\rightarrow{}~44$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"v"}~$\rightarrow{}~45$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"S"}~$\rightarrow{}~46$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"z"}~$\rightarrow{}~47$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~48$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~49$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"}~$\rightarrow{}~-1~$\ocwbc{} avagraha \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{45}"}~$\rightarrow{}~0~$\ocwbc{} notation for affixing \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"+"}~$\rightarrow{}~-10~$\ocwbc{} notation for compounding \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\_"}~$\rightarrow{}~50~$\ocwbc{} sentential hiatus \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\#"};~$\ocwlowerid{i}~=~\ocwupperid{INT}~\rightarrow{}~50+\ocwlowerid{int\_of\_string}~\ocwlowerid{i}~$\ocwbc{} 0 \ocwec{}~\ocweol
\ocwindent{2.00em}
$]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{wordsl}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{w}~=~\ocwupperid{LIST0}~\ocwlowerid{sl};~\ocwupperid{OPT}~$\ocwstring{"."};~`$\ocwupperid{EOI}~\rightarrow{}~\ocwlowerid{w}~]~];$\ocweol
\ocwindent{0.00em}
$\ocwupperid{END}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{code\_raw}~\ocwlowerid{s}~=~$\ocwbc{} VH transliteration \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gram.}\ocwlowerid{parse\_string}~\ocwlowerid{word}~\ocwupperid{Loc.}\ocwlowerid{ghost}~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~\ocwlowerid{e}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwupperid{Format.}\ocwlowerid{eprintf}~$\ocwstring{"\symbol{92}nIn\ocwvspace{}string\ocwvspace{}\symbol{92}"\%s\symbol{92}",\ocwvspace{}at\ocwvspace{}location\ocwvspace{}\%s\ocwvspace{}:\symbol{92}n\%!"}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{s}~(\ocwupperid{Loc.}\ocwlowerid{to\_string}~\ocwlowerid{loc})$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{raise}~\ocwlowerid{e}$\ocweol
\ocwindent{2.50em}
\}~\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{code\_raw\_WX}~\ocwlowerid{s}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gram.}\ocwlowerid{parse\_string}~\ocwlowerid{wordwx}~\ocwupperid{Loc.}\ocwlowerid{ghost}~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~\ocwlowerid{e}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwupperid{Format.}\ocwlowerid{eprintf}~$\ocwstring{"\symbol{92}nIn\ocwvspace{}string\ocwvspace{}\symbol{92}"\%s\symbol{92}",\ocwvspace{}at\ocwvspace{}location\ocwvspace{}\%s\ocwvspace{}:\symbol{92}n\%!"}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{s}~(\ocwupperid{Loc.}\ocwlowerid{to\_string}~\ocwlowerid{loc})$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{raise}~\ocwlowerid{e}$\ocweol
\ocwindent{2.50em}
\}~\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{code\_raw\_KH}~\ocwlowerid{s}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gram.}\ocwlowerid{parse\_string}~\ocwlowerid{wordkh}~\ocwupperid{Loc.}\ocwlowerid{ghost}~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~\ocwlowerid{e}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwupperid{Format.}\ocwlowerid{eprintf}~$\ocwstring{"\symbol{92}nIn\ocwvspace{}string\ocwvspace{}\symbol{92}"\%s\symbol{92}",\ocwvspace{}at\ocwvspace{}location\ocwvspace{}\%s\ocwvspace{}:\symbol{92}n\%!"}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{s}~(\ocwupperid{Loc.}\ocwlowerid{to\_string}~\ocwlowerid{loc})$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{raise}~\ocwlowerid{e}$\ocweol
\ocwindent{2.50em}
\}~\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{code\_raw\_SL}~\ocwlowerid{s}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gram.}\ocwlowerid{parse\_string}~\ocwlowerid{wordsl}~\ocwupperid{Loc.}\ocwlowerid{ghost}~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~\ocwlowerid{e}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwupperid{Format.}\ocwlowerid{eprintf}~$\ocwstring{"\symbol{92}nIn\ocwvspace{}string\ocwvspace{}\symbol{92}"\%s\symbol{92}",\ocwvspace{}at\ocwvspace{}location\ocwvspace{}\%s\ocwvspace{}:\symbol{92}n\%!"}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{s}~(\ocwupperid{Loc.}\ocwlowerid{to\_string}~\ocwlowerid{loc})$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{raise}~\ocwlowerid{e}$\ocweol
\ocwindent{2.50em}
\}~\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{}************************************************************************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} The following gives codes to proper names, starting with upper letters \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}************************************************************************\ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{upper\_lower}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"upper\ocwvspace{}case"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{wordu}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"wordu"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwupperid{EXTEND}~\ocwupperid{Gram}~$\ocwbc{} skt to nat \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{upper\_lower}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"S"}~$\rightarrow{}~146$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"Z"}~$\rightarrow{}~146$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"A"};~$\ocwupperid{LETTER}~$\ocwstring{"A"}~$\rightarrow{}~102$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"A"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~111$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"A"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~113$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"A"}~$\rightarrow{}~101$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"I"};~$\ocwupperid{LETTER}~$\ocwstring{"I"}~$\rightarrow{}~104$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"I"}~$\rightarrow{}~103$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"U"};~$\ocwupperid{LETTER}~$\ocwstring{"U"}~$\rightarrow{}~106$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"U"}~$\rightarrow{}~105$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"S"}~$\rightarrow{}~147$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"R"}~$\rightarrow{}~107$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"T"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~128$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"T"}~$\rightarrow{}~127$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"D"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~130$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"D"}~$\rightarrow{}~129$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"E"}~$\rightarrow{}~110$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"O"}~$\rightarrow{}~112$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"K"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~118$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"K"}~$\rightarrow{}~117$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"G"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~120$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"G"}~$\rightarrow{}~119$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"C"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~123$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"C"}~$\rightarrow{}~122$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"J"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~125$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"J"}~$\rightarrow{}~124$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"T"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~133$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"T"}~$\rightarrow{}~132$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"D"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~135$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"D"}~$\rightarrow{}~134$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"N"}~$\rightarrow{}~136$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"P"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~138$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"P"}~$\rightarrow{}~137$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"B"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~140$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"B"}~$\rightarrow{}~139$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"M"}~$\rightarrow{}~141$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"Y"}~$\rightarrow{}~142$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"R"}~$\rightarrow{}~143$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"L"}~$\rightarrow{}~144$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"V"}~$\rightarrow{}~145$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"S"}~$\rightarrow{}~148$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"H"}~$\rightarrow{}~149~$\ocweol
\ocwindent{0.00em}
\ocwbc{} duplication with lower necessary in order to get proper sharing of prefix \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~21$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"f"}~$\rightarrow{}~21$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~46$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"z"}~$\rightarrow{}~46$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\~{}"};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~26$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\~{}"};~\ocwstring{"\~{}"}~$\rightarrow{}~15$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"+"};~$\ocwlowerid{c}=\ocwlowerid{upper\_lower}~\rightarrow{}~\ocwlowerid{c}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{45}"}~$\rightarrow{}~0$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\_"}~$\rightarrow{}~50~$\ocwbc{} hiatus \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\$"};~$\ocwlowerid{c}=\ocwlowerid{upper\_lower}~\rightarrow{}~\ocwlowerid{c}~$\ocwbc{} word hiatus for VH trans pra-uga \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwlowerid{c}=\ocwlowerid{upper\_lower}~\rightarrow{}~\ocwlowerid{c}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~\ocwstring{"."};~\ocwstring{"."};~$\ocwlowerid{c}=\ocwlowerid{upper\_lower}~\rightarrow{}~\ocwlowerid{c}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"t"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~28$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"t"}~$\rightarrow{}~27$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"d"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~30$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"d"}~$\rightarrow{}~29$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~47$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~31$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"r"};~$\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~8$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~7$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"l"}~$\rightarrow{}~9$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~14$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~16$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~2$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~11$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~13$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~1$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~4$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~3$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~6$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~5$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"e"}~$\rightarrow{}~10$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"o"}~$\rightarrow{}~12$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"k"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~18$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"k"}~$\rightarrow{}~17$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"g"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~20$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"g"}~$\rightarrow{}~19$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"c"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~23$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"c"}~$\rightarrow{}~22$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"j"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~25$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"j"}~$\rightarrow{}~24$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"t"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~33$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"t"}~$\rightarrow{}~32$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"d"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~35$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"d"}~$\rightarrow{}~34$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"p"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~38$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"p"}~$\rightarrow{}~37$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"b"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~40$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"b"}~$\rightarrow{}~39$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~36$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~41$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"y"}~$\rightarrow{}~42$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~43$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"l"}~$\rightarrow{}~44$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"v"}~$\rightarrow{}~45$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~48$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~49$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\#"};~$\ocwlowerid{i}~=~\ocwupperid{INT}~\rightarrow{}~50+\ocwlowerid{int\_of\_string}~\ocwlowerid{i}$\ocweol
\ocwindent{2.00em}
$]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{wordu}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{w}~=~\ocwupperid{LIST0}~\ocwlowerid{upper\_lower};~`\ocwupperid{EOI}~\rightarrow{}~\ocwlowerid{w}~]~];$\ocweol
\ocwindent{0.00em}
$\ocwupperid{END}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Similar to \ocwbegindcode{}$\ocwlowerid{code\_raw}$\ocwenddcode{} but accepts upper letters. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{code\_rawu}~\ocwlowerid{s}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gram.}\ocwlowerid{parse\_string}~\ocwlowerid{wordu}~\ocwupperid{Loc.}\ocwlowerid{ghost}~\ocwlowerid{s}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~\ocwlowerid{e}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwupperid{Format.}\ocwlowerid{eprintf}~$\ocwstring{"\symbol{92}nIn\ocwvspace{}string\ocwvspace{}\symbol{92}"\%s\symbol{92}",\ocwvspace{}at\ocwvspace{}location\ocwvspace{}\%s\ocwvspace{}:\symbol{92}n\%!"}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{s}~(\ocwupperid{Loc.}\ocwlowerid{to\_string}~\ocwlowerid{loc})$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{raise}~\ocwlowerid{e}$\ocweol
\ocwindent{2.50em}
\}~\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Simplified mapping for matching without diacritics 
\ocweol
\label{transduction.ml:27917}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{simplified}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"simplified"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{wordd}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"wordd"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwupperid{EXTEND}~\ocwupperid{Gram}~$\ocwbc{} skt to nat \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{simplified}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"S"}~$\rightarrow{}~148$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"Z"}~$\rightarrow{}~148$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"A"};~$\ocwupperid{LETTER}~$\ocwstring{"A"}~$\rightarrow{}~101$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"A"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~111$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"A"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~113$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"A"}~$\rightarrow{}~101$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"I"};~$\ocwupperid{LETTER}~$\ocwstring{"I"}~$\rightarrow{}~103$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"I"}~$\rightarrow{}~103$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"U"};~$\ocwupperid{LETTER}~$\ocwstring{"U"}~$\rightarrow{}~105$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"U"}~$\rightarrow{}~105$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"S"}~$\rightarrow{}~148$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"R"}~$\rightarrow{}~143$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"T"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~132$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"T"}~$\rightarrow{}~132$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"D"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~134$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"D"}~$\rightarrow{}~134$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"E"}~$\rightarrow{}~110$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"O"}~$\rightarrow{}~112$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"K"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~117$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"K"}~$\rightarrow{}~117$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"G"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~119$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"G"}~$\rightarrow{}~119$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"C"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~122$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"C"}~$\rightarrow{}~122$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"J"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~124$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"J"}~$\rightarrow{}~124$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"T"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~132$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"T"}~$\rightarrow{}~132$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"D"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~134$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"D"}~$\rightarrow{}~134$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"N"}~$\rightarrow{}~136$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"P"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~137$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"P"}~$\rightarrow{}~137$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"B"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~139$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"B"}~$\rightarrow{}~139$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"M"}~$\rightarrow{}~141$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"Y"}~$\rightarrow{}~142$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"R"}~$\rightarrow{}~143$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"L"}~$\rightarrow{}~144$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"V"}~$\rightarrow{}~145$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"S"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~148$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"S"}~$\rightarrow{}~148$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"H"}~$\rightarrow{}~149~$\ocweol
\ocwindent{0.00em}
\ocwbc{} duplication with lower necessary in order to get proper sharing of prefix \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~15~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~36$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"f"}~$\rightarrow{}~36$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{92}""};~$\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~48$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"z"}~$\rightarrow{}~48$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\~{}"};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~36$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\~{}"};~\ocwstring{"\~{}"}~$\rightarrow{}~15$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"+"};~$\ocwlowerid{c}=\ocwlowerid{upper\_lower}~\rightarrow{}~\ocwlowerid{c}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\symbol{45}"}~$\rightarrow{}~0$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\_"}~$\rightarrow{}~50~$\ocwbc{} hiatus \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"\$"};~$\ocwlowerid{c}=\ocwlowerid{upper\_lower}~\rightarrow{}~\ocwlowerid{c}~$\ocwbc{} word hiatus for VH trans pra-uga \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"'"};~$\ocwlowerid{c}=\ocwlowerid{upper\_lower}~\rightarrow{}~\ocwlowerid{c}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~\ocwstring{"."};~\ocwstring{"."};~$\ocwlowerid{c}=\ocwlowerid{upper\_lower}~\rightarrow{}~\ocwlowerid{c}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"t"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~32$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"t"}~$\rightarrow{}~32$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"d"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~34$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"d"}~$\rightarrow{}~34$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~48$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~36$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"r"};~$\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~43$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~43$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"l"}~$\rightarrow{}~44$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~41~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"."};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~49$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~1$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~11$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~13$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"a"}~$\rightarrow{}~1$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~3$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~3$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~5$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~5$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"e"}~$\rightarrow{}~10$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"o"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~5~$\ocwbc{} Vishnou \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"o"}~$\rightarrow{}~12$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"k"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~17$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"k"}~$\rightarrow{}~17$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"g"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~19$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"g"}~$\rightarrow{}~19$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"c"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~48~$\ocwbc{} Vichnou , Krichna \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"c"}~$\rightarrow{}~22$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"j"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~24$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"j"}~$\rightarrow{}~24$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"t"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~32$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"t"}~$\rightarrow{}~32$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"d"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~34$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"d"}~$\rightarrow{}~34$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"p"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~37$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"p"}~$\rightarrow{}~37$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"b"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~39$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"b"}~$\rightarrow{}~39$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"n"}~$\rightarrow{}~36$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"m"}~$\rightarrow{}~41$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"y"}~$\rightarrow{}~42$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"r"};~$\ocwupperid{LETTER}~$\ocwstring{"i"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~43~$\ocwbc{} consistency with: \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"r"};~$\ocwupperid{LETTER}~$\ocwstring{"i"}~$\rightarrow{}~43~$\ocwbc{} Krishna \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"r"};~$\ocwupperid{LETTER}~$\ocwstring{"u"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~43~$\ocwbc{} consistency with: \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"r"};~$\ocwupperid{LETTER}~$\ocwstring{"u"}~$\rightarrow{}~43~$\ocwbc{} vikruti \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"r"}~$\rightarrow{}~43$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"l"}~$\rightarrow{}~44$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"v"}~$\rightarrow{}~45$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"s"};~$\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~48$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"s"}~$\rightarrow{}~48$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{LETTER}~$\ocwstring{"h"}~$\rightarrow{}~49$\ocweol
\ocwindent{2.00em}
$]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{wordd}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{w}~=~\ocwupperid{LIST0}~\ocwlowerid{simplified};~`\ocwupperid{EOI}~\rightarrow{}~\ocwlowerid{w}~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{w}~=~\ocwupperid{LIST0}~\ocwlowerid{simplified};~$\ocwstring{"\#"};~$\ocwupperid{INT};~`\ocwupperid{EOI}~\rightarrow{}~\ocwlowerid{w}~$\ocwbc{} homo index ignored \ocwec{}\ocweol
\ocwindent{2.00em}
$]~];$\ocweol
\ocwindent{0.00em}
$\ocwupperid{END}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Similar to \ocwbegindcode{}$\ocwlowerid{code\_skt\_ref}$\ocwenddcode{} but simplified (no diacritics) \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{code\_rawd}~\ocwlowerid{s}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gram.}\ocwlowerid{parse\_string}~\ocwlowerid{wordd}~\ocwupperid{Loc.}\ocwlowerid{ghost}~\ocwlowerid{s}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~\ocwlowerid{e}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwupperid{Format.}\ocwlowerid{eprintf}~$\ocwstring{"\symbol{92}nIn\ocwvspace{}string\ocwvspace{}\symbol{92}"\%s\symbol{92}",\ocwvspace{}at\ocwvspace{}location\ocwvspace{}\%s\ocwvspace{}:\symbol{92}n\%!"}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{s}~(\ocwupperid{Loc.}\ocwlowerid{to\_string}~\ocwlowerid{loc})$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{raise}~\ocwlowerid{e}$\ocweol
\ocwindent{2.50em}
\}~\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Encode.ml}
\ocwmodule{Encode}
\label{encode.ml:0}%
Defines various encodings of transliterated strings into words as int lists 
\ocweol
\label{encode.ml:734}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Transduction};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{code\_raw}$\ocwenddcode{} and similar \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phonetics};~$\ocwbc{} homonasal vowel \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{In\_error}~$\ocwkw{of}~\ocwbt{string}~\ocwbc{} Error in user or corpus input \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{is\_vowel}~\ocwlowerid{c}~=~\ocwlowerid{vowel}~\ocwlowerid{c}~\lor{}~\ocwlowerid{c}>100~\land{}~\ocwlowerid{c}<114~$\ocwbc{} accounts for upper case \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} anusvara substituted by nasal or normalized to 14 when original \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{normalize}~=~\ocwlowerid{normal\_rec}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{normal\_rec}~\ocwlowerid{after\_vow}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~[\,]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~14~$\ocwbc{} .m \ocwec{}~::~$[\,]~]~\rightarrow{}~[~14~]~$\ocwbc{} and NOT m \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~14~$\ocwbc{} .m \ocwec{}~::~$[~\ocwlowerid{c}~::~\ocwlowerid{l}~]~]~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{after\_vow}~$\ocwkw{then}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{c'}~=~\ocwlowerid{homonasal}~\ocwlowerid{c}~$\ocwkw{in}~$[~\ocwlowerid{c'}~::~[~\ocwlowerid{c}~::~\ocwlowerid{normal\_rec}~(\ocwlowerid{is\_vowel}~\ocwlowerid{c})~\ocwlowerid{l}~]~]$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$\ocwlowerid{raise}~(\ocwupperid{In\_error}~$\ocwstring{"Anusvaara\ocwvspace{}should\ocwvspace{}follow\ocwvspace{}vowel"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~[~16~$\ocwbc{} .h \ocwec{}~::~$[\,]~]~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{after\_vow}~$\ocwkw{then}~$[~16~]$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$\ocwlowerid{raise}~(\ocwupperid{In\_error}~$\ocwstring{"Visarga\ocwvspace{}should\ocwvspace{}follow\ocwvspace{}vowel"}$)$\ocweol
\ocwindent{0.00em}
\ocwbc{} No change to visarga since eg praata.hsvasu.h comes from praatar|svasu.h
   and praatassvasu.h is not recognized. This is contrary to Henry§43 note 1. 
   corresponding to the following code: \ocwbegindcode{}
~$\mid{}~[~16~(\times{}~.\ocwlowerid{h}~\times{})~::~[~\ocwlowerid{c}~::~\ocwlowerid{l}~]~]~\rightarrow{}~
~$\ocwkw{if}~$\ocwlowerid{after\_vow}~$\ocwkw{then}~
~\ocwkw{let}~$\ocwlowerid{c'}~=~$\ocwkw{if}~$\ocwlowerid{sibilant}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{c}~$\ocwkw{else}~16~$(\times{}~\ocwlowerid{du}.\ocwlowerid{hkha}~\times{})~$\ocwkw{in}
~[~$\ocwlowerid{c'}~::~[~\ocwlowerid{c}~::~\ocwlowerid{normal\_rec}~(\ocwlowerid{is\_vowel}~\ocwlowerid{c})~\ocwlowerid{l}~]~]
~$\ocwkw{else}~$\ocwlowerid{raise}~(\ocwupperid{In\_error}~$\ocwstring{"Visarga\ocwvspace{}should\ocwvspace{}follow\ocwvspace{}vowel"}$)~$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~50~::~\ocwlowerid{l}~]~\rightarrow{}~[~50~::~\ocwlowerid{normal\_rec}~\ocwupperid{False}~\ocwlowerid{l}~]~$\ocwbc{} hiatus \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{l}~]~\rightarrow{}~[~\ocwlowerid{c}~::~\ocwlowerid{normal\_rec}~(\ocwlowerid{is\_vowel}~\ocwlowerid{c})~\ocwlowerid{l}~]~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{code\_string}~\ocwlowerid{str}~=~\ocwlowerid{normalize}~(\ocwlowerid{code\_raw}~\ocwlowerid{str})~$\ocwbc{} standard VH \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{code\_string\_WX}~\ocwlowerid{str}~=~\ocwlowerid{normalize}~(\ocwlowerid{code\_raw\_WX}~\ocwlowerid{str})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{code\_string\_KH}~\ocwlowerid{str}~=~\ocwlowerid{normalize}~(\ocwlowerid{code\_raw\_KH}~\ocwlowerid{str})~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{code\_string\_SL}~\ocwlowerid{str}~=~\ocwlowerid{normalize}~(\ocwlowerid{code\_raw\_SL}~\ocwlowerid{str})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{code\_skt\_ref}~\ocwlowerid{str}~=~\ocwlowerid{normalize}~(\ocwlowerid{code\_rawu}~\ocwlowerid{str})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{code\_skt\_ref\_d}~\ocwlowerid{str}~=~\ocwlowerid{normalize}~(\ocwlowerid{code\_rawd}~\ocwlowerid{str})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Switching code function according to transliteration convention \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{switch\_code}~=~$\ocwkw{fun}~\ocwbc{} normalizes anusvaara in its input \ocwec{}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"VH"}~$\rightarrow{}~\ocwlowerid{code\_string}~$\ocwbc{} \ocwbegindcode{}$\ocwupperid{Canon}.\ocwlowerid{decode}$\ocwenddcode{}    \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"WX"}~$\rightarrow{}~\ocwlowerid{code\_string\_WX}~$\ocwbc{} \ocwbegindcode{}$\ocwupperid{Canon}.\ocwlowerid{decode\_WX}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"KH"}~$\rightarrow{}~\ocwlowerid{code\_string\_KH}~$\ocwbc{} \ocwbegindcode{}$\ocwupperid{Canon}.\ocwlowerid{decode\_KH}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"SL"}~$\rightarrow{}~\ocwlowerid{code\_string\_SL}~$\ocwbc{} \ocwbegindcode{}$\ocwupperid{Canon}.\ocwlowerid{decode\_SL}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unknown\ocwvspace{}transliteration\ocwvspace{}scheme"}\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rev\_code\_string}~\ocwlowerid{str}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~(\ocwlowerid{code\_string}~\ocwlowerid{str})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{anchor}~:~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{string}\ocwenddcode{} -- used in \ocwbegindcode{}$\ocwupperid{Morpho\_html}.\ocwlowerid{url}$\ocwenddcode{} and Sanskrit \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{anchor}~\ocwlowerid{t}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{canon}~\ocwlowerid{c}~=~$\ocwkw{if}~$\ocwlowerid{c}>100~$\ocwkw{then}~$\ocwupperid{Canon.}\ocwlowerid{canon\_upper\_html}~\ocwlowerid{c}~$\ocweol
\ocwindent{12.50em}
\ocwkw{else}~$\ocwupperid{Canon.}\ocwlowerid{canon\_html}~\ocwlowerid{c}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{catenate}~\ocwlowerid{c}~(\ocwlowerid{s},\ocwlowerid{b})~=~$\ocwbc{} similar to Canon.catenate \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{b'}=~\ocwlowerid{c}>0~\land{}~\ocwlowerid{c}<14~$\ocwbc{} Phonetics.vowel c \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{hiatus}~=~$\ocwkw{if}~$\ocwlowerid{b}~\land{}~\ocwlowerid{b'}~$\ocwkw{then}~\ocwstring{"\_"}~\^{}~$\ocwlowerid{s}~$\ocwkw{else}~$\ocwlowerid{s}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{canon}~\ocwlowerid{c}~$\^{}~$\ocwlowerid{hiatus}~,~\ocwlowerid{b'})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{word}~=~\ocwlowerid{code\_skt\_ref}~\ocwlowerid{t}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{s},\ocwlowerid{\_})~=~\ocwupperid{List.}\ocwlowerid{fold\_right}~\ocwlowerid{catenate}~\ocwlowerid{word}~($\ocwstring{""},$\ocwupperid{False})~$\ocwkw{in}~$\ocwlowerid{s}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} strips from word stack (revcode) homonym index if any \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{strip}~\ocwlowerid{w}~=~$\ocwkw{match}~$\ocwlowerid{w}~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{last}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{last}>50~$\ocwkw{then}~$\ocwlowerid{rest}~$\ocwbc{} remove homonymy index \ocwec{}\ocweol
\ocwindent{12.00em}
\ocwkw{else}~$\ocwlowerid{w}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Empty\ocwvspace{}stem\ocwvspace{}to\ocwvspace{}strip"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rev\_strip}~\ocwlowerid{w}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~(\ocwlowerid{strip}~(\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{w}))~$\ocwbc{} ugly - temp \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Builds revword normalised stem from entry string of root \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Used by \ocwbegindcode{}$\ocwupperid{Verbs}.\ocwlowerid{revstem}$\ocwenddcode{}, \ocwbegindcode{}$\ocwupperid{Nouns}.\ocwlowerid{enter\_iic}$\ocwenddcode{}, \ocwbegindcode{}$\ocwupperid{Print\_dict}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rev\_stem}~\ocwlowerid{str}~=~\ocwlowerid{strip}~(\ocwlowerid{rev\_code\_string}~\ocwlowerid{str})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Takes a reversed word and returns its canonical name (homo,stem) \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{decompose}~\ocwlowerid{w}~=~$\ocwkw{match}~$\ocwlowerid{w}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{last}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{3.50em}
\ocwkw{if}~$\ocwlowerid{last}>50~$\ocwkw{then}~$(\ocwlowerid{last}-50,\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rest})~$\ocweol
\ocwindent{9.00em}
\ocwkw{else}~$(0,\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{w})$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Empty\ocwvspace{}stem\ocwvspace{}to\ocwvspace{}decompose"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Temporary - encoding of homo as last character of word \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{decompose\_str}~\ocwlowerid{str}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{decompose}~(\ocwlowerid{rev\_code\_string}~\ocwlowerid{str})~$\ocwbc{} ugly multiple reversals \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{normal\_stem}~\ocwlowerid{str}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~(\ocwlowerid{rev\_stem}~\ocwlowerid{str})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{normal\_stem\_str}~\ocwlowerid{str}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~(\ocwlowerid{normal\_stem}~\ocwlowerid{str})~$\ocwbc{} horror \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} strips homonymy index of raw input - similar awful double reversal \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{code\_strip\_raw}~\ocwlowerid{s}~=~\ocwlowerid{rev\_strip}~(\ocwlowerid{code\_raw}~\ocwlowerid{s})$\ocweol
\ocwindent{0.00em}
\ocwbc{} Hopefully used only for devanagari printing below \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Same function, with skt input, is \ocwbegindcode{}$\ocwupperid{Subst}.\ocwlowerid{stripped\_code\_skt}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} A cleaner solution would be to have type lexeme = (word * int) 
   and \ocwstring{"x\#5"} represented as (x,5) (0 if no homophone) \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_to\_deva}~\ocwlowerid{str}~=~$\ocwkw{try}~$\ocwupperid{Canon.}\ocwlowerid{unidevcode}~(\ocwlowerid{code\_string}~\ocwlowerid{str})~$\ocwkw{with}\ocweol
\ocwindent{16.00em}
$[~\ocwupperid{Failure}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{In\_error}~\ocwlowerid{str})~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{skt\_raw\_to\_deva}~\ocwlowerid{str}~=~$\ocwkw{try}~$\ocwupperid{Canon.}\ocwlowerid{unidevcode}~(\ocwlowerid{code\_raw}~\ocwlowerid{str})~$\ocwkw{with}\ocweol
\ocwindent{16.00em}
$[~\ocwupperid{Failure}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{In\_error}~\ocwlowerid{str})~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{skt\_raw\_strip\_to\_deva}~\ocwlowerid{str}~=~$\ocwkw{try}~$\ocwupperid{Canon.}\ocwlowerid{unidevcode}~(\ocwlowerid{code\_strip\_raw}~\ocwlowerid{str})~$\ocwkw{with}\ocweol
\ocwindent{16.00em}
$[~\ocwupperid{Failure}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{In\_error}~\ocwlowerid{str})~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Following not needed since \ocwbegindcode{}$\ocwupperid{Transduction}.\ocwlowerid{skt\_to\_html}$\ocwenddcode{} is more direct 
\ocwbegindcode{}$\ocwlowerid{value}~\ocwlowerid{skt\_to\_roma}~\ocwlowerid{str}~=~\ocwupperid{Canon}.\ocwlowerid{uniromcode}~(\ocwlowerid{code\_string}~\ocwlowerid{str})~
~$\ocwkw{and}~$\ocwlowerid{skt\_raw\_to\_roma}~\ocwlowerid{str}~=~\ocwupperid{Canon}.\ocwlowerid{uniromcode}~(\ocwlowerid{code\_raw}~\ocwlowerid{str})~
~$\ocwkw{and}~$\ocwlowerid{skt\_raw\_strip\_to\_roma}~\ocwlowerid{str}~=~\ocwupperid{Canon}.\ocwlowerid{uniromcode}~(\ocwlowerid{code\_strip\_raw}~\ocwlowerid{str})$\ocwenddcode{} \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
diff with string in Velthuis transliteration - caution: argument swap 
\ocweol
\label{encode.ml:5553}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{diff\_str}~\ocwlowerid{str}~\ocwlowerid{w}~=~\ocwupperid{Word.}\ocwlowerid{diff}~\ocwlowerid{w}~(\ocwlowerid{code\_string}~\ocwlowerid{str})~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Order.ml}
\ocwmodule{Order}
\label{order.ml:0}%
lexicographic comparison 
\ocweol
\label{order.ml:681}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{lexico}~\ocwlowerid{l1}~\ocwlowerid{l2}~=~$\ocwkw{match}~$\ocwlowerid{l1}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c1}~::~\ocwlowerid{r1}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c1}=50~$\ocwbc{} hiatus \ocwec{}~\ocwkw{then}~$\ocwlowerid{lexico}~\ocwlowerid{r1}~\ocwlowerid{l2}~$\ocweol
\ocwindent{10.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{l2}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~\ocwlowerid{c2}~::~\ocwlowerid{r2}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c2}=50~$\ocwbc{} hiatus \ocwec{}~\ocwkw{then}~$\ocwlowerid{lexico}~\ocwlowerid{l1}~\ocwlowerid{r2}~$\ocweol
\ocwindent{12.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{c2}>50~$\ocwkw{then}~$\ocwlowerid{c1}>50~\land{}~\ocwlowerid{c1}<\ocwlowerid{c2}~$\ocwbc{} homonym indexes \ocwec{}\ocweol
\ocwindent{12.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{c1}>50~$\ocwkw{then}~$\ocwupperid{True}$\ocweol
\ocwindent{12.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{c2}<\ocwlowerid{c1}~$\ocwkw{then}~$\ocwupperid{False}~$\ocweol
\ocwindent{12.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{c2}=\ocwlowerid{c1}~$\ocwkw{then}~$\ocwlowerid{lexico}~\ocwlowerid{r1}~\ocwlowerid{r2}$\ocweol
\ocwindent{12.00em}
\ocwkw{else}~$\ocwupperid{True}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} for use as argument to List.sort \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{order}~\ocwlowerid{w}~\ocwlowerid{w'}~=~$\ocwkw{if}~$\ocwlowerid{w}=\ocwlowerid{w'}~$\ocwkw{then}~0~\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{lexico}~\ocwlowerid{w}~\ocwlowerid{w'}~$\ocwkw{then}~-1~\ocwkw{else}~1\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} end; \ocwec{}\ocweol
\ocwendcode{}\typeout{OcamlWeb file Padapatha.ml}
\ocwmodule{Padapatha}
\label{padapatha.ml:0}%
\label{padapatha.ml:701}%
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sanskrit\_chunk}~\ocwlowerid{encode}~\ocwlowerid{s}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{encode}~\ocwlowerid{s}~$\ocwkw{with}~\ocwbc{} avagraha reverts to a \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[~-1~::~\ocwlowerid{l}~]~\rightarrow{}~[~1~::~\ocwlowerid{l}~]~$\ocwbc{} only initial avagraha reverts to a \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{x}~\rightarrow{}~\ocwlowerid{x}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Preprocessing of corpus to prepare padapatha form from list of chunks   \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} This is extremely important from the segmenter complexity point of view \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Since it takes hints at parallel treatment from non-ambiguous blanks. \ocwec{}\medskip

\label{padapatha.ml:1105}%
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Hiatus}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Glue}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We raise Glue below when there are multiple ways to obtain the current break,
   in which case we do not profit of the sandhi hint. Furthermore, this is 
   incomplete, notably when one of the sandhied forms is a vocative. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Chunk \ocwbegindcode{}$\ocwlowerid{w}$\ocwenddcode{} is adjusted for padapatha in view of next character \ocwbegindcode{}$\ocwlowerid{c}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} No attempt is made to change \ocwbegindcode{}$\ocwlowerid{c}$\ocwenddcode{} and thus tacchrutvaa is not chunkable. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} This function defines the maximal separability of devanaagarii into chunks
   but is not always able to go as far as creating the full padapaa.tha \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{adjust}~\ocwlowerid{c}~\ocwlowerid{w}~=~$\ocwkw{match}~$\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{w}~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"adjust"}\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{last}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~14~$\ocwbc{} .m \ocwec{}~$\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{mirror}~[~41~$\ocwbc{} m \ocwec{}~::~$\ocwlowerid{rest}~]~$\ocwbc{} revert .m to m \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwbc{} note: .m coming from sandhi of n is followed by sibilant 
                and chunking is allowed only after this sibilant \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~12~$\ocwbc{} o \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{rest}~=~[~40~]~$\ocwbc{} bh from bhos -> bho \ocwec{}~\ocwkw{then}~\ocweol
\ocwindent{13.50em}
$\ocwupperid{Encode.}\ocwlowerid{code\_string}~$\ocwstring{"bhos"}~\ocwbc{} \ocwstring{"bho\ocwvspace{}raama"} \ocwstring{"bho\ocwvspace{}bhos"} \ocwec{}\ocweol
\ocwindent{12.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{rest}~=~[~49;~1~]~$\ocwbc{} aho \ocwec{}~\ocwkw{then}~\ocweol
\ocwindent{13.50em}
$\ocwupperid{Encode.}\ocwlowerid{code\_string}~$\ocwstring{"aho"}~\ocwbc{} \ocwstring{"bho\ocwvspace{}raama"} \ocwstring{"bho\ocwvspace{}bhos"} \ocwec{}\ocweol
\ocwindent{12.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{turns\_visarg\_to\_o}~\ocwlowerid{c}~\lor{}~\ocwlowerid{c}=1~$\ocweol
\ocwindent{14.50em}
\ocwbc{} zivoham must be entered as zivo'ham (avagraha) \ocwec{}\ocweol
\ocwindent{14.50em}
\ocwkw{then}~$\ocwupperid{Word.}\ocwlowerid{mirror}~[~16~::~[~1~::~\ocwlowerid{rest}~]~]~$\ocweol
\ocwindent{14.50em}
\ocwbc{} restore visarga, assuming original a.h form \ocwec{}\ocweol
\ocwindent{12.00em}
\ocwkw{else}~$\ocwlowerid{w}~$\ocweol
\ocwindent{4.00em}
$\mid{}~1~$\ocwbc{} a \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=1~$\ocwkw{then}~$\ocwlowerid{w}~$\ocwkw{else}\ocweol
\ocwindent{11.50em}
\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{raise}~\ocwupperid{Hiatus}~$\ocwkw{else}~$\ocwlowerid{w}$\ocweol
\ocwindent{4.00em}
$\mid{}~2~$\ocwbc{} aa \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{raise}~\ocwupperid{Hiatus}~$\ocwkw{else}~\ocweol
\ocwindent{12.00em}
\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{elides\_visarg\_aa}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{raise}~\ocwupperid{Hiatus}~$\ocwkw{else}~$\ocwlowerid{w}~$\ocweol
\ocwindent{12.00em}
\ocwbc{} NB \ocwstring{"baalaa\ocwvspace{}devaa"} must be written \ocwstring{"baalaadevaa"} \ocwec{}\ocweol
\ocwindent{12.00em}
\ocwbc{} but also \ocwstring{"tathaa\ocwvspace{}hi"} problematic \ocwec{}\ocweol
\ocwindent{12.00em}
\ocwbc{} Worse \ocwstring{"raama\ocwvspace{}aadhaara.h"} not parsable with vocative \ocwec{}\ocweol
\ocwindent{12.00em}
\ocwbc{} also \ocwstring{"vaa\ocwvspace{}are"} not analysed \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~4~$\ocwbc{} ii \ocwec{}~\ocwbc{} possible visarga vanishes, original vowel may be short \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~6~$\ocwbc{} uu \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=43~$\ocwbc{} r \ocwec{}~\ocwkw{then}~$\ocwlowerid{raise}~\ocwupperid{Glue}~$\ocwkw{else}~$\ocwlowerid{w}$\ocweol
\ocwindent{4.00em}
\ocwbc{} next 4 rules attempt to revert \ocwbegindcode{}$\ocwlowerid{last}$\ocwenddcode{} to 'd' in view of \ocwbegindcode{}$\ocwlowerid{c}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~34~$\ocwbc{} d \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=35~$\ocwbc{} dh \ocwec{}~\ocwkw{then}~$\ocwlowerid{raise}~\ocwupperid{Glue}~$\ocwkw{else}~\ocweol
\ocwindent{12.00em}
\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{is\_voiced}~\ocwlowerid{c}~$\ocweol
\ocwindent{13.50em}
\ocwkw{then}~$\ocwupperid{Word.}\ocwlowerid{mirror}~[~32~::~\ocwlowerid{rest}~]~$\ocwbc{} d -> t \ocwec{}\ocweol
\ocwindent{13.50em}
\ocwkw{else}~$\ocwlowerid{w}$\ocweol
\ocwindent{4.00em}
$\mid{}~24~$\ocwbc{} j \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{turns\_t\_to\_j}~\ocwlowerid{c}~$\ocwbc{} tat+jara -> tajjara \ocwec{}\ocweol
\ocwindent{13.50em}
\ocwkw{then}~$\ocwupperid{Word.}\ocwlowerid{mirror}~[~32~::~\ocwlowerid{rest}~]~$\ocwbc{} j -> t \ocwec{}\ocweol
\ocwindent{13.50em}
\ocwkw{else}~$\ocwlowerid{w}$\ocweol
\ocwindent{4.00em}
$\mid{}~26~$\ocwbc{} ~n \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rest}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~[~26~$\ocwbc{} ~n \ocwec{}~::~$\ocwlowerid{ante}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{ante}~$\ocwkw{with}\ocweol
\ocwindent{8.50em}
\ocwbc{} optional doubling of ~n in front of vowel \ocwec{}\ocweol
\ocwindent{8.50em}
$[~[~\ocwlowerid{v}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{short\_vowel}~\ocwlowerid{v}~\land{}~\ocwupperid{Phonetics.}\ocwlowerid{vowel}~\ocwlowerid{c}$\ocweol
\ocwindent{18.00em}
\ocwkw{then}~$\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rest}~$\ocweol
\ocwindent{18.00em}
\ocwkw{else}~$\ocwlowerid{failwith}~$\ocwstring{"padapatha"}\ocweol
\ocwindent{8.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"padapatha"}\ocweol
\ocwindent{8.50em}
$]$\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=23~$\ocwbc{} ch could come from ch or z \ocwec{}\ocweol
\ocwindent{11.50em}
\ocwkw{then}~$\ocwlowerid{raise}~\ocwupperid{Glue}~$\ocweol
\ocwindent{10.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{turns\_n\_to\_palatal}~\ocwlowerid{c}~$\ocweol
\ocwindent{14.00em}
\ocwbc{} taan+zaastravimukhaan -> taa~nzaastravimukhaan \ocwec{}\ocweol
\ocwindent{12.50em}
\ocwkw{then}~$\ocwupperid{Word.}\ocwlowerid{mirror}~[~36~$\ocwbc{} n \ocwec{}~::~$\ocwlowerid{rest}~]~$\ocwbc{} n -> ~n \ocwec{}\ocweol
\ocwindent{12.50em}
\ocwkw{else}~$\ocwlowerid{w}~$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{4.00em}
$\mid{}~29~$\ocwbc{} .d \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=30~$\ocwbc{} .dh \ocwec{}~\ocwkw{then}~$\ocwlowerid{raise}~\ocwupperid{Glue}~$\ocwkw{else}~\ocweol
\ocwindent{12.50em}
\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{is\_voiced}~\ocwlowerid{c}~$\ocweol
\ocwindent{13.50em}
\ocwkw{then}~$\ocwupperid{Word.}\ocwlowerid{mirror}~[~27~::~\ocwlowerid{rest}~]~$\ocwbc{} .d -> .t \ocwec{}\ocweol
\ocwindent{13.50em}
\ocwkw{else}~$\ocwlowerid{w}$\ocweol
\ocwindent{4.00em}
$\mid{}~39~$\ocwbc{} b \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=40~$\ocwbc{} bh \ocwec{}~\ocwkw{then}~$\ocwlowerid{raise}~\ocwupperid{Glue}~$\ocwkw{else}~\ocweol
\ocwindent{12.00em}
\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{is\_voiced}~\ocwlowerid{c}~$\ocweol
\ocwindent{13.50em}
\ocwkw{then}~$\ocwupperid{Word.}\ocwlowerid{mirror}~[~37~::~\ocwlowerid{rest}~]~$\ocwbc{} b -> p \ocwec{}\ocweol
\ocwindent{13.50em}
\ocwkw{else}~$\ocwlowerid{w}$\ocweol
\ocwindent{4.00em}
$\mid{}~19~$\ocwbc{} g \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=20~$\ocwbc{} gh \ocwec{}~\ocwkw{then}~$\ocwlowerid{raise}~\ocwupperid{Glue}~$\ocwkw{else}~\ocweol
\ocwindent{12.00em}
\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{is\_voiced}~\ocwlowerid{c}~$\ocwbc{} vaak+vazya \ocwec{}\ocweol
\ocwindent{13.50em}
\ocwkw{then}~$\ocwupperid{Word.}\ocwlowerid{mirror}~[~17~::~\ocwlowerid{rest}~]~$\ocwbc{} g -> k \ocwec{}\ocweol
\ocwindent{13.50em}
\ocwkw{else}~$\ocwlowerid{w}$\ocweol
\ocwindent{4.00em}
$\mid{}~36~$\ocwbc{} n \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rest}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~[~36~$\ocwbc{} n \ocwec{}~::~$\ocwlowerid{ante}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{ante}~$\ocwkw{with}\ocweol
\ocwindent{9.50em}
\ocwbc{} optional doubling of n in front of vowel \ocwec{}\ocweol
\ocwindent{8.50em}
$[~[~\ocwlowerid{v}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{short\_vowel}~\ocwlowerid{v}~\land{}~\ocwupperid{Phonetics.}\ocwlowerid{vowel}~\ocwlowerid{c}$\ocweol
\ocwindent{18.00em}
\ocwkw{then}~$\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rest}~$\ocwbc{} gacchann eva \ocwec{}\ocweol
\ocwindent{16.50em}
\ocwkw{else}~$\ocwlowerid{w}$\ocweol
\ocwindent{8.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"padapatha"}\ocweol
\ocwindent{8.50em}
$]$\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=36~$\ocwbc{} n \ocwec{}~$\lor{}~\ocwlowerid{c}=41~$\ocwbc{} m \ocwec{}\ocweol
\ocwindent{11.50em}
\ocwkw{then}~$\ocwlowerid{raise}~\ocwupperid{Glue}~$\ocwbc{} since d|m->nn and n|m -> nm \ocwec{}\ocweol
\ocwindent{12.50em}
\ocwbc{} Word.mirror \ocwbegindcode{}~32~::~$\ocwlowerid{rest}~$\ocwenddcode{} \ocwbc{} n -> t \ocwec{} \ocwec{}\ocweol
\ocwindent{12.50em}
\ocwbc{} incomplétude: raajan naasiin vocatif raajan \ocwec{}\ocweol
\ocwindent{10.00em}
\ocwkw{else}~$\ocwlowerid{w}$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{4.00em}
$\mid{}~22~$\ocwbc{} c \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=22~$\ocwkw{then}~$\ocwupperid{Word.}\ocwlowerid{mirror}~[~32~::~\ocwlowerid{rest}~]~$\ocwbc{} c -> t \ocwec{}\ocweol
\ocwindent{12.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{c}=23~$\ocwbc{} ch could come from ch or z \ocwec{}\ocweol
\ocwindent{14.50em}
\ocwkw{then}~$\ocwlowerid{raise}~\ocwupperid{Glue}~$\ocwkw{else}~$\ocwlowerid{w}$\ocweol
\ocwindent{4.00em}
$\mid{}~44~$\ocwbc{} l \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=\ocwlowerid{last}~$\ocweol
\ocwindent{13.50em}
\ocwkw{then}~$\ocwupperid{Word.}\ocwlowerid{mirror}~[~32~::~\ocwlowerid{rest}~]~$\ocwbc{} l -> t \ocwec{}\ocweol
\ocwindent{13.50em}
\ocwkw{else}~$\ocwlowerid{w}$\ocweol
\ocwindent{4.00em}
$\mid{}~21~$\ocwbc{} f \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rest}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~[~21~$\ocwbc{} f \ocwec{}~::~$\ocwlowerid{ante}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{ante}~$\ocwkw{with}\ocweol
\ocwindent{9.50em}
\ocwbc{} optional doubling of f in front of vowel \ocwec{}\ocweol
\ocwindent{8.50em}
$[~[~\ocwlowerid{v}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{short\_vowel}~\ocwlowerid{v}~\land{}~\ocwupperid{Phonetics.}\ocwlowerid{vowel}~\ocwlowerid{c}$\ocweol
\ocwindent{18.00em}
\ocwkw{then}~$\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rest}~$\ocweol
\ocwindent{16.50em}
\ocwkw{else}~$\ocwlowerid{failwith}~$\ocwstring{"padapatha"}\ocweol
\ocwindent{8.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"padapatha"}\ocweol
\ocwindent{8.50em}
$]$\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=41~$\ocwbc{} m \ocwec{}~\ocwbc{} vaak+mayi \ocwec{}\ocweol
\ocwindent{14.00em}
\ocwkw{then}~$\ocwupperid{Word.}\ocwlowerid{mirror}~[~17~::~\ocwlowerid{rest}~]~$\ocwbc{} f -> k \ocwec{}\ocweol
\ocwindent{14.00em}
\ocwkw{else}~$\ocwlowerid{w}$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{4.00em}
\ocwbc{} NB if last is y, r or v and c is vowel, then it may come from resp. 
           {i,ii}, {.r,.rr}, {u,uu} and this choice means that we cannot make 
           a chunk break here \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~42~$\ocwbc{} y \ocwec{}~$\mid{}~45~$\ocwbc{} v \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{raise}~\ocwupperid{Glue}~$\ocweol
\ocwindent{18.50em}
\ocwkw{else}~$\ocwlowerid{w}~$\ocwbc{} will fail \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~43~$\ocwbc{} r \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{turns\_visarg\_to\_o}~\ocwlowerid{c}~\lor{}~\ocwupperid{Phonetics.}\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocweol
\ocwindent{13.50em}
\ocwkw{then}~$\ocwupperid{Word.}\ocwlowerid{mirror}~[~16~::~\ocwlowerid{rest}~]~$\ocwbc{} visarg restored \ocwec{}\ocweol
\ocwindent{12.00em}
\ocwkw{else}~$\ocwlowerid{w}~$\ocwbc{} pb punar pitar etc \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~46~$\ocwbc{} z \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rest}~$\ocwkw{with}\ocweol
\ocwindent{7.00em}
$[~[~14~$\ocwbc{} .m \ocwec{}~::~$\ocwlowerid{b}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=22~\lor{}~\ocwlowerid{c}=23~$\ocwbc{} c ch \ocwec{}~\ocwkw{then}\ocweol
\ocwindent{21.50em}
$\ocwupperid{Word.}\ocwlowerid{mirror}~[~36~$\ocwbc{} n \ocwec{}~::~$\ocwlowerid{b}~]~$\ocweol
\ocwindent{20.00em}
\ocwkw{else}~$\ocwlowerid{w}~$\ocweol
\ocwindent{7.00em}
$\mid{}~[~26~$\ocwbc{} ~n \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=46~$\ocwbc{} z \ocwec{}~\ocwkw{then}\ocweol
\ocwindent{21.50em}
$\ocwupperid{Word.}\ocwlowerid{mirror}~[~36~$\ocwbc{} n \ocwec{}~::~$\ocwlowerid{rest}~]~$\ocweol
\ocwindent{20.00em}
\ocwkw{else}~$\ocwlowerid{w}~$\ocweol
\ocwindent{20.00em}
\ocwbc{} c=23 \ocwbc{} ch \ocwec{} could come from z \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=22~\lor{}~\ocwlowerid{c}=23~$\ocwbc{} c ch \ocwec{}~\ocwkw{then}\ocweol
\ocwindent{10.50em}
$\ocwupperid{Word.}\ocwlowerid{mirror}~[~16~$\ocwbc{} .h \ocwec{}~::~$\ocwlowerid{rest}~]~$\ocwkw{else}~$\ocwlowerid{w}$\ocweol
\ocwindent{7.00em}
$]$\ocweol
\ocwindent{4.00em}
$\mid{}~47~$\ocwbc{} .s \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rest}~$\ocwkw{with}\ocweol
\ocwindent{7.00em}
$[~[~14~$\ocwbc{} .m \ocwec{}~::~$\ocwlowerid{b}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=27~\lor{}~\ocwlowerid{c}=28~$\ocwbc{} .t .th \ocwec{}~\ocwkw{then}\ocweol
\ocwindent{20.00em}
$\ocwupperid{Word.}\ocwlowerid{mirror}~[~36~$\ocwbc{} n \ocwec{}~::~$\ocwlowerid{b}~]~$\ocwkw{else}~$\ocwlowerid{w}~$\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{w}$\ocweol
\ocwindent{7.00em}
$]$\ocweol
\ocwindent{4.00em}
$\mid{}~48~$\ocwbc{} s \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rest}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~[~14~$\ocwbc{} .m \ocwec{}~::~$\ocwlowerid{b}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=32~\lor{}~\ocwlowerid{c}=33~$\ocwbc{} t th \ocwec{}~\ocwkw{then}\ocweol
\ocwindent{20.50em}
$\ocwupperid{Word.}\ocwlowerid{mirror}~[~36~$\ocwbc{} n \ocwec{}~::~$\ocwlowerid{b}~]~$\ocwkw{else}~$\ocwlowerid{w}~$\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{w}$\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{w}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{padapatha}~\ocwlowerid{read\_chunk}~\ocwlowerid{l}~=~$\ocwbc{} l is list of chunks separated by blanks \ocwec{}\ocweol
\ocwindent{10.50em}
\ocwbc{} returns padapatha as list of forms in terminal sandhi \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{pad\_rec}~=~$\ocwkw{fun}~\ocwbc{} returns (c,l) with c first char of first pada in l \ocwec{}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~(-1,[\,])$\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{chk}~::~\ocwlowerid{chks}~]~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$(\ocwlowerid{c},\ocwlowerid{padas})~=~\ocwlowerid{pad\_rec}~\ocwlowerid{chks}~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{w}~=~\ocwlowerid{read\_chunk}~\ocwlowerid{chk}~$\ocwbc{} initial avagraha reverts to a \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{3.00em}
$(\ocwupperid{List.}\ocwlowerid{hd}~\ocwlowerid{w}~$\ocwbc{} next c \ocwec{},~\ocweol
\ocwindent{3.50em}
\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{pada}~=~$\ocwkw{if}~$\ocwlowerid{c}=(-1)~$\ocwkw{then}~$\ocwlowerid{w}~$\ocwbc{} last chunk \ocwec{}\ocweol
\ocwindent{11.00em}
\ocwkw{else}~$\ocwlowerid{adjust}~\ocwlowerid{c}~\ocwlowerid{w}~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$[~\ocwlowerid{pada}~::~\ocwlowerid{padas}~]$\ocweol
\ocwindent{3.50em}
\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Hiatus}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{padas}~$\ocwkw{with}~\ocweol
\ocwindent{5.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"padapatha"}\ocweol
\ocwindent{5.00em}
$\mid{}~[~\ocwlowerid{p}~::~\ocwlowerid{lp}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{conc}~=~\ocwlowerid{w}~@~[~50~::~\ocwlowerid{p}~]~$\ocwkw{in}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{w\_p}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{13.50em}
$[~\ocwlowerid{conc}~::~\ocwlowerid{lp}~]~$\ocwbc{} hiatus indicates a word boundary \ocwec{}\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Glue}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{padas}~$\ocwkw{with}~\ocweol
\ocwindent{5.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"padapatha"}\ocweol
\ocwindent{5.00em}
$\mid{}~[~\ocwlowerid{p}~::~\ocwlowerid{lp}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{conc}~=~\ocwlowerid{w}~@~\ocwlowerid{p}~$\ocwkw{in}\ocweol
\ocwindent{13.50em}
$[~\ocwlowerid{conc}~::~\ocwlowerid{lp}~]~$\ocwbc{} we lose the boundary indication \ocwec{}\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{4.50em}
$])$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{\_},\ocwlowerid{padas})~=~\ocwlowerid{pad\_rec}~\ocwlowerid{l}~$\ocwkw{in}~$\ocwlowerid{padas}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Sanskrit.mli}
\ocwinterface{Sanskrit}
\label{sanskrit.mli:0}%
\label{sanskrit.mli:650}%
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{skt}~$\ocwbc{} abstract \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{pada}~=~$\ocwbt{list}~$\ocwlowerid{skt}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sloka}~=~$\ocwbt{list}~$\ocwlowerid{pada}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{string\_of\_skt}~:~\ocwlowerid{skt}~\rightarrow{}~$\ocwbt{string};~\ocwbc{} input \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_of\_string}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{skt};~$\ocwbc{} faking - debug and \ocwbegindcode{}$\ocwupperid{Subst}.\ocwlowerid{record\_tad}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{aa\_preverb}~:~\ocwlowerid{skt};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{privative}~:~\ocwlowerid{skt}~\rightarrow{}~$\ocwbt{bool};\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{i\_root}~:~\ocwlowerid{skt};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ita\_part}~:~\ocwlowerid{skt};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{dagh\_root}~:~\ocwlowerid{skt};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{daghna\_part}~:~\ocwlowerid{skt};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{arcya\_absolutive}~:~\ocwlowerid{skt};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{trad\_skt}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{skt};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{trad\_sanscrit}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{sloka};~$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{trad\_skt\_list}~:~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{list}~$\ocwlowerid{skt};~$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{maha\_epic}~:~\ocwlowerid{skt};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rama\_epic}~:~\ocwlowerid{skt};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_to\_tex}~:~\ocwlowerid{skt}~\rightarrow{}~$\ocwbt{string};\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_to\_dev}~:~\ocwlowerid{skt}~\rightarrow{}~$\ocwbt{string};\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_to\_html}~:~\ocwlowerid{skt}~\rightarrow{}~$\ocwbt{string};\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_raw\_to\_deva}~:~\ocwlowerid{skt}~\rightarrow{}~$\ocwbt{string};\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_raw\_strip\_to\_deva}~:~\ocwlowerid{skt}~\rightarrow{}~$\ocwbt{string};\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_to\_anchor}~:~\ocwlowerid{skt}~\rightarrow{}~$\ocwbt{string};\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{raw\_sanskrit\_word}~:~\ocwlowerid{skt}~\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sanskrit\_word}~:~\ocwlowerid{skt}~\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rev\_stem\_skt}~:~\ocwlowerid{skt}~\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{normal\_stem}~:~\ocwlowerid{skt}~\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{clean\_up}~:~\ocwlowerid{skt}~\rightarrow{}~\ocwlowerid{skt};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{normal\_stem\_skt}~:~\ocwlowerid{skt}~\rightarrow{}~$\ocwbt{string};\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{code\_skt\_ref}~:~\ocwlowerid{skt}~\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{code\_skt\_ref\_d}~:~\ocwlowerid{skt}~\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{decode\_skt}~:~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~\ocwlowerid{skt};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{read\_corpus}~:~$\ocwbt{bool}~$\rightarrow{}~\ocwlowerid{in\_channel}~\rightarrow{}~$\ocwbt{list}~$\ocwupperid{Word.}\ocwlowerid{word};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{read\_VH}~:~$\ocwbt{bool}~$\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{list}~$\ocwupperid{Word.}\ocwlowerid{word};~$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{read\_sanskrit}~:~($\ocwbt{string}~$\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word})~\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{list}~$\ocwupperid{Word.}\ocwlowerid{word};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{read\_raw\_sanskrit}~:~($\ocwbt{string}~$\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word})~\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{list}~$\ocwupperid{Word.}\ocwlowerid{word};$\ocweol
\ocwendcode{}\typeout{OcamlWeb file Sanskrit.ml}
\ocwmodule{Sanskrit}
\label{sanskrit.ml:0}%
The Sanskrit lexical processor 
\ocweol
\label{sanskrit.ml:691}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_lexer};$\medskip

\label{sanskrit.ml:709}%
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{skt}~=~$\ocwbt{string}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{encoding}~=~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{list}~\ocwbt{int}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Recognize a Sanskrit sentence as either a pada or a sloka 
\ocweol
\label{sanskrit.ml:828}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{pada}~=~$\ocwbt{list}~$\ocwlowerid{skt}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sloka}~=~$\ocwbt{list}~$\ocwlowerid{pada}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Dangerous - keeps the accent and chars + - dollar \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{string\_of\_skt}~\ocwlowerid{s}~=~\ocwlowerid{s}~$\ocwbc{} coercion \ocwbegindcode{}$\ocwlowerid{skt}~\rightarrow{}~$\ocwbt{string}\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Unsafe - debugging mostly, but also \ocwbegindcode{}$\ocwupperid{Print\_html}.\ocwlowerid{print\_skt\_px\_ac}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_of\_string}~\ocwlowerid{s}~=~\ocwlowerid{s}~$\ocwbc{} coercion \ocwbegindcode{}\ocwbt{string}~$\rightarrow{}~\ocwlowerid{skt}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{aa\_preverb}~=~$\ocwstring{"aa"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{privative}~\ocwlowerid{p}~=~\ocwupperid{List.}\ocwlowerid{mem}~\ocwlowerid{p}~[~$\ocwstring{"a"};~\ocwstring{"an\#1"}~$]~$\ocwbc{} privative prefixes \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Sanskrit word used in computations \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Fragile: assumes fixed entry in lexicon \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{i\_root}~=~$\ocwstring{"i"}~\ocwbc{} \ocwbegindcode{}$\ocwupperid{Subst}.\ocwlowerid{record\_ifc2}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{ita\_part}~=~$\ocwstring{"ita"}~\ocwbc{} id \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{dagh\_root}~=~$\ocwstring{"dagh"}~\ocwbc{} id \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{daghna\_part}~=~$\ocwstring{"daghna"}~\ocwbc{} id - accent needed \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{arcya\_absolutive}~=~$\ocwstring{"arcya"}~\ocwbc{} \ocwbegindcode{}$\ocwupperid{Subst}.\ocwlowerid{record\_noun\_gen}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Gramskt}~=~\ocwupperid{Camlp4.PreCast.MakeGram}~\ocwupperid{Skt\_lexer}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_lexer.Token}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Entry points \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt}~=~\ocwupperid{Gramskt.Entry.}\ocwlowerid{mk}~$\ocwstring{"skt"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{skt1}~=~\ocwupperid{Gramskt.Entry.}\ocwlowerid{mk}~$\ocwstring{"skt1"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pada}~=~\ocwupperid{Gramskt.Entry.}\ocwlowerid{mk}~$\ocwstring{"pada"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sloka\_line}~=~\ocwupperid{Gramskt.Entry.}\ocwlowerid{mk}~$\ocwstring{"sloka\_line"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sloka}~=~\ocwupperid{Gramskt.Entry.}\ocwlowerid{mk}~$\ocwstring{"sloka"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sanscrit}~=~\ocwupperid{Gramskt.Entry.}\ocwlowerid{mk}~$\ocwstring{"sanscrit"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{prefix}~=~\ocwupperid{Gramskt.Entry.}\ocwlowerid{mk}~$\ocwstring{"prefix"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{skt\_list}~=~\ocwupperid{Gramskt.Entry.}\ocwlowerid{mk}~$\ocwstring{"skt\_list"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{prefix\_list}~=~\ocwupperid{Gramskt.Entry.}\ocwlowerid{mk}~$\ocwstring{"prefix\_list"}\ocweol
\ocwindent{0.00em}
;\medskip

\label{sanskrit.ml:2025}%
\ocwindent{0.00em}
$\ocwupperid{EXTEND}~\ocwupperid{Gramskt}$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{skt}:~$\ocwbc{} chunk of Sanskrit letters in Velthuis romanisation \ocwec{}\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{id}~=~\ocwupperid{IDENT};~$\ocwstring{"\_"};~$\ocwlowerid{s}~=~\ocwlowerid{skt}~\rightarrow{}~\ocwlowerid{id}~$\^{}~\ocwstring{"\_"}~\^{}~$\ocwlowerid{s}~$\ocwbc{} hiatus (underscore) \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{id}~=~\ocwupperid{IDENT};~$\ocwstring{"\#"};~$\ocwlowerid{n}~=~\ocwupperid{INT}~\rightarrow{}~\ocwlowerid{id}~$\^{}~\ocwstring{"\#"}~\^{}~$\ocwlowerid{n}~$\ocwbc{} homonym index \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{id}~=~\ocwupperid{IDENT}~\rightarrow{}~\ocwlowerid{id}~$\ocwbc{} possible avagraha is initial quote \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{n}~=~\ocwupperid{INT}~\rightarrow{}~\ocwlowerid{n}~$\ocwbc{} numerals eg -tama \ocwec{}\ocweol
\ocwindent{2.00em}
$]~]~;~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{skt1}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{s}~=~\ocwlowerid{skt};~`\ocwupperid{EOI}~\rightarrow{}~\ocwlowerid{s}~]~]~;$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{pada}:~$\ocwbc{} non-empty list of chunks separated by blanks \ocwec{}\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{el}~=~\ocwupperid{LIST1}~\ocwlowerid{skt}~\rightarrow{}~\ocwlowerid{el}~]~]~;~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{sloka\_line}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{p}~=~\ocwlowerid{pada};~$\ocwstring{"|"};~\ocwstring{"|"}~$\rightarrow{}~[~\ocwlowerid{p}~]~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{p}~=~\ocwlowerid{pada};~$\ocwstring{"|"};~$\ocwlowerid{sl}~=~\ocwlowerid{sloka\_line}~\rightarrow{}~[~\ocwlowerid{p}~::~\ocwlowerid{sl}~]$\ocweol
\ocwindent{2.00em}
$]~]~;$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{sloka}:~$\ocwbc{} wrong \ocwec{}\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{p}~=~\ocwlowerid{pada};~$\ocwstring{"|"};~$\ocwlowerid{sl}~=~\ocwlowerid{sloka\_line}~\rightarrow{}~[~\ocwlowerid{p}~::~\ocwlowerid{sl}~]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{p}~=~\ocwlowerid{pada}~\rightarrow{}~[~\ocwlowerid{p}~]$\ocweol
\ocwindent{3.00em}
$\mid{}~`\ocwupperid{EOI}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Empty\ocwvspace{}sanskrit\ocwvspace{}input"}\ocweol
\ocwindent{2.00em}
$]~]~;$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{sanscrit}:~$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{p}~=~\ocwlowerid{pada};~$\ocwstring{"|"};~\ocwstring{"|"}~$\rightarrow{}~[~\ocwlowerid{p}~]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{p}~=~\ocwlowerid{pada};~$\ocwstring{"|"};~$\ocwlowerid{sl}~=~\ocwlowerid{sanscrit}~\rightarrow{}~[~\ocwlowerid{p}~::~\ocwlowerid{sl}~]~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{p}~=~\ocwlowerid{pada};~`\ocwupperid{EOI}~\rightarrow{}~[~\ocwlowerid{p}~]$\ocweol
\ocwindent{3.00em}
$\mid{}~`\ocwupperid{EOI}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Empty\ocwvspace{}sanskrit\ocwvspace{}input"}\ocweol
\ocwindent{2.00em}
$]~]~;$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{skt\_list}~:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{el}~=~\ocwupperid{LIST1}~\ocwlowerid{skt}~\ocwupperid{SEP}~$\ocwstring{","};~`$\ocwupperid{EOI}~\rightarrow{}~\ocwlowerid{el}~]~]~;$\ocweol
\ocwindent{0.00em}
$\ocwupperid{END}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{trad\_string}~\ocwlowerid{entry}~\ocwlowerid{t}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gramskt.}\ocwlowerid{parse\_string}~\ocwlowerid{entry}~\ocwupperid{Loc.}\ocwlowerid{ghost}~\ocwlowerid{t}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~\ocwlowerid{e}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwupperid{Format.}\ocwlowerid{eprintf}~$\ocwstring{"\symbol{92}nIn\ocwvspace{}string\ocwvspace{}\symbol{92}"\%s\symbol{92}",\ocwvspace{}at\ocwvspace{}location\ocwvspace{}\%s\ocwvspace{}:\symbol{92}n\%!"}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{t}~(\ocwupperid{Loc.}\ocwlowerid{to\_string}~\ocwlowerid{loc})$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{raise}~\ocwlowerid{e}$\ocweol
\ocwindent{2.50em}
\}~\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{trad\_skt}~=~\ocwlowerid{trad\_string}~\ocwlowerid{skt1}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{trad\_sanscrit}~=~\ocwlowerid{trad\_string}~\ocwlowerid{sanscrit}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{trad\_skt\_list}~=~\ocwlowerid{trad\_string}~\ocwlowerid{skt\_list}$\ocweol
\ocwindent{1.00em}
;\medskip

\label{sanskrit.ml:3607}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{maha\_epic}~=~$\ocwstring{"Mahaabhaarata"}~\ocwbc{} for \ocwbegindcode{}$\ocwupperid{Print\_html}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{rama\_epic}~=~$\ocwstring{"Raamaaya.na"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_to\_tex}~=~\ocwupperid{Transduction.}\ocwlowerid{skt\_to\_tex};~$\ocwbc{} romanisation Tex diacritics \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_to\_dev}~=~\ocwupperid{Transduction.}\ocwlowerid{skt\_to\_dev};~$\ocwbc{} devanagari devnag \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_to\_html}~=~\ocwupperid{Transduction.}\ocwlowerid{skt\_to\_html};~$\ocwbc{} romanisation \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Encoding functions skt -> word 
\ocweol
\label{sanskrit.ml:3949}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{raw\_sanskrit\_word}~=~\ocwupperid{Transduction.}\ocwlowerid{code\_raw};~$\ocwbc{} no normalisation no accent\ocwec{}~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sanskrit\_word}~=~\ocwupperid{Encode.}\ocwlowerid{code\_string};~$\ocwbc{} normalisation \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_raw\_to\_deva}~=~\ocwupperid{Encode.}\ocwlowerid{skt\_raw\_to\_deva};~$\ocwbc{} devanagari unicode \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_raw\_strip\_to\_deva}~=~\ocwupperid{Encode.}\ocwlowerid{skt\_raw\_strip\_to\_deva};~$\ocwbc{} idem \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_to\_anchor}~=~\ocwupperid{Encode.}\ocwlowerid{anchor};~$\ocwbc{} hypertext anchor encoding \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rev\_stem\_skt}~=~\ocwupperid{Encode.}\ocwlowerid{rev\_stem};~$\ocwbc{} normalised revword \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{normal\_stem}~=~\ocwupperid{Encode.}\ocwlowerid{normal\_stem};~$\ocwbc{} normalised stem as word \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Cleaning up by removing accents - used in \ocwbegindcode{}$\ocwupperid{Print\_dict}$\ocwenddcode{} 
\ocweol
\label{sanskrit.ml:4501}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{clean\_up}~\ocwlowerid{s}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~(\ocwupperid{Transduction.}\ocwlowerid{code\_raw}~\ocwlowerid{s})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Following used in \ocwbegindcode{}$\ocwupperid{Print\_dict}$\ocwenddcode{} and \ocwbegindcode{}$\ocwupperid{Subst}$\ocwenddcode{} -- ought to disappear \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{normal\_stem\_skt}~=~\ocwupperid{Encode.}\ocwlowerid{normal\_stem\_str};~$\ocwbc{} normalised stem as string \ocwec{}\medskip

\label{sanskrit.ml:4713}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{code\_skt\_ref}~=~\ocwupperid{Encode.}\ocwlowerid{code\_skt\_ref};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{code\_skt\_ref\_d}~=~\ocwupperid{Encode.}\ocwlowerid{code\_skt\_ref\_d};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{decode\_skt}~=~\ocwupperid{Canon.}\ocwlowerid{decode}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Padapatha}~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{padapatha}~\ocwlowerid{sanskrit\_chunk}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sanskrit\_sentence}~\ocwlowerid{strm}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gramskt.}\ocwlowerid{parse}~\ocwlowerid{sanscrit}~\ocwupperid{Loc.}\ocwlowerid{ghost}~\ocwlowerid{strm}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~\ocwupperid{Exit}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Encode.In\_error}~$\ocwstring{"Exit"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~(\ocwupperid{Error.E}~\ocwlowerid{msg})~$\ocweol
\ocwindent{2.00em}
$\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Encode.In\_error}~($\ocwstring{"(Lexical)\ocwvspace{}"}~\^{}~$\ocwlowerid{msg}))$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~(\ocwupperid{Stream.Error}~\ocwlowerid{msg})~$\ocweol
\ocwindent{2.00em}
$\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Encode.In\_error}~($\ocwstring{"(Stream)\ocwvspace{}"}~\^{}~$\ocwlowerid{msg}))$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~(\ocwupperid{Failure}~\ocwlowerid{s})~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Encode.In\_error}~\ocwlowerid{s})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~\ocwlowerid{ex}~\rightarrow{}~\ocwlowerid{raise}~\ocwlowerid{ex}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} No padapatha processing, each chunk is assumed to be in terminal sandhi 
   already. But normalizes away anusvara, contrarily to its name \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} encode is \ocwbegindcode{}$\ocwlowerid{raw\_sanskrit\_word}$\ocwenddcode{}, \ocwbegindcode{}$\ocwlowerid{raw\_sanskrit\_word\_KH}$\ocwenddcode{}, etc. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{read\_raw\_skt\_stream}~\ocwlowerid{encode}~\ocwlowerid{strm}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{process}~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwlowerid{encode}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{sanskrit\_sentence}~\ocwlowerid{strm}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{l}~]~\rightarrow{}~\ocwlowerid{process}~\ocwlowerid{l}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{lines}~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{fold\_right}~\ocwlowerid{concat}~\ocwlowerid{lines}~[\,]$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{where}~\ocwlowerid{concat}~\ocwlowerid{line}~\ocwlowerid{lines}~=~\ocwlowerid{process}~\ocwlowerid{line}~@~\ocwlowerid{lines}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{read\_processed\_skt\_stream}~\ocwlowerid{encode}~\ocwlowerid{strm}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{process}~=~\ocwlowerid{padapatha}~(\ocwlowerid{sanskrit\_chunk}~\ocwlowerid{encode})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{sanskrit\_sentence}~\ocwlowerid{strm}~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{l}~]~\rightarrow{}~\ocwlowerid{process}~\ocwlowerid{l}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{lines}~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{fold\_right}~\ocwlowerid{concat}~\ocwlowerid{lines}~[\,]$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{where}~\ocwlowerid{concat}~\ocwlowerid{line}~\ocwlowerid{lines}~=~\ocwlowerid{process}~\ocwlowerid{line}~@~\ocwlowerid{lines}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} assumes Velthuis encoding \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{read\_corpus}~\ocwlowerid{unsandhied}~\ocwlowerid{chi}~=~$\ocwbc{} only used by Tagger1 \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{encode}~=~\ocwupperid{Transduction.}\ocwlowerid{code\_raw}~$\ocwbc{} unnormalized input from stream \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{channel}~=~\ocwupperid{Stream.}\ocwlowerid{of\_channel}~\ocwlowerid{chi}$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{reader}~=~$\ocwkw{if}~$\ocwlowerid{unsandhied}~$\ocwkw{then}~$\ocwlowerid{read\_raw\_skt\_stream}~$\ocweol
\ocwindent{14.50em}
\ocwkw{else}~$\ocwlowerid{read\_processed\_skt\_stream}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{reader}~\ocwlowerid{encode}~\ocwlowerid{channel}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{read\_VH}~\ocwlowerid{unsandhied}~\ocwlowerid{str}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{encode}~=~\ocwupperid{Encode.}\ocwlowerid{code\_string}~$\ocwbc{} normalized input from string \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{channel}~=~\ocwupperid{Stream.}\ocwlowerid{of\_string}~\ocwlowerid{str}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{reader}~=~$\ocwkw{if}~$\ocwlowerid{unsandhied}~$\ocwkw{then}~$\ocwlowerid{read\_raw\_skt\_stream}~$\ocweol
\ocwindent{14.50em}
\ocwkw{else}~$\ocwlowerid{read\_processed\_skt\_stream}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{reader}~\ocwlowerid{encode}~\ocwlowerid{channel}$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Now general readers with encoding parameter of type \ocwbegindcode{}\ocwbt{string}~$\rightarrow{}~\ocwlowerid{word}$\ocwenddcode{} 
\ocweol
\ocwindent{0.00em}
\ocwbegindcode{}$\ocwlowerid{read\_sanskrit}~:~\ocwlowerid{encoding}~\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{list}~$\ocwlowerid{word}$\ocwenddcode{} 
\ocweol
\ocwindent{0.00em}
Assumes sandhi is not undone between chunks - spaces are not significant 
\ocweol
\ocwindent{0.00em}
Generalizes \ocwbegindcode{}$\ocwlowerid{read\_VH}~\ocwupperid{False}$\ocwenddcode{} to all transliterations 
\ocweol
\label{sanskrit.ml:6943}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{read\_sanskrit}~\ocwlowerid{encode}~\ocwlowerid{str}~=~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{encode}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{word}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{read\_processed\_skt\_stream}~\ocwlowerid{encode}~(\ocwupperid{Stream.}\ocwlowerid{of\_string}~\ocwlowerid{str})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Assumes sandhi is undone between chunks (partial padapatha) \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Generalizes \ocwbegindcode{}$\ocwlowerid{read\_VH}~\ocwupperid{True}$\ocwenddcode{} to all transliterations \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{read\_raw\_sanskrit}~\ocwlowerid{encode}~\ocwlowerid{str}~=~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{encode}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{word}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{read\_raw\_skt\_stream}~\ocwlowerid{encode}~(\ocwupperid{Stream.}\ocwlowerid{of\_string}~\ocwlowerid{str})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Skt_lexer.ml}
\ocwmodule{Skt\_lexer}
\label{skt_lexer.ml:0}%
A simple lexer recognizing idents, integers, punctuation symbols,
   and skipping spaces and comments between % and eol.
   The transliteration scheme is Velthuis with aa for long a etc. 
\ocweol
\label{skt_lexer.ml:813}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Skt\_lexer}~=~$\ocwkw{struct}\medskip

\label{skt_lexer.ml:840}%
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Camlp4.PreCast};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Format};$\medskip

\label{skt_lexer.ml:875}%
\ocwindent{1.00em}
\ocwkw{module}~$\ocwupperid{Loc}~=~\ocwupperid{Loc};~$\ocwbc{} Using the PreCast Loc \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{module}~$\ocwupperid{Error}~=~$\ocwkw{struct}\ocweol
\ocwindent{2.00em}
\ocwkw{type}~$\ocwlowerid{t}~=~$\ocwbt{string};\ocweol
\ocwindent{2.00em}
\ocwkw{exception}~$\ocwupperid{E}~$\ocwkw{of}~$\ocwlowerid{t};$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{value}~\ocwlowerid{to\_string}~\ocwlowerid{x}~=~\ocwlowerid{x};$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{value}~\ocwlowerid{print}~=~\ocwupperid{Format.}\ocwlowerid{pp\_print\_string};$\ocweol
\ocwindent{1.00em}
\ocwkw{end};\ocweol
\ocwindent{1.00em}
\ocwkw{module}~$\ocwupperid{Token}~=~$\ocwkw{struct}\ocweol
\ocwindent{2.00em}
\ocwkw{module}~$\ocwupperid{Loc}~=~\ocwupperid{Loc};~$\ocweol
\ocwindent{2.00em}
\ocwkw{type}~$\ocwlowerid{t}~=$\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{KEYWORD}~$\ocwkw{of}~\ocwbt{string}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{IDENT}~$\ocwkw{of}~\ocwbt{string}~\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{INT}~$\ocwkw{of}~\ocwbt{int}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{EOI}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
;\ocweol
\ocwindent{2.00em}
\ocwkw{module}~$\ocwupperid{Error}~=~\ocwupperid{Error};$\ocweol
\ocwindent{2.00em}
\ocwkw{module}~$\ocwupperid{Filter}~=~$\ocwkw{struct}\ocweol
\ocwindent{3.00em}
\ocwkw{type}~$\ocwlowerid{token\_filter}~=~\ocwupperid{Camlp4.Sig.}\ocwlowerid{stream\_filter}~\ocwlowerid{t}~\ocwupperid{Loc.}\ocwlowerid{t}$\ocweol
\ocwindent{3.00em}
;\ocweol
\ocwindent{3.00em}
\ocwkw{type}~$\ocwlowerid{t}~=~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{bool}\ocweol
\ocwindent{3.00em}
;\ocweol
\ocwindent{3.00em}
$\ocwlowerid{value}~\ocwlowerid{mk}~\ocwlowerid{is\_kwd}~=~\ocwlowerid{is\_kwd}$\ocweol
\ocwindent{3.00em}
;\ocweol
\ocwindent{3.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{filter}~\ocwlowerid{is\_kwd}~=~$\ocwkw{parser}\ocweol
\ocwindent{4.00em}
$[~[:~`((\ocwupperid{KEYWORD}~\ocwlowerid{s},~\ocwlowerid{loc})~$\ocwkw{as}~$\ocwlowerid{p});~\ocwlowerid{strm}~:]~\rightarrow{}$\ocweol
\ocwindent{6.50em}
\ocwkw{if}~$\ocwlowerid{is\_kwd}~\ocwlowerid{s}~$\ocwkw{then}~$[:~`\ocwlowerid{p};~\ocwlowerid{filter}~\ocwlowerid{is\_kwd}~\ocwlowerid{strm}~:]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{raise}~(\ocwupperid{Encode.In\_error}~($\ocwstring{"Undefined\ocwvspace{}token\ocwvspace{}:\ocwvspace{}"}~\^{}~$\ocwlowerid{s}))$\ocweol
\ocwindent{4.00em}
$\mid{}~[:~`\ocwlowerid{x};~\ocwlowerid{s}~:]~\rightarrow{}~[:~`\ocwlowerid{x};~\ocwlowerid{filter}~\ocwlowerid{is\_kwd}~\ocwlowerid{s}~:]$\ocweol
\ocwindent{4.00em}
$\mid{}~[:~:]~\rightarrow{}~[:~:]~$\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{3.00em}
;\ocweol
\ocwindent{3.00em}
$\ocwlowerid{value}~\ocwlowerid{define\_filter}~\ocwlowerid{\_}~\ocwlowerid{\_}~=~()$\ocweol
\ocwindent{3.00em}
;\ocweol
\ocwindent{3.00em}
$\ocwlowerid{value}~\ocwlowerid{keyword\_added}~\ocwlowerid{\_}~\ocwlowerid{\_}~\ocwlowerid{\_}~=~()$\ocweol
\ocwindent{3.00em}
;\ocweol
\ocwindent{3.00em}
$\ocwlowerid{value}~\ocwlowerid{keyword\_removed}~\ocwlowerid{\_}~\ocwlowerid{\_}~=~()$\ocweol
\ocwindent{3.00em}
;\ocweol
\ocwindent{2.00em}
\ocwkw{end}\ocweol
\ocwindent{2.00em}
;\ocweol
\ocwindent{2.00em}
$\ocwlowerid{value}~\ocwlowerid{to\_string}~=~$\ocwkw{fun}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{KEYWORD}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{sprintf}~$\ocwstring{"KEYWORD\ocwvspace{}\%S"}~$\ocwlowerid{s}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{IDENT}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{sprintf}~$\ocwstring{"IDENT\ocwvspace{}\%S"}~$\ocwlowerid{s}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{INT}~\ocwlowerid{i}~\rightarrow{}~\ocwlowerid{sprintf}~$\ocwstring{"INT\ocwvspace{}\%d"}~$\ocwlowerid{i}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{EOI}~\rightarrow{}~$\ocwstring{"EOI"}\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
;\ocweol
\ocwindent{2.00em}
$\ocwlowerid{value}~\ocwlowerid{print}~\ocwlowerid{ppf}~\ocwlowerid{x}~=~\ocwlowerid{pp\_print\_string}~\ocwlowerid{ppf}~(\ocwlowerid{to\_string}~\ocwlowerid{x})$\ocweol
\ocwindent{2.00em}
;\ocweol
\ocwindent{2.00em}
$\ocwlowerid{value}~\ocwlowerid{match\_keyword}~\ocwlowerid{kwd}~=~$\ocwkw{fun}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{KEYWORD}~\ocwlowerid{kwd'}~$\ocwkw{when}~$\ocwlowerid{kwd'}~=~\ocwlowerid{kwd}~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
;\ocweol
\ocwindent{2.00em}
$\ocwlowerid{value}~\ocwlowerid{extract\_string}~=~$\ocwkw{fun}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{INT}~\ocwlowerid{i}~\rightarrow{}~\ocwlowerid{string\_of\_int}~\ocwlowerid{i}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{IDENT}~\ocwlowerid{s}~\mid{}~\ocwupperid{KEYWORD}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{s}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{EOI}~\rightarrow{}~$\ocwstring{""}~\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
;\ocweol
\ocwindent{1.00em}
\ocwkw{end}\ocweol
\ocwindent{1.00em}
;\medskip

\label{skt_lexer.ml:2377}%
\ocwindent{1.00em}
\ocwkw{open}~$\ocwupperid{Token}$\ocweol
\ocwindent{1.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
The string buffering machinery - ddr + np 
\ocweol
\label{skt_lexer.ml:2443}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{store}~\ocwlowerid{buf}~\ocwlowerid{c}~=~$\ocwkw{do}~\{~$\ocwupperid{Buffer.}\ocwlowerid{add\_char}~\ocwlowerid{buf}~\ocwlowerid{c};~\ocwlowerid{buf}~\}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{number}~\ocwlowerid{buf}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{parser}\ocweol
\ocwindent{1.00em}
$[~[:~`(\verb!'0'!..\verb!'9'!~$\ocwkw{as}~$\ocwlowerid{c});~\ocwlowerid{s}~:]~\rightarrow{}~\ocwlowerid{number}~(\ocwlowerid{store}~\ocwlowerid{buf}~\ocwlowerid{c})~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~[:~:]~\rightarrow{}~\ocwupperid{Buffer.}\ocwlowerid{contents}~\ocwlowerid{buf}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{skip\_to\_eol}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{parser}\ocweol
\ocwindent{1.00em}
$[~[:~`\verb!'\n'!~\mid{}~\verb!'\026'!~\mid{}~\verb!'\012'!;~\ocwlowerid{s}~:]~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$\mid{}~[:~`\ocwlowerid{c}~;~\ocwlowerid{s}~:]~\rightarrow{}~\ocwlowerid{skip\_to\_eol}~\ocwlowerid{s}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ident\_char}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{parser}~\ocweol
\ocwindent{1.00em}
$[~[:~`(\verb!'a'!..\verb!'z'!~\mid{}~\verb!'A'!..\verb!'Z'!~\mid{}~\verb!'.'!~\mid{}~\verb!':'!~\mid{}~\verb!'"'!~\mid{}~\verb!'~'!~\mid{}~\verb!'\''!~\mid{}~\verb!'+'!~\mid{}~\verb!'-'!~\mid{}~\verb!'$'!~$\ocwkw{as}~$\ocwlowerid{c})~:]~$\ocweol
\ocwindent{2.00em}
$\rightarrow{}~\ocwlowerid{c}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{ident}~\ocwlowerid{buff}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{parser}\ocweol
\ocwindent{1.00em}
$[~[:~\ocwlowerid{c}~=~\ocwlowerid{ident\_char};~\ocwlowerid{s}~:]~\rightarrow{}~\ocwlowerid{ident}~(\ocwlowerid{store}~\ocwlowerid{buff}~\ocwlowerid{c})~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~[:~:]~\rightarrow{}~\ocwupperid{Buffer.}\ocwlowerid{contents}~\ocwlowerid{buff}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{next\_token\_fun}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{next\_token}~\ocwlowerid{buff}~=$\ocweol
\ocwindent{3.00em}
\ocwkw{parser}~$\ocwlowerid{\_bp}$\ocweol
\ocwindent{3.00em}
$[~[:~\ocwlowerid{c}~=~\ocwlowerid{ident\_char};~\ocwlowerid{s}~=~\ocwlowerid{ident}~(\ocwlowerid{store}~\ocwlowerid{buff}~\ocwlowerid{c})~:]~\rightarrow{}~\ocwupperid{IDENT}~\ocwlowerid{s}$\ocweol
\ocwindent{3.00em}
$\mid{}~[:~`(\verb!'0'!..\verb!'9'!~$\ocwkw{as}~$\ocwlowerid{c});~\ocwlowerid{s}~=~\ocwlowerid{number}~(\ocwlowerid{store}~\ocwlowerid{buff}~\ocwlowerid{c})~:]~\rightarrow{}~\ocwupperid{INT}~(\ocwlowerid{int\_of\_string}~\ocwlowerid{s})$\ocweol
\ocwindent{3.00em}
$\mid{}~[:~`\ocwlowerid{c}~:]~\ocwlowerid{\_ep}~\rightarrow{}~\ocwupperid{KEYWORD}~(\ocwupperid{String.}\ocwlowerid{make}~1~\ocwlowerid{c})$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{next\_token\_loc}~=$\ocweol
\ocwindent{3.00em}
\ocwkw{parser}~$\ocwlowerid{bp}$\ocweol
\ocwindent{3.00em}
$[~[:~`\verb!'%'!;~\ocwlowerid{\_}~=~\ocwlowerid{skip\_to\_eol};~\ocwlowerid{s}~:]~\rightarrow{}~\ocwlowerid{next\_token\_loc}~\ocwlowerid{s}~$\ocwbc{} comments skipped \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[:~`\verb!' '!~\mid{}~\verb!'\n'!~\mid{}~\verb!'\r'!~\mid{}~\verb!'\t'!~\mid{}~\verb!'\026'!~\mid{}~\verb!'\012'!;~\ocwlowerid{s}~:]~\rightarrow{}~\ocwlowerid{next\_token\_loc}~\ocwlowerid{s}$\ocweol
\ocwindent{3.00em}
$\mid{}~[:~\ocwlowerid{tok}~=~\ocwlowerid{next\_token}~(\ocwupperid{Buffer.}\ocwlowerid{create}~80)~:]~\ocwlowerid{ep}~\rightarrow{}~(\ocwlowerid{tok},~(\ocwlowerid{bp},~\ocwlowerid{ep}))$\ocweol
\ocwindent{3.00em}
$\mid{}~[:~\ocwlowerid{\_}~=~\ocwupperid{Stream.}\ocwlowerid{empty}~:]~\rightarrow{}~(\ocwupperid{EOI},~(\ocwlowerid{bp},~\ocwlowerid{succ}~\ocwlowerid{bp}))$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{0.50em}
$\ocwlowerid{next\_token\_loc}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{mk}~()~=$\ocweol
\ocwindent{0.50em}
\ocwkw{let}~$\ocwlowerid{err}~\ocwlowerid{loc}~\ocwlowerid{msg}~=~\ocwupperid{Loc.}\ocwlowerid{raise}~\ocwlowerid{loc}~(\ocwupperid{Token.Error.E}~\ocwlowerid{msg})~$\ocwkw{in}\ocweol
\ocwindent{0.50em}
\ocwkw{fun}~$\ocwlowerid{init\_loc}~\ocwlowerid{cstrm}~\rightarrow{}~\ocwupperid{Stream.}\ocwlowerid{from}~$\ocweol
\ocwindent{2.50em}
$($\ocwkw{fun}~$\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{try}~\ocwkw{let}~$(\ocwlowerid{tok},~(\ocwlowerid{bp},~\ocwlowerid{ep}))~=~\ocwlowerid{next\_token\_fun}~\ocwlowerid{cstrm}~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{loc}~=~\ocwupperid{Loc.}\ocwlowerid{move}~`\ocwlowerid{start}~\ocwlowerid{bp}~(\ocwupperid{Loc.}\ocwlowerid{move}~`\ocwlowerid{stop}~\ocwlowerid{ep}~\ocwlowerid{init\_loc})~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
$\ocwupperid{Some}~(\ocwlowerid{tok},~\ocwlowerid{loc})$\ocweol
\ocwindent{7.50em}
\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~\ocwupperid{Stream.Error}~\ocwlowerid{str}~\rightarrow{}$\ocweol
\ocwindent{8.50em}
\ocwkw{let}~$\ocwlowerid{bp}~=~\ocwupperid{Stream.}\ocwlowerid{count}~\ocwlowerid{cstrm}~$\ocwkw{in}\ocweol
\ocwindent{8.50em}
\ocwkw{let}~$\ocwlowerid{loc}~=~\ocwupperid{Loc.}\ocwlowerid{move}~`\ocwlowerid{start}~\ocwlowerid{bp}~(\ocwupperid{Loc.}\ocwlowerid{move}~`\ocwlowerid{stop}~(\ocwlowerid{bp}+1)~\ocwlowerid{init\_loc})~$\ocwkw{in}\ocweol
\ocwindent{8.50em}
$\ocwlowerid{err}~\ocwlowerid{loc}~\ocwlowerid{str}~])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end};~\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Test_stamp.ml}
\ocwmodule{Test\_stamp}
\label{test_stamp.ml:0}%
Tests consistency of data version of \ocwbegindcode{}$\ocwupperid{Heritage\_Resources}$\ocwenddcode{}
   with program version of \ocwbegindcode{}$\ocwupperid{Heritage\_Platform}$\ocwenddcode{} 
\ocweol
\label{test_stamp.ml:731}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{check\_data\_version}~()~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{resources\_version\_file}~=~\ocwupperid{Paths.}\ocwlowerid{skt\_resources\_dir}~$\^{}~\ocwstring{"DATA/version.rem"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{data\_format\_version},~\ocwlowerid{data\_version})~=~$\ocweol
\ocwindent{3.00em}
$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwlowerid{resources\_version\_file}~:~($\ocwbt{int}~$\times{}~$\ocwbt{string}$))~$\ocwkw{in}\ocweol
\ocwindent{1.50em}
\ocwkw{if}~$\ocwupperid{Control.}\ocwlowerid{data\_format\_version}~>~\ocwlowerid{data\_format\_version}~$\ocwkw{then}~\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{print\_string}~$\ocwstring{"Your\ocwvspace{}linguistic\ocwvspace{}data\ocwvspace{}are\ocwvspace{}stale\symbol{92}n"}\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{print\_string}~$\ocwstring{"Your\ocwvspace{}must\ocwvspace{}install\ocwvspace{}a\ocwvspace{}recent\ocwvspace{}version\ocwvspace{}of\ocwvspace{}Heritage\_Resources\symbol{92}n"}\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{exit}~1$\ocweol
\ocwindent{3.00em}
\}~\ocwkw{else}\ocweol
\ocwindent{1.50em}
\ocwkw{if}~$\ocwupperid{Control.}\ocwlowerid{data\_format\_version}~<~\ocwlowerid{data\_format\_version}~$\ocwkw{then}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{print\_string}~$\ocwstring{"Your\ocwvspace{}Heritage\_Platform\ocwvspace{}installation\ocwvspace{}is\ocwvspace{}too\ocwvspace{}old\symbol{92}n"}\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{print\_string}~$\ocwstring{"Your\ocwvspace{}must\ocwvspace{}re\symbol{45}install\ocwvspace{}a\ocwvspace{}more\ocwvspace{}recent\ocwvspace{}version\symbol{92}n"}\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{print\_string}~$\ocwstring{"consistent\ocwvspace{}with\ocwvspace{}data\ocwvspace{}format\ocwvspace{}"}\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{print\_int}~\ocwlowerid{data\_format\_version}$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{print\_string}~$\ocwstring{"\symbol{92}n"}\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{exit}~1$\ocweol
\ocwindent{2.50em}
\}~\ocwkw{else}\ocweol
\ocwindent{1.50em}
\ocwkw{if}~$\ocwlowerid{data\_version}~=~\ocwupperid{Version.}\ocwlowerid{version}~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{print\_string}~$\ocwstring{"Warning:\ocwvspace{}this\ocwvspace{}platform\ocwvspace{}release\ocwvspace{}"}\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{print\_string}~($\ocwstring{"assumes\ocwvspace{}version\ocwvspace{}"}~\^{}~$\ocwupperid{Version.}\ocwlowerid{version})$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{print\_string}~$\ocwstring{"of\ocwvspace{}Heritage\_Resources\symbol{92}n"}\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{print\_string}~$\ocwstring{"while\ocwvspace{}the\ocwvspace{}currently\ocwvspace{}installed\ocwvspace{}Heritage\_Resources\ocwvspace{}at\ocwvspace{}"}\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{print\_string}~\ocwlowerid{resources\_version\_file}$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{print\_string}~($\ocwstring{"\ocwvspace{}has\ocwvspace{}version\ocwvspace{}"}~\^{}~$\ocwlowerid{data\_version})$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{print\_string}~$\ocwstring{"\symbol{92}n\ocwvspace{}You\ocwvspace{}should\ocwvspace{}consider\ocwvspace{}updating\ocwvspace{}to\ocwvspace{}recent\ocwvspace{}versions\symbol{92}n"}\ocweol
\ocwindent{2.50em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{try}~$\ocwlowerid{check\_data\_version}~()~$\ocwkw{with}\ocweol
\ocwindent{0.00em}
$[~\ocwupperid{Sys\_error}~\ocwlowerid{m}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Wrong\ocwvspace{}structure\ocwvspace{}of\ocwvspace{}Heritage\_Resources\ocwvspace{}"}~\^{}~$\ocwlowerid{m})~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Dir.mli}
\ocwinterface{Dir}
\label{dir.mli:0}%
Directory operations 
\ocweol
\ocwindent{0.00em}
\ocwbegindcode{}$\ocwlowerid{subdirs}~\ocwlowerid{dir}$\ocwenddcode{} returns the list of subdirectories of \ocwbegindcode{}$\ocwlowerid{dir}$\ocwenddcode{}.  The order
   of the returned list is unspecified.  Raise \ocwbegindcode{}$\ocwupperid{Sys\_error}$\ocwenddcode{} when an
   operating system error occurs.  
\ocweol
\label{dir.mli:824}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{subdirs}~:~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{list}~\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{files\_with\_ext}~\ocwlowerid{ext}~\ocwlowerid{dir}$\ocwenddcode{} returns the list of files in \ocwbegindcode{}$\ocwlowerid{dir}$\ocwenddcode{} with the
   extension \ocwbegindcode{}$\ocwlowerid{ext}$\ocwenddcode{} (e.g. \ocwbegindcode{}\ocwstring{"txt"}\ocwenddcode{}).  The order of the returned list is
   unspecified.  Raise \ocwbegindcode{}$\ocwupperid{Sys\_error}$\ocwenddcode{} when an operating system error
   occurs.  \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{files\_with\_ext}~:~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{list}~\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{split}~\ocwlowerid{path}$\ocwenddcode{} splits \ocwbegindcode{}$\ocwlowerid{path}$\ocwenddcode{} into substrings corresponding to the
   subdirectories of \ocwbegindcode{}$\ocwlowerid{path}$\ocwenddcode{}.  \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{split}~:~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{list}~\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Dir.ml}
\ocwmodule{Dir}
\label{dir.ml:0}%
Return the list of files in the given directory with their absolute
   name.  
\ocweol
\label{dir.ml:702}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{abs\_files}~\ocwlowerid{dir}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{files}~=~\ocwupperid{Array.}\ocwlowerid{to\_list}~(\ocwupperid{Sys.}\ocwlowerid{readdir}~\ocwlowerid{dir})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{map}~(\ocwupperid{Filename.}\ocwlowerid{concat}~\ocwlowerid{dir})~\ocwlowerid{files}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{basenames}~\ocwlowerid{files}~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwupperid{Filename.}\ocwlowerid{basename}~\ocwlowerid{files}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{subdirs}~\ocwlowerid{dir}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{subdirs}~=~\ocwupperid{List.}\ocwlowerid{filter}~\ocwupperid{Sys.}\ocwlowerid{is\_directory}~(\ocwlowerid{abs\_files}~\ocwlowerid{dir})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{subdirs}~|\ensuremath{>}~\ocwlowerid{basenames}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{file\_with\_ext}~\ocwlowerid{ext}~\ocwlowerid{file}~=$\ocweol
\ocwindent{1.00em}
$\lnot{}~(\ocwupperid{Sys.}\ocwlowerid{is\_directory}~\ocwlowerid{file})~\land{}~\ocwupperid{Filename.}\ocwlowerid{check\_suffix}~\ocwlowerid{file}~($\ocwstring{"."}~\^{}~$\ocwlowerid{ext})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{files\_with\_ext}~\ocwlowerid{ext}~\ocwlowerid{dir}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{files}~=~\ocwupperid{List.}\ocwlowerid{filter}~(\ocwlowerid{file\_with\_ext}~\ocwlowerid{ext})~(\ocwlowerid{abs\_files}~\ocwlowerid{dir})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{files}~|\ensuremath{>}~\ocwlowerid{basenames}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{split}~\ocwlowerid{path}~=~\ocwupperid{Str.}\ocwlowerid{split}~(\ocwupperid{Str.}\ocwlowerid{regexp\_string}~\ocwupperid{Filename.}\ocwlowerid{dir\_sep})~\ocwlowerid{path}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Paths.ml}
\ocwmodule{Paths}
\label{paths.ml:0}%
Do not edit by hand - generated by configuration script - see main Makefile 
\ocweol
\label{paths.ml:701}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{platform}~=~$\ocwstring{"Station"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{default\_transliteration}~=~$\ocwstring{"VH"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{default\_lexicon}~=~$\ocwstring{"SH"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{default\_display\_font}~=~$\ocwstring{"roma"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{skt\_install\_dir}~=~$\ocwstring{"/Users/huet/Sanskrit/Heritage\_Platform/"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{skt\_resources\_dir}~=~$\ocwstring{"/Users/huet/Sanskrit/Heritage\_Resources/"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_skt\_dir}~=~$\ocwstring{"/Library/WebServer/Documents/SKT/"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{skt\_dir\_url}~=~$\ocwstring{"/SKT/"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{server\_host}~=~$\ocwstring{"127.0.0.1"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{remote\_server\_host}~=~$\ocwstring{"http://sanskrit.inria.fr/"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_dir\_url}~=~$\ocwstring{"/cgi\symbol{45}bin/SKT/"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_index}~=~$\ocwstring{"sktindex.cgi"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_indexd}~=~$\ocwstring{"sktsearch.cgi"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_lemmatizer}~=~$\ocwstring{"sktlemmatizer.cgi"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_reader}~=~$\ocwstring{"sktreader.cgi"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_parser}~=~$\ocwstring{"sktparser.cgi"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_tagger}~=~$\ocwstring{"skttagger.cgi"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_decl}~=~$\ocwstring{"sktdeclin.cgi"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_conj}~=~$\ocwstring{"sktconjug.cgi"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_sandhier}~=~$\ocwstring{"sktsandhier.cgi"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_graph}~=~$\ocwstring{"sktgraph.cgi"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_user\_aid}~=~$\ocwstring{"sktuser.cgi"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_corpus\_manager}~=~$\ocwstring{"sktcorpus.cgi"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_save\_corpus}~=~$\ocwstring{"savecorpus.cgi"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_mkdir\_corpus}~=~$\ocwstring{"mkdircorpus.cgi"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{mouse\_action}~=~$\ocwstring{"CLICK"};\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Index.ml}
\ocwmodule{Index}
\label{index.ml:0}%
Indexing utility 
\ocweol
\ocwindent{0.00em}
\ocwbegindcode{}$\ocwlowerid{extract\_zip}~:~\ocwlowerid{zipper}~\rightarrow{}~\ocwlowerid{word}$\ocwenddcode{} 
\ocweol
\label{index.ml:738}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{extract\_zip}~=~\ocwlowerid{extract\_zip\_acc}~[\,]$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{extract\_zip\_acc}~\ocwlowerid{suff}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Top}~\rightarrow{}~\ocwlowerid{suff}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Zip}~(\ocwlowerid{\_},\ocwlowerid{\_},\ocwlowerid{n},\ocwlowerid{\_},\ocwlowerid{up})~\rightarrow{}~\ocwlowerid{extract\_zip\_acc}~[~\ocwlowerid{n}~::~\ocwlowerid{suff}~]~\ocwlowerid{up}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Last}~$\ocwkw{of}~\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{previous}~\ocwlowerid{b}~\ocwlowerid{left}~\ocwlowerid{z}~=~$\ocwkw{match}~$\ocwlowerid{left}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{b}~$\ocwkw{then}~$\ocwlowerid{extract\_zip}~\ocwlowerid{z}~$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{z}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~\ocwupperid{Top}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"entry\ocwvspace{}'a'\ocwvspace{}missing"}\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwupperid{Zip}~(\ocwlowerid{b'},\ocwlowerid{l'},\ocwlowerid{\_},\ocwlowerid{\_},\ocwlowerid{z'})~\rightarrow{}~\ocwlowerid{previous}~\ocwlowerid{b'}~\ocwlowerid{l'}~\ocwlowerid{z'}$\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwlowerid{n},\ocwlowerid{t})~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w1}~=~\ocwlowerid{extract\_zip}~\ocwlowerid{z}~$\ocweol
\ocwindent{11.00em}
\ocwkw{and}~$\ocwlowerid{w2}~=~\ocwlowerid{last\_trie}~\ocwlowerid{t}~$\ocwkw{in}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{w1}~@~[~\ocwlowerid{n}~::~\ocwlowerid{w2}~]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Vicious hack to return first homonym if it exists - ugly \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{next\_trie\_homo}~=~\ocwlowerid{next\_rec}~[\,]~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{next\_rec}~\ocwlowerid{pref}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Trie}~(\ocwlowerid{b},\ocwlowerid{l})~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{b}~$\ocwkw{then}~$\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{pref}$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{\_}~=~\ocwupperid{List.}\ocwlowerid{assoc}~51~\ocwlowerid{l}~$\ocwbc{} looking for homonym \#1 \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{6.50em}
$\ocwupperid{List.}\ocwlowerid{rev}~[~51~::~\ocwlowerid{pref}~]~$\ocwbc{} found - we know it is accepting \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwkw{with}~\ocwbc{} no homonym - we keep looking for first accepting suffix \ocwec{}\ocweol
\ocwindent{4.50em}
$[~\ocwupperid{Not\_found}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{l}~$\ocwkw{with}~\ocweol
\ocwindent{5.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"next"}~\ocwbc{} should not happen if trie in normal form \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~[~(\ocwlowerid{n},\ocwlowerid{u})~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{next\_rec}~[~\ocwlowerid{n}~::~\ocwlowerid{pref}~]~\ocwlowerid{u}$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{4.50em}
$]~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{escape}~\ocwlowerid{w}~=~\ocwlowerid{raise}~(\ocwupperid{Last}~(\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{w}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{search}~:~(\ocwlowerid{w}:\ocwlowerid{word})~\rightarrow{}~(\ocwlowerid{t}:\ocwlowerid{trie})~\rightarrow{}~($\ocwbt{string}~$\times{}~$\ocwbt{bool}~$\times{}~$\ocwbt{bool}$)$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Assert : \ocwbegindcode{}$\ocwlowerid{t}$\ocwenddcode{} is not \ocwbegindcode{}$\ocwupperid{Empty}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{search}~\ocwlowerid{w}~\ocwlowerid{t}$\ocwenddcode{} returns either the first member of \ocwbegindcode{}$\ocwlowerid{t}$\ocwenddcode{} with \ocwbegindcode{}$\ocwlowerid{w}$\ocwenddcode{} as initial 
   substring with a boolean \ocwbegindcode{}$\ocwlowerid{exact}$\ocwenddcode{} indicating if the match is exact 
   and another one \ocwbegindcode{}$\ocwlowerid{homo}$\ocwenddcode{} marking homonymy or else raises \ocwbegindcode{}$\ocwupperid{Last}~\ocwlowerid{s}$\ocwenddcode{} 
   with \ocwbegindcode{}$\ocwlowerid{s}$\ocwenddcode{} the last member of \ocwbegindcode{}$\ocwlowerid{t}$\ocwenddcode{} less than \ocwbegindcode{}$\ocwlowerid{w}$\ocwenddcode{} in lexicographic order.
   Beware. Do not change this code if you do not understand fully the specs. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{search}~\ocwlowerid{w}~\ocwlowerid{t}~=~\ocwlowerid{access}~\ocwlowerid{w}~\ocwlowerid{t}~\ocwupperid{Trie.Top}~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{access}~\ocwlowerid{w}~\ocwlowerid{t}~\ocwlowerid{z}~=~$\ocwkw{match}~$\ocwlowerid{w}~$\ocwkw{with}\ocweol
\ocwindent{2.50em}
$[~[\,]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w1}~=~\ocwlowerid{extract\_zip}~\ocwlowerid{z}~$\ocweol
\ocwindent{6.50em}
\ocwkw{and}~$\ocwlowerid{w2}~=~\ocwlowerid{next\_trie\_homo}~\ocwlowerid{t}~$\ocwkw{in}\ocweol
\ocwindent{6.50em}
\ocwkw{let}~$\ocwlowerid{exact}~=~\ocwlowerid{w2}=[\,]~$\ocweol
\ocwindent{6.50em}
\ocwkw{and}~$\ocwlowerid{homo}~=~\ocwlowerid{w2}=[~51~]~$\ocwkw{in}~\ocweol
\ocwindent{6.50em}
$(\ocwupperid{Canon.}\ocwlowerid{decode}~(\ocwlowerid{w1}~@~\ocwlowerid{w2}),\ocwlowerid{exact},\ocwlowerid{homo})$\ocweol
\ocwindent{2.50em}
$\mid{}~[~\ocwlowerid{n}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{t}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Trie}~(\ocwlowerid{b},\ocwlowerid{arcs})~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{arcs}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~[\,]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{b}~$\ocwkw{then}~$\ocwlowerid{escape}~(\ocwlowerid{extract\_zip}~\ocwlowerid{z})$\ocweol
\ocwindent{9.00em}
\ocwkw{else}~$\ocwlowerid{failwith}~$\ocwstring{"Empty\ocwvspace{}trie"}~\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{let}~$(\ocwlowerid{left},\ocwlowerid{right})~=~\ocwupperid{List2.}\ocwlowerid{zip}~\ocwlowerid{n}~\ocwlowerid{arcs}~$\ocwkw{in}~\ocweol
\ocwindent{8.50em}
\ocwkw{match}~$\ocwlowerid{right}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[\,]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w1}=\ocwlowerid{extract\_zip}~\ocwlowerid{z}~$\ocwkw{and}~$\ocwlowerid{w2}=~\ocwlowerid{last\_trie}~\ocwlowerid{t}~$\ocwkw{in}~\ocweol
\ocwindent{10.00em}
$\ocwlowerid{escape}~(\ocwlowerid{w1}~@~\ocwlowerid{w2})$\ocweol
\ocwindent{6.00em}
$\mid{}~[~(\ocwlowerid{m},\ocwlowerid{u})~::~\ocwlowerid{upper}~]~\rightarrow{}~$\ocweol
\ocwindent{7.00em}
\ocwkw{if}~$\ocwlowerid{m}=\ocwlowerid{n}~$\ocwkw{then}~$\ocwlowerid{access}~\ocwlowerid{rest}~\ocwlowerid{u}~(\ocwupperid{Zip}~(\ocwlowerid{b},\ocwlowerid{left},\ocwlowerid{m},\ocwlowerid{upper},\ocwlowerid{z}))~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{escape}~(\ocwlowerid{previous}~\ocwlowerid{b}~\ocwlowerid{left}~\ocwlowerid{z})$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{2.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{read\_entries}~()~=~$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwupperid{Web.}\ocwlowerid{public\_entries\_file}~:~\ocwlowerid{trie})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{is\_in\_lexicon}~\ocwlowerid{word}~=$\ocweol
\ocwindent{1.00em}
\ocwbc{} Checks whether entry \ocwbegindcode{}$\ocwlowerid{word}$\ocwenddcode{} actually appears in the lexicon, \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} so that a reference URL is generated in the answers or not.  \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} NB: not indexed by lexical category \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{entries\_trie}~=~\ocwlowerid{read\_entries}~()~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{Trie.}\ocwlowerid{mem}~\ocwlowerid{word}~\ocwlowerid{entries\_trie}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Phonetics.ml}
\ocwmodule{Phonetics}
\label{phonetics.ml:0}%
Sanskrit phonology 
\ocweol
\label{phonetics.ml:680}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{vowel}~\ocwlowerid{c}~=~\ocwlowerid{c}>0~\land{}~\ocwlowerid{c}<14~$\ocwbc{} a aa i ii u uu .r .rr .l e ai o au \ocwec{}\ocwbc{} Pr{hac} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{anusvar}~\ocwlowerid{c}~=~\ocwlowerid{c}=14~$\ocwbc{} .m : anusvara standing for nasal \ocwec{}\ocweol
\ocwindent{5.50em}
\ocwbc{}  || c=15  candrabindu \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{visarga}~\ocwlowerid{c}~=~\ocwlowerid{c}=16~$\ocwbc{} .h \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{consonant}~\ocwlowerid{c}~=~\ocwlowerid{c}>16~$\ocwbc{} Pr{hal} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{phantom}~\ocwlowerid{c}~=~\ocwlowerid{c}<(-1)~$\ocwbc{} -2 -3=*a -4=*i -5=*u -6=*r \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} final s assimilated to visarga \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{visarg}~\ocwlowerid{c}~=~\ocwlowerid{c}=48~$\ocwbc{} s \ocwec{}~$\lor{}~\ocwlowerid{c}=16~$\ocwbc{} .h \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} final r also assimilated to visarga \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{visargor}~\ocwlowerid{c}~=~\ocwlowerid{visarg}~\ocwlowerid{c}~\lor{}~\ocwlowerid{c}=43~$\ocwbc{} r \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{all\_consonants}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{consonant}~\ocwlowerid{c}~\land{}~\ocwlowerid{all\_consonants}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{consonant\_initial}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{consonant}~\ocwlowerid{c}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{monosyllabic}~=~\ocwlowerid{one\_vowel}$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{one\_vowel}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{all\_consonants}~\ocwlowerid{rest}$\ocweol
\ocwindent{11.50em}
\ocwkw{else}~$\ocwlowerid{one\_vowel}~\ocwlowerid{rest}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{short\_vowel}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~1~\mid{}~3~\mid{}~5~\mid{}~7~\mid{}~9~\rightarrow{}~\ocwupperid{True}~$\ocwbc{} .l included \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{long\_vowel}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~2~\mid{}~4~\mid{}~6~\mid{}~8~\rightarrow{}~\ocwupperid{True}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{avarna}~\ocwlowerid{c}~=~\ocwlowerid{c}<3~$\ocwbc{} a aa \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{ivarna}~\ocwlowerid{c}~=~\ocwlowerid{c}=3~\lor{}~\ocwlowerid{c}=4~$\ocwbc{} i ii \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{uvarna}~\ocwlowerid{c}~=~\ocwlowerid{c}=5~\lor{}~\ocwlowerid{c}=6~$\ocwbc{} u uu \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{rivarna}~\ocwlowerid{c}~=~\ocwlowerid{c}=7~\lor{}~\ocwlowerid{c}=8~$\ocwbc{} .r .rr \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{not\_a\_vowel}~\ocwlowerid{c}~=~\ocwlowerid{vowel}~\ocwlowerid{c}~\land{}~\lnot{}~(\ocwlowerid{avarna}~\ocwlowerid{c})~$\ocwbc{} c>2 and c<14 \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{is\_aa}~\ocwlowerid{c}~=~\ocwlowerid{c}=2$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{not\_short\_vowel}~\ocwlowerid{c}~=~\ocwlowerid{vowel}~\ocwlowerid{c}~\land{}~\lnot{}~(\ocwlowerid{short\_vowel}~\ocwlowerid{c})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} segments a word as a list of syllables - Unused \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{syllables}~=~\ocwlowerid{syllables\_rec}~[\,]~[\,]$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{syllables\_rec}~\ocwlowerid{accu\_syl}~\ocwlowerid{accu\_pho}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{new\_syl}~=~\ocwupperid{List.}\ocwlowerid{rev}~[~\ocwlowerid{c}~::~\ocwlowerid{accu\_pho}~]~$\ocwkw{in}~\ocweol
\ocwindent{4.50em}
$\ocwlowerid{syllables\_rec}~[~\ocwlowerid{new\_syl}~::~\ocwlowerid{accu\_syl}~]~[\,]~\ocwlowerid{rest}~$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~$\ocwlowerid{syllables\_rec}~\ocwlowerid{accu\_syl}~[~\ocwlowerid{c}~::~\ocwlowerid{accu\_pho}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{accu\_syl}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} multi-consonant - used in Verbs for reduplicating aorist \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} we call (mult w) with w starting with a consonant \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{mult}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{\_}~::~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~]~\rightarrow{}~\ocwlowerid{consonant}~\ocwlowerid{c}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} lengthens a vowel \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{long}~\ocwlowerid{c}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{short\_vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocweol
\ocwindent{3.50em}
\ocwkw{if}~$\ocwlowerid{c}=9~$\ocwkw{then}~$\ocwlowerid{failwith}~$\ocwstring{"No\ocwvspace{}long\ocwvspace{}.l"}~\ocwkw{else}~$\ocwlowerid{c}+1$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{c}$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~$\ocwlowerid{failwith}~$\ocwstring{"Bad\ocwvspace{}arg\ocwvspace{}to\ocwvspace{}long"}\ocweol
\ocwindent{0.00em}
\ocwbc{} shortens a vowel \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{short}~\ocwlowerid{c}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{long\_vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{c}-1$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{c}$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~$\ocwlowerid{failwith}~$\ocwstring{"Bad\ocwvspace{}arg\ocwvspace{}to\ocwvspace{}short"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} lengthens the final vowel of a (reverse) stem \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{lengthen}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{v}~::~\ocwlowerid{r}~]~\rightarrow{}~[~\ocwlowerid{long}~\ocwlowerid{v}~::~\ocwlowerid{r}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Bad\ocwvspace{}arg\ocwvspace{}to\ocwvspace{}lengthen"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} unphantom - sed in \ocwbegindcode{}$\ocwupperid{Compile\_sandhi}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{uph}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~-3~\rightarrow{}~[~2~]$\ocweol
\ocwindent{1.00em}
$\mid{}~-4~\rightarrow{}~[~10~]$\ocweol
\ocwindent{1.00em}
$\mid{}~-5~\rightarrow{}~[~12~]$\ocweol
\ocwindent{1.00em}
$\mid{}~-6~\rightarrow{}~[~2;~43~]~$\ocwbc{} aar \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{r}~\rightarrow{}~[~\ocwlowerid{r}~]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} homophonic vowels \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{savarna}~\ocwlowerid{v1}~\ocwlowerid{v2}~=~\ocwlowerid{v1}<9~\land{}~\ocwlowerid{v2}<9~\land{}~(\ocwlowerid{long}~\ocwlowerid{v1}~=~\ocwlowerid{long}~\ocwlowerid{v2})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} special version where c may be a phantom \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{savarna\_ph}~\ocwlowerid{v}~\ocwlowerid{c}~=~(\ocwlowerid{vowel}~\ocwlowerid{c}~\land{}~\ocwlowerid{savarna}~\ocwlowerid{v}~\ocwlowerid{c})~\lor{}~(\ocwlowerid{c}=(-3)~\land{}~\ocwlowerid{avarna}~\ocwlowerid{v})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{velar}~\ocwlowerid{c}~=~\ocwlowerid{c}~>~16~\land{}~\ocwlowerid{c}~<~22~$\ocwbc{} gutturals    : k kh g gh f       \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{palatal}~\ocwlowerid{c}~=~\ocwlowerid{c}~>~21~\land{}~\ocwlowerid{c}~<~27~$\ocwbc{} palatals     : c ch j jh ~n      \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{lingual}~\ocwlowerid{c}~=~\ocwlowerid{c}~>~26~\land{}~\ocwlowerid{c}~<~32~$\ocwbc{} cerebrals    : .t .th .d .dh .n  \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{dental}~\ocwlowerid{c}~=~\ocwlowerid{c}~>~31~\land{}~\ocwlowerid{c}~<~37~$\ocwbc{} dentals      : t th d dh n       \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{labial}~\ocwlowerid{c}~=~\ocwlowerid{c}~>~36~\land{}~\ocwlowerid{c}~<~42~$\ocwbc{} labials      : p ph b bh m       \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{semivowel}~\ocwlowerid{c}~=~\ocwlowerid{c}~>~41~\land{}~\ocwlowerid{c}~<~46~$\ocwbc{} semi vowels  : y r l v  Pr{ya.n} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sibilant}~\ocwlowerid{c}~=~\ocwlowerid{c}~>~45~\land{}~\ocwlowerid{c}~<~49~$\ocwbc{} sibilants    : z .s s   Pr{zar}  \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{aspirate}~\ocwlowerid{c}~=~\ocwlowerid{c}~=~49~$\ocwbc{} h \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{stop}~\ocwlowerid{c}~=~\ocwlowerid{c}~>~16~\land{}~\ocwlowerid{c}~<~42$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{nasal}~\ocwlowerid{c}~=~$\ocweol
\ocwindent{2.50em}
$\ocwlowerid{c}~=~21~$\ocwbc{} f \ocwec{}~$\lor{}~\ocwlowerid{c}~=~26~$\ocwbc{} ~n \ocwec{}~$\lor{}~\ocwlowerid{c}~=~31~$\ocwbc{} .n \ocwec{}~\ocweol
\ocwindent{1.00em}
$\lor{}~\ocwlowerid{c}~=~36~$\ocwbc{} n \ocwec{}~$\lor{}~\ocwlowerid{c}~=~41~$\ocwbc{}  m \ocwec{}~$\lor{}~\ocwlowerid{anusvar}~\ocwlowerid{c}~$\ocwbc{} Pr{~nam} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{n\_or\_f}~\ocwlowerid{c}~=~\ocwlowerid{c}~=~21~$\ocwbc{} f \ocwec{}~$\lor{}~\ocwlowerid{c}~=~36~$\ocwbc{} n \ocwec{}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{homonasal}~\ocwlowerid{c}~=~$\ocwbc{} nasal homophonic to given consonant \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{consonant}~\ocwlowerid{c}~$\ocwkw{then}~\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{velar}~\ocwlowerid{c}~$\ocwkw{then}~21~\ocwbc{} f  \ocwec{}~\ocwkw{else}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{palatal}~\ocwlowerid{c}~$\ocwkw{then}~26~\ocwbc{} ~n \ocwec{}~\ocwkw{else}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{lingual}~\ocwlowerid{c}~$\ocwkw{then}~31~\ocwbc{} .n \ocwec{}~\ocwkw{else}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{dental}~\ocwlowerid{c}~$\ocwkw{then}~36~\ocwbc{}  n \ocwec{}~\ocwkw{else}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{labial}~\ocwlowerid{c}~$\ocwkw{then}~41~\ocwbc{}  m \ocwec{}\ocweol
\ocwindent{7.50em}
\ocwkw{else}~14~\ocwbc{} .m \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{else}~$\ocwlowerid{failwith}~$\ocwstring{"Non\ocwvspace{}consonant\ocwvspace{}arg\ocwvspace{}to\ocwvspace{}homonasal"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} vowel modifiers = anusvaara 14, candrabindu 15 and visarga 16 \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{vowel\_mod}~\ocwlowerid{c}~=~\ocwlowerid{c}>13~\land{}~\ocwlowerid{c}<17~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} eliminate duplicate consonant in test for prosodically long in Verbs \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{contract}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{l}~=~$\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~[~\ocwlowerid{c'}~::~\ocwlowerid{r'}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=\ocwlowerid{c'}~$\ocwkw{then}~$\ocwlowerid{r'}~$\ocwkw{else}~$\ocwlowerid{r}$\ocweol
\ocwindent{4.00em}
$\mid{}~[\,]~\rightarrow{}~[\,]$\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~$[~\ocwlowerid{c}~::~\ocwlowerid{l}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~[\,]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{voiced}~=~$\ocwkw{fun}~\ocwbc{} voices previous phoneme with homophone \ocwec{}\ocweol
\ocwindent{1.00em}
$[~17~\rightarrow{}~19~$\ocwbc{} k   -> g   \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~27~\rightarrow{}~29~$\ocwbc{} .t  -> .d  \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~32~\rightarrow{}~34~$\ocwbc{} t   -> d   \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~37~\rightarrow{}~39~$\ocwbc{} p   -> b   \ocwec{}~\ocweol
\ocwindent{1.00em}
\ocwbc{} next 6 not used by sandhi \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~18~\rightarrow{}~20~$\ocwbc{} kh  -> gh  \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~22~\rightarrow{}~24~$\ocwbc{} c   -> j   \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~23~\rightarrow{}~25~$\ocwbc{} ch  -> jh  \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~28~\rightarrow{}~30~$\ocwbc{} .th -> .dh \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~33~\rightarrow{}~35~$\ocwbc{} th  -> dh  \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~38~\rightarrow{}~40~$\ocwbc{} ph  -> bh  \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~\ocwlowerid{c}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{voiced\_consonant}~\ocwlowerid{c}~=~$\ocwbc{} Pr{jhaz} \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{mem}~\ocwlowerid{c}~[~19;~20;~24;~25;~29;~30;~34;~35;~39;~40~]$\medskip

\label{phonetics.ml:5427}%
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{mute\_consonant}~\ocwlowerid{c}~=$\ocwbc{} Pr{khay} \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{mem}~\ocwlowerid{c}~[~17;~27;~32;~37;~18;~22;~23;~28;~33;~38~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{is\_voiced}~\ocwlowerid{c}~=~$\ocwbc{} voiced phonemes \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{vowel}~\ocwlowerid{c}~\lor{}~\ocwlowerid{voiced\_consonant}~\ocwlowerid{c}~\lor{}~\ocwupperid{List.}\ocwlowerid{mem}~\ocwlowerid{c}~[~42;~43;~45~]~$\ocwbc{} y r v \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Next 5 functions used in Sanskrit.adjust \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{turns\_t\_to\_j}~\ocwlowerid{c}~=~\ocwupperid{List.}\ocwlowerid{mem}~\ocwlowerid{c}~[~24;~25~]~$\ocwbc{} j jh \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{turns\_n\_to\_palatal}~\ocwlowerid{c}~=~\ocwlowerid{palatal}~\ocwlowerid{c}~\lor{}~\ocwlowerid{c}=46~$\ocwbc{} z \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{avagraha}~\ocwlowerid{c}~=~(\ocwlowerid{c}~=~-1)~$\ocwbc{} elided initial a after a.h which turns to o \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{elides\_visarg\_aa}~\ocwlowerid{c}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{voiced\_consonant}~\ocwlowerid{c}~\lor{}~\ocwlowerid{nasal}~\ocwlowerid{c}~\lor{}~\ocwlowerid{semivowel}~\ocwlowerid{c}~\lor{}~\ocwlowerid{aspirate}~\ocwlowerid{c}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{turns\_visarg\_to\_o}~\ocwlowerid{c}~=~\ocwlowerid{elides\_visarg\_aa}~\ocwlowerid{c}~\lor{}~\ocwlowerid{avagraha}~\ocwlowerid{c}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{guna}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~1~\rightarrow{}~[~1~]~$\ocwbc{} a is its own guna \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~2~\rightarrow{}~[~2~]~$\ocwbc{} aa is its own guna and vriddhi \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~3~\mid{}~4~\rightarrow{}~[~10~]~$\ocwbc{} e \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~5~\mid{}~6~\rightarrow{}~[~12~]~$\ocwbc{} o \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~7~\mid{}~8~\rightarrow{}~[~1;~43~]~$\ocwbc{} ar \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~9~\rightarrow{}~[~1;~44~]~$\ocwbc{} al \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{c}~]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{vriddhi}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~1~\mid{}~2~\rightarrow{}~[~2~]~$\ocwbc{} aa \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~3~\mid{}~4~\mid{}~10~\mid{}~11~\rightarrow{}~[~11~]~$\ocwbc{} ai \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~5~\mid{}~6~\mid{}~12~\mid{}~13~\rightarrow{}~[~13~]~$\ocwbc{} au \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~7~\mid{}~8~\rightarrow{}~[~2;~43~]~$\ocwbc{} aar \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~9~\rightarrow{}~[~2;~44~]~$\ocwbc{} aal \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{c}~]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Macdonnel §125 - condition for root of gana 1 to take guna of its stem 
\ocweol
\label{phonetics.ml:6658}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{gunify}~=~$\ocwkw{fun}~\ocwbc{} arg word is reversed stem \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{v}~::~\ocwlowerid{\_}~]~$\ocwkw{when}~$\ocwlowerid{vowel}~\ocwlowerid{v}~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{\_}~::~[~\ocwlowerid{v}~::~\ocwlowerid{\_}~]~]~$\ocwkw{when}~$\ocwlowerid{short\_vowel}~\ocwlowerid{v}~\rightarrow{}~\ocwupperid{True}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Augment computation \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{augment}~\ocwlowerid{x}~=~$\ocwbc{} arg is first letter of root \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{x}~$\ocwkw{then}~$\ocwlowerid{vriddhi}~\ocwlowerid{x}$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{x}~=~23~$\ocwbc{} ch \ocwec{}~\ocwkw{then}~$[~1;~22;~23~]~$\ocwbc{} cch \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{x}>16~\land{}~\ocwlowerid{x}<50~$\ocwkw{then}~$[~1;~\ocwlowerid{x}~]~$\ocwbc{} a prefix of consonant \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{else}~$\ocwlowerid{failwith}~$\ocwstring{"Phonetics.augment"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{aug}~=~$\ocwkw{fun}~\ocwbc{} augment last phoneme of word \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{word}~]~\rightarrow{}~\ocwlowerid{augment}~\ocwlowerid{c}~@~\ocwlowerid{word}$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Empty\ocwvspace{}stem\ocwvspace{}(aug)"}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{light}~=~$\ocwkw{fun}~\ocwbc{} light roots end in short vowel Pan{6,1,69} \ocwec{}\ocweol
\ocwindent{1.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"light"}~\ocweol
\ocwindent{1.50em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{short\_vowel}~\ocwlowerid{c}~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{light\_10}~=~$\ocwkw{fun}~\ocwbc{} light roots end in short vowel Pan{1,4,11} \ocwec{}\ocweol
\ocwindent{1.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"light\_10"}\ocweol
\ocwindent{1.50em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwupperid{False}~$\ocwbc{} ? \ocwec{}~\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"light\_10\_1"}\ocweol
\ocwindent{3.50em}
$\mid{}~[~\ocwlowerid{v}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{short\_vowel}~\ocwlowerid{v}~$\ocwkw{then}~$\ocwupperid{True}~$\ocwkw{else}~$\ocwupperid{False}$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Needed by \ocwbegindcode{}$\ocwupperid{Verbs}.\ocwlowerid{record\_part\_m\_th}$\ocwenddcode{} for proper retroflexion of
   aatmanepada participles in -maana - eg kriyamaa.na \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} all erase last phoneme - used in denominative verbs \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{trunc\_a}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~1~::~\ocwlowerid{w}~]~\rightarrow{}~\ocwlowerid{w}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"trunc\_a"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{trunc\_aa}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~2~::~\ocwlowerid{w}~]~\rightarrow{}~\ocwlowerid{w}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"trunc\_aa"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{trunc\_u}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~5~::~\ocwlowerid{w}~]~\rightarrow{}~\ocwlowerid{w}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"trunc\_u"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{trunc}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{\_}~::~\ocwlowerid{w}~]~\rightarrow{}~\ocwlowerid{w}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{w}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"trunc\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{rdecode}~\ocwlowerid{w})$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Unused 
\ocwbc{} Stem has short vowel in last syllable \ocwec{}
value rec brief = fun  
  \ocwbegindcode{}~$[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Stem\ocwvspace{}with\ocwvspace{}no\ocwvspace{}vowel\ocwvspace{}(brief)"}
~$\mid{}~[~\ocwlowerid{c}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{short\_vowel}~\ocwlowerid{c}
~$\ocwkw{else}~$\ocwlowerid{failwith}~$\ocwstring{"Stem\ocwvspace{}with\ocwvspace{}no\ocwvspace{}vowel\ocwvspace{}(brief)"}
~$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{short\_vowel}~\ocwlowerid{c}
~$\ocwkw{else}~$\ocwlowerid{brief}~\ocwlowerid{r}
~$\ocwenddcode{} 
; 
\ocwbc{} Sandhi of preverb aa- \ocwec{}
\ocwbc{} Unused, but simulated by Inflected. Related to asandhi below. \ocwec{}
value mkphantom = fun \ocwbc{} arg is vowel not avarna and not .rr or .l \ocwec{}
  \ocwbegindcode{}~1~$\mid{}~2~\rightarrow{}~[~-3~]~(\times{}~\ocwlowerid{aa}-\ocwlowerid{a}~\times{})
~\mid{}~3~\mid{}~4~\rightarrow{}~[~-4~]~(\times{}~\ocwlowerid{aa}-\ocwlowerid{i}~\times{})
~\mid{}~5~\mid{}~6~\rightarrow{}~[~-5~]~(\times{}~\ocwlowerid{aa}-\ocwlowerid{u}~\times{})
~\mid{}~7~\rightarrow{}~[~-6~]~(\times{}~\ocwlowerid{aar}~\times{})
~\mid{}~10~\mid{}~11~\rightarrow{}~[~11~]~(\times{}~\ocwlowerid{ai}~\times{})
~\mid{}~12~\mid{}~13~\rightarrow{}~[~13~]~(\times{}~\ocwlowerid{au}~\times{})
~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"mkphantom"}
~\ocwenddcode{}
; \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Sandhi of a and aa with initial vowel (or phantom) (for \ocwbegindcode{}$\ocwupperid{Compile\_sandhi}$\ocwenddcode{}) \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} arg is (vowel not avarna and not .rr or .l) or -2,-4,-5,-6 \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{asandhi}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~3~\mid{}~4~\mid{}~-4~\rightarrow{}~[~10~]~$\ocwbc{} e for i, ii and e-phantom *e \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~5~\mid{}~6~\mid{}~-5~\rightarrow{}~[~12~]~$\ocwbc{} o for u, uu and o-phantom *o \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~7~\rightarrow{}~[~1;~43~]~$\ocwbc{} ar \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-6~\rightarrow{}~[~2;~43~]~$\ocwbc{} aar \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~10~\mid{}~11~\rightarrow{}~[~11~]~$\ocwbc{} ai \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~12~\mid{}~13~\rightarrow{}~[~13~]~$\ocwbc{} au \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~-2~\rightarrow{}~[\,]~$\ocwbc{} amuissement \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"asandhi"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{vowel\_or\_phantom}~\ocwlowerid{c}~=~\ocwlowerid{vowel}~\ocwlowerid{c}~\lor{}~\ocwlowerid{phantom}~\ocwlowerid{c}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Tests whether a word starts with a phantom phoneme (precooked aa-prefixed
   finite or participial or infinitive or abs-ya root form) 
   Used by Morpho, Inflected. Copied in Dispatch. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{phantomatic}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{c}<(-2)~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwbc{} Amuitic forms start with -2 = \ocwbegindcode{}-\ocwenddcode{} which elides preceding -a or -aa from Pv \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{amuitic}~=~$\ocwkw{fun}~$[~[~-2~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwupperid{True}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{end\_aa}~=~$\ocwkw{fun}~$[~[~2~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwupperid{True}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{phantom\_elim}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~-2~::~\ocwlowerid{w}~]~\rightarrow{}~\ocwlowerid{w}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~-3~::~\ocwlowerid{w}~]~\rightarrow{}~[~1~::~\ocwlowerid{w}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~-4~::~\ocwlowerid{w}~]~\rightarrow{}~[~3~::~\ocwlowerid{w}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~-5~::~\ocwlowerid{w}~]~\rightarrow{}~[~5~::~\ocwlowerid{w}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~-6~::~\ocwlowerid{w}~]~\rightarrow{}~[~7~::~\ocwlowerid{w}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{w}~\rightarrow{}~\ocwlowerid{w}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} For m.rj-like verbs (Whitney§219-a) Panini{8,2,36} 
   \ocwstring{"bhraaj"} \ocwstring{"m.rj"} \ocwstring{"yaj1"} \ocwstring{"raaj1"} \ocwstring{"vraj"} \ocwstring{"s.rj1"}
   replace phoneme j=24 by j'=124 with sandhi j'+t = .s.t (j' is j going to z) \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{mrijify}~\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[~24~::~\ocwlowerid{r}~]~\rightarrow{}~[~124~::~\ocwlowerid{r}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"mrijify"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{rdecode}~\ocwlowerid{stem})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} For \ocwstring{"duh"}-like verbs (Whitney§222) \ocwstring{"dah"} \ocwstring{"dih"} \ocwstring{"duh1"} Panini{8,2,32}
   optionnellement \ocwstring{"druh1"} \ocwstring{"muh"} \ocwstring{"snuh1"} \ocwstring{"snih1"} Panini{8,2,33}
   replace phoneme h=49 by h'=149 with sandhi h'+t = gdh (h' is h going to gh) \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{duhify}~\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[~49~::~\ocwlowerid{r}~]~\rightarrow{}~[~149~::~\ocwlowerid{r}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"duhify\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{rdecode}~\ocwlowerid{stem})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} For \ocwstring{"nah"}-like verbs - h'' is h going to dh.
   Replace phoneme h=49 by h''=249 with sandhi h''+t = ddh ) \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{nahify}~\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[~49~::~\ocwlowerid{r}~]~\rightarrow{}~[~249~::~\ocwlowerid{r}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"nahify\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{rdecode}~\ocwlowerid{stem})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Aspiration of initial consonant of root stems ending in aspirate.
   The syllabic loop is necessary for e.g. druh -> dhruk. See Whitney §155. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{syll\_decomp}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{decomp\_rec}~[\,]~\ocwlowerid{c}~\ocwlowerid{rest}$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{decomp\_rec}~\ocwlowerid{cs}~\ocwlowerid{c}~\ocwlowerid{w}~=~$\ocwkw{match}~$\ocwlowerid{w}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~[~\ocwlowerid{c'}~::~\ocwlowerid{rest'}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{consonant}~\ocwlowerid{c'}~$\ocwkw{then}~$\ocwlowerid{decomp\_rec}~[~\ocwlowerid{c}~::~\ocwlowerid{cs}~]~\ocwlowerid{c'}~\ocwlowerid{rest'}$\ocweol
\ocwindent{14.50em}
\ocwkw{else}~$(\ocwlowerid{cs},\ocwlowerid{c},\ocwlowerid{w})$\ocweol
\ocwindent{4.00em}
$\mid{}~[\,]~\rightarrow{}~(\ocwlowerid{cs},\ocwlowerid{c},\ocwlowerid{w})$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"syll\_decomp"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{mk\_aspirate}~\ocwlowerid{w}~=~$\ocwbc{} c-cs-vow is the syllable ending in vow \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{cs},\ocwlowerid{c},\ocwlowerid{rest})~=~\ocwlowerid{syll\_decomp}~\ocwlowerid{w}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{aspc}~=~$\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~19~$\ocwbc{} g \ocwec{}~$\rightarrow{}~20~$\ocwbc{} gh \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~34~$\ocwbc{} d \ocwec{}~$\rightarrow{}~35~$\ocwbc{} dh \ocwec{}~\ocwbc{} e.g. duh {\R} dhuk \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~39~$\ocwbc{} b \ocwec{}~$\rightarrow{}~40~$\ocwbc{} bh \ocwec{}~\ocwbc{} e.g. budh {\R} bhut \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{c}~$\ocwbc{} e.g. v{\d r}dh \ocwec{}\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{cs}~[~\ocwlowerid{aspc}~::~\ocwlowerid{rest}~]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{asp}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{vow}~::~\ocwlowerid{rest}~]~$\ocwkw{when}~$\ocwlowerid{vowel}~\ocwlowerid{vow}~\rightarrow{}~[~\ocwlowerid{vow}~::~\ocwlowerid{mk\_aspirate}~\ocwlowerid{rest}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Penultimate\ocwvspace{}not\ocwvspace{}vowel"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} final form of a pada \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Warning - finalize does NOT replace s or r by visarga, and fails on visarga \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{finalize}~\ocwlowerid{rstem}~=~$\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~[\,]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}~\ocweol
\ocwindent{3.50em}
$[~17~$\ocwbc{} k \ocwec{}~\ocwbc{} first permitted finals \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~18~$\ocwbc{} kh \ocwec{}~\ocweol
\ocwindent{3.50em}
$\mid{}~21~$\ocwbc{} \.n \ocwec{}~\ocweol
\ocwindent{3.50em}
$\mid{}~27~$\ocwbc{} {\d t} \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~28~$\ocwbc{} {\d t}h \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~31~$\ocwbc{} {\d n} \ocwec{}~\ocweol
\ocwindent{3.50em}
$\mid{}~32~$\ocwbc{} t \ocwec{}~\ocwbc{} e.g. marut, vi\'svajit \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~33~$\ocwbc{} th \ocwec{}~\ocweol
\ocwindent{3.50em}
$\mid{}~36~$\ocwbc{} n \ocwec{}~\ocweol
\ocwindent{3.50em}
$\mid{}~37~$\ocwbc{} p \ocwec{}~\ocweol
\ocwindent{3.50em}
$\mid{}~38~$\ocwbc{} ph \ocwec{}~\ocweol
\ocwindent{3.50em}
$\mid{}~41~$\ocwbc{} m \ocwec{}~\ocweol
\ocwindent{3.50em}
$\mid{}~44~$\ocwbc{} l \ocwec{}~\ocwbc{} l needed for praty\=ah\=ara hal \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~45~$\ocwbc{} v \ocwec{}~\ocwbc{} diiv2 \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~43~$\ocwbc{} r \ocwec{}~\ocwbc{} no visarga to keep distinction r/s for segmentation \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~48~$\ocwbc{} s \ocwec{}~$\rightarrow{}~\ocwlowerid{rstem}~$\ocwbc{} but sras -> srat ? \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~19~$\ocwbc{} g \ocwec{}~\ocweol
\ocwindent{3.50em}
$\mid{}~22~$\ocwbc{} c \ocwec{}~\ocweol
\ocwindent{3.50em}
$\mid{}~23~$\ocwbc{} ch \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~24~$\ocwbc{} j \ocwec{}~\ocwbc{} e.g. bhi{\d s}aj; bhuj; as{\d r}j -yuj \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~25~$\ocwbc{} jh \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rest}~$\ocwkw{with}~\ocweol
\ocwindent{5.50em}
$[~[~26~$\ocwbc{} \~n \ocwec{}~::~$\ocwlowerid{ante}~]~\rightarrow{}~[~21~$\ocwbc{} \.n \ocwec{}~::~$\ocwlowerid{ante}~]~$\ocweol
\ocwindent{5.50em}
$\mid{}~[~21~$\ocwbc{} \.n \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{rest}~$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~17~$\ocwbc{} k \ocwec{}~::~$\ocwlowerid{rest}~]~$\ocwbc{} but sometimes {\d t} - beware \ocwec{}\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{3.50em}
$\mid{}~20~$\ocwbc{} gh \ocwec{}~$\rightarrow{}~[~17~$\ocwbc{} k \ocwec{}~::~$\ocwlowerid{asp}~\ocwlowerid{rest}~]~$\ocweol
\ocwindent{3.50em}
$\mid{}~26~$\ocwbc{} \~n \ocwec{}~$\rightarrow{}~[~21~$\ocwbc{} \.n \ocwec{}~::~$\ocwlowerid{rest}~]~$\ocweol
\ocwindent{3.50em}
$\mid{}~29~$\ocwbc{} {\d d} \ocwec{}~\ocweol
\ocwindent{3.50em}
$\mid{}~30~$\ocwbc{} {\d d}h \ocwec{}~\ocwbc{} e. g. vri{\d d}h \ocwec{}~\ocwbc{} asp? \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~124~$\ocwbc{} j' \ocwec{}~$\rightarrow{}~[~27~$\ocwbc{} {\d t} \ocwec{}~::~$\ocwlowerid{rest}~]~$\ocwbc{} e.g. r\=a{\d t} \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~34~$\ocwbc{} d \ocwec{}~$\rightarrow{}~[~32~$\ocwbc{} t \ocwec{}~::~$\ocwlowerid{rest}~]~$\ocwbc{} e.g. suh{\d r}d \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~35~$\ocwbc{} dh \ocwec{}~$\rightarrow{}~[~32~$\ocwbc{} t \ocwec{}~::~$\ocwlowerid{asp}~\ocwlowerid{rest}~]~$\ocwbc{} e.g. budh, v{\d r}dh \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~39~$\ocwbc{} b \ocwec{}~$\rightarrow{}~[~37~$\ocwbc{} p \ocwec{}~::~$\ocwlowerid{rest}~]$\ocweol
\ocwindent{3.50em}
$\mid{}~40~$\ocwbc{} bh \ocwec{}~$\rightarrow{}~[~37~$\ocwbc{} p \ocwec{}~::~$\ocwlowerid{asp}~\ocwlowerid{rest}~]~$\ocwbc{} e.g. kakubh \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~46~$\ocwbc{} \'s \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rest}~$\ocwkw{with}~\ocweol
\ocwindent{5.00em}
\ocwbc{} .t is default and k exception (Henry, Whitney§145,218) \ocwec{}\ocweol
\ocwindent{5.00em}
$[~[~3~::~[~34~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -di\'s {\R} -dik \ocwec{}~\ocweol
\ocwindent{5.00em}
$\mid{}~[~7~::~[~34~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -d{\d r}\'s {\R} -d{\d r}k \ocwec{}~\ocweol
\ocwindent{5.00em}
$\mid{}~[~7~::~[~37~::~[~48~::~\ocwlowerid{\_}~]~]~]~$\ocwbc{} -sp{\d r}\'s {\R} -sp{\d r}k \ocwec{}~\ocweol
\ocwindent{7.00em}
$\rightarrow{}~[~17~$\ocwbc{} k \ocwec{}~::~$\ocwlowerid{rest}~]$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~27~$\ocwbc{} {\d t} \ocwec{}~::~$\ocwlowerid{rest}~]~$\ocwbc{} default \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwbc{} NB optionally nak Whitney§218a \ocwec{}~\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{3.50em}
$\mid{}~47~$\ocwbc{} {\d s} \ocwec{}~$\rightarrow{}~[~27~$\ocwbc{} {\d t} \ocwec{}~::~$\ocwlowerid{rest}~]~$\ocwbc{} e.g. dvi{\d s} {\R} dvi{\d t} \ocwec{}~\ocweol
\ocwindent{3.50em}
$\mid{}~49~$\ocwbc{} h \ocwec{}~$\rightarrow{}~[~27~$\ocwbc{} {\d t} \ocwec{}~::~$\ocwlowerid{asp}~\ocwlowerid{rest}~]~$\ocwbc{} e.g. lih {\R} li{\d t} \ocwec{}~\ocweol
\ocwindent{3.50em}
$\mid{}~149~$\ocwbc{} h' \ocwec{}~$\rightarrow{}~[~17~$\ocwbc{} k \ocwec{}~::~$\ocwlowerid{asp}~\ocwlowerid{rest}~]~$\ocwbc{} -duh {\R} -dhuk , impft doh adhok, etc. \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~249~$\ocwbc{} h'' \ocwec{}~$\rightarrow{}~[~32~$\ocwbc{} t \ocwec{}~::~$\ocwlowerid{asp}~\ocwlowerid{rest}~]~$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{rstem}~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~\ocwkw{let}~$\ocwlowerid{s}~=~\ocwupperid{Canon.}\ocwlowerid{rdecode}~\ocwlowerid{rstem}~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
$\ocwlowerid{failwith}~($\ocwstring{"Illegal\ocwvspace{}stem\ocwvspace{}"}~\^{}~$\ocwlowerid{s}~$\^{}~\ocwstring{"\ocwvspace{}(finalize)"}$)$\ocweol
\ocwindent{3.50em}
$]~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{finalizer}~\ocwlowerid{root}~=~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~[\,]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}~\ocweol
\ocwindent{3.50em}
$[~41~$\ocwbc{} m \ocwec{}~$\rightarrow{}~[~36~$\ocwbc{} n \ocwec{}~::~$\ocwlowerid{rest}~]~$\ocwbc{} Whitney §143a \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{finalize}~\ocwlowerid{root}$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Used in \ocwbegindcode{}$\ocwupperid{Nouns}.\ocwlowerid{build\_root}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{finalize\_r}~\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~[\,]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}~\ocweol
\ocwindent{3.50em}
$[~43~$\ocwbc{} r \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rest}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{l}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{short\_vowel}~\ocwlowerid{c}~$\ocwbc{} giir puurbhyas Whitney §245b \ocwec{}\ocweol
\ocwindent{13.00em}
\ocwkw{then}~$[~43~::~[~\ocwlowerid{long}~\ocwlowerid{c}~::~\ocwlowerid{l}~]~]~$\ocweol
\ocwindent{13.00em}
\ocwkw{else}~$\ocwlowerid{stem}~$\ocweol
\ocwindent{5.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Illegal\ocwvspace{}arg\ocwvspace{}r\ocwvspace{}to\ocwvspace{}finalize"}\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{3.50em}
$\mid{}~48~$\ocwbc{} s \ocwec{}~$\rightarrow{}~[~34~$\ocwbc{} t \ocwec{}~::~$\ocwlowerid{rest}~]~$\ocwbc{} for roots sras dhvas \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{finalize}~\ocwlowerid{stem}~$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} internal sandhi with vowel or 'y' according to Macdonell §59 -- unused
\ocwbegindcode{}$\ocwlowerid{value}~\ocwlowerid{diphthong\_split}~=~$\ocwkw{fun}
~[~10~$(\times{}~\ocwlowerid{e}~\times{})~\rightarrow{}~[~42;~1~]~(\times{}~\ocwlowerid{ay}~\times{})
~\mid{}~11~(\times{}~\ocwlowerid{ai}~\times{})~\rightarrow{}~[~42;~2~]~(\times{}~\ocwlowerid{aay}~\times{})~
~\mid{}~12~(\times{}~\ocwlowerid{o}~\times{})~\rightarrow{}~[~45;~1~]~(\times{}~\ocwlowerid{av}~\times{})~
~\mid{}~13~(\times{}~\ocwlowerid{au}~\times{})~\rightarrow{}~[~45;~2~]~(\times{}~\ocwlowerid{aav}~\times{})
~\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{c}~]
~]
;$\ocwenddcode{} \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Caution. 
Phantom phonemes *a (-3), *i (-4), *u (-5) and *r (-6) are NOT vowels, 
you should use \ocwbegindcode{}$\ocwlowerid{vowel\_or\_phantom}$\ocwenddcode{} function. 
Extra fine-grained phonemes j' (124) h' (149) and h'' (249) are consonants. 
\ocweol
\typeout{OcamlWeb file Int_sandhi.ml}
\ocwmodule{Int\_sandhi}
\label{int_sandhi.ml:0}%
This module defines internal sandhi operations used in morphology computations
   The code is complex - do not change without extensive tests. 
\ocweol
\label{int_sandhi.ml:805}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phonetics};~$\ocwbc{} asp finalize visarg \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Canon};~$\ocwbc{} decode rdecode \ocwec{}\medskip

\label{int_sandhi.ml:881}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{code}~\ocwlowerid{str}~=~\ocwupperid{Encode.}\ocwlowerid{code\_string}~\ocwlowerid{str}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{mirror}~=~\ocwupperid{Word.}\ocwlowerid{mirror}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Retroflexion of s: for all s in w : l = w1 s w2 with w2 not empty and not 
   starting with r, look back in w1 skipping \ocwbegindcode{}$\ocwlowerid{c}$\ocwenddcode{} such that \ocwbegindcode{}$\ocwlowerid{retrokeeps}(\ocwlowerid{c})$\ocwenddcode{}; 
   if \ocwbegindcode{}$\ocwlowerid{retroacts}(\ocwlowerid{c})$\ocwenddcode{} found then s {\R} {\d s}
   and if w2 starts with (t, th, n) then this letter becomes retroflex too. \ocwec{}\medskip

\label{int_sandhi.ml:1229}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{retroacts}~\ocwlowerid{c}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{c}=17~$\ocwbc{} k \ocwec{}~$\lor{}~\ocwlowerid{c}=43~$\ocwbc{} r \ocwec{}~$\lor{}~(\ocwlowerid{vowel}~\ocwlowerid{c}~\land{}~\ocwlowerid{c}>2~\land{}~\lnot{}~(\ocwlowerid{c}=9~$\ocwbc{} {\d l} \ocwec{}$))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{retrokeeps}~\ocwlowerid{c}~=~\ocwlowerid{anusvar}~\ocwlowerid{c}~\lor{}~\ocwlowerid{visarga}~\ocwlowerid{c}~$\ocwbc{} {\d h} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{retros}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{l}~]~\rightarrow{}~\ocwlowerid{retroacts}~\ocwlowerid{c}~\lor{}~(\ocwlowerid{retrokeeps}~\ocwlowerid{c}~\land{}~\ocwlowerid{retros}~\ocwlowerid{l})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{inspects}~\ocwlowerid{accu}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{mirror}~\ocwlowerid{accu}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~]~\rightarrow{}~\ocwlowerid{mirror}~[~\ocwlowerid{c}~::~\ocwlowerid{accu}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~48~$\ocwbc{} s \ocwec{}~::~$[~43~$\ocwbc{} r \ocwec{}~::~$\ocwlowerid{l}~]~]~\rightarrow{}~\ocwlowerid{inspects}~[~43~::~[~48~::~\ocwlowerid{accu}~]~]~\ocwlowerid{l}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~48~$\ocwbc{} s \ocwec{}~::~$\ocwlowerid{l}~]~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{retros}~\ocwlowerid{accu}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{l}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Illegal\ocwvspace{}arg\ocwvspace{}to\ocwvspace{}accu"}\ocweol
\ocwindent{3.50em}
$\mid{}~[~32~$\ocwbc{} t \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{7.00em}
$\ocwlowerid{inspects}~[~27~$\ocwbc{} {\d t} \ocwec{}~::~$[~47~$\ocwbc{} {\d s} \ocwec{}~::~$\ocwlowerid{accu}~]~]~\ocwlowerid{r}$\ocweol
\ocwindent{3.50em}
$\mid{}~[~33~$\ocwbc{} th \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{7.00em}
$\ocwlowerid{inspects}~[~28~$\ocwbc{} {\d t}h \ocwec{}~::~$[~47~$\ocwbc{} {\d s} \ocwec{}~::~$\ocwlowerid{accu}~]~]~\ocwlowerid{r}$\ocweol
\ocwindent{3.50em}
$\mid{}~[~36~$\ocwbc{} n \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{7.00em}
$\ocwlowerid{inspects}~[~31~$\ocwbc{} {\d n} \ocwec{}~::~$[~47~$\ocwbc{} {\d s} \ocwec{}~::~$\ocwlowerid{accu}~]~]~\ocwlowerid{r}$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{l}~\rightarrow{}~\ocwlowerid{inspects}~[~47~$\ocwbc{} {\d s} \ocwec{}~::~$\ocwlowerid{accu}~]~\ocwlowerid{l}$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$\ocwlowerid{inspects}~[~48~$\ocwbc{} s \ocwec{}~::~$\ocwlowerid{accu}~]~\ocwlowerid{l}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{l}~]~\rightarrow{}~\ocwlowerid{inspects}~[~\ocwlowerid{c}~::~\ocwlowerid{accu}~]~\ocwlowerid{l}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{retroflexs}~\ocwlowerid{l}~=~\ocwlowerid{inspects}~[\,]~\ocwlowerid{l}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Retroflexion of n: for all n in w : l = w1 n w2 with w2 not empty and 
   starting with \ocwbegindcode{}$\ocwlowerid{enabling}(\ocwlowerid{c})$\ocwenddcode{}, look back in w1 skipping \ocwbegindcode{}$\ocwlowerid{c}$\ocwenddcode{};
   if \ocwbegindcode{}$\ocwlowerid{retrokeepn}(\ocwlowerid{c})$\ocwenddcode{} and if \ocwbegindcode{}$\ocwlowerid{retroactn}(\ocwlowerid{c})$\ocwenddcode{} found
   then n {\R} {\d n} and if w2 starts with n if becomes {\d n} too. \ocwec{}\medskip

\label{int_sandhi.ml:2550}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{retroactn}~\ocwlowerid{c}~=~\ocwlowerid{rivarna}~\ocwlowerid{c}~\lor{}~\ocwlowerid{c}=43~$\ocwbc{} r \ocwec{}~$\lor{}~\ocwlowerid{c}=47~$\ocwbc{} {\d s} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{retrokeepn}~\ocwlowerid{c}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{velar}~\ocwlowerid{c}~\lor{}~\ocwlowerid{labial}~\ocwlowerid{c}~\lor{}~\ocwlowerid{vowel}~\ocwlowerid{c}~\lor{}~\ocwlowerid{anusvar}~\ocwlowerid{c}~$\ocweol
\ocwindent{5.00em}
$\lor{}~\ocwlowerid{c}=42~$\ocwbc{} y \ocwec{}~$\lor{}~\ocwlowerid{c}=45~$\ocwbc{} v \ocwec{}~$\lor{}~\ocwlowerid{c}=49~$\ocwbc{} h \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{retron}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{retroactn}~\ocwlowerid{c}~\lor{}~(\ocwlowerid{retrokeepn}~\ocwlowerid{c}~\land{}~\ocwlowerid{retron}~\ocwlowerid{rest})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} uses \Pan{8,3,24} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enabling}~\ocwlowerid{c}~=~\ocwlowerid{vowel}~\ocwlowerid{c}~\lor{}~\ocwlowerid{c}=36~\lor{}~\ocwlowerid{c}=41~\lor{}~\ocwlowerid{c}=42~\lor{}~\ocwlowerid{c}=45~$\ocwbc{} n m y v \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{retrn}~\ocwlowerid{c}~=~$\ocwkw{if}~$\ocwlowerid{c}=36~$\ocwkw{then}~31~\ocwbc{} n {\R} {\d n} \ocwec{}~\ocwkw{else}~$\ocwlowerid{c}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{inspectn}~\ocwlowerid{accu}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{mirror}~\ocwlowerid{accu}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~]~\rightarrow{}~\ocwlowerid{mirror}~[~\ocwlowerid{c}~::~\ocwlowerid{accu}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~36~$\ocwbc{} n \ocwec{}~::~$[~\ocwlowerid{c}~::~\ocwlowerid{l}~]~]~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{enabling}~\ocwlowerid{c}~\land{}~\ocwlowerid{retron}~\ocwlowerid{accu}~$\ocwkw{then}~\ocweol
\ocwindent{4.50em}
$\ocwlowerid{inspectn}~[~\ocwlowerid{retrn}~\ocwlowerid{c}~::~[~31~$\ocwbc{} {\d n} \ocwec{}~::~$\ocwlowerid{accu}~]~]~\ocwlowerid{l}$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~$\ocwlowerid{inspectn}~[~36~::~\ocwlowerid{accu}~]~[~\ocwlowerid{c}~::~\ocwlowerid{l}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{l}~]~\rightarrow{}~\ocwlowerid{inspectn}~[~\ocwlowerid{c}~::~\ocwlowerid{accu}~]~\ocwlowerid{l}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{retroflexn}~\ocwlowerid{w}~=~\ocwlowerid{inspectn}~[\,]~\ocwlowerid{w}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ortho\_code}~\ocwlowerid{w}~=~\ocwlowerid{retroflexn}~(\ocwlowerid{retroflexs}~\ocwlowerid{w})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ortho}~\ocwlowerid{s}~=~\ocwlowerid{decode}~(\ocwlowerid{ortho\_code}~(\ocwlowerid{code}~\ocwlowerid{s}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Test examples \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{ortho}~$\ocwstring{"nisanna"}~=~\ocwstring{"ni.sa.n.na"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{ortho}~$\ocwstring{"pranamati"}~=~\ocwstring{"pra.namati"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{ortho}~$\ocwstring{"parinindati"}~=~\ocwstring{"pari.nindati"}$);~$\ocwbc{} could be \ocwstring{"parinindati"} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{ortho}~$\ocwstring{"gurusu"}~=~\ocwstring{"guru.su"}$);$\medskip

\ocwendcode{}\ocwindent{0.00em}
Exceptions: padas not ortho 
\ocweol
\label{int_sandhi.ml:3727}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{ortho}~$\ocwstring{"visarpati"}~=~\ocwstring{"vi.sarpati"}$);~$\ocwbc{} should be \ocwstring{"visarpati"} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Following due to non-IE origin of stem ? \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{ortho}~$\ocwstring{"kusuma"}~=~\ocwstring{"ku.suma"}$);~$\ocwbc{} but \ocwstring{"kusuma"} correct \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{ortho}~$\ocwstring{"pustaka"}~=~\ocwstring{"pu.s.taka"}$);~$\ocwbc{} but \ocwstring{"pustaka"} correct \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Note ortho does not transform final "s" or "r" into visarga 
\ocweol
\ocwindent{0.00em}
Homonasification necessary for present class 7 ~nk->fk 
\ocweol
\ocwindent{0.00em}
Also (very rare) normalisation of anusvara 
\ocweol
\label{int_sandhi.ml:4155}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{homonase}~\ocwlowerid{c}~\ocwlowerid{l}~=~$\ocwkw{match}~$\ocwlowerid{l}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[~14~$\ocwbc{} .m \ocwec{}~::~$\ocwlowerid{r}~]~$\ocwkw{when}~$\ocwlowerid{stop}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{c}~::~[~\ocwlowerid{homonasal}~\ocwlowerid{c}~::~\ocwlowerid{r}~]~]~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~26~$\ocwbc{} ~n \ocwec{}~::~$\ocwlowerid{r}~]~$\ocwkw{when}~$\ocwlowerid{velar}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{c}~::~[~21~$\ocwbc{} f \ocwec{}~::~$\ocwlowerid{r}~]~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~\ocwlowerid{c}~::~\ocwlowerid{l}~]$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Local combination of retron and retros, together with homonasification \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{retro\_join}~\ocwlowerid{left}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{mirror}~\ocwlowerid{left}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~]~\rightarrow{}~\ocwlowerid{mirror}~(\ocwlowerid{homonase}~\ocwlowerid{c}~\ocwlowerid{left})$\ocweol
\ocwindent{1.00em}
$\mid{}~[~36~$\ocwbc{} n \ocwec{}~::~$[~\ocwlowerid{c}~::~\ocwlowerid{l}~]~]~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{enabling}~\ocwlowerid{c}~\land{}~\ocwlowerid{retron}~\ocwlowerid{left}~$\ocwkw{then}~\ocweol
\ocwindent{5.50em}
$\ocwlowerid{retro\_join}~[~\ocwlowerid{retrn}~\ocwlowerid{c}~::~[~31~$\ocwbc{} {\d n} \ocwec{}~::~$\ocwlowerid{left}~]~]~\ocwlowerid{l}$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~$\ocwlowerid{retro\_join}~[~36~::~\ocwlowerid{left}~]~[~\ocwlowerid{c}~::~\ocwlowerid{l}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~48~$\ocwbc{} s \ocwec{}~::~$[~43~$\ocwbc{} r \ocwec{}~::~$\ocwlowerid{l}~]~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
$\ocwlowerid{retro\_join}~[~43~::~[~48~::~\ocwlowerid{left}~]~]~\ocwlowerid{l}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~48~$\ocwbc{} s \ocwec{}~::~$\ocwlowerid{l}~]~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{retros}~\ocwlowerid{left}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{l}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Illegal\ocwvspace{}arg\ocwvspace{}to\ocwvspace{}retro\_join"}\ocweol
\ocwindent{3.00em}
$\mid{}~[~32~$\ocwbc{} t \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{6.50em}
$\ocwlowerid{retro\_join}~[~27~$\ocwbc{} {\d t} \ocwec{}~::~$[~47~$\ocwbc{} {\d s} \ocwec{}~::~$\ocwlowerid{left}~]~]~\ocwlowerid{r}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~33~$\ocwbc{} th \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{6.50em}
$\ocwlowerid{retro\_join}~[~28~$\ocwbc{} {\d t}h \ocwec{}~::~$[~47~$\ocwbc{} {\d s} \ocwec{}~::~$\ocwlowerid{left}~]~]~\ocwlowerid{r}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~36~$\ocwbc{} n \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{6.50em}
$\ocwlowerid{retro\_join}~[~31~$\ocwbc{} {\d n} \ocwec{}~::~$[~47~$\ocwbc{} {\d s} \ocwec{}~::~$\ocwlowerid{left}~]~]~\ocwlowerid{r}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{l}~\rightarrow{}~\ocwlowerid{retro\_join}~[~47~$\ocwbc{} {\d s} \ocwec{}~::~$\ocwlowerid{left}~]~\ocwlowerid{l}$\ocweol
\ocwindent{3.00em}
$]~$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$\ocwlowerid{retro\_join}~[~48~::~\ocwlowerid{left}~]~\ocwlowerid{l}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{l}~]~\rightarrow{}~\ocwlowerid{retro\_join}~(\ocwlowerid{homonase}~\ocwlowerid{c}~\ocwlowerid{left})~\ocwlowerid{l}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} sandhi of -s and -.h \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sglue}~\ocwlowerid{first}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~1~::~\ocwlowerid{\_}~]~\rightarrow{}~[~-1;~12;~\ocwlowerid{first}~]~$\ocwbc{} as -> o \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~48;~\ocwlowerid{first}~]~$\ocwbc{} keep s \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sglue1}~\ocwlowerid{first}~\ocwlowerid{\_}~=~[~48;~\ocwlowerid{first}~]~$\ocwbc{} keep s \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Restore main phoneme from finer distinction. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} We unprime a primed phoneme by modulo 100 \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Codes 124, 149 and 249 ought to disappear if phonemic features introduced \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{restore}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~124~\rightarrow{}~24~$\ocwbc{} restores j' {\R} j \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~149~\mid{}~249~\rightarrow{}~49~$\ocwbc{} restores h' {\R} h and idem h'' \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~\ocwlowerid{c}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Its extension to (reversed) words \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{restore\_stem}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{r}~]~\rightarrow{}~[~\ocwlowerid{restore}~\ocwlowerid{c}~::~\ocwlowerid{r}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~[\,]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Change of final consonant before consonant in internal sandhi \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Gonda §19-II is not quite clear, so we keep a minimum rewrite set. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} What is missing is the removal of all final consonants but one - eg vrazc \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{cons\_cons}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~22~$\ocwbc{} c \ocwec{}~$\mid{}~23~$\ocwbc{} ch \ocwec{}~$\mid{}~24~$\ocwbc{} j \ocwec{}~$\mid{}~25~$\ocwbc{} jh \ocwec{}~$\mid{}~46~$\ocwbc{} \'s \ocwec{}~\ocweol
\ocwindent{8.50em}
$\rightarrow{}~17~$\ocwbc{} k \ocwec{}~\ocwbc{} but sometimes {\d t} like in finalize \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~124~$\ocwbc{} j' \ocwec{}~$\rightarrow{}~47~$\ocwbc{} {\d s} \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~149~$\ocwbc{} h' \ocwec{}~$\rightarrow{}~49~$\ocwbc{} h \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~26~$\ocwbc{} \~n \ocwec{}~$\rightarrow{}~21~$\ocwbc{} \.n \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~34~$\ocwbc{} d \ocwec{}~$\rightarrow{}~32~$\ocwbc{} t \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~35~$\ocwbc{} dh \ocwec{}~$\mid{}~249~$\ocwbc{} h'' \ocwec{}~$\rightarrow{}~33~$\ocwbc{} th \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~\ocwlowerid{c}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Error messages \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{illegal\_left}~\ocwlowerid{w}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{mess}~=~$\ocwstring{"Left\ocwvspace{}arg\ocwvspace{}of\ocwvspace{}sandhi\ocwvspace{}end\ocwvspace{}illegal\ocwvspace{}in\ocwvspace{}"}~\^{}~$(\ocwlowerid{rdecode}~\ocwlowerid{w})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{failwith}~\ocwlowerid{mess}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{illegal\_right}~\ocwlowerid{w}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{mess}~=~$\ocwstring{"Right\ocwvspace{}arg\ocwvspace{}of\ocwvspace{}sandhi\ocwvspace{}beginning\ocwvspace{}illegal\ocwvspace{}in\ocwvspace{}"}~\^{}~$(\ocwlowerid{decode}~\ocwlowerid{w})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{failwith}~\ocwlowerid{mess}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{too\_short}~()~=~\ocwlowerid{failwith}~$\ocwstring{"Left\ocwvspace{}arg\ocwvspace{}of\ocwvspace{}int\_sandhi\ocwvspace{}too\ocwvspace{}short"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Internal sandhi - wl is mirror of code of left string,
                     wr is code of right string.
   Result is code after internal sandhi at their junction. 
   This is a deterministic function.
   Optional rules have to be encoded elsewhere. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{int\_sandhi}~\ocwlowerid{wl}~\ocwlowerid{wr}~=~$\ocwkw{try}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{wl}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~$\ocwbc{} eg \ocwstring{"ap"} \ocwec{}~$\ocwlowerid{wr}$\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{last}~::~\ocwlowerid{before}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{wr}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{mirror}~(\ocwlowerid{finalize}~\ocwlowerid{wl})$\ocweol
\ocwindent{4.00em}
$\mid{}~[~\ocwlowerid{first}~::~\ocwlowerid{after}~]~\rightarrow{}~$\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{last}~$\ocwkw{then}\ocweol
\ocwindent{6.50em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{first}~$\ocwkw{then}~\ocweol
\ocwindent{8.00em}
\ocwkw{let}~$\ocwlowerid{glue}~=$\ocweol
\ocwindent{0.00em}
\ocwbc{} glue is the string replacing \ocwbegindcode{}$\ocwlowerid{last};~\ocwlowerid{first}$\ocwenddcode{} with a special convention:
 when it starts with -1, it means the last letter (an \ocwstring{"a"}) of \ocwbegindcode{}$\ocwlowerid{before}$\ocwenddcode{} is erased,
 and when it starts with -2, it means the last letter (a vowel) of \ocwbegindcode{}$\ocwlowerid{before}$\ocwenddcode{} 
 is lengthened \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{savarna}~\ocwlowerid{last}~\ocwlowerid{first}~$\ocwkw{then}~$[~\ocwlowerid{long}~\ocwlowerid{last}~]~$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{avarna}~\ocwlowerid{last}~$\ocwkw{then}~\ocweol
\ocwindent{9.00em}
\ocwkw{if}~$\ocwlowerid{ivarna}~\ocwlowerid{first}~$\ocwkw{then}~$[~10~]~$\ocwbc{} e \ocwec{}\ocweol
\ocwindent{9.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{uvarna}~\ocwlowerid{first}~$\ocwkw{then}~$[~12~]~$\ocwbc{} o \ocwec{}\ocweol
\ocwindent{9.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{first}~$\ocwkw{with}\ocweol
\ocwindent{11.50em}
$[~7~\rightarrow{}~[~1;~43~]~$\ocwbc{} ar \ocwec{}\ocweol
\ocwindent{11.50em}
$\mid{}~10~\mid{}~11~\rightarrow{}~[~11~]~$\ocwbc{} ai \ocwec{}\ocweol
\ocwindent{11.50em}
$\mid{}~12~\mid{}~13~\rightarrow{}~[~13~]~$\ocwbc{} au \ocwec{}\ocweol
\ocwindent{11.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{".rr\ocwvspace{}or\ocwvspace{}.l\ocwvspace{}initial"}\ocweol
\ocwindent{11.50em}
$]$\ocweol
\ocwindent{7.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{ivarna}~\ocwlowerid{last}~$\ocwkw{then}~$[~42;~\ocwlowerid{first}~]~$\ocwbc{} y \ocwec{}\ocweol
\ocwindent{10.00em}
\ocwbc{} but zrii+as=zriyas \Pan{6,4,77} \ocwec{}\ocweol
\ocwindent{7.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{uvarna}~\ocwlowerid{last}~$\ocwkw{then}~$[~45;~\ocwlowerid{first}~]~$\ocwbc{} v \ocwec{}\ocweol
\ocwindent{10.00em}
\ocwbc{} but bhuu+aadi=bhuuvaadi not bhvaadi irregular? \ocwec{}\ocweol
\ocwindent{7.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{last}=7~\lor{}~\ocwlowerid{last}=8~$\ocwbc{} .r .rr \ocwec{}~\ocwkw{then}~$[~43;~\ocwlowerid{first}~]~$\ocwbc{} r \ocwec{}\ocweol
\ocwindent{7.50em}
\ocwkw{else}~\ocwbc{} last diphthong \ocwec{}\ocweol
\ocwindent{11.50em}
\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{11.50em}
$[~10~$\ocwbc{} e \ocwec{}~$\rightarrow{}~[~1;~42;~$\ocwbc{} ay \ocwec{}~$\ocwlowerid{first}~]~$\ocweol
\ocwindent{11.50em}
$\mid{}~11~$\ocwbc{} ai \ocwec{}~$\rightarrow{}~[~2;~42;~$\ocwbc{} \=ay \ocwec{}~$\ocwlowerid{first}~]~$\ocweol
\ocwindent{11.50em}
$\mid{}~12~$\ocwbc{} o \ocwec{}~$\rightarrow{}~[~1;~45;~$\ocwbc{} av \ocwec{}~$\ocwlowerid{first}~]~$\ocweol
\ocwindent{11.50em}
$\mid{}~13~$\ocwbc{} au \ocwec{}~$\rightarrow{}~[~2;~45;~$\ocwbc{} \=av \ocwec{}~$\ocwlowerid{first}~]~$\ocweol
\ocwindent{11.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{illegal\_left}~\ocwlowerid{wl}$\ocweol
\ocwindent{11.50em}
$]$\ocweol
\ocwindent{6.50em}
\ocwbc{} let glue ... \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{8.00em}
$\ocwlowerid{retro\_join}~\ocwlowerid{before}~(\ocwlowerid{glue}~@~\ocwlowerid{after})$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwbc{} first consonant last vowel \ocwec{}~\ocwkw{match}~$\ocwlowerid{first}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~23~$\ocwbc{} ch \ocwec{}~\ocwkw{when}~$\ocwlowerid{short\_vowel}~\ocwlowerid{last}~\rightarrow{}~$\ocweol
\ocwindent{9.00em}
$(\ocwlowerid{mirror}~\ocwlowerid{wl})~@~[~22~::~\ocwlowerid{wr}~]~$\ocwbc{} cch \ocwec{}~\ocweol
\ocwindent{7.50em}
$\mid{}~42~$\ocwbc{} y \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{9.00em}
\ocwkw{let}~$\ocwlowerid{split}~=~$\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}~\ocwbc{} \Pan{6,1,79} \ocwec{}\ocweol
\ocwindent{15.00em}
$[~12~$\ocwbc{} o \ocwec{}~$\rightarrow{}~[~45;~1~]~$\ocwbc{} av \ocwec{}\ocweol
\ocwindent{15.00em}
$\mid{}~13~$\ocwbc{} au \ocwec{}~$\rightarrow{}~[~45;~2~]~$\ocwbc{} aav \ocwec{}\ocweol
\ocwindent{15.00em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{c}~]~$\ocwbc{} e or ai included \ocwec{}\ocweol
\ocwindent{15.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{9.00em}
$\ocwlowerid{retro\_join}~(\ocwlowerid{split}~@~\ocwlowerid{before})~\ocwlowerid{wr}$\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{retro\_join}~\ocwlowerid{wl}~\ocwlowerid{wr}$\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwbc{} consonant last \ocwec{}~\ocwbc{} should be analysed further \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwkw{if}~$\ocwlowerid{wr}~=~[~32~]~$\ocwbc{} t \ocwec{}~\ocwkw{then}~\ocwbc{} ad hoc \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{wl'}~=~$\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwbc{} s {\d h} \ocwec{}~\ocwkw{then}~\ocweol
\ocwindent{11.00em}
$[~32~::~\ocwlowerid{before}~]~$\ocwbc{} a\'s\=at impft \'s\=as \ocwec{}~\ocwbc{} *azaa.h \ocwec{}\ocweol
\ocwindent{9.50em}
\ocwkw{else}~$\ocwlowerid{finalizer}~\ocwlowerid{wl}~$\ocwkw{in}~\ocweol
\ocwindent{4.50em}
$\ocwlowerid{mirror}~\ocwlowerid{wl'}$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{all\_consonants}~\ocwlowerid{wr}~$\ocwkw{then}~$\ocwlowerid{mirror}~(\ocwlowerid{finalizer}~\ocwlowerid{wl})$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{first}~$\ocwkw{then}~$\ocwlowerid{retro\_join}~[~\ocwlowerid{restore}~\ocwlowerid{last}~::~\ocwlowerid{before}~]~\ocwlowerid{wr}~$\ocweol
\ocwindent{16.00em}
\ocwbc{} j' {\R} j \& h' {\R} h \ocwec{}\ocweol
\ocwindent{8.50em}
\ocwbc{} no doubling of \.n or n for internal sandhi 
                    no change of consonants before vowels, even ch/cch \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwkw{else}~\ocwbc{} both consonant \ocwec{}~\ocwkw{let}~$\ocwlowerid{glue}~=~$\ocwkw{match}~$\ocwlowerid{first}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~17~\mid{}~18~$\ocwbc{} k kh \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{7.50em}
\ocwkw{match}~$\ocwlowerid{cons\_cons}~\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~36;~\ocwlowerid{first}~]~$\ocwbc{} m+k {\R} nk \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~48~\rightarrow{}~[~16;~\ocwlowerid{first}~]~$\ocwbc{} s+k {\R} .hk could also be .sk \ocwbegindcode{}~47;~$\ocwlowerid{first}~$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~39~\mid{}~40~\rightarrow{}~[~37;~\ocwlowerid{first}~]~$\ocwbc{} b bh {\R} p \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~33~\rightarrow{}~[~32;~\ocwlowerid{first}~]~$\ocwbc{} th {\R} t \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~19~\mid{}~20~$\ocwbc{} g gh \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{9.50em}
\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{sglue}~\ocwlowerid{first}~\ocwlowerid{before}$\ocweol
\ocwindent{9.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{cons\_cons}~\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~36;~\ocwlowerid{first}~]~$\ocwbc{} m+g {\R} ng \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{voiced}~\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~22~\mid{}~23~$\ocwbc{} c ch \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{cons\_cons}~\ocwlowerid{last}~$\ocwkw{with}~\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~36;~\ocwlowerid{first}~]~$\ocwbc{} m+c {\R} nc \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~32~\mid{}~34~\rightarrow{}~[~22;~\ocwlowerid{first}~]~$\ocwbc{} t+c {\R} cc, d+c {\R} cc \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~33~\rightarrow{}~[~32;~\ocwlowerid{first}~]~$\ocwbc{} th {\R} t \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~36~\rightarrow{}~[~14;~46;~\ocwlowerid{first}~]~$\ocwbc{} n+c {\R} {\d m}\'sc \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~39~\mid{}~40~\rightarrow{}~[~37;~\ocwlowerid{first}~]~$\ocwbc{} b bh {\R} p \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~$\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{c}~$\ocwkw{then}~46~\ocwbc{} \'s \ocwec{}~\ocwkw{else}~$\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~24~\mid{}~25~$\ocwbc{} j jh \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{8.50em}
\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{sglue}~\ocwlowerid{first}~\ocwlowerid{before}$\ocweol
\ocwindent{8.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{cons\_cons}~\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~36;~\ocwlowerid{first}~]~$\ocwbc{} m+j {\R} nj \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~32~\rightarrow{}~[~24;~\ocwlowerid{first}~]~$\ocwbc{} t+j {\R} jj \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~36~\rightarrow{}~[~26;~\ocwlowerid{first}~]~$\ocwbc{} n+j {\R} \~nj \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{voiced}~\ocwlowerid{c};~\ocwlowerid{first}~]~$\ocwbc{} k+j {\R} gj ? \ocwec{}\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~36~$\ocwbc{} n \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{sglue1}~\ocwlowerid{first}~\ocwlowerid{before}~$\ocwbc{} {\d h}n {\R} rn {\R} r{\d n} \ocwec{}\ocweol
\ocwindent{10.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~36;~36~]~$\ocwbc{} m+n {\R} nn \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~22~\rightarrow{}~[~22;~26~]~$\ocwbc{} c+n {\R} c\~n \ocwec{}~\ocwbc{} Gonda §19-IX \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~24~\mid{}~124~\rightarrow{}~[~24;~26~]~$\ocwbc{} j+n {\R} j\~n \ocwec{}~\ocwbc{} Gonda §19-IX \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~149~\mid{}~249~\rightarrow{}~[~49;~36~]~$\ocwbc{} h'+n {\R} h+n same h'' \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{c};~36~]~$\ocwbc{} no other change - Gonda §19-I (except retroflexion e.g. v.rk.na) \ocwec{}\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~37~\mid{}~38~$\ocwbc{} p ph \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{7.50em}
\ocwkw{match}~$\ocwlowerid{cons\_cons}~\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~33~\rightarrow{}~[~32;~\ocwlowerid{first}~]~$\ocwbc{} th {\R} t \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~39~\mid{}~40~\rightarrow{}~[~37;~\ocwlowerid{first}~]~$\ocwbc{} b bh {\R} p \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~$\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{c}~$\ocwkw{then}~16~\ocwkw{else}~$\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~39~\mid{}~40~$\ocwbc{} b bh \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{sglue}~\ocwlowerid{first}~\ocwlowerid{before}$\ocweol
\ocwindent{14.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{cons\_cons}~\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{voiced}~\ocwlowerid{c};~\ocwlowerid{first}~]~]$\ocweol
\ocwindent{2.50em}
$\mid{}~41~$\ocwbc{} m \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{sglue1}~\ocwlowerid{first}~\ocwlowerid{before}~$\ocwbc{} {\d h}m {\R} rm \ocwec{}\ocweol
\ocwindent{10.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~36;~41~]~$\ocwbc{} m+m {\R} nm \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~\ocwlowerid{restore}~\ocwlowerid{last};~\ocwlowerid{first}~]~$\ocwbc{} no change Gonda §19-I \ocwec{}~\ocweol
\ocwindent{6.50em}
$]~$\ocweol
\ocwindent{2.50em}
$\mid{}~42~$\ocwbc{} y \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{sglue1}~\ocwlowerid{first}~\ocwlowerid{before}~$\ocwbc{} {\d h}y {\R} ry \ocwec{}\ocweol
\ocwindent{10.50em}
\ocwkw{else}~$[~\ocwlowerid{restore}~\ocwlowerid{last};~\ocwlowerid{first}~]~$\ocweol
\ocwindent{2.50em}
$\mid{}~43~$\ocwbc{} r \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}\ocweol
\ocwindent{12.00em}
$[~[~3~::~[~36~::~\ocwlowerid{\_}~]~]~$\ocwbc{} nis-r \ocwec{}~$\rightarrow{}~[~-1~;~4~;~43~]~$\ocwbc{} n{\=\i}r \ocwec{}\ocweol
\ocwindent{12.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~\ocwlowerid{restore}~\ocwlowerid{last};~\ocwlowerid{first}~]$\ocweol
\ocwindent{12.00em}
$]$\ocweol
\ocwindent{10.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~36;~43~]~$\ocwbc{} m+r {\R} nr \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~\ocwlowerid{restore}~\ocwlowerid{last};~\ocwlowerid{first}~]~$\ocwbc{} no other change Gonda §19-I \ocwec{}\ocweol
\ocwindent{6.50em}
$]~$\ocweol
\ocwindent{2.50em}
$\mid{}~44~$\ocwbc{} l \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{sglue1}~\ocwlowerid{first}~\ocwlowerid{before}~$\ocwbc{} {\d h}l {\R} rl \ocwec{}\ocweol
\ocwindent{10.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~36;~44~]~$\ocwbc{} m+l {\R} nl \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~\ocwlowerid{restore}~\ocwlowerid{last};~\ocwlowerid{first}~]~$\ocwbc{} no other change Gonda §19-I \ocwec{}~\ocweol
\ocwindent{6.50em}
$]~$\ocweol
\ocwindent{2.50em}
$\mid{}~45~$\ocwbc{} v \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{sglue1}~\ocwlowerid{first}~\ocwlowerid{before}~$\ocwbc{} {\d h}v {\R} rv \ocwec{}\ocweol
\ocwindent{10.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~36;~45~]~$\ocwbc{} m+v {\R} nv \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~\ocwlowerid{restore}~\ocwlowerid{last};~\ocwlowerid{first}~]~$\ocwbc{} no other change Gonda §19-I \ocwec{}\ocweol
\ocwindent{6.50em}
$]~$\ocweol
\ocwindent{2.50em}
$\mid{}~46~$\ocwbc{} \'s \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{cons\_cons}~\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~32~\mid{}~33~\rightarrow{}~[~22;~23~]~$\ocwbc{} t+\'s {\R} cch \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~36~\mid{}~41~\rightarrow{}~[~14;~46~]~$\ocwbc{} n,m+\'s {\R} {\d m}\'s \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~39~\mid{}~40~\rightarrow{}~[~37;~46~]~$\ocwbc{} b bh {\R} p \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~48~\rightarrow{}~[~16;~46~]~$\ocwbc{} s+\'s {\R} {\d h}\'s \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~47~$\ocwbc{} {\d s} \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{7.50em}
\ocwkw{match}~$\ocwlowerid{cons\_cons}~\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~36~\mid{}~41~\rightarrow{}~[~14;~47~]~$\ocwbc{} n,m+{\d s} {\R} {\d m}{\d s} \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~48~\rightarrow{}~[~16;~47~]~$\ocwbc{} s+{\d s} {\R} {\d h}{\d s} \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~33~\rightarrow{}~[~32;~47~]~$\ocwbc{} th {\R} t \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~39~\mid{}~40~\rightarrow{}~[~37;~47~]~$\ocwbc{} b bh {\R} p \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~24~\rightarrow{}~[~17;~47~]~$\ocwbc{} j+{\d s} {\R} k{\d s} \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~48~$\ocwbc{} s \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{7.50em}
\ocwkw{match}~$\ocwlowerid{cons\_cons}~\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~36~\mid{}~41~\rightarrow{}~[~14;~48~]~$\ocwbc{} n,m+s {\R} {\d m}s \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~47~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}~\ocweol
\ocwindent{7.50em}
$[~[~17~::~\ocwlowerid{\_}~]~\rightarrow{}~[~47~]~$\ocwbc{} k{\d s}+s {\R} k{\d s} \ocwec{}~\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~17;~47~]~$\ocwbc{} {\d s}+s {\R} k{\d s} \ocwec{}~\ocwbc{} Gonda §19-VI \ocwec{}\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{6.50em}
$\mid{}~48~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}~\ocwbc{} horrible glitch \ocwec{}\ocweol
\ocwindent{7.50em}
$[~[\,]~\rightarrow{}~[~48~]~$\ocwbc{} se 2 sg pm as\#1 \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~[~2~]~\rightarrow{}~[~48;~48~]~$\ocwbc{} \=asse 2 sg pm \=as\#2 \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~16;~48~]~$\ocwbc{} {\d h}s \ocwec{}\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{6.50em}
$\mid{}~19~\mid{}~20~\mid{}~49~\rightarrow{}~[~17;~47~]~$\ocwbc{} g,h+s {\R} k{\d s} : lek{\d s}i dhok{\d s}i \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~249~$\ocweol
\ocwindent{6.50em}
$\mid{}~33~\rightarrow{}~[~32;~48~]~$\ocwbc{} th {\R} t  h''+s {\R} ts natsyati\ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~39~\mid{}~40~\rightarrow{}~[~37;~48~]~$\ocwbc{} b bh {\R} p \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~17~\rightarrow{}~[~17;~47~]~$\ocwbc{} yuj yu\~nk+se {\R} yu\.nk{\d s}e \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~29~\mid{}~30~$\ocwbc{} {\d d} {\d d}h \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{9.50em}
\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{sglue}~\ocwlowerid{first}~\ocwlowerid{before}$\ocweol
\ocwindent{9.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{cons\_cons}~\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~36;~\ocwlowerid{first}~]~$\ocwbc{} m+{\d d} {\R} n{\d d} \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~32~\rightarrow{}~[~29;~\ocwlowerid{first}~]~$\ocwbc{} t+{\d d} {\R} {\d d}{\d d} \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~36~\rightarrow{}~[~31;~\ocwlowerid{first}~]~$\ocwbc{} n+{\d d} {\R} {\d n}{\d d} \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{voiced}~\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~34~$\ocwbc{} d \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{sglue}~\ocwlowerid{first}~\ocwlowerid{before}$\ocweol
\ocwindent{10.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{cons\_cons}~\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~36;~\ocwlowerid{first}~]~$\ocwbc{} m+d {\R} nd \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~47~\rightarrow{}~[~29;~29~]~$\ocwbc{} {\d s}+d {\R} {\d d}{\d d}  ? \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{voiced}~\ocwlowerid{c};~$\ocwkw{if}~$\ocwlowerid{lingual}~\ocwlowerid{c}~$\ocwkw{then}~29~\ocwbc{} {\d d} \ocwec{}~\ocwkw{else}~34~$]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~35~$\ocwbc{} dh \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{sglue}~\ocwlowerid{first}~\ocwlowerid{before}$\ocweol
\ocwindent{11.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~32~\mid{}~33~\mid{}~35~\rightarrow{}~[~34;~35~]~$\ocwbc{} dh+dh {\R} ddh \ocwec{}\ocwbc{} Gonda §19-III \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~41~\rightarrow{}~[~36;~35~]~$\ocwbc{} m+dh {\R} ndh \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~49~\rightarrow{}~[~-2;~30~]~$\ocwbc{} h+dh {\R} {\d d}h \ocwec{}~\ocwbc{} Gonda §19-VII \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~22~\mid{}~23~\mid{}~149~\rightarrow{}~[~19;~35~]~$\ocwbc{} c+dh {\R} gdh - dugdhve, vagdhi \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~249~\rightarrow{}~[~34;~35~]~$\ocwbc{} h''+dh {\R} ddh - naddhaa \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~24~\rightarrow{}~[~19;~35~]~$\ocwbc{} j+dh {\R} gdh \ocwec{}\ocwbc{} yu\.ngdhi \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~47~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}~\ocweol
\ocwindent{7.50em}
$[~[~17~::~\ocwlowerid{\_}~]~\rightarrow{}~[~-1;~29;~30~]~$\ocwbc{} k{\d s}+dh {\R} {\d d}{\d d}h - ca{\d d}{\d d}hve \ocwec{}~\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~29;~30~]~$\ocwbc{} {\d s}+dh {\R} {\d d}{\d d}h \ocwec{}~\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{6.50em}
$\mid{}~46~\mid{}~124~\rightarrow{}~[~29;~30~]~$\ocwbc{} \'s+dh {\R} {\d d}{\d d}h id. j' \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{voiced}~\ocwlowerid{c}~;~$\ocwkw{if}~$\ocwlowerid{lingual}~\ocwlowerid{c}~$\ocwkw{then}~30~\ocwbc{} {\d d}h \ocwec{}~\ocwkw{else}~35~$]$\ocweol
\ocwindent{6.50em}
$]~$\ocweol
\ocwindent{2.50em}
$\mid{}~32~$\ocwbc{} t \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}~\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~36;~32~]~$\ocwbc{} m+t {\R} {\d m}t = nt \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~20~\mid{}~149~\rightarrow{}~[~19;~35~]~$\ocwbc{} gh+t {\R} gdh \ocwec{}~\ocwbc{} Gonda §19-III \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~19~\mid{}~22~\mid{}~24~\rightarrow{}~[~17;~32~]~$\ocwbc{} g+t {\R} kt \ocwec{}~\ocwbc{} \Pan{8,4,54} \ocwec{}\ocweol
\ocwindent{11.00em}
\ocwbc{} id c+t {\R} kt \ocwec{}~\ocwbc{} Gonda §19-V ? \ocwec{}\ocweol
\ocwindent{11.00em}
\ocwbc{} id j+t {\R} kt \ocwec{}~\ocwbc{} yukta anakti bhunakti \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~23~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}~\ocweol
\ocwindent{7.50em}
$[~[~22~::~\ocwlowerid{\_}~]~\rightarrow{}~[~-1;~47;~27~]~$\ocwbc{} cch+t {\R} {\d s}{\d t}  eg p.r{\d s}{\d t}a \ocwec{}~\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~47;~27~]~$\ocwbc{} ch+t {\R} {\d s}{\d t} \ocwec{}~\ocwbc{} ? \ocwec{}\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{6.50em}
$\mid{}~25~\rightarrow{}~[~24;~35~]~$\ocwbc{} jh+t {\R} jdh \ocwec{}~\ocwbc{} Gonda §19-III \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~27~\mid{}~29~\rightarrow{}~[~27;~27~]~$\ocwbc{} {\d t}+t {\R} {\d t}{\d t}  {\d d}+t {\R} {\d t}{\d t} \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~28~\rightarrow{}~[~27;~28~]~$\ocwbc{} {\d t}h+t {\R} {\d t}{\d t}h \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~30~\rightarrow{}~[~29;~30~]~$\ocwbc{} {\d d}h+t {\R} {\d d}{\d d}h \ocwec{}~\ocwbc{} Gonda §19-III ? \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~33~\rightarrow{}~[~32;~33~]~$\ocwbc{} th+t {\R} tth \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~34~\rightarrow{}~[~32;~32~]~$\ocwbc{} d+t {\R} tt \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~35~\mid{}~249~\rightarrow{}~[~34;~35~]~$\ocwbc{} dh+t {\R} ddh \ocwec{}~\ocwbc{} Gonda §19-III \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~38~\rightarrow{}~[~37;~33~]~$\ocwbc{} ph+t {\R} pth \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~39~\rightarrow{}~[~37;~32~]~$\ocwbc{} b {\R} p \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~40~\rightarrow{}~[~39;~35~]~$\ocwbc{} bh+t {\R} bdh \ocwec{}~\ocwbc{} Gonda §19-III \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~46~$\ocwbc{} \'s+t {\R} {\d s}{\d t} \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~124~\rightarrow{}~[~47;~27~]~$\ocwbc{} j'+t {\R} {\d s}{\d t}  eg m{\d r}j {\R} m\=ar{\d s}{\d t}i \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~47~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}~\ocweol
\ocwindent{7.50em}
$[~[~17~::~\ocwlowerid{\_}~]~\rightarrow{}~[~-1;~47;~27~]~$\ocwbc{} k{\d s}+t {\R} {\d s}{\d t}  eg ca{\d s}{\d t}e \ocwec{}~\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~47;~27~]~$\ocwbc{} {\d s}+t {\R} {\d s}{\d t} \ocwec{}~\ocwbc{} Gonda §19-V \ocwec{}\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{6.50em}
$\mid{}~49~\rightarrow{}~[~-2;~30~]~$\ocwbc{} h+t {\R} {\d d}h \ocwec{}~\ocwbc{} Gonda §19-VII \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~$\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{c}~$\ocwkw{then}~48~\ocwbc{} s \ocwec{}~\ocwkw{else}~$\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~33~$\ocwbc{} th \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}~\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~36;~\ocwlowerid{first}~]~$\ocwbc{} m+th {\R} {\d m}th = nth \ocwec{}\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~149~$\ocwbc{} h'+t {\R} gdh \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~20~\rightarrow{}~[~19;~35~]~$\ocwbc{} gh+th {\R} gdh \ocwec{}~\ocwbc{} Gonda §19-III \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~22~\mid{}~23~\rightarrow{}~[~17;~33~]~$\ocwbc{} c+th {\R} kth \ocwec{}~\ocwbc{} Gonda §19-V \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~24~\rightarrow{}~[~17;~33~]~$\ocwbc{} j+th {\R} kth \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~25~\rightarrow{}~[~24;~35~]~$\ocwbc{} jh+th {\R} jdh \ocwec{}~\ocwbc{} Gonda §19-III \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~27~\mid{}~28~\mid{}~29~\rightarrow{}~[~27;~28~]~$\ocwbc{} {\d t}(h)+th {\R} {\d t}{\d th}  {\d d}+th {\R} {\d t}{\d th} \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~30~\rightarrow{}~[~29;~30~]~$\ocwbc{} {\d d}h+th {\R} {\d d}{\d d}h \ocwec{}~\ocwbc{} Gonda §19-III ? \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~33~$\ocwbc{} th+th {\R} tth \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~34~\rightarrow{}~[~32;~33~]~$\ocwbc{} d+th {\R} tth \ocwec{}~\ocwbc{} ? \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~35~\mid{}~249~\rightarrow{}~[~34;~35~]~$\ocwbc{} dh+th {\R} ddh \ocwec{}~\ocwbc{} Gonda §19-III \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~39~\rightarrow{}~[~37;~33~]~$\ocwbc{} b {\R} p \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~40~\rightarrow{}~[~39;~35~]~$\ocwbc{} bh+th {\R} bdh \ocwec{}~\ocwbc{} Gonda §19-III \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~124~$\ocwbc{} j'+th {\R} {\d s}{\d t}h eg iya{\d s}{\d t}ha \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~46~\rightarrow{}~[~47;~28~]~$\ocwbc{} \'s+th {\R} {\d s}{\d t}h \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~47~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}~\ocweol
\ocwindent{7.50em}
$[~[~17~::~\ocwlowerid{\_}~]~\rightarrow{}~[~-1;~47;~28~]~$\ocwbc{} k{\d s}+th {\R} {\d s}{\d t}h \ocwec{}~\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~47;~28~]~$\ocwbc{} {\d s}+th {\R} {\d s}{\d t}h \ocwec{}~\ocwbc{} Gonda §19-V \ocwec{}\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{6.50em}
$\mid{}~49~\rightarrow{}~[~-2;~30~]~$\ocwbc{} h+th {\R} {\d d}h \ocwec{}~\ocwbc{} Gonda §19-VII \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~$\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{c}~$\ocwkw{then}~48~\ocwkw{else}~$\ocwlowerid{restore}~\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~27~\mid{}~28~$\ocwbc{} {\d t} {\d t}h \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{cons\_cons}~\ocwlowerid{last}~$\ocwkw{with}~\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~36;~\ocwlowerid{first}~]~$\ocwbc{} m+{\d t} {\R} n{\d t} \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~32~\mid{}~33~\rightarrow{}~[~27;~\ocwlowerid{first}~]~$\ocwbc{} t+{\d t} {\R} {\d t}{\d t}  d+{\d t} {\R} {\d t}{\d t} \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~36~\rightarrow{}~[~14;~47;~\ocwlowerid{first}~]~$\ocwbc{} n+{\d t} {\R} {\d m}{\d s}{\d t} \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~39~\mid{}~40~\rightarrow{}~[~37;~\ocwlowerid{first}~]~$\ocwbc{} b bh {\R} p \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~$\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{c}~$\ocwkw{then}~47~\ocwkw{else}~$\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~49~$\ocwbc{} h \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{4.50em}
\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{sglue}~\ocwlowerid{first}~\ocwlowerid{before}$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{cons\_cons}~\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~17~\rightarrow{}~[~19;~20~]~$\ocwbc{} k+h {\R} ggh \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~27~\rightarrow{}~[~29;~30~]~$\ocwbc{} {\d t}+h {\R} {\d d}{\d d}h \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~32~\mid{}~33~\rightarrow{}~[~34;~35~]~$\ocwbc{} t+h {\R} ddh  d+h {\R} ddh \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~37~\rightarrow{}~[~39;~40~]~$\ocwbc{} p+h {\R} bbh \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~41~\rightarrow{}~[~36;~49~]~$\ocwbc{} m+h {\R} nh \ocwec{}~\ocwbc{} Gonda §19-VIII \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{c};~49~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{illegal\_right}~\ocwlowerid{wr}$\ocweol
\ocwindent{2.50em}
$]~$\ocwbc{} let glue \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$(\ocwlowerid{w1},\ocwlowerid{w2})~=~$\ocwkw{match}~$\ocwlowerid{glue}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"empty\ocwvspace{}glue"}\ocweol
\ocwindent{5.00em}
$\mid{}~[~-1~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{too\_short}~()$\ocweol
\ocwindent{6.50em}
$\mid{}~[~\ocwlowerid{\_}~$\ocwbc{} a \ocwec{}~::~$\ocwlowerid{init}~]~\rightarrow{}~(\ocwlowerid{init},~\ocwlowerid{rest}~@~\ocwlowerid{after})$\ocweol
\ocwindent{6.50em}
$]~$\ocwbc{} as {\R} o \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~[~-2~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{too\_short}~()$\ocweol
\ocwindent{6.50em}
$\mid{}~[~7~$\ocwbc{} {\d r} \ocwec{}~::~$\ocwlowerid{init}~]~\rightarrow{}~(\ocwlowerid{before},~\ocwlowerid{rest}~@~\ocwlowerid{after})~$\ocweol
\ocwindent{6.50em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{init}~]~\rightarrow{}~(\ocwlowerid{w},~\ocwlowerid{rest}~@~\ocwlowerid{after})~$\ocweol
\ocwindent{8.50em}
$\ocwlowerid{where}~\ocwlowerid{w}~=~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$[~\ocwlowerid{long}~\ocwlowerid{c}~::~\ocwlowerid{init}~]~$\ocwbc{} guu.dha \ocwec{}\ocweol
\ocwindent{13.50em}
\ocwkw{else}~$\ocwlowerid{before}~$\ocwbc{} rara{\d m}h+tha {\R} rara{\d m}{\d d}ha \ocwec{}~\ocweol
\ocwindent{6.50em}
$]~$\ocwbc{} Gonda §19-VII \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~(\ocwlowerid{before},~\ocwlowerid{glue}~@~\ocwlowerid{after})$\ocweol
\ocwindent{5.00em}
$]~$\ocwkw{in}~$\ocwlowerid{retro\_join}~\ocwlowerid{w1}~\ocwlowerid{w2}$\ocweol
\ocwindent{4.00em}
$]~$\ocwbc{} match wr \ocwec{}\ocweol
\ocwindent{2.00em}
$]~$\ocwbc{} match wl \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{with}~$[~\ocwupperid{Failure}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{failwith}~\ocwlowerid{mess}$\ocweol
\ocwindent{3.50em}
$\ocwlowerid{where}~\ocwlowerid{mess}~=~\ocwlowerid{s}~$\^{}~\ocwstring{"\ocwvspace{}in\ocwvspace{}int\_sandhi\ocwvspace{}of\ocwvspace{}"}~\^{}~$(\ocwlowerid{rdecode}~\ocwlowerid{wl})~$\^{}~\ocwstring{"\&"}~\^{}~$(\ocwlowerid{decode}~\ocwlowerid{wr})~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{internal\_sandhi}~\ocwlowerid{left}~\ocwlowerid{right}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{decode}~(\ocwlowerid{int\_sandhi}~(\ocwlowerid{mirror}~(\ocwlowerid{code}~\ocwlowerid{left}))~(\ocwlowerid{code}~\ocwlowerid{right}))$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
tests 
\ocweol
\label{int_sandhi.ml:23357}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"ne"}~\ocwstring{"ati"}~=~\ocwstring{"nayati"}$);~$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"budh"}~\ocwstring{"ta"}~=~\ocwstring{"buddha"}$);~$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"rundh"}~\ocwstring{"dhve"}~=~\ocwstring{"runddhve"}$);~$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"d.rz"}~\ocwstring{"ta"}~=~\ocwstring{"d.r.s.ta"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"dvi.s"}~\ocwstring{"ta"}~=~\ocwstring{"dvi.s.ta"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"dvi.s"}~\ocwstring{"dhvam"}~=~\ocwstring{"dvi.d.dhvam"}$);~$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"han"}~\ocwstring{"si"}~=~\ocwstring{"ha.msi"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"labh"}~\ocwstring{"sye"}~=~\ocwstring{"lapsye"}$);~$\ocwbc{} I will take \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"yaj"}~\ocwstring{"na"}~=~\ocwstring{"yaj\~{}na"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"han"}~\ocwstring{"ka"}~=~\ocwstring{"hanka"}$);~$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"gam"}~\ocwstring{"va"}~=~\ocwstring{"ganva"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"lih"}~\ocwstring{"ta"}~=~\ocwstring{"lii.dha"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"manas"}~\ocwstring{"su"}~=~\ocwstring{"mana.hsu"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"jyotis"}~\ocwstring{"stoma"}~=~\ocwstring{"jyoti.h.s.toma"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"manas"}~\ocwstring{"bhis"}~=~\ocwstring{"manobhis"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"bhas"}~\ocwstring{"ya"}~=~\ocwstring{"bhasya"}$);~$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"bho"}~\ocwstring{"ya"}~=~\ocwstring{"bhavya"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"sraj"}~\ocwstring{"su"}~=~\ocwstring{"srak.su"}$);~$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"yuj"}~\ocwstring{"ta"}~=~\ocwstring{"yukta"}$);~$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"yu\~{}nj"}~\ocwstring{"te"}~=~\ocwstring{"yufkte"}$);~$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"tad"}~\ocwstring{""}~=~\ocwstring{"tat"}$);~$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"vid"}~\ocwstring{"aam"}~=~\ocwstring{"vidaam"}$);~$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"nis"}~\ocwstring{"rasa"}~=~\ocwstring{"niirasa"}$);~$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"hi.ms"}~\ocwstring{"aa"}~=~\ocwstring{"hi.msaa"}$);~$\ocwbc{} not hi.m.saa \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{internal\_sandhi}~$\ocwstring{"praa\~{}nc"}~\ocwstring{"s"}~=~\ocwstring{"praaf"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{let}~$\ocwlowerid{adoh}~=~\ocwlowerid{duhify}~(\ocwupperid{Encode.}\ocwlowerid{rev\_code\_string}~$\ocwstring{"adoh"}$)~$\ocwkw{in}~\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{decode}~(\ocwlowerid{int\_sandhi}~\ocwlowerid{adoh}~(\ocwlowerid{code}~$\ocwstring{"t"}$))~=~$\ocwstring{"adhok"}$);~$\ocwbc{} she milked - not \ocwstring{"adho.t"} \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Not fully correct - still to be improved 
   Special cases - to be accommodated at proper point in the derivation Macdonell §60 footnote 1 p 26
d is assimilated before primary suffix -na: ad+na -> anna
t and d are assimilated before secondary suffixes -mat and -maya: vidyunmat m.rnmaya 
\ocweol
\typeout{OcamlWeb file Skt_morph.mli}
\ocwinterface{Skt\_morph}
\label{skt_morph.mli:0}%
Sanskrit morphology interface 
\ocweol
\label{skt_morph.mli:656}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{deictic}~=~[~\ocwupperid{Speaker}~\mid{}~\ocwupperid{Listener}~\mid{}~\ocwupperid{Self}~\mid{}~\ocwupperid{Numeral}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Deictics have their gender determined from the context for pronouns 
of 1st and 2nd person, or the reflexive pronoun \ocwstring{"aatman"}, or numerals over 4 \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{gender}~=~[~\ocwupperid{Mas}~\mid{}~\ocwupperid{Neu}~\mid{}~\ocwupperid{Fem}~\mid{}~\ocwupperid{Deictic}~$\ocwkw{of}~$\ocwlowerid{deictic}~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{genders}~=~$\ocwbt{list}~$\ocwlowerid{gender}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{number}~=~[~\ocwupperid{Singular}~\mid{}~\ocwupperid{Dual}~\mid{}~\ocwupperid{Plural}~]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{case}~=~[~\ocwupperid{Nom}~$\ocwbc{} nominatif \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Acc}~$\ocwbc{} accusatif \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Ins}~$\ocwbc{} instrumental \ocwec{}~\ocwbc{} comitatif (Henry) \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Dat}~$\ocwbc{} datif \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Abl}~$\ocwbc{} ablatif \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Gen}~$\ocwbc{} génitif \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Loc}~$\ocwbc{} locatif \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Voc}~$\ocwbc{} vocatif \ocwec{}\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} The verb system \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{gana}~=~$\ocwbt{int}~\ocwbc{} present class: 1 to 10, plus 11 for denominatives \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{aor\_class}~=~$\ocwbt{int}~\ocwbc{} aorist class: 1 to 7 \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{person}~=~[~\ocwupperid{First}~\mid{}~\ocwupperid{Second}~\mid{}~\ocwupperid{Third}~]~$\ocwbc{} Indian Third, Second and First \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{conjugation}~=~[~\ocwupperid{Primary}~\mid{}~\ocwupperid{Causative}~\mid{}~\ocwupperid{Desiderative}~\mid{}~\ocwupperid{Intensive}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{finite}~=~(\ocwlowerid{conjugation}~\times{}~\ocwlowerid{paradigm})~$\ocwbc{} finite forms of verbs \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{paradigm}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Presenta}~$\ocwkw{of}~$\ocwlowerid{gana}~$\ocwkw{and}~$\ocwlowerid{pr\_mode}~$\ocwbc{} parasmaipade \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Presentm}~$\ocwkw{of}~$\ocwlowerid{gana}~$\ocwkw{and}~$\ocwlowerid{pr\_mode}~$\ocwbc{} aatmanepade \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Presentp}~$\ocwkw{of}~$\ocwlowerid{pr\_mode}~$\ocwbc{} passive of present system \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Conjug}~$\ocwkw{of}~$\ocwlowerid{tense}~$\ocwkw{and}~$\ocwlowerid{voice}~$\ocwbc{} other tenses/aspects \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Perfut}~$\ocwkw{of}~$\ocwlowerid{voice}~$\ocwbc{} periphrastic futur (lu.t) \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{voice}~=~[~\ocwupperid{Active}~\mid{}~\ocwupperid{Middle}~\mid{}~\ocwupperid{Passive}~]~$\ocwbc{} diathesis (pada: Para Atma Ubha) \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pr\_mode}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Present}~$\ocwbc{} (la.t) \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Imperfect}~$\ocwbc{} Preterit (laf) \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Imperative}~$\ocwbc{} (lo.t) \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Optative}~$\ocwbc{} Potential (lif) \ocwec{}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{tense}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Future}~$\ocwbc{} (l.r.t) \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Perfect}~$\ocwbc{} Remote past - resultative aspect (li.t) \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Aorist}~$\ocwkw{of}~$\ocwlowerid{aor\_class}~$\ocwbc{} Immediate past or future - perfective aspect (luf) \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Injunctive}~$\ocwkw{of}~$\ocwlowerid{aor\_class}~$\ocwbc{} (le.t) - also Prohibitive with maa \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Benedictive}~$\ocwbc{} Precative: optative aorist (aazirlif) \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Conditional}~$\ocwbc{} Preterit of future (l.rf) \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} NB from Indo-European: the present stem has the imperfective aspect,
   the aorist one the perfective aspect, and the perfect one the resultative. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Vedic Subjunctive and Pluperfect are not yet taken into account. The only
   non-present passive forms are some passive aorist forms in 3rd sg. \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Verbal adjectives 
\ocweol
\label{skt_morph.mli:2941}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{kritya}~=~$\ocwbt{int}~\ocwbc{} shades of intention of passive future/potential participle: 
   1 -ya (obligation, necessity or possibility, potentiality) (yat kyap .nyat)
   2 -aniiya (fitness, desirability, effectivity) (aniiyar)
   3 -tavya (necessity, unavoidability) (tavyat) \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{verbal}~=~(\ocwlowerid{conjugation}~\times{}~\ocwlowerid{participle})~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{participle}~=~$\ocwbc{} participles \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} These are the kridanta stems (primary verbal derivatives) with participial 
   value. They act as adjectives or gendered nouns. But \ocwbegindcode{}$\ocwupperid{Ppra}$\ocwenddcode{} does not qualify 
   as a noun, but as an adverb, signifying simultaneous action. \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Ppp}~$\ocwbc{} passive past participle \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pppa}~$\ocwbc{} active past participle \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppra}~$\ocwkw{of}~$\ocwlowerid{gana}~$\ocwbc{} active present participle \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pprm}~$\ocwkw{of}~$\ocwlowerid{gana}~$\ocwbc{} middle present participle \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pprp}~$\ocwbc{} passive present participle \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppfta}~$\ocwbc{} active perfect participle \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppftm}~$\ocwbc{} middle perfect participle \ocwec{}~\ocwbc{} no passive \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfuta}~$\ocwbc{} active future participle \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfutm}~$\ocwbc{} middle future participle \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfutp}~$\ocwkw{of}~$\ocwlowerid{kritya}~$\ocwbc{} passive future/potential participle/gerundive 3 forms \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Action\_noun}~$\ocwbc{} generative only for auxiliaries, for cvi compounds \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}| \ocwbegindcode{}$\ocwupperid{Agent\_noun}$\ocwenddcode{}, etc. -- non generative, must be lexicalized; see nominal \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Invariable verbal forms.
   Such forms are indeclinable and have their own inflected forms constructors.
   Infinitives are similar to dative substantival forms, periphrastic perfect
   forms are associated with an auxiliary verb in the perfect.
   Absolutives split into root absolutives in -tvaa and absolutives in -ya 
   that must be prefixed with a preverb. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{modal}~=~(\ocwlowerid{conjugation}~\times{}~\ocwlowerid{invar})~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{invar}~=$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Infi}~$\ocwbc{} infinitive (tumun) \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Absoya}~$\ocwbc{} absolutive (gerund, invariable participle) (lyap) \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Perpft}~$\ocwbc{} periphrastic perfect (li.t) \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{sadhana}~=~$\ocwbc{} karaka, action or absolutive - coarser than krit \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Agent}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Action}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Object}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Instr}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Loca}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Absolu}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Primary nominal formations \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{nominal}~=~(\ocwlowerid{conjugation}~\times{}~\ocwlowerid{krit})~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{krit}~=~$\ocwbc{} coarser than Paninian krit suffixes \ocwec{}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Agent\_aka}~$\ocwbc{} .nvul \Pan{3,1,133} \Pan{3,3,108-109} -aka -ikaa v.rddhi 
                 .svun \Pan{3,1,145} trade gu.na f. -akii  
                 vu~n \Pan{3,1,146-147} 
                 vun \Pan{3,1,149-150} repeated action, benediction \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Agent\_in}~$\ocwbc{} .nini \Pan{3,1,134} \Pan{3,2,78-86}   -in  -inii v.rddhi 
                 ghinu.n \Pan{3,2,141-145} 
                 ini \Pan{3,2,93} ifc. -vikrayin past \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Agent\_tri}~$\ocwbc{} t.rc \Pan{3,1,133} t.rn \Pan{3,2,135} habit -t.r gu.na  \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Agent\_ana}~$\ocwbc{} lyu \Pan{3,1,134} yuc \Pan{3,2,148}     -ana a.   
                 .nyu.t \Pan{3,1,147-148} profession f. -anii \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Agent\_root}~$\ocwbc{} kvip \Pan{3,2,61} ifc + \Pan{3,2,76} adja  
                        ifc. mnf. \Pan{6,1,67} amuis de v
                        \Pan{3,2,76} root autonomous mnf. 
                 + .tak \Pan{3,2,8} root ifc (f. -ii) 
                 + .ta \Pan{3,2,20} -kara ifc (f. -ii) habitual, enjoy
                 + ka \Pan{3,2,3} root -aa, amuie, ifcno (no Preverb) f. ii \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Agent\_a}~$\ocwbc{} ac \Pan{3,1,134} gu.na m. -a f. -aa   
               .na \Pan{3,1,140-143} v.rddhi (f. -aa)
               ka \Pan{3,1,135-136;144} -gu.na 
                  \Pan{3,2,3-7} m. -a (f. -aa) metaphoric use
               za \Pan{3,1,137-139} idem ka but (f. -aa) nb present stem 
               a.n \Pan{3,2,1} vriddhi ifc (iic obj) (f. -ii) -kaara \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Agent\_nu}~$\ocwbc{} i.s.nu \Pan{3,2,136} 
                i.s.nuc \Pan{3,2,136-138} -i.s.nu gu.na (habit)
                khi.s.nuc \Pan{3,2,57} -i.s.n'u gu.na 
                knu \Pan{3,2,140} ksnu \Pan{3,2,139} -nu -gu.na \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Action\_ana}~$\ocwbc{} lyu.t \Pan{3,3,115-117}            -ana n.    \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Action\_na}~$\ocwbc{} naf \Pan{3,3,90} nan \Pan{3,3,91} -na m. -naa f. \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Action\_a}~$\ocwbc{} gha~n \Pan{3,3,18-}                -a m. v.rddhi \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Action\_ya}~$\ocwbc{} kyap \Pan{3,1,107} -ya n. -yaa f.              \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Action\_ti}~$\ocwbc{} ktin \Pan{3,3,94}                      -ti f.  \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Action\_i}~$\ocwbc{} ki \Pan{3,3,92-93}                     -i f.    \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Action\_root}~$\ocwbc{} unknown krit of non-agent noun  \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Object\_root}~$\ocwbc{} we should probably lump action and object in \ocwbegindcode{}$\ocwupperid{Non\_agent}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Object\_a}~$\ocwbc{} ka                                    -a n.    \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Instrument}~$\ocwbc{} ka \Pan{3,1,136}                  0/amui n.   \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Instra}~$\ocwbc{} .s.tran -tra n.                -trii f. traa f.  \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Agent\_u}~$\ocwbc{} san+u                             -u on des stem \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Action\_aa}~$\ocwbc{} san+a+.taap  \Pan{3,3,102}        -aa on des stem \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Abstract}~$\ocwbc{} abstract nouns n.           -as u.naadi suffix \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\label{skt_morph.mli:7571}%
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{ind\_kind}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Adv}~$\ocwbc{} adverb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Avya}~$\ocwbc{} turned into an adverb by avyayiibhaava compounding \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Abs}~$\ocwbc{} root absolutive in -tvaa \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Tas}~$\ocwbc{} tasil taddhita \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Part}~$\ocwbc{} particule \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Prep}~$\ocwbc{} preposition \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Conj}~$\ocwbc{} conjunction \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Nota}~$\ocwbc{} notation \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Infl}~$\ocwbc{} inflected form \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Interj}~$\ocwbc{} interjection \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Default}~$\ocwbc{} default - inherits its role \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Morphology.mli}
\ocwinterface{Morphology}
\label{morphology.mli:0}%
Morphology interface 
\ocweol
\ocwindent{0.00em}
Used by \ocwbegindcode{}$\ocwupperid{Inflected}$\ocwenddcode{} for morphology generation, and by \ocwbegindcode{}$\ocwupperid{Morpho}$\ocwenddcode{} for 
   further treatment 
\ocweol
\label{morphology.mli:743}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\medskip

\ocwendcode{}\ocwindent{0.00em}
module Morphology : sig 
\ocweol
\label{morphology.mli:791}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{inflexion\_tag}~=~$\ocwbc{} vibhakti \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Noun\_form}~$\ocwkw{of}~$\ocwlowerid{gender}~$\ocwkw{and}~$\ocwlowerid{number}~$\ocwkw{and}~$\ocwlowerid{case}~$\ocwbc{} declined nominal \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Part\_form}~$\ocwkw{of}~$\ocwlowerid{verbal}~$\ocwkw{and}~$\ocwlowerid{gender}~$\ocwkw{and}~$\ocwlowerid{number}~$\ocwkw{and}~$\ocwlowerid{case}~$\ocwbc{} declined participle \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Bare\_stem}~$\ocwbc{} iic forms \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Avyayai\_form}~$\ocwbc{} iic forms of avyayiibhaava cpds \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Avyayaf\_form}~$\ocwbc{} ifc forms of avyayiibhaava cpds \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Verb\_form}~$\ocwkw{of}~$\ocwlowerid{finite}~$\ocwkw{and}~$\ocwlowerid{number}~$\ocwkw{and}~$\ocwlowerid{person}~$\ocwbc{} finite conjugated root forms \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind\_form}~$\ocwkw{of}~$\ocwlowerid{ind\_kind}~$\ocwbc{} indeclinable forms: prep, adv, etc \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind\_verb}~$\ocwkw{of}~$\ocwlowerid{modal}~$\ocwbc{} indeclinable inf abs-ya and perpft \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Abs\_root}~$\ocwkw{of}~$\ocwlowerid{conjugation}~$\ocwbc{} abs-tvaa \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Auxi\_form}~$\ocwbc{} verbal auxiliaries forms \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Unanalysed}~$\ocwbc{} un-analysable segments \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{PV}~$\ocwkw{of}~\ocwbt{list}~\ocwbt{string}~\ocwbc{} Preverb sequences \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} NB preverb sequences are collated separately by \ocwbegindcode{}$\ocwupperid{Roots}$\ocwenddcode{} module, and
     they do not appear in solutions, by compression of \ocwbegindcode{}$\ocwupperid{Dispatcher}.\ocwlowerid{validate}$\ocwenddcode{}. \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{inflexions}~=~$\ocwbt{list}~$\ocwlowerid{inflexion\_tag}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{inflected\_map}~=~\ocwupperid{Lexmap.}\ocwlowerid{lexmap}~\ocwlowerid{inflexions}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{lemma}~=~\ocwupperid{Lexmap.}\ocwlowerid{inverse}~\ocwlowerid{inflexions}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{lemmas}~=~$\ocwbt{list}~$\ocwlowerid{lemma}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{multitag}~=~$\ocwbt{list}~$(\ocwupperid{Word.}\ocwlowerid{delta}~\times{}~\ocwlowerid{inflexions})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{morphology}~=~$\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{nouns}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{nouns2}~:~\ocwlowerid{inflected\_map}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{prons}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{roots}~:~\ocwlowerid{inflected\_map}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{krids}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{voks}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{lopas}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{lopaks}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{indes}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{absya}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{abstvaa}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iics2}~:~\ocwlowerid{inflected\_map}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iics}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iifs}~:~\ocwlowerid{inflected\_map}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iiks}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iivs}~:~\ocwlowerid{inflected\_map}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{peris}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{auxis}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{auxiks}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{auxiicks}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{vocas}~:~\ocwlowerid{inflected\_map}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{invs}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ifcs}~:~\ocwlowerid{inflected\_map}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ifcs2}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{inftu}~:~\ocwlowerid{inflected\_map}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{kama}~:~\ocwlowerid{inflected\_map}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iiys}~:~\ocwlowerid{inflected\_map}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{avys}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{sfxs}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{isfxs}~:~\ocwlowerid{inflected\_map}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{caches}~:~\ocwlowerid{inflected\_map}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
end; 
\ocweol
\typeout{OcamlWeb file Naming.ml}
\ocwmodule{Naming}
\label{naming.ml:0}%
Unique naming mechanism. 
\ocweol
\ocwindent{0.00em}
Kridanta names management: namespace data structures 
\ocweol
\ocwindent{0.00em}
The problem is to find the lexical entry, if any, that matches a stem
and an etymology, corresponding to the morphological structure of a
generated stem. For instance k.rta has etymology pp(k.r\#1). 
It does not produce forms, and is skipped by the morphology generator,
since the pp participal stem is a productive taddhita construction,
that will indeed generate stem k.rta from its root k.r\#1.
The problem for the morphology generator is to display forms of k.rta
with a link to k.rta in the hypertext lexicon. It is non-trivial, since
homonymies occur. Thus homophony indexes associated with generators
and consistent with possible lexicalisations must be registered.
A first pass of recording builds \ocwbegindcode{}$\ocwlowerid{lexical\_kridantas}$\ocwenddcode{} as a \ocwbegindcode{}$\ocwlowerid{deco\_krid}$\ocwenddcode{} deco
indexing the stems with a pair (morphology,homo). Then the morphology
generator from Inflected extends it as \ocwbegindcode{}$\ocwlowerid{unique\_kridantas}$\ocwenddcode{}, accessed as
\ocwbegindcode{}$\ocwupperid{Inflected}.\ocwlowerid{acccess\_krid}$\ocwenddcode{} and \ocwbegindcode{}$\ocwupperid{Inflected}.\ocwlowerid{register\_krid}$\ocwenddcode{}, and used
by \ocwbegindcode{}$\ocwupperid{Parts}.\ocwlowerid{gen\_stem}$\ocwenddcode{}.  
\ocweol
\ocwindent{0.00em}
Unique naming of kridantas 
\ocweol
\ocwindent{0.00em}
associates to a pair (verbal,root) a homophony index for unique naming 
\ocweol
\label{naming.ml:1836}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{homo\_krid}~=~((\ocwupperid{Skt\_morph.}\ocwlowerid{verbal}~\times{}~\ocwupperid{Word.}\ocwlowerid{word})~\times{}~$\ocwbt{int}$)$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{deco\_krid}~=~\ocwupperid{Deco.}\ocwlowerid{deco}~\ocwlowerid{homo\_krid}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{homo\_undo}~\ocwlowerid{w}~=~\ocwupperid{Encode.}\ocwlowerid{decompose}~(\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{w})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{look\_up\_homo}~\ocwlowerid{homo}~=~\ocwlowerid{look\_rec}$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{look\_rec}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"look\_up\_homo"}~\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwlowerid{morpho},\ocwlowerid{n})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{n}=\ocwlowerid{homo}~$\ocwkw{then}~$\ocwlowerid{morpho}~$\ocwkw{else}~$\ocwlowerid{look\_rec}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{unique\_kridantas}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwupperid{Web.}\ocwlowerid{public\_unique\_kridantas\_file}~:~\ocwlowerid{deco\_krid})~$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"unique\_kridantas"}~$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{lexical\_kridantas}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwupperid{Web.}\ocwlowerid{public\_lexical\_kridantas\_file}~:~\ocwlowerid{deco\_krid})~$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"lexical\_kridantas"}~$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} This mechanism is used by \ocwbegindcode{}$\ocwupperid{Make\_roots}$\ocwenddcode{} at morphology generation time,
and by \ocwbegindcode{}$\ocwupperid{Morpho}.\ocwlowerid{print\_inv\_morpho}$\ocwenddcode{} and \ocwbegindcode{}$\ocwupperid{Morpho\_ext}.\ocwlowerid{print\_inv\_morpho\_ext}$\ocwenddcode{}
at segmenting time. \ocwec{}\ocweol
\ocwendcode{}\typeout{OcamlWeb file Inflected.mli}
\ocwinterface{Inflected}
\label{inflected.mli:0}%
\label{inflected.mli:651}%
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Naming};$\medskip

\label{inflected.mli:698}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{register\_krid}~:~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~\ocwlowerid{homo\_krid}~\rightarrow{}~$\ocwbt{unit};~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{access\_krid}~:~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~$\ocwbt{list}~$\ocwlowerid{homo\_krid};$\medskip

\label{inflected.mli:804}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{admits\_aa}~:~$\ocwbt{ref}~\ocwbt{bool};\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{morpho\_gen}~:~$\ocwbt{ref}~\ocwbt{bool}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{nouns}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pronouns}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{vocas}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{iics}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{avyayais}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{avyayafs}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{piics}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{iivs}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{peri}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{auxi}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{auxik}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{auxiick}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{indecls}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{invs}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{absya}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{abstvaa}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{parts}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{partvocs}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{roots}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{lopas}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{lopaks}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{inftu}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{kama}~:~$\ocwbt{ref}~$\ocwlowerid{inflected\_map};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{preverbs}~:~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{deco}~\ocwupperid{Word.}\ocwlowerid{word});$\medskip

\label{inflected.mli:1735}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{lexicalized\_kridantas}~:~$\ocwbt{ref}~$\ocwlowerid{deco\_krid};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{unique\_kridantas}~:~$\ocwbt{ref}~$\ocwlowerid{deco\_krid};$\medskip

\ocwendcode{}\ocwindent{0.00em}
Inflectional categories 
\ocweol
\label{inflected.mli:1851}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{nominal}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Noun}~$\ocwbc{} lexicalized stem - noun, adjective or number \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pron}~$\ocwbc{} lexicalized stem - pronoun \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Krid}~$\ocwkw{of}~$\ocwlowerid{verbal}~$\ocwkw{and}~\ocwbt{string}~\ocwbc{} kridantas of roots \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{flexion}~=$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Declined}~$\ocwkw{of}~$\ocwlowerid{nominal}~$\ocwkw{and}~$\ocwlowerid{gender}~$\ocwkw{and}~\ocwbt{list}~$(\ocwlowerid{number}~\times{}~$\ocwbt{list}~$(\ocwlowerid{case}~\times{}~\ocwupperid{Word.}\ocwlowerid{word}))$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Conju}~$\ocwkw{of}~$\ocwlowerid{finite}~$\ocwkw{and}~\ocwbt{list}~$(\ocwlowerid{number}~\times{}~$\ocwbt{list}~$(\ocwlowerid{person}~\times{}~\ocwupperid{Word.}\ocwlowerid{word}))$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Indecl}~$\ocwkw{of}~$\ocwlowerid{ind\_kind}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Bare}~$\ocwkw{of}~$\ocwlowerid{nominal}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Avyayai}~$\ocwkw{of}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} Iic of avyayiibhaava cpd \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Avyayaf}~$\ocwkw{of}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} Ifc of avyayiibhaava cpd \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Cvi}~$\ocwkw{of}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Preverb}~$\ocwkw{of}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~\ocwbt{list}~$\ocwupperid{Word.}\ocwlowerid{word}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Invar}~$\ocwkw{of}~$\ocwlowerid{modal}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} inf abs-ya perpft \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inftu}~$\ocwkw{of}~$\ocwlowerid{conjugation}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} infinitive in -tu \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Absotvaa}~$\ocwkw{of}~$\ocwlowerid{conjugation}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} abs-tvaa \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enter1}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{flexion}~\rightarrow{}~$\ocwbt{unit}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enter}~:~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{list}~$\ocwlowerid{flexion}~\rightarrow{}~$\ocwbt{unit}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enter\_form}~:~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~\ocwlowerid{flexion}~\rightarrow{}~$\ocwbt{unit}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enter\_forms}~:~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~$\ocwbt{list}~$\ocwlowerid{flexion}~\rightarrow{}~$\ocwbt{unit}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{nominal\_databases}~:~$\ocwbt{unit}~$\rightarrow{}~$\ocweol
\ocwindent{1.00em}
$(\ocwlowerid{inflected\_map}~\times{}~\ocwlowerid{inflected\_map}~\times{}~\ocwlowerid{inflected\_map}~\times{}~\ocwlowerid{inflected\_map}~\times{}~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{reset\_nominal\_databases}~:~$\ocwbt{unit}~$\rightarrow{}~$\ocwbt{unit}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Inflected.ml}
\ocwmodule{Inflected}
\label{inflected.ml:0}%
Morphology : computation of inflected forms in \ocwbegindcode{}$\ocwlowerid{inflected\_map}~\ocwlowerid{decls}$\ocwenddcode{}.    
\ocweol
\label{inflected.ml:734}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{inflected\_map}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Word};$\medskip

\ocwendcode{}\ocwindent{0.00em}
Holds the state vector : \ocwbegindcode{}$(\ocwlowerid{nouns},\ocwlowerid{roots},\ocwlowerid{preverbs},\ocwlowerid{segmenting\_mode})$\ocwenddcode{} where: 
\ocweol
\ocwindent{0.00em}
nouns is accumulator for the set of declined forms of substantives       
\ocweol
\ocwindent{0.00em}
pronouns is accumulator for the set of declined forms of pronouns        
\ocweol
\ocwindent{0.00em}
vocas is accumulator for the set of vocative forms of substantives       
\ocweol
\ocwindent{0.00em}
roots is accumulator for the set of conjugated forms of roots            
\ocweol
\ocwindent{0.00em}
preverbs is accumulator for the set of preverb sequences                 
\ocweol
\ocwindent{0.00em}
\ocwbegindcode{}$\ocwlowerid{segmenting\_mode}$\ocwenddcode{} tells whether phantom phonemes are generated or not.   
\ocweol
\ocwindent{0.00em}
Admits aa- as a preverb -- global set in \ocwbegindcode{}$\ocwupperid{Verbs}.\ocwlowerid{compute\_conjugs\_stems}$\ocwenddcode{} 
\ocweol
\label{inflected.ml:1432}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{admits\_aa}~=~$\ocwbt{ref}~$\ocwupperid{False}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{admits\_lopa}~=~$\ocwbt{ref}~$\ocwupperid{False}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{morpho\_gen}~=~$\ocwbt{ref}~$\ocwupperid{True}~$\ocwbc{} morphology generation time \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Turn to \ocwbegindcode{}$\ocwupperid{False}$\ocwenddcode{} for cgi execution (fake conjugation and nophantoms) \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} The \ocwbegindcode{}$\ocwlowerid{inflected\_map}$\ocwenddcode{} lexicons of inflected forms: nouns, iics, etc are computed
   by \ocwbegindcode{}$\ocwupperid{Make\_nouns}$\ocwenddcode{} and are dumped as persistent global databases nouns.rem etc.
   They are also used on the fly locally by \ocwbegindcode{}$\ocwupperid{Declension}$\ocwenddcode{} and \ocwbegindcode{}$\ocwupperid{Conjugation}$\ocwenddcode{}. \ocwec{}\medskip

\label{inflected.ml:1872}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{lexicalized\_kridantas}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwupperid{Naming.}\ocwlowerid{deco\_krid})$\ocweol
\ocwindent{0.00em}
\ocwbc{} It will be set by \ocwbegindcode{}$\ocwupperid{Make\_roots}.\ocwlowerid{roots\_to\_conjugs}$\ocwenddcode{} for the \ocwbegindcode{}$\ocwlowerid{unique\_kridantas}$\ocwenddcode{}
   computation. \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{access\_lexical\_krid}~\ocwlowerid{stem}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{stem}~\ocwlowerid{lexicalized\_kridantas.}\ocwlowerid{val}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We look up the lexicalized kridantas register to see if entry is a krid. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} This test should be done before, in \ocwbegindcode{}$\ocwupperid{Print\_dict}$\ocwenddcode{} that has the info ? \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{is\_kridanta}~\ocwlowerid{entry}~=~$\ocwkw{try}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{hom},\ocwlowerid{stem})~=~\ocwupperid{Encode.}\ocwlowerid{decompose\_str}~\ocwlowerid{entry}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{krids}~=~\ocwlowerid{access\_lexical\_krid}~\ocwlowerid{stem}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{\_}~=~\ocwupperid{List.}\ocwlowerid{find}~($\ocwkw{fun}~$(\ocwlowerid{\_},\ocwlowerid{h})~\rightarrow{}~\ocwlowerid{h}=\ocwlowerid{hom})~\ocwlowerid{krids}~$\ocwkw{in}~$\ocwupperid{True}~$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwupperid{Not\_found}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{unique\_kridantas}~=~$\ocwbt{ref}~$\ocwupperid{Deco.}\ocwlowerid{empty}~$\ocweol
\ocwindent{0.00em}
\ocwbc{} This structure holds the unique names to kridantas. It is initialized
to the lexicalized one in \ocwbegindcode{}$\ocwupperid{Make\_roots}.\ocwlowerid{roots\_to\_conjugs}$\ocwenddcode{}, which completes it
with the kridantas generated by Parts. At the end of morphological generation 
its final value is stored in persistent \ocwbegindcode{}$\ocwupperid{Install}.\ocwlowerid{unique\_kridantas\_file}$\ocwenddcode{}, and
transfered to \ocwbegindcode{}$\ocwupperid{Install}.\ocwlowerid{public\_unique\_kridantas\_file}$\ocwenddcode{} read from module Naming. \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{access\_krid}~\ocwlowerid{stem}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{stem}~\ocwlowerid{unique\_kridantas.}\ocwlowerid{val}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{register\_krid}~\ocwlowerid{stem}~\ocwlowerid{vrp}~=~$\ocwbc{} used in \ocwbegindcode{}$\ocwupperid{Parts}.\ocwlowerid{gen\_stem}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{unique\_kridantas.}\ocwlowerid{val}~:=~\ocwupperid{Deco.}\ocwlowerid{add1}~\ocwlowerid{unique\_kridantas.}\ocwlowerid{val}~\ocwlowerid{stem}~\ocwlowerid{vrp}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Inflected forms of nouns pronouns numbers, \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} also used separately for ifc only nouns \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{nouns}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pronouns}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})~$\ocwbc{} demonstrative + personal pn \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vocas}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Add morphological feature i to form w relative to entry e, with d = diff e \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morph}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{nouns.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{nouns.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{d}~\ocwlowerid{w},\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{add\_morphpro}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~=~$\ocwbc{} pronouns not usable as ifc \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{pronouns.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{pronouns.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{d}~\ocwlowerid{w},\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
\ocwbc{} Add vocative feature i to form w relative to entry e, with d = diff e \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{add\_voca}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{vocas.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{vocas.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{d}~\ocwlowerid{w},\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} auxiliary verbs used in the inchoative cvi construction \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{auxiliary}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"bhuu\#1"}~$\mid{}~$\ocwstring{"k.r\#1"}~$\mid{}~$\ocwstring{"as\#1"}~$\rightarrow{}~\ocwupperid{True}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} iic forms \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{iics}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphi}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{iics.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{iics.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{d}~\ocwlowerid{w},\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} avyaya iic forms \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{avyayais}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} avyaya ifc forms \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{avyayafs}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphyai}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{avyayais.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{avyayais.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{d}~\ocwlowerid{w},\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphyaf}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{avyayafs.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{avyayafs.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{d}~\ocwlowerid{w},\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Used by \ocwbegindcode{}$\ocwupperid{Nouns}.\ocwlowerid{fake\_compute\_decls}$\ocwenddcode{} for declension of single entry \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{nominal\_databases}~()~=~$\ocweol
\ocwindent{1.00em}
$(\ocwlowerid{nouns.}\ocwlowerid{val},\ocwlowerid{pronouns.}\ocwlowerid{val},\ocwlowerid{vocas.}\ocwlowerid{val},\ocwlowerid{iics.}\ocwlowerid{val},\ocwlowerid{avyayafs.}\ocwlowerid{val})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{reset\_nominal\_databases}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{nouns.}\ocwlowerid{val}~:=~\ocwupperid{Deco.}\ocwlowerid{empty}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pronouns.}\ocwlowerid{val}~:=~\ocwupperid{Deco.}\ocwlowerid{empty}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{vocas.}\ocwlowerid{val}~:=~\ocwupperid{Deco.}\ocwlowerid{empty}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iics.}\ocwlowerid{val}~:=~\ocwupperid{Deco.}\ocwlowerid{empty}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
iiv forms 
\ocweol
\label{inflected.ml:4723}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{iivs}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphvi}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{iivs.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{iivs.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{d}~\ocwlowerid{w},\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} finite forms of auxiliary roots k.r bhuu as \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{auxi}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphauxi}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{phantomatic}~\ocwlowerid{w}~$\ocwkw{then}~$()~$\ocwkw{else}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{auxi.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{auxi.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{d}~\ocwlowerid{w},\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} periphrastic perfect forms \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{peri}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphperi}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{peri.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{peri.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{d}~\ocwlowerid{w},\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} indeclinable forms - adverbs, conjonctions, particles \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{indecls}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphin}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{indecls.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{indecls.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{d}~\ocwlowerid{w},\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} invocations are registered in invs \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{invs}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_invoc}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{invs.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{invs.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{d}~\ocwlowerid{w},\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} indeclinable verbal forms usable without preverbs: infinitives, abs-tvaa \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{abstvaa}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphabstvaa}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{abstvaa.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{abstvaa.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{d}~\ocwlowerid{w},\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} indeclinable verbal forms usable with preverbs: infinitives, abs-ya \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{absya}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphabsya}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~\ocwlowerid{aapv}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{absya.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{absya.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{d}~\ocwlowerid{w},\ocwlowerid{i})$\ocweol
\ocwindent{1.00em}
\ocwbc{} now we add fake absol forms with phantom phonemes \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwlowerid{morpho\_gen.}\ocwlowerid{val}~\land{}~\ocwlowerid{aapv}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{w}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~1~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwbc{} aa-a gives *a \ocwec{}\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *a \ocwec{}~-3~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{absya.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{absya.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{d}~\ocwlowerid{fake},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~2~::~\ocwlowerid{r}~]~\rightarrow{}$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *A \ocwec{}~-9~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{absya.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{absya.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{d}~\ocwlowerid{fake},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~3~::~\ocwlowerid{r}~]~\rightarrow{}$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *i \ocwec{}~-4~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{absya.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{absya.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{d}~\ocwlowerid{fake},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~4~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *I \ocwec{}~-7~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{absya.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{absya.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{d}~\ocwlowerid{fake},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~5~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *u \ocwec{}~-5~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{absya.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{absya.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{d}~\ocwlowerid{fake},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~6~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *U \ocwec{}~-8~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{absya.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{absya.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{d}~\ocwlowerid{fake},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~7~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *r \ocwec{}~-6~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{absya.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{absya.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{d}~\ocwlowerid{fake},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$()$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} root finite conjugated forms \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{roots}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphc}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~\ocwlowerid{aapv}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{roots.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{roots.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{d}~\ocwlowerid{w},\ocwlowerid{i})$\ocweol
\ocwindent{1.00em}
\ocwbc{} now we add fake conjugated forms with phantom phonemes \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwlowerid{morpho\_gen.}\ocwlowerid{val}~\land{}~\ocwlowerid{aapv}~$\ocwkw{then}~\ocwkw{do}~\ocwbc{} \Pan{6,1,95} \ocwec{}\ocweol
\ocwindent{2.50em}
\{~\ocwkw{match}~$\ocwlowerid{w}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~1~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwbc{} aa-a gives *a \ocwec{}\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *a \ocwec{}~-3~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{roots.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{roots.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{d}~\ocwlowerid{fake},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~2~::~\ocwlowerid{r}~]~\rightarrow{}$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *A \ocwec{}~-9~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{roots.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{roots.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{d}~\ocwlowerid{fake},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~3~::~\ocwlowerid{r}~]~\rightarrow{}$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *i \ocwec{}~-4~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{roots.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{roots.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{d}~\ocwlowerid{fake},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~4~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *I \ocwec{}~-7~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{roots.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{roots.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{d}~\ocwlowerid{fake},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~5~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *u \ocwec{}~-5~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{roots.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{roots.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{d}~\ocwlowerid{fake},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~6~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *U \ocwec{}~-8~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{roots.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{roots.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{d}~\ocwlowerid{fake},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~7~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *r \ocwec{}~-6~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{roots.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{roots.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{d}~\ocwlowerid{fake},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.50em}
\}\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$()$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} root finite forms starting with e or o \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{lopas}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{lopaks}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Concerns \Pan{6,1,94} a,\=a (preverb) | e (root) -> e; same for o. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Ex: upelayati prelayati upo.sati pro.sati \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphlopa}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~=~$\ocwkw{match}~$\ocwlowerid{w}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[~10~::~\ocwlowerid{\_}~]~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~12~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{amui}~=~[~-2~::~\ocwlowerid{w}~]~$\ocwbc{} amuitic form \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{9.50em}
$\ocwlowerid{lopas.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{lopas.}\ocwlowerid{val}~\ocwlowerid{amui}~(\ocwlowerid{d}~\ocwlowerid{amui},\ocwlowerid{i})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} New style of forms generators - stem argument generated as pseudo-entry \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
inflected forms of participles - and more generally kridantas 
\ocweol
\label{inflected.ml:9002}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{parts}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphpa}~\ocwlowerid{w}~\ocwlowerid{stem}~\ocwlowerid{i}~\ocwlowerid{aapv}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{parts.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{parts.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{diff}~\ocwlowerid{w}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{1.00em}
\ocwbc{} now we add fake participial forms with phantom phonemes \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwlowerid{morpho\_gen.}\ocwlowerid{val}~\land{}~\ocwlowerid{aapv}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{w}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~1~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwbc{} aa-a gives *a \ocwec{}\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *a \ocwec{}~-3~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{parts.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{parts.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~2~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *A \ocwec{}~-9~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{parts.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{parts.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~3~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *i \ocwec{}~-4~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{parts.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{parts.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~4~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *I \ocwec{}~-7~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{parts.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{parts.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~5~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *u \ocwec{}~-5~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{parts.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{parts.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~6~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *U \ocwec{}~-8~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{parts.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{parts.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~7~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwbc{} aa-.r gives *r \ocwec{}\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *r \ocwec{}~-6~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{parts.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{parts.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$()$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{add\_morphlopak}~\ocwlowerid{w}~\ocwlowerid{stem}~\ocwlowerid{i}~\ocwlowerid{aapv}~=~$\ocwkw{match}~$\ocwlowerid{w}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[~10~::~\ocwlowerid{\_}~]~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~12~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{amui}~=~[~-2~::~\ocwlowerid{w}~]~$\ocwbc{} amuitic form \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{lopaks.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{lopaks.}\ocwlowerid{val}~\ocwlowerid{amui}~(\ocwlowerid{diff}~\ocwlowerid{amui}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} participial vocatives \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{partvocs}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphpav}~\ocwlowerid{w}~\ocwlowerid{stem}~\ocwlowerid{i}~\ocwlowerid{aapv}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{partvocs.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{partvocs.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{diff}~\ocwlowerid{w}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{1.00em}
\ocwbc{} now we add fake participial forms with phantom phonemes \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwlowerid{morpho\_gen.}\ocwlowerid{val}~\land{}~\ocwlowerid{aapv}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{w}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~1~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwbc{} aa-a gives *a \ocwec{}\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *a \ocwec{}~-3~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{partvocs.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{partvocs.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~2~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *A \ocwec{}~-9~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{partvocs.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{partvocs.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~3~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *i \ocwec{}~-4~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{partvocs.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{partvocs.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~4~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *I \ocwec{}~-7~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{partvocs.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{partvocs.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~5~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *u \ocwec{}~-5~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{partvocs.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{partvocs.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~6~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *U \ocwec{}~-8~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{partvocs.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{partvocs.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~7~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwbc{} aa-.r gives *r \ocwec{}\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *r \ocwec{}~-6~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{partvocs.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{partvocs.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$()$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} piic forms \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{piics}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphpi}~\ocwlowerid{w}~\ocwlowerid{stem}~\ocwlowerid{i}~\ocwlowerid{aapv}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{piics.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{piics.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{diff}~\ocwlowerid{w}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{1.00em}
\ocwbc{} now we add fake participial iic forms with phantom phonemes \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwlowerid{morpho\_gen.}\ocwlowerid{val}~\land{}~\ocwlowerid{aapv}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{w}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~1~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwbc{} aa-a gives *a \ocwec{}\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *a \ocwec{}~-3~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{piics.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{piics.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~2~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *A \ocwec{}~-9~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{piics.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{piics.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~3~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *i \ocwec{}~-4~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{piics.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{piics.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~4~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *I \ocwec{}~-7~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{piics.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{piics.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~5~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *u \ocwec{}~-5~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{piics.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{piics.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~6~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *U \ocwec{}~-8~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{piics.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{piics.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~[~7~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwbc{} aa-.r gives *r \ocwec{}\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fake}~=~[~$\ocwbc{} *r \ocwec{}~-6~::~$\ocwlowerid{r}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{piics.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{piics.}\ocwlowerid{val}~\ocwlowerid{fake}~(\ocwlowerid{diff}~\ocwlowerid{fake}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$()$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} kridantas of auxiliary roots k.r bhuu for cvi -ii compounds \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{auxik}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphauxik}~\ocwlowerid{w}~\ocwlowerid{stem}~\ocwlowerid{i}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{phantomatic}~\ocwlowerid{w}~$\ocwkw{then}~$()~$\ocwkw{else}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{auxik.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{auxik.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{diff}~\ocwlowerid{w}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{auxiick}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphauxiick}~\ocwlowerid{w}~\ocwlowerid{stem}~\ocwlowerid{i}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{phantomatic}~\ocwlowerid{w}~$\ocwkw{then}~$()~$\ocwkw{else}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{auxiick.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{auxiick.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{diff}~\ocwlowerid{w}~\ocwlowerid{stem},\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Root infinitives in -tu with forms of kaama \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{inftu}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{kama}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphinftu}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~=~$\ocwbc{} similar to \ocwbegindcode{}$\ocwlowerid{add\_morphin}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{phantomatic}~\ocwlowerid{w}~$\ocwkw{then}~$()~$\ocwkw{else}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{inftu.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{inftu.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{d}~\ocwlowerid{w},\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{add\_morphkama}~\ocwlowerid{w}~\ocwlowerid{d}~\ocwlowerid{i}~=~$\ocwbc{} similar to \ocwbegindcode{}$\ocwlowerid{add\_morph}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{kama.}\ocwlowerid{val}~:=~\ocwupperid{Lexmap.}\ocwlowerid{addl}~\ocwlowerid{kama.}\ocwlowerid{val}~\ocwlowerid{w}~(\ocwlowerid{d}~\ocwlowerid{w},\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Preverb sequences 
\ocweol
\label{inflected.ml:14134}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{preverbs}~=~$\ocwbt{ref}~$(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwupperid{Deco.}\ocwlowerid{deco}~\ocwlowerid{word})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_morphp}~\ocwlowerid{w}~\ocwlowerid{i}~=~\ocwlowerid{preverbs.}\ocwlowerid{val}~:=~\ocwupperid{Deco.}\ocwlowerid{add}~\ocwlowerid{preverbs.}\ocwlowerid{val}~\ocwlowerid{w}~\ocwlowerid{i}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Inflectional categories \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{nominal}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Noun}~$\ocwbc{} lexicalized stem - noun, adjective or number \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pron}~$\ocwbc{} lexicalized stem - pronoun \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Krid}~$\ocwkw{of}~$\ocwlowerid{verbal}~$\ocwkw{and}~\ocwbt{string}~\ocwbc{} kridantas of roots \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{flexion}~=$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Declined}~$\ocwkw{of}~$\ocwlowerid{nominal}~$\ocwkw{and}~$\ocwlowerid{gender}~$\ocwkw{and}~\ocwbt{list}~$(\ocwlowerid{number}~\times{}~$\ocwbt{list}~$(\ocwlowerid{case}~\times{}~\ocwlowerid{word}))$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Conju}~$\ocwkw{of}~$\ocwlowerid{finite}~$\ocwkw{and}~\ocwbt{list}~$(\ocwlowerid{number}~\times{}~$\ocwbt{list}~$(\ocwlowerid{person}~\times{}~\ocwlowerid{word}))$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Indecl}~$\ocwkw{of}~$\ocwlowerid{ind\_kind}~$\ocwkw{and}~$\ocwlowerid{word}~$\ocwbc{} avyaya, particle, interjection, nota \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Bare}~$\ocwkw{of}~$\ocwlowerid{nominal}~$\ocwkw{and}~$\ocwlowerid{word}~$\ocwbc{} Iic \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Avyayai}~$\ocwkw{of}~$\ocwlowerid{word}~$\ocwbc{} Iic of avyayiibhaava cpd \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Avyayaf}~$\ocwkw{of}~$\ocwlowerid{word}~$\ocwbc{} Ifc of avyayiibhaava cpd \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Cvi}~$\ocwkw{of}~$\ocwlowerid{word}~$\ocwbc{} -cvi suffixed stem (iiv) for inchoative compound verbs \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Preverb}~$\ocwkw{of}~$\ocwlowerid{word}~$\ocwkw{and}~\ocwbt{list}~$\ocwlowerid{word}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Invar}~$\ocwkw{of}~$\ocwlowerid{modal}~$\ocwkw{and}~$\ocwlowerid{word}~$\ocwbc{} inf abs-ya perpft \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inftu}~$\ocwkw{of}~$\ocwlowerid{conjugation}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} infinitive in -tu \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Absotvaa}~$\ocwkw{of}~$\ocwlowerid{conjugation}~$\ocwkw{and}~$\ocwlowerid{word}~$\ocwbc{} abs-tvaa \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{is\_taddhita}~=~$\ocwkw{fun}~\ocwbc{} unused at present - see \ocwbegindcode{}$\ocwupperid{Subst}.\ocwlowerid{taddhitas}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"taa"}~$\mid{}~$\ocwstring{"tva"}~$\mid{}~$\ocwstring{"vat"}~$\mid{}~$\ocwstring{"mat"}~$\mid{}~$\ocwstring{"tas"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"kataa"}~$\mid{}~$\ocwstring{"katva"}~\ocwbc{} -ka-taa -ka-tva \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"vattva"}~$\mid{}~$\ocwstring{"tvavat"}$\rightarrow{}~\ocwupperid{True}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sort\_taddhita}~\ocwlowerid{s}~=~\ocwlowerid{s}~;$\ocweol
\ocwindent{0.00em}
\ocwbc{} enter1: string -> flexion -> unit \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enter1}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{lexeme}~=~\ocwlowerid{sort\_taddhita}~\ocwlowerid{entry}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{delta}~=~\ocwupperid{Encode.}\ocwlowerid{diff\_str}~\ocwlowerid{lexeme}~$\ocwbc{} partial application \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{aapv}~=~\ocwlowerid{admits\_aa.}\ocwlowerid{val}~$\ocwbc{} for phantom forms generation \ocwec{}~\ocwkw{in}~\ocwkw{fun}\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}~\ocwlowerid{lg}~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{enterg}~\ocwlowerid{lg}~$\ocwbc{} nouns \ocwec{}\ocweol
\ocwindent{2.50em}
$\ocwlowerid{where}~\ocwlowerid{enterg}~(\ocwlowerid{n},\ocwlowerid{ln})~=~\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{entern}~\ocwlowerid{ln}$\ocweol
\ocwindent{2.50em}
$\ocwlowerid{where}~\ocwlowerid{entern}~(\ocwlowerid{c},\ocwlowerid{w})~=~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{f}~=~\ocwupperid{Noun\_form}~\ocwlowerid{g}~\ocwlowerid{n}~\ocwlowerid{c}~$\ocwkw{in}~\ocweol
\ocwindent{4.50em}
\ocwkw{if}~$\ocwlowerid{c}=\ocwupperid{Voc}~$\ocwkw{then}~\ocweol
\ocwindent{6.50em}
\ocwkw{if}~$\ocwlowerid{morpho\_gen.}\ocwlowerid{val}~\land{}~\ocwlowerid{is\_kridanta}~\ocwlowerid{entry}~$\ocwkw{then}~$($\ocwbc{} f is in Kridv \ocwec{}$)~$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{add\_voca}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwlowerid{f}~$\ocwbc{} non-generative Voca \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwkw{else}~\ocwkw{do}~\{~$\ocwlowerid{add\_morph}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwlowerid{f}~$\ocweol
\ocwindent{8.50em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} generative ifcs of infinitive bahus \ocwec{}\ocweol
\ocwindent{9.50em}
$[~$\ocwstring{"kaama"}~\ocwbc{} volition : who wants to do \ocwec{}\ocweol
\ocwindent{9.50em}
$\mid{}~$\ocwstring{"manas"}~\ocwbc{} consideration : who thinks about doing \ocwec{}\ocweol
\ocwindent{8.00em}
\ocwbc{} | \ocwstring{"zakya"} \ocwbc{} consideration : who is able to do \ocwec{}  kridanta \ocwec{}\ocweol
\ocwindent{14.50em}
$\rightarrow{}~\ocwlowerid{add\_morphkama}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwlowerid{f}~$\ocweol
\ocwindent{9.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()~$\ocweol
\ocwindent{9.50em}
$]$\ocweol
\ocwindent{8.50em}
\}\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwupperid{Declined}~\ocwupperid{Pron}~\ocwlowerid{g}~\ocwlowerid{lg}~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{enterg}~\ocwlowerid{lg}~$\ocwbc{} pronouns \ocwec{}~\ocweol
\ocwindent{2.50em}
$\ocwlowerid{where}~\ocwlowerid{enterg}~(\ocwlowerid{n},\ocwlowerid{ln})~=~\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{entern}~\ocwlowerid{ln}$\ocweol
\ocwindent{2.50em}
$\ocwlowerid{where}~\ocwlowerid{entern}~(\ocwlowerid{c},\ocwlowerid{w})~=~$\ocwkw{let}~$\ocwlowerid{f}~=~\ocwupperid{Noun\_form}~\ocwlowerid{g}~\ocwlowerid{n}~\ocwlowerid{c}~$\ocwkw{in}~\ocweol
\ocwindent{13.00em}
\ocwkw{if}~$\ocwlowerid{c}=\ocwupperid{Voc}~$\ocwkw{then}~$\ocwlowerid{add\_voca}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwlowerid{f}~$\ocweol
\ocwindent{17.50em}
\ocwkw{else}~$\ocwlowerid{add\_morphpro}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwlowerid{f}~$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwupperid{Conju}~\ocwlowerid{f}~\ocwlowerid{lv}~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{enterv}~\ocwlowerid{lv}$\ocweol
\ocwindent{2.50em}
$\ocwlowerid{where}~\ocwlowerid{enterv}~(\ocwlowerid{n},\ocwlowerid{ln})~=~\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{entern}~\ocwlowerid{ln}$\ocweol
\ocwindent{2.50em}
$\ocwlowerid{where}~\ocwlowerid{entern}~(\ocwlowerid{p},\ocwlowerid{w})~=~$\ocwkw{let}~$\ocwlowerid{v}~=~\ocwupperid{Verb\_form}~\ocwlowerid{f}~\ocwlowerid{n}~\ocwlowerid{p}~$\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{3.50em}
\{~$\ocwlowerid{add\_morphc}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwlowerid{v}~\ocwlowerid{aapv}~$\ocweol
\ocwindent{3.50em}
\ocwbc{} Now we take care of \Pan{6,1,94} when not blocked by \Pan{6,1,89} \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwbc{} ex: prejate, + (Kazikaa) upelayati prelayati upo.sati pro.sati \ocwec{}\ocweol
\ocwindent{3.50em}
;~\ocwkw{if}~$\ocwlowerid{morpho\_gen.}\ocwlowerid{val}~$\ocwkw{then}~\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"i"}~$\lor{}~\ocwlowerid{entry}~=~$\ocwstring{"edh"}~\ocwkw{then}~$()~$\ocwbc{} \Pan{6,1,89} \ocwec{}~\ocweol
\ocwindent{6.00em}
\ocwkw{else}~$\ocwlowerid{add\_morphlopa}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwlowerid{v}~$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~$()$\ocweol
\ocwindent{3.50em}
;~\ocwbc{} Now auxiliaries for verbal cvi compounds \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwkw{if}~$\ocwlowerid{auxiliary}~\ocwlowerid{entry}~$\ocwkw{then}~$\ocwlowerid{add\_morphauxi}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwlowerid{v}~$\ocwkw{else}~$()$\ocweol
\ocwindent{3.50em}
\}\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwupperid{Indecl}~\ocwlowerid{k}~\ocwlowerid{w}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{k}~$\ocwkw{with}\ocweol
\ocwindent{2.50em}
$[~\ocwupperid{Adv}~\mid{}~\ocwupperid{Part}~\mid{}~\ocwupperid{Conj}~\mid{}~\ocwupperid{Default}~\mid{}~\ocwupperid{Prep}~\mid{}~\ocwupperid{Tas}~\rightarrow{}~$\ocweol
\ocwindent{8.50em}
$\ocwlowerid{add\_morphin}~\ocwlowerid{w}~\ocwlowerid{delta}~(\ocwupperid{Ind\_form}~\ocwlowerid{k})$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Interj}~\rightarrow{}~\ocwlowerid{add\_invoc}~\ocwlowerid{w}~\ocwlowerid{delta}~(\ocwupperid{Ind\_form}~\ocwlowerid{k})~$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Avya}~\rightarrow{}~()~$\ocwbc{} since generative \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Abs}~\mid{}~\ocwupperid{Infl}~\mid{}~\ocwupperid{Nota}~\rightarrow{}~()~$\ocwbc{} no recording in morph tables \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwbc{} Abs generated by absolutives of verbs, Infl by flexions of nouns, and
        our parser does not deal with the specific notations of Panini suutras \ocwec{}\ocweol
\ocwindent{2.50em}
$]~$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{w}~$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwupperid{Bare}~\ocwupperid{Pron}~\ocwlowerid{w}~\rightarrow{}~\ocwlowerid{add\_morphi}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwupperid{Bare\_stem}~$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwupperid{Avyayai}~\ocwlowerid{w}~\rightarrow{}~\ocwlowerid{add\_morphyai}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwupperid{Avyayai\_form}$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwupperid{Avyayaf}~\ocwlowerid{w}~\rightarrow{}~\ocwlowerid{add\_morphyaf}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwupperid{Avyayaf\_form}$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwupperid{Cvi}~\ocwlowerid{w}~\rightarrow{}~\ocwlowerid{add\_morphvi}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwupperid{Auxi\_form}~$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwupperid{Invar}~\ocwlowerid{m}~\ocwlowerid{w}~\rightarrow{}~$\ocwkw{let}~$(\ocwlowerid{\_},\ocwlowerid{vi})~=~\ocwlowerid{m}~$\ocweol
\ocwindent{9.00em}
\ocwkw{and}~$\ocwlowerid{f}~=~\ocwupperid{Ind\_verb}~\ocwlowerid{m}~$\ocwkw{in}~\ocweol
\ocwindent{9.00em}
\ocwkw{match}~$\ocwlowerid{vi}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~\ocwupperid{Infi}~\rightarrow{}~$\ocwkw{do}~\ocwbc{} 2 cases: with and without preverbs - saves one phase \ocwec{}\ocweol
\ocwindent{4.50em}
\{~$\ocwlowerid{add\_morphabsya}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwlowerid{f}~\ocwlowerid{aapv}$\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{add\_morphin}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwlowerid{f}~$\ocweol
\ocwindent{4.50em}
;~\ocwkw{if}~$\ocwlowerid{auxiliary}~\ocwlowerid{entry}~$\ocwkw{then}~$\ocwlowerid{add\_morphauxi}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwlowerid{f}~$\ocwkw{else}~$()$\ocweol
\ocwindent{4.50em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Absoya}~$\ocwbc{} abso in -ya \ocwec{}~$\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{4.50em}
\{~$\ocwlowerid{add\_morphabsya}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwlowerid{f}~\ocwlowerid{aapv}~$\ocwbc{} abs-ya: pv or cvii (gati) mandatory \ocwec{}\ocweol
\ocwindent{4.50em}
;~\ocwkw{if}~$\ocwlowerid{auxiliary}~\ocwlowerid{entry}~$\ocwkw{then}~$\ocwlowerid{add\_morphauxi}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwlowerid{f}~$\ocwkw{else}~$()$\ocweol
\ocwindent{4.50em}
\}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Perpft}~\rightarrow{}~\ocwlowerid{add\_morphperi}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwlowerid{f}$\ocweol
\ocwindent{2.50em}
\ocwbc{} NB Allows perpft of verbs with preverbs but overgenerates since
           it allows perpft followed by a non perfect form of auxiliary \ocwec{}\ocweol
\ocwindent{2.50em}
$]$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwupperid{Inftu}~\ocwlowerid{m}~\ocwlowerid{w}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{f}~=~\ocwupperid{Ind\_verb}~(\ocwlowerid{m},\ocwupperid{Infi})~$\ocwkw{in}~\ocweol
\ocwindent{9.00em}
$\ocwlowerid{add\_morphinftu}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwlowerid{f}~$\ocwbc{} infinitive in -tu \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwupperid{Absotvaa}~\ocwlowerid{c}~\ocwlowerid{w}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{f}~=~\ocwupperid{Abs\_root}~\ocwlowerid{c}~$\ocwkw{in}~\ocweol
\ocwindent{10.50em}
$\ocwlowerid{add\_morphabstvaa}~\ocwlowerid{w}~\ocwlowerid{delta}~\ocwlowerid{f}~$\ocwbc{} abs-tvaa: no preverb \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwupperid{Preverb}~\ocwlowerid{w}~\ocwlowerid{lw}~\rightarrow{}~\ocwlowerid{add\_morphp}~\ocwlowerid{w}~\ocwlowerid{lw}~$\ocwbc{} w is (normalised) sandhi of lw \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unexpected\ocwvspace{}arg\ocwvspace{}to\ocwvspace{}enter"}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{enter\_form}$\ocwenddcode{}: word -> flexion -> unit \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} 1st argument is a stem generated by derivational morphology,
   it may have a homo index computed by \ocwbegindcode{}$\ocwupperid{Parts}.\ocwlowerid{gen\_stem}$\ocwenddcode{}. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{enter\_form}$\ocwenddcode{} enters in the relevant data bank one of its inflected forms. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Special treatment to have kridanta forms for auxiliaries, since their 
   lexicalised action nouns are not recognized as generative, 
   and thus must be skipped to avoid overgeneration. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enter\_form}~\ocwlowerid{stem}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{aapv}~=~\ocwlowerid{admits\_aa.}\ocwlowerid{val}~$\ocwbc{} for phantom forms generation \ocwec{}~\ocwkw{in}~\ocwkw{fun}\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~(\ocwupperid{Krid}~\ocwlowerid{v}~\ocwlowerid{root})~\ocwlowerid{g}~\ocwlowerid{lg}~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{enterg}~\ocwlowerid{lg}$\ocweol
\ocwindent{2.50em}
$\ocwlowerid{where}~\ocwlowerid{enterg}~(\ocwlowerid{n},\ocwlowerid{ln})~=~\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{entern}~\ocwlowerid{ln}$\ocweol
\ocwindent{2.50em}
$\ocwlowerid{where}~\ocwlowerid{entern}~(\ocwlowerid{c},\ocwlowerid{w})~=~$\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{p}~=~\ocwupperid{Part\_form}~\ocwlowerid{v}~\ocwlowerid{g}~\ocwlowerid{n}~\ocwlowerid{c}~$\ocwkw{in}~\ocwbc{} We lose the root, and v is used only in
        Constraints. Both can be recovered from stem using \ocwbegindcode{}$\ocwlowerid{unique\_kridantas}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwkw{if}~$\ocwlowerid{c}=\ocwupperid{Voc}~$\ocwkw{then}~$\ocwlowerid{add\_morphpav}~\ocwlowerid{w}~\ocwlowerid{stem}~\ocwlowerid{p}~\ocwlowerid{aapv}~$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~\ocwkw{match}~$\ocwlowerid{v}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~(\ocwlowerid{\_},\ocwupperid{Action\_noun})~\rightarrow{}~\ocwlowerid{add\_morphauxik}~\ocwlowerid{w}~\ocwlowerid{stem}~\ocwlowerid{p}~$\ocwbc{} cvi patch \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{7.00em}
\{~$\ocwlowerid{add\_morphpa}~\ocwlowerid{w}~\ocwlowerid{stem}~\ocwlowerid{p}~\ocwlowerid{aapv}~$\ocweol
\ocwindent{7.00em}
;~\ocwkw{if}~$\ocwlowerid{auxiliary}~\ocwlowerid{root}~$\ocwkw{then}~$\ocwlowerid{add\_morphauxik}~\ocwlowerid{w}~\ocwlowerid{stem}~\ocwlowerid{p}~$\ocwkw{else}~$()$\ocweol
\ocwindent{7.00em}
\}\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{morpho\_gen.}\ocwlowerid{val}~$\ocwkw{then}~\ocweol
\ocwindent{6.50em}
\ocwkw{if}~$\ocwlowerid{root}~=~$\ocwstring{"i"}~$\lor{}~\ocwlowerid{root}~=~$\ocwstring{"edh"}~\ocwkw{then}~$()~$\ocwbc{} \Pan{6,1,89} \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{add\_morphlopak}~\ocwlowerid{w}~\ocwlowerid{stem}~\ocwlowerid{p}~\ocwlowerid{aapv}$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$()$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwupperid{Bare}~(\ocwupperid{Krid}~(\ocwlowerid{\_},\ocwupperid{Action\_noun})~\ocwlowerid{root})~\ocwlowerid{w}~\rightarrow{}~$\ocweol
\ocwindent{3.50em}
$\ocwlowerid{add\_morphauxiick}~\ocwlowerid{w}~\ocwlowerid{stem}~\ocwupperid{Bare\_stem}~$\ocwbc{} cvi \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwupperid{Bare}~(\ocwupperid{Krid}~\ocwlowerid{\_}~\ocwlowerid{root})~\ocwlowerid{w}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{f}~=~\ocwupperid{Bare\_stem}~$\ocwkw{in}~\ocwkw{do}~\ocwbc{} losing verbal and root \ocwec{}\ocweol
\ocwindent{3.50em}
\{~$\ocwlowerid{add\_morphpi}~\ocwlowerid{w}~\ocwlowerid{stem}~\ocwlowerid{f}~\ocwlowerid{aapv}~$\ocweol
\ocwindent{3.50em}
;~\ocwkw{if}~$\ocwlowerid{auxiliary}~\ocwlowerid{root}~$\ocwkw{then}~$\ocwlowerid{add\_morphauxiick}~\ocwlowerid{w}~\ocwlowerid{stem}~\ocwlowerid{f}~$\ocwkw{else}~$()$\ocweol
\ocwindent{3.50em}
\}\medskip

\label{inflected.ml:21066}%
\ocwindent{1.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unexpected\ocwvspace{}arg\ocwvspace{}to\ocwvspace{}enter\_form"}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enter}~\ocwlowerid{entry}~=~\ocwupperid{List.}\ocwlowerid{iter}~(\ocwlowerid{enter1}~\ocwlowerid{entry})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{enter\_forms}~\ocwlowerid{w}~=~\ocwupperid{List.}\ocwlowerid{iter}~(\ocwlowerid{enter\_form}~\ocwlowerid{w})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Sandhi.ml}
\ocwmodule{Sandhi}
\label{sandhi.ml:0}%
This module defines external sandhi for compound and sentence construction. 
   It proceeds as a finite transducer with two input tapes, one for the right
   stream of phonemes, the other for the reversal of the left stream. It is 
   deterministic, and thus makes choices in optional situations, so that 
   sandhi is a deterministic function. 
\ocweol
\ocwindent{0.00em}
This algorithm is only used by service \ocwbegindcode{}$\ocwupperid{Sandhier}$\ocwenddcode{}, while sandhi viccheda
   proceeds by building tables in \ocwbegindcode{}$\ocwupperid{Compile\_sandhi}$\ocwenddcode{} with the help of a clone 
   of this code, then completes the tables with optional rules, 
   making predictive sandhi a truly non-deterministic relation.
   The code below ought NOT be modified without inspection 
   of its improved clone in module \ocwbegindcode{}$\ocwupperid{Compile\_sandhi}$\ocwenddcode{}. 
\ocweol
\label{sandhi.ml:1402}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phonetics};~$\ocwbc{} finalize visargor \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Canon};~$\ocwbc{} decode \ocwec{}\medskip

\label{sandhi.ml:1468}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{code}~\ocwlowerid{str}~=~\ocwupperid{Encode.}\ocwlowerid{code\_string}~\ocwlowerid{str}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{visargcomp1}~\ocwlowerid{first}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"left\ocwvspace{}arg\ocwvspace{}of\ocwvspace{}sandhi\ocwvspace{}too\ocwvspace{}short\ocwvspace{}(1)"}\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{penu}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{penu}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~1~\rightarrow{}~[~-1;~12;~\ocwlowerid{first}~]~$\ocwbc{} o  -1 means erase a \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~2~\rightarrow{}~[~\ocwlowerid{first}~]~$\ocwbc{} visarga dropped after aa \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~43;~\ocwlowerid{first}~]~$\ocwbc{} visarga goes to r \ocwec{}\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{visargcomp2}~=~$\ocwkw{fun}~\ocwbc{} first = `r`, visarga goes to r \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Failure}~$\ocwstring{"left\ocwvspace{}arg\ocwvspace{}of\ocwvspace{}sandhi\ocwvspace{}too\ocwvspace{}short\ocwvspace{}(2)"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{penu}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{penu}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~1~\rightarrow{}~[~-1;~12;~43~]~$\ocwbc{} \ocwstring{"a.h+r\ocwvspace{}\{\symbol{92}R\}\ocwvspace{}or"}  -1 means erase a \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~2~\rightarrow{}~[~43~]~$\ocwbc{} \ocwstring{"aa.h+r\ocwvspace{}\{\symbol{92}R\}\ocwvspace{}aar"} \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~-1;~\ocwlowerid{long}~\ocwlowerid{c};~43~]~$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{visargcompr}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"left\ocwvspace{}arg\ocwvspace{}of\ocwvspace{}sandhi\ocwvspace{}too\ocwvspace{}short\ocwvspace{}(r)"}\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{penu}~::~\ocwlowerid{\_}~]~\rightarrow{}~[~-1;~\ocwlowerid{long}~\ocwlowerid{penu};~43~]~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{visargcompv}~\ocwlowerid{first}~$\ocwbc{} vowel \ocwec{}~=~\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"left\ocwvspace{}arg\ocwvspace{}of\ocwvspace{}sandhi\ocwvspace{}too\ocwvspace{}short\ocwvspace{}(v)"}\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{penu}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{penu}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~1~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{first}~=~1~$\ocwkw{then}~$[~-1;~12;~-1~]~$\ocwbc{} erase a, o, then avagraha \ocwec{}\ocweol
\ocwindent{7.50em}
\ocwkw{else}~$[~50;~\ocwlowerid{first}~]~$\ocwbc{} hiatus \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~2~\rightarrow{}~[~50;~\ocwlowerid{first}~]~$\ocwbc{} hiatus \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~43;~\ocwlowerid{first}~]~$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} External sandhi core algorithm - \ocwbegindcode{}$\ocwlowerid{wl}$\ocwenddcode{} is the reverse left word
   \ocwbegindcode{}$\ocwlowerid{wr}$\ocwenddcode{} is the right word, result is a zip pair (left,right) of words.
   Caution. This code is used mostly by the Web interface Sandhier, 
   where phantoms may not occur in the input.
   However, phantom is tested in the code in order to keep consistency with 
   \ocwbegindcode{}$\ocwupperid{Compile\_sandhi}$\ocwenddcode{}, which builds the sandhi rules for transducers decorations.
   This function is also used for glueing preverbs in Roots. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ext\_sandhi\_pair}~\ocwlowerid{wl}~\ocwlowerid{wr}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{wl}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"left\ocwvspace{}arg\ocwvspace{}of\ocwvspace{}sandhi\ocwvspace{}empty"}\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{last}~::~\ocwlowerid{before}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{wr}~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
\ocwbc{} Nota Bene : we assume \ocwbegindcode{}$\ocwlowerid{wl}$\ocwenddcode{} to be in final sandhi form except r or s.    \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} Thus in the following code all cases last = 34 \ocwbc{} d \ocwec{} could be omitted \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} for the sandhi viccheda algorithm when inflected forms are known final. \ocwec{}\ocweol
\ocwindent{4.00em}
$[~[\,]~\rightarrow{}~(\ocwlowerid{wl},[\,])~$\ocwbc{} no visarga for final s or r \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~[~\ocwlowerid{first}~::~\ocwlowerid{after}~]~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{last}~$\ocwkw{then}\ocweol
\ocwindent{3.50em}
\ocwkw{if}~$\ocwlowerid{vowel\_or\_phantom}~\ocwlowerid{first}~$\ocwkw{then}~\ocwbc{} first may be *e or *o, thus uph below \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{glue}~=$\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{glue}$\ocwenddcode{} is the string replacing \ocwbegindcode{}[~$\ocwlowerid{last};~\ocwlowerid{first}~]$\ocwenddcode{} with a special convention:
   when it starts with -1, it means the last letter of \ocwbegindcode{}$\ocwlowerid{before}$\ocwenddcode{} is erased,
   which occurs only when last is visarga \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{savarna\_ph}~\ocwlowerid{last}~\ocwlowerid{first}~$\ocwkw{then}~$[~\ocwlowerid{long}~\ocwlowerid{last}~]~$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{avarna}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{asandhi}~\ocwlowerid{first}$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{ivarna}~\ocwlowerid{last}~$\ocwkw{then}~$[~42~::~\ocwlowerid{uph}~\ocwlowerid{first}~]~$\ocwbc{} y \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{uvarna}~\ocwlowerid{last}~$\ocwkw{then}~$[~45~::~\ocwlowerid{uph}~\ocwlowerid{first}~]~$\ocwbc{} v \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~7~\mid{}~8~\rightarrow{}~[~43~::~\ocwlowerid{uph}~\ocwlowerid{first}~]~$\ocwbc{} .r {\R} r \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~10~\mid{}~12~$\ocwbc{} e o \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{7.00em}
\ocwkw{if}~$\ocwlowerid{first}=1~$\ocwkw{then}~$[~\ocwlowerid{last};~-1~]~$\ocwbc{} avagraha \ocwec{}\ocweol
\ocwindent{7.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{first}=(-11)~$\ocwkw{then}~$[~1;~$\ocwkw{if}~$\ocwlowerid{last}=10~$\ocwkw{then}~42~\ocwkw{else}~44;~2~$]~$\ocweol
\ocwindent{9.50em}
\ocwbc{} e+aa+a -> ayaa  o+aa+a -> avaa (preverb aa on augment) \ocwec{}\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$[~1~::~[~50~::~\ocwlowerid{uph}~\ocwlowerid{first}~]~]~$\ocwbc{} a+hiatus \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~11~$\ocwbc{} ai \ocwec{}~$\rightarrow{}~[~2~::~[~50~::~\ocwlowerid{uph}~\ocwlowerid{first}~]~]~$\ocwbc{} aa+hiatus \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~13~$\ocwbc{} au \ocwec{}~$\rightarrow{}~[~2~::~[~45~::~\ocwlowerid{uph}~\ocwlowerid{first}~]~]~$\ocwbc{} aav \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{message}~=~$\ocwstring{"left\ocwvspace{}arg\ocwvspace{}of\ocwvspace{}sandhi\ocwvspace{}end\ocwvspace{}illegal\ocwvspace{}in\ocwvspace{}"}~\ocwkw{in}\ocweol
\ocwindent{9.50em}
$\ocwlowerid{failwith}~(\ocwlowerid{message}~$\^{}~$\ocwlowerid{decode}~\ocwlowerid{wl})$\ocweol
\ocwindent{6.00em}
$]~$\ocwkw{in}~$(\ocwlowerid{before},\ocwlowerid{glue}~@~\ocwlowerid{after})$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~$(\ocwlowerid{wl},$\ocwkw{if}~$\ocwlowerid{first}=23~$\ocwbc{} ch \ocwec{}~\ocwkw{then}~$[~22~::~\ocwlowerid{wr}~]~$\ocwbc{} cch \ocwec{}~\ocwkw{else}~$\ocwlowerid{wr})$\ocweol
\ocwindent{6.00em}
\ocwbc{} c optional except when \ocwbegindcode{}$\ocwlowerid{short\_vowel}~\ocwlowerid{last}$\ocwenddcode{} or wl=\=a or m\=a \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{else}~\ocwbc{} we assume that last cannot be a phantom and thus is a consonant \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{glue}~=~$\ocweol
\ocwindent{4.50em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{first}~$\ocwkw{then}~\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{visargcompv}~\ocwlowerid{first}~\ocwlowerid{before}~$\ocwbc{} may start with -1 \ocwec{}\ocweol
\ocwindent{6.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}~\ocweol
\ocwindent{8.50em}
$[~21~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}~\ocweol
\ocwindent{10.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"left\ocwvspace{}arg\ocwvspace{}too\ocwvspace{}short"}\ocweol
\ocwindent{10.00em}
$\mid{}~[~\ocwlowerid{v}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{short\_vowel}~\ocwlowerid{v}~$\ocwkw{then}~\ocweol
\ocwindent{21.00em}
$[~21~::~[~21~::~\ocwlowerid{uph}~\ocwlowerid{first}~]~]~$\ocwbc{} ff \ocwec{}\ocweol
\ocwindent{19.50em}
\ocwkw{else}~$[~21~::~\ocwlowerid{uph}~\ocwlowerid{first}~]~$\ocweol
\ocwindent{10.00em}
$]$\ocweol
\ocwindent{8.50em}
$\mid{}~36~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}~\ocweol
\ocwindent{10.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"left\ocwvspace{}arg\ocwvspace{}too\ocwvspace{}short"}\ocweol
\ocwindent{10.00em}
$\mid{}~[~\ocwlowerid{v}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{short\_vowel}~\ocwlowerid{v}~$\ocwkw{then}~\ocweol
\ocwindent{21.00em}
$[~36~::~[~36~::~\ocwlowerid{uph}~\ocwlowerid{first}~]~]~$\ocwbc{} nn \ocwec{}\ocweol
\ocwindent{19.50em}
\ocwkw{else}~$[~36~::~\ocwlowerid{uph}~\ocwlowerid{first}~]~$\ocweol
\ocwindent{10.00em}
$]$\ocweol
\ocwindent{8.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{voiced}~\ocwlowerid{c}~::~\ocwlowerid{uph}~\ocwlowerid{first}~]~$\ocwbc{} t {\R} d, p {\R} b  \ocwec{}\ocweol
\ocwindent{8.50em}
$]$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~\ocwbc{} both consonant \ocwec{}~\ocwkw{match}~$\ocwlowerid{first}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~49~$\ocwbc{} h \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{4.50em}
\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{visargcomp1}~\ocwlowerid{first}~\ocwlowerid{before}$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~17~\mid{}~19~\rightarrow{}~[~19;~20~]~$\ocwbc{} k+h {\R} ggh,  g+h {\R} ggh \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~27~\rightarrow{}~[~29;~30~]~$\ocwbc{} {\d t}+h {\R} {\d d}{\d d}h \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~32~\mid{}~34~\rightarrow{}~[~34;~35~]~$\ocwbc{} t+h {\R} ddh,  d+h {\R} ddh \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~37~\mid{}~39~\rightarrow{}~[~39;~40~]~$\ocwbc{} p+h {\R} bbh,  b+h {\R} bbh \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~41~\rightarrow{}~[~14;~\ocwlowerid{first}~]~$\ocwbc{} m+h {\R} {\d m}h \ocwec{}~\ocweol
\ocwindent{9.00em}
\ocwbc{} but m+hm {\R} mhm and m+hn {\R} mhn preferably (Deshpande) \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~46~$\ocwbc{} \'s \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~32~\mid{}~34~\mid{}~22~\rightarrow{}~[~22;~23~]~$\ocwbc{} t+\'s {\R} cch  idem d c \ocwec{}~\ocweol
\ocwindent{13.00em}
\ocwbc{} optionally \ocwbegindcode{}~22;~46~\ocwenddcode{} c's see \ocwbegindcode{}$\ocwlowerid{compile\_sandhi}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~36~\rightarrow{}~[~26;~23~]~$\ocwbc{} n+\'s {\R} \~nch (or \ocwbegindcode{}~26;~46~\ocwenddcode{} \~n\'s) \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~41~\rightarrow{}~[~14;~\ocwlowerid{first}~]~$\ocwbc{} m+\'s {\R} {\d m}\'s (or \~nch optional) \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~$\ocwkw{if}~$\ocwlowerid{visargor}~\ocwlowerid{c}~$\ocwkw{then}~16~\ocwkw{else}~$\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~36~\mid{}~41~$\ocwbc{} n m \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{visargcomp1}~\ocwlowerid{first}~\ocwlowerid{before}$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~17~\mid{}~21~\rightarrow{}~[~21;~\ocwlowerid{first}~]~$\ocwbc{} k+n {\R} \.nn 'n+n -> 'nn \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~27~\mid{}~29~\rightarrow{}~[~31;~\ocwlowerid{first}~]~$\ocwbc{} {\d t}+n {\R} {\d n}n  {\d d}+n {\R} {\d n}n \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~32~\mid{}~34~\rightarrow{}~[~36;~\ocwlowerid{first}~]~$\ocwbc{} t+n {\R} nn  d+n {\R} nn \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~37~\rightarrow{}~[~41;~\ocwlowerid{first}~]~$\ocwbc{} p+n {\R} mn \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~41~\rightarrow{}~[~14;~\ocwlowerid{first}~]~$\ocwbc{} m+n {\R} {\d m}n \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{c};~\ocwlowerid{first}~]~$\ocwbc{} \.n+n {\R} \.nn etc. \ocwec{}\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~47~\mid{}~48~$\ocwbc{} {\d s} s \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{7.50em}
\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~14;~\ocwlowerid{first}~]~$\ocwbc{} m+s {\R} {\d m}s \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~34~\rightarrow{}~[~32;~\ocwlowerid{first}~]~$\ocwbc{} d+s {\R} ts \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~$\ocwkw{if}~$\ocwlowerid{visargor}~\ocwlowerid{c}~$\ocwkw{then}~16~\ocwkw{else}~$\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~37~\mid{}~38~\mid{}~17~\mid{}~18~$\ocwbc{} p ph k kh \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{7.50em}
\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~14;~\ocwlowerid{first}~]~$\ocwbc{} m+p {\R} {\d m}p \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~34~\rightarrow{}~[~32;~\ocwlowerid{first}~]~$\ocwbc{} d+p {\R} tp \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~$\ocwkw{if}~$\ocwlowerid{visargor}~\ocwlowerid{c}~$\ocwkw{then}~16~\ocwkw{else}~$\ocwlowerid{c};~\ocwlowerid{first}~]~$\ocwbc{} s+k {\R} {\d h}k but optional {\d s}k \ocwec{}\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~44~$\ocwbc{} l \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{visargcomp1}~\ocwlowerid{first}~\ocwlowerid{before}$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~32~\mid{}~34~\rightarrow{}~[~44;~44~]~$\ocwbc{} t+l {\R} ll  d+l {\R} ll \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~36~\mid{}~41~\rightarrow{}~[~44;~15;~44~]~$\ocwbc{} n+l {\R} l\~ l (candrabindu) \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{voiced}~\ocwlowerid{c};~44~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~42~\mid{}~45~$\ocwbc{} y v \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{visargcomp1}~\ocwlowerid{first}~\ocwlowerid{before}$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~14;~\ocwlowerid{first}~]~$\ocwbc{} m+y {\R} {\d m}y \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{voiced}~\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~43~$\ocwbc{} r \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{visargcomp2}~\ocwlowerid{before}$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~14;~43~]~$\ocwbc{} m+r {\R} {\d m}r \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~43~\rightarrow{}~\ocwlowerid{visargcompr}~\ocwlowerid{before}~$\ocwbc{} Gonda §16 \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{voiced}~\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]~$\ocweol
\ocwindent{2.50em}
$\mid{}~39~\mid{}~40~\mid{}~34~\mid{}~35~\mid{}~19~\mid{}~20~$\ocwbc{} b bh d dh g gh \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{visargcomp1}~\ocwlowerid{first}~\ocwlowerid{before}$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~14;~\ocwlowerid{first}~]~$\ocwbc{} m+b {\R} {\d m}b == mb \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{voiced}~\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~29~\mid{}~30~$\ocwbc{} {\d d} {\d d}h \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{visargcomp1}~\ocwlowerid{first}~\ocwlowerid{before}$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~14;~\ocwlowerid{first}~]~$\ocwbc{} m+{\d d} {\R} {\d m}{\d d} == {\d n}{\d d} \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~32~\mid{}~34~\rightarrow{}~[~29;~\ocwlowerid{first}~]~$\ocwbc{} t+{\d d} {\R} {\d d}{\d d}  d+{\d d} {\R} {\d d}{\d d} \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~36~\rightarrow{}~[~31;~\ocwlowerid{first}~]~$\ocwbc{} n+{\d d} {\R} {\d n}{\d d} \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{voiced}~\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~24~\mid{}~25~$\ocwbc{} j jh \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{visarg}~\ocwlowerid{last}~$\ocwkw{then}~$\ocwlowerid{visargcomp1}~\ocwlowerid{first}~\ocwlowerid{before}$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~14;~\ocwlowerid{first}~]~$\ocwbc{} m+j {\R} {\d m}j == \~nj \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~32~\mid{}~34~\rightarrow{}~[~24;~\ocwlowerid{first}~]~$\ocwbc{} t+j {\R} jj  d+j {\R} jj \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~36~\rightarrow{}~[~26;~\ocwlowerid{first}~]~$\ocwbc{} n+j {\R} \~nj \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwlowerid{voiced}~\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~32~\mid{}~33~$\ocwbc{} t th \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}~\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~14;~\ocwlowerid{first}~]~$\ocwbc{} m+t {\R} {\d m}t == nt \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~36~\rightarrow{}~[~14;~48;~\ocwlowerid{first}~]~$\ocwbc{} n+t {\R} {\d m}st \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~34~\rightarrow{}~[~32;~\ocwlowerid{first}~]~$\ocwbc{} d+t {\R} tt \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~$\ocwkw{if}~$\ocwlowerid{visargor}~\ocwlowerid{c}~$\ocwkw{then}~48~\ocwkw{else}~$\ocwlowerid{c};~\ocwlowerid{first}~]~$\ocwbc{} s+t {\R} st \ocwec{}\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~27~\mid{}~28~$\ocwbc{} {\d t} {\d t}h \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}~\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~14;~\ocwlowerid{first}~]~$\ocwbc{} m+{\d t} {\R} {\d m}{\d t} == {\d n}{\d t} \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~32~\mid{}~34~\rightarrow{}~[~27;~\ocwlowerid{first}~]~$\ocwbc{} t+{\d t} {\R} {\d t}{\d t}  d+{\d t} {\R} {\d t}{\d t} \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~36~\rightarrow{}~[~14;~47;~\ocwlowerid{first}~]~$\ocwbc{} n+{\d t} {\R} {\d m}{\d s}{\d t} \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~$\ocwkw{if}~$\ocwlowerid{visargor}~\ocwlowerid{c}~$\ocwkw{then}~47~\ocwkw{else}~$\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~22~\mid{}~23~$\ocwbc{} c ch \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{last}~$\ocwkw{with}~\ocweol
\ocwindent{6.50em}
$[~41~\rightarrow{}~[~14;~\ocwlowerid{first}~]~$\ocwbc{} m+c {\R} {\d m}c == \~nc \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~32~\mid{}~34~\rightarrow{}~[~22;~\ocwlowerid{first}~]~$\ocwbc{} t+c {\R} cc  d+c {\R} cc \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~36~\rightarrow{}~[~14;~46;~\ocwlowerid{first}~]~$\ocwbc{} n+c {\R} {\d m}\'sc \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~$\ocwkw{if}~$\ocwlowerid{visargor}~\ocwlowerid{c}~$\ocwkw{then}~46~\ocwkw{else}~$\ocwlowerid{c};~\ocwlowerid{first}~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"illegal\ocwvspace{}start\ocwvspace{}of\ocwvspace{}right\ocwvspace{}arg\ocwvspace{}of\ocwvspace{}sandhi\ocwvspace{}in\ocwvspace{}"}~\^{}~$\ocwlowerid{decode}~\ocwlowerid{wr})$\ocweol
\ocwindent{2.50em}
$]~$\ocwbc{} match first \ocwec{}~\ocwkw{in}~\ocwbc{} let glue \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$(\ocwlowerid{w1},\ocwlowerid{w2})~=~$\ocwkw{match}~$\ocwlowerid{glue}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"empty\ocwvspace{}glue"}\ocweol
\ocwindent{5.00em}
$\mid{}~[~-1~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"left\ocwvspace{}arg\ocwvspace{}too\ocwvspace{}short"}\ocweol
\ocwindent{7.50em}
$\mid{}~[~\ocwlowerid{\_}~$\ocwbc{} a \ocwec{}~::~$\ocwlowerid{init}~]~\rightarrow{}~(\ocwlowerid{init},\ocwlowerid{rest})$\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~(\ocwlowerid{before},\ocwlowerid{glue})$\ocweol
\ocwindent{5.00em}
$]~$\ocwkw{in}~$(\ocwlowerid{w1},\ocwlowerid{w2}~@~\ocwlowerid{after})$\ocweol
\ocwindent{4.00em}
$]~$\ocwbc{} match \ocwbegindcode{}$\ocwlowerid{wr}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
$]~$\ocwbc{} match \ocwbegindcode{}$\ocwlowerid{wl}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ext\_sandhi0}~\ocwlowerid{wl}~\ocwlowerid{wr}~=~$\ocwbc{} No normalization \ocwec{}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{w1},\ocwlowerid{w2})~=~\ocwlowerid{ext\_sandhi\_pair}~\ocwlowerid{wl}~\ocwlowerid{wr}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{w1}~\ocwlowerid{w2}~$\ocwbc{} w1 is pasted as left context of w2 \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Only used in stand-alone module Sandhier; argument is rev of word \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{final\_sandhi}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Empty\ocwvspace{}input\ocwvspace{}Sandhi"}\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{last}~::~\ocwlowerid{rest}~]~$\ocwkw{when}~$\ocwlowerid{visargor}~\ocwlowerid{last}~$\ocweol
\ocwindent{3.50em}
$\rightarrow{}~\ocwupperid{List.}\ocwlowerid{rev}~[~16~::~\ocwlowerid{rest}~]~$\ocwbc{} final visarga \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{rw}~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{rev}~(\ocwlowerid{finalize}~\ocwlowerid{rw})$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
External sandhi - Reference version - used in \ocwbegindcode{}$\ocwupperid{Roots}.\ocwlowerid{follow}$\ocwenddcode{} 
\ocweol
\ocwindent{0.00em}
\ocwbegindcode{}$\ocwlowerid{esandhi}~:~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{word}$\ocwenddcode{} 
\ocweol
\label{sandhi.ml:12213}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{esandhi}~\ocwlowerid{left}~\ocwlowerid{right}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{wl}~=~\ocwupperid{List.}\ocwlowerid{rev}~(\ocwlowerid{code}~\ocwlowerid{left})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{wr}~=~\ocwlowerid{code}~\ocwlowerid{right}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{Encode.}\ocwlowerid{normalize}~(\ocwlowerid{ext\_sandhi0}~\ocwlowerid{wl}~\ocwlowerid{wr})~$\ocwbc{} normalization \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Unused directly; copied in \ocwbegindcode{}$\ocwupperid{Compile\_sandhi}.\ocwlowerid{match\_sandhi}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{e\_sandhi}~:~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{string}\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{e\_sandhi}~\ocwlowerid{left}~\ocwlowerid{right}~=~\ocwlowerid{decode}~(\ocwlowerid{esandhi}~\ocwlowerid{left}~\ocwlowerid{right})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Used in \ocwbegindcode{}$\ocwupperid{Roots}.\ocwlowerid{follow}$\ocwenddcode{} and \ocwbegindcode{}$\ocwupperid{Make\_preverbs}.\ocwlowerid{preverbs\_etym}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pv\_sandhi}~\ocwlowerid{left}~\ocwlowerid{right}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{left}=$\ocwstring{"pra"}~$\land{}~\ocwlowerid{right}=$\ocwstring{"ni"}~\ocwkw{then}~\ocwstring{"pra.ni"}~\ocwbc{} retroflexion \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{else}~$\ocwlowerid{e\_sandhi}~\ocwlowerid{left}~\ocwlowerid{right}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pv\_sandhi0}~\ocwlowerid{wl}~\ocwlowerid{wr}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{rwl}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{wl}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{rwl}=\ocwlowerid{code}~$\ocwstring{"pra"}~$\land{}~\ocwlowerid{wr}=\ocwlowerid{code}~$\ocwstring{"ni"}~\ocwkw{then}~$\ocwlowerid{code}~$\ocwstring{"pra.ni"}~\ocwbc{} retroflexion \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{else}~$\ocwupperid{Encode.}\ocwlowerid{normalize}~(\ocwlowerid{ext\_sandhi0}~\ocwlowerid{wl}~\ocwlowerid{wr})~$\ocwbc{} normalization \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} tests \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"vane"}~\ocwstring{"iva"}~=~\ocwstring{"vana\_iva"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"na"}~\ocwstring{"chinatti"}~=~\ocwstring{"nacchinatti"}$);~$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"tat"}~\ocwstring{"zariiram"}~=~\ocwstring{"tacchariiram"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"tat"}~\ocwstring{"lebhe"}~=~\ocwstring{"tallebhe"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"tat"}~\ocwstring{"zrutvaa"}~=~\ocwstring{"tacchrutvaa"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"tat"}~\ocwstring{"jayati"}~=~\ocwstring{"tajjayati"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"tat"}~\ocwstring{"mitram"}~=~\ocwstring{"tanmitram"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"azvas"}~\ocwstring{"asti"}~=~\ocwstring{"azvo'sti"}$);~$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"azvas"}~\ocwstring{"iva"}~=~\ocwstring{"azva\_iva"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"punar"}~\ocwstring{"iva"}~=~\ocwstring{"punariva"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"punar"}~\ocwstring{"suuti"}~=~\ocwstring{"puna.hsuuti"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"punar"}~\ocwstring{"janman"}~=~\ocwstring{"punarjanman"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"api"}~\ocwstring{"avagacchasi"}~=~\ocwstring{"apyavagacchasi"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"nanu"}~\ocwstring{"upavizaama.h"}~=~\ocwstring{"nanuupavizaama.h"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"ubhau"}~\ocwstring{"aagacchata.h"}~=~\ocwstring{"ubhaavaagacchata.h"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"katham"}~\ocwstring{"smarati"}~=~\ocwstring{"katha.msmarati"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"sam"}~\ocwstring{"hraad"}~=~\ocwstring{"sa.mhraad"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"dvi.t"}~\ocwstring{"hasati"}~=~\ocwstring{"dvi.d.dhasati"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"ud"}~\ocwstring{"h.r"}~=~\ocwstring{"uddh.r"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"tat"}~\ocwstring{"hema"}~=~\ocwstring{"taddhema"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"taan"}~\ocwstring{"tu"}~=~\ocwstring{"taa.mstu"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"nara.h"}~\ocwstring{"rak.sati"}~=~\ocwstring{"narorak.sati"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"punar"}~\ocwstring{"rak.sati"}~=~\ocwstring{"punaarak.sati"}$);~$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"gaayan"}~\ocwstring{"aagacchati"}~=~\ocwstring{"gaayannaagacchati"}$);~$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"vaak"}~\ocwstring{"me"}~=~\ocwstring{"vaafme"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"vaag"}~\ocwstring{"hasati"}~=~\ocwstring{"vaagghasati"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"bahis"}~\ocwstring{"k.r"}~=~\ocwstring{"bahi.hk.r"}$);~$\ocwbc{} aussi \ocwstring{"bahi.sk.r"} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{".sa.t"}~\ocwstring{"naam"}~=~\ocwstring{".sa.nnaam"}$);~$\ocwbc{} and not \ocwstring{".sa.n.naam"} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"tat"}~\ocwstring{"namas"}~=~\ocwstring{"tannamas"}$);~$\ocwbc{} but \ocwstring{"tadnamas"} also correct \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"kim"}~\ocwstring{"hmalayati"}~=~\ocwstring{"ki.mhmalayati"}$);~$\ocwbc{} but \ocwstring{"kimhmalayati"} also correct \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"kim"}~\ocwstring{"hnute"}~=~\ocwstring{"ki.mhnute"}$);~$\ocwbc{} but \ocwstring{"kinhnute"} also correct (metathesis) \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"tat"}~\ocwstring{"mitram"}~=~\ocwstring{"tanmitram"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"devaan"}~\ocwstring{"z.r.noti"}~=~\ocwstring{"devaa\~{}nch.r.noti"}$);$\medskip

\ocwendcode{}\ocwindent{0.00em}
Remark. \ocwbegindcode{}$\ocwlowerid{e\_sandhi}$\ocwenddcode{} is used for preverbs, and the existence of 
   *e and *o guarantees that \ocwbegindcode{}$(\ocwlowerid{external\_sandhi}~\ocwlowerid{x}~(\ocwlowerid{external\_sandhi}~\ocwlowerid{pre}~\ocwlowerid{y}))$\ocwenddcode{}
   is the same as \ocwbegindcode{}$(\ocwlowerid{external\_sandhi}~(\ocwlowerid{external\_sandhi}~\ocwlowerid{x}~\ocwlowerid{pre})~\ocwlowerid{y})$\ocwenddcode{}: 
\ocweol
\ocwindent{0.00em}
NB. form "aa|ihi" with *e-phantom generated by Inflected. 
\ocweol
\label{sandhi.ml:15040}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"iha"}~\ocwstring{"aa|ihi"}~=~\ocwstring{"ihehi"}$);~$\ocwbc{} e-phantom elim \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"iha"}~\ocwstring{"aa"}~=~\ocwstring{"ihaa"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"ihaa"}~\ocwstring{"ihi"}~=~\ocwstring{"ihehi"}$);$\ocweol
\ocwindent{0.00em}
\ocwbc{} Idem for *o : fake sandhi \ocwstring{"aa"} \ocwstring{"upa"} = \ocwstring{"aa|upa"}) generated by Inflected. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{e\_sandhi}~$\ocwstring{"zoka"}~\ocwstring{"aa|rta"}~=~\ocwstring{"zokaarta"}$);$\medskip

\ocwendcode{}\ocwindent{0.00em}
Context-sensitive irregularities 
\ocweol
\label{sandhi.ml:15355}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{external\_sandhi}~\ocwlowerid{left}~\ocwlowerid{right}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{left}~=~$\ocwstring{"sas"}~$\lor{}~\ocwlowerid{left}~=~$\ocwstring{"sa.h"}~\ocwkw{then}\ocweol
\ocwindent{2.50em}
\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{right}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~[\,]~\rightarrow{}~$\ocwstring{"sa.h"}\ocweol
\ocwindent{4.00em}
$\mid{}~[~\ocwlowerid{first}~::~\ocwlowerid{after}~]~\rightarrow{}$\ocweol
\ocwindent{6.00em}
$\ocwlowerid{e\_sandhi}~($\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{first}~$\ocwkw{then}~\ocwstring{"sa.h"}~\ocwkw{else}~\ocwstring{"sa"}$)~\ocwlowerid{right}$\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~$\ocwlowerid{e\_sandhi}~\ocwlowerid{left}~\ocwlowerid{right}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Sandhier version, takes a revword and a word, and returns a word \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ext\_sandhi}~\ocwlowerid{rvlword}~\ocwlowerid{rword}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{left}~=~$\ocwkw{match}~$\ocwlowerid{rvlword}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~48~::~[~1;~48~]~]~\mid{}~[~16~::~[~1;~48~]~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rword}~$\ocwkw{with}~\ocweol
\ocwindent{7.00em}
$[~[\,]~\rightarrow{}~[~16~::~[~1;~48~]~]$\ocweol
\ocwindent{7.00em}
$\mid{}~[~\ocwlowerid{first}~::~\ocwlowerid{after}~]~\rightarrow{}$\ocweol
\ocwindent{9.00em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{first}~$\ocwkw{then}~$[~16~::~[~1;~48~]~]~$\ocwkw{else}~$[~1;~48~]$\ocweol
\ocwindent{7.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{l}~\rightarrow{}~\ocwlowerid{l}$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}~$\ocwlowerid{ext\_sandhi0}~\ocwlowerid{left}~\ocwlowerid{rword}~$\ocwbc{} does not finalize r or s into .h \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{after\_dual\_sandhi}~\ocwlowerid{left}~\ocwlowerid{right}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwupperid{List.}\ocwlowerid{rev}~(\ocwlowerid{code}~\ocwlowerid{left})$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"left\ocwvspace{}arg\ocwvspace{}of\ocwvspace{}sandhi\ocwvspace{}empty"}\ocweol
\ocwindent{3.50em}
$\mid{}~[~\ocwlowerid{last}~::~\ocwlowerid{\_}~]~\rightarrow{}$\ocweol
\ocwindent{4.50em}
\ocwkw{if}~$\ocwlowerid{last}=4~$\ocwbc{} ii \ocwec{}~$\lor{}~\ocwlowerid{last}=6~$\ocwbc{} uu \ocwec{}~$\lor{}~\ocwlowerid{last}=10~$\ocwbc{} e \ocwec{}\ocweol
\ocwindent{6.00em}
\ocwkw{then}~$(\ocwlowerid{left}~$\^{}~\ocwstring{"\_"}~\^{}~$\ocwlowerid{right})~$\ocwbc{} hiatus \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwkw{else}~$\ocwlowerid{e\_sandhi}~\ocwlowerid{left}~\ocwlowerid{right}$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} tests \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{external\_sandhi}~$\ocwstring{"sas"}~\ocwstring{"gaja.h"}~=~\ocwstring{"sagaja.h"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{external\_sandhi}~$\ocwstring{"sas"}~\ocwstring{"aacaarya.h"}~=~\ocwstring{"sa\_aacaarya.h"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{external\_sandhi}~$\ocwstring{"sas"}~\ocwstring{"azva.h"}~=~\ocwstring{"so'zva.h"}$);$\ocweol
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{external\_sandhi}~$\ocwstring{"sas"}~\ocwstring{""}~=~\ocwstring{"sa.h"}$);$\medskip

\label{sandhi.ml:16619}%
\ocwindent{0.00em}
\ocwkw{assert}~$(\ocwlowerid{after\_dual\_sandhi}~$\ocwstring{"tephale"}~\ocwstring{"icchaama.h"}~=~\ocwstring{"tephale\_icchaama.h"}$);$\medskip

\ocwendcode{}\ocwindent{0.00em}
Also external sandhi does not occur after interjections 
   and is optional after initial vocatives - TODO 
\ocweol
\typeout{OcamlWeb file Sandhier.ml}
\ocwmodule{Sandhier}
\label{sandhier.ml:0}%
Sandhi Engine cgi 
\ocweol
\ocwindent{0.00em}
It gives the most commun sandhi solution, but not the optional forms 
\ocweol
\ocwindent{0.00em}
This stand-alone module is not used by the rest of the system 
\ocweol
\label{sandhier.ml:821}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Sandhi};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{final\_sandhi}$\ocwenddcode{} \ocwbegindcode{}$\ocwlowerid{ext\_sandhi}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Int\_sandhi};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{int\_sandhi}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps pl abort etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Cgi};$\medskip

\label{sandhier.ml:959}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{title}~=~\ocwlowerid{h1\_title}~($\ocwkw{if}~$\ocwlowerid{narrow\_screen}~$\ocwkw{then}~\ocwstring{"Sandhi"}~\ocweol
\ocwindent{12.50em}
\ocwkw{else}~\ocwstring{"The\ocwvspace{}Sandhi\ocwvspace{}Engine"}$)$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{meta\_title}~=~\ocwlowerid{title}~$\ocwstring{"Sanskrit\ocwvspace{}Sandhi\ocwvspace{}Engine"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display\_rom\_red}~\ocwlowerid{s}~=~\ocwlowerid{html\_red}~(\ocwupperid{Transduction.}\ocwlowerid{skt\_to\_html}~\ocwlowerid{s})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{display\_dev\_red}~\ocwlowerid{s}~=~\ocwlowerid{html\_devared}~(\ocwupperid{Encode.}\ocwlowerid{skt\_to\_deva}~\ocwlowerid{s})~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sandhi\_engine}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{http\_header}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_begin}~\ocwlowerid{meta\_title}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{body\_begin}~(\ocwlowerid{background}~\ocwupperid{Chamois}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{title}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{query}~=~\ocwupperid{Sys.}\ocwlowerid{getenv}~$\ocwstring{"QUERY\_STRING"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{env}~=~\ocwlowerid{create\_env}~\ocwlowerid{query}~$\ocwkw{in}~\ocweol
\ocwindent{1.50em}
\ocwkw{try}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{url\_encoded\_left}~=~\ocwlowerid{get}~$\ocwstring{"l"}~$\ocwlowerid{env}~$\ocwstring{""}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_right}~=~\ocwlowerid{get}~$\ocwstring{"r"}~$\ocwlowerid{env}~$\ocwstring{""}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_kind}~=~\ocwlowerid{get}~$\ocwstring{"k"}~$\ocwlowerid{env}~$\ocwstring{"external"}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{translit}~=~\ocwlowerid{get}~$\ocwstring{"t"}~$\ocwlowerid{env}~\ocwupperid{Paths.}\ocwlowerid{default\_transliteration}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{lex}~=~\ocwlowerid{get}~$\ocwstring{"lex"}~$\ocwlowerid{env}~\ocwupperid{Paths.}\ocwlowerid{default\_lexicon}~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{left\_str}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_left}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{right\_str}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_right}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{lang}~=~\ocwlowerid{language\_of}~\ocwlowerid{lex}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{encode}~=~\ocwupperid{Encode.}\ocwlowerid{switch\_code}~\ocwlowerid{translit}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{left\_word}~=~\ocwlowerid{encode}~\ocwlowerid{left\_str}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{right\_word}~=~\ocwlowerid{encode}~\ocwlowerid{right\_str}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{rleft\_word}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{left\_word}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{final}~=~(\ocwlowerid{right\_word}~=~[\,])~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{result\_word}~=~$\ocwkw{match}~$\ocwlowerid{url\_encoded\_kind}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"external"}~$\rightarrow{}~$\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{final}~$\ocwkw{then}~$\ocwlowerid{final\_sandhi}~\ocwlowerid{rleft\_word}$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~$\ocwlowerid{ext\_sandhi}~\ocwlowerid{rleft\_word}~\ocwlowerid{right\_word}$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"internal"}~$\rightarrow{}~$\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{final}~$\ocwkw{then}~$\ocwlowerid{raise}~(\ocwupperid{Control.Fatal}~$\ocwstring{"Empty\ocwvspace{}right\ocwvspace{}component"}$)$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~$\ocwlowerid{int\_sandhi}~\ocwlowerid{rleft\_word}~\ocwlowerid{right\_word}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Fatal}~$\ocwstring{"Unexpected\ocwvspace{}kind"}$)$\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{kind}~=~$\ocwkw{if}~$\ocwlowerid{final}~$\ocwkw{then}~\ocwstring{"final"}~\ocwkw{else}~$\ocwlowerid{url\_encoded\_kind}~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{left}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{left\_word}~$\ocwbc{} = \ocwbegindcode{}$\ocwlowerid{left\_str}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{right}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{right\_word}~$\ocwbc{} = \ocwbegindcode{}$\ocwlowerid{right\_str}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{result}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{result\_word}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{span\_begin}~\ocwupperid{C1})$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~($\ocwstring{"The\ocwvspace{}"}~\^{}~$\ocwlowerid{kind}~$\^{}~\ocwstring{"\ocwvspace{}sandhi\ocwvspace{}of\ocwvspace{}"}$)$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{display\_rom\_red}~\ocwlowerid{left})$\ocweol
\ocwindent{2.00em}
;~\ocwkw{if}~$\ocwlowerid{final}~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{4.50em}
\{~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}and\ocwvspace{}"}\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{ps}~(\ocwlowerid{display\_rom\_red}~\ocwlowerid{right})$\ocweol
\ocwindent{4.50em}
\}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}is\ocwvspace{}"}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{display\_rom\_red}~\ocwlowerid{result})$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{span\_end}~$\ocwbc{} C1 \ocwec{}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{center\_begin}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{span\_skt\_begin}~\ocwupperid{Deva20c})$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{display\_dev\_red}~\ocwlowerid{left})$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}\ocweol
\ocwindent{2.00em}
;~\ocwkw{if}~$\ocwlowerid{final}~$\ocwkw{then}~$()~$\ocwkw{else}~$\ocwlowerid{ps}~(\ocwlowerid{display\_dev\_red}~\ocwlowerid{right})$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}=\ocwvspace{}"}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{display\_dev\_red}~\ocwlowerid{result})$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{span\_end}~$\ocwbc{} Deva20c \ocwec{}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{center\_end}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{span\_begin}~\ocwupperid{C1})$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"NB.\ocwvspace{}Other\ocwvspace{}sandhi\ocwvspace{}solutions\ocwvspace{}may\ocwvspace{}be\ocwvspace{}allowed"}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{span\_end}~$\ocwbc{} C1 \ocwec{}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{page\_end}~\ocwlowerid{lang}~\ocwupperid{True}$\ocweol
\ocwindent{2.00em}
\}~\ocweol
\ocwindent{1.50em}
\ocwkw{with}~$[~\ocwupperid{Stream.Error}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Exit}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Not\_found}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"parameter\ocwvspace{}missing\ocwvspace{}?"}\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{safe\_engine}~()~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{abor}~=~\ocwlowerid{abort}~\ocwlowerid{default\_language}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwlowerid{sandhi\_engine}~()~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Sys\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{sys\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Stream.Error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{stream\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Encode.In\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Wrong\_input\ocwvspace{}"}~$\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Invalid\_argument}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} sub \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Failure}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Not\_found}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"assoc"}~\ocwbc{} assoc \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{End\_of\_file}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"EOF"}~\ocwbc{} EOF \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Control.Fatal}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Wrong\ocwvspace{}parameters\ocwvspace{}"}~$\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Exit}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Wrong\ocwvspace{}character\ocwvspace{}in\ocwvspace{}input\ocwvspace{}\symbol{45}\ocwvspace{}"}~\ocweol
\ocwindent{15.50em}
\ocwstring{"check\ocwvspace{}input\ocwvspace{}convention"}~\ocwbc{} Sanskrit \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"Unexpected\ocwvspace{}anomaly"}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{safe\_engine}~()$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Pada.ml}
\ocwmodule{Pada}
\label{pada.ml:0}%
Pada defines the allowed padas (Para, Atma or Ubha) for
   a given combination of root, gana, and upasarga 
\ocweol
\ocwindent{0.00em}
It is used at conjugation computation time by Verbs, in order to generate 
   root forms for attested lexicalizations of root and gana (over all
   possible upasarga usages) and at segmentation time, to filter out
   by Dispatcher the non attested combinations of gana, pada and upasarga 
\ocweol
\label{pada.ml:1058}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{voices}~=~$\ocwbc{} permitted padas in present system \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} NB. These are distinctions within the active voice, as opposed to passive 
     (\ocwstring{"karma.ni\ocwvspace{}prayoga"}). Atma is called \ocwstring{"middle"} by Western grammarians. \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Para}~$\ocwbc{} parasmaipadin usage only - generated as Dictionary.Active \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Atma}~$\ocwbc{} aatmanepadin  usage only - generated as Dictionary.Middle \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ubha}~$\ocwbc{} admits both schemes - default \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Unattested}~$\ocwbc{} when a root/pada is attested only for some pvs \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{voices\_of}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
\ocwbc{} Simplification: invariant when prefixing by preverbs \ocwec{}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"ak.s"}~$\mid{}~$\ocwstring{"afg"}~$\mid{}~$\ocwstring{"aj"}~$\mid{}~$\ocwstring{"a.t"}~$\mid{}~$\ocwstring{"at"}~$\mid{}~$\ocwstring{"ad\#1"}~$\mid{}~$\ocwstring{"an\#2"}~$\mid{}~$\ocwstring{"am"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"ard"}~$\mid{}~$\ocwstring{"av"}~$\mid{}~$\ocwstring{"az\#2"}~$\mid{}~$\ocwstring{"as\#1"}~$\mid{}~$\ocwstring{"as\#2"}~$\mid{}~$\ocwstring{"aap"}~$\mid{}~$\ocwstring{"ifg"}~$\mid{}~$\ocwstring{"in"}~$\mid{}~$\ocwstring{"ind"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"inv"}~$\mid{}~$\ocwstring{"il"}~$\mid{}~$\ocwstring{"i.s\#2"}~$\mid{}~$\ocwstring{"iifkh"}~$\mid{}~$\ocwstring{"iir.s"}~$\mid{}~$\ocwstring{"uk.s"}~$\mid{}~$\ocwstring{"uc"}~$\mid{}~$\ocwstring{"ujjh"}~$\mid{}~$\ocwstring{"u\~{}nch"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"und"}~$\mid{}~$\ocwstring{"umbh"}~$\mid{}~$\ocwstring{"u.s"}~$\mid{}~$\ocwstring{".rc\#1"}~$\mid{}~$\ocwstring{".rdh"}~$\mid{}~$\ocwstring{".r.s"}~$\mid{}~$\ocwstring{"ej"}~$\mid{}~$\ocwstring{"kas"}~$\mid{}~$\ocwstring{"kiil"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"ku.t"}~$\mid{}~$\ocwstring{"ku.n.th"}~$\mid{}~$\ocwstring{"kunth"}~$\mid{}~$\ocwstring{"kup"}~$\mid{}~$\ocwstring{"kul"}~$\mid{}~$\ocwstring{"kuuj"}~$\mid{}~$\ocwstring{"k.rt\#1"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"k.rz"}~$\mid{}~$\ocwstring{"krand"}~$\mid{}~$\ocwstring{"krii.d"}~$\mid{}~$\ocwstring{"kru\~{}nc\#1"}~$\mid{}~$\ocwstring{"krudh\#1"}~$\mid{}~$\ocwstring{"kruz"}~$\mid{}~$\ocwstring{"klam"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"klid"}~$\mid{}~$\ocwstring{"kliz"}~$\mid{}~$\ocwstring{"kvath"}~$\mid{}~$\ocwstring{"k.sar"}~$\mid{}~$\ocwstring{"k.sal"}~$\mid{}~$\ocwstring{"k.si"}~$\mid{}~$\ocwstring{"k.sii"}~$\mid{}~$\ocwstring{"k.su"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"k.sudh\#1"}~$\mid{}~$\ocwstring{"k.subh"}~$\mid{}~$\ocwstring{"k.svi.d"}~$\mid{}~$\ocwstring{"khaad"}~$\mid{}~$\ocwstring{"khid"}~$\mid{}~$\ocwstring{"khel"}~$\mid{}~$\ocwstring{"khyaa"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"gaj"}~$\mid{}~$\ocwstring{"gad"}~$\mid{}~$\ocwstring{"gam"}~$\mid{}~$\ocwstring{"garj"}~$\mid{}~$\ocwstring{"gard"}~$\mid{}~$\ocwstring{"gal"}~$\mid{}~$\ocwstring{"gaa\#1"}~$\mid{}~$\ocwstring{"gaa\#2"}~$\mid{}~$\ocwstring{"gu\~{}nj"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"gu.n.th"}~$\mid{}~$\ocwstring{"gup"}~$\mid{}~$\ocwstring{"gumph"}~$\mid{}~$\ocwstring{"g.rdh"}~$\mid{}~$\ocwstring{"g.rr\#1"}~$\mid{}~$\ocwstring{"g.rr\#2"}~$\mid{}~$\ocwstring{"granth"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"grah"}~$\mid{}~$\ocwstring{"glai"}~$\mid{}~$\ocwstring{"ghas"}~$\mid{}~$\ocwstring{"ghu.s"}~$\mid{}~$\ocwstring{"gh.r"}~$\mid{}~$\ocwstring{"gh.r.s"}~$\mid{}~$\ocwstring{"ghraa"}~$\mid{}~$\ocwstring{"cakaas"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"ca.t"}~$\mid{}~$\ocwstring{"cand"}~$\mid{}~$\ocwstring{"cam"}~$\mid{}~$\ocwstring{"car"}~$\mid{}~$\ocwstring{"cal"}~$\mid{}~$\ocwstring{"cit\#1"}~$\mid{}~$\ocwstring{"cumb"}~$\mid{}~$\ocwstring{"chur"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"ch.rd"}~$\mid{}~$\ocwstring{"jak.s"}~$\mid{}~$\ocwstring{"jap"}~$\mid{}~$\ocwstring{"jabh\#2"}~$\mid{}~$\ocwstring{"jam"}~$\mid{}~$\ocwstring{"jalp"}~$\mid{}~$\ocwstring{"jas"}~$\mid{}~$\ocwstring{"jaag.r"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"jinv"}~$\mid{}~$\ocwstring{"jiiv"}~$\mid{}~$\ocwstring{"jvar"}~$\mid{}~$\ocwstring{"jval"}~$\mid{}~$\ocwstring{"tak"}~$\mid{}~$\ocwstring{"tak.s"}~$\mid{}~$\ocwstring{"ta\~{}nc"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"tam"}~$\mid{}~$\ocwstring{"tarj"}~$\mid{}~$\ocwstring{"tup"}~$\mid{}~$\ocwstring{"tu.s"}~$\mid{}~$\ocwstring{"t.rp\#1"}~$\mid{}~$\ocwstring{"t.r.s\#1"}~$\mid{}~$\ocwstring{"t.rr"}~$\mid{}~$\ocwstring{"tyaj\#1"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"tras"}~$\mid{}~$\ocwstring{"tru.t"}~$\mid{}~$\ocwstring{"tvak.s"}~$\mid{}~$\ocwstring{"tsar"}~$\mid{}~$\ocwstring{"da.mz"}~$\mid{}~$\ocwstring{"dagh"}~$\mid{}~$\ocwstring{"dabh"}~$\mid{}~$\ocwstring{"dam\#1"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"dal"}~$\mid{}~$\ocwstring{"das"}~$\mid{}~$\ocwstring{"dah\#1"}~$\mid{}~$\ocwstring{"daa\#2"}~$\mid{}~$\ocwstring{"daa\#3"}~$\mid{}~$\ocwstring{"diiv\#1"}~$\mid{}~$\ocwstring{"du"}~$\mid{}~$\ocwstring{"du.s"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"d.rp"}~$\mid{}~$\ocwstring{"d.rbh"}~$\mid{}~$\ocwstring{"d.rz\#1"}~$\mid{}~$\ocwstring{"d.rh"}~$\mid{}~$\ocwstring{"d.rr"}~$\mid{}~$\ocwstring{"dhyaa"}~$\mid{}~$\ocwstring{"draa\#1"}~$\mid{}~$\ocwstring{"dru\#1"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"druh\#1"}~$\mid{}~$\ocwstring{"dham"}~$\mid{}~$\ocwstring{"dhaa\#2"}~$\mid{}~$\ocwstring{"dhru"}~$\mid{}~$\ocwstring{"dhvan"}~$\mid{}~$\ocwstring{"dhv.r"}~$\mid{}~$\ocwstring{"na.t"}~$\mid{}~$\ocwstring{"nad"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"nand"}~$\mid{}~$\ocwstring{"nam"}~$\mid{}~$\ocwstring{"nard"}~$\mid{}~$\ocwstring{"naz\#1"}~$\mid{}~$\ocwstring{"nind"}~$\mid{}~$\ocwstring{"nu\#1"}~$\mid{}~$\ocwstring{"n.rt"}~$\mid{}~$\ocwstring{"pa.t"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"pat\#1"}~$\mid{}~$\ocwstring{"path"}~$\mid{}~$\ocwstring{"paa\#1"}~$\mid{}~$\ocwstring{"paa\#2"}~$\mid{}~$\ocwstring{"pi\#2"}~$\mid{}~$\ocwstring{"piz\#1"}~$\mid{}~$\ocwstring{"pi.s"}~$\mid{}~$\ocwstring{"pu.t"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"p.r\#1"}~$\mid{}~$\ocwstring{"p.r.s"}~$\mid{}~$\ocwstring{"p.rr"}~$\mid{}~$\ocwstring{"praa\#1"}~$\mid{}~$\ocwstring{"phal"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"bal"}~$\mid{}~$\ocwstring{"b.rh\#1"}~$\mid{}~$\ocwstring{"b.rh\#2"}~$\mid{}~$\ocwstring{"bha\~{}nj"}~$\mid{}~$\ocwstring{"bha.n"}~$\mid{}~$\ocwstring{"bha.s"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"bhas"}~$\mid{}~$\ocwstring{"bhaa\#1"}~$\mid{}~$\ocwstring{"bhii\#1"}~$\mid{}~$\ocwstring{"bhuj\#1"}~$\mid{}~$\ocwstring{"bhuu\#1"}~$\mid{}~$\ocwstring{"bhuu.s"}~$\mid{}~$\ocwstring{"bhram"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"majj"}~$\mid{}~$\ocwstring{"ma.n.d"}~$\mid{}~$\ocwstring{"mad\#1"}~$\mid{}~$\ocwstring{"manth"}~$\mid{}~$\ocwstring{"mah"}~$\mid{}~$\ocwstring{"maa\#3"}~$\mid{}~$\ocwstring{"mi.s"}~$\mid{}~$\ocwstring{"mih"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"miil"}~$\mid{}~$\ocwstring{"mu.s\#1"}~$\mid{}~$\ocwstring{"muh"}~$\mid{}~$\ocwstring{"muurch"}~$\mid{}~$\ocwstring{"m.r.d"}~$\mid{}~$\ocwstring{"m.rz"}~$\mid{}~$\ocwstring{"mnaa"}~$\mid{}~$\ocwstring{"mre.d"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"mlaa"}~$\mid{}~$\ocwstring{"mlecch"}~$\mid{}~$\ocwstring{"yabh"}~$\mid{}~$\ocwstring{"yam"}~$\mid{}~$\ocwstring{"yas"}~$\mid{}~$\ocwstring{"yaa\#1"}~$\mid{}~$\ocwstring{"yu\#2"}~$\mid{}~$\ocwstring{"ra.mh"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"rak.s"}~$\mid{}~$\ocwstring{"ra.n"}~$\mid{}~$\ocwstring{"rad"}~$\mid{}~$\ocwstring{"radh"}~$\mid{}~$\ocwstring{"raa\#1"}~$\mid{}~$\ocwstring{"raadh"}~$\mid{}~$\ocwstring{"ri.s"}~$\mid{}~$\ocwstring{"ru"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"ruj\#1"}~$\mid{}~$\ocwstring{"rudh\#1"}~$\mid{}~$\ocwstring{"ru.s\#1"}~$\mid{}~$\ocwstring{"ruh\#1"}~$\mid{}~$\ocwstring{"lag"}~$\mid{}~$\ocwstring{"lafg"}~$\mid{}~$\ocwstring{"lap"}~$\mid{}~$\ocwstring{"lal"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"las"}~$\mid{}~$\ocwstring{"laa"}~$\mid{}~$\ocwstring{"laa\~{}nch"}~$\mid{}~$\ocwstring{"likh"}~$\mid{}~$\ocwstring{"liz"}~$\mid{}~$\ocwstring{"lu.n.th"}~$\mid{}~$\ocwstring{"lubh"}~$\mid{}~$\ocwstring{"lul"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"vak.s"}~$\mid{}~$\ocwstring{"vac"}~$\mid{}~$\ocwstring{"vaj"}~$\mid{}~$\ocwstring{"va\~{}nc"}~$\mid{}~$\ocwstring{"van"}~$\mid{}~$\ocwstring{"vam"}~$\mid{}~$\ocwstring{"valg"}~$\mid{}~$\ocwstring{"vaz"}~$\mid{}~$\ocwstring{"vas\#1"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"vaa\#2"}~$\mid{}~$\ocwstring{"vas\#4"}~$\mid{}~$\ocwstring{"vaa\~{}nch"}~$\mid{}~$\ocwstring{"vid\#1"}~$\mid{}~$\ocwstring{"vidh\#1"}~$\mid{}~$\ocwstring{"vi.s\#1"}~$\mid{}~$\ocwstring{"vii\#1"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"v.rj"}~$\mid{}~$\ocwstring{"v.r.s"}~$\mid{}~$\ocwstring{"v.rh"}~$\mid{}~$\ocwstring{"ven"}~$\mid{}~$\ocwstring{"vyac"}$\mid{}~$\ocwstring{"vyadh"}~$\mid{}~$\ocwstring{"vraj"}~$\mid{}~$\ocwstring{"vrazc"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"za.ms"}~$\mid{}~$\ocwstring{"zak"}~$\mid{}~$\ocwstring{"zam\#1"}~$\mid{}~$\ocwstring{"zam\#2"}~$\mid{}~$\ocwstring{"zal"}~$\mid{}~$\ocwstring{"zaz"}~$\mid{}~$\ocwstring{"zas"}~$\mid{}~$\ocwstring{"zaas"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"zi.s"}~$\mid{}~$\ocwstring{"ziil"}~$\mid{}~$\ocwstring{"zuc\#1"}~$\mid{}~$\ocwstring{"zudh"}~$\mid{}~$\ocwstring{"zumbh"}~$\mid{}~$\ocwstring{"zu.s"}~$\mid{}~$\ocwstring{"zuu"}~$\mid{}~$\ocwstring{"z.rr"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"zcut\#1"}~$\mid{}~$\ocwstring{"zram"}~$\mid{}~$\ocwstring{"zru"}~$\mid{}~$\ocwstring{"zli.s"}~$\mid{}~$\ocwstring{"zvas\#1"}~$\mid{}~$\ocwstring{".s.thiiv"}~$\mid{}~$\ocwstring{"sa\~{}nj"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"sad\#1"}~$\mid{}~$\ocwstring{"sap\#1"}~$\mid{}~$\ocwstring{"saa\#1"}~$\mid{}~$\ocwstring{"sidh\#1"}~$\mid{}~$\ocwstring{"sidh\#2"}~$\mid{}~$\ocwstring{"siiv"}~$\mid{}~$\ocwstring{"sur"}~$\mid{}~$\ocwstring{"s.r"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"s.rj\#1"}~$\mid{}~$\ocwstring{"s.rp"}~$\mid{}~$\ocwstring{"skand"}~$\mid{}~$\ocwstring{"skhal"}~$\mid{}~$\ocwstring{"stan"}~$\mid{}~$\ocwstring{"stubh"}~$\mid{}~$\ocwstring{"sthag"}~$\mid{}~$\ocwstring{"snaa"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"snih\#1"}~$\mid{}~$\ocwstring{"snu"}~$\mid{}~$\ocwstring{"snuh\#1"}~$\mid{}~$\ocwstring{"sp.r"}~$\mid{}~$\ocwstring{"sphal"}~$\mid{}~$\ocwstring{"sphu.t"}~$\mid{}~$\ocwstring{"sphur"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"sm.r"}~$\mid{}~$\ocwstring{"sru"}~$\mid{}~$\ocwstring{"svan"}~$\mid{}~$\ocwstring{"svap"}~$\mid{}~$\ocwstring{"svar\#1"}~$\mid{}~$\ocwstring{"svar\#2"}~$\mid{}~$\ocwstring{"ha.th"}~$\mid{}~$\ocwstring{"has"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"haa\#1"}~$\mid{}~$\ocwstring{"hi\#2"}~$\mid{}~$\ocwstring{"hi.ms"}~$\mid{}~$\ocwstring{"h.r.s"}~$\mid{}~$\ocwstring{"hras"}~$\mid{}~$\ocwstring{"hrii\#1"}~$\mid{}~$\ocwstring{"hval"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"maarg"}~\ocwbc{} root rather than nominal verb \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}| \ocwstring{"viz\#1"}  Atma needed for eg nivizate \Pan{1,3,17} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}| \ocwstring{"ji"}     Atma needed for eg vijayate paraajayate \Pan{1,3,19} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}| \ocwstring{"jyaa\#1"} Atma needed for jiiyate \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}| \ocwstring{"kan"}    Atma needed for kaayamaana \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}| \ocwstring{"van"}    Atma needed for vanute \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}| \ocwstring{"mah"} also Atma for pft. maamahe \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}| \ocwstring{"cit\#1"} also Atma for pft. cikite \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}| \ocwstring{"kaafk.s"} | \ocwstring{"han\#1"} occur also in Atma in BhG: kaafk.se hani.sye \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}| \ocwstring{"a\~{}nj"} also Atma afkte | \ocwstring{"naath"} \ocwstring{"praz"} \ocwstring{"sp.rz\#1"} idem \ocwec{}\ocweol
\ocwindent{3.00em}
$\rightarrow{}~\ocwupperid{Para}~$\ocwbc{} active only \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"az\#1"}~$\mid{}~$\ocwstring{"aas\#2"}~$\mid{}~$\ocwstring{"indh"}~$\mid{}~$\ocwstring{"iik.s"}~$\mid{}~$\ocwstring{"ii.d"}~$\mid{}~$\ocwstring{"iir"}~$\mid{}~$\ocwstring{"iiz\#1"}~$\mid{}~$\ocwstring{"ii.s"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"iih"}~$\mid{}~$\ocwstring{"edh"}~$\mid{}~$\ocwstring{"katth"}~$\mid{}~$\ocwstring{"kam"}~$\mid{}~$\ocwstring{"kamp"}~$\mid{}~$\ocwstring{"kaaz"}~$\mid{}~$\ocwstring{"kaas\#1"}~$\mid{}~$\ocwstring{"kuu"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"k.rp"}~$\mid{}~$\ocwstring{"k.lp"}~\ocwbc{} but Henry: {cak.lpur} \ocwstring{"ils\ocwvspace{}s'arrangèrent"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"klav"}~$\mid{}~$\ocwstring{"k.sad"}~$\mid{}~$\ocwstring{"k.sam"}~$\mid{}~$\ocwstring{"galbh"}~$\mid{}~$\ocwstring{"gaah"}~$\mid{}~$\ocwstring{"gur"}~$\mid{}~$\ocwstring{"gha.t"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"jabh\#1"}~$\mid{}~$\ocwstring{"ju.s\#1"}~$\mid{}~$\ocwstring{"j.rmbh"}~$\mid{}~$\ocwstring{".damb"}~$\mid{}~$\ocwstring{".dii"}~$\mid{}~$\ocwstring{"tandr"}~$\mid{}~$\ocwstring{"tij"}~$\mid{}~$\ocwstring{"trap"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"trai"}~$\mid{}~$\ocwstring{"tvar"}~$\mid{}~$\ocwstring{"dak.s"}~$\mid{}~$\ocwstring{"day"}~$\mid{}~$\ocwstring{"diik.s"}~$\mid{}~$\ocwstring{"diip"}~$\mid{}~$\ocwstring{"d.r\#1"}~$\mid{}~$\ocwstring{"dhii\#1"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"dhuk.s"}~$\mid{}~$\ocwstring{"pa.n"}~$\mid{}~$\ocwstring{"pad\#1"}~$\mid{}~$\ocwstring{"pi\~{}nj"}~$\mid{}~$\ocwstring{"p.r\#2"}~$\mid{}~$\ocwstring{"pyaa"}~$\mid{}~$\ocwstring{"prath"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"pru"}~$\mid{}~$\ocwstring{"plu"}~$\mid{}~$\ocwstring{"ba.mh"}~$\mid{}~$\ocwstring{"baadh"}~$\mid{}~$\ocwstring{"bha.n.d"}~$\mid{}~$\ocwstring{"bhand"}~$\mid{}~$\ocwstring{"bhaa.s"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"bhuj\#2"}~$\mid{}~$\ocwstring{"bhraaj"}~$\mid{}~$\ocwstring{"ma.mh"}~$\mid{}~$\ocwstring{"man"}~$\mid{}~$\ocwstring{"mand\#1"}~$\mid{}~$\ocwstring{"yat\#1"}~$\mid{}~$\ocwstring{"yudh\#1"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"rabh"}~$\mid{}~$\ocwstring{"ruc\#1"}~$\mid{}~$\ocwstring{"lajj"}~$\mid{}~$\ocwstring{"lamb"}~$\mid{}~$\ocwstring{"lii"}~$\mid{}~$\ocwstring{"loc"}~$\mid{}~$\ocwstring{"vand"}~$\mid{}~$\ocwstring{"vas\#2"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"vaaz"}~$\mid{}~$\ocwstring{"vip"}~$\mid{}~$\ocwstring{"v.rdh\#1"}~$\mid{}~$\ocwstring{"ve.s.t"}~$\mid{}~$\ocwstring{"vrii.d"}~$\mid{}~$\ocwstring{"zafk"}~$\mid{}~$\ocwstring{"zad"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"zi\~{}nj"}~$\mid{}~$\ocwstring{"zii\#1"}~$\mid{}~$\ocwstring{"zrambh"}~$\mid{}~$\ocwstring{"zlaagh"}~$\mid{}~$\ocwstring{"zvit"}~$\mid{}~$\ocwstring{"sac"}~$\mid{}~$\ocwstring{"sev"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"styaa"}~$\mid{}~$\ocwstring{"spand"}~$\mid{}~$\ocwstring{"spardh"}~$\mid{}~$\ocwstring{"spaz\#1"}~$\mid{}~$\ocwstring{"sphaa"}~$\mid{}~$\ocwstring{"smi"}~$\mid{}~$\ocwstring{"sra.ms"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"sva\~{}nj"}~$\mid{}~$\ocwstring{"haa\#2"}~$\mid{}~$\ocwstring{"hu.n.d"}~$\mid{}~$\ocwstring{"h.r\#2"}~$\mid{}~$\ocwstring{"hnu"}~$\mid{}~$\ocwstring{"hraad"}~$\mid{}~$\ocwstring{"hlaad"}~\ocweol
\ocwindent{0.00em}
\ocwbc{}| \ocwstring{"m.r"} Ubha needed for non present tenses - see \Pan{1,3,61} for exact rule \ocwec{}\ocweol
\ocwindent{1.50em}
\ocwbc{} DRP restriction: \ocwstring{"dyut\#1"} \ocwec{}~\ocweol
\ocwindent{3.00em}
$\rightarrow{}~\ocwupperid{Atma}~$\ocwbc{} middle only \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Ubha}~$\ocwbc{} default \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} Attested Ubha (over all ga.nas) : 
  \ocwbegindcode{}~\ocwstring{"a\~{}nc"}~$\mid{}~$\ocwstring{"arh"}~$\mid{}~$\ocwstring{"i"}~$\mid{}~$\ocwstring{"i.s\#1"}~$\mid{}~$\ocwstring{"uurj\#1"}~$\mid{}~$\ocwstring{"uuh"}~$\mid{}~$\ocwstring{".r"}~$\mid{}~$\ocwstring{".rj"}
~$\mid{}~$\ocwstring{"ka.n.d"}~$\mid{}~$\ocwstring{"kal"}~$\mid{}~$\ocwstring{"ka.s"}~$\mid{}~$\ocwstring{"ku.t.t"}~$\mid{}~$\ocwstring{"ku.n.d"}~$\mid{}~$\ocwstring{"k.r\#1"}~$\mid{}~$\ocwstring{"k.r\#2"}
~$\mid{}~$\ocwstring{"kram"}~$\mid{}~$\ocwstring{"krii"}~$\mid{}~$\ocwstring{"k.san"}~$\mid{}~$\ocwstring{"k.sap\#1"}~$\mid{}~$\ocwstring{"k.sal"}~$\mid{}~$\ocwstring{"k.sip"}~$\mid{}~$\ocwstring{"k.sud"}~$\mid{}~$\ocwstring{"khan"}~
~$\mid{}~$\ocwstring{"garh"}~$\mid{}~$\ocwstring{"guh"}~$\mid{}~$\ocwstring{"gras"}~$\mid{}~$\ocwstring{"gha.t.t"}~$\mid{}~$\ocwstring{"cat"}~$\mid{}~$\ocwstring{"carc"}~$\mid{}~$\ocwstring{"ci"}
~$\mid{}~$\ocwstring{"cint"}~$\mid{}~$\ocwstring{"cud"}~$\mid{}~$\ocwstring{"ce.s.t"}~$\mid{}~$\ocwstring{"cyu"}~$\mid{}~$\ocwstring{"chad\#1"}~$\mid{}~$\ocwstring{"chand"}~$\mid{}~$\ocwstring{"chid\#1"}~$\mid{}~$\ocwstring{"jan"}~
~$\mid{}~$\ocwstring{"juu"}~$\mid{}~$\ocwstring{"j\~{}naa\#1"}~$\mid{}~$\ocwstring{"jyaa\#1"}~$\mid{}~$\ocwstring{"jyut"}~$\mid{}~$\ocwstring{"ta.d"}~$\mid{}~$\ocwstring{"tan\#1"}~$\mid{}~$\ocwstring{"tan\#2"}~
~$\mid{}~$\ocwstring{"tud\#1"}~$\mid{}~$\ocwstring{"tul"}~$\mid{}~$\ocwstring{"t.rd"}~$\mid{}~$\ocwstring{"daaz\#1"}~$\mid{}~$\ocwstring{"diz\#1"}~$\mid{}~$\ocwstring{"dih"}~$\mid{}~$\ocwstring{"duh\#1"}
~$\mid{}~$\ocwstring{"dev\#1"}~$\mid{}~$\ocwstring{"draa\#2"}~$\mid{}~$\ocwstring{"dvi.s\#1"}~$\mid{}~$\ocwstring{"dhaa\#1"}~$\mid{}~$\ocwstring{"dhaav\#1"}~$\mid{}~$\ocwstring{"dhaav\#2"}~
~$\mid{}~$\ocwstring{"dhuu\#1"}~$\mid{}~$\ocwstring{"dh.r"}~$\mid{}~$\ocwstring{"dhva.ms"}~$\mid{}~$\ocwstring{"nah"}~$\mid{}~$\ocwstring{"naath"}~$\mid{}~$\ocwstring{"nij"}~$\mid{}~$\ocwstring{"nii\#1"}
~$\mid{}~$\ocwstring{"nud"}~$\mid{}~$\ocwstring{"pac"}~$\mid{}~$\ocwstring{"paz"}~$\mid{}~$\ocwstring{"pa.th"}~$\mid{}~$\ocwstring{"pii.d"}~$\mid{}~$\ocwstring{"pu.s\#1"}~$\mid{}~$\ocwstring{"puu\#1"}~$\mid{}~$\ocwstring{"puuj"}
~$\mid{}~$\ocwstring{"puuy"}~$\mid{}~$\ocwstring{"p.rth"}~$\mid{}~$\ocwstring{"prii"}~$\mid{}~$\ocwstring{"budh\#1"}~$\mid{}~$\ocwstring{"bruu"}~$\mid{}~$\ocwstring{"bhak.s"}~$\mid{}~$\ocwstring{"bhaj"}~$\mid{}~$\ocwstring{"bharts"}
~$\mid{}~$\ocwstring{"bhaas\#1"}~$\mid{}~$\ocwstring{"bhid\#1"}~$\mid{}~$\ocwstring{"bh.r"}~$\mid{}~$\ocwstring{"bh.rjj"}~$\mid{}~$\ocwstring{"maa\#4"}
~$\mid{}~$\ocwstring{"mi"}~$\mid{}~$\ocwstring{"mith"}~$\mid{}~$\ocwstring{"mil"}~$\mid{}~$\ocwstring{"mii"}~$\mid{}~$\ocwstring{"muc\#1"}~$\mid{}~$\ocwstring{"mud\#1"}~$\mid{}~$\ocwstring{"m.r"}~$\mid{}~$\ocwstring{"m.rj"}~
~$\mid{}~$\ocwstring{"m.rdh"}~$\mid{}~$\ocwstring{"m.r.s"}~$\mid{}~$\ocwstring{"yaj\#1"}~$\mid{}~$\ocwstring{"yaac"}~$\mid{}~$\ocwstring{"yu\#1"}~$\mid{}~$\ocwstring{"yuj\#1"}~$\mid{}~$\ocwstring{"rac"}~
~$\mid{}~$\ocwstring{"ra\~{}nj"}~$\mid{}~$\ocwstring{"ram"}~$\mid{}~$\ocwstring{"rah"}~$\mid{}~$\ocwstring{"raaj\#1"}~$\mid{}~$\ocwstring{"ri"}~$\mid{}~$\ocwstring{"ric"}~$\mid{}~$\ocwstring{"rud\#1"}~$\mid{}~$\ocwstring{"rudh\#2"}
~$\mid{}~$\ocwstring{"lafgh"}~$\mid{}~$\ocwstring{"labh"}~$\mid{}~$\ocwstring{"la.s"}~$\mid{}~$\ocwstring{"lip"}~$\mid{}~$\ocwstring{"lih\#1"}~$\mid{}~$\ocwstring{"lup"}~$\mid{}~$\ocwstring{"luu\#1"}~$\mid{}~$\ocwstring{"vad"}~
~$\mid{}~$\ocwstring{"vap\#1"}~$\mid{}~$\ocwstring{"vap\#2"}~$\mid{}~$\ocwstring{"val"}~$\mid{}~$\ocwstring{"vah\#1"}~$\mid{}~$\ocwstring{"vaa\#3"}~$\mid{}~$\ocwstring{"vic"}~$\mid{}~$\ocwstring{"vij"}~$\mid{}~$\ocwstring{"viij"}~
~$\mid{}~$\ocwstring{"v.r\#2"}~$\mid{}~$\ocwstring{"v.rt\#1"}~$\mid{}~$\ocwstring{"vyath"}~$\mid{}~$\ocwstring{"vyaa"}~$\mid{}~$\ocwstring{"zap"}~$\mid{}~$\ocwstring{"zaa"}~$\mid{}~$\ocwstring{"zubh\#1"}~
~$\mid{}~$\ocwstring{"zyaa"}~$\mid{}~$\ocwstring{"zri"}~$\mid{}~$\ocwstring{"san\#1"}~$\mid{}~$\ocwstring{"sah\#1"}~$\mid{}~$\ocwstring{"sic"}~$\mid{}~$\ocwstring{"su\#2"}~$\mid{}~$\ocwstring{"suud"}~$\mid{}~$\ocwstring{"stambh"}~
~$\mid{}~$\ocwstring{"stu"}~$\mid{}~$\ocwstring{"st.rr"}~$\mid{}~$\ocwstring{"sthaa\#1"}~$\mid{}~$\ocwstring{"sp.rz\#1"}~$\mid{}~$\ocwstring{"sp.rh"}~$\mid{}~$\ocwstring{"syand"}~$\mid{}~$\ocwstring{"svad"}~$\mid{}~$\ocwstring{"had"}~
~$\mid{}~$\ocwstring{"hikk"}~$\mid{}~$\ocwstring{"hu"}~$\mid{}~$\ocwstring{"huu"}~$\mid{}~$\ocwstring{"h.r\#1"}~\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} + corr. \ocwstring{"pa.th"} | \ocwstring{"sthaa\#1"} | \ocwstring{"praz"} | \ocwstring{"k.rr"} | \ocwstring{"p.rc"} | \ocwstring{"bandh"} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} NB. \ocwstring{"ah"} \ocwstring{"rip"} \ocwstring{"vadh"} have no pr, \ocwstring{"mand2"} is fictitious \ocwec{}~\ocweol
\ocwindent{1.00em}
\ocwbc{} \ocwstring{"iiz1"} and \ocwstring{"lii"} allowed Para in future \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} List of roots that admit different padas for distinct ganas:
as2 1U 4P \ocwbc{} 4P Vedic - may overgenerate ? \ocwec{}
i 1A 2P 4A 5P
.r 1U 3P 5P
kuc 1U 6P
k.r.s 1P 6U
ghuur.n 1A 6P
jan 4A 1U
j.rr 1U 4P
jyaa1 4A 9P
.damb 1A 10P (vi-)
tap 1P 4A
daa1 2P 1U 3U
draa2 2P 4U
dh.r.s 1U 5P
nij 2A 3U
pu.s1 4U 9P
budh1 1P 4A
bhra.mz 1A 4P
man 1U 4U 8A
maa1 3A 2P
mid 1A 4P 1OP
mii 9P 4A
m.r 4A other tenses P
m.rj 1U 2P 6U
m.rd1 9P 1U
ri 4A 9U
ric 4A 7P
rud1 2P 1U 6U
van 1P 8U
vid2 2A 6U 7A
v.r1 1P 5U
zaa 3U 4P
su2 1P 2P 5U 
suu1 1P 6P 2A
stambh 1U 5P 9P
svid2 1A 4P
\ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwbc{} More precise selection for present system \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{voices\_of\_gana}~\ocwlowerid{g}~\ocwlowerid{root}~=~$\ocwkw{match}~$\ocwlowerid{g}~$\ocwkw{with}\ocweol
\ocwindent{0.50em}
$[~1~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{".r"}~$\mid{}~$\ocwstring{"k.r.s"}~$\mid{}~$\ocwstring{"cur"}~$\mid{}~$\ocwstring{"tap"}~$\mid{}~$\ocwstring{"budh\#1"}~$\mid{}~$\ocwstring{"van"}~$\mid{}~$\ocwstring{"v.r\#1"}~$\mid{}~$\ocwstring{"su\#2"}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"suu\#1"}~\ocweol
\ocwindent{6.00em}
$\rightarrow{}~\ocwupperid{Para}~$\ocwbc{} but \ocwstring{".r"} Atma for pv sam \Pan{1,3,29} \ocwec{}~\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"i"}~$\mid{}~$\ocwstring{"gha.t.t"}~$\mid{}~$\ocwstring{"ghuur.n"}~$\mid{}~$\ocwstring{".damb"}~$\mid{}~$\ocwstring{"bhra.mz"}~$\mid{}~$\ocwstring{"mid"}~$\mid{}~$\ocwstring{"mok.s"}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"lok"}~$\mid{}~$\ocwstring{"svid\#2"}~\ocweol
\ocwindent{6.00em}
$\rightarrow{}~\ocwupperid{Atma}$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"i.s\#1"}~$\mid{}~$\ocwstring{"j.rr"}~$\mid{}~$\ocwstring{"daa\#1"}~$\mid{}~$\ocwstring{"dh.r.s"}~$\mid{}~$\ocwstring{"as\#2"}~$\mid{}~$\ocwstring{"kuc"}~\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"m.rj"}~$\mid{}~$\ocwstring{"m.rd\#1"}~$\mid{}~$\ocwstring{"rud\#1"}~$\mid{}~$\ocwstring{"stambh"}~\ocweol
\ocwindent{6.00em}
$\rightarrow{}~\ocwupperid{Ubha}$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"kliiba"}~$\rightarrow{}~\ocwupperid{Atma}~$\ocwbc{} denominative verb \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{voices\_of}~\ocwlowerid{root}~$\ocwbc{} man U (epic P) \ocwec{}\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{0.50em}
$\mid{}~2~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~$\ocwstring{"daa\#1"}~$\mid{}~$\ocwstring{"dyaa"}~$\mid{}~$\ocwstring{"draa\#2"}~$\mid{}~$\ocwstring{"maa\#1"}~$\mid{}~$\ocwstring{"m.rj"}~$\mid{}~$\ocwstring{"rud\#1"}~$\mid{}~$\ocwstring{"su\#2"}\ocweol
\ocwindent{6.00em}
$\rightarrow{}~\ocwupperid{Para}$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"nij"}~$\mid{}~$\ocwstring{"vid\#2"}~$\mid{}~$\ocwstring{"suu\#1"}~$\rightarrow{}~\ocwupperid{Atma}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{voices\_of}~\ocwlowerid{root}~$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{0.50em}
$\mid{}~3~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{".r"}~$\rightarrow{}~\ocwupperid{Para}$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"maa\#1"}~$\rightarrow{}~\ocwupperid{Atma}$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"daa\#1"}~$\mid{}~$\ocwstring{"nij"}~$\rightarrow{}~\ocwupperid{Ubha}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{voices\_of}~\ocwlowerid{root}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{0.50em}
$\mid{}~4~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"as\#2"}~$\mid{}~$\ocwstring{"j.rr"}~$\mid{}~$\ocwstring{"bhra.mz"}~$\mid{}~$\ocwstring{"mid"}~$\mid{}~$\ocwstring{"zaa"}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"svid\#2"}~$\rightarrow{}~\ocwupperid{Para}$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"i"}~$\mid{}~$\ocwstring{"jan"}~$\mid{}~$\ocwstring{"jyaa\#1"}~$\mid{}~$\ocwstring{"tap"}~$\mid{}~$\ocwstring{"draa\#2"}~$\mid{}~$\ocwstring{"budh\#1"}~$\mid{}~$\ocwstring{"mii"}~$\mid{}~$\ocwstring{"ri"}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"ric"}~$\mid{}~$\ocwstring{"m.r"}~$\rightarrow{}~\ocwupperid{Atma}~$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"pu.s\#1"}~\ocwbc{} | \ocwstring{"raadh"} Bergaigne vedic \ocwec{}~$\rightarrow{}~\ocwupperid{Ubha}~$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{voices\_of}~\ocwlowerid{root}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{0.50em}
$\mid{}~5~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"i"}~$\mid{}~$\ocwstring{".r"}~$\mid{}~$\ocwstring{"dh.r.s"}~$\mid{}~$\ocwstring{"raadh"}~$\mid{}~$\ocwstring{"stambh"}~$\rightarrow{}~\ocwupperid{Para}$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"v.r\#1"}~$\mid{}~$\ocwstring{"su\#2"}~$\rightarrow{}~\ocwupperid{Ubha}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{voices\_of}~\ocwlowerid{root}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{0.50em}
$\mid{}~6~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"kuc"}~$\mid{}~$\ocwstring{"ghuur.n"}~$\mid{}~$\ocwstring{"suu\#1"}~$\rightarrow{}~\ocwupperid{Para}$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"k.r.s"}~$\mid{}~$\ocwstring{"m.rj"}~$\mid{}~$\ocwstring{"rud\#1"}~$\mid{}~$\ocwstring{"vid\#2"}~$\rightarrow{}~\ocwupperid{Ubha}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{voices\_of}~\ocwlowerid{root}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{0.50em}
$\mid{}~7~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"vid\#2"}~$\rightarrow{}~\ocwupperid{Atma}$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"ric"}~$\rightarrow{}~\ocwupperid{Para}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{voices\_of}~\ocwlowerid{root}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{0.50em}
$\mid{}~8~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"man"}~$\rightarrow{}~\ocwupperid{Atma}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{voices\_of}~\ocwlowerid{root}~$\ocwbc{} van Ubha \ocwec{}\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{0.50em}
$\mid{}~9~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"jyaa\#1"}~$\mid{}~$\ocwstring{"pu.s\#1"}~$\mid{}~$\ocwstring{"mii"}~$\mid{}~$\ocwstring{"m.rd\#1"}~$\mid{}~$\ocwstring{"ri"}~$\rightarrow{}~\ocwupperid{Para}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{voices\_of}~\ocwlowerid{root}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{0.50em}
$\mid{}~10~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"gha.t.t"}~$\mid{}~$\ocwstring{".damb"}~$\mid{}~$\ocwstring{"mid"}~$\mid{}~$\ocwstring{"mok.s"}~$\mid{}~$\ocwstring{"lak.s"}~$\mid{}~$\ocwstring{"lok"}~$\mid{}~$\ocwstring{"stambh"}\ocweol
\ocwindent{6.00em}
$\rightarrow{}~\ocwupperid{Para}$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"arth"}~$\rightarrow{}~\ocwupperid{Atma}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{voices\_of}~\ocwlowerid{root}~$\ocwbc{} other denominatives will take Ubha as default \ocwec{}\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{voices\_of}~\ocwlowerid{root}~$\ocweol
\ocwindent{0.50em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Refining with potential preverb 
\ocweol
\label{pada.ml:11051}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{voices\_of\_pv}~\ocwlowerid{upasarga}~\ocwlowerid{gana}~=~$\ocwkw{fun}~\ocwbc{} gana only used for \ocwstring{"tap"} \ocwstring{"i"} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Paninian requirements \ocwec{}\ocweol
\ocwindent{0.00em}
$[~$\ocwstring{"zru"}~$\mid{}~$\ocwstring{".r"}~$\mid{}~$\ocwstring{"gam"}~$\mid{}~$\ocwstring{"svar"}~$\mid{}~$\ocwstring{"vid\#1"}~\ocwbc{} | \ocwstring{"praz"} \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{6.50em}
\ocwkw{if}~$\ocwlowerid{upasarga}~=~$\ocwstring{"sam"}~\ocwkw{then}~$\ocwupperid{Ubha}~$\ocwkw{else}~$\ocwupperid{Para}~$\ocwbc{} \Pan{1,3,29} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwstring{"praz"} used in Atma with aa- but also without pv in epics (MW) \ocwec{}\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"car"}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{upasarga}~=~$\ocwstring{"sam"}~\ocwkw{then}~$\ocwupperid{Ubha}~$\ocwkw{else}~$\ocwupperid{Para}~$\ocwbc{} \Pan{1,3,54} \ocwec{}\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"viz\#1"}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{upasarga}~=~$\ocwstring{"ni"}~\ocwkw{then}~$\ocwupperid{Atma}~$\ocwkw{else}~$\ocwupperid{Para}~$\ocwbc{} \Pan{1,3,17} \ocwec{}\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"huu"}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{upasarga}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~$\ocwstring{"ni"}~$\mid{}~$\ocwstring{"sam"}~$\mid{}~$\ocwstring{"upa"}~$\mid{}~$\ocwstring{"vi"}~$\rightarrow{}~\ocwupperid{Atma}~$\ocwbc{} \Pan{1,3,30} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"aa"}~$\rightarrow{}~\ocwupperid{Ubha}~$\ocwbc{} \Pan{1,3,31} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Para}$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"yam"}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{upasarga}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~$\ocwstring{"aa"}~$\mid{}~$\ocwstring{"upa"}~$\rightarrow{}~\ocwupperid{Ubha}~$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Para}~$\ocwbc{} \Pan{1,3,28} and \Pan{1,3,56} \ocwec{}\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"vah\#1"}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{upasarga}~=~$\ocwstring{"pra"}~\ocwkw{then}~$\ocwupperid{Para}~$\ocwkw{else}~$\ocwupperid{Ubha}~$\ocwbc{} \Pan{1,3,81} \ocwec{}\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"vad"}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{upasarga}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~$\ocwstring{"anu"}~$\rightarrow{}~\ocwupperid{Ubha}~$\ocwbc{} \Pan{1,3,49} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"apa"}~$\rightarrow{}~\ocwupperid{Atma}~$\ocwbc{} \Pan{1,3,73} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Para}$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"g.rr\#1"}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{upasarga}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~$\ocwstring{"ava"}~$\rightarrow{}~\ocwupperid{Atma}~$\ocwbc{} \Pan{1,3,51} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"sam"}~$\rightarrow{}~\ocwupperid{Ubha}~$\ocwbc{} \Pan{1,3,52} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Para}$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"ji"}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{upasarga}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~$\ocwstring{"vi"}~$\mid{}~$\ocwstring{"paraa"}~$\rightarrow{}~\ocwupperid{Atma}~$\ocwbc{} \Pan{1,3,19} \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Ubha}~$\ocwbc{} was Para but \ocwstring{"satyam\ocwvspace{}eva\ocwvspace{}jayate"} \ocwec{}~\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"krii.d"}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{upasarga}~$\ocwkw{with}\ocweol
\ocwindent{7.00em}
$[~$\ocwstring{"aa"}~$\mid{}~$\ocwstring{"anu"}~$\mid{}~$\ocwstring{"pari"}~$\rightarrow{}~\ocwupperid{Atma}~$\ocwbc{} \Pan{1,3,21} \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"sam"}~$\rightarrow{}~\ocwupperid{Ubha}~$\ocwbc{} \Pan{1,3,21} vaartikaa \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Para}$\ocweol
\ocwindent{7.00em}
$]$\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"m.rz"}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{upasarga}~=~$\ocwstring{"pari"}~\ocwkw{then}~$\ocwupperid{Para}~$\ocwkw{else}~$\ocwupperid{Ubha}~$\ocwbc{} \Pan{1,3,82} \ocwec{}\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"tap"}~\ocwkw{when}~$\ocwlowerid{gana}~=~1~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{upasarga}~$\ocwkw{with}\ocweol
\ocwindent{12.50em}
$[~$\ocwstring{"ut"}~$\mid{}~$\ocwstring{"vi"}~$\rightarrow{}~\ocwupperid{Ubha}~$\ocweol
\ocwindent{12.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Para}~$\ocwbc{} \Pan{1,3,27} \ocwec{}\ocweol
\ocwindent{12.50em}
$]$\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"i"}~\ocwkw{when}~$\ocwlowerid{gana}~=~2~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{upasarga}~$\ocwkw{with}\ocweol
\ocwindent{11.50em}
$[~$\ocwstring{"adhi"}~$\rightarrow{}~\ocwupperid{Ubha}~$\ocweol
\ocwindent{11.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Para}~$\ocweol
\ocwindent{11.50em}
$]$\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"zii\#1"}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{upasarga}~=~$\ocwstring{"sam"}~\ocwkw{then}~$\ocwupperid{Ubha}~$\ocwkw{else}~$\ocwupperid{Atma}$\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"krii"}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{upasarga}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~$\ocwstring{"vi"}~$\mid{}~$\ocwstring{"pari"}~$\mid{}~$\ocwstring{"ava"}~$\rightarrow{}~\ocwupperid{Atma}~$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Para}~$\ocwbc{} \Pan{1,3,18} \ocwec{}\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwbc{} Next three equivalent to marking \ocwstring{"unused"} in lexicon \ocwec{}\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"ta\~{}nc"}~$\mid{}~$\ocwstring{"saa\#1"}~$\mid{}~$\ocwstring{"zal"}~\ocwbc{} also \ocwstring{"khyaa"} ? \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{upasarga}~$\ocwkw{with}~\ocweol
\ocwindent{1.50em}
$[~$\ocwstring{""}~$\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Unattested}$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Para}$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"loc"}~$\mid{}~$\ocwstring{"zrambh"}~$\mid{}~$\ocwstring{"hnu"}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{upasarga}~$\ocwkw{with}~\ocweol
\ocwindent{1.50em}
$[~$\ocwstring{""}~$\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Unattested}$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Atma}$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{".damb"}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{upasarga}~$\ocwkw{with}~\ocweol
\ocwindent{1.50em}
$[~$\ocwstring{"vi"}~$\rightarrow{}~\ocwupperid{Ubha}$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Unattested}$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwbc{} Usage, MW \ocwec{}\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"gha.t.t"}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{gana}~=~1~$\ocwkw{then}~\ocweol
\ocwindent{9.00em}
\ocwkw{if}~$\ocwlowerid{upasarga}~=~$\ocwstring{""}~\ocwkw{then}~$\ocwlowerid{raise}~\ocwupperid{Unattested}$\ocweol
\ocwindent{9.00em}
\ocwkw{else}~$\ocwupperid{Atma}~$\ocwbc{} only \ocwstring{"vi"} | \ocwstring{"sam"}, NOT \ocwstring{""} \ocwec{}\ocweol
\ocwindent{7.50em}
\ocwkw{else}~\ocwbc{} gana = 10 \ocwec{}~$\ocwupperid{Para}~$\ocweol
\ocwindent{0.00em}
$\mid{}~$\ocwstring{"i.s\#1"}~\ocwkw{when}~$\ocwlowerid{gana}~=~1~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{upasarga}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~$\ocwstring{""}~$\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Unattested}$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Ubha}$\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{0.00em}
$\mid{}~\ocwlowerid{root}~\rightarrow{}~\ocwlowerid{voices\_of\_gana}~\ocwlowerid{gana}~\ocwlowerid{root}$\ocweol
\ocwindent{0.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Nouns.mli}
\ocwinterface{Nouns}
\label{nouns.mli:0}%
\label{nouns.mli:647}%
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{inflected\_map}$\ocwenddcode{} \ocwec{}\medskip

\label{nouns.mli:703}%
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{declension\_class}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Gender}~$\ocwkw{of}~$\ocwlowerid{gender}~$\ocwbc{} declined substantive, adjective, number, pronoun \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind}~$\ocwkw{of}~$\ocwlowerid{ind\_kind}~$\ocwbc{} indeclinable form \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{nmorph}~=~($\ocwbt{string}~$\times{}~\ocwlowerid{declension\_class})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Report}~$\ocwkw{of}~\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_decls}~:~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~$\ocwbt{list}~$\ocwlowerid{nmorph}~\rightarrow{}~$\ocwbt{unit};~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_extra\_iic}~:~$\ocwbt{list}~\ocwbt{string}~$\rightarrow{}~$\ocwbt{unit};\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_extra}~:~$\ocwbt{list}~\ocwbt{string}~$\rightarrow{}~$\ocwbt{unit};\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enter\_extra\_ifcs}~:~$\ocwbt{unit}~$\rightarrow{}~$\ocwbt{unit};~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enter\_extra\_iifcs}~:~$\ocwbt{unit}~$\rightarrow{}~$\ocwbt{unit};~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fake\_compute\_decls}~:~$\ocweol
\ocwindent{2.50em}
$\ocwlowerid{nmorph}~\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~(~\ocwlowerid{inflected\_map}~$\ocwbc{} nouns \ocwec{}\ocweol
\ocwindent{12.50em}
$\times{}~\ocwlowerid{inflected\_map}~$\ocwbc{} pronouns \ocwec{}\ocweol
\ocwindent{12.50em}
$\times{}~\ocwlowerid{inflected\_map}~$\ocwbc{} vocas \ocwec{}\ocweol
\ocwindent{12.50em}
$\times{}~\ocwlowerid{inflected\_map}~$\ocwbc{} iics \ocwec{}\ocweol
\ocwindent{12.50em}
$\times{}~\ocwlowerid{inflected\_map}~);~$\ocwbc{} adverbs ifcs \ocwec{}\medskip

\label{nouns.mli:1473}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{extract\_current\_cache}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{inflected\_map};~$\ocwbc{} used in Interface \ocwec{}\ocweol
\ocwendcode{}\typeout{OcamlWeb file Nouns.ml}
\ocwmodule{Nouns}
\label{nouns.ml:0}%
Computes the declensions of substantives, adjectives, pronouns, numerals
   and records the nominal inflected forms in databases by \ocwbegindcode{}$\ocwupperid{Inflected}.\ocwlowerid{enter}$\ocwenddcode{}. 
   It is called from \ocwbegindcode{}$\ocwupperid{Make\_nouns}$\ocwenddcode{} nominal generation process. 
\ocweol
\label{nouns.ml:871}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{List};~$\ocwbc{} exists, iter \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Word};~$\ocwbc{} mirror \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phonetics};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{finalize},~\ocwlowerid{finalize\_r}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Inflected};~$\ocwbc{} \ocwbegindcode{}$\ocwupperid{Declined},~\ocwupperid{Bare},~\ocwupperid{Cvi},~\ocwlowerid{enter},~\ocwlowerid{enter1},~\ocwlowerid{morpho\_gen},
\ocwlowerid{reset\_nominal\_databases},~\ocwlowerid{nominal\_databases}$\ocwenddcode{} \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
*** Error handling ***
\ocweol
\label{nouns.ml:1129}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Report}~$\ocwkw{of}~\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{report}~\ocwlowerid{revstem}~\ocwlowerid{gen}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwupperid{Canon.}\ocwlowerid{rdecode}~\ocwlowerid{revstem}$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{gender}~=~$\ocwkw{match}~$\ocwlowerid{gen}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Mas}~\rightarrow{}~$\ocwstring{"M"}~$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"N"}~$\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"F"}~$\mid{}~\ocwupperid{Deictic}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"*"}~$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{message}~=~\ocwlowerid{stem}~$\^{}~\ocwstring{"\ocwvspace{}missing\ocwvspace{}gender\ocwvspace{}"}~\^{}~$\ocwlowerid{gender}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{raise}~(\ocwupperid{Report}~\ocwlowerid{message})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{warn}~\ocwlowerid{revstem}~\ocwlowerid{str}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~(\ocwlowerid{mirror}~\ocwlowerid{revstem})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{message}~=~\ocwlowerid{stem}~$\^{}~\ocwstring{"\ocwvspace{}is\ocwvspace{}declined\ocwvspace{}as\ocwvspace{}"}~\^{}~$\ocwlowerid{str}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{raise}~(\ocwupperid{Report}~\ocwlowerid{message})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_report}~\ocwlowerid{s}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{output\_string}~\ocwlowerid{stderr}~(\ocwlowerid{s}~$\^{}~\ocwstring{"\symbol{92}n"}$)$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Word encodings of strings 
\ocweol
\label{nouns.ml:1645}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{code}~=~\ocwupperid{Encode.}\ocwlowerid{code\_string}~$\ocwbc{} normalized \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{revcode}~=~\ocwupperid{Encode.}\ocwlowerid{rev\_code\_string}~$\ocwbc{} reversed (mirror o code) \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{revstem}~=~\ocwupperid{Encode.}\ocwlowerid{rev\_stem}~$\ocwbc{} stripped of homo counter \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{normal\_stem}~=~\ocwupperid{Encode.}\ocwlowerid{normal\_stem}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} declension generators \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{declension\_class}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Gender}~$\ocwkw{of}~$\ocwlowerid{gender}~$\ocwbc{} declined substantive, adjective, number, pronoun \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind}~$\ocwkw{of}~$\ocwlowerid{ind\_kind}~$\ocwbc{} Indeclinable form \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{nmorph}~=~($\ocwbt{string}~$\times{}~\ocwlowerid{declension\_class})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Affix a suffix string to a stem word using internal sandhi \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{fix}:~\ocwupperid{Word}.\ocwlowerid{word}~\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~\ocwupperid{Word}.\ocwlowerid{word}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fix}~\ocwlowerid{rstem}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{1.00em}
$\ocwupperid{Int\_sandhi.}\ocwlowerid{int\_sandhi}~\ocwlowerid{rstem}~(\ocwlowerid{code}~\ocwlowerid{suff})~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} raw affixing for \ocwbegindcode{}$\ocwlowerid{build\_han}$\ocwenddcode{} Whitney§195a \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fixno}~\ocwlowerid{rstem}~\ocwlowerid{suff}~=~\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{rstem}~(\ocwlowerid{code}~\ocwlowerid{suff})~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{wrap}~\ocwlowerid{rstem}~\ocwlowerid{c}~=~\ocwlowerid{mirror}~[~\ocwlowerid{c}~::~\ocwlowerid{rstem}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} monosyllabic stems, for feminine in ii or uu \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} NB - condition not preserved by prefixing and compounding.
   See Whitney§352 for differing opinions of grammarians \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{monosyl}~=~\ocwupperid{Phonetics.}\ocwlowerid{all\_consonants}~$\ocwbc{} Z NOT Phonetics monosyllabic \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} An attempt at treating a few compounds of monosyllabic in -ii    \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} This question is not clear at all, cf. mail by Malhar Kulkarni   \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} eg loc sg fem abhii = abhiyi (Zukla) or abhyaam (Malhar) ?       \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Malhar actually says: 3 forms abhyi according to commentators    \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} if consonant clutter before ii or uu, then not nadii \Pan{1.4.4} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} This is dubious, see -vii lower \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} See Kale §76 §77 \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compound\_monosyl\_ii}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~40~::~\ocwlowerid{l}~]~$\ocwbc{} -bhii \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{l}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[~1~]~\mid{}~[~1;~37;~1~]~\rightarrow{}~\ocwupperid{True}~$\ocwbc{} abhii apabhii \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~35~::~\ocwlowerid{l}~]~$\ocwbc{} -dhii \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{l}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~1;~37;~44;~1~]~\mid{}~[~2;~33;~32;~3~]~\mid{}~[~5;~17~]~\mid{}~[~43;~5;~34~]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~5;~48~]~\rightarrow{}~\ocwupperid{True}~$\ocwbc{} alpa- itthaa- ku- dur- su- \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~43~::~[~37~::~\ocwlowerid{l}~]~]~$\ocwbc{} -prii \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{l}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~2~]~$\ocwbc{} aaprii \ocwec{}~$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~43~::~[~46~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -zrii \ocwec{}~$\rightarrow{}~\ocwupperid{True}~$\ocwbc{} ma~njuzrii \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}| \ocwbegindcode{}~31~::~$\ocwlowerid{l}~$\ocwenddcode{} \ocwbc{} -.nii for -nii \ocwec{} -> match l with
      \ocwbegindcode{}~[~1;~41;~2;~43;~19~]~$(\times{}~\ocwlowerid{graama}-~\times{})~\rightarrow{}~\ocwupperid{True}~(\times{}~\ocwlowerid{wrong}~-~\symbol{92}\ocwupperid{Pan}\{6,4,82\}~\times{})
~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~
~$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~36~::~\ocwlowerid{l}~]~$\ocwbc{} -nii \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{l}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~2;~36;~10;~48~]~$\ocwbc{} senaa- \ocwec{}~$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwbc{}| \ocwbegindcode{}~45~::~$\ocwlowerid{l}~$\ocwenddcode{} \ocwbc{} -vii \ocwec{} -> match l with \ocwbc{} wrong: padaviim \ocwec{}
      \ocwbegindcode{}~[~1;~34;~1;~37~]~$\rightarrow{}~\ocwupperid{True}~(\times{}~\ocwlowerid{pada}-~\times{})
~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~
~$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~$\ocwbc{} to be completed for other roots \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Similarly for -uu roots \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compound\_monosyl\_uu}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~40~::~\ocwlowerid{\_}~]~$\ocwbc{} -bhuu \ocwec{}~$\rightarrow{}~\ocwupperid{True}~$\ocwbc{} abhiibhuu (may be too wide) \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~[~48~::~\ocwlowerid{\_}~]~$\ocwbc{} -suu \ocwec{}~$\rightarrow{}~\ocwupperid{True}~$\ocwbc{} prasuu  (may be too wide) \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~$\ocwbc{} to be completed for other roots \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Stems with possible pronominal declension 
\ocweol
\label{nouns.ml:4425}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pronominal\_usage}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"prathama"}~$\mid{}~$\ocwstring{"dvitaya"}~$\mid{}~$\ocwstring{"t.rtiiya"}~$\mid{}~$\ocwstring{"apara"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"alpa"}~$\mid{}~$\ocwstring{"ardha"}~$\mid{}~$\ocwstring{"kevala"}~$\mid{}~$\ocwstring{"baahya"}~$\rightarrow{}~\ocwupperid{True}~$\ocwbc{} Whitney§526 \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} The following restrict the generative capacity of certain entries,
   in order to reduce overgeneration. 
   Such information should ultimately be lexicalized \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Masculine a-entries may be all used as iiv (inchoative cvi suffix) 
\ocweol
\ocwindent{0.00em}
NB pronouns "eka" and "sva" produces cvi form in \ocwbegindcode{}$\ocwlowerid{build\_pron\_a}$\ocwenddcode{} 
\ocweol
\ocwindent{0.00em}
idem for masculines in -i and -in 
\ocweol
\ocwindent{0.00em}
Now for neuter stems 
\ocweol
\label{nouns.ml:4973}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{a\_n\_iiv}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"aaspada"}~$\mid{}~$\ocwstring{"kara.na"}~$\mid{}~$\ocwstring{"t.r.na"}~$\mid{}~$\ocwstring{"nimitta"}~$\mid{}~$\ocwstring{"paatra"}~$\mid{}~$\ocwstring{"pi\~{}njara"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"pratibimba"}~$\mid{}~$\ocwstring{"pratyak.sa"}~$\mid{}~$\ocwstring{"pramaa.na"}~$\mid{}~$\ocwstring{"prahara.na"}~$\mid{}~$\ocwstring{"yuddha"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"vahana"}~$\mid{}~$\ocwstring{"vize.sa.na"}~$\mid{}~$\ocwstring{"vi.sa"}~$\mid{}~$\ocwstring{"vyajana"}~$\mid{}~$\ocwstring{"zayana"}~$\mid{}~$\ocwstring{"zo.na"}~$\mid{}~$\ocwstring{"sukha"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwbc{} NavyaNyaaya \ocwec{}~\ocwstring{"adhikara.na"}~$\mid{}~$\ocwstring{"kaara.na"}~$\mid{}~$\ocwstring{"saadhana"}\ocweol
\ocwindent{2.00em}
\ocwbc{} missing compound: \ocwstring{"si.mhavyaaghraami.sa"} \ocwec{}\ocweol
\ocwindent{3.00em}
$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{man\_iiv}~=~$\ocwkw{fun}~\ocwbc{} sn \ocwec{}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"karman"}~$\mid{}~$\ocwstring{"bhasman"}~\ocweol
\ocwindent{3.00em}
$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{as\_iiv}~=~$\ocwkw{fun}~\ocwbc{} sn \ocwec{}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"unmanas"}~$\mid{}~$\ocwstring{"uras"}~$\mid{}~$\ocwstring{"cetas"}~$\mid{}~$\ocwstring{"manas"}~$\mid{}~$\ocwstring{"rajas"}~$\mid{}~$\ocwstring{"rahas"}~\ocweol
\ocwindent{3.00em}
$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{aa\_iiv}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"kathaa"}$\rightarrow{}~\ocwupperid{True}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwbc{} NB \ocwbegindcode{}$\ocwlowerid{aa\_iic}$\ocwenddcode{} obsolete, now use separate entry femcf marked fstem \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{}***********************************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}************ Paradigms ************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}***********************************\ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
For use in mono-entries paradigms 
\ocweol
\label{nouns.ml:5872}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{register}~\ocwlowerid{case}~\ocwlowerid{form}~=~(\ocwlowerid{case},\ocwlowerid{code}~\ocwlowerid{form})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_a}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}~$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"ubha"}~\ocwbc{} dual only \ocwec{}\ocweol
\ocwindent{7.50em}
$\lor{}~\ocwlowerid{entry}~=~$\ocwstring{"g.rha"}~\ocwbc{} plural only \ocwec{}\ocweol
\ocwindent{7.50em}
$\lor{}~\ocwlowerid{entry}~=~$\ocwstring{"daara"}~\ocwkw{then}~$[\,]~$\ocwkw{else}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ena"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aaya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"asya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"e"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"g.rha"}~\ocweol
\ocwindent{6.00em}
$\lor{}~\ocwlowerid{entry}~=~$\ocwstring{"daara"}~\ocwkw{then}~$[\,]~$\ocwkw{else}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"ubha"}~\ocwkw{then}~$[\,]~$\ocwkw{else}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ais"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aanaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"esu"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{pronominal\_usage}~\ocwlowerid{entry}~$\ocwkw{then}~$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"e"}~::~$\ocwlowerid{l}~]~$\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~1)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"am"}$);~\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"aat"}$)~$\ocwbc{} avyayiibhaava \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"atas"}$)~$\ocwbc{} tasil productive \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Cvi}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~4)~$\ocwbc{} cvi now productive for masculine stems in -a \ocwec{}\ocweol
\ocwindent{1.50em}
$])~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_i}~\ocwlowerid{stem}~\ocwlowerid{trunc}~\ocwlowerid{entry}~=~$\ocwbc{} declension of \ocwstring{"ghi"} class \ocwec{}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{declines}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declineg}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~[~10~::~\ocwlowerid{trunc}~]~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinel}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~[~4~::~\ocwlowerid{trunc}~]~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinau}~\ocwlowerid{case}~=~(\ocwlowerid{case},\ocwlowerid{wrap}~\ocwlowerid{trunc}~13)~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declineg}~\ocwupperid{Voc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Nom}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Acc}~$\ocwstring{"m"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"naa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineg}~\ocwupperid{Dat}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineg}~\ocwupperid{Abl}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineg}~\ocwupperid{Gen}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinau}~\ocwupperid{Loc}~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinel}~\ocwupperid{Voc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Nom}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Acc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"bhyaam"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declineg}~\ocwupperid{Voc}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineg}~\ocwupperid{Nom}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Acc}~$\ocwstring{"n"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"bhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Gen}~$\ocwstring{"naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~\ocwlowerid{stem})$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{mirror}~\ocwlowerid{stem})$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"tas"}$)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Cvi}~(\ocwlowerid{wrap}~\ocwlowerid{trunc}~4)~$\ocwbc{} \ocwstring{"aadhi1"} \ocwstring{"pratinidhi"} \ocwec{}\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_sakhi}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{sakhi}~=~$\ocwbc{} Whitney§343a \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}~$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aayam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"yaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ye"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"yus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"yus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"yau"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aayau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aayaa"}~\ocwbc{} ved. Whitney§343b \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aayau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aayau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"yos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"yos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aayas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aayas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iin"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ibhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iinaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"isu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~3)$\ocweol
\ocwindent{0.00em}
\ocwbc{} ; Cvi (wrap stem 4) \ocwec{}\ocweol
\ocwindent{1.50em}
$]~@~($\ocwkw{if}~$\ocwlowerid{sakhi}~$\ocwkw{then}~$[~\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~1)~]~$\ocwbc{} sakha \ocwec{}~\ocwkw{else}~$[\,]))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_u}~\ocwlowerid{stem}~\ocwlowerid{trunc}~\ocwlowerid{entry}~=~$\ocwbc{} similar to \ocwbegindcode{}$\ocwlowerid{build\_mas\_i}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{declines}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declineg}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~[~12~::~\ocwlowerid{trunc}~]~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinel}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~[~6~::~\ocwlowerid{trunc}~]~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinau}~\ocwlowerid{case}~=~(\ocwlowerid{case},\ocwlowerid{wrap}~\ocwlowerid{trunc}~13)~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declineg}~\ocwupperid{Voc}~$\ocwstring{""}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Nom}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Acc}~$\ocwstring{"m"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"naa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineg}~\ocwupperid{Dat}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineg}~\ocwupperid{Abl}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineg}~\ocwupperid{Gen}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinau}~\ocwupperid{Loc}~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinel}~\ocwupperid{Voc}~$\ocwstring{""}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Nom}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Acc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"os"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
$])~$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declineg}~\ocwupperid{Voc}~$\ocwstring{"as"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineg}~\ocwupperid{Nom}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Acc}~$\ocwstring{"n"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"bhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Gen}~$\ocwstring{"naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~\ocwlowerid{stem})$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Cvi}~(\ocwlowerid{wrap}~\ocwlowerid{trunc}~6)~$\ocwbc{} .rju maru m.rdu laghu \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{mirror}~\ocwlowerid{stem})$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"tas"}$)$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_ri\_v}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} vriddhi in strong cases \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bare}~=~\ocwlowerid{wrap}~\ocwlowerid{stem}~7~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ar"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aaram"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"raa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"re"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ari"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aarau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aarau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aarau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{".rbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{".rbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{".rbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ros"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ros"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aaras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aaras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{".rrn"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{".rbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{".rbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{".rbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{".rr.naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{".r.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} kro.s.t.r irregular with stem krostu Muller§236 \Pan{7,1,95-97} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_krostu}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bare}~=~\ocwlowerid{wrap}~\ocwlowerid{stem}~5~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"o"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aaram"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"unaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"raa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ave"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"re"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"or"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"or"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ari"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aarau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aarau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aarau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"vos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ros"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"vos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ros"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aaras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aaras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uun"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ubhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ubhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ubhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uunaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"u.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_ri\_g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} parenté avec gu.na \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bare}~=~\ocwlowerid{wrap}~\ocwlowerid{stem}~7~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ar"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aram"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"raa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"re"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ari"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"arau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"arau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"arau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{".rbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{".rbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{".rbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ros"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ros"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{".rrn"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aras"}~\ocwbc{} epics Whitney§373c \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{".rbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{".rbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{".rbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{".rr.naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{".r.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~2)~$\ocwbc{} for dvandva eg ved hotaapotarau \Pan{6,3,47} \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_nri}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} currently disabled by skip in Dico \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bare}~=~\ocwlowerid{wrap}~\ocwlowerid{stem}~7~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa"}~$])~$\ocwbc{} other cases from nara \ocwec{}\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aarau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aarau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aarau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{".rbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{".rbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{".rbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ros"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ros"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aaras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aaras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{".rrn"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{".rbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{".rbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{".rbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{".rr.naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{".r.naam"}~\ocwbc{} Veda, but .r metrically long \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{".r.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~2)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{bare}~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_red}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"taa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"te"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ti"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"tau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"tau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"tau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"dbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"dbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"dbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"dbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"dbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"dbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"tas"}$)$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_at}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"n"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"n"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ntam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"taa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"te"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ti"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ntau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ntau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ntau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"dbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"dbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"dbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ntas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ntas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"dbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"dbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"dbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~32)~$\ocwbc{} at - e.g. b.rhadazva \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"ntam"}$)~$\ocwbc{} tam ? \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_mat}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} poss adj mas in -mat or -vat \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"an"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"antam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ataa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ate"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ati"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"antau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"antau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"antau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"atos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"atos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"antas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"antas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"adbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"adbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"adbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ataam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"atsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~[~32~::~[~1~::~\ocwlowerid{stem}~]~])~$\ocwbc{} mat - e.g. zriimat \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"antam"}$)~$\ocwbc{} atam ? \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_mahat}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aantam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ataa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ate"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ati"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aantau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aantau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aantau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"atos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"atos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aantas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aantas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"adbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"adbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"adbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ataam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"atsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~2)~$\ocwbc{} mahaa- \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Cvi}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~4)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"aantam"}$)~$\ocwbc{} atam ? \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} stems having a consonant before man or van have vocalic endings an \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{avocalic}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{last}~::~\ocwlowerid{\_}~]~\rightarrow{}~\lnot{}~(\ocwupperid{Phonetics.}\ocwlowerid{vowel}~\ocwlowerid{last})$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Nouns.avocalic:\ocwvspace{}empty\ocwvspace{}stem"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_man}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{avoc}~=~\ocwlowerid{avocalic}~\ocwlowerid{stem}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"man"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"ma"}~\ocwkw{else}~\ocwstring{"maa"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"ma"}~\ocwkw{else}~\ocwstring{"maanam"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~\ocwstring{"manaa"}~\ocwkw{else}~\ocwstring{"mnaa"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~\ocwstring{"mane"}~\ocwkw{else}~\ocwstring{"mne"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~\ocwstring{"manas"}~\ocwkw{else}~\ocwstring{"mnas"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~\ocwstring{"manas"}~\ocwkw{else}~\ocwstring{"mnas"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"mani"}\ocweol
\ocwindent{4.00em}
$]~@~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ma"}~$]~$\ocwkw{else}~$[\,])$\ocweol
\ocwindent{5.00em}
@~$($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~$[\,]~$\ocwkw{else}~$[~\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"mni"}~$]))$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"manii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"mnii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"manii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"mnii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"manii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"mnii"}\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"maanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"maanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"maanau"}\ocweol
\ocwindent{4.00em}
$])~@$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"mabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"mabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"mabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~\ocwstring{"manos"}~\ocwkw{else}~\ocwstring{"mnos"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~\ocwstring{"manos"}~\ocwkw{else}~\ocwstring{"mnos"}$)$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"maani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"maani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"maani"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{else}\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"maanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"maanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~\ocwstring{"manas"}~\ocwkw{else}~\ocwstring{"mnas"}$)$\ocweol
\ocwindent{4.00em}
$])~$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"mabhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"mabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"mabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~\ocwstring{"manaam"}~\ocwkw{else}~\ocwstring{"mnaam"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"masu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"mam"}$)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"matas"}$)$\ocweol
\ocwindent{1.50em}
$]~@~($\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"dharman"}~\ocwkw{then}~$[\,]~$\ocwbc{} redundant with dharma \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$[~\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~[~1~::~[~41~::~\ocwlowerid{stem}~]])~])$\ocweol
\ocwindent{2.50em}
@~$($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~\land{}~\ocwlowerid{man\_iiv}~\ocwlowerid{entry}~$\ocwkw{then}~$[~\ocwupperid{Cvi}~(\ocwlowerid{mirror}~[~4~::~[~41~::~\ocwlowerid{stem}~]])~]~$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$[\,])$\ocweol
\ocwindent{2.50em}
@~\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~$[~\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"ma"}$)~]~$\ocwkw{else}~$[\,])~$\ocwbc{} \Pan{5,4,109} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_man\_god}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} Aryaman Whitney §426a; Kale §118 \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"man"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"maa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"manam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"mnaa"}~\ocwbc{} aryam.naa and not *arya.n.naa \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"mne"}~\ocwbc{} above forbids merging with \ocwbegindcode{}$\ocwlowerid{build\_an\_god}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"mnas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"mnas"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"mani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"mni"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"manau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"manau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"manau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"mabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"mabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"mabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"mnos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"mnos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"manas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"manas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"mnas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"mabhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"mabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"mabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"mnaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"masu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~[~1~::~[~41~::~\ocwlowerid{stem}~]])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_van}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{avoc}~=~\ocwlowerid{avocalic}~\ocwlowerid{stem}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"van"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"piivan"}~\ocwkw{then}~\ocwstring{"vaan"}~\ocwbc{} Gonda \ocwec{}\ocweol
\ocwindent{11.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"va"}~\ocwkw{else}~\ocwstring{"vaa"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"va"}~\ocwkw{else}~\ocwstring{"vaanam"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~\ocwstring{"vanaa"}~\ocwkw{else}~\ocwstring{"vnaa"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~\ocwstring{"vane"}~\ocwkw{else}~\ocwstring{"vne"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~\ocwstring{"vanas"}~\ocwkw{else}~\ocwstring{"vnas"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~\ocwstring{"vanas"}~\ocwkw{else}~\ocwstring{"vnas"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"vani"}\ocweol
\ocwindent{4.00em}
$]~@~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"va"}~$]~$\ocwkw{else}~$[\,])$\ocweol
\ocwindent{5.00em}
@~$($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~$[\,]~$\ocwkw{else}~$[~\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"vni"}~$]))$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vanii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vnii"}~\ocwbc{} if avoc ? \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vanii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vnii"}~\ocwbc{} if avoc ? \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vanii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vnii"}~\ocwbc{} if avoc ? \ocwec{}\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vaanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vaanau"}\ocweol
\ocwindent{4.00em}
$])~@$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~\ocwstring{"vanos"}~\ocwkw{else}~\ocwstring{"vnos"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~\ocwstring{"vanos"}~\ocwkw{else}~\ocwstring{"vnos"}$)$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vaani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vaani"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{else}\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vaanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~\ocwstring{"vanas"}~\ocwkw{else}~\ocwstring{"vnas"}$)$\ocweol
\ocwindent{4.00em}
$])~$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vabhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~($\ocwkw{if}~$\ocwlowerid{avoc}~$\ocwkw{then}~\ocwstring{"vanaam"}~\ocwkw{else}~\ocwstring{"vnaam"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"vasu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~[~1~::~[~44~::~\ocwlowerid{stem}~]])$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"vam"}$)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"vatas"}$)$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
@~\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~$[~\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"va"}$)~]~$\ocwkw{else}~$[\,])~$\ocwbc{} \Pan{5,4,109} \ocwec{}\medskip

\label{nouns.ml:24784}%
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_an}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"an"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"a"}~\ocwkw{else}~\ocwstring{"aa"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"a"}~\ocwkw{else}~\ocwstring{"aanam"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"naa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ne"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ni"}\ocweol
\ocwindent{4.00em}
$]~@~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"a"}~$]~$\ocwkw{else}~$[\,]))$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"anii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"anii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"anii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aanau"}\ocweol
\ocwindent{4.00em}
$])~@$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"abhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"abhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"abhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{else}\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
$])~$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"abhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"abhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"abhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"asu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~1)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"am"}$)~$\ocweol
\ocwindent{1.50em}
$]~@~$\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~$[~\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"a"}$)~]~$\ocwkw{else}~$[\,])~$\ocwbc{} \Pan{5,4,109} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_an\_god}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} Whitney §426a \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"an"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"anam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"naa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ne"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ni"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"anau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"anau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"anau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"abhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"abhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"abhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"anas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"anas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"abhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"abhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"abhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"asu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~1)$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{0.00em}
;\medskip

\label{nouns.ml:27321}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_sp\_an}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{0.00em}
\ocwbc{} Whitney§432 these stems substitute the following for Voc Nom Acc :
   \ocwstring{"yakan"} \R \ocwstring{"yak.rt"}
   \ocwstring{"zakan"} \R \ocwstring{"zak.rt"}
   \ocwstring{"udan"} \R \ocwstring{"udaka"}
   \ocwstring{"yuu.san"} \R \ocwstring{"yuu.sa"}
   \ocwstring{"do.san"} \R \ocwstring{"dos"}
   \ocwstring{"asan"} \R \ocwstring{"as.rk"}
   \ocwstring{"aasan"} \R \ocwstring{"aasya"} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"naa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ne"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ani"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"abhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"abhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"abhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"abhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"abhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"abhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"asu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~1)$\ocweol
\ocwindent{0.00em}
\ocwbc{} ; Avyayaf ? \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_han}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} stem = ...-han Whitney§402 \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} g=Mas only, since g=Neu is dubious specially -ha \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declino}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fixno}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocwbc{} no retroflexion of n \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"han"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"haa"}~\ocwbc{} if g=Neu then \ocwstring{"ha"} else \ocwstring{"haa"} \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"hanam"}~\ocwbc{} if g=Neu then \ocwstring{"ha"} else \ocwstring{"hanam"} \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declino}~\ocwupperid{Ins}~$\ocwstring{"ghnaa"}~\ocwbc{} v.rtraghnaa, not *v.rtragh.naa Whitney§195a \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declino}~\ocwupperid{Dat}~$\ocwstring{"ghne"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declino}~\ocwupperid{Abl}~$\ocwstring{"ghnas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declino}~\ocwupperid{Gen}~$\ocwstring{"ghnas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declino}~\ocwupperid{Loc}~$\ocwstring{"ghni"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"hani"}\ocweol
\ocwindent{4.00em}
$])~$\ocwbc{} @ (if g=Neu then \ocwbegindcode{}~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ha"}~\ocwenddcode{} else \ocwbegindcode{}\ocwenddcode{})) \ocwec{}\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocwbc{} if g=Neu then 
                  \ocwbegindcode{}~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"hanii"}
~;~$\ocwlowerid{declino}~\ocwupperid{Voc}~$\ocwstring{"ghnii"}
~;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"hanii"}
~;~$\ocwlowerid{declino}~\ocwupperid{Nom}~$\ocwstring{"ghnii"}
~;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"hanii"}
~;~$\ocwlowerid{declino}~\ocwupperid{Acc}~$\ocwstring{"ghnii"}
~\ocwenddcode{}
               else \ocwec{}\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"hanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"hanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"hanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"habhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"habhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"habhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declino}~\ocwupperid{Gen}~$\ocwstring{"ghnos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declino}~\ocwupperid{Loc}~$\ocwstring{"ghnos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwbc{} if g=Neu then 
                    \ocwbegindcode{}~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"haani"}
~;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"haani"}
~;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"haani"}
~\ocwenddcode{}
                 else \ocwec{}\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"hanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"hanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declino}~\ocwupperid{Acc}~$\ocwstring{"ghnas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"habhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"habhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"habhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declino}~\ocwupperid{Gen}~$\ocwstring{"ghnaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"hasu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"hanam"}$)$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_zvan}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} \Pan{6,4,133} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"van"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vaanam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"unaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"une"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"unas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"unas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uni"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vaanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vaanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"unos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"unos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vaanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"unas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vabhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"unaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"vasu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
\ocwbc{} Bare Noun (code \ocwstring{"zunas"}) abl/gen pour zuna.hzepa non génératif \ocwec{}\ocweol
\ocwindent{1.50em}
\ocwbc{} Bare Noun (code \ocwstring{"zvaa"}) zvaapada avec nom. non génératif \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~[~1~::~[~45~::~\ocwlowerid{stem}~]~])~$\ocwbc{} eg zva-v.rtti \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"vaanam"}$)~$\ocwbc{} \ocwstring{"vam"} ? \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_athin}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} pathin, supathin, mathin \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bare}~=~\ocwlowerid{wrap}~\ocwlowerid{stem}~3~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"nthaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"nthaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"nthaanam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"thaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"the"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"thas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"thas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"thi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"nthaanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"nthaanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"nthaanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"thibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"thibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"thibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"thos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"thos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"nthaanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"nthaanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"thas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"thibhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"thibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"thibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"thaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"thisu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_ribhuksin}~\ocwlowerid{stem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aanam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"anam"}~\ocwbc{} \Pan{6,4,9} \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ibhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"asu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
\ocwbc{} ; Avyayaf ? \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_yuvan}~\ocwlowerid{entry}~=~$\ocwbc{} \Pan{6,4,133} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~[~42~]~$\ocwbc{} y \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"uvan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"uvaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uvaanam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uunaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uune"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uunas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uunas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uuni"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"uvaanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"uvaanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uvaanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uvabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uvabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uvabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uunos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uunos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"uvaanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"uvaanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uunas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uvabhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uvabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uvabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uunaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uvasu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{code}~$\ocwstring{"yuva"}$)~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{code}~$\ocwstring{"yuvam"}$)~$\ocwbc{} ? \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_maghavan}~\ocwlowerid{entry}~=~$\ocwbc{} \Pan{6,4,133} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~$\ocwstring{"magh"}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"avan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"avaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"avaanam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"onaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"one"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"onas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"onas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"oni"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"avaanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"avaanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"avaanau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"avabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"avabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"avabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"onos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"onos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"avaanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"avaanas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"onas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"avabhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"avabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"avabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"onaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"avasu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"avam"}$)~$\ocwbc{} ? \ocwec{}\ocweol
\ocwindent{0.00em}
$];$\medskip

\label{nouns.ml:35447}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_in}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bare}~=~\ocwlowerid{wrap}~\ocwlowerid{stem}~3~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"in"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"inam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"inaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ine"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"inas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"inas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ini"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"inau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"inau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"inau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"inos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"inos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"inas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"inas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"inas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ibhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"inaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"i.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Cvi}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~4)~$\ocwbc{} \ocwstring{"saak.sin"} \ocwstring{"sthaayin"} \ocwec{}\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_as}~\ocwlowerid{gen}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bare}~=~\ocwlowerid{mirror}~[~48~::~[~1~::~\ocwlowerid{stem}~]~]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{gen}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{match}~$\ocwlowerid{gen}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~\ocwupperid{Mas}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} gram Muller p 72,  Whitney §416 \ocwec{}\ocweol
\ocwindent{10.00em}
$[~$\ocwstring{"anehas"}~$\mid{}~$\ocwstring{"uzanas"}~$\mid{}~$\ocwstring{"da.mzas"}~\ocwbc{} Puruda.mzas \ocwec{}~$\rightarrow{}~$\ocwstring{"aa"}~\ocweol
\ocwindent{10.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"aas"}\ocweol
\ocwindent{10.00em}
$]~$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"aas"}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"as"}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"Nouns"}$)$\ocweol
\ocwindent{5.50em}
$])$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{match}~$\ocwlowerid{gen}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~\ocwupperid{Mas}~\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"asam"}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"as"}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"Nouns"}$)$\ocweol
\ocwindent{5.50em}
$])$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"asaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ase"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"asas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"asas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"asi"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"uzanas"}~$\land{}~\ocwlowerid{gen}~=~\ocwupperid{Mas}~$\ocwkw{then}~\ocwbc{} gram Muller p 72 \ocwec{}\ocweol
\ocwindent{8.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"a"};~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"an"}~$]~@~\ocwlowerid{l}~$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{direct}~=~$\ocwkw{match}~$\ocwlowerid{gen}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~\ocwupperid{Mas}~\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"asau"}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"asii"}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"Nouns"}$)$\ocweol
\ocwindent{5.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"obhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"obhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"obhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"asos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"asos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{direct}~=~$\ocwkw{match}~$\ocwlowerid{gen}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~\ocwupperid{Mas}~\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"asas"}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"aa.msi"}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"Nouns"}$)$\ocweol
\ocwindent{5.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"obhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"obhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"obhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"asaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"a.hsu"}~\ocwbc{} decline Loc \ocwstring{"assu"} \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{bare}~$\ocwbc{} as \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{2.50em}
@~$($\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{4.50em}
$[$\ocwstring{"uras"}~$\mid{}~$\ocwstring{"manas"}~$\rightarrow{}~[~\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~1)~]~$\ocwbc{} ura- mana- \ocwec{}\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[\,]$\ocweol
\ocwindent{4.50em}
$])$\ocweol
\ocwindent{2.50em}
@~$($\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{4.50em}
$[~$\ocwstring{"anas"}~$\mid{}~$\ocwstring{"manas"}~$\mid{}~$\ocwstring{"cetas"}~$\mid{}~$\ocwstring{"jaras"}~$\rightarrow{}~[~\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"asam"}$)~]$\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[\,]$\ocweol
\ocwindent{4.50em}
$])$\ocweol
\ocwindent{2.50em}
@~$($\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{4.50em}
$[~$\ocwstring{"nabhas"}~$\rightarrow{}~[~\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"as"}$);~\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"yam"}$)~]$\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[\,]$\ocweol
\ocwindent{4.50em}
$])$\ocweol
\ocwindent{2.50em}
@~$($\ocwkw{if}~$\ocwlowerid{gen}=\ocwupperid{Neu}~\land{}~\ocwlowerid{as\_iiv}~\ocwlowerid{entry}~$\ocwkw{then}~$[~\ocwupperid{Cvi}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~4)~]~$\ocwkw{else}~$[\,]))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_maas}~()~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{form}~=~(\ocwlowerid{case},\ocwlowerid{code}~\ocwlowerid{form})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~$\ocwstring{"maas"}\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"maas"}~\ocwbc{} no Acc Voc ? \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"maasaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"maase"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"maasas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"maasas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"maasi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"maadbhyaam"}~\ocwbc{} ou \ocwstring{"maabhyaam"} ?? \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"maabhyaam"}~\ocwbc{} Siddhaanta kaumudii - Jha \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"maadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"maadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"maasos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"maasos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"maadbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"maadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"maadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"maasaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"maa.hsu"}~\ocwbc{} maassu \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_nas}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{form}~=~(\ocwlowerid{case},\ocwlowerid{code}~\ocwlowerid{form})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"nasaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"nase"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"nasas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"nasas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"nasi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"naasaa"}~\ocwbc{} RV narines Whitney§397 \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"nasos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"nasos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_is}~\ocwlowerid{gen}~\ocwlowerid{stem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bare}~=~\ocwlowerid{mirror}~[~48~::~[~3~::~\ocwlowerid{stem}~]~]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{gen}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"is"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"is"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{match}~$\ocwlowerid{gen}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~\ocwupperid{Mas}~\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"i.sam"}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"is"}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"Nouns"}$)$\ocweol
\ocwindent{5.00em}
$])$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"i.saa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"i.se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"i.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"i.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"i.si"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{direct}~=~$\ocwkw{match}~$\ocwlowerid{gen}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~\ocwupperid{Mas}~\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"i.sau"}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"i.sii"}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"Nouns"}$)$\ocweol
\ocwindent{5.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"irbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"irbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"irbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"i.sos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"i.sos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{direct}~=~$\ocwkw{match}~$\ocwlowerid{gen}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~\ocwupperid{Mas}~\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"i.sas"}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"ii.msi"}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"Nouns"}$)$\ocweol
\ocwindent{5.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"irbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"irbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"irbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"i.saam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"i.h.su"}~\ocwbc{} decline Loc \ocwstring{"i.s.su"} \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{bare}~$\ocwbc{} is \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_us}~\ocwlowerid{gen}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bare}~=~\ocwlowerid{mirror}~[~48~::~[~5~::~\ocwlowerid{stem}~]~]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{gen}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"us"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"us"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{match}~$\ocwlowerid{gen}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~\ocwupperid{Mas}~\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"u.sam"}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"us"}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"Nouns"}$)$\ocweol
\ocwindent{5.00em}
$])$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"u.saa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"u.se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"u.si"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{direct}~=~$\ocwkw{match}~$\ocwlowerid{gen}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~\ocwupperid{Mas}~\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"u.sau"}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"u.sii"}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"Nouns"}$)$\ocweol
\ocwindent{5.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"urbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"urbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"urbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.sos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"u.sos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{direct}~=~$\ocwkw{match}~$\ocwlowerid{gen}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~\ocwupperid{Mas}~\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"uu.msi"}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"Nouns"}$)$\ocweol
\ocwindent{5.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~\ocwlowerid{direct}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"urbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"urbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"urbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.saam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"u.h.su"}~\ocwbc{} decline Loc \ocwstring{"u.s.su"} \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{bare}~$\ocwbc{} us \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Cvi}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~6)~$\ocwbc{} arus cak.sus \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{bare}~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_yas}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{bare}~=~\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"as"}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"an"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aa.msam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"asaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ase"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"asas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"asas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"asi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"obhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"obhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"obhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"asos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"asos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aa.msas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa.msas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"asas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"obhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"obhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"obhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"asaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"a.hsu"}~\ocwbc{} decline Loc \ocwstring{"assu"} \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_vas}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"van"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vaa.msam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"u.saa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"u.se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"u.si"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vaa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vaa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.sos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"u.sos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vaa.msas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaa.msas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vadbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.saam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"vatsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
\ocwbc{} ; Bare Noun (fix stem \ocwstring{"vas"}) \ocwec{}~\ocwbc{} ou vat ? \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"vas"}$)$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} i is dropped before u.s - Macdonnel §89a \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_ivas}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinev}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~($\ocwstring{"i"}~\^{}~$\ocwlowerid{suff}))~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinev}~\ocwupperid{Voc}~$\ocwstring{"van"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Nom}~$\ocwstring{"vaan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Acc}~$\ocwstring{"vaa.msam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"u.saa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"u.se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"u.si"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinev}~\ocwupperid{Voc}~$\ocwstring{"vaa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Nom}~$\ocwstring{"vaa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Acc}~$\ocwstring{"vaa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Ins}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Dat}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Abl}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.sos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"u.sos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinev}~\ocwupperid{Voc}~$\ocwstring{"vaa.msas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Nom}~$\ocwstring{"vaa.msas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Ins}~$\ocwstring{"vadbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Dat}~$\ocwstring{"vadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Abl}~$\ocwstring{"vadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.saam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Loc}~$\ocwstring{"vatsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"vas"}$)$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_aac}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"f"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"f"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"\~{}ncam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"caa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ce"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"cas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"cas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ci"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"\~{}ncau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"\~{}ncau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"\~{}ncau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"gbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"gbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"gbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"cos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"cos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"\~{}ncas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"\~{}ncas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"cas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"gbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"gbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"gbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"caam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"k.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"f"}$)~$\ocwbc{} nasale gutturale \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"\~{}nc"}$)~$\ocwbc{} ? \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_yac}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{prevoc}~=~$\ocwkw{if}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~$\ocwstring{"tir"}~\ocwkw{then}~\ocwstring{"azc"}\ocweol
\ocwindent{19.50em}
\ocwkw{else}~\ocwstring{"iic"}~\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwbc{} exception tiryac -> weakest stem tiriic in prevocalic flexions \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"yaf"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"yaf"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ya\~{}ncam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"aa"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"e"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"as"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"as"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"i"}$)$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ya\~{}ncau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ya\~{}ncau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ya\~{}ncau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"yagbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"yagbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"yagbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"os"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"os"}$)$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ya\~{}ncas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ya\~{}ncas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"as"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"yagbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"yagbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"yagbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"aam"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"yak.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"yak"}$)~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"yaf"}$)~$\ocwbc{} ? \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_vac}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vaf"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaf"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"va\~{}ncam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uucaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uuce"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uucas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uucas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uuci"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"va\~{}ncau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"va\~{}ncau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"va\~{}ncau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vagbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vagbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vagbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uucos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uucos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"va\~{}ncas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"va\~{}ncas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uucas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vagbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vagbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vagbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uucaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"vak.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"vak"}$)~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"vaf"}$)~$\ocwbc{} ? \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_ac}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"af"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"af"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"a\~{}ncam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iicaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iice"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iicas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iicas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"iici"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"a\~{}ncau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"a\~{}ncau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"a\~{}ncau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"agbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"agbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"agbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iicos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"iicos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"a\~{}ncas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"a\~{}ncas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iicas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"agbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"agbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"agbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iicaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ak.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"ak"}$)~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"af"}$)~$\ocwbc{} ? \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_pums}~\ocwlowerid{pum}~\ocwlowerid{pums}~\ocwlowerid{entry}~=~$\ocwbc{} for pu.ms et napu.ms \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} hi.ms pu.ms no retroflexion of s - Whitney§183a \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{pum}~(\ocwlowerid{code}~\ocwlowerid{suff}))~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declines}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{pums}~(\ocwlowerid{code}~\ocwlowerid{suff}))~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"an"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aa.msam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aa.msas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa.msas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Acc}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"bhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"u"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~\ocwlowerid{pum})~$\ocwbc{} for pul~~lifga \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~\ocwlowerid{pums})~$\ocwbc{} for pu.mzcala \ocwec{}\ocweol
\ocwindent{1.50em}
\ocwbc{} ; Avyayaf ? \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_vah}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"van"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaa.t"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vaaham"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ohaa"}~\ocwbc{} becomes auhaa by sandhi with a-   \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ohe"}~\ocwbc{} Whitney 403 gives uuhaa etc       \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ohas"}~\ocwbc{} but has special sandhi rule §137c \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ohas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ohi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vaahau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaahau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vaahau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vaa.dbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vaa.dbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vaa.dbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ohos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ohos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vaahas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaahas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ohas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vaa.dbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vaa.dbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vaa.dbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ohaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"vaa.tsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"vah"}$)$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_anadvah}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} ana.dvah \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"van"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vaaham"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uhaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uhe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uhas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uhas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uhi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vaahau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaahau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vaahau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"udbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"udbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"udbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uhos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uhos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vaahas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaahas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uhas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"udbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"udbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"udbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uhaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"utsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{code}~$\ocwstring{"uham"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_a}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"ubha"}~\ocwbc{} dual only \ocwec{}~\ocwkw{then}~$[\,]~$\ocwkw{else}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"a"}\ocweol
\ocwindent{3.50em}
\ocwbc{} decline Voc \ocwstring{"am"} - rare - disconnected for avoiding overgeneration \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ena"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aaya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"asya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"ubha"}~\ocwbc{} dual only \ocwec{}~\ocwkw{then}~$[\,]~$\ocwkw{else}~\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ais"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aanaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"esu"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"durita"}~\ocwkw{then}~$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa"}~::~$\ocwlowerid{l}~]~$\ocwbc{} vedic \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~1)~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"am"}$);~\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"aat"}$)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"atas"}$)$\ocweol
\ocwindent{1.50em}
$]~@~($\ocwkw{if}~$\ocwlowerid{a\_n\_iiv}~\ocwlowerid{entry}~$\ocwkw{then}~$[~\ocwupperid{Cvi}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~4)~]~$\ocwkw{else}~$[\,]))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_i}~\ocwlowerid{trunc}~\ocwlowerid{entry}~=~$\ocwbc{} stems in -i and -ii \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stems}~=~[~3~::~\ocwlowerid{trunc}~]~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{steml}~=~[~4~::~\ocwlowerid{trunc}~]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{rstems}~=~\ocwlowerid{mirror}~\ocwlowerid{stems}$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declines}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stems}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinel}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{steml}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declines}~\ocwupperid{Voc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Nom}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Acc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"naa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"ne"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"ni"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declines}~\ocwupperid{Voc}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Nom}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Acc}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinel}~\ocwupperid{Voc}~$\ocwstring{"ni"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Nom}~$\ocwstring{"ni"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Acc}~$\ocwstring{"ni"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"bhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Gen}~$\ocwstring{"naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{rstems}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{rstems}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_u}~\ocwlowerid{trunc}~\ocwlowerid{entry}~=~$\ocwbc{} stems in -u and -uu \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stems}~=~[~5~::~\ocwlowerid{trunc}~]~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{steml}~=~[~6~::~\ocwlowerid{trunc}~]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{declines}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stems}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinel}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{steml}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declines}~\ocwupperid{Voc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Nom}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Acc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"naa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"ne"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"ni"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declines}~\ocwupperid{Voc}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Nom}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Acc}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinel}~\ocwupperid{Voc}~$\ocwstring{"ni"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Nom}~$\ocwstring{"ni"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Acc}~$\ocwstring{"ni"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"bhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Gen}~$\ocwstring{"naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~\ocwlowerid{stems})$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{mirror}~\ocwlowerid{stems})$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_ri}~\ocwlowerid{trunc}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stems}~=~[~7~::~\ocwlowerid{trunc}~]~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{steml}~=~[~8~::~\ocwlowerid{trunc}~]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{declines}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stems}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinel}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{steml}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declines}~\ocwupperid{Voc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Nom}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Acc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"naa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"ne"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"ni"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declines}~\ocwupperid{Voc}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Nom}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Acc}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinel}~\ocwupperid{Voc}~$\ocwstring{"ni"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Nom}~$\ocwstring{"ni"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Acc}~$\ocwstring{"ni"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"bhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Gen}~$\ocwstring{"naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~\ocwlowerid{stems})$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{mirror}~\ocwlowerid{stems})$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_yas}~\ocwlowerid{stem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"asaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ase"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"asas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"asas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"asi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"asii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"asii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"asii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"obhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"obhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"obhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"asos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"asos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aa.msi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa.msi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aa.msi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"obhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"obhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"obhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"asaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"a.hsu"}~\ocwbc{} decline Loc \ocwstring{"assu"} \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"as"}$)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"as"}$)$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_vas}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"u.saa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"u.se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"u.si"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"u.sii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"u.sii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"u.sii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.sos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"u.sos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vaa.msi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaa.msi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vaa.msi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vadbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.saam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"vatsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"vat"}$)~$\ocwbc{} eg vidvat- \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"vas"}$)$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} i is dropped before u.s - Macdonnel §89a \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_ivas}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinev}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~($\ocwstring{"i"}~\^{}~$\ocwlowerid{suff}))~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinev}~\ocwupperid{Voc}~$\ocwstring{"vat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Nom}~$\ocwstring{"vat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Acc}~$\ocwstring{"vat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"u.saa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"u.se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"u.si"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"u.sii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"u.sii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"u.sii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Ins}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Dat}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Abl}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.sos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"u.sos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinev}~\ocwupperid{Voc}~$\ocwstring{"vaa.msi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Nom}~$\ocwstring{"vaa.msi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Acc}~$\ocwstring{"vaa.msi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Ins}~$\ocwstring{"vadbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Dat}~$\ocwstring{"vadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Abl}~$\ocwstring{"vadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.saam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Loc}~$\ocwstring{"vatsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"ivat"}$)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"ivas"}$)$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_red}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"taa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"te"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ti"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"tii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"tii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"tii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"dbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"dbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"dbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"nti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"nti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"nti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"dbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"dbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"dbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"tam"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_at}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"taa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"te"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ti"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"tii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ntii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"tii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ntii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"tii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ntii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"dbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"dbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"dbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"nti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"nti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"nti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"dbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"dbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"dbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"tam"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_mahat}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"at"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"at"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"at"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ataa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ate"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ati"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"atii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"atii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"atii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"atos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"atos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aanti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aanti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aanti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"adbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"adbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"adbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ataam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"atsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"atam"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} pronominal use of aatman in sg for refl use of 3 genders and 3 numbers \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_aatman}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~$\ocwstring{"aatm"}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~(\ocwupperid{Deictic}~\ocwupperid{Self})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"an"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aanam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"anaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ane"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"anas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"anas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ani"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Pron}~(\ocwlowerid{code}~$\ocwstring{"aatma"}$)~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{code}~$\ocwstring{"aatmam"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_yuvan}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~[~42~]~$\ocwbc{} y \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"uva"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"uvan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"uva"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uva"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uunaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uune"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uunas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uunas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uuni"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"uvanii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"uvanii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uvanii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uvabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uvabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uvabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uunos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uunos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"uvaanii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"uvaanii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uvaanii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uvabhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uvabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uvabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uunaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uvasu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"uvam"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_brahman}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~$\ocwstring{"brahm"}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"a.naa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"a.ne"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"a.nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"a.nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"a.ni"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"a.nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"a.nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"a.nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"abhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"abhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"abhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"a.nos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"a.nos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aa.nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa.nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aa.nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"abhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"abhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"abhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"a.naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"asu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{code}~$\ocwstring{"brahma"}$)~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{code}~$\ocwstring{"brahmam"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_aksan}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwbc{} stem = ak.san, asthan, dadhan, sakthan Whitney §431 \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"naa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ne"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ni"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ani"}~\ocwbc{} \Pan{7,1,75} \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"inii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"inii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ii"}~\ocwbc{} Sun and moon \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"inii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"iinii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"iinii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iinii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aanii"}~\ocwbc{} MW véd. sakthaanii RV{10,86,16} AV{6,9,1} \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ibhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"isu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"i"}$)~$\ocwbc{} also indirectly generated by var subentry \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_ahan}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} stem = \ocwstring{"ah"} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ar"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ar"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ar"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"naa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ne"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ni"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ani"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"anii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"anii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"anii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"obhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"obhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"obhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"obhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"obhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"obhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"a.hsu"}~\ocwbc{} decline Loc \ocwstring{"assu"} \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"ar"}$)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"as"}$)~$\ocwbc{} before r Pan{8;2;68} \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"am"}$)~$\ocwbc{} pratyaham \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"ar"}$)~$\ocwbc{} pratyaha.h \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_uudhan}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} stem = \ocwstring{"uudh"} \ocwec{}~\ocwbc{} Whitney §430d \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ar"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ar"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ar"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"naa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ne"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"nas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"an"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ani"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"anii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"anii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"nii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"anii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"abhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"abhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"abhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"nos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"abhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"abhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"abhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"a.hsu"}~\ocwbc{} decline Loc \ocwstring{"assu"} \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{code}~$\ocwstring{"uudhar"}$)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{code}~$\ocwstring{"uudham"}$)~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{code}~$\ocwstring{"uudha"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_in}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bare}~=~\ocwlowerid{wrap}~\ocwlowerid{stem}~3~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"in"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"inaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ine"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"inas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"inas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ini"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"inii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"inii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"inii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"inos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"inos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"iini"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"iini"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iini"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ibhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"inaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"i.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{bare}~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_aac}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"k"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"k"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"\~{}ncam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"caa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ce"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"cas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"cas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ci"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"cii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"cii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"cii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"gbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"gbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"gbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"cos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"cos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"\~{}nci"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"\~{}nci"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"\~{}nci"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"gbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"gbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"gbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"caam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"k.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_yac}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{prevoc}~=~$\ocwkw{if}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~$\ocwstring{"tir"}~\ocwkw{then}~\ocwstring{"azc"}~\ocweol
\ocwindent{19.50em}
\ocwkw{else}~\ocwstring{"iic"}~\ocwkw{in}\ocweol
\ocwindent{7.50em}
\ocwbc{} exception tiryac -> tiriic in prevocalic flexions \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"yak"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"yak"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"yak"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"aa"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"e"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"as"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"as"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"i"}$)$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"ii"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"ii"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"ii"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"yagbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"yagbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"yagbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"os"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"os"}$)$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ya\~{}nci"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ya\~{}nci"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ya\~{}nci"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"yagbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"yagbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"yagbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~(\ocwlowerid{prevoc}~$\^{}~\ocwstring{"aam"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"yak.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_vac}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vak"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vak"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vak"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uucaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uuce"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uucas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uucas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uuci"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"uucii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"uucii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uucii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vagbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vagbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vagbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uucos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uucos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"va\~{}nci"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"va\~{}nci"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"va\~{}nci"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vagbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vagbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vagbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uucaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"vak.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{code}~$\ocwstring{"vacam"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_ac}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ak"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ak"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ak"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iicaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iice"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iicas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iicas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"iici"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"iicii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"iicii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iicii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"agbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"agbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"agbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iicos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"iicos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"a\~{}nci"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"a\~{}nci"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"a\~{}nci"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"agbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"agbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"agbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iicaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ak.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{code}~$\ocwstring{"acam"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_aas}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aa"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ayaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_fem\_aa}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"ubha"}~\ocwkw{then}~$[\,]~$\ocwkw{else}~\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"allaa"}~$\lor{}~\ocwlowerid{entry}~=~$\ocwstring{"akkaa"}~\ocweol
\ocwindent{5.00em}
\ocwkw{then}~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"a"}~\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ayaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aayai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aayaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aayaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"aayaam"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"ambaa"}~\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"a"}~::~$\ocwlowerid{l}~]~$\ocwbc{} also ambe vedic \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"guha"}~\ocwkw{then}~\ocwbc{} guhaa fde guha \ocwec{}\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"aa"}~::~$\ocwlowerid{l}~]~$\ocwbc{} vedic \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"ubha"}~\ocwkw{then}~$[\,]~$\ocwkw{else}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aanaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"aasu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"am"}$)~$\ocweol
\ocwindent{1.50em}
$]~@~($\ocwkw{if}~$\ocwlowerid{aa\_iiv}~\ocwlowerid{entry}~$\ocwkw{then}~$[~\ocwupperid{Cvi}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~4)~]~$\ocwkw{else}~$[\,]))$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwbc{} vedic g = Fem, rare (jaa) Whitney 351 \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mono\_aa}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aas"}~\ocwbc{} Whitney \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"as"}~\ocwbc{} Paninian form, according to Deshpande \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhis"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyas"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"anaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"aasu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"am"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} gandharva Haahaa \ocwbegindcode{}$\ocwupperid{Tirupati}$\ocwenddcode{} and pkt raa.naa \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_aa\_no\_root}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aus"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"aus"}\ocweol
\ocwindent{4.00em}
$])~$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aas"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aas"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhis"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyas"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aam"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"aasu"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Special for gandharva Huuhuu \ocwbegindcode{}$\ocwupperid{Tirupati}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Also a few exceptions \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_huuhuu}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~$\ocwstring{"huuh"}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"uus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"uus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uum"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ve"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"vi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"vau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"vau"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uun"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uubhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uubhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uubhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"vaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uu.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_fem\_i}~\ocwlowerid{stem}~\ocwlowerid{trunc}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{declines}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declineg}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~[~10~::~\ocwlowerid{trunc}~]~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinel}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~[~4~::~\ocwlowerid{trunc}~]~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinau}~\ocwlowerid{case}~=~(\ocwlowerid{case},\ocwlowerid{wrap}~\ocwlowerid{trunc}~13)~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declineg}~\ocwupperid{Voc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Nom}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Acc}~$\ocwstring{"m"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"ai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineg}~\ocwupperid{Dat}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineg}~\ocwupperid{Abl}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineg}~\ocwupperid{Gen}~$\ocwstring{"s"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinau}~\ocwupperid{Loc}~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinel}~\ocwupperid{Voc}~$\ocwstring{""}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Nom}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Acc}~$\ocwstring{""}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"bhyaam"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"bhyaam"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"os"}~\ocweol
\ocwindent{4.00em}
$])~$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declineg}~\ocwupperid{Voc}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineg}~\ocwupperid{Nom}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Acc}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"bhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Gen}~$\ocwstring{"naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~\ocwlowerid{stem})$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{mirror}~\ocwlowerid{stem})~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"tas"}$)$\ocweol
\ocwindent{1.50em}
$]~@~($\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"vi.mzati"}~\ocweol
\ocwindent{4.00em}
\ocwkw{then}~$[~\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~\ocwlowerid{trunc})~$\ocwbc{} vi.mzat \ocwec{}~$]$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$[\,]))$\medskip

\label{nouns.ml:82523}%
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_fem\_ii}~\ocwlowerid{trunc}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stems}~=~[~3~::~\ocwlowerid{trunc}~]~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{steml}~=~[~4~::~\ocwlowerid{trunc}~]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{declines}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stems}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinel}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{steml}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declines}~\ocwupperid{Voc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Nom}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Acc}~$\ocwstring{"m"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"ai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declines}~\ocwupperid{Voc}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Nom}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Acc}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Ins}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Dat}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Abl}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declines}~\ocwupperid{Voc}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Nom}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Acc}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Ins}~$\ocwstring{"bhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Dat}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Abl}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Gen}~$\ocwstring{"naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Loc}~$\ocwstring{"su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~\ocwlowerid{steml})~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{mirror}~\ocwlowerid{stems})~$\ocweol
\ocwindent{1.50em}
$]~@~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{3.50em}
$[~$\ocwstring{"nadii"}~$\mid{}~$\ocwstring{"paur.namasii"}~$\mid{}~$\ocwstring{"aagrahaaya.nii"}~\ocweol
\ocwindent{4.50em}
$\rightarrow{}~[~\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{trunc}~$\ocwstring{"am"}$)~]$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[\,]$\ocweol
\ocwindent{3.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} g = Fem, rarely Mas \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mono\_ii}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}~$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"iis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"iis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iyam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iyaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iye"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iyai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iyaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iyaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"iyi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"iyaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"iyau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"iyau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iyau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iyos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"iyos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"iyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"iyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iibhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iinaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ii.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~4)~$\ocwbc{} productive ? shortened ? \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~3)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{poly\_ii\_decls}~\ocwlowerid{decline}~=$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"iis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"yam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"yaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ye"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"yas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"yas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"yi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"yaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"yaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"yaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"yos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"yos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"yas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"yas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"yas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iibhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iinaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ii.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} vedic forms g = Fem, rarely Mas (rathii) \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_poly\_ii}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}~(\ocwlowerid{poly\_ii\_decls}~\ocwlowerid{decline})$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~4)~$\ocweol
\ocwindent{0.00em}
\ocwbc{} ; Bare Noun (wrap stem 3) eg kumaarimataa Pan{6,3,42} \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~3)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_strii}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iyam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iim"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iyaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iyai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iyaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iyaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"iyaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"iyau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"iyau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iyau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iyos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"iyos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"iyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"iyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iibhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iinaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ii.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~4)~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~3)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_fem\_u}~\ocwlowerid{stem}~\ocwlowerid{trunc}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{declines}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declineg}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~[~12~::~\ocwlowerid{trunc}~]~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinel}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~[~6~::~\ocwlowerid{trunc}~]~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinau}~\ocwlowerid{case}~=~(\ocwlowerid{case},\ocwlowerid{wrap}~\ocwlowerid{trunc}~13)~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}~$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declineg}~\ocwupperid{Voc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Nom}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Acc}~$\ocwstring{"m"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"ai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineg}~\ocwupperid{Dat}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineg}~\ocwupperid{Abl}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineg}~\ocwupperid{Gen}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinau}~\ocwupperid{Loc}~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinel}~\ocwupperid{Voc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Nom}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Acc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Gen}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declineg}~\ocwupperid{Voc}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineg}~\ocwupperid{Nom}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Acc}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Ins}~$\ocwstring{"bhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Dat}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Abl}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinel}~\ocwupperid{Gen}~$\ocwstring{"naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declines}~\ocwupperid{Loc}~$\ocwstring{"su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{mirror}~\ocwlowerid{stem})$\ocweol
\ocwindent{1.50em}
$]~@~($\ocwkw{if}~$\ocwlowerid{entry}=$\ocwstring{"ku\#2"}~$\lor{}~\ocwlowerid{entry}=$\ocwstring{"go"}~\ocwkw{then}~$[\,]~$\ocwbc{} avoids overgeneration \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$[~\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~\ocwlowerid{stem})~]))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_fem\_uu}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"u"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"uus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uum"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"vaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"vaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"vos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"vos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uubhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uubhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uubhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uunaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uu.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~6)~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~5)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} g = Fem, rarely Mas \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mono\_uu}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"uus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"uus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uvam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uvaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uve"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uvai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uvas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uvaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uvas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uvaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uvi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uvaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"uvau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"uvau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uvau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uvos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uvos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"uvas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"uvas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uvas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uubhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uubhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uubhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uvaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uunaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uu.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~6)~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~5)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{poly\_uu\_decls}~\ocwlowerid{decline}~=~$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"u"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"uus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"vaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ve"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"vi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"vos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"vos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uubhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uubhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uubhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uunaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uu.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} vedic forms g = Fem, very rarely Mas (praazuu) \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_poly\_uu}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}~(\ocwlowerid{poly\_uu\_decls}~\ocwlowerid{decline})$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~6)~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~5)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_fem\_ri\_v}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} vriddhi in strong cases \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bare}~=~\ocwlowerid{wrap}~\ocwlowerid{stem}~7~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ar"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aaram"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"raa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"re"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ari"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aarau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aarau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aarau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{".rbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{".rbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{".rbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ros"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ros"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aaras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aaras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{".rrs"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{".rbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{".rbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{".rbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{".rr.naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{".r.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{bare}~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_fem\_ri\_g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} parenté avec gu.na \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bare}~=~\ocwlowerid{wrap}~\ocwlowerid{stem}~7~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ar"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aram"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"raa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"re"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ari"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"arau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"arau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"arau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{".rbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{".rbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{".rbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ros"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ros"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{".rrs"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aras"}~\ocwbc{} epics Whitney 373c \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{".rbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{".rbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{".rbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{".rr.naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{".r.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{bare}~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_fem\_ir}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} gir \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{short}~=~\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"ir"}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{long}~=~\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"iir"}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"iir"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"iir"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iram"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iraa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ire"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"iri"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"irau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"irau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"irau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iirbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iirbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iirbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iros"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"iros"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"iras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"iras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iirbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iirbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iirbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iraam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"iir.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{short}~$\ocwbc{} gir- \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{long}~$\ocwbc{} giir- \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{short}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Similar to preceding paradigm - for aazis \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_fem\_is}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"iis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"iis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"i.sam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"i.saa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"i.se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"i.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"i.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"i.si"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"i.sau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"i.sau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"i.sau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iirbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iirbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iirbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"i.sos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"i.sos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"i.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"i.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"i.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iirbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iirbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iirbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"i.saam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ii.h.su"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ii.s.su"}~\ocwbc{} necessary \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"iir"}$)~$\ocwbc{} aazis1- \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"ii"}$)~$\ocwbc{} aazis2- \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"is"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_fem\_ur}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"uur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"uur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uram"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uraa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ure"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uri"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"urau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"urau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"urau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uurbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uurbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uurbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uros"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uros"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"uras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"uras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"uurbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"uurbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"uurbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"uraam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"uur.su"}\ocweol
\ocwindent{4.00em}
$])~$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"uur"}$)~$\ocwbc{} dhuur- \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"ur"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} This paradigm could be obtained by implementing Macdonell§59, see
   \ocwbegindcode{}$\ocwupperid{Phonetics}.\ocwlowerid{diphthong\_split}$\ocwenddcode{} and the code commented out in \ocwbegindcode{}$\ocwupperid{Int\_sandhi}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_rai}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} stem = raa g = Mas or Fem (rare) \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"yam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"yaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ye"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"yas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"yas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"yi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"yau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"yau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"yau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"yos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"yos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"yas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"yas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"yas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"bhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"yaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{code}~$\ocwstring{"ri"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_e}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"es"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"e"}~\ocwbc{} Kale 33 \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"es"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ayaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aye"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"es"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"es"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ayi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ayau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ayau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ayau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ebhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ebhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ebhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ayas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ayas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ayas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ebhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ayaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"e.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"aya"}$)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"i"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_o}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"avaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ave"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"avi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aavau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aavau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aavau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"obhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"obhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"obhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"avos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"avos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aavas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aavas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"obhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"obhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"obhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"avaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"o.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~((\ocwlowerid{mirror}~\ocwlowerid{stem})~@~(\ocwlowerid{code}~$\ocwstring{"o"}$))~$\ocwbc{} go- \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~((\ocwlowerid{mirror}~\ocwlowerid{stem})~@~(\ocwlowerid{code}~$\ocwstring{"ava"}$))~$\ocwbc{} go -> gava- \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"u"}$)~$\ocwbc{} upagu \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_div}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} stem = \ocwstring{"d"} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"yaus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"yaus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ivam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"yaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ivaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ive"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"yave"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ivas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"yos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ivas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"yos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ivi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"yavi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"yaavau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ivau"}~\ocwbc{} Renou \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"yaavau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ivau"}~\ocwbc{} Renou \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ivas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ivas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"yaavas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ivas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"yubhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"yubhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"yubhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ivaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"yu.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"iv"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_diiv}~\ocwlowerid{entry}~=~$\ocwbc{} diiv\#2 \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{form}~=~(\ocwlowerid{case},\ocwlowerid{code}~\ocwlowerid{form})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"dyuvam"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"diivnaa"}~\ocwbc{} for pratidiivnaa (par l'adversaire) \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"diive"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"dyuve"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"diivi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_au}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aavam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aavaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aave"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aavas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aavas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"aavi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aavau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aavau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aavau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aavos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"aavos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aavas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aavas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aavas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aubhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aubhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aubhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aavaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"au.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"u"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_ap}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{register}~\ocwupperid{Voc}~$\ocwstring{"aapas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Nom}~$\ocwstring{"aapas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Acc}~$\ocwstring{"apas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Ins}~$\ocwstring{"adbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Dat}~$\ocwstring{"adbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Abl}~$\ocwstring{"adbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Gen}~$\ocwstring{"apaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Loc}~$\ocwstring{"apsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{code}~$\ocwstring{"ap"}$)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{code}~$\ocwstring{"apam"}$)~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Root word declension. Finalization ensures the initial aspiration by
Phonetics.asp, in order to transform eg duk in dhuk (Whitney §155) \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_root}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declfin}~\ocwlowerid{case}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{3.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{finalize\_r}$\ocwenddcode{} for doubling of vowel in r roots Whitney §245b \ocwec{}\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{case},\ocwlowerid{fix}~(\ocwlowerid{finalize\_r}~\ocwlowerid{stem})~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bare}~=~\ocwlowerid{mirror}~(\ocwlowerid{finalize}~\ocwlowerid{stem})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declfin}~\ocwupperid{Voc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declfin}~\ocwupperid{Nom}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~$\ocwlowerid{declfin}~\ocwupperid{Acc}~$\ocwstring{""}~\ocwkw{else}~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"ii"}~\ocwkw{else}~\ocwstring{"au"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"ii"}~\ocwkw{else}~\ocwstring{"au"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"ii"}~\ocwkw{else}~\ocwstring{"au"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declfin}~\ocwupperid{Ins}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declfin}~\ocwupperid{Dat}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declfin}~\ocwupperid{Abl}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"i"}~\ocwkw{else}~\ocwstring{"as"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"i"}~\ocwkw{else}~\ocwstring{"as"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"i"}~\ocwkw{else}~\ocwstring{"as"}$)$\ocweol
\ocwindent{1.50em}
\ocwbc{} Voc Nom Acc Neu ought to have nasal : vr.nti Whitney§389c p. 145 \ocwec{}\ocweol
\ocwindent{1.50em}
\ocwbc{} Acc. vaacas with accent on aa or on a        Whitney§391  p. 147 \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declfin}~\ocwupperid{Ins}~$\ocwstring{"bhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declfin}~\ocwupperid{Dat}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declfin}~\ocwupperid{Abl}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declfin}~\ocwupperid{Loc}~$\ocwstring{"su"}~\ocweol
\ocwindent{4.50em}
\ocwbc{} viz2 -> vi.tsu but also véd. vik.su Whitney§218a \ocwbegindcode{}$\ocwlowerid{compute\_extra}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{bare}~$\ocwbc{} thus hutabhuj -> hutabhuk+dik -> ...gdik \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_root\_m}~\ocwlowerid{g}~\ocwlowerid{trunc}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} Kale§107 \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declcon}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~[~36~$\ocwbc{} n \ocwec{}~::~$\ocwlowerid{trunc}~]~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declcon}~\ocwupperid{Voc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declcon}~\ocwupperid{Nom}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~$\ocwlowerid{declcon}~\ocwupperid{Acc}~$\ocwstring{""}~\ocwkw{else}~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"ii"}~\ocwkw{else}~\ocwstring{"au"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"ii"}~\ocwkw{else}~\ocwstring{"au"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"ii"}~\ocwkw{else}~\ocwstring{"au"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declcon}~\ocwupperid{Ins}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declcon}~\ocwupperid{Dat}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declcon}~\ocwupperid{Abl}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"i"}~\ocwkw{else}~\ocwstring{"as"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"i"}~\ocwkw{else}~\ocwstring{"as"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"i"}~\ocwkw{else}~\ocwstring{"as"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declcon}~\ocwupperid{Ins}~$\ocwstring{"bhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declcon}~\ocwupperid{Dat}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declcon}~\ocwupperid{Abl}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declcon}~\ocwupperid{Loc}~$\ocwstring{"su"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_archaic\_yuj}~\ocwlowerid{stem}~$\ocwbc{} yu~nj remnant nasal Kale§97 \ocwec{}~$\ocwlowerid{g}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declfinal}~\ocwlowerid{case}~=~(\ocwlowerid{case},~[~42;~5;~21~$\ocwbc{} yuf \ocwec{}~$])~$\ocwkw{in}~\ocwbc{} Whitney§386 \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}~$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declfinal}~\ocwupperid{Voc}~$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declfinal}~\ocwupperid{Nom}~$\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~$\ocwlowerid{declfinal}~\ocwupperid{Acc}~$\ocwkw{else}~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"am"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"au"}~\ocwbc{} Kale§97 but Whitney§386 \ocwstring{"aa"} ? \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"au"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Root words opt. substitutes in weak cases \Pan{6,1,63} Whitney§397 \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_root\_weak}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bare}~=~\ocwlowerid{mirror}~(\ocwlowerid{finalize}~\ocwlowerid{stem})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocwbc{} strong stem entry paada danta etc. \ocwec{}\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"bhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_pad}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} for catu.spad and other -pad compounds \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{form}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{form})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bare}~=~\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"pat"}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}~$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"paat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"paat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"paadam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"padaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"pade"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"padas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"padas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"padi"}\ocweol
\ocwindent{4.00em}
$]~@~$\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Fem}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"padii"}~$]~$\ocwkw{else}~$[\,])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"paadii"}~\ocwkw{else}~\ocwstring{"paadau"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"paadii"}~\ocwkw{else}~\ocwstring{"paadau"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"paadii"}~\ocwkw{else}~\ocwstring{"paadau"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"paadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"paadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"paadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"paados"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"paados"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"paadas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"paadas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"paadas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"paadbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"paadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"paadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"paadaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"paatsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~\ocwlowerid{bare}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_sap}~\ocwlowerid{g}~\ocwlowerid{st}~\ocwlowerid{entry}~=~$\ocwbc{} MW saap in strong cases \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~[~37~::~[~1~::~[~48~::~\ocwlowerid{st}~]~]~]~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinestr}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~[~37~::~[~2~::~[~48~::~\ocwlowerid{st}~]~]~]~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinestr}~\ocwupperid{Nom}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinestr}~\ocwupperid{Acc}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"ii"}~\ocwkw{else}~\ocwstring{"au"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinestr}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"ii"}~\ocwkw{else}~\ocwstring{"au"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinestr}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"ii"}~\ocwkw{else}~\ocwstring{"au"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"i"}~\ocwkw{else}~\ocwstring{"as"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinestr}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"i"}~\ocwkw{else}~\ocwstring{"as"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocwstring{"i"}~\ocwkw{else}~\ocwstring{"as"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"bhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"su"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_dam}~\ocwlowerid{entry}~=~$\ocwbc{} vedic \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{form}~=~(\ocwlowerid{case},\ocwlowerid{code}~\ocwlowerid{form})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}~$\ocwbc{} arbitrary \ocwec{}\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"dan"}~$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"damaam"}~$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{revcode}~$\ocwstring{"dam"}$)$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_upaanah}~\ocwlowerid{trunc}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} Kale§101 trunc = mirror(upaana) \ocwec{}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{bare}~=~[~32~$\ocwbc{} t \ocwec{}~::~$\ocwlowerid{trunc}~]~$\ocwbc{} upaanat \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{declineh}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinet}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{bare}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinet}~\ocwupperid{Voc}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinet}~\ocwupperid{Nom}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineh}~\ocwupperid{Acc}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineh}~\ocwupperid{Ins}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineh}~\ocwupperid{Dat}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineh}~\ocwupperid{Abl}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineh}~\ocwupperid{Gen}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineh}~\ocwupperid{Loc}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declineh}~\ocwupperid{Voc}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineh}~\ocwupperid{Nom}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineh}~\ocwupperid{Acc}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinet}~\ocwupperid{Ins}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinet}~\ocwupperid{Dat}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinet}~\ocwupperid{Abl}~$\ocwstring{"bhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineh}~\ocwupperid{Gen}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineh}~\ocwupperid{Loc}~$\ocwstring{"os"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declineh}~\ocwupperid{Voc}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineh}~\ocwupperid{Nom}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineh}~\ocwupperid{Acc}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinet}~\ocwupperid{Ins}~$\ocwstring{"bhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinet}~\ocwupperid{Dat}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinet}~\ocwupperid{Abl}~$\ocwstring{"bhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declineh}~\ocwupperid{Gen}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinet}~\ocwupperid{Loc}~$\ocwstring{"su"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~\ocwlowerid{bare})$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} reduplicated ppr of class 3 verbs or intensives: no nasal in strong stem \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} should be replaced by proper tag, rather than matching stem \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{is\_redup}~=~$\ocwkw{fun}~\ocwbc{} reduplicating roots, possibly with preverb \ocwec{}\ocweol
\ocwindent{2.00em}
$[~[~41~::~[~3~::~[~41~::~\ocwlowerid{r}~]~]~]~$\ocwkw{when}~$\ocwlowerid{r}~=~\ocwlowerid{revstem}~$\ocwstring{"raz"}~\ocweol
\ocwindent{4.00em}
$\rightarrow{}~\ocwupperid{False}~$\ocwbc{} razmimat protected from compounds of mimat \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~34~::~[~1~::~[~34~::~\ocwlowerid{\_}~]~]~]~$\ocwbc{} daa\#1 -> dadat \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~35~::~[~1::~[~34~::~\ocwlowerid{\_}~]~]~]~$\ocwbc{} dhaa\#1 -> dadhat \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~[~41~::~[~3~::~[~41~::~\ocwlowerid{\_}~]~]~]~$\ocwbc{} maa\#1 -> mimat \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~[~42~::~[~5~::~[~42~::~\ocwlowerid{\_}~]~]~]~$\ocwbc{} yu\#2 -> yuyat \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~43~::~[~19~::~[~2~::~[~24~::~\ocwlowerid{\_}~]~]~]~]~$\ocwbc{} g.r int -> jaagrat \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~43~::~[~20~::~[~3~::~[~24~::~\ocwlowerid{\_}~]~]~]~]~$\ocwbc{} gh.r -> jighrat \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~43~::~[~37~::~[~3~::~[~37~::~\ocwlowerid{\_}~]~]~]~]~$\ocwbc{} p.r\#1 -> piprat \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~43~::~[~40~::~[~3~::~[~39~::~\ocwlowerid{\_}~]~]~]~]~$\ocwbc{} bh.r -> bibhrat \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~45~::~[~49~::~[~5~::~[~24~::~\ocwlowerid{\_}~]~]~]~]~$\ocwbc{} hu -> juhvat \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~[~46~::~[~3~::~[~46~::~\ocwlowerid{\_}~]~]~]~$\ocwbc{} zaa -> zizat \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~[~48~::~[~3~::~[~48~::~\ocwlowerid{\_}~]~]~]~$\ocwbc{} s.r -> sisrat \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~[~49~::~[~1~::~[~24~::~\ocwlowerid{\_}~]~]~]~$\ocwbc{} haa\#1 -> jahat \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwbc{}  | \ocwbegindcode{}~49~::~[~3~::~[~24~::~$\ocwlowerid{\_}~]~]~$\ocwenddcode{}           \ocwbc{} haa\#? -> jihat \ocwec{} ? \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~[~49~::~[~12~::~[~24~::~\ocwlowerid{\_}~]~]~]~$\ocwbc{} hu int. -> johvat \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~41~::~[~1~::~[~43~::~[~17~::~[~21~::~[~1~::~[~22~::~\ocwlowerid{\_}~]~]~]~]~]~]~]~$\ocweol
\ocwindent{5.00em}
\ocwbc{} kram int. -> cafkramat \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~34~::~[~1~::~[~45~::~[~2~::~[~45~::~\ocwlowerid{\_}~]~]~]~]~]$\ocwbc{} vad int. -> vaavadat \ocwec{}\ocweol
\ocwindent{4.00em}
$\rightarrow{}~\ocwupperid{True}~$\ocweol
\ocwindent{0.00em}
\ocwbc{} Whitney says add: cak.sat daazat daasat zaasat sazcat dhak.sat vaaghat \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_auduloma}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{pstem}~\ocwlowerid{entry}~=~$\ocwbc{} au.duloma Kale 26 \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinep}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{pstem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"is"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"im"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"inaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aye"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"es"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"es"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"yos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"yos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinep}~\ocwupperid{Voc}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinep}~\ocwupperid{Nom}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinep}~\ocwupperid{Acc}~$\ocwstring{"aan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinep}~\ocwupperid{Ins}~$\ocwstring{"ais"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinep}~\ocwupperid{Dat}~$\ocwstring{"ebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinep}~\ocwupperid{Abl}~$\ocwstring{"ebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinep}~\ocwupperid{Gen}~$\ocwstring{"aanaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinep}~\ocwupperid{Loc}~$\ocwstring{"esu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Pronouns 
\ocweol
\label{nouns.ml:113717}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_sa\_tad}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Pron}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"sas"}~\ocwbc{} gives e.sa.h for etad \ocwec{}\ocweol
\ocwindent{16.00em}
\ocwkw{else}~\ocwstring{"tat"}$)~$\ocwbc{} final \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"tam"}~\ocwkw{else}~\ocwstring{"tat"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"tena"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"tasmai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tasmaat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tatas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tasya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tasmin"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"sa"}~::~$\ocwlowerid{l}~]~$\ocwbc{} usable before vowels, see Dispatcher \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l})~$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"tau"}~\ocwkw{else}~\ocwstring{"te"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"tau"}~\ocwkw{else}~\ocwstring{"te"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"taabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"taabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"taabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tatas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"te"}~\ocwkw{else}~\ocwstring{"taani"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"taan"}~\ocwkw{else}~\ocwstring{"taani"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"tais"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"tebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tatas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"te.saam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"te.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]~@~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~\land{}~\ocwlowerid{stem}~=~[~10~]~$\ocwkw{then}~$[~\ocwupperid{Bare}~\ocwupperid{Pron}~(\ocwlowerid{code}~$\ocwstring{"etat"}$)~]$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$[\,]))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_sya\_tyad}~\ocwlowerid{g}~\ocwlowerid{entry}~=~$\ocwbc{} Vedic Whitney §499a \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{form}~=~(\ocwlowerid{case},\ocwlowerid{code}~\ocwlowerid{form})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Pron}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"syas"}~\ocwkw{else}~\ocwstring{"tyat"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"tyam"}~\ocwkw{else}~\ocwstring{"tyat"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"tyena"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"tyasmai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tyasmaat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tyatas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tyasya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tyasmin"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"sya"}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{11.00em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"tyau"}~\ocwkw{else}~\ocwstring{"tye"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"tyau"}~\ocwkw{else}~\ocwstring{"tye"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"tyaabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"tyaabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tyaabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tyatas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tyayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tyayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"tye"}~\ocwkw{else}~\ocwstring{"tyaani"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"tyaan"}~\ocwkw{else}~\ocwstring{"tyaani"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"tyais"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"tyebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tyebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tyatas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tye.saam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tye.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} pronominal stems (mirror+lopa) of pronouns usable as nominals \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pseudo\_nominal\_basis}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[~17;~10;~36;~1~]~$\ocwbc{} aneka \ocwec{}~\ocwbc{} perhaps also eka, anya ? \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~31;~3;~47;~17;~1;~34~]~$\ocwbc{} dak.si.na \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~[~41;~3;~22;~46;~1;~37~]~$\ocwbc{} pazcima \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~[~41;~10;~36~]~$\ocwbc{} nema Whitney§525c \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~42;~1;~40;~5~]~$\ocwbc{} ubhaya \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~[~43;~1;~32;~32;~5~]~$\ocwbc{} uttara \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~[~43;~1;~32;~36;~1~]~$\ocwbc{} antara \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~43;~1;~35;~1~]~$\ocwbc{} adhara \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~43;~1;~37~]~$\ocwbc{} para \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~43;~1;~37;~1~]~$\ocwbc{} apara \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~43;~1;~45;~1~]~$\ocwbc{} avara \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~45;~43;~1;~48~]~$\ocwbc{} sarva \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~45;~43;~6;~37~]~$\ocwbc{} puurva Whitney§524 \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~45;~46;~3;~45~]~$\ocwbc{} vizva \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~[~45;~48~]~$\ocwbc{} sva \ocwec{}~$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_pron\_a}~\ocwlowerid{g}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} g=Mas ou g=Neu \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pseudo\_nominal}~=~\ocwlowerid{pseudo\_nominal\_basis}~\ocwlowerid{stem}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{neu\_nom\_acc}~=~$\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~17~]~\rightarrow{}~$\ocwbc{} kim \ocwec{}~\ocwstring{"im"}\ocweol
\ocwindent{3.00em}
$\mid{}~[~42~]~$\ocwbc{} yad \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~[~43;~1;~32;~1;~17~]~$\ocwbc{} katara \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~41;~1;~32;~1;~17~]~$\ocwbc{} katama \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~43;~1;~32;~3~]~$\ocwbc{} itara \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~42;~36;~1~]~$\ocwbc{} anya \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~[~43;~1;~32;~1;~42;~36;~1~]~$\ocwbc{} anyatara \ocwec{}~$\rightarrow{}~$\ocwstring{"at"}~\ocwbc{} Whitney§523 \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwbc{} eka, ekatara, vizva, sva, sarva, ... \ocwec{}~\ocwstring{"am"}\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{phase}~=~$\ocwkw{if}~$\ocwlowerid{pseudo\_nominal}~$\ocwkw{then}~$\ocwupperid{Noun}~$\ocwkw{else}~$\ocwupperid{Pron}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwlowerid{phase}~\ocwlowerid{g}~$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"as"}~\ocwkw{else}~$\ocwlowerid{neu\_nom\_acc})$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"am"}~\ocwkw{else}~$\ocwlowerid{neu\_nom\_acc})$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ena"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"asmai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"asmaat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"asya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"asmin"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{pseudo\_nominal}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aat"}~::~$[~\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"e"}~::~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"a"}~::~$\ocwlowerid{l}~]~]~]~$\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"au"}~\ocwkw{else}~\ocwstring{"e"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"au"}~\ocwkw{else}~\ocwstring{"e"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{pseudo\_nominal}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"au"}~\ocwkw{else}~\ocwstring{"e"}$)~::~\ocwlowerid{l}~]~$\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"e"}~\ocwkw{else}~\ocwstring{"aani"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"aan"}~\ocwkw{else}~\ocwstring{"aani"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ais"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"e.saam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"e.su"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{pseudo\_nominal}~$\ocwkw{then}~\ocweol
\ocwindent{8.00em}
\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aas"}~::~$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aas"}~::~$\ocwlowerid{l}~]~]$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~\ocwbc{} g=Neu \ocwec{}~$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aani"}~::~$\ocwlowerid{l}~]~$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
$]~]~@~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Neu}~$\ocwkw{then}~\ocweol
\ocwindent{6.50em}
\ocwkw{let}~$\ocwlowerid{iic}~=~$\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}~\ocweol
\ocwindent{11.50em}
$[~[~17~]~$\ocwbc{} kim \ocwec{}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"kim"}\ocweol
\ocwindent{11.50em}
$\mid{}~[~42~]~$\ocwbc{} yad \ocwec{}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"yat"}\ocweol
\ocwindent{11.50em}
$\mid{}~[~42;~36;~1~]~$\ocwbc{} anyad \ocwec{}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"anyat"}\ocweol
\ocwindent{11.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{mirror}~[~1~::~\ocwlowerid{stem}~]$\ocweol
\ocwindent{11.50em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{6.50em}
$[~\ocwupperid{Bare}~\ocwlowerid{phase}~\ocwlowerid{iic}~]$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~\land{}~\ocwlowerid{stem}~=~[~42;~36;~1~]~$\ocwbc{} anya \ocwec{}~\ocweol
\ocwindent{7.50em}
\ocwkw{then}~$[~\ocwupperid{Bare}~\ocwlowerid{phase}~(\ocwlowerid{code}~$\ocwstring{"anya"}$)~]~$\ocwbc{} optional anya- \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{pseudo\_nominal}~\land{}~\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocweol
\ocwindent{9.00em}
$[~\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"am"}$);~\ocwupperid{Avyayaf}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"aat"}$)~]$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$[\,])$\ocweol
\ocwindent{3.50em}
@~$($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{11.50em}
$[~$\ocwstring{"eka"}~$\rightarrow{}~[~\ocwupperid{Cvi}~(\ocwlowerid{code}~$\ocwstring{"ekii"}$)~]~$\ocweol
\ocwindent{11.50em}
$\mid{}~$\ocwstring{"sva"}~$\rightarrow{}~[~\ocwupperid{Cvi}~(\ocwlowerid{code}~$\ocwstring{"svii"}$)~]~$\ocweol
\ocwindent{11.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[\,]~$\ocweol
\ocwindent{11.50em}
$]$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$[\,]~))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_saa}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Pron}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"saa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"tayaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"tasyai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tasyaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tatas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tasyaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tasyaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"te"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"te"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"taabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"taabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"taabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tatas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"taas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"taas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"taabhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"taabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"taabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tatas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"taasaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"taasu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_syaa}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Pron}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"syaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"tyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"tyayaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"tyasyai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tyasyaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tyatyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tyasyaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tyasyaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"tye"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"tye"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"tyaabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"tyaabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tyaabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tyatyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tyayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tyayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"tyaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"tyaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"tyaabhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"tyaabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tyaabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tyatas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tyaasaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tyaasu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_pron\_aa}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pseudo\_nominal}~=~\ocwlowerid{pseudo\_nominal\_basis}~\ocwlowerid{stem}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Pron}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ayaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"asyai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"asyaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"asyaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"asyaam"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{pseudo\_nominal}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"e"}~::~$\ocwlowerid{l}~]~$\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{pseudo\_nominal}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"e"}~::~$\ocwlowerid{l}~]~$\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aasaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"aasu"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{pseudo\_nominal}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aas"}~::~$\ocwlowerid{l}~]~$\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_ayam\_idam}~\ocwlowerid{g}~=~$\ocwbc{} g=Mas or Neu \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~$\ocwstring{"idam"}\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Pron}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{register}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"ayam"}~\ocwkw{else}~\ocwstring{"idam"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"imam"}~\ocwkw{else}~\ocwstring{"idam"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Ins}~$\ocwstring{"anena"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Dat}~$\ocwstring{"asmai"}~\ocwbc{} also \ocwstring{"atas"} \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Abl}~$\ocwstring{"asmaat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Gen}~$\ocwstring{"asya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Loc}~$\ocwstring{"asmin"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{register}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"imau"}~\ocwkw{else}~\ocwstring{"ime"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"imau"}~\ocwkw{else}~\ocwstring{"ime"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Ins}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Dat}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Abl}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Gen}~$\ocwstring{"anayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Loc}~$\ocwstring{"anayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{register}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"ime"}~\ocwkw{else}~\ocwstring{"imaani"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"imaan"}~\ocwkw{else}~\ocwstring{"imaani"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Ins}~$\ocwstring{"ebhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Dat}~$\ocwstring{"ebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Abl}~$\ocwstring{"ebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Gen}~$\ocwstring{"e.saam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Loc}~$\ocwstring{"e.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_iyam}~()~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~$\ocwstring{"idam"}\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Pron}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{register}~\ocwupperid{Nom}~$\ocwstring{"iyam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Acc}~$\ocwstring{"imaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Ins}~$\ocwstring{"anayaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Dat}~$\ocwstring{"asyai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Abl}~$\ocwstring{"asyaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Gen}~$\ocwstring{"asyaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Loc}~$\ocwstring{"asyaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{register}~\ocwupperid{Nom}~$\ocwstring{"ime"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Acc}~$\ocwstring{"ime"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Ins}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Dat}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Abl}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Gen}~$\ocwstring{"anayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Loc}~$\ocwstring{"anayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{register}~\ocwupperid{Nom}~$\ocwstring{"imaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Acc}~$\ocwstring{"imaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Ins}~$\ocwstring{"aabhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Dat}~$\ocwstring{"aabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Abl}~$\ocwstring{"aabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Gen}~$\ocwstring{"aasaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Loc}~$\ocwstring{"aasu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_asau\_adas}~\ocwlowerid{g}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~$\ocwstring{"adas"}\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Pron}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{accu}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{register}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"asau"}~\ocwkw{else}~\ocwstring{"adas"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"amum"}~\ocwkw{else}~\ocwstring{"adas"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Ins}~$\ocwstring{"amunaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Dat}~$\ocwstring{"amu.smai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Abl}~$\ocwstring{"amu.smaat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Gen}~$\ocwstring{"amu.sya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Loc}~$\ocwstring{"amu.smin"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~$[~\ocwlowerid{register}~\ocwupperid{Nom}~$\ocwstring{"asakau"}~::~$\ocwlowerid{accu}~]~$\ocweol
\ocwindent{13.50em}
\ocwbc{} Pan{7,2,107} with yaka.h/yakaa \ocwec{}~\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{accu})~$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{register}~\ocwupperid{Nom}~$\ocwstring{"amuu"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Acc}~$\ocwstring{"amuu"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Ins}~$\ocwstring{"amuubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Dat}~$\ocwstring{"amuubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Abl}~$\ocwstring{"amuubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Gen}~$\ocwstring{"amuyos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Loc}~$\ocwstring{"amuyos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{register}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"amii"}~\ocwkw{else}~\ocwstring{"amuuni"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Acc}~($\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Mas}~$\ocwkw{then}~\ocwstring{"amuun"}~\ocwkw{else}~\ocwstring{"amuuni"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Ins}~$\ocwstring{"amiibhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Dat}~$\ocwstring{"amiibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Abl}~$\ocwstring{"amiibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Gen}~$\ocwstring{"amii.saam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Loc}~$\ocwstring{"amii.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_asau\_f}~()~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~$\ocwstring{"adas"}~\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Pron}~\ocwupperid{Fem}~$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{register}~\ocwupperid{Nom}~$\ocwstring{"asau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Nom}~$\ocwstring{"asakau"}~\ocwbc{} Pan{7,2,107} with yaka.h/yakaa \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Acc}~$\ocwstring{"amuum"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Ins}~$\ocwstring{"amuyaa"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Dat}~$\ocwstring{"amu.syai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Abl}~$\ocwstring{"amu.syaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Gen}~$\ocwstring{"amu.syaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Loc}~$\ocwstring{"amu.syaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{register}~\ocwupperid{Nom}~$\ocwstring{"amuu"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Acc}~$\ocwstring{"amuu"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Ins}~$\ocwstring{"amuubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Dat}~$\ocwstring{"amuubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Abl}~$\ocwstring{"amuubhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Gen}~$\ocwstring{"amuyos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Loc}~$\ocwstring{"amuyos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{register}~\ocwupperid{Nom}~$\ocwstring{"amuus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Acc}~$\ocwstring{"amuus"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Ins}~$\ocwstring{"amuubhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Dat}~$\ocwstring{"amuubhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Abl}~$\ocwstring{"amuubhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Gen}~$\ocwstring{"amuu.saam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Loc}~$\ocwstring{"amuu.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_ena}~\ocwlowerid{g}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocwbc{} Whitney§500 \ocwec{}\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Pron}~\ocwlowerid{g}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{2.00em}
\ocwbc{} No nominative - anaphoric pronoun - in non accented position \ocwec{}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{register}~\ocwupperid{Acc}~($\ocwkw{match}~$\ocwlowerid{g}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~\ocwupperid{Mas}~\rightarrow{}~$\ocwstring{"enam"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"enat"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"enaam"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"Nouns"}$)$\ocweol
\ocwindent{6.00em}
$])$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Ins}~($\ocwkw{match}~$\ocwlowerid{g}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~\ocwupperid{Mas}~\rightarrow{}~$\ocwstring{"enena"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"enena"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"enayaa"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"Nouns"}$)$\ocweol
\ocwindent{6.00em}
$])$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{register}~\ocwupperid{Acc}~($\ocwkw{match}~$\ocwlowerid{g}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~\ocwupperid{Mas}~\rightarrow{}~$\ocwstring{"enau"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"ene"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"ene"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"Nouns"}$)$\ocweol
\ocwindent{6.00em}
$])$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Gen}~$\ocwstring{"enayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{register}~\ocwupperid{Loc}~$\ocwstring{"enayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{register}~\ocwupperid{Acc}~($\ocwkw{match}~$\ocwlowerid{g}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~\ocwupperid{Mas}~\rightarrow{}~$\ocwstring{"enaan"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"enaani"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"enaas"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"Nouns"}$)$\ocweol
\ocwindent{6.00em}
$])$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_aham}~()~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{form}~=~(\ocwlowerid{case},\ocwlowerid{code}~\ocwlowerid{form})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~$\ocwstring{"asmad"}~\ocwbc{} entry \ocwec{}\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Pron}~(\ocwupperid{Deictic}~\ocwupperid{Speaker})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aham"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"maam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"maa"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"mayaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"mahyam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"me"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"mat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"mattas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"mama"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"me"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"mayi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aavaam"}~\ocwbc{} Vedic \ocwstring{"aavam"} \Pan{7.2.88}  Burrow p267 \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aavaam"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"nau"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aavaabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aavaabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"nau"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aavaabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aavayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"nau"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"aavayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vayam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"asmaan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"nas"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"asmaabhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"asmabhyam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"nas"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"asmat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"asmattas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"asmaakam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"nas"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"asmaasu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Pron}~(\ocwlowerid{code}~$\ocwstring{"aham"}$)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Pron}~(\ocwlowerid{code}~$\ocwstring{"mat"}$)~$\ocwbc{} \Pan{7,2,98} when meaning is singular \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Pron}~(\ocwlowerid{code}~$\ocwstring{"asmat"}$)~$\ocwbc{} \Pan{7,2,98} when meaning is plural \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_tvad}~()~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{form}~=~(\ocwlowerid{case},\ocwlowerid{code}~\ocwlowerid{form})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~$\ocwstring{"yu.smad"}~\ocwbc{} entry \ocwec{}\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Pron}~(\ocwupperid{Deictic}~\ocwupperid{Listener})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"tvam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"tvaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"tvaa"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"tvayaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"tubhyam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"te"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tvat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"tvattas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"tava"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"te"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"tvayi"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"yuvaam"}~\ocwbc{} Vedic \ocwstring{"yuvam"} \Pan{7.2.88} Burrow p267 \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"yuvaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vaam"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"yuvaabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"yuvaabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vaam"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"yuvaabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"yuvayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"vaam"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"yuvayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"yuuyam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"yu.smaan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vas"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"yu.smaabhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"yu.smabhyam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"vas"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"yu.smat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"yu.smattas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"yu.smaakam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"vas"}~\ocwbc{} encl \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"yu.smaasu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Pron}~(\ocwlowerid{code}~$\ocwstring{"tvad"}$)~$\ocwbc{} \Pan{7,2,98} when meaning is singular \ocwec{}\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Pron}~(\ocwlowerid{code}~$\ocwstring{"yu.smat"}$)~$\ocwbc{} \Pan{7,2,98} when meaning is plural \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Numerals \ocwec{}\medskip

\label{nouns.ml:130880}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_dva}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~$\ocwstring{"dv"}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.00em}
$[~(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.00em}
$[~(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{code}~$\ocwstring{"dvaa"}$)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{code}~$\ocwstring{"dvi"}$)$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_tri}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{case},\ocwlowerid{fix}~(\ocwlowerid{revcode}~$\ocwstring{"tr"}$)~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinf}~\ocwlowerid{case}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{case},\ocwlowerid{fix}~(\ocwlowerid{revcode}~$\ocwstring{"tis"}$)~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ayas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ayas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iin"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ibhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ayaa.naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"i.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ii.ni"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ii.ni"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ii.ni"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ibhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ayaa.naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"i.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinf}~\ocwupperid{Voc}~$\ocwstring{"ras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinf}~\ocwupperid{Nom}~$\ocwstring{"ras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinf}~\ocwupperid{Acc}~$\ocwstring{"ras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinf}~\ocwupperid{Ins}~$\ocwstring{".rbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinf}~\ocwupperid{Dat}~$\ocwstring{".rbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinf}~\ocwupperid{Abl}~$\ocwstring{".rbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinf}~\ocwupperid{Gen}~$\ocwstring{".r.naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinf}~\ocwupperid{Loc}~$\ocwstring{".r.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{code}~$\ocwstring{"tri"}$)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{code}~$\ocwstring{"tis.r"}$)~$\ocwbc{} tis.rdhanva Whitney§482f \ocwec{}\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_catur}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{1.50em}
$(\ocwlowerid{case},\ocwlowerid{fix}~(\ocwlowerid{revcode}~$\ocwstring{"cat"}$)~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinf}~\ocwlowerid{case}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{1.50em}
$(\ocwlowerid{case},\ocwlowerid{fix}~(\ocwlowerid{revcode}~$\ocwstring{"catas"}$)~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vaaras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaaras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"uras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"urbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"urbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"urbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ur.naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ur.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"vaari"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"vaari"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"vaari"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"urbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"urbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"urbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ur.naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ur.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinf}~\ocwupperid{Voc}~$\ocwstring{"ras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinf}~\ocwupperid{Nom}~$\ocwstring{"ras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinf}~\ocwupperid{Acc}~$\ocwstring{"ras"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinf}~\ocwupperid{Ins}~$\ocwstring{".rbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinf}~\ocwupperid{Dat}~$\ocwstring{".rbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinf}~\ocwupperid{Abl}~$\ocwstring{".rbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinf}~\ocwupperid{Gen}~$\ocwstring{".r.naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinf}~\ocwupperid{Loc}~$\ocwstring{".r.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{code}~$\ocwstring{"catur"}$)$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avyayaf}~(\ocwlowerid{code}~$\ocwstring{"caturam"}$)$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_sat}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~$\ocwstring{".sa"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~(\ocwupperid{Deictic}~\ocwupperid{Numeral})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{".t"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{".t"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{".t"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{".dbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{".dbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{".dbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{".n.naam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{".tsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{code}~$\ocwstring{".sa.t"}$)$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} To verify: internal sandhi ought to allow formation of stem .sa.t \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Numerals 5, 7, 8, 9, 10, 11-19 
\ocweol
\label{nouns.ml:134809}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_num}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter}~\ocwlowerid{entry}~($\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwupperid{Noun}~(\ocwupperid{Deictic}~\ocwupperid{Numeral})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Dual},~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"a.s.tan"}~\ocwkw{then}~\ocweol
\ocwindent{6.00em}
\ocwbc{} remains of dual form 8 as a pair of 4 \ocwec{}\ocweol
\ocwindent{6.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"au"}\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"au"}\ocweol
\ocwindent{6.00em}
$]~$\ocwkw{else}~$[\,])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"a"}~\ocwbc{} plural although no proper plural form Whitney§483 \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"a"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"abhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"abhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"abhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aanaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"asu"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"a.s.tan"}~\ocwkw{then}~$\ocwlowerid{l}~@$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"aasu"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~1)~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Cvi}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~4)~$\ocweol
\ocwindent{1.50em}
$]~@~($\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"a.s.tan"}~\ocwkw{then}\ocweol
\ocwindent{5.50em}
$[~\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~2)~$\ocwbc{} a.s.taa \ocwec{}~$]~$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$[\,]))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_kati}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{case},\ocwlowerid{fix}~(\ocwlowerid{revcode}~$\ocwstring{"kat"}$)~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.50em}
$(~\ocwupperid{Declined}~\ocwupperid{Noun}~(\ocwupperid{Deictic}~\ocwupperid{Numeral})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ibhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iinaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"i.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
$)$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Here end the declension tables \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
The next two functions, as well as the special cases for -vas ought to
   disappear, when declension will be called with a fuller morphological tag, 
   and not just the gender 
\ocweol
\label{nouns.ml:136395}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pprvat}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"avat"}~$\mid{}~$\ocwstring{"aapnuvat"}~$\mid{}~$\ocwstring{"kurvat"}~$\mid{}~$\ocwstring{"jiivat"}~$\mid{}~$\ocwstring{"dhaavat"}~$\mid{}~$\ocwstring{"dhaavat\#1"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"dhaavat\#2"}~$\mid{}~$\ocwstring{"bhavat\#1"}~$\mid{}~$\ocwstring{"z.r.nvat"}~$\mid{}~$\ocwstring{"zaknuvat"}~$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pprmat}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"jamat"}~$\mid{}~$\ocwstring{"dyumat"}~$\mid{}~$\ocwstring{"bhaamat"}~$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} tad -> tat yad -> yat cid -> cit etc mais pas de visarga pour r ou s \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{terminal\_form}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~34~::~\ocwlowerid{w}~]~\rightarrow{}~[~32~::~\ocwlowerid{w}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{w}~\rightarrow{}~\ocwlowerid{w}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Big switch between paradigms. \ocwbegindcode{}$\ocwlowerid{e}:$\ocwbt{string}\ocwenddcode{} is the entry, \ocwbegindcode{}$\ocwlowerid{stem}:\ocwlowerid{word}$\ocwenddcode{} one of 
   its (reversed) stems, \ocwbegindcode{}$\ocwlowerid{d}:\ocwlowerid{declension\_class}$\ocwenddcode{} gives gender or indeclinable 
   \ocwbegindcode{}$\ocwlowerid{p}:$\ocwbt{string}\ocwenddcode{} provides morphology or is empty if not known \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_nouns\_stem\_form}~\ocwlowerid{e}~\ocwlowerid{stem}~\ocwlowerid{d}~\ocwlowerid{p}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~\ocwkw{match}~$\ocwlowerid{d}~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Gender}~\ocwlowerid{g}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{g}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Mas}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[~1~::~\ocwlowerid{r1}~]~$\ocwbc{} -a \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~17~]~$\ocwbc{} ka as mas stem of kim \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~17;~10~]~$\ocwbc{} eka \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~17;~10;~36;~1~]~$\ocwbc{} aneka \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~31;~3;~47;~17;~1;~34~]~$\ocwbc{} dak.si.na \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~41;~1;~32;~1;~17~]~$\ocwbc{} katama \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~41;~3;~22;~46;~1;~37~]~$\ocwbc{} pazcima \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~41;~10;~36~]~$\ocwbc{} nema Whitney§525c \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~42~]~$\ocwbc{} ya\#1 \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~42;~1;~40;~5~]~$\ocwbc{} ubhaya \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~42;~36;~1~]~$\ocwbc{} anya \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~1;~17~]~$\ocwbc{} katara \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~1;~17;~10~]~$\ocwbc{} ekatara \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~3~]~$\ocwbc{} itara \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~1;~42;~36;~1~]~$\ocwbc{} anyatara \ocwec{}~\ocwbc{} Whitney§523 \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~32;~5~]~$\ocwbc{} uttara \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~36;~1~]~$\ocwbc{} antara \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~35;~1~]~$\ocwbc{} adhara \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~37~]~$\ocwbc{} para \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~37;~1~]~$\ocwbc{} apara \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~45;~1~]~$\ocwbc{} avara \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~45;~43;~1;~48~]~$\ocwbc{} sarva \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~45;~43;~6;~37~]~$\ocwbc{} puurva \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~45;~46;~3;~45~]~$\ocwbc{} vizva \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~45;~48~]~$\ocwbc{} sva \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_pron\_a}~\ocwupperid{Mas}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~36;~10~]~$\ocwbc{} ena \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_ena}~\ocwupperid{Mas}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~47;~10~]~$\ocwbc{} e.sa \ocwec{}~\ocwkw{when}~$(\ocwlowerid{e}=$\ocwstring{"etad"}~$\lor{}~\ocwlowerid{e}=$\ocwstring{"e.sa\#1"}~$\lor{}~\ocwlowerid{e}=$\ocwstring{"e.sa"}$)$\ocweol
\ocwindent{8.50em}
$\rightarrow{}~\ocwlowerid{build\_sa\_tad}~\ocwupperid{Mas}~[~10~]~\ocwlowerid{e}~$\ocweol
\ocwindent{6.00em}
$\mid{}~[~48~]~$\ocwbc{} sa \ocwec{}~\ocwkw{when}~$(\ocwlowerid{e}=$\ocwstring{"tad"}~$\lor{}~\ocwlowerid{e}=$\ocwstring{"sa\#2"}~$\lor{}~\ocwlowerid{e}=$\ocwstring{"sa"}$)$\ocweol
\ocwindent{8.50em}
$\rightarrow{}~\ocwlowerid{build\_sa\_tad}~\ocwupperid{Mas}~[\,]~\ocwlowerid{e}~$\ocweol
\ocwindent{6.00em}
$\mid{}~[~42;~48~]~$\ocwbc{} sya \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_sya\_tyad}~\ocwupperid{Mas}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~41;~12;~44;~5;~29;~13~]~$\ocwbc{} au.duloma \ocwec{}~$\rightarrow{}~$\ocwbc{} Kale 26 \ocwec{}\ocweol
\ocwindent{7.00em}
\ocwkw{let}~$\ocwlowerid{ps}~=~\ocwlowerid{revcode}~$\ocwstring{"u.duloma"}~\ocwkw{in}~$\ocwlowerid{build\_auduloma}~\ocwupperid{Mas}~\ocwlowerid{r1}~\ocwlowerid{ps}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_mas\_a}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~2~::~\ocwlowerid{r1}~]~$\ocwbc{} -aa - rare \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~[~19~::~[~1~::~[~41~::~[~2~::~[~48~]~]~]~]~]~$\ocwbc{} saamagaa \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~[~28~::~[~47~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -.s.thaa savya.s.thaa \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~[~33~::~[~48~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -sthaa (?) \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~[~34~::~\ocwlowerid{\_}~]~$\ocwbc{} -daa yazodaa \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~[~35~::~\ocwlowerid{\_}~]~$\ocwbc{} -dhaa yazodhaa \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~[~37~::~\ocwlowerid{\_}~]~$\ocwbc{} -paa gopaa vizvapaa dhenupaa somapaa etc Kale \ocwec{}~\ocweol
\ocwindent{5.00em}
$\mid{}~[~40~::~\ocwlowerid{\_}~]~$\ocwbc{} vibhaa2 \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~[~41~::~\ocwlowerid{\_}~]~$\ocwbc{} pratimaa and -dhmaa:
                           pa.nidhmaa zafkhadhmaa mukhadhmaa agnidhmaa \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~[~42~::~[~14~::~\ocwlowerid{\_}~]~]~$\ocwbc{} zubha.myaa \ocwec{}~\ocweol
\ocwindent{5.00em}
$\mid{}~[~43~::~[~17~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -kraa dadhikraa \ocwec{}~\ocweol
\ocwindent{5.00em}
$\mid{}~[~43~]~$\ocwbc{} raa2 \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_mono\_aa}~\ocwupperid{Mas}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocweol
\ocwindent{5.00em}
$\mid{}~[~49;~2;~49~]~$\ocwbc{} haahaa \ocwec{}~\ocweol
\ocwindent{5.00em}
$\mid{}~[~31;~2;~43~]~$\ocwbc{} raa.naa \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_mas\_aa\_no\_root}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwlowerid{g}~$\ocwbc{} monitoring \ocwec{}\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~3~::~\ocwlowerid{r1}~]~$\ocwbc{} -i \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{e}~$\ocwkw{with}~\ocweol
\ocwindent{5.00em}
$[~$\ocwstring{"sakhi"}~$\rightarrow{}~\ocwlowerid{build\_sakhi}~\ocwlowerid{r1}~\ocwlowerid{e}~\ocwupperid{True}$\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"pati"}~$\rightarrow{}~$\ocwbc{} \Pan{I.4.8,9} optional ghi \ocwec{}\ocweol
\ocwindent{11.00em}
\ocwkw{do}~\{~$\ocwlowerid{build\_sakhi}~\ocwlowerid{r1}~\ocwlowerid{e}~\ocwupperid{False};~\ocwlowerid{build\_mas\_i}~\ocwlowerid{stem}~\ocwlowerid{r1}~\ocwlowerid{e}~\}$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_mas\_i}~\ocwlowerid{stem}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocwbc{} agni, etc (ghi) \ocwec{}~\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~4~::~\ocwlowerid{r1}~]~$\ocwbc{} -ii - rare \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{monosyl}~\ocwlowerid{r1}~\lor{}~\ocwlowerid{compound\_monosyl\_ii}~\ocwlowerid{r1}~$\ocwkw{then}~$\ocwlowerid{build\_mono\_ii}~\ocwupperid{Mas}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{build\_poly\_ii}~\ocwupperid{Mas}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocwbc{} rathii sudhii \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~5~::~\ocwlowerid{r1}~]~$\ocwbc{} -u \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~[~27;~47;~12;~43;~17~]~\rightarrow{}~\ocwlowerid{build\_krostu}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocwbc{} = kro.s.t.r \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_mas\_u}~\ocwlowerid{stem}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocwbc{} vaayu, etc (ghi) \ocwec{}~\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~6;~49;~6;~49~]~$\ocwbc{} huuhuu \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_huuhuu}~\ocwlowerid{e}~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~6~::~\ocwlowerid{r1}~]~$\ocwbc{} -uu - rare \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{monosyl}~\ocwlowerid{r1}~$\ocwkw{then}~$\ocwlowerid{build\_mono\_uu}~\ocwupperid{Mas}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocwbc{} puu2 \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{build\_poly\_uu}~\ocwupperid{Mas}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocwbc{} sarvatanuu \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwbc{} vedic polysyllabic in uu are of utmost rarity - Whitney §355 \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~7~::~\ocwlowerid{r1}~]~$\ocwbc{} -.r \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~[~27;~47;~12;~43;~17~]~\rightarrow{}~\ocwlowerid{build\_krostu}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocwbc{} kro.s.t.r Muller §236 \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~[~32~::~\ocwlowerid{r2}~]~$\ocwbc{} -t.r \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~[~3;~37~]~$\ocwbc{} pit.r \ocwec{}~\ocwbc{} relationships McDonell §101 \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~[~2;~41;~2;~24~]~$\ocwbc{} jaamaat.r \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~[~36;~1;~42;~1;~37;~3~]~$\ocwbc{} upayant.r \ocwec{}~\ocweol
\ocwindent{7.50em}
$\mid{}~[~2;~43;~40~]~$\ocwbc{} bhraat.r \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_mas\_ri\_g}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
\ocwbc{} napt.r bhart.r pari.net.r - parenthood exceptions, follow: \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwbc{} dhaat.r general agent paradigm \ocwec{}~$\ocwlowerid{build\_mas\_ri\_v}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{5.00em}
$\mid{}~[~36~]~$\ocwbc{} n.r \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_nri}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_mas\_ri\_v}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~8~::~\ocwlowerid{\_}~]~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~9~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwlowerid{g}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~10~::~\ocwlowerid{r1}~]~$\ocwbc{} -e \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_e}~\ocwupperid{Mas}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocwbc{} apte (?) \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~11~::~\ocwlowerid{r1}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~43~]~$\ocwbc{} rai \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_rai}~\ocwupperid{Mas}~[~2;~43~]~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwlowerid{g}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~12~::~\ocwlowerid{r1}~]~$\ocwbc{} -o \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_o}~\ocwupperid{Mas}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~13~::~\ocwlowerid{r1}~]~$\ocwbc{} -au \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~48;~1~]~$\ocwbc{} asau \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_asau\_adas}~\ocwupperid{Mas}~$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_au}~\ocwupperid{Mas}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~22~::~\ocwlowerid{r1}~]~$\ocwbc{} -c \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~1~::~\ocwlowerid{r2}~]~$\ocwbc{} -ac \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{8.50em}
$[~[\,]~\rightarrow{}~()~$\ocwbc{} ac utilisé seulement avec px \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[~42~::~\ocwlowerid{r3}~]~$\ocwbc{} yac \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_mas\_yac}~\ocwlowerid{r3}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
$\mid{}~[~45~::~\ocwlowerid{r3}~]~$\ocwbc{} vac \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_mas\_vac}~\ocwlowerid{r3}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
$\mid{}~\ocwlowerid{\_}~$\ocwbc{} udac ... \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_mas\_ac}~\ocwlowerid{r2}~\ocwlowerid{e}~$\ocweol
\ocwindent{8.50em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~[~2~::~\ocwlowerid{r2}~]~$\ocwbc{} -aac \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{8.50em}
$[~[~37;~1~]~$\ocwbc{} apa-ac \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[~42;~48;~1;~17~]~$\ocwbc{} kasya-ac \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[~43;~1;~37~]~$\ocwbc{} para-ac \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[~43;~37~]~$\ocwbc{} pra-ac \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[~45;~1~]~$\ocwbc{} ava-ac \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[~45;~34;~1;~10;~34~]~$\ocwbc{} devadra-ac \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[~45;~43;~1~]~$\ocwbc{} arva-ac \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[~45;~43;~1;~48~]~$\ocwbc{} sarva-ac \ocwec{}\ocweol
\ocwindent{9.50em}
$\rightarrow{}~\ocwlowerid{build\_mas\_aac}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Mas}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
$]$\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Mas}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~24~::~\ocwlowerid{r1}~]~$\ocwbc{} -j \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}~\ocwbc{} m.rjify \ocwec{}\ocweol
\ocwindent{6.00em}
$[~[~2~::~[~43~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -raaj2 viraaj2 \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~2~::~[~42~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -yaaj2 \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~7;~48~]~$\ocwbc{} s.rj2 \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Mas}~[~124~$\ocwbc{} j' \ocwec{}~::~$\ocwlowerid{r1}~]~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~5;~42~]~$\ocwbc{} yuj2 \ocwec{}~$\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{8.00em}
\{~$\ocwlowerid{build\_root}~\ocwupperid{Mas}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{build\_archaic\_yuj}~[~24;~26;~5;~42~]~$\ocwbc{} yu~nj \ocwec{}~$\ocwupperid{Mas}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Mas}~\ocwlowerid{stem}~\ocwlowerid{e}~$\ocweol
\ocwindent{6.00em}
$]~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~32~::~\ocwlowerid{r1}~]~$\ocwbc{} -t \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~1~::~\ocwlowerid{r2}~]~$\ocwbc{} -at \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{is\_redup}~\ocwlowerid{r2}~$\ocwkw{then}~$\ocwlowerid{build\_mas\_red}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{19.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{8.50em}
$[~[~41~::~\ocwlowerid{r3}~]~$\ocwbc{} -mat \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{9.50em}
\ocwkw{if}~$\ocwlowerid{p}=$\ocwstring{"Ppra"}~$\lor{}~\ocwlowerid{pprmat}~\ocwlowerid{e}~$\ocwkw{then}~$\ocwlowerid{build\_mas\_at}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{21.50em}
\ocwkw{else}~$\ocwlowerid{build\_mas\_mat}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{9.50em}
\ocwbc{} Whitney§451 : yat iyat kiyat \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[~42~]~\mid{}~[~42;~3~]~\mid{}~[~42;~3;~17~]~\rightarrow{}~$\ocweol
\ocwindent{9.50em}
\ocwkw{if}~$\ocwlowerid{p}=$\ocwstring{"Ppra"}~\ocwkw{then}~$\ocwlowerid{build\_mas\_at}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocwbc{} yat2 \ocwec{}\ocweol
\ocwindent{9.50em}
\ocwkw{else}~$\ocwlowerid{build\_mas\_mat}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
$\mid{}~[~45~::~\ocwlowerid{r3}~]~$\ocwbc{} -vat \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{9.50em}
\ocwkw{if}~$\ocwlowerid{p}=$\ocwstring{"Ppra"}~$\lor{}~\ocwlowerid{pprvat}~\ocwlowerid{e}~$\ocwkw{then}~$\ocwlowerid{build\_mas\_at}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{21.50em}
\ocwkw{else}~$\ocwlowerid{build\_mas\_mat}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
$\mid{}~[~49~::~[~1~::~[~41~::~\ocwlowerid{\_}~]~]~]~$\ocwbc{} mahat, sumahat \ocwec{}~\ocweol
\ocwindent{13.00em}
$\rightarrow{}~\ocwlowerid{build\_mas\_mahat}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
$\mid{}~[~34~]~$\ocwbc{} dat \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root\_weak}~\ocwupperid{Mas}~\ocwlowerid{stem}~$\ocwstring{"danta"}~\ocweol
\ocwindent{8.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_mas\_at}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
$]~$\ocweol
\ocwindent{6.00em}
$\mid{}~[~2~::~\ocwlowerid{r2}~]~$\ocwbc{} -aat \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{8.50em}
$[~[~37;~1;~36~]~$\ocwbc{} vedic napaat \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Mas}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_mas\_at}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocwbc{} ppr in aat/aant ? \ocwec{}\ocweol
\ocwindent{8.50em}
$]~$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Mas}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~34~::~\ocwlowerid{r1}~]~$\ocwbc{} -d \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~[~1;~37~]~$\ocwbc{} pad \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root\_weak}~\ocwupperid{Mas}~\ocwlowerid{stem}~$\ocwstring{"paada"}\ocweol
\ocwindent{5.00em}
$\mid{}~[~1~::~[~37~::~\ocwlowerid{s}~]~]~$\ocwbc{} -pad \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_pad}~\ocwupperid{Mas}~\ocwlowerid{s}~\ocwlowerid{e}$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Mas}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~36~::~\ocwlowerid{r1}~]~$\ocwbc{} -n \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~1~::~\ocwlowerid{r2}~]~$\ocwbc{} -an \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~[~47~::~[~6~::~[~37~]~]~]~$\ocwbc{} puu.san \ocwec{}~\ocweol
\ocwindent{9.50em}
$\rightarrow{}~\ocwlowerid{build\_an\_god}~\ocwlowerid{r2}~\ocwlowerid{e}~$\ocwbc{} Whitney §426a \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~[~41~::~\ocwlowerid{r3}~]~$\ocwbc{} -man \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r3}~$\ocwkw{with}\ocweol
\ocwindent{10.50em}
$[~[~1~::~[~42~::~[~43~::~[~1~]~]~]~]~$\ocwbc{} aryaman \ocwec{}\ocweol
\ocwindent{12.50em}
$\rightarrow{}~\ocwlowerid{build\_man\_god}~\ocwlowerid{r3}~\ocwlowerid{e}~$\ocwbc{} Whitney §426a \ocwec{}\ocweol
\ocwindent{10.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_man}~\ocwupperid{Mas}~\ocwlowerid{r3}~\ocwlowerid{e}$\ocweol
\ocwindent{10.50em}
$]$\ocweol
\ocwindent{7.50em}
$\mid{}~[~45~::~([~46~::~\ocwlowerid{\_}~]~$\ocwkw{as}~$\ocwlowerid{r3})~]~$\ocwbc{} -zvan \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_mas\_zvan}~\ocwlowerid{r3}~\ocwlowerid{e}$\ocweol
\ocwindent{23.50em}
\ocwbc{} takes care of eg dharmazvan \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~[~45~::~\ocwlowerid{r3}~]~$\ocwbc{} -van \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{e}~$\ocwkw{with}\ocweol
\ocwindent{9.00em}
$[~$\ocwstring{"yuvan"}~$\rightarrow{}~\ocwlowerid{build\_mas\_yuvan}~\ocwlowerid{e}$\ocweol
\ocwindent{9.00em}
$\mid{}~$\ocwstring{"maghavat"}~$\mid{}~$\ocwstring{"maghavan"}~$\rightarrow{}~\ocwlowerid{build\_mas\_maghavan}~\ocwlowerid{e}~$\ocweol
\ocwindent{11.00em}
\ocwbc{} NB: entry is maghavat but interface allows maghavan \ocwec{}\ocweol
\ocwindent{9.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_van}~\ocwupperid{Mas}~\ocwlowerid{r3}~\ocwlowerid{e}$\ocweol
\ocwindent{9.00em}
$]$\ocweol
\ocwindent{7.50em}
$\mid{}~[~49~::~\ocwlowerid{r3}~]~$\ocwbc{} -han \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_han}~\ocwlowerid{r3}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_an}~\ocwupperid{Mas}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~[~3~::~\ocwlowerid{r2}~]~$\ocwbc{} -in \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~[~33~::~\ocwlowerid{r3}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r3}~$\ocwkw{with}\ocweol
\ocwindent{9.00em}
$[~[~1~::~[~37~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -pathin \ocwec{}~\ocwbc{} \Pan{7,1,85} \ocwec{}\ocweol
\ocwindent{9.00em}
$\mid{}~[~1~::~[~41~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -mathin \ocwec{}~\ocweol
\ocwindent{10.50em}
$\rightarrow{}~\ocwlowerid{build\_athin}~\ocwlowerid{r3}~\ocwlowerid{e}$\ocweol
\ocwindent{9.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_mas\_in}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{9.00em}
$]$\ocweol
\ocwindent{7.50em}
$\mid{}~[~47;~17;~5;~40;~7~]~$\ocwbc{} -.rbhuk.sin \ocwec{}~\ocwbc{} \Pan{7,1,85} \ocwec{}\ocweol
\ocwindent{9.50em}
$\rightarrow{}~\ocwlowerid{build\_ribhuksin}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_mas\_in}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
$]~$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwlowerid{g}$\ocweol
\ocwindent{6.00em}
$]~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~37~::~[~1~::~[~48~::~\ocwlowerid{r}~]~]~]~$\ocwbc{} -sap \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_sap}~\ocwupperid{Mas}~\ocwlowerid{r}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~41~::~\ocwlowerid{r1}~]~$\ocwbc{} -m \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~[~1;~42;~1~]~$\ocwbc{} ayam \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_ayam\_idam}~\ocwupperid{Mas}~$\ocweol
\ocwindent{5.50em}
$\mid{}~[~1;~34~]~$\ocwbc{} dam2 \ocwec{}~$\rightarrow{}~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{build\_dam}~\ocwlowerid{e}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{8.50em}
$()~$\ocwbc{} skipped - only gen. vedic forms except dam-pati \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root\_m}~\ocwupperid{Mas}~\ocwlowerid{r1}~\ocwlowerid{stem}~\ocwlowerid{e}~$\ocwbc{} was report stem g \ocwec{}\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~45~::~\ocwlowerid{r1}~]~$\ocwbc{} -v \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~[~3;~34~]~$\ocwbc{} div \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_div}~\ocwupperid{Mas}~[~34~]~\ocwlowerid{e}$\ocweol
\ocwindent{5.50em}
$\mid{}~[~4;~34~]~$\ocwbc{} diiv \ocwec{}~$\rightarrow{}~()~$\ocwbc{} avoids reporting bahu \ocwec{}~\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwlowerid{g}$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~47~::~\ocwlowerid{r1}~]~$\ocwbc{} .s \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~3~::~\ocwlowerid{r2}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~[~45;~1;~19~]~$\ocwbc{} gavi.s \ocwec{}\ocweol
\ocwindent{8.00em}
$\mid{}~[~45;~34~]~$\ocwbc{} dvi.s \ocwec{}\ocweol
\ocwindent{8.00em}
$\mid{}~[~45;~34;~3;~45~]~$\ocwbc{} vidvi.s \ocwec{}\ocweol
\ocwindent{8.00em}
$\mid{}~[~45;~34;~1;~32;~1;~49~]~$\ocwbc{} hatadvi.s \ocwec{}\ocweol
\ocwindent{8.00em}
$\mid{}~[~28;~1;~37;~3;~37~]~$\ocwbc{} pipa.thi.s \ocwec{}\ocweol
\ocwindent{10.00em}
$\rightarrow{}~\ocwlowerid{build\_is}~\ocwupperid{Mas}~\ocwlowerid{r2}~\ocwlowerid{e}~$\ocwbc{} Kale §114 \ocwec{}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Mas}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~[~5~::~\ocwlowerid{r2}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~[~24~::~[~1~::~[~48~]~]~]~$\ocwbc{} saju.s \ocwec{}\ocweol
\ocwindent{10.00em}
$\rightarrow{}~\ocwlowerid{build\_us}~\ocwupperid{Mas}~\ocwlowerid{r2}~\ocwlowerid{e}~$\ocwbc{} Kale §114 \ocwec{}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Mas}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Mas}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~48~::~\ocwlowerid{r1}~]~$\ocwbc{} -s \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~1~::~\ocwlowerid{r2}~]~$\ocwbc{} -as \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~[~42~::~\ocwlowerid{\_}~]~$\ocwbc{} -yas \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_mas\_yas}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
$\mid{}~[~45~::~\ocwlowerid{r3}~]~$\ocwbc{} -vas \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{8.50em}
\ocwkw{if}~$\ocwlowerid{p}~=~$\ocwstring{"Ppfta"}~\ocwkw{then}~$\ocwlowerid{build\_mas\_vas}~\ocwlowerid{r3}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{r3}~$\ocwkw{with}~\ocweol
\ocwindent{9.50em}
$[~[~1~::~[~43~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -ravas \ocwec{}~\ocweol
\ocwindent{9.50em}
$\mid{}~[~5~::~[~48~::~\ocwlowerid{\_}~]~]~$\ocwbc{} - suvas \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_as}~\ocwupperid{Mas}~\ocwlowerid{r2}~\ocwlowerid{e}~$\ocweol
\ocwindent{10.50em}
\ocwbc{} uccaisravas, puruuravas, ugrazravas, vizravas non ppf \ocwec{}\ocweol
\ocwindent{9.50em}
$\mid{}~[~3~::~\ocwlowerid{r4}~]~$\ocwbc{} -ivas \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_mas\_ivas}~\ocwlowerid{r4}~\ocwlowerid{e}$\ocweol
\ocwindent{9.50em}
$\mid{}~[~35~::~\ocwlowerid{\_}~]~$\ocwbc{} -dhvas \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Mas}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{9.50em}
$\mid{}~\ocwlowerid{\_}~$\ocwbc{} other ppf \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_mas\_vas}~\ocwlowerid{r3}~\ocwlowerid{e}$\ocweol
\ocwindent{9.50em}
$]$\ocweol
\ocwindent{7.50em}
$\mid{}~[~43~::~[~48~::~\ocwlowerid{\_}~]]~$\ocwbc{} -sras \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Mas}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{0.00em}
\ocwbc{}             | \ocwbegindcode{}[~46;~1;~33;~17;~5~]~$(\times{}~\ocwlowerid{ukthazas}~\times{})~\rightarrow{}~\ocwlowerid{build\_ukthazas}~\ocwupperid{Mas}~\ocwlowerid{e}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}             | \ocwbegindcode{}[~46~::~$\ocwlowerid{\_}~]~(\times{}~-\ocwlowerid{zas}~\times{})~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Mas}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_as}~\ocwupperid{Mas}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
$]~$\ocweol
\ocwindent{6.00em}
$\mid{}~[~2;~41~]~$\ocwbc{} maas \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_maas}~()$\ocweol
\ocwindent{6.00em}
$\mid{}~[~2~::~\ocwlowerid{\_}~]~$\ocwbc{} -aas \ocwec{}~$\rightarrow{}~()~$\ocwbc{} avoids reporting bahu aas bhaas \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~3~::~\ocwlowerid{r2}~]~$\ocwbc{} -is \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_is}~\ocwupperid{Mas}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~5~::~\ocwlowerid{r2}~]~$\ocwbc{} -us \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_us}~\ocwupperid{Mas}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~12;~34~]~$\ocwbc{} dos \ocwec{}~$\rightarrow{}~()~$\ocwbc{} avoids reporting bahu \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~14;~5;~37~]~$\ocwbc{} pu.ms \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_pums}~[~41;~5;~37~]~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~14;~5;~37;~1;~36~]~$\ocwbc{} napu.ms \ocwec{}~\ocweol
\ocwindent{7.00em}
$\rightarrow{}~\ocwlowerid{build\_pums}~[~41;~5;~37;~1;~36~]~\ocwlowerid{stem}~\ocwlowerid{e}~$\ocweol
\ocwindent{6.00em}
$\mid{}~[~14;~2;~41~]~$\ocwbc{} maa.ms \ocwec{}~$\rightarrow{}~()~$\ocwbc{} avoids reporting bahu \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwlowerid{g}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~49~::~\ocwlowerid{r1}~]~$\ocwbc{} -h \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~1~::~[~45~::~\ocwlowerid{r3}~]~]~$\ocwbc{} vah2 \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{e}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~$\ocwstring{"ana.dvah"}~$\rightarrow{}~\ocwlowerid{build\_anadvah}~\ocwlowerid{r3}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_mas\_vah}~\ocwlowerid{r3}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~[~1;~34~]~$\ocwbc{} dah2 \ocwec{}~\ocwbc{} mandatory duhify \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~5;~34~]~$\ocwbc{} duh2 \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Mas}~[~149~$\ocwbc{} h' \ocwec{}~::~$\ocwlowerid{r1}~]~\ocwlowerid{e}~$\ocweol
\ocwindent{6.00em}
$\mid{}~[~3~::~[~36~::~[~48~::~\ocwlowerid{\_}~]~]~]~$\ocwbc{} -snih2 \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~5~::~[~36~::~[~48~::~\ocwlowerid{\_}~]~]~]~$\ocwbc{} -snuh2 \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~5~::~[~43~::~[~34~::~\ocwlowerid{\_}~]~]~]~$\ocwbc{} -druh2 \ocwec{}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{8.00em}
\{~$\ocwlowerid{build\_root}~\ocwupperid{Mas}~[~149~$\ocwbc{} h' \ocwec{}~::~$\ocwlowerid{r1}~]~\ocwlowerid{e}~$\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{build\_root}~\ocwupperid{Mas}~\ocwlowerid{stem}~\ocwlowerid{e}~$\ocwbc{} optionally duhify \ocwec{}\ocweol
\ocwindent{8.00em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Mas}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Mas}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[~1~::~\ocwlowerid{r1}~]~$\ocwbc{} -a \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~17;~10~]~$\ocwbc{} eka \ocwec{}~\ocwbc{} pronouns \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~17;~10;~36;~1~]~$\ocwbc{} aneka \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~31;~3;~47;~17;~1;~34~]~$\ocwbc{} dak.si.na \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~41;~1;~32;~1;~17~]~$\ocwbc{} katama \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~41;~3;~22;~46;~1;~37~]~$\ocwbc{} pazcima \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~42;~1;~40;~5~]~$\ocwbc{} ubhaya \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~1;~17~]~$\ocwbc{} katara \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~1;~17;~10~]~$\ocwbc{} ekatara \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~3~]~$\ocwbc{} itara \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~32;~5~]~$\ocwbc{} uttara \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~36;~1~]~$\ocwbc{} antara \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~35;~1~]~$\ocwbc{} adhara \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~37~]~$\ocwbc{} para \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~37;~1~]~$\ocwbc{} apara \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~45;~1~]~$\ocwbc{} avara \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~45;~43;~6;~37~]~$\ocwbc{} puurva \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~45;~46;~3;~45~]~$\ocwbc{} vizva \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~45;~43;~1;~48~]~$\ocwbc{} sarva \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~45;~48~]~$\ocwbc{} sva \ocwec{}~\ocweol
\ocwindent{8.00em}
$\rightarrow{}~\ocwlowerid{build\_pron\_a}~\ocwupperid{Neu}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_neu\_a}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~2~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwupperid{Neu}~$\ocwbc{} (missing) ahigopaa raa vibhaa sthaa \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~3~::~\ocwlowerid{r1}~]~$\ocwbc{} -i \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~[~4~::~\ocwlowerid{r1}~]~$\ocwbc{} -ii - rare \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_neu\_i}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~5~::~\ocwlowerid{r1}~]~$\ocwbc{} -u \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~[~6~::~\ocwlowerid{r1}~]~$\ocwbc{} -uu - rare \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_neu\_u}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~7~::~\ocwlowerid{r1}~]~$\ocwbc{} -.r \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_neu\_ri}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~11;~43~]~$\ocwbc{} rai \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~[~12;~19~]~$\ocwbc{} go \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~[~13;~36~]~$\ocwbc{} nau \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~[~13;~44;~19~]~$\ocwbc{} glau \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~[~13;~48;~1~]~$\ocwbc{} asau \ocwec{}~$\rightarrow{}~()~$\ocwbc{} avoids reporting bahu \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~[~8~::~\ocwlowerid{\_}~]~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~9~::~\ocwlowerid{\_}~]~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~10~::~\ocwlowerid{\_}~]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~11~::~\ocwlowerid{\_}~]~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~12~::~\ocwlowerid{\_}~]~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~13~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwlowerid{g}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~22~::~\ocwlowerid{r1}~]~$\ocwbc{} -c \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~1~::~\ocwlowerid{r2}~]~$\ocwbc{} -ac \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{8.50em}
$[~[\,]~\rightarrow{}~()~$\ocwbc{} ac utilisé seulement avec px \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[~42~::~\ocwlowerid{r3}~]~\rightarrow{}~\ocwlowerid{build\_neu\_yac}~\ocwlowerid{r3}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
$\mid{}~[~45~::~\ocwlowerid{r3}~]~\rightarrow{}~\ocwlowerid{build\_neu\_vac}~\ocwlowerid{r3}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
$\mid{}~\ocwlowerid{\_}~$\ocwbc{} udac ... \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_neu\_ac}~\ocwlowerid{r2}~\ocwlowerid{e}~$\ocweol
\ocwindent{8.50em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~[~2~::~\ocwlowerid{\_}~]~$\ocwbc{} -aac \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_neu\_aac}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Neu}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~24~::~\ocwlowerid{r1}~]~$\ocwbc{} -j \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}~\ocwbc{} m.rjify \ocwec{}\ocweol
\ocwindent{6.00em}
$[~[~2~::~[~43~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -raaj2 viraaj2 \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~2~::~[~42~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -yaaj2 \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~7;~48~]~$\ocwbc{} s.rj2 \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Neu}~[~124~$\ocwbc{} j' \ocwec{}~::~$\ocwlowerid{r1}~]~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~5;~42~]~$\ocwbc{} yuj2 \ocwec{}~$\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{8.00em}
\{~$\ocwlowerid{build\_root}~\ocwupperid{Neu}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{build\_archaic\_yuj}~[~24;~26;~5;~42~]~$\ocwbc{} yu~nj \ocwec{}~$\ocwupperid{Neu}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Neu}~\ocwlowerid{stem}~\ocwlowerid{e}~$\ocweol
\ocwindent{6.00em}
$]~$\ocweol
\ocwindent{3.50em}
$\mid{}~[~32~::~\ocwlowerid{r1}~]~$\ocwbc{} -t \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~1~::~\ocwlowerid{r2}~]~$\ocwbc{} -at \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{is\_redup}~\ocwlowerid{r2}~$\ocwkw{then}~$\ocwlowerid{build\_neu\_red}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{19.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~[~49~::~[~1~::~[~41~::~\ocwlowerid{\_}~]~]~]~$\ocwbc{} mahat, sumahat \ocwec{}~\ocweol
\ocwindent{9.50em}
$\rightarrow{}~\ocwlowerid{build\_neu\_mahat}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_neu\_at}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocwbc{} e.g. jagat \ocwec{}\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~[~2~::~\ocwlowerid{r2}~]~$\ocwbc{} -aat \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_neu\_at}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocwbc{} ppr in aat/aant ? \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Neu}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~34~::~\ocwlowerid{r1}~]~$\ocwbc{} -d \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~[~1~::~\ocwlowerid{r2}~]~$\ocwbc{} -ad \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~32~]~$\ocwbc{} tad \ocwec{}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{8.50em}
\{~$\ocwlowerid{build\_sa\_tad}~\ocwupperid{Neu}~[\,]~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
;~$\ocwlowerid{enter}~\ocwlowerid{e}~[~\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{code}~$\ocwstring{"tat"}$)~]$\ocweol
\ocwindent{8.50em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~[~32;~10~]~$\ocwbc{} etad \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_sa\_tad}~\ocwupperid{Neu}~[~10~]~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~42;~32~]~$\ocwbc{} tyad \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_sya\_tyad}~\ocwupperid{Neu}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~36;~10~]~$\ocwbc{} enad \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_ena}~\ocwupperid{Neu}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~37~]~$\ocwbc{} pad \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root\_weak}~\ocwupperid{Neu}~\ocwlowerid{stem}~$\ocwstring{"paada"}\ocweol
\ocwindent{6.00em}
$\mid{}~[~37~::~\ocwlowerid{s}~]~$\ocwbc{} -pad \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_pad}~\ocwupperid{Neu}~\ocwlowerid{s}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~42~]~$\ocwbc{} yad \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~42;~36;~1~]~$\ocwbc{} anyad \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~1;~42;~36;~1~]~$\ocwbc{} anyatarad \ocwec{}~\ocwbc{} Whitney§523 \ocwec{}\ocweol
\ocwindent{8.00em}
$\rightarrow{}~\ocwlowerid{build\_pron\_a}~\ocwupperid{Neu}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Neu}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]~$\ocweol
\ocwindent{5.00em}
$\mid{}~[~7;~49~]~$\ocwbc{} h.rd \ocwec{}\ocweol
\ocwindent{7.00em}
$\rightarrow{}~\ocwlowerid{build\_root\_weak}~\ocwupperid{Neu}~\ocwlowerid{stem}~$\ocwstring{"h.rdaya"}~\ocwbc{} \Pan{6,1,63} Whitney§397 \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Neu}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~36~::~\ocwlowerid{r1}~]~$\ocwbc{} -n \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~1~::~\ocwlowerid{r2}~]~$\ocwbc{} -an \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~[~33;~17;~1;~48~]~$\ocwbc{} sakthan \ocwec{}~\ocweol
\ocwindent{7.50em}
$\mid{}~[~33;~48;~1~]~$\ocwbc{} asthan \ocwec{}~\ocweol
\ocwindent{7.50em}
$\mid{}~[~47;~17;~1~]~$\ocwbc{} ak.san \ocwec{}~\ocweol
\ocwindent{7.50em}
$\mid{}~[~35;~1;~34~]~$\ocwbc{} dadhan \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_aksan}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
$\mid{}~[~17;~1;~42~]~$\ocwbc{} yakan \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~[~17;~1;~46~]~$\ocwbc{} zakan \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~[~34;~5~]~$\ocwbc{} udan \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~[~47;~6;~42~]~$\ocwbc{} yuu.san \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~[~47;~12;~34~]~$\ocwbc{} do.san \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~[~48;~1~]~$\ocwbc{} asan \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~[~48;~2~]~$\ocwbc{} aasan \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_sp\_an}~\ocwlowerid{r2}~\ocwlowerid{e}~$\ocwbc{} Whitney §432 \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~[~35;~6~]~$\ocwbc{} uudhan \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_uudhan}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
$\mid{}~[~41~::~\ocwlowerid{r3}~]~$\ocwbc{} -man \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{e}~$\ocwkw{with}\ocweol
\ocwindent{9.00em}
$[~$\ocwstring{"brahman"}~$\rightarrow{}~\ocwlowerid{build\_neu\_brahman}~\ocwlowerid{e}$\ocweol
\ocwindent{9.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_man}~\ocwupperid{Neu}~\ocwlowerid{r3}~\ocwlowerid{e}$\ocweol
\ocwindent{9.00em}
$]$\ocweol
\ocwindent{7.50em}
$\mid{}~[~45~::~\ocwlowerid{r3}~]~$\ocwbc{} -van \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{e}~$\ocwkw{with}\ocweol
\ocwindent{9.00em}
$[~$\ocwstring{"yuvan"}~$\rightarrow{}~\ocwlowerid{build\_neu\_yuvan}~\ocwlowerid{e}$\ocweol
\ocwindent{9.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_van}~\ocwupperid{Neu}~\ocwlowerid{r3}~\ocwlowerid{e}$\ocweol
\ocwindent{9.00em}
$]$\ocweol
\ocwindent{7.50em}
$\mid{}~[~49~::~\ocwlowerid{r3}~]~$\ocwbc{} -han \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r3}~$\ocwkw{with}\ocweol
\ocwindent{9.00em}
$[~[~1~::~\ocwlowerid{\_}~]~$\ocwbc{} -ahan \ocwec{}~\ocweol
\ocwindent{9.00em}
$\mid{}~[~2;~42;~2;~48~]~$\ocwbc{} saayaahan \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_ahan}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{9.00em}
$\mid{}~\ocwlowerid{\_}~$\ocwbc{} -han2 \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_an}~\ocwupperid{Neu}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{9.00em}
$]$\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_an}~\ocwupperid{Neu}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~[~3~::~\ocwlowerid{r2}~]~$\ocwbc{} -in \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_neu\_in}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwlowerid{g}$\ocweol
\ocwindent{6.00em}
$]~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~37~::~[~1~::~[~48~::~\ocwlowerid{r}~]~]~]~$\ocwbc{} -sap \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_sap}~\ocwupperid{Neu}~\ocwlowerid{r}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~41~::~\ocwlowerid{r1}~]~$\ocwbc{} -m \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~[~1;~34;~3~]~$\ocwbc{} idam \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_ayam\_idam}~\ocwupperid{Neu}~$\ocweol
\ocwindent{5.50em}
$\mid{}~[~3;~17~]~$\ocwbc{} kim \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_pron\_a}~\ocwupperid{Neu}~[~17~]~\ocwlowerid{e}$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root\_m}~\ocwupperid{Neu}~\ocwlowerid{r1}~\ocwlowerid{stem}~\ocwlowerid{e}~$\ocwbc{} was report stem g \ocwec{}\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~45~::~\ocwlowerid{r1}~]~$\ocwbc{} -v \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~[~3;~34~]~$\ocwbc{} div \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_div}~\ocwupperid{Neu}~[~34~]~\ocwlowerid{e}$\ocweol
\ocwindent{5.50em}
$\mid{}~[~4;~34~]~$\ocwbc{} diiv \ocwec{}~$\rightarrow{}~()~$\ocwbc{} avoids reporting bahu \ocwec{}~\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwlowerid{g}$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~47~::~\ocwlowerid{r1}~]~$\ocwbc{} .s \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~3~::~\ocwlowerid{r2}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~[~45;~1;~19~]~$\ocwbc{} gavi.s \ocwec{}\ocweol
\ocwindent{8.00em}
$\mid{}~[~45;~34;~1;~32;~1;~49~]~$\ocwbc{} hatadvi.s \ocwec{}\ocweol
\ocwindent{8.00em}
$\mid{}~[~28;~1;~37;~3;~37~]~$\ocwbc{} pipa.thi.s \ocwec{}\ocweol
\ocwindent{10.00em}
$\rightarrow{}~\ocwlowerid{build\_is}~\ocwupperid{Neu}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Neu}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~[~5~::~\ocwlowerid{r2}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~[~24~::~[~1~::~[~48~]]]~$\ocwbc{} saju.s \ocwec{}\ocweol
\ocwindent{10.00em}
$\rightarrow{}~\ocwlowerid{build\_us}~\ocwupperid{Neu}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Neu}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Neu}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~48~::~\ocwlowerid{r1}~]~$\ocwbc{} -s \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~1~::~\ocwlowerid{r2}~]~$\ocwbc{} -as \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~[~34;~1~]~$\ocwbc{} adas \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_asau\_adas}~\ocwupperid{Neu}~$\ocweol
\ocwindent{7.50em}
$\mid{}~[~42~::~\ocwlowerid{\_}~]~$\ocwbc{} -yas \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_neu\_yas}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
$\mid{}~[~45~::~\ocwlowerid{r3}~]~$\ocwbc{} -vas \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{8.50em}
\ocwkw{if}~$\ocwlowerid{p}~=~$\ocwstring{"Ppfta"}~\ocwkw{then}~$\ocwlowerid{build\_neu\_vas}~\ocwlowerid{r3}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{r3}~$\ocwkw{with}~\ocweol
\ocwindent{8.50em}
$[~[~1~]~$\ocwbc{} avas1 - non ppf \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[~1~::~[~43~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -ravas eg zravas, sravas - non ppf \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[~5~::~[~48~::~\ocwlowerid{\_}~]~]~$\ocwbc{} - suvas \ocwec{}~\ocweol
\ocwindent{8.50em}
$\mid{}~[~3;~43;~1;~45~]~$\ocwbc{} varivas \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_as}~\ocwupperid{Neu}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
$\mid{}~[~3~::~\ocwlowerid{r4}~]~$\ocwbc{} ivas \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_neu\_ivas}~\ocwlowerid{r4}~\ocwlowerid{e}~$\ocweol
\ocwindent{8.50em}
$\mid{}~[~35~::~\ocwlowerid{\_}~]~$\ocwbc{} -dhvas \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Neu}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
$\mid{}~\ocwlowerid{\_}~$\ocwbc{} other ppf \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_neu\_vas}~\ocwlowerid{r3}~\ocwlowerid{e}~$\ocweol
\ocwindent{8.50em}
$]$\ocweol
\ocwindent{7.50em}
$\mid{}~[~43~::~[~48~::~\ocwlowerid{\_}~]]~$\ocwbc{} -sras \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Neu}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_as}~\ocwupperid{Neu}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~[~2~::~\ocwlowerid{r2}~]~$\ocwbc{} -aas \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{build\_neu\_aas}~\ocwlowerid{stem}~\ocwlowerid{e}~$\ocwbc{} aas3 irregular \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~[~17~]~$\ocwbc{} kaas2 \ocwec{}~\ocweol
\ocwindent{7.50em}
$\mid{}~[~41~]~$\ocwbc{} maas \ocwec{}~$\rightarrow{}~()~$\ocwbc{} avoids reporting bahu \ocwec{}~\ocweol
\ocwindent{7.50em}
$\mid{}~[~40~::~\ocwlowerid{\_}~]~$\ocwbc{} bhaas aabhaas \ocwec{}~$\rightarrow{}~()~$\ocwbc{} missing paradigm \ocwec{}~\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwupperid{Neu}$\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~[~3~::~\ocwlowerid{r2}~]~$\ocwbc{} -is \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_is}~\ocwupperid{Neu}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~5~::~\ocwlowerid{r2}~]~$\ocwbc{} -us \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_us}~\ocwupperid{Neu}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Neu}~\ocwlowerid{stem}~\ocwlowerid{e}~$\ocwbc{} dos \ocwec{}\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~49~::~\ocwlowerid{r1}~]~$\ocwbc{} -h \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~1;~34~]~$\ocwbc{} dah2 \ocwec{}~\ocwbc{} duhify \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~5;~43;~34~]~$\ocwbc{} druh2 \ocwec{}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{8.00em}
\{~$\ocwlowerid{build\_root}~\ocwupperid{Neu}~[~149~$\ocwbc{} h' \ocwec{}~::~$\ocwlowerid{r1}~]~\ocwlowerid{e}~$\ocwbc{} optionally duhify \ocwec{}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{build\_root}~\ocwupperid{Neu}~\ocwlowerid{stem}~\ocwlowerid{e}~$\ocweol
\ocwindent{8.00em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Neu}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Neu}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[~1~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwlowerid{g}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~2~::~\ocwlowerid{r1}~]~$\ocwbc{} -aa \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}~\ocweol
\ocwindent{12.00em}
$[~[~42~]~$\ocwbc{} yaa \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{e}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~$\ocwstring{"ya\#1"}~$\mid{}~$\ocwstring{"yad"}~$\mid{}~$\ocwstring{"yaa\#2"}~$\rightarrow{}~\ocwlowerid{build\_pron\_aa}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocwbc{} pn yaa\#2 \ocwec{}\ocweol
\ocwindent{8.00em}
$\mid{}~$\ocwstring{"ya\#2"}~$\mid{}~$\ocwstring{"yaa\#3"}~$\rightarrow{}~\ocwlowerid{build\_fem\_aa}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocwbc{} ifc. -yaa\#3 \ocwec{}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwlowerid{g}$\ocweol
\ocwindent{8.00em}
$]~$\ocweol
\ocwindent{6.00em}
$\mid{}~[~17~]~$\ocwbc{} kaa \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~17;~10~]~$\ocwbc{} ekaa \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~17;~10;~36;~1~]~$\ocwbc{} anekaa \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~31;~3;~47;~17;~1;~34~]~$\ocwbc{} dak.si.naa \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~41;~1;~32;~1;~17~]~$\ocwbc{} katamaa \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~41;~3;~22;~46;~1;~37~]~$\ocwbc{} pazcimaa \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~42;~36;~1~]~$\ocwbc{} anyaa \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~1;~17~]~$\ocwbc{} kataraa \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~1;~17;~10~]~$\ocwbc{} ekataraa \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~1;~42;~36;~1~]~$\ocwbc{} anyataraa \ocwec{}~\ocwbc{} Whitney§523 \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~3~]~$\ocwbc{} itaraa \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~32;~5~]~$\ocwbc{} uttaraa \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~32;~36;~1~]~$\ocwbc{} antaraa \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~35;~1~]~$\ocwbc{} adharaa \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~37~]~$\ocwbc{} paraa \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~37;~1~]~$\ocwbc{} aparaa \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~43;~1;~45;~1~]~$\ocwbc{} avaraa \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~45;~43;~1;~48~]~$\ocwbc{} sarvaa \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~45;~43;~6;~37~]~$\ocwbc{} puurvaa \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~45;~46;~3;~45~]~$\ocwbc{} vizvaa \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~45;~48~]~$\ocwbc{} svaa \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_pron\_aa}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~36;~10~]~$\ocwbc{} enaa \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_ena}~\ocwupperid{Fem}~\ocwlowerid{e}~$\ocweol
\ocwindent{6.00em}
$\mid{}~[~47;~10~]~$\ocwbc{} e.saa \ocwec{}~\ocwkw{when}~$\ocwlowerid{e}=$\ocwstring{"etad"}~$\lor{}~\ocwlowerid{e}=$\ocwstring{"e.saa"}\ocweol
\ocwindent{9.00em}
$\rightarrow{}~\ocwlowerid{build\_saa}~[~10~]~\ocwlowerid{e}~$\ocweol
\ocwindent{6.00em}
$\mid{}~[~48~]~$\ocwbc{} saa \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_saa}~[\,]~\ocwlowerid{e}~$\ocweol
\ocwindent{6.00em}
$\mid{}~[~42~;~48~]~$\ocwbc{} syaa \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_syaa}~[\,]~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_fem\_aa}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~3~::~\ocwlowerid{r1}~]~$\ocwbc{} -i \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_fem\_i}~\ocwlowerid{stem}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~4~::~\ocwlowerid{r1}~]~$\ocwbc{} -ii \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{7.00em}
\ocwbc{} \ocwbegindcode{}\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}~
~[~[~37~::~[~2~::~$\ocwlowerid{\_}~]~]~(\times{}~-\ocwlowerid{aapii}~\times{})~
~\mid{}~\ocwlowerid{\_}~\rightarrow{}~]$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{monosyl}~\ocwlowerid{r1}~\lor{}~\ocwlowerid{compound\_monosyl\_ii}~\ocwlowerid{r1}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~[~43;~32;~48~]~$\ocwbc{} strii \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_strii}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{6.50em}
$\mid{}~[~43;~46~]~$\ocwbc{} zrii \ocwec{}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{7.50em}
\{~$\ocwlowerid{build\_mono\_ii}~\ocwupperid{Fem}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
;~$\ocwlowerid{build\_fem\_ii}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocwbc{} MW \ocwec{}\ocweol
\ocwindent{7.50em}
\}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_mono\_ii}~\ocwupperid{Fem}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{7.50em}
\{~\ocwkw{if}~$\ocwlowerid{r1}=[~22;~1~]~$\ocwbc{} -acii \ocwec{}~\ocwkw{then}~$()~$\ocwbc{} seulement avec px \ocwec{}\ocweol
\ocwindent{8.50em}
\ocwkw{else}~$\ocwlowerid{build\_fem\_ii}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
;~\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}~\ocwbc{} vedic forms Whitney §355-356 \ocwec{}~\ocweol
\ocwindent{8.50em}
$[~[~45;~1~]~$\ocwbc{} avii \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[~34;~1;~36~]~$\ocwbc{} nadii \ocwec{}~\ocweol
\ocwindent{8.50em}
$\mid{}~[~41;~43;~6;~48~]~$\ocwbc{} suurmii \ocwec{}~\ocweol
\ocwindent{8.50em}
$\mid{}~[~41;~47;~17;~1;~44~]~$\ocwbc{} lak.smii \ocwec{}~\ocweol
\ocwindent{8.50em}
$\mid{}~[~43;~1;~32~]~$\ocwbc{} tarii \ocwec{}~\ocwbc{} Whitney §363a \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[~43;~32;~36;~1;~32~]~$\ocwbc{} tantrii \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[~43;~1;~32;~48~]~$\ocwbc{} starii \ocwec{}~\ocwbc{} Deshpande u.naadisuutra \ocwec{}\ocweol
\ocwindent{9.50em}
$\rightarrow{}~\ocwlowerid{build\_poly\_ii}~\ocwupperid{Fem}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{8.50em}
$]$\ocweol
\ocwindent{7.50em}
\}\ocweol
\ocwindent{3.00em}
$\mid{}~[~5~::~\ocwlowerid{r1}~]~$\ocwbc{} u \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_fem\_u}~\ocwlowerid{stem}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~6~::~\ocwlowerid{r1}~]~$\ocwbc{} -uu \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{monosyl}~\ocwlowerid{r1}~\lor{}~\ocwlowerid{compound\_monosyl\_uu}~\ocwlowerid{r1}~$\ocwkw{then}~$\ocwlowerid{build\_mono\_uu}~\ocwupperid{Fem}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{7.50em}
\{~$\ocwlowerid{build\_fem\_uu}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
;~\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}~\ocwbc{} vedic forms Whitney §355-356 \ocwec{}\ocweol
\ocwindent{8.50em}
$[~[~35;~1;~45~]~$\ocwbc{} vadhuu \ocwec{}~\ocweol
\ocwindent{8.50em}
$\mid{}~[~36;~1;~32~]~$\ocwbc{} tanuu \ocwec{}~\ocweol
\ocwindent{8.50em}
$\mid{}~[~41;~1;~22~]~$\ocwbc{} camuu \ocwec{}~\ocweol
\ocwindent{9.50em}
$\rightarrow{}~\ocwlowerid{build\_poly\_uu}~\ocwupperid{Fem}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{8.50em}
$]$\ocweol
\ocwindent{7.50em}
\}\ocweol
\ocwindent{3.00em}
$\mid{}~[~7~::~\ocwlowerid{r1}~]~$\ocwbc{} -.r \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~32~::~\ocwlowerid{r2}~]~$\ocwbc{} -t.r \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~[~2;~41~]~$\ocwbc{} maat.r \ocwec{}~\ocwbc{} relationships McDonnel §101 \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~[~3;~49;~5;~34~]~$\ocwbc{} duhit.r \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_fem\_ri\_g}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_fem\_ri\_v}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~[~34;~36;~2;~36;~1;~36~]~$\ocwbc{} nanaand.r \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~34;~36;~1;~36;~1;~36~]~$\ocwbc{} nanaand.r \ocwec{}~\ocweol
\ocwindent{8.50em}
$\rightarrow{}~\ocwlowerid{build\_fem\_ri\_g}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_fem\_ri\_v}~\ocwlowerid{r1}~\ocwlowerid{e}~$\ocwbc{} including relationship svas.r \ocwec{}\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~8~::~\ocwlowerid{\_}~]~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~9~::~\ocwlowerid{\_}~]~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~10~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwupperid{Fem}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~11~::~\ocwlowerid{r1}~]$\ocwbc{} -ai \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~43~]~$\ocwbc{} rai \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_rai}~\ocwupperid{Fem}~[~2;~43~]~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwupperid{Fem}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~12~::~\ocwlowerid{r1}~]~$\ocwbc{} -o \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_o}~\ocwupperid{Fem}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~13~::~\ocwlowerid{r1}~]~$\ocwbc{} -au \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~48;~1~]~$\ocwbc{} asau \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_asau\_f}~()$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_au}~\ocwupperid{Fem}~\ocwlowerid{r1}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~24~::~\ocwlowerid{r1}~]~$\ocwbc{} -j \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}~\ocwbc{} m.rjify \ocwec{}\ocweol
\ocwindent{6.00em}
$[~[~2~::~[~43~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -raaj2 viraaj2 \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~2~::~[~42~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -yaaj2 \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~7;~48~]~$\ocwbc{} s.rj2 \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Fem}~[~124~$\ocwbc{} j' \ocwec{}~::~$\ocwlowerid{r1}~]~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~5;~42~]~$\ocwbc{} yuj2 \ocwec{}~$\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{8.00em}
\{~$\ocwlowerid{build\_root}~\ocwupperid{Fem}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{build\_archaic\_yuj}~[~24;~26;~5;~42~]~$\ocwbc{} yu~nj \ocwec{}~$\ocwupperid{Fem}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Fem}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~34~::~\ocwlowerid{r1}~]~$\ocwbc{} -d \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~1;~37~]~$\ocwbc{} pad \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root\_weak}~\ocwupperid{Fem}~\ocwlowerid{stem}~$\ocwstring{"paada"}\ocweol
\ocwindent{6.00em}
$\mid{}~[~1;~37;~2~]~$\ocwbc{} aapad \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~1;~37;~3;~45~]~$\ocwbc{} vipad \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~1;~37;~41;~1;~48~]~$\ocwbc{} sampad \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Fem}~\ocwlowerid{stem}~\ocwlowerid{e}~$\ocweol
\ocwindent{6.00em}
$\mid{}~[~1~::~[~37~::~\ocwlowerid{s}~]~]~$\ocwbc{} -pad \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_pad}~\ocwupperid{Fem}~\ocwlowerid{s}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Fem}~\ocwlowerid{stem}~\ocwlowerid{e}~$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~36~::~\ocwlowerid{r1}~]~$\ocwbc{} -n \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~1~::~\ocwlowerid{r2}~]~$\ocwbc{} -an \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~[~41~::~\ocwlowerid{r3}~]~$\ocwbc{} man \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r3}~$\ocwkw{with}\ocweol
\ocwindent{9.00em}
$[~[~2;~48~]~$\ocwbc{} saaman \ocwec{}~\ocweol
\ocwindent{9.00em}
$\mid{}~[~4;~48~]~$\ocwbc{} siiman \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_man}~\ocwupperid{Fem}~\ocwlowerid{r3}~\ocwlowerid{e}~$\ocwbc{} check \ocwec{}\ocweol
\ocwindent{9.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwupperid{Fem}$\ocweol
\ocwindent{9.00em}
$]$\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwupperid{Fem}$\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwupperid{Fem}$\ocweol
\ocwindent{6.00em}
$]~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~37;~1~]~$\ocwbc{} ap \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_ap}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~37~::~[~1~::~[~48~::~\ocwlowerid{r}~]~]~]~$\ocwbc{} -sap \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_sap}~\ocwupperid{Fem}~\ocwlowerid{r}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~41~::~\ocwlowerid{r1}~]~$\ocwbc{} -m \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~1;~42;~3~]~$\ocwbc{} iyam \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_iyam}~()$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root\_m}~\ocwupperid{Fem}~\ocwlowerid{r1}~\ocwlowerid{stem}~\ocwlowerid{e}~$\ocwbc{} was report stem g \ocwec{}\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~43~::~\ocwlowerid{r1}~]~$\ocwbc{} -r \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~2~::~\ocwlowerid{\_}~]~$\ocwbc{} -aar \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Fem}~\ocwlowerid{stem}~\ocwlowerid{e}~$\ocwbc{} dvaar \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~3~::~\ocwlowerid{r2}~]~$\ocwbc{} -ir \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_fem\_ir}~\ocwlowerid{r2}~\ocwlowerid{e}~$\ocwbc{} gir \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~5~::~\ocwlowerid{r2}~]~$\ocwbc{} -ur \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_fem\_ur}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~1~::~\ocwlowerid{\_}~]~$\ocwbc{} -praatar -sabar \ocwec{}~$\rightarrow{}~()~$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwlowerid{g}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~45~::~\ocwlowerid{r1}~]~$\ocwbc{} -v \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~3;~34~]~$\ocwbc{} div \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_div}~\ocwupperid{Fem}~[~34~]~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~4;~34~]~$\ocwbc{} diiv\#2 \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_diiv}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwlowerid{g}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~47~::~\ocwlowerid{r1}~]~$\ocwbc{} -.s \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~3~::~\ocwlowerid{r2}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~[~28~::~[~1~::~[~37~::~[~3~::~[~37~]~]~]~]~]~$\ocwbc{} pipa.thi.s \ocwec{}\ocweol
\ocwindent{10.00em}
$\rightarrow{}~\ocwlowerid{build\_is}~\ocwupperid{Fem}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Fem}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~[~5~::~\ocwlowerid{r2}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~[~24~::~[~1~::~[~48~]~]~]~$\ocwbc{} saju.s \ocwec{}\ocweol
\ocwindent{10.00em}
$\rightarrow{}~\ocwlowerid{build\_us}~\ocwupperid{Fem}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Fem}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Fem}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~48~::~\ocwlowerid{r1}~]~$\ocwbc{} -s \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~1;~36~]~$\ocwbc{} nas \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_nas}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~1~::~\ocwlowerid{r2}~]~$\ocwbc{} -as \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~[~45~::~[~35~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -dhvas \ocwec{}~\ocweol
\ocwindent{8.00em}
$\mid{}~[~43~::~[~48~::~\ocwlowerid{\_}~]~]~$\ocwbc{} -sras \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Fem}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
$\mid{}~[~34;~1~]~$\ocwbc{} adas \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_asau\_f}~()$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_as}~\ocwupperid{Fem}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~[~2~::~\ocwlowerid{r2}~]~$\ocwbc{} -aas \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Fem}~\ocwlowerid{stem}~\ocwlowerid{e}~$\ocwbc{} bhaas \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~3~::~\ocwlowerid{r2}~]~$\ocwbc{} -is \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r2}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~[~46;~2~]~$\ocwbc{} aazis \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_fem\_is}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_is}~\ocwupperid{Fem}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~[~5~::~\ocwlowerid{r2}~]~$\ocwbc{} -us \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_us}~\ocwupperid{Fem}~\ocwlowerid{r2}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$\mid{}~[~12;~34~]~$\ocwbc{} dos \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~14;~2;~41~]~$\ocwbc{} maa.ms \ocwec{}~$\rightarrow{}~()~$\ocwbc{} avoids reporting bahu \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~14~::~[~5~::~\ocwlowerid{\_}~]~]~\rightarrow{}~()~$\ocwbc{} -pu.ms \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwlowerid{g}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~49~::~\ocwlowerid{r1}~]~$\ocwbc{} -h \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r1}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~1~::~[~34~::~\ocwlowerid{\_}~]~]~$\ocwbc{} dah2 -dah \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~5~::~[~34~::~\ocwlowerid{\_}~]~]~$\ocwbc{} duh2 -duh \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~3;~31;~47;~5~]~$\ocwbc{} u.s.nih \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{7.00em}
$\ocwlowerid{build\_root}~\ocwupperid{Fem}~[~149~$\ocwbc{} h' \ocwec{}~::~$\ocwlowerid{r1}~]~\ocwlowerid{e}~$\ocwbc{} duhify \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~3;~36;~48~]~$\ocwbc{} snih2 \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~5;~36;~48~]~$\ocwbc{} snuh2 \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~[~5~::~[~43~::~[~34~::~\ocwlowerid{\_}~]~]~]~$\ocwbc{} druh2 -druh \ocwec{}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{8.00em}
\{~$\ocwlowerid{build\_root}~\ocwupperid{Fem}~[~149~$\ocwbc{} h' \ocwec{}~::~$\ocwlowerid{r1}~]~\ocwlowerid{e}~$\ocwbc{} optionally duhify \ocwec{}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{build\_root}~\ocwupperid{Fem}~\ocwlowerid{stem}~\ocwlowerid{e}~$\ocweol
\ocwindent{8.00em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~[~1;~36;~2;~37;~5~]~\rightarrow{}~\ocwlowerid{build\_upaanah}~\ocwlowerid{r1}~\ocwlowerid{stem}~\ocwlowerid{e}~$\ocwbc{} Kale§101 \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Fem}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~46;~3;~36~]~$\ocwbc{} niz \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root\_weak}~\ocwupperid{Fem}~\ocwlowerid{stem}~$\ocwstring{"nizaa"}\ocweol
\ocwindent{3.00em}
$\mid{}~[~32;~7;~37~]~$\ocwbc{} p.rt \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_root\_weak}~\ocwupperid{Fem}~\ocwlowerid{stem}~$\ocwstring{"p.rtanaa"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{build\_root}~\ocwupperid{Fem}~\ocwlowerid{stem}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Deictic}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~$\ocwbc{} aham \ocwec{}~$[~41;~1;~49;~1~]~$\ocwbc{} Dico \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} asmad \ocwec{}~$[~34;~1;~41;~48;~1~]~$\ocwbc{} tradition \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_aham}~()~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} tvad \ocwec{}~$[~34;~1;~45;~32~]~$\ocwbc{} Dico \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} yu.smad \ocwec{}~$[~34;~1;~41;~47;~5;~42~]~$\ocwbc{} tradition \ocwec{}~$\rightarrow{}~\ocwlowerid{build\_tvad}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} aatman \ocwec{}~$[~36;~1;~41;~32;~2~]~\rightarrow{}~\ocwlowerid{build\_aatman}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} eka \ocwec{}~$[~1;~17;~10~]~\rightarrow{}~\ocwlowerid{warn}~\ocwlowerid{stem}~$\ocwstring{"a\ocwvspace{}Mas\ocwvspace{}or\ocwvspace{}Neu"}~\ocwbc{} pn in Dico \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} dva \ocwec{}~$[~1;~45;~34~]~\rightarrow{}~\ocwlowerid{build\_dva}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} tri \ocwec{}~$[~3;~43;~32~]~\rightarrow{}~\ocwlowerid{build\_tri}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} tis.r \ocwec{}~$[~7;~48;~3;~32~]$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} trayas \ocwec{}~$[~48;~1;~42;~1;~43;~32~]~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} trii.ni \ocwec{}~$[~3;~31;~4;~43;~32~]~\rightarrow{}~\ocwlowerid{warn}~\ocwlowerid{stem}~$\ocwstring{"tri"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} catur \ocwec{}~$[~43;~5;~32;~1;~22~]~\rightarrow{}~\ocwlowerid{build\_catur}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} catas.r \ocwec{}~$[~7;~48;~1;~32;~1;~22~]~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} catvaari \ocwec{}~$[~3;~43;~2;~45;~32;~1;~22~]~\rightarrow{}~\ocwlowerid{warn}~\ocwlowerid{stem}~$\ocwstring{"catur"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} .sa.s \ocwec{}~$[~47;~1;~47~]~\rightarrow{}~\ocwlowerid{build\_sat}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} -an (numbers) \ocwec{}~$[~36~::~[~1~::~\ocwlowerid{st}~]~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{st}~$\ocwkw{with}~\ocweol
\ocwindent{6.50em}
$[~$\ocwbc{} pa~ncan \ocwec{}~$[~22;~26;~1;~37~]~$\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwbc{} saptan \ocwec{}~$[~32;~37;~1;~48~]$\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwbc{} a.s.tan \ocwec{}~$[~27;~47;~1~]~$\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwbc{} navan \ocwec{}~$[~45;~1;~36~]$\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwbc{} .so.dazan \ocwec{}~$[~46;~1;~29;~12;~47~]~$\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwbc{} -dazan \ocwec{}~$[~46~::~[~1~::~[~34~::~\ocwlowerid{\_}~]~]~]~\rightarrow{}~\ocwlowerid{build\_num}~\ocwlowerid{st}~\ocwlowerid{e}~$\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwlowerid{g}$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} kati \ocwec{}~$[~3;~32;~1;~17~]~\rightarrow{}~\ocwlowerid{build\_kati}~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} vi.mzati \ocwec{}~$[~3;~32;~1;~46;~14;~3;~45~]~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} .sa.s.ti \ocwec{}~$[~3;~27;~47;~1;~47~]~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} saptati \ocwec{}~$[~3;~32;~1;~32;~37;~1;~48~]$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} aziiti \ocwec{}~$[~3;~32;~4;~46;~1~]~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} navati \ocwec{}~$[~3;~32;~1;~45;~1;~36~]~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} -zat \ocwec{}~$[~32~::~[~1~::~[~46~::~\ocwlowerid{\_}~]~]~]~$\ocweol
\ocwindent{10.00em}
\ocwbc{} -tri.mzat -catvaari.mzat -pa~ncaazat \ocwec{}\ocweol
\ocwindent{10.00em}
$\rightarrow{}~\ocwlowerid{warn}~\ocwlowerid{stem}~$\ocwstring{"a\ocwvspace{}Fem"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} zata \ocwec{}~$[~1;~32;~1;~46~]~$\ocwbc{} actually also Mas \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} dvizata \ocwec{}~$[~1;~32;~1;~46;~3;~45;~34~]$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} sahasra \ocwec{}~$[~1;~43;~48;~1;~49;~1;~48~]~\rightarrow{}~\ocwlowerid{warn}~\ocwlowerid{stem}~$\ocwstring{"a\ocwvspace{}Neu"}~\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwbc{} adhika \ocwec{}~$[~1;~17;~3;~35;~1~]~\rightarrow{}~\ocwlowerid{warn}~\ocwlowerid{stem}~$\ocwstring{"an\ocwvspace{}adj"}~\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{stem}~\ocwlowerid{g}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
$]~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind}~\ocwlowerid{k}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{form}~=~\ocwlowerid{mirror}~(\ocwlowerid{terminal\_form}~\ocwlowerid{stem})~$\ocwkw{in}\ocweol
\ocwindent{6.50em}
$\ocwlowerid{enter}~\ocwlowerid{e}~[~\ocwupperid{Indecl}~\ocwlowerid{k}~\ocwlowerid{form}~]~$\ocweol
\ocwindent{1.00em}
$]~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Failure}~\ocwlowerid{s}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{output\_string}~\ocwlowerid{stdout}~$\ocwstring{"\symbol{92}n\symbol{92}n"}\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{flush}~\ocwlowerid{stdout}$\ocweol
\ocwindent{3.00em}
;~$\ocwupperid{Printf.}\ocwlowerid{eprintf}~$\ocwstring{"Declension\ocwvspace{}error\ocwvspace{}for\ocwvspace{}stem\ocwvspace{}\%s\ocwvspace{}in\ocwvspace{}entry\ocwvspace{}\%s\symbol{92}n\%!"}~\ocweol
\ocwindent{11.50em}
$(\ocwupperid{Canon.}\ocwlowerid{decode}~(\ocwlowerid{mirror}~\ocwlowerid{stem}))~\ocwlowerid{e}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{failwith}~\ocwlowerid{s}$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Main procedure, invoked by \ocwbegindcode{}$\ocwlowerid{compute\_decls}$\ocwenddcode{} and \ocwbegindcode{}$\ocwlowerid{fake\_compute\_decls}$\ocwenddcode{} 
   with entry \ocwbegindcode{}$\ocwlowerid{e}:$\ocwbt{string}\ocwenddcode{}, \ocwbegindcode{}$\ocwlowerid{d}:\ocwlowerid{declension\_class}$\ocwenddcode{} which gives the gender \ocwbegindcode{}$\ocwlowerid{g}$\ocwenddcode{}, 
   \ocwbegindcode{}$\ocwlowerid{s}:\ocwlowerid{skt}$\ocwenddcode{} is a stem of \ocwbegindcode{}$\ocwlowerid{e}$\ocwenddcode{} \ocwbegindcode{}$\ocwlowerid{p}:$\ocwbt{string}\ocwenddcode{} is a participle name or \ocwstring{""} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_decls\_stem}~\ocwlowerid{e}~(\ocwlowerid{s},\ocwlowerid{d})~\ocwlowerid{p}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{rstem}~=~\ocwlowerid{revstem}~\ocwlowerid{s}~$\ocwkw{in}~\ocwbc{} remove homonym index if any \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{compute\_nouns\_stem\_form}~\ocwlowerid{e}~\ocwlowerid{rstem}~\ocwlowerid{d}~\ocwlowerid{p}$\ocweol
\ocwindent{1.00em}
\ocwbc{} Only the normalized form is stored and thus extra sandhi rules such as 
     m+n->nn must be added in \ocwbegindcode{}$\ocwupperid{Compile\_sandhi}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We keep entries with only feminine stems, in order to put them in Iic \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{extract\_fem\_stems}~=~\ocwlowerid{extract\_rec}~[\,]$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{extract\_rec}~\ocwlowerid{acc}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{acc}$\ocweol
\ocwindent{2.50em}
$\mid{}~[~(\ocwlowerid{s},\ocwupperid{Gender}~\ocwupperid{Fem})~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{extract\_rec}~[~\ocwlowerid{s}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{2.50em}
$\mid{}~[~\ocwlowerid{\_}~::~\ocwlowerid{rest}~]~\rightarrow{}~[\,]~$\ocwbc{} Beware: ind subentry of fstem will kill its iic \ocwec{}\ocweol
\ocwindent{2.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enter\_iic\_stem}~\ocwlowerid{entry}~(\ocwlowerid{stem}~:~$\ocwbt{string}$)~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{mirror}~(\ocwlowerid{finalize}~(\ocwlowerid{revstem}~\ocwlowerid{stem}))))~$\ocwbc{} horror \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} extra forms \ocwec{}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"viz\#2"}~$\rightarrow{}~\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{normal\_stem}~\ocwlowerid{entry}))~$\ocwbc{} vizpati \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()~$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} called by \ocwbegindcode{}$\ocwupperid{Make\_nouns}.\ocwlowerid{genders\_to\_nouns}$\ocwenddcode{} twice, for nouns and then ifcs \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_decls}~\ocwlowerid{word}~\ocwlowerid{genders}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{entry}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{word}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{compute\_gender}~\ocwlowerid{gen}~=~\ocwlowerid{compute\_decls\_stem}~\ocwlowerid{entry}~\ocwlowerid{gen}~$\ocwstring{""}\ocweol
\ocwindent{13.50em}
\ocwbc{} we do not know the morphology \ocwec{}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~\ocwkw{try}~$\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{compute\_gender}~\ocwlowerid{genders}$\ocweol
\ocwindent{2.00em}
\ocwkw{with}~$[~\ocwupperid{Report}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{print\_report}~\ocwlowerid{s}~$\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwupperid{Failure}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{print\_report}~($\ocwstring{"Anomaly:\ocwvspace{}"}~\^{}~$\ocwlowerid{entry}~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}~$\ocwlowerid{s})$\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{extract\_fem\_stems}~\ocwlowerid{genders}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~()$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{fem\_stems}~\rightarrow{}~\ocwlowerid{iter}~(\ocwlowerid{enter\_iic\_stem}~\ocwlowerid{entry})~\ocwlowerid{fem\_stems}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{iic\_indecl}~=~$\ocwbc{} should be lexicalized \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} indeclinable stems used as iic of non-avyayiibhaava cpd \ocwec{}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"atra"}~\ocwbc{} atrabhavat \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"adhas"}~\ocwbc{} adha.hzaakha adhazcara.nam \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"antar"}~\ocwbc{} antarafga \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"alam"}~\ocwbc{} (gati) ala.mk.rta \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"iti"}~\ocwbc{} ityukta \ocwec{}~\ocweol
\ocwindent{1.00em}
;~\ocwstring{"upari"}~\ocwbc{} uparicara \ocwec{}~\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ubhayatas"}~\ocwbc{} ubhayata.hsasya \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"tatra"}~\ocwbc{} tatrabhavat \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"na\~{}n"}~\ocwbc{} na~nvaada \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"naanaa"}~\ocwbc{} naanaaruupa \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"param"}~\ocwbc{} para.mtapa \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"punar"}~\ocwbc{} punarukta \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"puras"}~\ocwbc{} (gati) pura.hstha \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"mithyaa"}~\ocwbc{} mithyaak.rta \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"tathaa"}~\ocwbc{} tathaagata \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"yathaa"}~\ocwbc{} yathaanirdi.s.ta \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vinaa"}~\ocwbc{} vinaabhava \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"satraa"}~\ocwbc{} satraajit \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"saha"}~\ocwbc{} problematic -- overgenerates  \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"saak.saat"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"saaci"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Feminine stems iic for productive adjectives                       \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} This is a generic weakness, to be remedied.                        \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Generative stems are not inspected for feminine stems              \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} attested as substantives, and thus incurring a feminine iic stem.  \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} This concerns privative compounds and participles.                 \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{iicf\_extra}~=~$\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"abalaa"}~\ocwbc{} a-bala with fem abalaa \ocwec{}~\ocweol
\ocwindent{1.00em}
;~\ocwstring{"kaantaa"}~\ocwbc{} kaanta pp \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"jihvaa"}~\ocwbc{} since jihva mas skips it \ocwec{}\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{iic\_avya}~=~$\ocweol
\ocwindent{0.00em}
\ocwbc{} indeclinable stems used as iic of avyayiibhaava cpd \ocwec{}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"ati"}~\ocwbc{} atikambalam atinidram atyaasam \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"adhas"}~\ocwbc{} adhazcara.nam \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"adhi"}~\ocwbc{} adhipaa.ni adhistri adhihari adhihasti adhyaatmam \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"abhi"}~\ocwbc{} abhyagni abhipuurvam \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"anu"}~\ocwbc{} anujye.s.tham anuk.sa.nam anugu anu.svadham (.) \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"apa"}\ocweol
\ocwindent{0.00em}
\ocwbc{}; \ocwstring{"aa"} -- overgenerates \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"upa"}~\ocwbc{} upakumbham upak.r.s.naat upagafgam upanadam upaagni \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sa\#1"}~\ocwbc{} sak.satram sacakram sat.r.nam saak.siptam saak.saat \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"su\#1"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"dus"}~\ocwbc{} durbhik.sam \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"nis"}~\ocwbc{} nirmak.sikam \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"pari"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"prati"}~\ocwbc{} pratyaham prativar.sam \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"iti"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"paare"}~\ocwbc{} paaregafgam \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"praak"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"yathaa"}~\ocwbc{} yathaazakti yathaakaamam yathaagatam yathaanyaasam yathaav.rddha                 yathaazraddham yathaasthaanam ... \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"yaavat"}~\ocwbc{} yaavacchakyam yaavajjiivam \Pan{2,1,8} \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"bahir"}~\ocwbc{} bahirgraamam \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"upari"}~\ocwbc{} uparibhuumi \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"madhye"}~\ocwbc{} madhyegafgam madhyejalaat \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}  \ocwstring{"dvyaha"} \ocwbc{} dvyahatar.sam (adv+namul) dvyahaatyaasam (adv) \ocwec{} \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwbc{} Avyayiibhaava compounds not recognized as such: 
   those should not be marked as avya (and thus skipped) in the lexicon 
1. missing iic:
   iic aa-: aakar.namuulam aacandram aadvaadazam aamuulam aasa.msaaram aasamudram
   iic. a-yathaa-:  ayathaamaatram 
   iic. ubhayatas-: ubhayata.hkaalam
   iic. dvyaha-: dvyahatar.sam dvyahaatyaasam
   iic. para-: parazvas 
   iic. paras-: parovaram
   iic. uccais-: uccai.hzabdam
   iic. mithyaa-: mithyaaj~naanam 
2. missing ifc:
   ifc. -prati: sukhaprati zaakaprati
   ifc. kridanta yathaav.rddham yathe.s.tam yaavacchakyam (TODO)
   ifc. also pv-kridanta (-aagata) yathaagatam 
   ifc. yatham: yathaayatham
3. misc: ti.s.thadgu anu.svadham var.sabhogye.na (retroflexion) \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enter\_iic}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{normal\_stem}~\ocwlowerid{entry}))~$\ocwbc{} stripped entry \ocwec{}~\ocweol
\ocwindent{1.00em}
\ocwbc{} NB This assumes the iic to be the entry stem - unsafe \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_extra\_iic}~=~\ocwlowerid{iter}~\ocwlowerid{enter\_iic}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Glitch to allow Cvi construction to kridanta entries, even though
   \ocwbegindcode{}$\ocwupperid{Inflected}.\ocwlowerid{enter\_form}$\ocwenddcode{} called from \ocwbegindcode{}$\ocwupperid{Parts}$\ocwenddcode{} does not allow it. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Incomplete for compounds anyway: \ocwstring{"si.mh'avyaaghraami.siik.r"} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{iiv\_krids}~=~$\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"gupta"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"yuddha"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"lak.sya"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vibhinna"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vyakta"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ziir.na"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"zuddha"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"spa.s.ta"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"saaci"}~\ocwbc{} ind \ocwec{}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enter\_iiv}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{revstem}~\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{\_}~::~\ocwlowerid{stem}~]~\rightarrow{}~\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Cvi}~(\ocwlowerid{wrap}~\ocwlowerid{stem}~4))$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"wrong\ocwvspace{}stem\ocwvspace{}enter\_iiv"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_extra\_iiv}~=~\ocwlowerid{iter}~\ocwlowerid{enter\_iiv}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enter\_iiy}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Avyayai}~(\ocwlowerid{normal\_stem}~\ocwlowerid{entry}))~$\ocwbc{} stripped entry \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{tasil\_preserve}~()~=~$\ocwkw{do}~\ocwbc{} Whitney§1098 \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} needed since -tas etymology induces skipping the entry \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~$\ocwstring{"tad"}~$(\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{code}~$\ocwstring{"tatas"}$))~$\ocwbc{} tasil on tad \Pan{5,3,7} \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"ya\#1"}~$(\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{code}~$\ocwstring{"yatas"}$))~$\ocwbc{} tasil on ya \Pan{5,3,7} \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"ku\#1"}~$(\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{code}~$\ocwstring{"kutas"}$))~$\ocwbc{} tasil on ku \Pan{5,3,7-8} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"abhi"}~$(\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{code}~$\ocwstring{"abhitas"}$))~$\ocwbc{} tasil on abhi \Pan{5,3,9} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"pari"}~$(\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{code}~$\ocwstring{"paritas"}$))~$\ocwbc{} tasil on pari \Pan{5,3,9} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"anti"}~$(\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{code}~$\ocwstring{"antitas"}$))~$\ocwbc{} tasil on pn \Pan{5,3,7} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"adas"}~$(\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{code}~$\ocwstring{"amutas"}$))~$\ocwbc{} id \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"anya"}~$(\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{code}~$\ocwstring{"anyatas"}$))~$\ocwbc{} id \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"avara"}~$(\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{code}~$\ocwstring{"avaratas"}$))~$\ocwbc{} id \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"para"}~$(\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{code}~$\ocwstring{"paratas"}$))~$\ocwbc{} id \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"vizva"}~$(\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{code}~$\ocwstring{"vizvatas"}$))~$\ocwbc{} id \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"sva"}~$(\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{code}~$\ocwstring{"svatas"}$))~$\ocwbc{} id \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"puurva"}~$(\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{code}~$\ocwstring{"puurvatas"}$))~$\ocwbc{} id \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"aze.sa"}~$(\ocwupperid{Indecl}~\ocwupperid{Tas}~(\ocwlowerid{code}~$\ocwstring{"aze.satas"}$))~$\ocwbc{} tasil on privative cpd \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Supplementary forms - called by \ocwbegindcode{}$\ocwupperid{Make\_nouns}.\ocwlowerid{genders\_to\_nouns}$\ocwenddcode{}
   with argument \ocwbegindcode{}$\ocwlowerid{iic\_stems}$\ocwenddcode{} contents of \ocwbegindcode{}$\ocwlowerid{iic\_stems\_file}$\ocwenddcode{} dumped from
   \ocwbegindcode{}$\ocwupperid{Subst}.\ocwlowerid{iic\_stems}$\ocwenddcode{} built by calling \ocwbegindcode{}$\ocwupperid{Subst}.\ocwlowerid{record\_iic}$\ocwenddcode{} for iic only entries. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_extra}~\ocwlowerid{iic\_only\_stems}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~$\ocwstring{"maas"}~\ocwbc{} Siddhaanta kaumudii \ocwec{}~$\ocwlowerid{decl}~\ocwlowerid{where}~\ocwlowerid{decl}~=~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}~[~(\ocwupperid{Dual},[~(\ocwupperid{Ins},\ocwlowerid{code}~$\ocwstring{"maabhyaam"}$)~])~]~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"yuu.sa"}~\ocwbc{} Siddhaanta kaumudii \ocwec{}~$\ocwlowerid{decl}$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{where}~\ocwlowerid{decl}~=~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}~[~(\ocwupperid{Plural},[~(\ocwupperid{Loc},\ocwlowerid{code}~$\ocwstring{"yuu.h.su"}$)~])~]$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"avanam"}~$(\ocwupperid{Cvi}~(\ocwlowerid{revcode}~$\ocwstring{"avanamii"}$))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"saak.saat"}~$(\ocwupperid{Cvi}~(\ocwlowerid{revcode}~$\ocwstring{"saak.saat"}$))~$\ocwbc{} gati \ocwec{}\ocweol
\ocwindent{0.50em}
\ocwbc{} For the moment, computed as form of n.r but skipped
 \ocwbegindcode{};~$\ocwlowerid{enter1}~$\ocwstring{"nara"}~$\ocwlowerid{decl}~(\times{}~\ocwlowerid{overgenerates}~\ocwlowerid{badly}~!~\times{})
~\ocwlowerid{where}~\ocwlowerid{decl}~=~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}~[~(\ocwupperid{Singular},[~(\ocwupperid{Nom},\ocwlowerid{code}~$\ocwstring{"naa"}$)~])~]~$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"nara"}~$\ocwlowerid{decl}~$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{where}~\ocwlowerid{decl}~=~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}~[~(\ocwupperid{Plural},[~(\ocwupperid{Gen},\ocwlowerid{code}~$\ocwstring{"n.rr.naam"}$)~])~]$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"nara"}~$\ocwlowerid{decl}~$\ocwbc{} \Pan{6,4,6} \ocwec{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{where}~\ocwlowerid{decl}~=~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}~[~(\ocwupperid{Plural},[~(\ocwupperid{Gen},\ocwlowerid{code}~$\ocwstring{"n.r.naam"}$)~])~]~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"nara"}~$\ocwlowerid{decl}~$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{where}~\ocwlowerid{decl}~=~\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{code}~$\ocwstring{"n.r"}$)~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"bhagavat"}~$\ocwlowerid{decl}~$\ocwbc{} archaic vocative bhagavas \ocwec{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{where}~\ocwlowerid{decl}~=~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}~[~(\ocwupperid{Singular},[~(\ocwupperid{Voc},\ocwlowerid{code}~$\ocwstring{"bhagavas"}$)~])~]$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"tak.san"}~$\ocwlowerid{decl}~$\ocwbc{} \Pan{6,4,9} \ocwec{}~\ocweol
\ocwindent{2.00em}
$\ocwlowerid{where}~\ocwlowerid{decl}~=~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}~[~(\ocwupperid{Singular},[~(\ocwupperid{Acc},\ocwlowerid{code}~$\ocwstring{"tak.sa.nam"}$)~])~]$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"bhuuman"}~$\ocwlowerid{decl}~$\ocwbc{} dhruvaaya bhuumaaya nama.h \ocwec{}~\ocweol
\ocwindent{2.00em}
$\ocwlowerid{where}~\ocwlowerid{decl}~=~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}~[~(\ocwupperid{Singular},[~(\ocwupperid{Dat},\ocwlowerid{code}~$\ocwstring{"bhuumaaya"}$)~])~]$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"sudhii"}~\ocwbc{} Monier \ocwec{}~$\ocwlowerid{decl}$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{where}~\ocwlowerid{decl}~=~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}~[~(\ocwupperid{Singular},[~(\ocwupperid{Nom},\ocwlowerid{code}~$\ocwstring{"sudhi"}$)~])~]$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"viz\#2"}~\ocwbc{} Vedic Whitney§218a \ocwec{}~$\ocwlowerid{decl}$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{where}~\ocwlowerid{decl}~=~\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}~[~(\ocwupperid{Plural},[~(\ocwupperid{Loc},\ocwlowerid{code}~$\ocwstring{"vik.su"}$)~])~]$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iter}~\ocwlowerid{enter\_iiy}~\ocwlowerid{iic\_avya}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tasil\_preserve}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_iic}~\ocwlowerid{iic\_indecl}~$\ocwbc{} antar \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_iic}~\ocwlowerid{iic\_only\_stems}~$\ocwbc{} aajaanu etc. \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_iic}~\ocwlowerid{iicf\_extra}~$\ocwbc{} abalaa etc. \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_iiv}~\ocwlowerid{iiv\_krids}~$\ocwbc{} zuddhii \ocwec{}~\ocweol
\ocwindent{2.00em}
\ocwbc{} Unplugged presently because of overgeneration
  ; \ocwbegindcode{}$\ocwlowerid{compute\_extra\_iic}~\ocwlowerid{gen\_prefixes}$\ocwenddcode{} 
  ; \ocwbegindcode{}$\ocwlowerid{compute\_extra\_ifc}~\ocwlowerid{bahu\_suffixes}$\ocwenddcode{} eg Fem -padaa for meter formation \ocwec{}~\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enter\_extra\_ifcs}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~\ocwkw{let}~$\ocwlowerid{entry}~=~$\ocwstring{"bhogya"}~\ocwkw{in}~\ocwbc{} for retroflexion in var.sabhogye.na \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{ins\_sg}~=~[~(\ocwupperid{Singular},[~(\ocwupperid{Ins},\ocwlowerid{code}~$\ocwstring{"bhogye.na"}$)~])~]$\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{gen\_pl}~=~[~(\ocwupperid{Plural},[~(\ocwupperid{Gen},\ocwlowerid{code}~$\ocwstring{"bhogyaa.naam"}$)~])~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}~\ocwlowerid{ins\_sg})$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Mas}~\ocwlowerid{gen\_pl})$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}~\ocwlowerid{ins\_sg})$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Neu}~\ocwlowerid{gen\_pl})$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Declined}~\ocwupperid{Noun}~\ocwupperid{Fem}~\ocwlowerid{gen\_pl})$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{1.00em}
\}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enter\_extra\_iifcs}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~\ocwkw{let}~$\ocwlowerid{entry}~=~$\ocwstring{"ahan"}~\ocwkw{in}~\ocwbc{} for -aha- like pu.nyaahavaacanam \ocwec{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Bare}~\ocwupperid{Noun}~(\ocwlowerid{code}~$\ocwstring{"aha"}$))$\ocweol
\ocwindent{2.00em}
\ocwbc{} more entries are potentially concerned - TODO \ocwec{}\ocweol
\ocwindent{1.00em}
\}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} called by \ocwbegindcode{}$\ocwupperid{Declension}.\ocwlowerid{emit\_decls}$\ocwenddcode{} and \ocwbegindcode{}$\ocwupperid{Morpho\_debug}.\ocwlowerid{emit\_decls}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fake\_compute\_decls}~((\ocwlowerid{s},\ocwlowerid{\_}~$\ocwbc{} forget decli \ocwec{}$)~$\ocwkw{as}~$\ocwlowerid{nmorph})~\ocwlowerid{part}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{entry}~=~\ocwlowerid{s}~$\ocwkw{in}~\ocwkw{do}~\ocwbc{} fake entry made from stem s - cheat \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{reset\_nominal\_databases}~()~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{morpho\_gen.}\ocwlowerid{val}~:=~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_decls\_stem}~\ocwlowerid{entry}~\ocwlowerid{nmorph}~\ocwlowerid{part}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{nominal\_databases}~()~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
For Interface - cache management 
\ocweol
\label{nouns.ml:181281}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Bank\_lexer};~$\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Gram}~=~\ocwupperid{Camlp4.PreCast.MakeGram}~\ocwupperid{Bank\_lexer}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Bank\_lexer.Token};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\medskip

\label{nouns.ml:181391}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{full\_entry}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"full\_entry"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{entry}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"entry"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{gen}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"gen"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwupperid{EXTEND}~\ocwupperid{Gram}$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{full\_entry}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{e}~=~\ocwlowerid{entry};~\ocwlowerid{g}~=~\ocwlowerid{gen}~\rightarrow{}~(\ocwlowerid{e},\ocwlowerid{g})~]~]~;$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{entry}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"["};~$\ocwlowerid{t}~=~\ocwupperid{TEXT};~$\ocwstring{"]"}~$\rightarrow{}~\ocwlowerid{t}~]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{gen}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"("};~$\ocwlowerid{t}~=~\ocwupperid{TEXT};~$\ocwstring{")"}~$\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{gender\_of}~=~$\ocwkw{fun}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"m."}~$\rightarrow{}~\ocwupperid{Mas}$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"f."}~$\rightarrow{}~\ocwupperid{Fem}$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"n."}~$\rightarrow{}~\ocwupperid{Neu}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Weird\ocwvspace{}gender"}~\^{}~$\ocwlowerid{s})$\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwupperid{Gender}~(\ocwlowerid{gender\_of}~\ocwlowerid{t})~]~];$\ocweol
\ocwindent{0.00em}
$\ocwupperid{END}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{parse\_entry}~\ocwlowerid{s}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gram.}\ocwlowerid{parse\_string}~\ocwlowerid{full\_entry}~\ocwupperid{Loc.}\ocwlowerid{ghost}~\ocwlowerid{s}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~\ocwlowerid{e}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwupperid{Format.}\ocwlowerid{eprintf}~$\ocwstring{"Wrong\ocwvspace{}input:\ocwvspace{}\%s\symbol{92}n,\ocwvspace{}at\ocwvspace{}location\ocwvspace{}\%a:@."}~$\ocwlowerid{s}~\ocwupperid{Loc.}\ocwlowerid{print}~\ocwlowerid{loc}~$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{raise}~\ocwlowerid{e}$\ocweol
\ocwindent{2.50em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{update\_index}~\ocwlowerid{ic}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwlowerid{read\_from\_ic}~\ocwlowerid{ic}$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{read\_from\_ic}~\ocwlowerid{ic}~=~$\ocweol
\ocwindent{5.00em}
\ocwkw{let}~$\ocwlowerid{s}~=~\ocwlowerid{input\_line}~\ocwlowerid{ic}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{5.00em}
\{~\ocwkw{let}~$((\ocwlowerid{entry},\ocwlowerid{gender})~$\ocwkw{as}~$\ocwlowerid{eg})~=~\ocwlowerid{parse\_entry}~\ocwlowerid{s}~$\ocwkw{in}~\ocweol
\ocwindent{6.00em}
\ocwkw{try}~$\ocwlowerid{compute\_decls\_stem}~\ocwlowerid{entry}~\ocwlowerid{eg}~$\ocwstring{""}\ocweol
\ocwindent{6.00em}
\ocwkw{with}~$[~\ocwupperid{Sys\_error}~\ocwlowerid{m}~\rightarrow{}~\ocwlowerid{print\_string}~($\ocwstring{"Sys\_error"}~\^{}~$\ocwlowerid{m})$\ocweol
\ocwindent{8.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{print\_string}~$\ocwstring{"Wrong\ocwvspace{}input"}\ocweol
\ocwindent{8.50em}
$]$\ocweol
\ocwindent{5.00em}
;~$\ocwlowerid{read\_from\_ic}~\ocwlowerid{ic}$\ocweol
\ocwindent{5.00em}
\}\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwupperid{End\_of\_file}~\rightarrow{}~\ocwlowerid{close\_in}~\ocwlowerid{ic}~]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{extract\_current\_cache}~\ocwlowerid{cache\_txt\_file}~=~$\ocwkw{do}~\ocwbc{} cache forms computation \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{nouns.}\ocwlowerid{val}~:=~\ocwupperid{Deco.}\ocwlowerid{empty}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{morpho\_gen.}\ocwlowerid{val}~:=~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{ic}~=~\ocwlowerid{open\_in}~\ocwlowerid{cache\_txt\_file}~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
$\ocwlowerid{update\_index}~\ocwlowerid{ic}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{nouns.}\ocwlowerid{val}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Verbs.mli}
\ocwinterface{Verbs}
\label{verbs.mli:0}%
\label{verbs.mli:647}%
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\medskip

\label{verbs.mli:665}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_conjugs}~:~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~\ocwupperid{Conj\_infos.}\ocwlowerid{root\_infos}~\rightarrow{}~$\ocwbt{unit};\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_conjugs\_stems}~:~$\ocwbt{string}~$\rightarrow{}~\ocwupperid{Conj\_infos.}\ocwlowerid{root\_infos}~\rightarrow{}~$\ocwbt{unit};\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_extra}~:~$\ocwbt{unit}~$\rightarrow{}~$\ocwbt{unit};\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fake\_compute\_conjugs}~:~$\ocwbt{int}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{pr\_class}$\ocwenddcode{} \ocwec{}~$\rightarrow{}~$\ocwbt{string}~\ocwbc{} entry \ocwec{}~$\rightarrow{}~$\ocwbt{unit};\ocweol
\ocwendcode{}\typeout{OcamlWeb file Verbs.ml}
\ocwmodule{Verbs}
\label{verbs.ml:0}%
Verbs defines the conjugation paradigms, and computes conjugated forms 
\ocweol
\ocwindent{0.00em}
Computed forms comprise finite verbal forms of roots, but also derived
   nominal forms (participles), infinitives and absolutives 
\ocweol
\ocwindent{0.00em}
Terminology. record functions will build the forms needed by Conjugation
and Stemming. After change of this file, and "make releasecgi", these tables
are updated. But the Reader/Parser needs a full pass of generation, with 
"make scratch" from Dictionary, in order to rebuild the full automata. 
\ocweol
\label{verbs.ml:1166}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{List};~$\ocwbc{} map, length, rev \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phonetics};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{vowel},~\ocwlowerid{homonasal},~\ocwlowerid{duhify},~\ocwlowerid{mrijify},~\ocwlowerid{nahify},~\ocwlowerid{light},~\ocwlowerid{nasal},~
~\ocwlowerid{gana},~\ocwlowerid{mult},~\ocwlowerid{aug},~\ocwlowerid{trunc\_a},~\ocwlowerid{trunc\_u},~\ocwlowerid{trunc\_aa}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Inflected};~$\ocwbc{} \ocwbegindcode{}$\ocwupperid{Conju},~\ocwupperid{Invar},~\ocwupperid{Inftu},~\ocwlowerid{roots},~\ocwlowerid{enter1},~\ocwlowerid{morpho\_gen},~\ocwlowerid{admits\_aa}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Parts};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{memo\_part},~\ocwlowerid{record\_part},~\ocwlowerid{cau\_gana},~\ocwlowerid{fix},~\ocwlowerid{fix\_augment},~\ocwlowerid{rfix},
~\ocwlowerid{compute\_participles}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} This module also uses modules \ocwbegindcode{}$\ocwupperid{List2}~\ocwupperid{Word}~\ocwupperid{Control}~\ocwupperid{Canon}~\ocwupperid{Encode}~\ocwupperid{Int\_sandhi}$\ocwenddcode{} 
   and interface \ocwbegindcode{}$\ocwupperid{Conj\_infos}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Pada};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{voices\_of\_gana}$\ocwenddcode{} \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
In the grinding phase, we record for each root entry its class and its stem
   for 3rd present. In the declination phase, we compute the inflected forms and
   we record them with a pair \ocwbegindcode{}$(\ocwlowerid{entry},\ocwlowerid{conjugs})$\ocwenddcode{} in verbs.rem, parts.rem, etc. 
\ocweol
\label{verbs.ml:1947}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Not\_attested}~$\ocwbc{} No attested form \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Present system - we give \ocwbegindcode{}$\ocwlowerid{vmorph}$\ocwenddcode{} info \ocwbegindcode{}$\ocwupperid{Prim}~\ocwlowerid{root\_class}~\ocwlowerid{pada}~\ocwlowerid{third\_conjug}$\ocwenddcode{} 
   where \ocwbegindcode{}$\ocwlowerid{third\_conjug}$\ocwenddcode{} is a word, used for checking the 3rd sg Para \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{present}~=~\ocwupperid{Present}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{imperfect}~=~\ocwupperid{Imperfect}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{optative}~=~\ocwupperid{Optative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{imperative}~=~\ocwupperid{Imperative}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Paradigms \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{vpa}~\ocwlowerid{cl}~=~\ocwupperid{Presenta}~\ocwlowerid{cl}~\ocwupperid{Present}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vpm}~\ocwlowerid{cl}~=~\ocwupperid{Presentm}~\ocwlowerid{cl}~\ocwupperid{Present}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vpp}~=~\ocwupperid{Presentp}~\ocwupperid{Present}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{via}~\ocwlowerid{cl}~=~\ocwupperid{Presenta}~\ocwlowerid{cl}~\ocwupperid{Imperfect}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vim}~\ocwlowerid{cl}~=~\ocwupperid{Presentm}~\ocwlowerid{cl}~\ocwupperid{Imperfect}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vip}~=~\ocwupperid{Presentp}~\ocwupperid{Imperfect}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{voa}~\ocwlowerid{cl}~=~\ocwupperid{Presenta}~\ocwlowerid{cl}~\ocwupperid{Optative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vom}~\ocwlowerid{cl}~=~\ocwupperid{Presentm}~\ocwlowerid{cl}~\ocwupperid{Optative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vop}~=~\ocwupperid{Presentp}~\ocwupperid{Optative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vma}~\ocwlowerid{cl}~=~\ocwupperid{Presenta}~\ocwlowerid{cl}~\ocwupperid{Imperative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vmm}~\ocwlowerid{cl}~=~\ocwupperid{Presentm}~\ocwlowerid{cl}~\ocwupperid{Imperative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vmp}~=~\ocwupperid{Presentp}~\ocwupperid{Imperative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vfa}~=~\ocwupperid{Conjug}~\ocwupperid{Future}~\ocwupperid{Active}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vfm}~=~\ocwupperid{Conjug}~\ocwupperid{Future}~\ocwupperid{Middle}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vca}~=~\ocwupperid{Conjug}~\ocwupperid{Conditional}~\ocwupperid{Active}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vcm}~=~\ocwupperid{Conjug}~\ocwupperid{Conditional}~\ocwupperid{Middle}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vfp}~=~\ocwupperid{Conjug}~\ocwupperid{Future}~\ocwupperid{Passive}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vpfa}~=~\ocwupperid{Conjug}~\ocwupperid{Perfect}~\ocwupperid{Active}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vpfm}~=~\ocwupperid{Conjug}~\ocwupperid{Perfect}~\ocwupperid{Middle}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vpfp}~=~\ocwupperid{Conjug}~\ocwupperid{Perfect}~\ocwupperid{Passive}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vbena}~=~\ocwupperid{Conjug}~\ocwupperid{Benedictive}~\ocwupperid{Active}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vbenm}~=~\ocwupperid{Conjug}~\ocwupperid{Benedictive}~\ocwupperid{Middle}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vaa}~\ocwlowerid{cl}~=~\ocwupperid{Conjug}~(\ocwupperid{Aorist}~\ocwlowerid{cl})~\ocwupperid{Active}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vam}~\ocwlowerid{cl}~=~\ocwupperid{Conjug}~(\ocwupperid{Aorist}~\ocwlowerid{cl})~\ocwupperid{Middle}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vja}~\ocwlowerid{cl}~=~\ocwupperid{Conjug}~(\ocwupperid{Injunctive}~\ocwlowerid{cl})~\ocwupperid{Active}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vjm}~\ocwlowerid{cl}~=~\ocwupperid{Conjug}~(\ocwupperid{Injunctive}~\ocwlowerid{cl})~\ocwupperid{Middle}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vap1}~=~\ocwupperid{Conjug}~(\ocwupperid{Aorist}~1)~\ocwupperid{Passive}~$\ocwbc{} passive of root aorist \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vjp1}~=~\ocwupperid{Conjug}~(\ocwupperid{Injunctive}~1)~\ocwupperid{Passive}~$\ocwbc{} passive of root injunctive \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Finite verbal forms of roots \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fpresa}~\ocwlowerid{cl}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vpa}~\ocwlowerid{cl})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fpresm}~\ocwlowerid{cl}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vpm}~\ocwlowerid{cl})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fpresp}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vpp})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fimpfta}~\ocwlowerid{cl}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{via}~\ocwlowerid{cl})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fimpftm}~\ocwlowerid{cl}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vim}~\ocwlowerid{cl})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fimpftp}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vip})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fopta}~\ocwlowerid{cl}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{voa}~\ocwlowerid{cl})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{foptm}~\ocwlowerid{cl}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vom}~\ocwlowerid{cl})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{foptp}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vop})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fimpera}~\ocwlowerid{cl}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vma}~\ocwlowerid{cl})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fimperm}~\ocwlowerid{cl}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vmm}~\ocwlowerid{cl})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fimperp}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vmp})~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{ffutura}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vfa})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{ffuturm}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vfm})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fconda}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vca})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fcondm}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vcm})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fperfa}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vpfa})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fperfm}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vpfm})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fbenea}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vbena})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fbenem}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vbenm})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{faora}~\ocwlowerid{cl}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vaa}~\ocwlowerid{cl})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{faorm}~\ocwlowerid{cl}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vam}~\ocwlowerid{cl})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{finja}~\ocwlowerid{cl}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vja}~\ocwlowerid{cl})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{finjm}~\ocwlowerid{cl}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vjm}~\ocwlowerid{cl})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{faorp1}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vap1})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{finjp1}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{vjp1})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Primary finite verbal forms of roots \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{presa}~\ocwlowerid{cl}~=~\ocwlowerid{fpresa}~\ocwlowerid{cl}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{presm}~\ocwlowerid{cl}~=~\ocwlowerid{fpresm}~\ocwlowerid{cl}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{impfta}~\ocwlowerid{cl}~=~\ocwlowerid{fimpfta}~\ocwlowerid{cl}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{impftm}~\ocwlowerid{cl}~=~\ocwlowerid{fimpftm}~\ocwlowerid{cl}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{opta}~\ocwlowerid{cl}~=~\ocwlowerid{fopta}~\ocwlowerid{cl}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{optm}~\ocwlowerid{cl}~=~\ocwlowerid{foptm}~\ocwlowerid{cl}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{impera}~\ocwlowerid{cl}~=~\ocwlowerid{fimpera}~\ocwlowerid{cl}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{imperm}~\ocwlowerid{cl}~=~\ocwlowerid{fimperm}~\ocwlowerid{cl}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{futura}~=~\ocwlowerid{ffutura}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{futurm}~=~\ocwlowerid{ffuturm}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{perfa}~=~\ocwlowerid{fperfa}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{perfm}~=~\ocwlowerid{fperfm}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{aora}~\ocwlowerid{cl}~=~\ocwlowerid{faora}~\ocwlowerid{cl}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{aorm}~\ocwlowerid{cl}~=~\ocwlowerid{faorm}~\ocwlowerid{cl}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{aorp1}~=~\ocwlowerid{faorp1}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{benea}~=~\ocwlowerid{fbenea}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{benem}~=~\ocwlowerid{fbenem}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{inja}~\ocwlowerid{cl}~=~\ocwlowerid{finja}~\ocwlowerid{cl}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{injm}~\ocwlowerid{cl}~=~\ocwlowerid{finjm}~\ocwlowerid{cl}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{injp1}~=~\ocwlowerid{finjp1}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Participial forms \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pra}~\ocwlowerid{k}~=~\ocwupperid{Ppra}~\ocwlowerid{k}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{prm}~\ocwlowerid{k}~=~\ocwupperid{Pprm}~\ocwlowerid{k}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{prp}~=~\ocwupperid{Pprp}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pfta}~=~\ocwupperid{Ppfta}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pftm}~=~\ocwupperid{Ppftm}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{futa}~=~\ocwupperid{Pfuta}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{futm}~=~\ocwupperid{Pfutm}$\ocweol
\ocwindent{0.00em}
\ocwbc{} Also in Part: Ppp, Pppa, Ger=Pfut Passive, Inf \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Verbal forms of roots \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{vppra}~\ocwlowerid{k}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{pra}~\ocwlowerid{k})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vpprm}~\ocwlowerid{k}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{prm}~\ocwlowerid{k})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vppfta}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{pfta})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vppftm}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{pftm})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vpfuta}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{futa})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vpfutm}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{futm})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vpprp}~\ocwlowerid{conj}~=~(\ocwlowerid{conj},\ocwlowerid{prp})$\ocweol
\ocwindent{0.00em}
\ocwbc{} Also in Part: Ppp, Pppa, Ger=Pfut Passive, Inf \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Verbal forms of roots \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ppra}~\ocwlowerid{k}~=~\ocwlowerid{vppra}~\ocwlowerid{k}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pprm}~\ocwlowerid{k}~=~\ocwlowerid{vpprm}~\ocwlowerid{k}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{ppfta}~=~\ocwlowerid{vppfta}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{ppftm}~=~\ocwlowerid{vppftm}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pfuta}~=~\ocwlowerid{vpfuta}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pfutm}~=~\ocwlowerid{vpfutm}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pprp}~=~\ocwlowerid{vpprp}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Derived verbal forms \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{causa}~=~\ocwlowerid{fpresa}~\ocwlowerid{cau\_gana}~\ocwupperid{Causative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pcausa}~=~\ocwlowerid{vppra}~\ocwlowerid{cau\_gana}~\ocwupperid{Causative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{causm}~=~\ocwlowerid{fpresm}~\ocwlowerid{cau\_gana}~\ocwupperid{Causative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pcausm}~=~\ocwlowerid{vpprm}~\ocwlowerid{cau\_gana}~\ocwupperid{Causative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{causp}~=~\ocwlowerid{fpresp}~\ocwupperid{Causative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{causfa}~=~\ocwlowerid{ffutura}~\ocwupperid{Causative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pcausfa}~=~\ocwlowerid{vpfuta}~\ocwupperid{Causative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{causfm}~=~\ocwlowerid{ffuturm}~\ocwupperid{Causative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pcausfm}~=~\ocwlowerid{vpfutm}~\ocwupperid{Causative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{caaora}~\ocwlowerid{cl}~=~\ocwlowerid{faora}~\ocwlowerid{cl}~\ocwupperid{Causative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{caaorm}~\ocwlowerid{cl}~=~\ocwlowerid{faorm}~\ocwlowerid{cl}~\ocwupperid{Causative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{intensa}~=~\ocwlowerid{fpresa}~\ocwlowerid{int\_gana}~\ocwupperid{Intensive}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pinta}~=~\ocwlowerid{vppra}~\ocwlowerid{int\_gana}~\ocwupperid{Intensive}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{intensm}~=~\ocwlowerid{fpresm}~\ocwlowerid{int\_gana}~\ocwupperid{Intensive}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pintm}~=~\ocwlowerid{vpprm}~\ocwlowerid{int\_gana}~\ocwupperid{Intensive}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{desida}~=~\ocwlowerid{fpresa}~\ocwlowerid{des\_gana}~\ocwupperid{Desiderative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pdesa}~=~\ocwlowerid{vppra}~\ocwlowerid{des\_gana}~\ocwupperid{Desiderative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{desidm}~=~\ocwlowerid{fpresm}~\ocwlowerid{des\_gana}~\ocwupperid{Desiderative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pdesm}~=~\ocwlowerid{vpprm}~\ocwlowerid{des\_gana}~\ocwupperid{Desiderative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{despfa}~=~\ocwlowerid{fperfa}~\ocwupperid{Desiderative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{despfm}~=~\ocwlowerid{fperfm}~\ocwupperid{Desiderative}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{intimpfta}~=~\ocwlowerid{fimpfta}~\ocwlowerid{int\_gana}~\ocwupperid{Intensive}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{intopta}~=~\ocwlowerid{fopta}~\ocwlowerid{int\_gana}~\ocwupperid{Intensive}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{intimpera}~=~\ocwlowerid{fimpera}~\ocwlowerid{int\_gana}~\ocwupperid{Intensive}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{code}~=~\ocwupperid{Encode.}\ocwlowerid{code\_string}~$\ocwbc{} normalized \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{revcode}~=~\ocwupperid{Encode.}\ocwlowerid{rev\_code\_string}~$\ocwbc{} reversed \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{revstem}~=~\ocwupperid{Encode.}\ocwlowerid{rev\_stem}~$\ocwbc{} stripped of homo counter \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Checking consistency of computed form with witness from lexicon.   \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Discrepancies are noted on a warnings log, written on stderr.      \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} NB currently log dumped in STAT/warnings.txt by \ocwstring{"make\ocwvspace{}roots.rem"}.  \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{emit\_warning}~\ocwlowerid{s}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{morpho\_gen.}\ocwlowerid{val}~$\ocwkw{then}~$\ocwlowerid{output\_string}~\ocwlowerid{stderr}~(\ocwlowerid{s}~$\^{}~\ocwstring{"\symbol{92}n"}$)~$\ocwkw{else}~$($\ocwbc{} cgi \ocwec{}$)$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{report}~\ocwlowerid{entry}~\ocwlowerid{gana}~\ocwlowerid{listed}~\ocwlowerid{computed}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{s1}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{computed}$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{s2}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{listed}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{message}~=~\ocwlowerid{entry}~$\^{}~\ocwstring{"\ocwvspace{}["}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{gana}~$\^{}~\ocwstring{"]\ocwvspace{}wrong\ocwvspace{}3rd\ocwvspace{}pr\ocwvspace{}"}\ocweol
\ocwindent{11.00em}
\^{}~$\ocwlowerid{s1}~$\^{}~\ocwstring{"\ocwvspace{}for\ocwvspace{}"}~\^{}~$\ocwlowerid{s2}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{emit\_warning}~\ocwlowerid{message}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} third is attested from Dico, form is generated by morphology \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{check}~\ocwlowerid{entry}~\ocwlowerid{gana}~\ocwlowerid{third}~((\ocwlowerid{\_},\ocwlowerid{form})~$\ocwkw{as}~$\ocwlowerid{res})~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~\ocwkw{if}~$\ocwlowerid{third}=[\,]~$\ocwbc{} no checking \ocwec{}~$\lor{}~\ocwlowerid{third}=\ocwlowerid{form}~$\ocwkw{then}~$()~$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{4.50em}
$[~$\ocwstring{"a\~{}nc"}~$\mid{}~$\ocwstring{"kalu.s"}~$\mid{}~$\ocwstring{"kram"}~$\mid{}~$\ocwstring{"grah"}~$\mid{}~$\ocwstring{"cam"}~$\mid{}~$\ocwstring{"tul"}~$\mid{}~$\ocwstring{"t.rr"}\ocweol
\ocwindent{4.50em}
$\mid{}~$\ocwstring{"manth"}~$\mid{}~$\ocwstring{"v.r\#1"}~$\mid{}~$\ocwstring{"huu"}~$\mid{}~$\ocwstring{"putr"}~\ocweol
\ocwindent{6.50em}
$\rightarrow{}~()~$\ocwbc{} 2 forms - avoids double warning \ocwec{}\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{report}~\ocwlowerid{entry}~\ocwlowerid{gana}~\ocwlowerid{third}~\ocwlowerid{form}$\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{res}~$\ocwbc{} Note that the computed form has priority over the listed one. \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwbc{} Log inspection leads to correction of either Dico or Verbs.   \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{warning}~\ocwlowerid{message}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{failwith}~(\ocwlowerid{message}~$\^{}~\ocwstring{"\symbol{92}n"}$)$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{error\_empty}~\ocwlowerid{n}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{failwith}~($\ocwstring{"empty\ocwvspace{}stem\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{n})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{error\_suffix}~\ocwlowerid{n}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{failwith}~($\ocwstring{"empty\ocwvspace{}suffix\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{n})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{error\_vowel}~\ocwlowerid{n}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{failwith}~($\ocwstring{"no\ocwvspace{}vowel\ocwvspace{}in\ocwvspace{}root\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{n})$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
****  Conjugation of verbal stems ****
\ocweol
\ocwindent{0.00em}
Suffixing uses \ocwbegindcode{}$\ocwupperid{Int\_sandhi}.\ocwlowerid{sandhi}$\ocwenddcode{} (through Parts.fix) for thematic
   conjugation and conjugation of roots of ganas 5,7,8 and 9, and the following 
   sandhi function for athematic conjugation of roots of ganas 2 and 3 (through
   respectively fix2 and fix3w). 
\ocweol
\ocwindent{0.00em}
This sandhi restores initial aspiration if final one is lost -- Gonda§4 note.
   This concerns root syllables with initial g- d- b- and final -gh -dh -bh -h
   where aspiration is shifted forwards. The corresponding problem is dealt in 
   \ocwbegindcode{}$\ocwupperid{Nouns}.\ocwlowerid{build\_root}$\ocwenddcode{} by \ocwbegindcode{}$\ocwupperid{Phonetics}.\ocwlowerid{finalize}$\ocwenddcode{}, so there is some redundancy. 
   It is related to Grassmann's law and Bartholomae's law in IE linguistics. 
\ocweol
\label{verbs.ml:9011}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sandhi}~\ocwlowerid{revstem}~\ocwlowerid{wsuff}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{aspirate}~\ocwlowerid{w}~=~$\ocwkw{match}~$\ocwlowerid{w}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{w}$\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}~\ocwbc{} uses arithmetic encoding for aspiration \ocwec{}\ocweol
\ocwindent{3.50em}
$[~19~\mid{}~34~\mid{}~39~$\ocwbc{} g d b \ocwec{}~$\rightarrow{}~[~\ocwlowerid{c}+1~::~\ocwlowerid{rest}~]~$\ocwbc{} aspiration \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{w}$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.00em}
$]~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{lost}~=~$\ocwkw{match}~$\ocwlowerid{wsuff}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}~\ocwbc{} Gonda§4 note \ocwec{}\ocweol
\ocwindent{3.00em}
$[~48~$\ocwbc{} s \ocwec{}~$\rightarrow{}~$\ocwbc{} 32 | 33 | 35 | 49 \ocwbc{} t th dh h \ocwec{} ? \ocwec{}~\ocweol
\ocwindent{4.00em}
\ocwkw{match}~$\ocwlowerid{revstem}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~[~20~::~\ocwlowerid{\_}~]~\mid{}~[~35~::~\ocwlowerid{\_}~]~\mid{}~[~40~::~\ocwlowerid{\_}~]~\mid{}~[~49~::~\ocwlowerid{\_}~]~$\ocweol
\ocwindent{5.00em}
\ocwbc{} gh           dh            bh            h      \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~[~149~::~\ocwlowerid{\_}~]~\mid{}~[~249~::~\ocwlowerid{\_}~]~$\ocweol
\ocwindent{5.00em}
\ocwbc{} h'            h''     \ocwec{}~\ocweol
\ocwindent{6.00em}
$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{3.00em}
$]~$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{result}~=~\ocwupperid{Int\_sandhi.}\ocwlowerid{int\_sandhi}~\ocwlowerid{revstem}~\ocwlowerid{wsuff}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{lost}~$\ocwkw{then}~$\ocwlowerid{aspirate}~\ocwlowerid{result}~$\ocwkw{else}~$\ocwlowerid{result}$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Theoretical general conjugational scheme : 
   Given the stem value, let conjug person suff = (person,fix stem suff) 
                             (\ocwbegindcode{}$\ocwlowerid{fix\_augment}$\ocwenddcode{} instead of \ocwbegindcode{}$\ocwlowerid{fix}$\ocwenddcode{} for preterit) 
   We enter in the roots lexicon an entry:
  \ocwbegindcode{}~$(\ocwupperid{Conju}~\ocwlowerid{verbal}~
~[~(\ocwupperid{Singular},~
~[~\ocwlowerid{conjug}~\ocwupperid{First}~\ocwlowerid{suff\_s1}
~;~\ocwlowerid{conjug}~\ocwupperid{Second}~\ocwlowerid{suff\_s2}
~;~\ocwlowerid{conjug}~\ocwupperid{Third}~\ocwlowerid{suff\_s3}
~])
~;~(\ocwupperid{Dual},
~[~\ocwlowerid{conjug}~\ocwupperid{First}~\ocwlowerid{suff\_d1}
~;~\ocwlowerid{conjug}~\ocwupperid{Second}~\ocwlowerid{suff\_d2}
~;~\ocwlowerid{conjug}~\ocwupperid{Third}~\ocwlowerid{suff\_d3}
~])
~;~(\ocwupperid{Plural},
~[~\ocwlowerid{conjug}~\ocwupperid{First}~\ocwlowerid{suff\_p1}
~;~\ocwlowerid{conjug}~\ocwupperid{Second}~\ocwlowerid{suff\_p2}
~;~\ocwlowerid{conjug}~\ocwupperid{Third}~\ocwlowerid{suff\_p3}
~])
~])~$\ocwenddcode{}
  Remark. More general patterns such as above could have been used, in Paninian
  style, but at the price of complicating internal sandhi, for instance for
  dropping final a of the stem in \ocwbegindcode{}$\ocwlowerid{conjug}~\ocwupperid{First}~\ocwlowerid{suff\_s1}$\ocwenddcode{} (Goldman§4.22).
  Here instead of st-a+e -> st-e we compute st-e with a shortened stem. 
  Similarly st-a+ete -> st-ete -> in Dual, see \ocwbegindcode{}$\ocwlowerid{compute\_thematic\_presentm}$\ocwenddcode{} etc. 

\ocweol
\ocwindent{0.00em}
Returns the reverse of \ocwbegindcode{}$\ocwlowerid{int\_sandhi}$\ocwenddcode{} of reversed prefix and reversed stem 
\ocweol
\ocwindent{0.00em}
PB: \ocwbegindcode{}$\ocwlowerid{int\_sandhi}$\ocwenddcode{} may provoke too much retroflexion, such as *si.sarti 
   instead of sisarti for root s.r, cf. the ugly ad-hoc patch in redup3 below. 
\ocweol
\label{verbs.ml:11119}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{revaffix}~\ocwlowerid{revpref}~\ocwlowerid{revstem}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{rev}~(\ocwupperid{Int\_sandhi.}\ocwlowerid{int\_sandhi}~\ocwlowerid{revpref}~(\ocwlowerid{rev}~\ocwlowerid{revstem}))~;$\medskip

\ocwendcode{}\ocwindent{0.00em}
Computation of verbal stems from root 
\ocweol
\label{verbs.ml:11282}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{final\_guna}~\ocwlowerid{v}~\ocwlowerid{w}~=~\ocwupperid{List2.}\ocwlowerid{unstack}~(\ocwlowerid{guna}~\ocwlowerid{v})~\ocwlowerid{w}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{final\_vriddhi}~\ocwlowerid{v}~\ocwlowerid{w}~=~\ocwupperid{List2.}\ocwlowerid{unstack}~(\ocwlowerid{vriddhi}~\ocwlowerid{v})~\ocwlowerid{w}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Strong form of reversed stem \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{strong}~=~$\ocwkw{fun}~\ocwbc{} follows Phonetics.gunify \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{error\_empty}~1$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{v}~::~\ocwlowerid{rest}~]~$\ocwkw{when}~$\ocwlowerid{vowel}~\ocwlowerid{v}~\rightarrow{}~\ocwlowerid{final\_guna}~\ocwlowerid{v}~\ocwlowerid{rest}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~::~[~\ocwlowerid{v}~::~\ocwlowerid{rest}~]~]~$\ocwkw{when}~$\ocwlowerid{short\_vowel}~\ocwlowerid{v}~\rightarrow{}~[~\ocwlowerid{c}~::~\ocwlowerid{final\_guna}~\ocwlowerid{v}~\ocwlowerid{rest}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Lengthened form of reversed stem \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{lengthened}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{error\_empty}~2$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{v}~::~\ocwlowerid{rest}~]~$\ocwkw{when}~$\ocwlowerid{vowel}~\ocwlowerid{v}~\rightarrow{}~\ocwlowerid{final\_vriddhi}~\ocwlowerid{v}~\ocwlowerid{rest}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~::~[~\ocwlowerid{v}~::~\ocwlowerid{rest}~]~]~$\ocwkw{when}~$\ocwlowerid{short\_vowel}~\ocwlowerid{v}~\rightarrow{}~[~\ocwlowerid{c}~::~\ocwlowerid{final\_vriddhi}~\ocwlowerid{v}~\ocwlowerid{rest}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{strengthen\_10}~\ocwlowerid{rstem}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"m.r.d"}~$\mid{}~$\ocwstring{"sp.rh"}~$\rightarrow{}~\ocwlowerid{rstem}~$\ocwbc{} exceptions with weak stem \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"k.sal"}~$\rightarrow{}~\ocwlowerid{lengthened}~\ocwlowerid{rstem}~$\ocwbc{} v.rddhi \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{strong}~\ocwlowerid{rstem}~$\ocwbc{} guna \ocwec{}~\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} .r -> raa (Whitney§882a, Macdonell§144.4) \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{long\_metathesis}~=~$\ocwkw{fun}~\ocwbc{} .r penultimate -> raa \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~[~7~$\ocwbc{} .r \ocwec{}~::~$\ocwlowerid{rest}~]~]~\rightarrow{}~[~\ocwlowerid{c}~::~[~2~::~[~43~::~\ocwlowerid{rest}~]~]~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"long\_metathesis"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} truncates an rstem eg bh.rjj -> bh.rj \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{truncate}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{error\_empty}~3$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{\_}~::~\ocwlowerid{r}~]~\rightarrow{}~\ocwlowerid{r}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{strong\_stem}~\ocwlowerid{entry}~\ocwlowerid{rstem}~=~$\ocwbc{} rstem = revstem entry \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"am"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"amii"}~\ocwbc{} amiiti \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"dah\#1"}~$\mid{}~$\ocwstring{"dih"}~$\mid{}~$\ocwstring{"duh\#1"}~$\mid{}~$\ocwstring{"druh\#1"}~$\mid{}~$\ocwstring{"muh"}~$\mid{}~$\ocwstring{"snih\#1"}~$\mid{}~$\ocwstring{"snuh\#1"}\ocweol
\ocwindent{7.50em}
$\rightarrow{}~\ocwlowerid{duhify}~(\ocwlowerid{strong}~\ocwlowerid{rstem})$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"nah"}~$\rightarrow{}~\ocwlowerid{nahify}~(\ocwlowerid{strong}~\ocwlowerid{rstem})$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"m.rj"}~$\rightarrow{}~\ocwlowerid{mrijify}~(\ocwlowerid{revcode}~$\ocwstring{"maarj"}$)~$\ocwbc{} maar.s.ti \ocwbegindcode{}$\ocwlowerid{long\_metathesis}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"yaj\#1"}~$\mid{}~$\ocwstring{"vraj"}~$\mid{}~$\ocwstring{"raaj\#1"}~$\mid{}~$\ocwstring{"bhraaj"}~$\mid{}~$\ocwstring{"s.rj\#1"}~\ocweol
\ocwindent{7.50em}
$\rightarrow{}~\ocwlowerid{mrijify}~(\ocwlowerid{strong}~\ocwlowerid{rstem})$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"bh.rjj"}~$\rightarrow{}~\ocwlowerid{mrijify}~(\ocwlowerid{strong}~(\ocwlowerid{truncate}~\ocwlowerid{rstem}))$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"nij"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"ni\~{}nj"}~\ocwbc{} nasalisation for gana 2 \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zrath"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"zranth"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{strong}~\ocwlowerid{rstem}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{weak\_stem}~\ocwlowerid{entry}~\ocwlowerid{rstem}~=~$\ocwbc{} rstem = revstem entry \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"dah\#1"}~$\mid{}~$\ocwstring{"dih"}~$\mid{}~$\ocwstring{"duh\#1"}~$\mid{}~$\ocwstring{"druh\#1"}~$\mid{}~$\ocwstring{"muh"}~$\mid{}~$\ocwstring{"snih\#1"}~$\mid{}~$\ocwstring{"snuh\#1"}\ocweol
\ocwindent{7.50em}
$\rightarrow{}~\ocwlowerid{duhify}~\ocwlowerid{rstem}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"nah"}~$\rightarrow{}~\ocwlowerid{nahify}~\ocwlowerid{rstem}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"m.rj"}~$\mid{}~$\ocwstring{"yaj\#1"}~$\mid{}~$\ocwstring{"vraj"}~$\mid{}~$\ocwstring{"raaj\#1"}~$\mid{}~$\ocwstring{"bhraaj"}~$\mid{}~$\ocwstring{"s.rj\#1"}~\ocweol
\ocwindent{7.50em}
$\rightarrow{}~\ocwlowerid{mrijify}~\ocwlowerid{rstem}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"bh.rjj"}~$\rightarrow{}~\ocwlowerid{mrijify}~(\ocwlowerid{truncate}~\ocwlowerid{rstem})$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"nij"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"ni\~{}nj"}~\ocwbc{} nasalisation \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vaz"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"uz"}~\ocwbc{} but not vac ! \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zaas"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"zi.s"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"myak.s"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"mik.s"}~\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{rstem}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} samprasaara.na correction - weak strong and long rev stem words of root.    \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Concerns 4 roots, lexicalized under their strong rather than weak stem.     \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Beware. The sampra correction must be effected separately when \ocwbegindcode{}$\ocwlowerid{weak\_stem}$\ocwenddcode{}
   and \ocwbegindcode{}$\ocwlowerid{strong\_stem}$\ocwenddcode{} are invoked directly, rather than as components of stems. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{stems}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{rstem}~=~\ocwlowerid{revstem}~\ocwlowerid{root}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{sampra}~\ocwlowerid{substitute}~=~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{lstem}~=~\ocwlowerid{lengthened}~\ocwlowerid{rstem}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{revstem}~\ocwlowerid{substitute},\ocwlowerid{rstem},\ocwlowerid{lstem})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}~\ocwbc{} This shows what ought to be the root name, its weak form \ocwec{}\ocweol
\ocwindent{2.50em}
$[~$\ocwstring{"grah"}~$\rightarrow{}~\ocwlowerid{sampra}~$\ocwstring{"g.rh"}~\ocwbc{} \Pan{6,1,15} \ocwec{}~\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"vyadh"}~$\rightarrow{}~\ocwlowerid{sampra}~$\ocwstring{"vidh"}~\ocwbc{} \Pan{6,1,15} \ocwec{}~\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"spardh"}~$\rightarrow{}~\ocwlowerid{sampra}~$\ocwstring{"sp.rdh"}\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"svap"}~$\rightarrow{}~\ocwlowerid{sampra}~$\ocwstring{"sup"}~\ocwbc{} \Pan{6,1,15} \ocwec{}~\ocweol
\ocwindent{2.50em}
\ocwbc{}  note \ocwstring{"vac"}, \ocwstring{"yaj"} etc not concerned although having samprasaara.na \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{weak}~=~\ocwlowerid{weak\_stem}~\ocwlowerid{root}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{6.00em}
\ocwkw{and}~$\ocwlowerid{strong}~=~\ocwlowerid{strong\_stem}~\ocwlowerid{root}~\ocwlowerid{rstem}~$\ocwkw{in}\ocweol
\ocwindent{6.00em}
\ocwkw{let}~$\ocwlowerid{long}~=~\ocwlowerid{lengthened}~\ocwlowerid{weak}~$\ocwkw{in}\ocweol
\ocwindent{6.00em}
$(\ocwlowerid{weak},\ocwlowerid{strong},\ocwlowerid{long})$\ocweol
\ocwindent{2.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{drop\_penultimate\_nasal}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~[~\ocwlowerid{n}~::~\ocwlowerid{s}~]~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{nasal}~\ocwlowerid{n}~$\ocwkw{then}~$[~\ocwlowerid{c}~::~\ocwlowerid{s}~]~$\ocweol
\ocwindent{13.50em}
\ocwkw{else}~$\ocwlowerid{failwith}~$\ocwstring{"No\ocwvspace{}penultimate\ocwvspace{}nasal"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"No\ocwvspace{}penultimate\ocwvspace{}nasal"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{passive\_stem}~\ocwlowerid{entry}~\ocwlowerid{rstem}~=~$\ocwbc{} Panini -yak (k means no guna) \ocwec{}\ocweol
\ocwindent{16.50em}
\ocwbc{} k also means samprasaara.na \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{weak}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{weak}$\ocwenddcode{} same as first component of \ocwbegindcode{}$\ocwlowerid{stems}$\ocwenddcode{}, except praz vac etc and bh.rjj \ocwec{}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"dah\#1"}~$\mid{}~$\ocwstring{"dih"}~$\mid{}~$\ocwstring{"duh\#1"}~$\mid{}~$\ocwstring{"druh\#1"}~$\mid{}~$\ocwstring{"muh"}~$\mid{}~$\ocwstring{"snih\#1"}~$\mid{}~$\ocwstring{"snuh\#1"}\ocweol
\ocwindent{7.00em}
$\rightarrow{}~\ocwlowerid{duhify}~\ocwlowerid{rstem}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"nah"}~$\rightarrow{}~\ocwlowerid{nahify}~\ocwlowerid{rstem}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"m.rj"}~$\mid{}~$\ocwstring{"vraj"}~$\mid{}~$\ocwstring{"raaj\#1"}~$\mid{}~$\ocwstring{"bhraaj"}~$\mid{}~$\ocwstring{"s.rj\#1"}~$\mid{}~$\ocwstring{"bh.rjj"}~\ocweol
\ocwindent{7.00em}
$\rightarrow{}~\ocwlowerid{mrijify}~\ocwlowerid{rstem}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"yaj\#1"}~$\rightarrow{}~\ocwlowerid{mrijify}~(\ocwlowerid{revcode}~$\ocwstring{"ij"}$)~$\ocwbc{} samprasaara.na ya-x \R i-x \Pan{6,1,15} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vyadh"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"vidh"}~\ocwbc{} id \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"grah"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"g.rh"}~\ocwbc{} samprasaara.na ra-x \R .r-x  \Pan{6,1,16} \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vrazc"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"v.rzc"}~\ocwbc{} id \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"praz"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"p.rcch"}~\ocwbc{} id \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"svap"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"sup"}~\ocwbc{} samprasaara.na va-x \R u-x \Pan{6,1,15} \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vaz"}~$\mid{}~$\ocwstring{"vac"}~$\mid{}~$\ocwstring{"vap"}~$\mid{}~$\ocwstring{"vap\#1"}~$\mid{}~$\ocwstring{"vap\#2"}~$\mid{}~$\ocwstring{"vad"}~$\mid{}~$\ocwstring{"vas\#1"}~$\mid{}~$\ocwstring{"vas\#4"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vah\#1"}~\ocwbc{} idem - specific code for va-x roots \ocwec{}\ocweol
\ocwindent{7.00em}
$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}~\ocweol
\ocwindent{8.50em}
$[~[~48~::~\ocwlowerid{\_}~]~\rightarrow{}~[~47~;~5~$\ocwbc{} u \ocwec{}~$]~$\ocwbc{} vas \R u.s \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~[~\ocwlowerid{c}~;~5~$\ocwbc{} u \ocwec{}~$]~$\ocwbc{} va-x \R u-x \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Anomalous\ocwvspace{}passive\_stem"}\ocweol
\ocwindent{8.50em}
$]$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vaa\#3"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"uu"}~\ocwbc{} \Pan{6,1,15} \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zaas"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"zi.s"}~\ocwbc{} ambiguous zi.s.ta, zi.syate \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zii\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"zay"}~\ocwbc{} \Pan{7,4,22} \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"pyaa"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"pyaay"}~\ocwbc{} pyaa=pyai \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"indh"}~$\mid{}~$\ocwstring{"und"}~$\mid{}~$\ocwstring{"umbh"}~$\mid{}~$\ocwstring{"gumph"}~$\mid{}~$\ocwstring{"granth"}~$\mid{}~$\ocwstring{"da.mz"}~$\mid{}~$\ocwstring{"dhva.ms"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"bandh"}~$\mid{}~$\ocwstring{"bhra.mz"}~$\mid{}~$\ocwstring{"za.ms"}~$\mid{}~$\ocwstring{"zrambh"}~\ocweol
\ocwindent{3.00em}
\ocwbc{} above roots have penultimate and do not have \ocwbegindcode{}$\ocwlowerid{i\_it}$\ocwenddcode{} marker \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"ba.mh"}~$\mid{}~$\ocwstring{"ma.mh"}~$\mid{}~$\ocwstring{"manth"}~$\mid{}~$\ocwstring{"stambh"}~\ocweol
\ocwindent{3.00em}
\ocwbc{} these four roots are listed in dhatupathas as bahi, mahi, mathi, stabhi
         and thus appear here even though they admit \ocwbegindcode{}$\ocwlowerid{i\_it}$\ocwenddcode{} marker \ocwec{}\ocweol
\ocwindent{7.00em}
$\rightarrow{}~\ocwlowerid{drop\_penultimate\_nasal}~\ocwlowerid{rstem}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}~\ocweol
\ocwindent{4.50em}
\ocwbc{} -a~nc -aa~nc va~nc a~nj sa~nj \ocwbegindcode{}$\ocwlowerid{drop\_penultimate\_nasal}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwbc{} doubt for pi~nj and gu~nj since they admit \ocwbegindcode{}$\ocwlowerid{i\_it}$\ocwenddcode{} marker \ocwec{}\ocweol
\ocwindent{4.50em}
$[~[~22~::~[~26~::~\ocwlowerid{r}~]~]~$\ocwbc{} -~nc \ocwec{}~$\rightarrow{}~[~22~::~\ocwlowerid{r}~]~$\ocwbc{} -ac \ocwec{}\ocweol
\ocwindent{4.50em}
$\mid{}~[~24~::~[~26~::~\ocwlowerid{r}~]~]~$\ocwbc{} -~nj \ocwec{}~$\rightarrow{}~[~24~::~\ocwlowerid{r}~]~$\ocwbc{} -aj \ocwec{}\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{w}~\rightarrow{}~\ocwlowerid{w}$\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{rst}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~2~$\ocwbc{} aa \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rst}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~42~$\ocwbc{} y \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~[~4~$\ocwbc{} ii \ocwec{}~::~$\ocwlowerid{r}~]~$\ocwbc{} ziiyate stiiyate \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~$\ocwstring{"j\~{}naa\#1"}~$\mid{}~$\ocwstring{"dhyaa"}~$\mid{}~$\ocwstring{"bhaa\#1"}~$\mid{}~$\ocwstring{"mnaa"}~$\mid{}~$\ocwstring{"yaa\#1"}~$\mid{}~$\ocwstring{"laa"}~\ocweol
\ocwindent{7.50em}
$\mid{}~$\ocwstring{"zaa"}~$\mid{}~$\ocwstring{"haa\#2"}~\ocweol
\ocwindent{9.50em}
$\rightarrow{}~\ocwlowerid{weak}$\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~4~$\ocwbc{} ii \ocwec{}~::~$\ocwlowerid{rst}~]$\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{4.00em}
$\mid{}~3~$\ocwbc{} i \ocwec{}~$\rightarrow{}~[~4~$\ocwbc{} ii \ocwec{}~::~$\ocwlowerid{rst}~]$\ocweol
\ocwindent{4.00em}
$\mid{}~5~$\ocwbc{} u \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~$\ocwstring{"k.su"}~$\mid{}~$\ocwstring{"plu"}~$\mid{}~$\ocwstring{"sru"}~$\rightarrow{}~\ocwlowerid{weak}$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~6~$\ocwbc{} uu \ocwec{}~::~$\ocwlowerid{rst}~]$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{4.00em}
$\mid{}~7~$\ocwbc{} .r \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rst}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~\ocwlowerid{\_}~]~\rightarrow{}~[~3~::~[~43~::~\ocwlowerid{rst}~]~]~$\ocwbc{} ri- \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~$\ocwbc{} 0 or 2 consonants \ocwec{}~$\rightarrow{}~[~43~::~[~1~::~\ocwlowerid{rst}~]~]~$\ocwbc{} ar- \ocwec{}\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{4.00em}
$\mid{}~8~$\ocwbc{} .rr \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rst}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~\ocwlowerid{d}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocweol
\ocwindent{7.00em}
\ocwkw{if}~$\ocwlowerid{labial}~\ocwlowerid{d}~$\ocwkw{then}~$[~43~::~[~6~::~\ocwlowerid{rst}~]~]~$\ocwbc{} puuryate \ocwec{}\ocweol
\ocwindent{13.00em}
\ocwkw{else}~$[~43~::~[~4~::~\ocwlowerid{rst}~]~]~$\ocwbc{} kiiryate ziiryate \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{error\_empty}~4$\ocweol
\ocwindent{6.00em}
$]~$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}>9~\land{}~\ocwlowerid{c}<14~$\ocwbc{} e ai o au \ocwec{}~\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~$\ocwstring{"dhyai"}~$\rightarrow{}~[~2~::~\ocwlowerid{rst}~]~$\ocwbc{} dhyaa in Dico \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"hve"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"huu"}~\ocwbc{} huu in Dico, just for convenience \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~4~$\ocwbc{} ii \ocwec{}~::~$\ocwlowerid{rst}~]$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{7.50em}
\ocwkw{else}~$\ocwlowerid{weak}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{2.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_empty}~5~$\ocweol
\ocwindent{2.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Reduplication for third class present: redup3 takes the root string  
   and its (reversed) stem word, and returns a triple \ocwbegindcode{}$(\ocwlowerid{s},\ocwlowerid{w},\ocwlowerid{b})$\ocwenddcode{} 
   where \ocwbegindcode{}$\ocwlowerid{s}$\ocwenddcode{} is the (reversed) strong stem word, 
         \ocwbegindcode{}$\ocwlowerid{w}$\ocwenddcode{} is the (reversed) weak stem word, 
         \ocwbegindcode{}$\ocwlowerid{b}$\ocwenddcode{} is a boolean flag for special aa roots \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{redup3}~\ocwlowerid{entry}~\ocwlowerid{rstem}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{mirror}~\ocwlowerid{rstem}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Empty\ocwvspace{}root"}\ocweol
\ocwindent{2.00em}
$\mid{}~[~7~$\ocwbc{} .r \ocwec{}~$]~\rightarrow{}~$\ocwbc{} Whitney§643d \ocwec{}~$(\ocwlowerid{revstem}~$\ocwstring{"iyar"},$\ocwlowerid{revstem}~$\ocwstring{"iy.r"},$\ocwupperid{False})$\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{c1}~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c1}~$\ocwkw{then}~$\ocwlowerid{failwith}~$\ocwstring{"Attempt\ocwvspace{}reduplicating\ocwvspace{}vowel\ocwvspace{}root"}\ocweol
\ocwindent{10.50em}
\ocwkw{else}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{v}~=~\ocwlowerid{lookvoy}~\ocwlowerid{r}$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{lookvoy}~=~$\ocwkw{fun}\ocweol
\ocwindent{5.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Attempt\ocwvspace{}to\ocwvspace{}reduplicate\ocwvspace{}root\ocwvspace{}with\ocwvspace{}no\ocwvspace{}vowel"}\ocweol
\ocwindent{5.50em}
$\mid{}~[~\ocwlowerid{c2}~::~\ocwlowerid{r2}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c2}~$\ocwkw{then}~$\ocwlowerid{c2}~$\ocwkw{else}~$\ocwlowerid{lookvoy}~\ocwlowerid{r2}$\ocweol
\ocwindent{5.50em}
$]~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{iflag}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} special flag for some aa roots \ocwec{}\ocweol
\ocwindent{5.50em}
$[~$\ocwstring{"gaa\#1"}~$\mid{}~$\ocwstring{"ghraa"}~$\mid{}~$\ocwstring{"maa\#1"}~$\mid{}~$\ocwstring{"zaa"}~$\mid{}~$\ocwstring{"haa\#2"}~$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~$\ocweol
\ocwindent{5.50em}
$]~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{iflag2}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} special flag for some other roots \ocwec{}\ocweol
\ocwindent{5.50em}
$[~$\ocwstring{"maa\#3"}~$\mid{}~$\ocwstring{"vac"}~$\mid{}~$\ocwstring{"vyac"}~$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~$\ocweol
\ocwindent{5.50em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{c}~=~$\ocwkw{if}~$\ocwlowerid{sibilant}~\ocwlowerid{c1}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}~\ocweol
\ocwindent{3.50em}
\ocwbc{} c is reduplicating consonant candidate \ocwec{}\ocweol
\ocwindent{8.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Reduplicated\ocwvspace{}root\ocwvspace{}with\ocwvspace{}no\ocwvspace{}vowel"}\ocweol
\ocwindent{8.50em}
$\mid{}~[~\ocwlowerid{c2}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c2}~\lor{}~\ocwlowerid{nasal}~\ocwlowerid{c2}~$\ocwkw{then}~$\ocwlowerid{c1}$\ocweol
\ocwindent{17.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{stop}~\ocwlowerid{c2}~$\ocwkw{then}~$\ocwlowerid{c2}$\ocweol
\ocwindent{17.00em}
\ocwkw{else}~\ocwbc{} semivowel c2 \ocwec{}~$\ocwlowerid{c1}$\ocweol
\ocwindent{8.50em}
$]~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{c1}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{rv}~=~$\ocwbc{} rv is reduplicating vowel \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{entry}=$\ocwstring{"v.rt\#1"}~\ocwkw{then}~1~\ocwbc{} a \ocwec{}~\ocwkw{else}\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{rivarna}~\ocwlowerid{v}~\lor{}~\ocwlowerid{iflag}~\lor{}~\ocwlowerid{iflag2}~$\ocwkw{then}~3~\ocwbc{} i \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}=$\ocwstring{"nij"}~\ocwkw{then}~10~\ocwbc{} e \ocwec{}~\ocwbc{} Whitney says intensive! \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$\ocwlowerid{short}~\ocwlowerid{v}~$\ocwbc{} reduplicated vowel is short \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{rc}~=~$\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}~\ocwbc{} rc is reduplicating consonant \ocwec{}\ocweol
\ocwindent{4.00em}
$[~17~\mid{}~18~$\ocwbc{} k kh \ocwec{}~$\rightarrow{}~22~$\ocwbc{} c \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~19~\mid{}~20~\mid{}~49~$\ocwbc{} g gh h \ocwec{}~$\rightarrow{}~24~$\ocwbc{} j \ocwec{}~\ocweol
\ocwindent{4.00em}
$\mid{}~149~\mid{}~249~$\ocwbc{} h' h2 \ocwec{}~$\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Weird\ocwvspace{}root\ocwvspace{}of\ocwvspace{}class\ocwvspace{}3"}\ocweol
\ocwindent{4.00em}
$\mid{}~23~\mid{}~25~\mid{}~28~\mid{}~30~\mid{}~33~\mid{}~35~\mid{}~38~\mid{}~40~\rightarrow{}~\ocwlowerid{c}-1~$\ocwbc{} aspiration loss \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{c}$\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{iiflag}~=~\ocwlowerid{iflag}~\lor{}~\ocwlowerid{entry}~=~$\ocwstring{"haa\#1"}~\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$(\ocwlowerid{strong},\ocwlowerid{weak})~=~$\ocweol
\ocwindent{5.50em}
\ocwkw{if}~$\ocwlowerid{iiflag}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}\ocweol
\ocwindent{7.00em}
$[~[~2~::~\ocwlowerid{rest}~]~\rightarrow{}~(\ocwlowerid{rstem},[~4~::~\ocwlowerid{rest}~])~$\ocwbc{} aa \R ii \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Anomaly\ocwvspace{}Verbs"}\ocweol
\ocwindent{7.00em}
$]$\ocweol
\ocwindent{5.50em}
\ocwkw{else}~\ocwkw{let}~$\ocwlowerid{wstem}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~$\ocwstring{"daa\#1"}~$\mid{}~$\ocwstring{"dhaa\#1"}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}\ocweol
\ocwindent{9.50em}
$[~[~2~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{rest}~$\ocwbc{} drop final aa \ocwec{}\ocweol
\ocwindent{9.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Anomaly\ocwvspace{}Verbs"}\ocweol
\ocwindent{9.50em}
$]$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{rstem}$\ocweol
\ocwindent{8.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{strong}~\ocwlowerid{rstem},\ocwlowerid{wstem})$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{glue}~=~\ocwlowerid{revaffix}~[\ocwlowerid{rv};~\ocwlowerid{rc}]~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{entry}=$\ocwstring{"s.r"}~\ocwkw{then}~\ocwbc{} ad-hoc nonsense \ocwec{}\ocweol
\ocwindent{6.50em}
$(\ocwlowerid{revcode}~$\ocwstring{"sisar"},$\ocwlowerid{revcode}~$\ocwstring{"sis.r"},$\ocwlowerid{iiflag})~$\ocwbc{} to avoid si.sarti ?!? \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$(\ocwlowerid{glue}~\ocwlowerid{strong},\ocwlowerid{glue}~\ocwlowerid{weak},\ocwlowerid{iiflag})$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Dhatupatha markers (from AK's listing) 
\ocweol
\label{verbs.ml:21389}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{aa\_it}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~$\ocwbc{} \ocwstring{"muurch"} | WRONG ? \ocwec{}~\ocweol
\ocwindent{2.00em}
\ocwstring{"phal"}~$\mid{}~$\ocwstring{"zvit"}~$\mid{}~$\ocwstring{"svid\#2"}~$\mid{}~$\ocwstring{"tvar"}~$\mid{}~$\ocwstring{"dh.r.s"}~$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{i\_it}~=~$\ocwkw{fun}~\ocwbc{} unused but subset of set in intercalates \ocwec{}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"vand"}~$\mid{}~$\ocwstring{"bhand"}~$\mid{}~$\ocwstring{"mand\#1"}~$\mid{}~$\ocwstring{"spand"}~$\mid{}~$\ocwstring{"indh"}~$\mid{}~$\ocwstring{"nind"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"nand"}~$\mid{}~$\ocwstring{"cand"}~$\mid{}~$\ocwstring{"zafk"}~$\mid{}~$\ocwstring{"iifkh"}~$\mid{}~$\ocwstring{"lafg"}~$\mid{}~$\ocwstring{"afg"}~$\mid{}~$\ocwstring{"ifg"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"gu\~{}nj"}~$\mid{}~$\ocwstring{"laa\~{}nch"}~$\mid{}~$\ocwstring{"vaa\~{}nch"}~$\mid{}~$\ocwstring{"u\~{}nch"}~$\mid{}~$\ocwstring{"ku.n.d"}~$\mid{}~$\ocwstring{"ma.n.d"}~$\mid{}~$\ocwstring{"ku.n.th"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"lu.n.th"}~$\mid{}~$\ocwstring{"kamp"}~$\mid{}~$\ocwstring{"lamb"}~$\mid{}~$\ocwstring{"stambh"}~$\mid{}~$\ocwstring{"j.rmbh"}~$\mid{}~$\ocwstring{"cumb"}~$\mid{}~$\ocwstring{"inv"}~$\mid{}~$\ocwstring{"jinv"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"ba.mh"}~$\mid{}~$\ocwstring{"ma.mh"}~$\mid{}~$\ocwstring{"ghu.s"}~$\mid{}~$\ocwstring{"kaafk.s"}~$\mid{}~$\ocwstring{"ra.mh"}~$\mid{}~$\ocwstring{"tvar"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"pi\~{}nj"}~$\mid{}~$\ocwstring{"rud\#1"}~$\mid{}~$\ocwstring{"hi.ms"}~$\mid{}~$\ocwstring{"chand"}~$\mid{}~$\ocwstring{"lafgh"}~$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{0.00em}
\ocwbc{} other roots admitting set:
\ocwbegindcode{}~\ocwstring{"a\~{}nc"}~$\mid{}~$\ocwstring{"an\#2"}~$\mid{}~$\ocwstring{"arh"}~$\mid{}~$\ocwstring{"av"}~$\mid{}~$\ocwstring{"az\#1"}~$\mid{}~$\ocwstring{"az\#2"}~$\mid{}~$\ocwstring{"as\#2"}~$\mid{}~$\ocwstring{"aas\#2"}
$\mid{}~$\ocwstring{"i.s\#1"}~$\mid{}~$\ocwstring{"i.s\#2"}~$\mid{}~$\ocwstring{"iik.s"}~$\mid{}~$\ocwstring{"ii.d"}~$\mid{}~$\ocwstring{"iiz\#1"}~$\mid{}~$\ocwstring{"uc"}~$\mid{}~$\ocwstring{"umbh"}~$\mid{}~$\ocwstring{"uuh"}~
$\mid{}~$\ocwstring{".rc\#1"}~$\mid{}~$\ocwstring{".rj"}~$\mid{}~$\ocwstring{".rdh"}~$\mid{}~$\ocwstring{"edh"}~$\mid{}~$\ocwstring{"kafk"}~$\mid{}~$\ocwstring{"kam"}~$\mid{}~$\ocwstring{"ka.s"}~$\mid{}~$\ocwstring{"kup"}~$\mid{}~$\ocwstring{"krand"}
$\mid{}~$\ocwstring{"krii.d"}~$\mid{}~$\ocwstring{"khan"}~$\mid{}~$\ocwstring{"khaad"}~$\mid{}~$\ocwstring{"gam"}~$\mid{}~$\ocwstring{"ghaat"}~$\mid{}~$\ocwstring{"ghuur.n"}~$\mid{}~$\ocwstring{"cit\#1"}~
$\mid{}~$\ocwstring{"jak.s"}~$\mid{}~$\ocwstring{"jap"}~$\mid{}~$\ocwstring{"jalp"}~$\mid{}~$\ocwstring{"tak"}~$\mid{}~$\ocwstring{"tan\#1"}~$\mid{}~$\ocwstring{"tan\#2"}~$\mid{}~$\ocwstring{"tark"}~$\mid{}~$\ocwstring{"dagh"}~
$\mid{}~$\ocwstring{"dabh"}~$\mid{}~$\ocwstring{"dham"}~$\mid{}~$\ocwstring{"dhva.ms"}~$\mid{}~$\ocwstring{"dhvan"}~$\mid{}~$\ocwstring{"pa.th"}~$\mid{}~$\ocwstring{"pat\#1"}~$\mid{}~$\ocwstring{"piz"}~
$\mid{}~$\ocwstring{"bhaa.s"}~$\mid{}~$\ocwstring{"bhraaj"}~$\mid{}~$\ocwstring{"mad\#1"}~$\mid{}~$\ocwstring{"mlecch"}~$\mid{}~$\ocwstring{"yat\#1"}~$\mid{}~$\ocwstring{"yaac"}~$\mid{}~$\ocwstring{"rak.s"}~
$\mid{}~$\ocwstring{"raaj\#1"}~$\mid{}~$\ocwstring{"ruc\#1"}~$\mid{}~$\ocwstring{"lag"}~$\mid{}~$\ocwstring{"lap"}~$\mid{}~$\ocwstring{"la.s"}~$\mid{}~$\ocwstring{"lok"}~$\mid{}~$\ocwstring{"loc"}~$\mid{}~$\ocwstring{"vad"}~
$\mid{}~$\ocwstring{"vam"}~$\mid{}~$\ocwstring{"vaz"}~$\mid{}~$\ocwstring{"vaaz"}~$\mid{}~$\ocwstring{"vip"}~$\mid{}~$\ocwstring{"ven"}~$\mid{}~$\ocwstring{"vyath"}~$\mid{}~$\ocwstring{"vraj"}~$\mid{}~$\ocwstring{"vrii.d"}
$\mid{}~$\ocwstring{"za.ms"}~$\mid{}~$\ocwstring{"zas"}~$\mid{}~$\ocwstring{"zaas"}~$\mid{}~$\ocwstring{"zuc\#1"}~$\mid{}~$\ocwstring{"san\#1"}~$\mid{}~$\ocwstring{"skhal"}~$\mid{}~$\ocwstring{"spardh"}~$\mid{}~$\ocwstring{"sp.rh"}~
$\mid{}~$\ocwstring{"sphu.t"}~$\mid{}~$\ocwstring{"svan"}~$\mid{}~$\ocwstring{"has"}~\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{ii\_it}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"hlaad"}~$\mid{}~$\ocwstring{"yat\#1"}~$\mid{}~$\ocwstring{"cit\#1"}~$\mid{}~$\ocwstring{"vas\#4"}~$\mid{}~$\ocwstring{"jabh\#1"}~$\mid{}~$\ocwstring{"kan"}~$\mid{}~$\ocwstring{"puuy"}~$\mid{}~$\ocwstring{"sphaa"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"pyaa"}~$\mid{}~$\ocwstring{"jan"}~$\mid{}~$\ocwstring{"n.rt"}~$\mid{}~$\ocwstring{"tras"}~$\mid{}~$\ocwstring{"diip"}~$\mid{}~$\ocwstring{"mad\#1"}~$\mid{}~$\ocwstring{".r.s"}~$\mid{}~$\ocwstring{"ju.s\#1"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"vij"}~$\mid{}~$\ocwstring{"d.rbh"}~$\mid{}~$\ocwstring{"gur"}~$\mid{}~$\ocwstring{"k.rt\#1"}~$\mid{}~$\ocwstring{"indh"}~$\mid{}~$\ocwstring{"und"}~$\mid{}~$\ocwstring{"v.rj"}~$\mid{}~$\ocwstring{"p.rc"}~\ocweol
\ocwindent{3.00em}
$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{u\_it}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"sidh\#2"}~$\mid{}~$\ocwstring{"a\~{}nc\#1"}~$\mid{}~$\ocwstring{"va\~{}nc"}~$\mid{}~$\ocwstring{"zrambh"}~$\mid{}~$\ocwstring{"stubh"}~$\mid{}~$\ocwstring{"kam"}~$\mid{}~$\ocwstring{"cam"}~$\mid{}~$\ocwstring{"jam"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"kram"}~$\mid{}~$\ocwstring{".s.thiiv"}~$\mid{}~$\ocwstring{"dhaav\#1"}~$\mid{}~$\ocwstring{"gras"}~$\mid{}~$\ocwstring{"mi.s"}~$\mid{}~$\ocwstring{"p.r.s"}~$\mid{}~$\ocwstring{"v.r.s"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"gh.r.s"}~$\mid{}~$\ocwstring{"zas"}~$\mid{}~$\ocwstring{"za.ms"}~$\mid{}~$\ocwstring{"sra.ms"}~$\mid{}~$\ocwstring{"dhva.ms"}~$\mid{}~$\ocwstring{"v.rt"}~$\mid{}~$\ocwstring{"v.rdh\#1"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"bhram"}~$\mid{}~$\ocwstring{"ram"}~$\mid{}~$\ocwstring{"m.rdh"}~$\mid{}~$\ocwstring{"khan"}~$\mid{}~$\ocwstring{"zaas"}~$\mid{}~$\ocwstring{"diiv\#1"}~$\mid{}~$\ocwstring{"siiv"}~$\mid{}~$\ocwstring{"sidh\#1"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"zam\#1"}~$\mid{}~$\ocwstring{"tam"}~$\mid{}~$\ocwstring{"dam\#1"}~$\mid{}~$\ocwstring{"zram"}~$\mid{}~$\ocwstring{"as\#2"}~$\mid{}~$\ocwstring{"yas"}~$\mid{}~$\ocwstring{"jas"}~$\mid{}~$\ocwstring{"das"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"bhra.mz"}~$\mid{}~$\ocwstring{".rdh"}~$\mid{}~$\ocwstring{"g.rdh"}~$\mid{}~$\ocwstring{"dambh"}~$\mid{}~$\ocwstring{"i.s\#1"}~$\mid{}~$\ocwstring{"t.rd"}~$\mid{}~$\ocwstring{"tan\#1"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"k.san"}~$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{uu\_it}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"trap"}~$\mid{}~$\ocwstring{"k.sam"}~$\mid{}~$\ocwstring{"gaah"}~$\mid{}~$\ocwstring{"ak.s"}~$\mid{}~$\ocwstring{"tak.s"}~$\mid{}~$\ocwstring{"tvak.s"}~$\mid{}~$\ocwstring{"syand"}~$\mid{}~$\ocwstring{"k.rp"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"guh"}~$\mid{}~$\ocwstring{"m.rj"}~$\mid{}~$\ocwstring{"klid"}~$\mid{}~$\ocwstring{"az\#1"}~$\mid{}~$\ocwstring{"vrazc"}~$\mid{}~$\ocwstring{"b.rh\#2"}~$\mid{}~$\ocwstring{"v.rh"}~$\mid{}~$\ocwstring{"a\~{}nj"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"kli.s"}~$\mid{}~$\ocwstring{"ta\~{}nc"}~$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{o\_it}~=~$\ocwkw{fun}~\ocwbc{} these roots have ppp in -na - unused here \ocwec{}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"zuu"}~$\mid{}~$\ocwstring{"haa\#1"}~$\mid{}~$\ocwstring{"haa\#2"}~$\mid{}~$\ocwstring{"vij"}~$\mid{}~$\ocwstring{"vrazc"}~$\mid{}~$\ocwstring{"bhuj\#1"}~$\mid{}~$\ocwstring{"bha\~{}nj"}~$\mid{}~$\ocwstring{"lag"}~\ocweol
\ocwindent{3.00em}
$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{}****************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Present system \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}****************\ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
In all such functions, \ocwbegindcode{}$(\ocwlowerid{stem}~:~\ocwlowerid{word})$\ocwenddcode{} is the code of the reversed stem. 
\ocweol
\ocwindent{0.00em}
Exemple pour cyu: stem=strong=guna=cyo et cyo+ati=cyavati par \ocwbegindcode{}$\ocwlowerid{int\_sandhi}$\ocwenddcode{} 
\ocweol
\label{verbs.ml:24214}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_thematic\_presenta}~\ocwlowerid{cl}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{fpresa}~\ocwlowerid{cl}~\ocwlowerid{conj})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aami"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"asi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{check}~\ocwlowerid{entry}~\ocwlowerid{cl}~\ocwlowerid{third}~(\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ati"}$)~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aavas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"athas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aamas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"atha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"anti"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{m\_stem}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} Whitney§450 \ocwec{}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"b.rh\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"b.rh"}~\ocwbc{} not b.r.mh \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{stem}~$\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{f\_stem}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} Whitney§450f \ocwec{}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"j.rr"}~$\mid{}~$\ocwstring{"p.r.s"}~$\mid{}~$\ocwstring{"b.rh\#1"}~\ocwbc{} | \ocwstring{"mah"} \ocwec{}~$\mid{}~$\ocwstring{"v.rh"}~$\rightarrow{}~\ocwlowerid{rfix}~\ocwlowerid{m\_stem}~$\ocwstring{"at"}~\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{rfix}~\ocwlowerid{m\_stem}~$\ocwstring{"ant"}~\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{cl}=4~\land{}~\ocwlowerid{entry}=$\ocwstring{"daa\#2"}~$\lor{}~\ocwlowerid{entry}=$\ocwstring{"mah"}~\ocwkw{then}~$()~$\ocwbc{} to avoid dyat mahat \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$\ocwlowerid{record\_part}~(\ocwupperid{Ppra\_}~\ocwlowerid{cl}~\ocwlowerid{conj}~\ocwlowerid{m\_stem}~\ocwlowerid{f\_stem}~\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_thematic\_presentm}~\ocwlowerid{cl}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{fpresm}~\ocwlowerid{cl}~\ocwlowerid{conj})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ase"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{check}~\ocwlowerid{entry}~\ocwlowerid{cl}~\ocwlowerid{third}~(\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ate"}$)$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aavahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ethe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ete"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aamahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"adhve"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ante"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{thematic\_preterit\_a}~\ocwlowerid{conjug}~=$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"at"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aava"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"atam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aama"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ata"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"an"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_thematic\_impfta}~\ocwlowerid{cl}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{fimpfta}~\ocwlowerid{cl}~\ocwlowerid{conj})~(\ocwlowerid{thematic\_preterit\_a}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{thematic\_preterit\_m}~\ocwlowerid{conjug}~=$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"athaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ata"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aavahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ethaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"etaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aamahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"adhvam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"anta"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_thematic\_impftm}~\ocwlowerid{cl}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{fimpftm}~\ocwlowerid{cl}~\ocwlowerid{conj})~(\ocwlowerid{thematic\_preterit\_m}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_thematic\_optativea}~\ocwlowerid{cl}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{fopta}~\ocwlowerid{cl}~\ocwlowerid{conj})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"eyam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"es"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"et"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"eva"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"etam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"etaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"ema"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"eta"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"eyur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_thematic\_optativem}~\ocwlowerid{cl}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{foptm}~\ocwlowerid{cl}~\ocwlowerid{conj})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"eya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ethaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"eta"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"evahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"eyaathaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"eyaataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"emahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"edhvam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"eran"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_thematic\_imperativea}~\ocwlowerid{cl}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{fimpera}~\ocwlowerid{cl}~\ocwlowerid{conj})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"atu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aava"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"atam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aama"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ata"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"antu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_thematic\_imperativem}~\ocwlowerid{cl}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{fimperm}~\ocwlowerid{cl}~\ocwlowerid{conj})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"ai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"asva"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aavahai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ethaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"etaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aamahai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"adhvam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"antaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_part\_m}~(\ocwlowerid{conj},\ocwlowerid{part\_kind})~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwkw{match}~$\ocwlowerid{part\_kind}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Pprm}~\ocwlowerid{k}~\rightarrow{}~\ocwlowerid{record\_part}~(\ocwupperid{Pprm\_}~\ocwlowerid{k}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pprp}~\rightarrow{}~\ocwlowerid{record\_part}~(\ocwupperid{Pprp\_}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppfta}~\rightarrow{}~\ocwlowerid{record\_part}~(\ocwupperid{Ppfta\_}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppftm}~\rightarrow{}~\ocwlowerid{record\_part}~(\ocwupperid{Ppftm\_}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfutm}~\rightarrow{}~\ocwlowerid{record\_part}~(\ocwupperid{Pfutm\_}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unexpected\ocwvspace{}participle"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_part\_m\_th}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"cint"}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{pprm}~=~\ocwupperid{Pprm\_}~10~\ocwupperid{Primary}~(\ocwlowerid{revcode}~$\ocwstring{"cintayaan"}$)~\ocwlowerid{entry}~$\ocwkw{in}\ocweol
\ocwindent{7.00em}
$\ocwlowerid{record\_part}~\ocwlowerid{pprm}~$\ocwbc{} irregular \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{mid\_stem}~=~\ocwlowerid{trunc\_a}~(\ocwlowerid{rfix}~\ocwlowerid{stem}~$\ocwstring{"amaana"}$)~$\ocwbc{} -maana \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{trunc\_a}$\ocwenddcode{} needed because possible retroflexion in amaa.na \ocwec{}\ocweol
\ocwindent{4.50em}
$\ocwlowerid{record\_part\_m}~\ocwlowerid{verbal}~\ocwlowerid{mid\_stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{record\_part\_m\_ath}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{suff}~=~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"aas\#2"}~\ocwkw{then}~\ocwstring{"iina"}~\ocwbc{} McDonell§158a \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwkw{else}~\ocwstring{"aana"}~\ocwbc{} -aana \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{mid\_stem}~=~$\ocwkw{match}~$\ocwlowerid{rfix}~\ocwlowerid{stem}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{8.50em}
$[~[~1~::~\ocwlowerid{r}~]~\rightarrow{}~\ocwlowerid{r}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Anomaly\ocwvspace{}Verbs"}~$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwbc{} rare (Whitney). Creates bizarre forms such as plu -> puplvaana \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{record\_part\_m}~\ocwlowerid{verbal}~\ocwlowerid{mid\_stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Thematic present system - gana is root's present class \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_thematic\_active}~\ocwlowerid{gana}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_thematic\_presenta}~\ocwlowerid{gana}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_thematic\_impfta}~\ocwlowerid{gana}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_thematic\_optativea}~\ocwlowerid{gana}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_thematic\_imperativea}~\ocwlowerid{gana}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
\}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_thematic\_middle}~\ocwlowerid{gana}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_thematic\_presentm}~\ocwlowerid{gana}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_thematic\_impftm}~\ocwlowerid{gana}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_thematic\_optativem}~\ocwlowerid{gana}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_thematic\_imperativem}~\ocwlowerid{gana}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part\_m\_th}~(\ocwlowerid{vpprm}~\ocwlowerid{gana}~\ocwlowerid{conj})~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_causativea}~=~\ocwlowerid{compute\_thematic\_active}~\ocwlowerid{cau\_gana}~\ocwupperid{Causative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_causativem}~=~\ocwlowerid{compute\_thematic\_middle}~\ocwlowerid{cau\_gana}~\ocwupperid{Causative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_desiderativea}~=~\ocwlowerid{compute\_thematic\_active}~\ocwlowerid{des\_gana}~\ocwupperid{Desiderative}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_desiderativem}~=~\ocwlowerid{compute\_thematic\_middle}~\ocwlowerid{des\_gana}~\ocwupperid{Desiderative}$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
** Gana 2 (root conjugation) **
\ocweol
\ocwindent{0.00em}
\ocwbegindcode{}$\ocwlowerid{fix2}:~\ocwupperid{Word}.\ocwlowerid{word}~\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~\ocwupperid{Word}.\ocwlowerid{word}$\ocwenddcode{} 
\ocweol
\ocwindent{0.00em}
set indicates connecting vowel string of se.t root 
\ocweol
\label{verbs.ml:31223}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fix2}~\ocwlowerid{stem}~\ocwlowerid{suff}~\ocwlowerid{set}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{codesf}~=~\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{wsfx}~=~$\ocwkw{match}~$\ocwlowerid{codesf}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~1$\ocweol
\ocwindent{3.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~\lor{}~\ocwlowerid{c}=42~$\ocwbc{} y \ocwec{}~\ocwkw{then}~$\ocwlowerid{codesf}$\ocweol
\ocwindent{11.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{set}~$\ocwkw{then}~$[~3~::~\ocwlowerid{codesf}~]~$\ocwbc{} pad with initial i \ocwec{}\ocweol
\ocwindent{11.00em}
\ocwkw{else}~$\ocwlowerid{codesf}$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{sandhi}~\ocwlowerid{stem}~\ocwlowerid{wsfx}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} correction for i, ii, u, uu roots of gana 2 \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{correct2}~\ocwlowerid{weak}~=~$\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[~3~]~$\ocwbc{} i \ocwec{}~$\rightarrow{}~\ocwlowerid{weak}~$\ocwbc{} eg ppr yat \Pan{6,4,81} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~3~$\ocwbc{} i \ocwec{}~::~$\ocwlowerid{rest}~]~\rightarrow{}~[~42~::~\ocwlowerid{weak}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~[~4;~46~]~$\ocwbc{} zii \ocwec{}~$\rightarrow{}~[~42;~1;~46~]~$\ocwbc{} zay \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~[~4~$\ocwbc{} ii \ocwec{}~::~$\ocwlowerid{rest}~]~\rightarrow{}~[~42~::~[~3~::~\ocwlowerid{rest}~]~]~$\ocwbc{} iy \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~5~$\ocwbc{} u \ocwec{}~::~$\ocwlowerid{rest}~]~\rightarrow{}~[~45~::~\ocwlowerid{weak}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~[~6~$\ocwbc{} uu \ocwec{}~::~$\ocwlowerid{rest}~]~\rightarrow{}~[~45~::~[~5~::~\ocwlowerid{rest}~]~]~$\ocwbc{} uv \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{weak}~$\ocweol
\ocwindent{2.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fix2w}~\ocwlowerid{weak}~\ocwlowerid{suff}~\ocwlowerid{set}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{weakv}~=~\ocwlowerid{correct2}~\ocwlowerid{weak}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{weakc}~=~$\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[~4;~46~]~$\ocwbc{} zii \ocwec{}~$\rightarrow{}~[~10;~46~]~$\ocwbc{} ze \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{weak}~$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{fix2}~($\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{weakv}~$\ocwkw{else}~$\ocwlowerid{weakc})~\ocwlowerid{suff}~\ocwlowerid{set}$\ocweol
\ocwindent{2.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~7$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fix2w\_augment}~\ocwlowerid{weak}~\ocwlowerid{suff}~\ocwlowerid{set}~=~\ocwlowerid{aug}~(\ocwlowerid{fix2w}~\ocwlowerid{weak}~\ocwlowerid{suff}~\ocwlowerid{set})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fix2wi}~\ocwlowerid{suff}~=~$\ocwbc{} special for root i middle \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}~\ocwbc{} \Pan{6,4,77} \ocwec{}\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{fix2}~($\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$[~42;~3~]~$\ocwkw{else}~$[~3~])~\ocwlowerid{suff}~\ocwupperid{False}$\ocweol
\ocwindent{2.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~15$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fix2whan}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{codesf}~=~\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{codesf}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~2$\ocweol
\ocwindent{2.50em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocwstring{"ghn"}\ocweol
\ocwindent{10.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{c}=41~\lor{}~\ocwlowerid{c}=42~\lor{}~\ocwlowerid{c}=45~$\ocwbc{} m y v \ocwec{}~\ocwkw{then}~\ocwstring{"han"}\ocweol
\ocwindent{10.50em}
\ocwkw{else}~\ocwstring{"ha"}\ocweol
\ocwindent{2.50em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{sandhi}~(\ocwlowerid{revcode}~\ocwlowerid{stem})~\ocwlowerid{codesf}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fix2whan\_augment}~\ocwlowerid{suff}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{codesf}~=~\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{codesf}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~3$\ocweol
\ocwindent{2.50em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocwstring{"aghn"}\ocweol
\ocwindent{10.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{c}=41~\lor{}~\ocwlowerid{c}=42~\lor{}~\ocwlowerid{c}=45~$\ocwbc{} m y v \ocwec{}~\ocwkw{then}~\ocwstring{"ahan"}\ocweol
\ocwindent{10.50em}
\ocwkw{else}~\ocwstring{"aha"}\ocweol
\ocwindent{2.50em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{sandhi}~(\ocwlowerid{revcode}~\ocwlowerid{stem})~\ocwlowerid{codesf}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} correction for u roots \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fix2s}~\ocwlowerid{strong}~\ocwlowerid{suff}~\ocwlowerid{set}~=~$\ocwkw{match}~$\ocwlowerid{strong}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[~12~$\ocwbc{} o \ocwec{}~::~$\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{fix2}~\ocwlowerid{strong}~\ocwlowerid{suff}~\ocwlowerid{set}$\ocweol
\ocwindent{11.00em}
\ocwkw{else}~$\ocwlowerid{fix2}~[~13~$\ocwbc{} au \ocwec{}~::~$\ocwlowerid{rest}~]~\ocwlowerid{suff}~\ocwlowerid{set}$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~4$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{fix2}~\ocwlowerid{strong}~\ocwlowerid{suff}~\ocwlowerid{set}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fix2s\_augment}~\ocwlowerid{strong}~\ocwlowerid{suff}~\ocwlowerid{set}~=~\ocwlowerid{aug}~(\ocwlowerid{fix2s}~\ocwlowerid{strong}~\ocwlowerid{suff}~\ocwlowerid{set})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fix2sbruu}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{strong}~=~\ocwlowerid{revcode}~$\ocwstring{"bro"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{suff'}~=~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{suff}~$\ocwkw{else}~\ocwstring{"ii"}~\^{}~$\ocwlowerid{suff}~$\ocwkw{in}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{fix2}~\ocwlowerid{strong}~\ocwlowerid{suff'}~\ocwupperid{False}$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~5$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fix2sbruu\_augment}~\ocwlowerid{suff}~=~\ocwlowerid{aug}~(\ocwlowerid{fix2sbruu}~\ocwlowerid{suff})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} \Pan{6,1,6} reduplicated roots dropping the n of 3rd pl -anti \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{abhyasta}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"jak.s"}~$\mid{}~$\ocwstring{"jaag.r"}~$\mid{}~$\ocwstring{"cakaas"}~$\rightarrow{}~\ocwupperid{True}~$\ocwbc{} zaas has special treatment \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_present2a}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{set}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=$\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{person},$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"bruu"}~\ocwkw{then}~$\ocwlowerid{fix2sbruu}~\ocwlowerid{suff}~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{fix2s}~\ocwlowerid{strong}~\ocwlowerid{suff}~\ocwlowerid{set})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=$\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{person},$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"han\#1"}~\ocwkw{then}~$\ocwlowerid{fix2whan}~\ocwlowerid{suff}~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{fix2w}~\ocwlowerid{weak}~\ocwlowerid{suff}~\ocwlowerid{set})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{presa}~2)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"mi"}\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"as\#1"}~\ocwkw{then}~$(\ocwupperid{Second},~\ocwlowerid{code}~$\ocwstring{"asi"}$)$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"si"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{check}~\ocwlowerid{entry}~2~\ocwlowerid{third}~(\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"ti"}$)~$\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=$\ocwstring{"bruu"}~\ocwkw{then}~$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"mi"}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=$\ocwstring{"stu"}~\ocwkw{then}~$[~(\ocwupperid{First},~\ocwlowerid{code}~$\ocwstring{"staviimi"}$)~::~\ocwlowerid{l}~]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l}~$\ocwbc{} bruumi Whitney§632 staviimi Whitney§633 \ocwec{}$)$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"thas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"mas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tha"}\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"zaas"}~\ocwkw{then}~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"ati"}~\ocwbc{} \Pan{7,1,4} \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{conjugw}~\ocwupperid{Third}~($\ocwkw{if}~$\ocwlowerid{abhyasta}~\ocwlowerid{entry}~$\ocwkw{then}~\ocwstring{"ati"}~\ocwkw{else}~\ocwstring{"anti"}$)$\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"m.rj"}~\ocwkw{then}~$[~\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"anti"}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l}~$\ocwbc{} Whitney§627 \ocwec{}$)$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_present2m}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{set}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{person},$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"bruu"}~\ocwkw{then}~$\ocwlowerid{fix2sbruu}~\ocwlowerid{suff}~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{fix2s}~\ocwlowerid{strong}~\ocwlowerid{suff}~\ocwlowerid{set})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=$\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{person},$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"han\#1"}~\ocwkw{then}~$\ocwlowerid{fix2whan}~\ocwlowerid{suff}~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"i"}~\ocwkw{then}~$\ocwlowerid{fix2wi}~\ocwlowerid{suff}~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{fix2w}~\ocwlowerid{weak}~\ocwlowerid{suff}~\ocwlowerid{set})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{presm}~2)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"as\#1"}~\ocwkw{then}~$(\ocwupperid{First},~\ocwlowerid{code}~$\ocwstring{"he"}$)~$\ocwkw{else}\ocweol
\ocwindent{5.00em}
$\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"e"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{check}~\ocwlowerid{entry}~2~\ocwlowerid{third}~(\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"te"}$)~$\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"m.rj"}~\ocwkw{then}~$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"e"}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l}~$\ocwbc{} Whitney§627 \ocwec{}$)$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"vahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"aathe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"aate"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"m.rj"}~\ocwkw{then}~\ocweol
\ocwindent{8.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"aathe"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"aate"}\ocweol
\ocwindent{8.00em}
$]~@~\ocwlowerid{l}$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l}~$\ocwbc{} Whitney§627 \ocwec{}$)~$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"mahe"}~\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"as\#1"}~\ocwkw{then}~$(\ocwupperid{Second},~\ocwlowerid{code}~$\ocwstring{"dhve"}$)~$\ocwkw{else}\ocweol
\ocwindent{5.00em}
$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"dhve"}\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"zii\#1"}~\ocwkw{then}~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"rate"}~\ocwbc{} \Pan{7,1,6} \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ate"}~\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"m.rj"}~\ocwkw{then}~$[~\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"ate"}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"aas\#2"}~\ocwkw{then}~$[~\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ddhve"}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l}~$\ocwbc{} Whitney§627 \ocwec{}$)~$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_impft2a}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{set}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{person},$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"bruu"}~\ocwkw{then}~$\ocwlowerid{fix2sbruu\_augment}~\ocwlowerid{suff}~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{fix2s\_augment}~\ocwlowerid{strong}~\ocwlowerid{suff}~\ocwlowerid{set})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=$\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{person},$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"han\#1"}~\ocwkw{then}~$\ocwlowerid{fix2whan\_augment}~\ocwlowerid{suff}~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{fix2w\_augment}~\ocwlowerid{weak}~\ocwlowerid{suff}~\ocwlowerid{set})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{impfta}~2)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{set}~$\ocwkw{then}~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"as"}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"as\#1"}~\ocwkw{then}~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"iis"}~\ocwbc{} Whitney§621c \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"ad\#1"}~\ocwkw{then}~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"as"}~\ocwbc{} Whitney§621c \ocwec{}\ocweol
\ocwindent{10.00em}
\ocwkw{else}~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"s"}~\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{set}~$\ocwkw{then}~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"at"}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"as\#1"}~\ocwkw{then}~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"iit"}~\ocwbc{} idem aasiit \ocwec{}\ocweol
\ocwindent{7.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"ad\#1"}~\ocwkw{then}~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"at"}~\ocwbc{} idem aadat \ocwec{}\ocweol
\ocwindent{10.00em}
\ocwkw{else}~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{set}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"iis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"iit"}\ocweol
\ocwindent{4.00em}
$]~@~\ocwlowerid{l}~$\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"bruu"}~\ocweol
\ocwindent{9.50em}
\ocwkw{then}~$[~(\ocwupperid{First},~\ocwlowerid{code}~$\ocwstring{"abruvam"}$)~$\ocwbc{} Whitney§632 \ocwec{}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{9.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"va"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"ma"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"i"}~\ocwkw{then}~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"an"}~\ocwbc{} aayan \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"an"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"m.rj"}~\ocweol
\ocwindent{9.00em}
\ocwkw{then}~$[~\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"an"}~::~$\ocwlowerid{l}~]~$\ocwbc{} Whitney§627 \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"bruu"}~\ocweol
\ocwindent{9.00em}
\ocwkw{then}~$[~(\ocwupperid{Third},~\ocwlowerid{code}~$\ocwstring{"abruuvan"}$)~::~\ocwlowerid{l}~]~$\ocwbc{} Whitney§632 \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}~\ocwbc{} Kale§420 optional -us for roots in -aa \ocwec{}\ocweol
\ocwindent{9.00em}
$[~[~2~::~\ocwlowerid{s}~]~\rightarrow{}~[~(\ocwupperid{Third},~\ocwlowerid{aug}~(\ocwlowerid{sandhi}~\ocwlowerid{s}~(\ocwlowerid{code}~$\ocwstring{"us"}$)))~::~\ocwlowerid{l}~]~$\ocweol
\ocwindent{9.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{l}$\ocweol
\ocwindent{9.00em}
$])~$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_impft2m}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{set}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{person},$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"bruu"}~\ocwkw{then}~$\ocwlowerid{fix2sbruu\_augment}~\ocwlowerid{suff}~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{fix2s\_augment}~\ocwlowerid{strong}~\ocwlowerid{suff}~\ocwlowerid{set})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=$\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{person},$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"han\#1"}~\ocwkw{then}~$\ocwlowerid{fix2whan\_augment}~\ocwlowerid{suff}~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{fix2w\_augment}~\ocwlowerid{weak}~\ocwlowerid{suff}~\ocwlowerid{set})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{impftm}~2)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"i"}~\ocwkw{then}~$\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"yi"}~\ocwbc{} adhyaiyi Bucknell 128 \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"thaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"m.rj"}~\ocwkw{then}~$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"i"}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l}~$\ocwbc{} Whitney§627 \ocwec{}$)$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"vahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"aathaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"aataam"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"m.rj"}~\ocwkw{then}~\ocweol
\ocwindent{8.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"aathaam"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"aataam"}\ocweol
\ocwindent{8.00em}
$]~@~\ocwlowerid{l}~$\ocwkw{else}~$\ocwlowerid{l}~$\ocwbc{} Whitney§627 \ocwec{}$)$\ocweol
\ocwindent{2.00em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"mahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"dhvam"}\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"zii\#1"}~\ocwkw{then}~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"rata"}~\ocwbc{} \Pan{7,1,6} \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"i"}~\ocwkw{then}~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"yata"}~\ocwbc{} adhyaiyata Bucknell 128 \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ata"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"m.rj"}~\ocwkw{then}~$[~\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"ata"}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"aas\#2"}~\ocwkw{then}~$[~\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ddhvam"}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=$\ocwstring{"duh\#1"}~\ocwkw{then}~$[~\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ra"}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{7.00em}
\ocwbc{} aduhata -> aduha-a = \Pan{7,1,41} = aduha -> aduhra \Pan{7,1,8} \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l}~$\ocwbc{} Whitney§627 \ocwec{}$)$\ocweol
\ocwindent{1.50em}
$])~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_optative2a}~\ocwlowerid{weak}~\ocwlowerid{set}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=$\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{person},$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"han\#1"}~\ocwkw{then}~$\ocwlowerid{fix2whan}~\ocwlowerid{suff}~$\ocweol
\ocwindent{16.50em}
\ocwkw{else}~$\ocwlowerid{fix2w}~\ocwlowerid{weak}~\ocwlowerid{suff}~\ocwlowerid{set})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{opta}~2)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"yaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"yaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"yaat"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"bruu"}~\ocweol
\ocwindent{6.50em}
\ocwkw{then}~$[~(\ocwupperid{Third},~\ocwlowerid{code}~$\ocwstring{"bruyaat"}$)~$\ocwbc{} Whitney§632 \ocwec{}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"yaava"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"yaatam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"yaataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"yaama"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"yaata"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"yur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_optative2m}~\ocwlowerid{weak}~\ocwlowerid{set}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=$\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{person},$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"han\#1"}~\ocwkw{then}~$\ocwlowerid{fix2whan}~\ocwlowerid{suff}~$\ocweol
\ocwindent{16.50em}
\ocwkw{else}~$\ocwlowerid{fix2w}~\ocwlowerid{weak}~\ocwlowerid{suff}~\ocwlowerid{set})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugwmrij}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},~\ocwlowerid{fix2}~(\ocwlowerid{revcode}~$\ocwstring{"maarj"}$)~\ocwlowerid{suff}~\ocwlowerid{set})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{optm}~2)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"iiya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"iithaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"iita"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"m.rj"}~\ocwkw{then}~\ocweol
\ocwindent{8.00em}
$[~\ocwlowerid{conjugwmrij}~\ocwupperid{First}~$\ocwstring{"iiya"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjugwmrij}~\ocwupperid{Second}~$\ocwstring{"iithaas"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjugwmrij}~\ocwupperid{Third}~$\ocwstring{"iita"}\ocweol
\ocwindent{8.00em}
$]~@~\ocwlowerid{l}~$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l}~$\ocwbc{} Whitney§627 \ocwec{}$)$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"iivahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"iiyaathaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"iiyaataam"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"m.rj"}~\ocwkw{then}~\ocweol
\ocwindent{8.00em}
$[~\ocwlowerid{conjugwmrij}~\ocwupperid{First}~$\ocwstring{"iivahi"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjugwmrij}~\ocwupperid{Second}~$\ocwstring{"iiyaathaam"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjugwmrij}~\ocwupperid{Third}~$\ocwstring{"iiyaataam"}\ocweol
\ocwindent{8.00em}
$]~@~\ocwlowerid{l}~$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l}~$\ocwbc{} Whitney§627 \ocwec{}$)$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"iimahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"iidhvam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"iiran"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"m.rj"}~\ocwkw{then}~\ocweol
\ocwindent{8.00em}
$[~\ocwlowerid{conjugwmrij}~\ocwupperid{First}~$\ocwstring{"iimahi"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjugwmrij}~\ocwupperid{Second}~$\ocwstring{"iidhvam"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjugwmrij}~\ocwupperid{Third}~$\ocwstring{"iiran"}\ocweol
\ocwindent{8.00em}
$]~@~\ocwlowerid{l}~$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l}~$\ocwbc{} Whitney§627 \ocwec{}$)$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_imperative2a}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{set}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{person},$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"bruu"}~\ocwkw{then}~$\ocwlowerid{fix2sbruu}~\ocwlowerid{suff}~$\ocweol
\ocwindent{16.00em}
\ocwkw{else}~$\ocwlowerid{fix2s}~\ocwlowerid{strong}~\ocwlowerid{suff}~\ocwlowerid{set})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=$\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{person},$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"han\#1"}~\ocwkw{then}~$\ocwlowerid{fix2whan}~\ocwlowerid{suff}~$\ocweol
\ocwindent{16.50em}
\ocwkw{else}~$\ocwlowerid{fix2w}~\ocwlowerid{weak}~\ocwlowerid{suff}~\ocwlowerid{set})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{impera}~2)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$(\ocwupperid{Second},~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~$\ocwstring{"as\#1"}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"edhi"}\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"zaas"}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"zaadhi"}~\ocweol
\ocwindent{0.50em}
\ocwbc{} above leads to conflict between \Pan{6.4.35} (zaa+hi) and \Pan{6.4.101} 
    (zaas+dhi) \ocwbegindcode{}$\ocwlowerid{asiddhavat}$\ocwenddcode{} => we operate in parallel zaa+dhi= zaadhi \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"han\#1"}~\ocwkw{then}~$\ocwlowerid{revcode}~$\ocwstring{"ja"}~\ocwkw{else}~$\ocwlowerid{weak}~$\ocwkw{in}\ocweol
\ocwindent{8.50em}
\ocwkw{match}~$\ocwlowerid{w}~$\ocwkw{with}~\ocweol
\ocwindent{6.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{fix2}~\ocwlowerid{w}~\ocwlowerid{suff}~\ocwlowerid{set}$\ocweol
\ocwindent{7.00em}
$\ocwlowerid{where}~\ocwlowerid{suff}~=~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~\lor{}~\ocwlowerid{set}~$\ocwkw{then}~\ocwstring{"hi"}~\ocwkw{else}~\ocwstring{"dhi"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{error\_empty}~6$\ocweol
\ocwindent{6.00em}
$]~$\ocwbc{} \ocwstring{"dhi"} or \ocwstring{"hi"} after vowel \ocwec{}\ocweol
\ocwindent{5.00em}
$])$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"tu"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"vac"}~\ocwkw{then}~\ocweol
\ocwindent{8.00em}
$[~(\ocwupperid{Second},~\ocwlowerid{code}~$\ocwstring{"voci"}$);~(\ocwupperid{Third},~\ocwlowerid{code}~$\ocwstring{"vocatu"}$)~]~@~\ocwlowerid{l}$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=$\ocwstring{"bruu"}~\ocwkw{then}~$[~\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"hi"}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{9.00em}
\ocwbc{} braviihi Whitney§632 \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aava"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aama"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"zaas"}~\ocwkw{then}~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"atu"}~\ocwbc{} \Pan{7,1,4} \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$\ocwlowerid{conjugw}~\ocwupperid{Third}~($\ocwkw{if}~$\ocwlowerid{abhyasta}~\ocwlowerid{entry}~$\ocwkw{then}~\ocwstring{"atu"}~\ocwkw{else}~\ocwstring{"antu"}$)~$\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"m.rj"}~\ocwkw{then}~$[~\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"antu"}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l}~$\ocwbc{} Whitney§627 \ocwec{}$)$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_imperative2m}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{set}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{person},$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"bruu"}~\ocwkw{then}~$\ocwlowerid{fix2sbruu}~\ocwlowerid{suff}~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{fix2s}~\ocwlowerid{strong}~\ocwlowerid{suff}~\ocwlowerid{set})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=$\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{person},$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"han\#1"}~\ocwkw{then}~$\ocwlowerid{fix2whan}~\ocwlowerid{suff}~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{fix2w}~\ocwlowerid{weak}~\ocwlowerid{suff}~\ocwlowerid{set})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{imperm}~2)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"ai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"sva"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aavahai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"aathaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"aataam"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"m.rj"}~\ocwkw{then}~\ocweol
\ocwindent{8.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"aathaam"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"aataam"}\ocweol
\ocwindent{8.00em}
$]~@~\ocwlowerid{l}$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l}~$\ocwbc{} Whitney§627 \ocwec{}$)$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aamahai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"dhvam"}\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"zii\#1"}~\ocwkw{then}~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"rataam"}~\ocwbc{} \Pan{7,1,6} \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ataam"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"m.rj"}~\ocwkw{then}~$[~\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"ataam"}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"aas\#2"}~\ocwkw{then}~$[~\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ddhvam"}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l}~$\ocwbc{} Whitney§627 \ocwec{}$)$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_active\_present2}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{set}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_athematic\_present2a}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{set}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{weak}~=~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"as\#1"}~\ocwkw{then}~$[~48;~1~]~$\ocwkw{else}~$\ocwlowerid{wstem}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{compute\_athematic\_impft2a}~\ocwlowerid{sstem}~\ocwlowerid{weak}~\ocwlowerid{set}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_optative2a}~\ocwlowerid{wstem}~\ocwlowerid{set}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_imperative2a}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{set}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{wstem}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~[~2~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwbc{} Ppr of roots in -aa is complex and overgenerates \ocwec{}\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{m\_pstem}~=~\ocwlowerid{wstem}~$\ocwkw{and}~$\ocwlowerid{f\_pstem}~=~\ocwlowerid{rev}~(\ocwlowerid{fix2w}~\ocwlowerid{wstem}~$\ocwstring{"at"}~$\ocwlowerid{set})~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{record\_part}~(\ocwupperid{Ppra\_}~2~\ocwupperid{Primary}~\ocwlowerid{m\_pstem}~\ocwlowerid{f\_pstem}~\ocwlowerid{entry})~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{m\_pstem}~=~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"han\#1"}~\ocwkw{then}~$\ocwlowerid{revstem}~$\ocwstring{"ghn"}~\ocweol
\ocwindent{12.50em}
\ocwkw{else}~$\ocwlowerid{correct2}~\ocwlowerid{wstem}~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{f\_pstem}~=~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"han\#1"}~\ocwkw{then}~$\ocwlowerid{revstem}~$\ocwstring{"ghnat"}~\ocweol
\ocwindent{12.50em}
\ocwkw{else}~$\ocwlowerid{rev}~(\ocwlowerid{fix2w}~\ocwlowerid{wstem}~$\ocwstring{"at"}~$\ocwlowerid{set})~$\ocwkw{in}~\ocweol
\ocwindent{5.50em}
$\ocwlowerid{record\_part}~(\ocwupperid{Ppra\_}~2~\ocwupperid{Primary}~\ocwlowerid{m\_pstem}~\ocwlowerid{f\_pstem}~\ocwlowerid{entry})$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"m.rj"}~\ocwkw{then}~\ocwkw{let}~$\ocwlowerid{m\_pstem}~=~\ocwlowerid{revstem}~$\ocwstring{"maarj"}~\ocwkw{in}\ocweol
\ocwindent{13.50em}
\ocwkw{let}~$\ocwlowerid{f\_pstem}~=~\ocwlowerid{revstem}~$\ocwstring{"maarjat"}~\ocwkw{in}\ocweol
\ocwindent{13.50em}
$\ocwlowerid{record\_part}~(\ocwupperid{Ppra\_}~2~\ocwupperid{Primary}~\ocwlowerid{m\_pstem}~\ocwlowerid{f\_pstem}~\ocwlowerid{entry})$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$()$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_middle\_present2}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{set}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_athematic\_present2m}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{set}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_impft2m}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{set}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_optative2m}~\ocwlowerid{wstem}~\ocwlowerid{set}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_imperative2m}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{set}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"maa\#1"}~$\rightarrow{}~()~$\ocwbc{} no pprm \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"i"}~$\rightarrow{}~\ocwlowerid{record\_part\_m\_ath}~(\ocwlowerid{pprm}~2)~[~42;~3~]~\ocwlowerid{entry}~$\ocwbc{} iyaana \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{record\_part\_m\_ath}~(\ocwlowerid{pprm}~2)~(\ocwlowerid{correct2}~\ocwlowerid{wstem})~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
** Gana 3  **
\ocweol
\label{verbs.ml:46812}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{strip\_ii}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[~4~::~\ocwlowerid{w}~]~\rightarrow{}~\ocwlowerid{w}~$\ocwbc{} ii disappears before vowels in special roots \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Wrong\ocwvspace{}weak\ocwvspace{}stem\ocwvspace{}of\ocwvspace{}special\ocwvspace{}3rd\ocwvspace{}class\ocwvspace{}root"}\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fix3w}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{dadh}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{codesf}~=~\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{short}~=~$\ocwkw{if}~$\ocwlowerid{iiflag}~$\ocwkw{then}~$\ocwlowerid{strip\_ii}~\ocwlowerid{wstem}~$\ocwkw{else}~$\ocwlowerid{wstem}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{codesf}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~8$\ocweol
\ocwindent{2.50em}
$\mid{}~[~5;~43~]~$\ocwbc{} ur \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{iiflag}~$\ocwkw{then}~$\ocwlowerid{short}~$\ocwkw{else}~$\ocwlowerid{strong}~\ocwlowerid{wstem}~$\ocwbc{} guna \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{dadh}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}~\ocwbc{} Gonda§66 \ocwec{}\ocweol
\ocwindent{6.00em}
$[~32~\mid{}~33~\mid{}~35~\mid{}~48~\mid{}~49~$\ocwbc{} t th dh s h \ocwec{}~$\rightarrow{}~\ocwlowerid{revstem}~$\ocwstring{"dhad"}~\ocweol
\ocwindent{7.50em}
\ocwbc{} aspirate correction of sandhi not enough : dh+t=ddh not tt \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{short}$\ocweol
\ocwindent{6.00em}
$]~$\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{short}~$\ocwkw{else}~$\ocwlowerid{wstem}$\ocweol
\ocwindent{2.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{sandhi}~\ocwlowerid{stem}~\ocwlowerid{codesf}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fix3w\_augment}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{dadh}~\ocwlowerid{suff}~=~\ocwlowerid{aug}~(\ocwlowerid{fix3w}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{dadh}~\ocwlowerid{suff})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_present3a}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{dadh\_flag}~=~(\ocwlowerid{entry}=$\ocwstring{"dhaa\#1"}$)~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix3w}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{dadh\_flag}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjughaa}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~(\ocwlowerid{revstem}~$\ocwstring{"jahi"}$)~\ocwlowerid{suff})~$\ocweol
\ocwindent{15.00em}
\ocwbc{} weak = jahii but optionally jahi \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{haa\_flag}~=~(\ocwlowerid{entry}=$\ocwstring{"haa\#1"}$)~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{presa}~3)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"mi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"si"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{check}~\ocwlowerid{entry}~3~\ocwlowerid{third}~(\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"ti"}$)~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"thas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{haa\_flag}~$\ocwkw{then}~$\ocwlowerid{l}~@$\ocweol
\ocwindent{8.00em}
$[~\ocwlowerid{conjughaa}~\ocwupperid{First}~$\ocwstring{"vas"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjughaa}~\ocwupperid{Second}~$\ocwstring{"thas"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjughaa}~\ocwupperid{Third}~$\ocwstring{"tas"}\ocweol
\ocwindent{8.00em}
$]~$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"mas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ati"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{haa\_flag}~$\ocwkw{then}~$\ocwlowerid{l}~@$\ocweol
\ocwindent{8.00em}
$[~\ocwlowerid{conjughaa}~\ocwupperid{First}~$\ocwstring{"mas"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjughaa}~\ocwupperid{Second}~$\ocwstring{"tha"}\ocweol
\ocwindent{8.00em}
$]~$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{wstem}~=~$\ocwkw{if}~$\ocwlowerid{iiflag}~$\ocwkw{then}~$\ocwlowerid{strip\_ii}~\ocwlowerid{weak}~$\ocwkw{else}~$\ocwlowerid{weak}~$\ocwkw{in}~\ocwbc{} 3rd pl weak stem \ocwec{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{record\_part}~(\ocwupperid{Pprared\_}~\ocwupperid{Primary}~\ocwlowerid{wstem}~\ocwlowerid{entry})~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_present3m}~\ocwlowerid{conj}~\ocwlowerid{gana}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{dadh\_flag}~=~(\ocwlowerid{entry}=$\ocwstring{"dhaa\#1"}$)~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix3w}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{dadh\_flag}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{fpresm}~\ocwlowerid{gana}~\ocwlowerid{conj})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"e"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{check}~\ocwlowerid{entry}~3~\ocwlowerid{third}~(\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"te"}$)~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"vahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"aathe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"aate"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"mahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"dhve"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ate"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_impft3a}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{dadh\_flag}~=~(\ocwlowerid{entry}=$\ocwstring{"dhaa\#1"}$)~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix3w\_augment}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{dadh\_flag}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjughaa}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~(\ocwlowerid{revstem}~$\ocwstring{"jahi"}$)~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{haa\_flag}~=~(\ocwlowerid{entry}=$\ocwstring{"haa\#1"}$)~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{impfta}~3)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"s"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{haa\_flag}~$\ocwkw{then}~$\ocwlowerid{l}~@$\ocweol
\ocwindent{8.00em}
$[~\ocwlowerid{conjughaa}~\ocwupperid{Second}~$\ocwstring{"s"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjughaa}~\ocwupperid{Third}~$\ocwstring{"t"}\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"va"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{haa\_flag}~$\ocwkw{then}~$\ocwlowerid{l}~@$\ocweol
\ocwindent{8.00em}
$[~\ocwlowerid{conjughaa}~\ocwupperid{First}~$\ocwstring{"va"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjughaa}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjughaa}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{8.00em}
$]~$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"ma"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{haa\_flag}~$\ocwkw{then}~$\ocwlowerid{l}~@$\ocweol
\ocwindent{8.00em}
$[~\ocwlowerid{conjughaa}~\ocwupperid{First}~$\ocwstring{"ma"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjughaa}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} common to \ocwbegindcode{}$\ocwlowerid{impft\_m}$\ocwenddcode{}  and \ocwbegindcode{}$\ocwlowerid{root\_aoristm}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{conjugs\_past\_m}~\ocwlowerid{conjug}~=$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"thaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"vahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"aathaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"aataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"mahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"dhvam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ata"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{conjug\_impft\_m}~\ocwlowerid{gana}~\ocwlowerid{conjugw}~=~$\ocwbc{} used by classes 3 and 9 \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwupperid{Conju}~(\ocwlowerid{impftm}~\ocwlowerid{gana})~(\ocwlowerid{conjugs\_past\_m}~\ocwlowerid{conjugw})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_impft3m}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{dadh\_flag}~=~(\ocwlowerid{entry}=$\ocwstring{"dhaa\#1"}$)~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix3w\_augment}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{dadh\_flag}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwlowerid{conjug\_impft\_m}~3~\ocwlowerid{conjugw})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Like \ocwbegindcode{}$\ocwlowerid{compute\_athematic\_optative2a}$\ocwenddcode{} except for \ocwbegindcode{}$\ocwlowerid{yan}\#1$\ocwenddcode{} et \ocwbegindcode{}$\ocwlowerid{bruu}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{conjug\_optativea}~\ocwlowerid{gana}~\ocwlowerid{conj}~\ocwlowerid{conjugw}~=$\ocweol
\ocwindent{1.00em}
$\ocwupperid{Conju}~(\ocwlowerid{fopta}~\ocwlowerid{gana}~\ocwlowerid{conj})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"yaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"yaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"yaat"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"yaava"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"yaatam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"yaataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"yaama"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"yaata"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"yur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{conjug\_opt\_ath\_a}~\ocwlowerid{gana}~=~\ocwlowerid{conjug\_optativea}~\ocwlowerid{gana}~\ocwupperid{Primary}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_optative3a}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{dadh\_flag}~=~(\ocwlowerid{entry}=$\ocwstring{"dhaa\#1"}$)~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{entry}=$\ocwstring{"haa\#1"}~\ocwkw{then}~$\ocwlowerid{fix}~(\ocwlowerid{revstem}~$\ocwstring{"jah"}$)~\ocwlowerid{suff}$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~$\ocwlowerid{fix3w}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{dadh\_flag}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwlowerid{conjug\_opt\_ath\_a}~3~\ocwlowerid{conjugw})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{conjug\_opt\_ath\_m}~\ocwlowerid{gana}~\ocwlowerid{conjugw}~=$\ocweol
\ocwindent{1.00em}
$\ocwupperid{Conju}~(\ocwlowerid{optm}~\ocwlowerid{gana})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"iiya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"iithaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"iita"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"iivahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"iiyaathaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"iiyaataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"iimahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"iidhvam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"iiran"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_optative3m}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{dadh\_flag}~=~(\ocwlowerid{entry}=$\ocwstring{"dhaa\#1"}$)~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix3w}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{dadh\_flag}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwlowerid{conjug\_opt\_ath\_m}~3~\ocwlowerid{conjugw})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_imperative3a}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{dadh\_flag}~=~(\ocwlowerid{entry}=$\ocwstring{"dhaa\#1"}$)~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{daa\_flag}~=~(\ocwlowerid{entry}=$\ocwstring{"daa\#1"}$)~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{haa\_flag}~=~(\ocwlowerid{entry}=$\ocwstring{"haa\#1"}$)~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix3w}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{dadh\_flag}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjughaa}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~(\ocwlowerid{revstem}~$\ocwstring{"jahi"}$)~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{impera}~3)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$(\ocwupperid{Second},~$\ocwkw{if}~$\ocwlowerid{daa\_flag}~$\ocwkw{then}~$\ocwlowerid{code}~$\ocwstring{"dehi"}~\ocwbc{} \Pan{4,4,119} \ocwec{}\ocweol
\ocwindent{9.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{dadh\_flag}~$\ocwkw{then}~$\ocwlowerid{code}~$\ocwstring{"dhehi"}~\ocwbc{} idem ghu \Pan{1,1,20} \ocwec{}\ocweol
\ocwindent{9.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}~\ocweol
\ocwindent{6.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{fix3w}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{dadh\_flag}~\ocwlowerid{suff}~$\ocweol
\ocwindent{7.00em}
$\ocwlowerid{where}~\ocwlowerid{suff}~=~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocwbc{} \ocwstring{"dhi"} or \ocwstring{"hi"} after vowel \ocwec{}\ocweol
\ocwindent{15.00em}
\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"hu"}~\ocwkw{then}~\ocwstring{"dhi"}~\ocwkw{else}~\ocwstring{"hi"}~\ocweol
\ocwindent{14.00em}
\ocwkw{else}~\ocwstring{"dhi"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{error\_empty}~7$\ocweol
\ocwindent{6.00em}
$]~)~$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"tu"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{haa\_flag}~$\ocwkw{then}~$\ocwlowerid{l}~@$\ocweol
\ocwindent{8.00em}
$[~\ocwlowerid{conjughaa}~\ocwupperid{Second}~$\ocwstring{"hi"}~\ocwbc{} jahihi \ocwec{}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"hi"}~\ocwbc{} jahaahi \ocwec{}~\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjughaa}~\ocwupperid{Third}~$\ocwstring{"tu"}~\ocwbc{} jahitu \ocwec{}\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l})~$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aava"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{haa\_flag}~$\ocwkw{then}~$\ocwlowerid{l}~@$\ocweol
\ocwindent{8.00em}
$[~\ocwlowerid{conjughaa}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{conjughaa}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aama"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"atu"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{haa\_flag}~$\ocwkw{then}~$\ocwlowerid{l}~@~[~\ocwlowerid{conjughaa}~\ocwupperid{Second}~$\ocwstring{"ta"}~$]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_imp\_ath\_m}~\ocwlowerid{gana}~\ocwlowerid{conjugs}~\ocwlowerid{conjugw}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{imperm}~\ocwlowerid{gana})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"ai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"sva"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aavahai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"aathaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"aataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aamahai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"dhvam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_imperative3m}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{dadh\_flag}~=~(\ocwlowerid{entry}=$\ocwstring{"dhaa\#1"}$)~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix3w}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{dadh\_flag}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{compute\_imp\_ath\_m}~3~\ocwlowerid{conjugs}~\ocwlowerid{conjugw}~\ocwlowerid{entry}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_active\_present3}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_athematic\_present3a}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_impft3a}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_optative3a}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_imperative3a}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
\}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_middle\_present3}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_athematic\_present3m}~\ocwupperid{Primary}~3~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_impft3m}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_optative3m}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_imperative3m}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{short}~=~$\ocwkw{if}~$\ocwlowerid{iiflag}~$\ocwkw{then}~$\ocwlowerid{strip\_ii}~\ocwlowerid{wstem}~$\ocwkw{else}~$\ocwlowerid{wstem}~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
$\ocwlowerid{record\_part\_m\_ath}~(\ocwlowerid{pprm}~3)~\ocwlowerid{short}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
** Gana 5  **
\ocweol
\label{verbs.ml:56257}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_present5a}~\ocwlowerid{gana}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{vow}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$\ocwlowerid{weak}~$\ocwkw{else}~$[~45~$\ocwbc{} v \ocwec{}~::~$\ocwlowerid{weak}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{w}~\ocwlowerid{suff})$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~9$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw2}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[~5~::~\ocwlowerid{no\_u}~]~\rightarrow{}~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{no\_u}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"5a\ocwvspace{}weak\ocwvspace{}ought\ocwvspace{}to\ocwvspace{}end\ocwvspace{}in\ocwvspace{}u"}\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{presa}~\ocwlowerid{gana})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"mi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"si"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{check}~\ocwlowerid{entry}~\ocwlowerid{gana}~\ocwlowerid{third}~(\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"ti"}$)~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"thas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$[~\ocwlowerid{conjugw2}~\ocwupperid{First}~$\ocwstring{"vas"}~\ocwbc{} optional elision of u \ocwec{}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{7.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"mas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"anti"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$[~\ocwlowerid{conjugw2}~\ocwupperid{First}~$\ocwstring{"mas"}~\ocwbc{} optional elision of u \ocwec{}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{7.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{m\_pstem}~=~$\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$\ocwlowerid{weak}~$\ocwkw{else}~$[~45~$\ocwbc{} v \ocwec{}~::~$\ocwlowerid{weak}~]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{f\_pstem}~=~\ocwlowerid{rfix}~\ocwlowerid{m\_pstem}~$\ocwstring{"at"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{record\_part}~(\ocwupperid{Ppra\_}~5~\ocwupperid{Primary}~\ocwlowerid{m\_pstem}~\ocwlowerid{f\_pstem}~\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_present5m}~\ocwlowerid{gana}~\ocwlowerid{weak}~\ocwlowerid{vow}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocweol
\ocwindent{12.50em}
\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$\ocwlowerid{weak}~$\ocwkw{else}~$[~45~$\ocwbc{} v \ocwec{}~::~$\ocwlowerid{weak}~]~$\ocwkw{in}\ocweol
\ocwindent{12.50em}
$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{w}~\ocwlowerid{suff})$\ocweol
\ocwindent{11.00em}
\ocwkw{else}~$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~17$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw2}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[~5~::~\ocwlowerid{no\_u}~]~\rightarrow{}~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{no\_u}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"5m\ocwvspace{}weak\ocwvspace{}ought\ocwvspace{}to\ocwvspace{}end\ocwvspace{}in\ocwvspace{}u"}\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{presm}~\ocwlowerid{gana})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"e"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{check}~\ocwlowerid{entry}~\ocwlowerid{gana}~\ocwlowerid{third}~(\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"te"}$)~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"vahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"aathe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"aate"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$[~\ocwlowerid{conjugw2}~\ocwupperid{First}~$\ocwstring{"vahe"}~\ocwbc{} optional elision of u \ocwec{}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"mahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"dhve"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ate"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$[~\ocwlowerid{conjugw2}~\ocwupperid{First}~$\ocwstring{"mahe"}~\ocwbc{} optional elision of u \ocwec{}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_impft5a}~\ocwlowerid{gana}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{vow}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$\ocwlowerid{weak}~$\ocwkw{else}~$[~45~$\ocwbc{} v \ocwec{}~::~$\ocwlowerid{weak}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{w}~\ocwlowerid{suff})$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{weak}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~10$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw2}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[~5~::~\ocwlowerid{no\_u}~]~\rightarrow{}~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{no\_u}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"5a\ocwvspace{}weak\ocwvspace{}ought\ocwvspace{}to\ocwvspace{}end\ocwvspace{}in\ocwvspace{}u"}\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{impfta}~\ocwlowerid{gana})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
$])~$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"va"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$[~\ocwlowerid{conjugw2}~\ocwupperid{First}~$\ocwstring{"va"}~\ocwbc{} optional elision of u \ocwec{}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"ma"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"an"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$[~\ocwlowerid{conjugw2}~\ocwupperid{First}~$\ocwstring{"ma"}~\ocwbc{} optional elision of u \ocwec{}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_impft5m}~\ocwlowerid{gana}~\ocwlowerid{weak}~\ocwlowerid{vow}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$\ocwlowerid{weak}~$\ocwkw{else}~$[~45~$\ocwbc{} v \ocwec{}~::~$\ocwlowerid{weak}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{w}~\ocwlowerid{suff})$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{weak}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~14$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw2}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[~5~::~\ocwlowerid{no\_u}~]~\rightarrow{}~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{no\_u}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"5m\ocwvspace{}weak\ocwvspace{}ought\ocwvspace{}to\ocwvspace{}end\ocwvspace{}in\ocwvspace{}u"}\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{impftm}~\ocwlowerid{gana})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"thaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"vahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"aathaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"aataam"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$[~\ocwlowerid{conjugw2}~\ocwupperid{First}~$\ocwstring{"vahi"}~\ocwbc{} optional elision of u \ocwec{}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"mahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"dhvam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ata"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$[~\ocwlowerid{conjugw2}~\ocwupperid{First}~$\ocwstring{"mahi"}~\ocwbc{} optional elision of u \ocwec{}~::~$\ocwlowerid{l}~]$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_optative5a}~\ocwlowerid{gana}~\ocwlowerid{weak}~\ocwlowerid{vow}~\ocwlowerid{entry}~=~$\ocwbc{} gana=5 or 8 \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$\ocwlowerid{weak}~$\ocwkw{else}~$[~45~$\ocwbc{} v \ocwec{}~::~$\ocwlowerid{weak}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{w}~\ocwlowerid{suff})$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~11$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwlowerid{conjug\_opt\_ath\_a}~\ocwlowerid{gana}~\ocwlowerid{conjugw})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_optative5m}~\ocwlowerid{gana}~\ocwlowerid{weak}~\ocwlowerid{vow}~\ocwlowerid{entry}~=~$\ocwbc{} gana=5 or 8 \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$\ocwlowerid{weak}~$\ocwkw{else}~$[~45~$\ocwbc{} v \ocwec{}~::~$\ocwlowerid{weak}~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{w}~\ocwlowerid{suff})$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~19$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwlowerid{conjug\_opt\_ath\_m}~\ocwlowerid{gana}~\ocwlowerid{conjugw})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_imperative5a}~\ocwlowerid{gana}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{vow}~\ocwlowerid{entry}~=~$\ocwbc{} gana=5 or 8 \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocweol
\ocwindent{12.50em}
\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$\ocwlowerid{weak}~$\ocwkw{else}~$[~45~$\ocwbc{} v \ocwec{}~::~$\ocwlowerid{weak}~]~$\ocwkw{in}\ocweol
\ocwindent{12.50em}
$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{w}~\ocwlowerid{suff})$\ocweol
\ocwindent{11.00em}
\ocwkw{else}~$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~$\ocwstring{""}$)$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{impera}~\ocwlowerid{gana})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~($\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~\ocwstring{""}~\ocwkw{else}~\ocwstring{"hi"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"tu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aava"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aama"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"antu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_imperative5m}~\ocwlowerid{gana}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{vow}~\ocwlowerid{entry}~=~$\ocwbc{} gana=5 or 8 \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$\ocwlowerid{weak}~$\ocwkw{else}~$[~45~$\ocwbc{} v \ocwec{}~::~$\ocwlowerid{weak}~]~$\ocwkw{in}\ocweol
\ocwindent{7.00em}
$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{w}~\ocwlowerid{suff})$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~$\ocwstring{""}$)$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{compute\_imp\_ath\_m}~\ocwlowerid{gana}~\ocwlowerid{conjugs}~\ocwlowerid{conjugw}~\ocwlowerid{entry}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Used by classes 5 and 8 \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_active\_present5}~\ocwlowerid{gana}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{vow}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_athematic\_present5a}~\ocwlowerid{gana}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{vow}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_impft5a}~\ocwlowerid{gana}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{vow}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_optative5a}~\ocwlowerid{gana}~\ocwlowerid{wstem}~\ocwlowerid{vow}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_imperative5a}~\ocwlowerid{gana}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{vow}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
\}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_middle\_present5}~\ocwlowerid{gana}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{vow}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_athematic\_present5m}~\ocwlowerid{gana}~\ocwlowerid{wstem}~\ocwlowerid{vow}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_impft5m}~\ocwlowerid{gana}~\ocwlowerid{wstem}~\ocwlowerid{vow}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_optative5m}~\ocwlowerid{gana}~\ocwlowerid{wstem}~\ocwlowerid{vow}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_imperative5m}~\ocwlowerid{gana}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{vow}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part\_m\_ath}~(\ocwlowerid{pprm}~5)~\ocwlowerid{wstem}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Also used by gana 8 \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_present5}~\ocwlowerid{gana}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{vow}~\ocwlowerid{entry}~\ocwlowerid{third}~\ocwlowerid{pada}~\ocwlowerid{padam}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{voices\_of\_gana}~\ocwlowerid{gana}~\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Para}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{compute\_active\_present5}~\ocwlowerid{gana}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{vow}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{5.50em}
\ocwkw{else}~$\ocwlowerid{emit\_warning}~($\ocwstring{"Unexpected\ocwvspace{}middle\ocwvspace{}form:\ocwvspace{}"}~\^{}~$\ocwlowerid{entry})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Atma}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{padam}~$\ocwkw{then}~$\ocwlowerid{emit\_warning}~($\ocwstring{"Unexpected\ocwvspace{}active\ocwvspace{}form:\ocwvspace{}"}~\^{}~$\ocwlowerid{entry})$\ocweol
\ocwindent{5.50em}
\ocwkw{else}~$\ocwlowerid{compute\_middle\_present5}~\ocwlowerid{gana}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{vow}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Ubha}~\rightarrow{}~$\ocweol
\ocwindent{5.00em}
\ocwkw{let}~$\ocwlowerid{thirda}~=~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~$\ocwlowerid{third}~$\ocwkw{else}~$[\,]$\ocweol
\ocwindent{5.00em}
\ocwkw{and}~$\ocwlowerid{thirdm}~=~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~$[\,]~$\ocwkw{else}~$\ocwlowerid{third}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{5.00em}
\{~$\ocwlowerid{compute\_active\_present5}~\ocwlowerid{gana}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{vow}~\ocwlowerid{entry}~\ocwlowerid{thirda}$\ocweol
\ocwindent{5.00em}
;~$\ocwlowerid{compute\_middle\_present5}~\ocwlowerid{gana}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{vow}~\ocwlowerid{entry}~\ocwlowerid{thirdm}$\ocweol
\ocwindent{5.00em}
\}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
** Gana 7  **
\ocweol
\label{verbs.ml:64661}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_present7a}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{presa}~7)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"mi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"si"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{check}~\ocwlowerid{entry}~7~\ocwlowerid{third}~(\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"ti"}$)~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"thas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"mas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"anti"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{m\_pstem}~=~\ocwlowerid{weak}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{f\_pstem}~=~\ocwlowerid{rfix}~\ocwlowerid{weak}~$\ocwstring{"at"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{record\_part}~(\ocwupperid{Ppra\_}~7~\ocwupperid{Primary}~\ocwlowerid{m\_pstem}~\ocwlowerid{f\_pstem}~\ocwlowerid{entry})~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_present7m}~\ocwlowerid{weak}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{presm}~7)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"e"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{check}~\ocwlowerid{entry}~7~\ocwlowerid{third}~(\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"te"}$)~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"vahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"aathe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"aate"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"mahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"dhve"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ate"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_impft7a}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{weak}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{impfta}~7)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"s"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{match}~$\ocwlowerid{rev}~(\ocwlowerid{fix\_augment}~\ocwlowerid{strong}~$\ocwstring{"s"}$)~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}=32~$\ocwbc{} t \ocwec{}~\ocwkw{then}~\ocweol
\ocwindent{16.00em}
$[~(\ocwupperid{Second},\ocwlowerid{rev}~[~48~$\ocwbc{} s \ocwec{}~::~$\ocwlowerid{r}~])~::~\ocwlowerid{l}~]$\ocweol
\ocwindent{16.00em}
\ocwbc{} abhinad-s -> abhinat or abhinas \ocwec{}\ocweol
\ocwindent{14.50em}
\ocwkw{else}~$\ocwlowerid{l}~$\ocwbc{} horrible patch \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{error\_empty}~8$\ocweol
\ocwindent{6.50em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"va"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"ma"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"an"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_impft7m}~\ocwlowerid{weak}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{weak}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{impftm}~7)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"thaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"vahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"aathaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"aataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"mahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"dhvam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ata"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_optative7a}~\ocwlowerid{weak}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{glue}~=~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"hi.ms"}~\ocwkw{then}~\ocwkw{fun}~$\ocwlowerid{w}~\ocwlowerid{s}~\rightarrow{}~$\ocweol
\ocwindent{8.00em}
$\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{w}~(\ocwlowerid{code}~\ocwlowerid{s})~$\ocwbc{} no retroflexion Whitney§183a \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{fix}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{glue}~\ocwlowerid{weak}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwlowerid{conjug\_opt\_ath\_a}~7~\ocwlowerid{conjugw})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_optative7m}~\ocwlowerid{weak}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwlowerid{conjug\_opt\_ath\_m}~7~\ocwlowerid{conjugw})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_imperative7a}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{impera}~7)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$(\ocwupperid{Second},~$\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}~\ocweol
\ocwindent{6.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff}~$\ocweol
\ocwindent{7.00em}
$\ocwlowerid{where}~\ocwlowerid{suff}~=~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocwstring{"hi"}~\ocwkw{else}~\ocwstring{"dhi"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{error\_empty}~9$\ocweol
\ocwindent{6.00em}
$])~$\ocwbc{} \ocwstring{"dhi"} or \ocwstring{"hi"} after vowel \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"tu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aava"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aama"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"antu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_imperative7m}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{compute\_imp\_ath\_m}~7~\ocwlowerid{conjugs}~\ocwlowerid{conjugw}~\ocwlowerid{entry}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_active\_present7}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_athematic\_present7a}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_impft7a}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_optative7a}~\ocwlowerid{wstem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_imperative7a}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
\}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_middle\_present7}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_athematic\_present7m}~\ocwlowerid{wstem}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_impft7m}~\ocwlowerid{wstem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_optative7m}~\ocwlowerid{wstem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_imperative7m}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part\_m\_ath}~(\ocwlowerid{pprm}~7)~\ocwlowerid{wstem}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_present7}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{entry}~\ocwlowerid{third}~\ocwlowerid{pada}~\ocwlowerid{padam}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{voices\_of\_gana}~7~\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Para}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~$\ocwlowerid{compute\_active\_present7}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~$\ocwlowerid{emit\_warning}~($\ocwstring{"Unexpected\ocwvspace{}middle\ocwvspace{}form:\ocwvspace{}"}~\^{}~$\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Atma}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{padam}~$\ocwkw{then}~$\ocwlowerid{emit\_warning}~($\ocwstring{"Unexpected\ocwvspace{}active\ocwvspace{}form:\ocwvspace{}"}~\^{}~$\ocwlowerid{entry})$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~$\ocwlowerid{compute\_middle\_present7}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ubha}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{thirda}~=~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~$\ocwlowerid{third}~$\ocwkw{else}~$[\,]$\ocweol
\ocwindent{6.00em}
\ocwkw{and}~$\ocwlowerid{thirdm}~=~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~$[\,]~$\ocwkw{else}~$\ocwlowerid{third}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{6.00em}
\{~$\ocwlowerid{compute\_active\_present7}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{entry}~\ocwlowerid{thirda}$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{compute\_middle\_present7}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{entry}~\ocwlowerid{thirdm}$\ocweol
\ocwindent{6.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
** Gana 8  **
\ocweol
\ocwindent{0.00em}
Conjugation of k.r 
\ocweol
\ocwindent{2.50em}
"karo" "kuru" "kur" 
\ocweol
\label{verbs.ml:70015}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_presentk}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{short}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugwvm}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{short}~\ocwlowerid{suff})~$\ocwbc{} -v -m suff \ocwec{}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{presa}~8)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"mi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"si"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{check}~\ocwlowerid{entry}~8~\ocwlowerid{third}~(\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"ti"}$)~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugwvm}~\ocwupperid{First}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"thas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugwvm}~\ocwupperid{First}~$\ocwstring{"mas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"anti"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{f\_pstem}~=~\ocwlowerid{rfix}~\ocwlowerid{weak}~$\ocwstring{"at"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{record\_part}~(\ocwupperid{Ppra\_}~8~\ocwupperid{Primary}~\ocwlowerid{weak}~\ocwlowerid{f\_pstem}~\ocwlowerid{entry})~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part\_m\_ath}~(\ocwlowerid{pprm}~8)~\ocwlowerid{weak}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{presm}~8)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"e"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"te"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugwvm}~\ocwupperid{First}~$\ocwstring{"vahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"aathe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"aate"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugwvm}~\ocwupperid{First}~$\ocwstring{"mahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"dhve"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ate"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_impftk}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{short}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{weak}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugwvm}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{short}~\ocwlowerid{suff})~$\ocwbc{} -v -m suff \ocwec{}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{impfta}~8)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
$])~$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugwvm}~\ocwupperid{First}~$\ocwstring{"va"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugwvm}~\ocwupperid{First}~$\ocwstring{"ma"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"an"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{impftm}~8)~$\ocwbc{} similar to \ocwbegindcode{}$\ocwlowerid{conjugs\_past\_m}$\ocwenddcode{} except for -v -m suff \ocwec{}\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"thaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugwvm}~\ocwupperid{First}~$\ocwstring{"vahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"aathaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"aataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugwvm}~\ocwupperid{First}~$\ocwstring{"mahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"dhvam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ata"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_optativek}~\ocwlowerid{weak}~\ocwlowerid{short}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{short}~\ocwlowerid{suff})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwlowerid{conjug\_opt\_ath\_a}~8~\ocwlowerid{conjugs})~$\ocwbc{} short since -y suffixes \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwlowerid{conjug\_opt\_ath\_m}~8~\ocwlowerid{conjugw})$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_imperativek}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{impera}~8)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"tu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aava"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aama"}~\ocwbc{} also kurma Epics \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"antu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_imp\_ath\_m}~8~\ocwlowerid{conjugs}~\ocwlowerid{conjugw}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_presentk}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_athematic\_presentk}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_impftk}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_optativek}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_imperativek}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
** Gana 9  **
\ocweol
\label{verbs.ml:73594}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_present9a}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{short}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw\_v}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{short}~\ocwlowerid{suff})~$\ocwbc{} vowel suffix \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw\_c}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})~$\ocwbc{} consonant suffix \ocwec{}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{presa}~9)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"mi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"si"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{check}~\ocwlowerid{entry}~9~\ocwlowerid{third}~(\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"ti"}$)~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw\_c}~\ocwupperid{First}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw\_c}~\ocwupperid{Second}~$\ocwstring{"thas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw\_c}~\ocwupperid{Third}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw\_c}~\ocwupperid{First}~$\ocwstring{"mas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw\_c}~\ocwupperid{Second}~$\ocwstring{"tha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw\_v}~\ocwupperid{Third}~$\ocwstring{"anti"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{f\_pstem}~=~\ocwlowerid{rfix}~\ocwlowerid{short}~$\ocwstring{"at"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{record\_part}~(\ocwupperid{Ppra\_}~9~\ocwupperid{Primary}~\ocwlowerid{short}~\ocwlowerid{f\_pstem}~\ocwlowerid{entry})~$\ocwbc{} follows 3rd pl \ocwec{}~\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_present9m}~\ocwlowerid{weak}~\ocwlowerid{short}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{short}~$\ocwkw{else}~$\ocwlowerid{weak}~$\ocwkw{in}\ocweol
\ocwindent{11.00em}
$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{w}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~16$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{presm}~9)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"e"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{check}~\ocwlowerid{entry}~9~\ocwlowerid{third}~(\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"te"}$)~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"vahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"aathe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"aate"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"mahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"dhve"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ate"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_impft9a}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{short}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{short}~$\ocwkw{else}~$\ocwlowerid{weak}~$\ocwkw{in}\ocweol
\ocwindent{11.00em}
$(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{w}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~6$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{impfta}~9)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
$])~$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"va"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"ma"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"an"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_impft9m}~\ocwlowerid{weak}~\ocwlowerid{short}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{short}~$\ocwkw{else}~$\ocwlowerid{weak}~$\ocwkw{in}\ocweol
\ocwindent{11.00em}
$(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{w}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~13$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwlowerid{conjug\_impft\_m}~9~\ocwlowerid{conjugw})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_optative9a}~\ocwlowerid{weak}~\ocwlowerid{short}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{short}~$\ocwkw{else}~$\ocwlowerid{weak}~$\ocwkw{in}~\ocwbc{} tjs y- \ocwec{}\ocweol
\ocwindent{11.00em}
$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{w}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_suffix}~14$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwlowerid{conjug\_opt\_ath\_a}~9~\ocwlowerid{conjugw})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_optative9m}~\ocwlowerid{short}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{short}~\ocwlowerid{suff})~$\ocwkw{in}~\ocwbc{} suff starts with ii \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwlowerid{conjug\_opt\_ath\_m}~9~\ocwlowerid{conjugw})~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_imperative9a}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{short}~\ocwlowerid{vow}~\ocwlowerid{root}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{short}~$\ocwkw{else}~$\ocwlowerid{weak}~$\ocwkw{in}\ocweol
\ocwindent{11.00em}
$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{w}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~$\ocwstring{""}$)$\ocweol
\ocwindent{3.00em}
$]~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw2}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{root}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{impera}~9)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{vow}~$\ocwkw{then}~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"hi"}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{conjugw2}~\ocwupperid{Second}~$\ocwstring{"aana"}~\ocwbc{} no nii suffix for consonant root \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"tu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aava"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aama"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"antu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_athematic\_imperative9m}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{short}~\ocwlowerid{root}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{short}~$\ocwkw{else}~$\ocwlowerid{weak}~$\ocwkw{in}\ocweol
\ocwindent{11.00em}
$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{w}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~$\ocwstring{""}$)$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{compute\_imp\_ath\_m}~9~\ocwlowerid{conjugs}~\ocwlowerid{conjugw}~\ocwlowerid{entry}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_active\_present9}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{vow}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_athematic\_present9a}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_impft9a}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_optative9a}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_imperative9a}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{vow}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
\}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_middle\_present9}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_athematic\_present9m}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_impft9m}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_optative9m}~\ocwlowerid{short}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_athematic\_imperative9m}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part\_m\_ath}~(\ocwlowerid{pprm}~9)~\ocwlowerid{short}~\ocwlowerid{entry}~$\ocwbc{} short and not wstem \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_present9}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{vow}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{third}~\ocwlowerid{pada}~\ocwlowerid{padam}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{voices\_of\_gana}~9~\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Para}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~\ocweol
\ocwindent{7.50em}
$\ocwlowerid{compute\_active\_present9}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{vow}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~$\ocwlowerid{emit\_warning}~($\ocwstring{"Unexpected\ocwvspace{}middle\ocwvspace{}form:\ocwvspace{}"}~\^{}~$\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Atma}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{padam}~$\ocwkw{then}~$\ocwlowerid{emit\_warning}~($\ocwstring{"Unexpected\ocwvspace{}active\ocwvspace{}form:\ocwvspace{}"}~\^{}~$\ocwlowerid{entry})$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~$\ocwlowerid{compute\_middle\_present9}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ubha}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{thirda}~=~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~$\ocwlowerid{third}~$\ocwkw{else}~$[\,]$\ocweol
\ocwindent{6.00em}
\ocwkw{and}~$\ocwlowerid{thirdm}~=~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~$[\,]~$\ocwkw{else}~$\ocwlowerid{third}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{6.00em}
\{~$\ocwlowerid{compute\_active\_present9}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{vow}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{thirda}$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{compute\_middle\_present9}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{thirdm}$\ocweol
\ocwindent{6.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Benedictive/precative. Formed from \ocwbegindcode{}$\ocwlowerid{conjug\_optativea}$\ocwenddcode{} 
\ocweol
\label{verbs.ml:79287}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{conjug\_benedictivea}~\ocwlowerid{conj}~\ocwlowerid{weak}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Conju}~(\ocwlowerid{fbenea}~\ocwlowerid{conj})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"yaasam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"yaas"}~\ocwbc{} ambig opt \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"yaat"}~\ocwbc{} ambig opt \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"yaasva"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"yaastam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"yaastaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"yaasma"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"yaasta"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"yaasur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{conjug\_benedictivem}~\ocwlowerid{conj}~\ocwlowerid{sibstem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{sibstem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Conju}~(\ocwlowerid{fbenem}~\ocwlowerid{conj})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~$\ocwbc{} conjugw First \ocwstring{"iiya"} - ambig opt \ocwec{}\ocweol
\ocwindent{5.00em}
$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ii.s.thaas"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ii.s.ta"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~$\ocwbc{} conjugw First \ocwstring{"iivahi"} - ambig opt \ocwec{}\ocweol
\ocwindent{5.00em}
$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"iiyaasthaam"}\ocweol
\ocwindent{5.00em}
\ocwbc{} conjug Third  \ocwstring{"iiyaastaam"} \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~$\ocwbc{} conjugw First \ocwstring{"iimahi"} - ambig opt \ocwec{}\ocweol
\ocwindent{5.00em}
$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ii.dhvam"}\ocweol
\ocwindent{5.00em}
\ocwbc{} conjugw Third \ocwstring{"iiran"} - ambig opt \ocwec{}\ocweol
\ocwindent{4.00em}
$])~$\ocweol
\ocwindent{1.50em}
$])~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{}***************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Future system \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}***************\ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Similar to \ocwbegindcode{}$\ocwlowerid{compute\_thematic\_paradigm\_act}$\ocwenddcode{} 
\ocweol
\label{verbs.ml:80576}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_futurea}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{ffutura}~\ocwlowerid{conj})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aami"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"asi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ati"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aavas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"athas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aamas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"atha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"anti"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part}~(\ocwupperid{Pfuta\_}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry})~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_futurem}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{ffuturm}~\ocwlowerid{conj})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ase"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ate"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aavahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ethe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ete"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aamahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"adhve"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ante"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part\_m\_th}~\ocwlowerid{pfutm}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Conditional - preterit of future, built from imperfect on future stem   \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} where non-performance of the action is implied - pluperfect conditional \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} used in antecedent as well as in consequent clause - Apte§216           \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwstring{"si\ocwvspace{}vous\ocwvspace{}étiez\ocwvspace{}venu,\ocwvspace{}vous\ocwvspace{}l'auriez\ocwvspace{}vue"} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_conda}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{fconda}~\ocwlowerid{conj})~(\ocwlowerid{thematic\_preterit\_a}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_condm}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{fcondm}~\ocwlowerid{conj})~(\ocwlowerid{thematic\_preterit\_m}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_future}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"as\#1"}~$\rightarrow{}~()~$\ocwbc{} uses bhuu \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"iiz\#1"}~$\mid{}~$\ocwstring{"lii"}~$\rightarrow{}~$\ocwkw{do}~\ocwbc{} Para allowed in future \ocwec{}\ocweol
\ocwindent{4.50em}
\{~$\ocwlowerid{compute\_futurea}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{compute\_futurem}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.50em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{voices\_of}~\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Para}~\rightarrow{}~$\ocwkw{do}~\ocwbc{} active only \ocwec{}~\ocweol
\ocwindent{4.50em}
\{~$\ocwlowerid{compute\_futurea}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.50em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} conditional on demand \ocwec{}\ocweol
\ocwindent{5.50em}
$[~$\ocwstring{"gam"}~$\mid{}~$\ocwstring{"bhuu\#1"}~$\rightarrow{}~\ocwlowerid{compute\_conda}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{4.50em}
\}\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Atma}~\rightarrow{}~$\ocwbc{} middle only \ocwec{}~\ocweol
\ocwindent{4.50em}
$\ocwlowerid{compute\_futurem}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.50em}
$\mid{}~$\ocwbc{} both \ocwec{}~$\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{4.50em}
\{~$\ocwlowerid{compute\_futurea}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{compute\_futurem}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.50em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} rare conditional \ocwec{}\ocweol
\ocwindent{5.50em}
$[~$\ocwstring{"i"}~$\mid{}~$\ocwstring{"k.r\#1"}~$\mid{}~$\ocwstring{"tap"}~$\mid{}~$\ocwstring{"daa\#1"}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{7.00em}
\{~$\ocwlowerid{compute\_conda}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{7.00em}
;~$\ocwlowerid{compute\_condm}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{7.00em}
\}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{4.50em}
\}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_future\_ca}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_futurea}~\ocwupperid{Causative}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_futurem}~\ocwupperid{Causative}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part\_m\_th}~\ocwlowerid{pcausfm}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Possible intercalating vowel i for se.t and ve.t roots Whitney§935 \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{intercalates}$\ocwenddcode{} returns a set of possible intercalations.           \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} This information should be lexicalised with a generative lexicon.  \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{intercalates}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{anit}~=~[~0~]~$\ocwbc{} no intercalation \ocwec{}~\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{set}~=~[~1~]~$\ocwbc{} intercalate i \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{vet}~=~[~0;~1~]~$\ocwbc{} intercalate i optionally \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwbc{} NB for likh and vij 0 means intercalate i on weak stem \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{setl}~=~[~2~]~$\ocwbc{} intercalate ii \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{serb}~=~[~1;~2~]~$\ocwbc{} intercalate i or ii \ocwec{}~\ocwkw{in}~\ocwkw{fun}~\ocwbc{} rstem \ocwec{}\ocweol
\ocwindent{1.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{error\_empty}~10$\ocweol
\ocwindent{1.50em}
$\mid{}~[~7;~45~$\ocwbc{} v.r \ocwec{}~$]~\rightarrow{}~\ocwlowerid{serb}~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{v}.\ocwlowerid{r}\#1$\ocwenddcode{} and \ocwbegindcode{}$\ocwlowerid{v}.\ocwlowerid{r}\#2$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~[~7~$\ocwbc{} -.r \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{set}$\ocweol
\ocwindent{1.50em}
$\mid{}~[~8~$\ocwbc{} -.rr \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{serb}$\ocweol
\ocwindent{1.50em}
$\mid{}~[~6;~48~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{suu}\#1$\ocwenddcode{} \ocwec{}~$]~\rightarrow{}~\ocwlowerid{vet}$\ocweol
\ocwindent{1.50em}
$\mid{}~[~6~$\ocwbc{} -uu \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{set}~$\ocwbc{} Kale p. 186 \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{3.50em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{all\_consonants}~\ocwlowerid{r}~$\ocwkw{then}~\ocweol
\ocwindent{6.50em}
\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~$\ocwstring{"k.sii"}~$\mid{}~$\ocwstring{"ji"}~$\mid{}~$\ocwstring{"nii\#1"}~$\mid{}~$\ocwstring{"vaa\#3"}~$\mid{}~$\ocwstring{"zii\#1"}~$\mid{}~$\ocwstring{"su\#2"}~\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"stu"}~$\mid{}~$\ocwstring{"haa\#1"}~$\rightarrow{}~\ocwlowerid{vet}$\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{".dii"}~$\mid{}~$\ocwstring{"nu\#1"}~$\mid{}~$\ocwstring{"yu\#1"}~$\mid{}~$\ocwstring{"yu\#2"}~$\mid{}~$\ocwstring{"ru"}~$\mid{}~$\ocwstring{"zri"}~\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"k.su"}~$\mid{}~$\ocwstring{"k.s.nu"}~$\mid{}~$\ocwstring{"snu"}~\ocwbc{} Kale \ocwec{}~$\mid{}~$\ocwstring{"zuu"}\ocweol
\ocwindent{8.50em}
$\rightarrow{}~\ocwlowerid{set}$\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{anit}~$\ocweol
\ocwindent{6.50em}
$]~$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{set}~$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{semivowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{set}$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~$\ocwstring{"ak.s"}~$\mid{}~$\ocwstring{"a\~{}nj"}~$\mid{}~$\ocwstring{"k.rt\#1"}~$\mid{}~$\ocwstring{"k.rp"}~$\mid{}~$\ocwstring{"k.lp"}~$\mid{}~$\ocwstring{"kram"}~$\mid{}~$\ocwstring{"k.sam"}~\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"klid"}~$\mid{}~$\ocwstring{"gup"}~$\mid{}~$\ocwstring{"guh"}~$\mid{}~$\ocwstring{"ghu.s"}~$\mid{}~$\ocwstring{"jan"}~$\mid{}~$\ocwstring{"ta\~{}nc"}~$\mid{}~$\ocwstring{"tap"}~$\mid{}~$\ocwstring{"t.rd"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"tyaj\#1"}~$\mid{}~$\ocwstring{"dah\#1"}~$\mid{}~$\ocwstring{"d.rp"}~$\mid{}~$\ocwstring{"nam"}~$\mid{}~$\ocwstring{"naz"}~$\mid{}~$\ocwstring{"n.rt"}~$\mid{}~$\ocwstring{"bandh"}~\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"bhaj"}~$\mid{}~$\ocwstring{"majj"}~$\mid{}~$\ocwstring{"man"}~$\mid{}~$\ocwstring{"m.rj"}~$\mid{}~$\ocwstring{"yam"}~$\mid{}~$\ocwstring{"ruh"}~$\mid{}~$\ocwstring{"labh"}~$\mid{}~$\ocwstring{"likh"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"vap\#2"}~$\mid{}~$\ocwstring{"vas\#1"}~$\mid{}~$\ocwstring{"vah\#1"}~$\mid{}~$\ocwstring{"vij"}~$\mid{}~$\ocwstring{"vid\#1"}~$\mid{}~$\ocwstring{"v.rj"}~$\mid{}~$\ocwstring{"v.rt\#1"}~\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"vrazc"}~$\mid{}~$\ocwstring{"sad\#1"}~$\mid{}~$\ocwstring{"sah\#1"}~$\mid{}~$\ocwstring{"sidh\#2"}~$\mid{}~$\ocwstring{"svap"}~$\mid{}~$\ocwstring{"han\#1"}~\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"syand"}~\ocwbc{} WR says set for atma, anit for para  \ocwec{}\ocweol
\ocwindent{8.00em}
$\rightarrow{}~\ocwlowerid{vet}~$\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"grah"}~$\rightarrow{}~\ocwlowerid{setl}$\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"s.rj\#1"}~$\rightarrow{}~[~3~]~$\ocwbc{} sra.s.taa \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"k.r.s"}~$\rightarrow{}~[~3~::~\ocwlowerid{vet}~]~$\ocwbc{} ar -> ra optionally \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"bh.rjj"}~$\rightarrow{}~[~3~::~\ocwlowerid{anit}~]~$\ocwbc{} idem \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"ad\#1"}~$\mid{}~$\ocwstring{"aap"}~$\mid{}~$\ocwstring{"krudh\#1"}~$\mid{}~$\ocwstring{"kruz"}~$\mid{}~$\ocwstring{"k.sip"}~$\mid{}~$\ocwstring{"k.sud"}~\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"k.sudh\#1"}~$\mid{}~$\ocwstring{"khid"}~$\mid{}~$\ocwstring{"chid\#1"}~$\mid{}~$\ocwstring{"tud\#1"}~$\mid{}~$\ocwstring{"tu.s"}~$\mid{}~$\ocwstring{"t.rp\#1"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"tvi.s\#1"}~$\mid{}~$\ocwstring{"diz\#1"}~$\mid{}~$\ocwstring{"dih"}~$\mid{}~$\ocwstring{"du.s"}~$\mid{}~$\ocwstring{"duh\#1"}~$\mid{}~$\ocwstring{"d.rz\#1"}~\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"dvi.s\#1"}~$\mid{}~$\ocwstring{"nah"}~$\mid{}~$\ocwstring{"nij"}~$\mid{}~$\ocwstring{"nud"}~$\mid{}~$\ocwstring{"pac"}~$\mid{}~$\ocwstring{"pad\#1"}~$\mid{}~$\ocwstring{"pi.s"}~\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"pu.s\#1"}~$\mid{}~$\ocwstring{"praz"}~$\mid{}~$\ocwstring{"budh\#1"}~$\mid{}~$\ocwstring{"bha\~{}nj"}~$\mid{}~$\ocwstring{"bha.s"}~$\mid{}~$\ocwstring{"bhid\#1"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"bhuj\#1"}~$\mid{}~$\ocwstring{"bhuj\#2"}~$\mid{}~$\ocwstring{"mih"}~$\mid{}~$\ocwstring{"muc\#1"}~$\mid{}~$\ocwstring{"m.rz"}~$\mid{}~$\ocwstring{"yaj\#1"}~$\mid{}~$\ocwstring{"yabh"}~\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"yuj\#1"}~$\mid{}~$\ocwstring{"yudh\#1"}~$\mid{}~$\ocwstring{"ra\~{}nj"}~$\mid{}~$\ocwstring{"rabh"}~$\mid{}~$\ocwstring{"ram"}~$\mid{}~$\ocwstring{"raadh"}~$\mid{}~$\ocwstring{"ric"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"ruj\#1"}~$\mid{}~$\ocwstring{"rudh\#1"}~$\mid{}~$\ocwstring{"rudh\#2"}~$\mid{}~$\ocwstring{"ruh\#1"}~$\mid{}~$\ocwstring{"lip"}~$\mid{}~$\ocwstring{"liz"}~$\mid{}~$\ocwstring{"lih\#1"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"lup"}~$\mid{}~$\ocwstring{"vac"}~$\mid{}~$\ocwstring{"vap\#1"}~$\mid{}~$\ocwstring{"vic"}~$\mid{}~$\ocwstring{"vid\#2"}~$\mid{}~$\ocwstring{"viz\#1"}~$\mid{}~$\ocwstring{"vi.s\#1"}~\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"vyadh"}~$\mid{}~$\ocwstring{"zak"}~$\mid{}~$\ocwstring{"zad"}~$\mid{}~$\ocwstring{"zap"}~$\mid{}~$\ocwstring{"zi.s"}~$\mid{}~$\ocwstring{"zudh"}~$\mid{}~$\ocwstring{"zu.s"}~\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"zli.s"}~$\mid{}~$\ocwstring{"sa\~{}nj"}~$\mid{}~$\ocwstring{"sic"}~$\mid{}~$\ocwstring{"sidh\#1"}~$\mid{}~$\ocwstring{"s.rp"}~$\mid{}~$\ocwstring{"skand"}~\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"sp.rz\#1"}~$\mid{}~$\ocwstring{"sva\~{}nj"}~$\mid{}~$\ocwstring{"svid\#2"}~$\mid{}~$\ocwstring{"had"}~\ocweol
\ocwindent{8.00em}
$\rightarrow{}~\ocwlowerid{anit}$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{set}~$\ocwbc{} default all multisyllabic, gana 10, nominal verbs plus:
\ocwbegindcode{}~\ocwstring{"afg"}~$\mid{}~$\ocwstring{"a\~{}nc"}~$\mid{}~$\ocwstring{"an\#2"}~$\mid{}~$\ocwstring{"arh"}~$\mid{}~$\ocwstring{"av"}~$\mid{}~$\ocwstring{"az\#1"}~$\mid{}~$\ocwstring{"az\#2"}~$\mid{}~$\ocwstring{"as\#2"}~$\mid{}~$\ocwstring{"aas\#2"}
$\mid{}~$\ocwstring{"indh"}~$\mid{}~$\ocwstring{"inv"}~$\mid{}~$\ocwstring{"i.s\#1"}~$\mid{}~$\ocwstring{"i.s\#2"}~$\mid{}~$\ocwstring{"iik.s"}~$\mid{}~$\ocwstring{"iifkh"}~$\mid{}~$\ocwstring{"ii.d"}~$\mid{}~$\ocwstring{"iiz\#1"}~
$\mid{}~$\ocwstring{"uc"}~$\mid{}~$\ocwstring{"u\~{}nch"}~$\mid{}~$\ocwstring{"umbh"}~$\mid{}~$\ocwstring{"uuh"}~$\mid{}~$\ocwstring{".rc\#1"}~$\mid{}~$\ocwstring{".rj"}~$\mid{}~$\ocwstring{".rdh"}~$\mid{}~$\ocwstring{"edh"}~$\mid{}~$\ocwstring{"kafk"}
$\mid{}~$\ocwstring{"kam"}~$\mid{}~$\ocwstring{"kamp"}~$\mid{}~$\ocwstring{"ka.s"}~$\mid{}~$\ocwstring{"kaafk.s"}~$\mid{}~$\ocwstring{"ku.n.th"}~$\mid{}~$\ocwstring{"ku.n.d"}~$\mid{}~$\ocwstring{"kup"}~$\mid{}~$\ocwstring{"krand"}~
$\mid{}~$\ocwstring{"krii.d"}~$\mid{}~$\ocwstring{"khan"}~$\mid{}~$\ocwstring{"khaad"}~$\mid{}~$\ocwstring{"gu\~{}nj"}~$\mid{}~$\ocwstring{"gam"}~$\mid{}~$\ocwstring{"ghu.s"}~$\mid{}~$\ocwstring{"ghaat"}~$\mid{}~$\ocwstring{"ghuur.n"}
$\mid{}~$\ocwstring{"cand"}~$\mid{}~$\ocwstring{"cit\#1"}~$\mid{}~$\ocwstring{"cumb"}~$\mid{}~$\ocwstring{"chand"}~$\mid{}~$\ocwstring{"jak.s"}~$\mid{}~$\ocwstring{"jap"}~$\mid{}~$\ocwstring{"jalp"}~$\mid{}~$\ocwstring{"jinv"}
$\mid{}~$\ocwstring{"j.rmbh"}~$\mid{}~$\ocwstring{"tak"}~$\mid{}~$\ocwstring{"tan\#1"}~$\mid{}~$\ocwstring{"tan\#2"}~$\mid{}~$\ocwstring{"tark"}~$\mid{}~$\ocwstring{"tvar"}~$\mid{}~$\ocwstring{"dagh"}~$\mid{}~$\ocwstring{"dabh"}~
$\mid{}~$\ocwstring{"dham"}~$\mid{}~$\ocwstring{"dhva.ms"}~$\mid{}~$\ocwstring{"dhvan"}~$\mid{}~$\ocwstring{"nand"}~$\mid{}~$\ocwstring{"nind"}~$\mid{}~$\ocwstring{"pa.th"}~$\mid{}~$\ocwstring{"pat\#1"}~$\mid{}~$\ocwstring{"pi\~{}nj"}
$\mid{}~$\ocwstring{"piz"}~$\mid{}~$\ocwstring{"ba.mh"}~$\mid{}~$\ocwstring{"bhand"}~$\mid{}~$\ocwstring{"bhaa.s"}~$\mid{}~$\ocwstring{"bhraaj"}~$\mid{}~$\ocwstring{"ma.mh"}~$\mid{}~$\ocwstring{"ma.n.d"}~$\mid{}~$\ocwstring{"mad\#1"}
$\mid{}~$\ocwstring{"mand\#1"}~$\mid{}~$\ocwstring{"mlecch"}~$\mid{}~$\ocwstring{"yat\#1"}~$\mid{}~$\ocwstring{"yaac"}~$\mid{}~$\ocwstring{"ra.mh"}~$\mid{}~$\ocwstring{"rak.s"}~$\mid{}~$\ocwstring{"raaj\#1"}~
$\mid{}~$\ocwstring{"ruc\#1"}~$\mid{}~$\ocwstring{"rud\#1"}~$\mid{}~$\ocwstring{"lag"}~$\mid{}~$\ocwstring{"lafg"}~$\mid{}~$\ocwstring{"lafgh"}~$\mid{}~$\ocwstring{"lap"}~$\mid{}~$\ocwstring{"lamb"}~$\mid{}~$\ocwstring{"laa\~{}nch"}~
$\mid{}~$\ocwstring{"la.s"}~$\mid{}~$\ocwstring{"lu.n.th"}~$\mid{}~$\ocwstring{"lok"}~$\mid{}~$\ocwstring{"loc"}~$\mid{}~$\ocwstring{"vad"}~$\mid{}~$\ocwstring{"vand"}~$\mid{}~$\ocwstring{"vam"}~$\mid{}~$\ocwstring{"vaz"}~$\mid{}~$\ocwstring{"vas\#2"}
$\mid{}~$\ocwstring{"vaa\~{}nch"}~$\mid{}~$\ocwstring{"vaaz"}~$\mid{}~$\ocwstring{"vip"}~$\mid{}~$\ocwstring{"ven"}~$\mid{}~$\ocwstring{"vyath"}~$\mid{}~$\ocwstring{"vraj"}~$\mid{}~$\ocwstring{"vrii.d"}~$\mid{}~$\ocwstring{"za.ms"}~
$\mid{}~$\ocwstring{"zafk"}~$\mid{}~$\ocwstring{"zas"}~$\mid{}~$\ocwstring{"zaas"}~$\mid{}~$\ocwstring{"zuc\#1"}~$\mid{}~$\ocwstring{"san\#1"}~$\mid{}~$\ocwstring{"skhal"}~$\mid{}~$\ocwstring{"stambh"}~$\mid{}~$\ocwstring{"spand"}~
$\mid{}~$\ocwstring{"spardh"}~$\mid{}~$\ocwstring{"sp.rh"}~$\mid{}~$\ocwstring{"sphu.t"}~$\mid{}~$\ocwstring{"svan"}~$\mid{}~$\ocwstring{"has"}~$\mid{}~$\ocwstring{"hi.ms"}~\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Whitney§631 \& §640 intercalating i in present system 2nd class \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{intercalate\_2}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"an\#2"}~$\mid{}~$\ocwstring{"praa.n\#1"}~$\mid{}~$\ocwstring{"rud\#1"}~$\mid{}~$\ocwstring{"zvas\#1"}~$\mid{}~$\ocwstring{"svap"}~$\mid{}~$\ocwstring{"jak.s"}~$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Perfect passive participle 
\ocweol
\label{verbs.ml:87927}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{intercalate\_pp}~\ocwlowerid{root}~\ocwlowerid{rstem}~=~$\ocweol
\ocwindent{0.00em}
\ocwbc{} some redundancy with intercalates but really different, 
   specially since the default is anit for verbs ending with single consonant \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{anit}~=~[~0~]~$\ocwbc{} no intercalation \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{set}~=~[~1~]~$\ocwbc{} intercalate i \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{vet}~=~[~0;~1~]~$\ocwbc{} intercalate i optionally \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"jaag.r"}~$\mid{}~$\ocwstring{"zii\#1"}~$\rightarrow{}~\ocwlowerid{set}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{anit}~$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{2.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~\ocwlowerid{v}~::~\ocwlowerid{\_}~]~$\ocwkw{when}~$\ocwlowerid{vowel}~\ocwlowerid{v}~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}~\ocweol
\ocwindent{6.00em}
\ocwbc{} TODO utiliser intercalates sauf exceptions \ocwec{}\ocweol
\ocwindent{5.50em}
$[~$\ocwstring{"radh"}~$\mid{}~$\ocwstring{"naz\#1"}~$\mid{}~$\ocwstring{"trap\#1"}~$\mid{}~$\ocwstring{"d.rp"}~$\mid{}~$\ocwstring{"druh\#1"}~$\mid{}~$\ocwstring{"muh"}~$\mid{}~$\ocwstring{"jap"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"snih\#1"}~$\mid{}~$\ocwstring{"snuh\#1"}~\ocwbc{} \Pan{7,2,45} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"i.s\#1"}~$\mid{}~$\ocwstring{"sah\#1"}~$\mid{}~$\ocwstring{"lubh"}~$\mid{}~$\ocwstring{"ru.s\#1"}~$\mid{}~$\ocwstring{"ri.s"}~\ocwbc{} \Pan{7,2,48} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"uuh"}~$\mid{}~$\ocwstring{"k.subh"}~$\mid{}~$\ocwstring{"tap"}~$\mid{}~$\ocwstring{"yat\#1"}~$\mid{}~$\ocwstring{"ruup"}~$\mid{}~$\ocwstring{"vas\#1"}~$\mid{}~$\ocwstring{"vas\#4"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"zap"}~$\mid{}~$\ocwstring{"zas"}~$\mid{}~$\ocwstring{"zaas"}~$\mid{}~$\ocwstring{"h.r.s"}~\ocwbc{} \Pan{7,2,...} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"zak"}~\ocwbc{} zakita \Pan{7,2,17} (Kaazikaa) \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"gaah"}~\ocwbc{} gaahita \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"yas"}~\ocwbc{} aayasita \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"kliz"}~$\mid{}~$\ocwstring{"puu\#1"}~$\mid{}~$\ocwstring{"a\~{}nc"}~\ocwbc{} \Pan{7,2,51,53,50} \ocwec{}~$\rightarrow{}~\ocwlowerid{vet}$\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"ghu.s"}~\ocwbc{} \Pan{7,2,23} \ocwec{}~$\mid{}~$\ocwstring{"ka.s"}~\ocwbc{} \Pan{7,2,22} \ocwec{}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"dh.r.s"}~\ocwbc{} \Pan{7,2,19} \ocwec{}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"am"}~$\mid{}~$\ocwstring{"tvar"}~\ocwbc{} \Pan{7,2,28} \ocwec{}~$\rightarrow{}~\ocwlowerid{vet}~$\ocwbc{} but only set for -tvaa \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"gup"}~$\mid{}~$\ocwstring{"dyut\#1"}~$\mid{}~$\ocwstring{"dham"}~$\mid{}~$\ocwstring{"nud"}~$\mid{}~$\ocwstring{"m.rj"}~$\rightarrow{}~\ocwlowerid{vet}~$\ocweol
\ocwindent{6.50em}
\ocwbc{} NB zaas vet for stem zaas but admits also zi.s only anit \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"aj"}~$\mid{}~$\ocwstring{"a.t"}~$\mid{}~$\ocwstring{"at"}~$\mid{}~$\ocwstring{"an\#2"}~$\mid{}~$\ocwstring{"az\#2"}~$\mid{}~$\ocwstring{"aas\#2"}~$\mid{}~$\ocwstring{"i.s\#2"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"ii.d"}~$\mid{}~$\ocwstring{"iir"}~$\mid{}~$\ocwstring{"iiz\#1"}~$\mid{}~$\ocwstring{"ii.s"}~$\mid{}~$\ocwstring{"iih"}~$\mid{}~$\ocwstring{"uc"}~$\mid{}~$\ocwstring{".rc\#1"}~$\mid{}~$\ocwstring{".rj"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"ej"}~$\mid{}~$\ocwstring{"edh"}~$\mid{}~$\ocwstring{"kath"}~$\mid{}~$\ocwstring{"kal"}~$\mid{}~$\ocwstring{"kas"}~$\mid{}~$\ocwstring{"kaaz"}~$\mid{}~$\ocwstring{"kiil"}~$\mid{}~$\ocwstring{"kuc"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"kup"}~$\mid{}~$\ocwstring{"kuuj"}~$\mid{}~$\ocwstring{"k.rz"}~$\mid{}~$\ocwstring{"krii.d"}~$\mid{}~$\ocwstring{"klav"}~$\mid{}~$\ocwstring{"kvath"}~$\mid{}~$\ocwstring{"k.sam"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"k.sar"}~$\mid{}~$\ocwstring{"k.sudh\#1"}~$\mid{}~$\ocwstring{"k.svi.d"}~$\mid{}~$\ocwstring{"khaad"}~$\mid{}~$\ocwstring{"ga.n"}~$\mid{}~$\ocwstring{"gad"}~$\mid{}~$\ocwstring{"gal"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"granth"}~$\mid{}~$\ocwstring{"gha.t"}~$\mid{}~$\ocwstring{"ghaat"}~$\mid{}~$\ocwstring{"cak"}~$\mid{}~$\ocwstring{"ca.t"}~$\mid{}~$\ocwstring{"car"}~$\mid{}~$\ocwstring{"cal"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"cud"}~$\mid{}~$\ocwstring{"cur"}~$\mid{}~$\ocwstring{"chal"}~$\mid{}~$\ocwstring{"jiiv"}~$\mid{}~$\ocwstring{"jval"}~$\mid{}~$\ocwstring{"ta.d"}~$\mid{}~$\ocwstring{"tam"}~$\mid{}~$\ocwstring{"tul"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"t.r.s\#1"}~$\mid{}~$\ocwstring{"tru.t"}~$\mid{}~$\ocwstring{"tvi.s\#1"}~$\mid{}~$\ocwstring{"day"}~$\mid{}~$\ocwstring{"dal"}~$\mid{}~$\ocwstring{"dol"}~$\mid{}~$\ocwstring{"dhaav\#1"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"dhiir"}~$\mid{}~$\ocwstring{"dhvan"}~$\mid{}~$\ocwstring{"na.t"}~$\mid{}~$\ocwstring{"nad"}~$\mid{}~$\ocwstring{"pa.th"}~$\mid{}~$\ocwstring{"pa.n"}~$\mid{}~$\ocwstring{"pat\#1"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"piz"}~$\mid{}~$\ocwstring{"pii.d"}~$\mid{}~$\ocwstring{"pulak"}~$\mid{}~$\ocwstring{"puuj"}~$\mid{}~$\ocwstring{"prath"}~$\mid{}~$\ocwstring{"phal"}~$\mid{}~$\ocwstring{"baadh"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"bha.n"}~$\mid{}~$\ocwstring{"bhas"}~$\mid{}~$\ocwstring{"bhaa.s"}~$\mid{}~$\ocwstring{"bhaas\#1"}~$\mid{}~$\ocwstring{"bhuu.s"}~$\mid{}~$\ocwstring{"bhraaj"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"ma.mh"}~$\mid{}~$\ocwstring{"manth"}~$\mid{}~$\ocwstring{"mah"}~$\mid{}~$\ocwstring{"likh"}~$\mid{}~$\ocwstring{"mil"}~$\mid{}~$\ocwstring{"mi.s"}~$\mid{}~$\ocwstring{"miil"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"mud\#1"}~$\mid{}~$\ocwstring{"mu.s\#1"}~$\mid{}~$\ocwstring{"yaac"}~$\mid{}~$\ocwstring{"rac"}~$\mid{}~$\ocwstring{"ra.n"}~$\mid{}~$\ocwstring{"ras"}~$\mid{}~$\ocwstring{"rah"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"raaj\#1"}~$\mid{}~$\ocwstring{"ruc\#1"}~$\mid{}~$\ocwstring{"rud\#1"}~$\mid{}~$\ocwstring{"lag"}~$\mid{}~$\ocwstring{"lap"}~$\mid{}~$\ocwstring{"lal"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"la.s"}~$\mid{}~$\ocwstring{"las"}~$\mid{}~$\ocwstring{"lu.th"}~$\mid{}~$\ocwstring{"lul"}~$\mid{}~$\ocwstring{"lok"}~$\mid{}~$\ocwstring{"loc"}~$\mid{}~$\ocwstring{"vad"}~$\mid{}~$\ocwstring{"val"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"vas\#2"}~$\mid{}~$\ocwstring{"vaaz"}$\mid{}~$\ocwstring{"vaas\#3"}~$\mid{}~$\ocwstring{"vid\#1"}~$\mid{}~$\ocwstring{"vip"}$\mid{}~$\ocwstring{"ven"}~$\mid{}~$\ocwstring{"vyath"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"vraj"}~$\mid{}~$\ocwstring{"vra.n"}~$\mid{}~$\ocwstring{"vrii.d"}~$\mid{}~$\ocwstring{"zubh\#1"}~$\mid{}~$\ocwstring{"zcut\#1"}~$\mid{}~$\ocwstring{"zrath"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"zlath"}~$\mid{}~$\ocwstring{"zlaagh"}~$\mid{}~$\ocwstring{"zvas\#1"}~$\mid{}~$\ocwstring{".s.thiiv"}~$\mid{}~$\ocwstring{"suuc"}$\mid{}~$\ocwstring{"suud"}~$\mid{}~$\ocwstring{"sev"}~$\mid{}~$\ocwstring{"skhal"}~$\mid{}~$\ocwstring{"stan"}~$\mid{}~$\ocwstring{"stim"}~$\mid{}~$\ocwstring{"sthag"}~$\mid{}~$\ocwstring{"sphu.t"}~$\mid{}~$\ocwstring{"sphur"}~$\mid{}~$\ocwstring{"svad"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"svan"}~$\mid{}~$\ocwstring{"svar\#1"}~$\mid{}~$\ocwstring{"has"}~$\mid{}~$\ocwstring{"hras"}~$\mid{}~$\ocwstring{"hraad"}~$\mid{}~$\ocwstring{"hlaad"}~$\mid{}~$\ocwstring{"hval"}~\ocweol
\ocwindent{7.50em}
$\rightarrow{}~\ocwlowerid{set}$\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"palaay"}~$\rightarrow{}~\ocwlowerid{set}~$\ocwbc{} very special item \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"grah"}~$\rightarrow{}~\ocwlowerid{set}~$\ocwbc{} but will get ii \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{anit}$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~$\ocwstring{"umbh"}~$\mid{}~$\ocwstring{"muurch"}~$\mid{}~$\ocwstring{"mlecch"}~$\mid{}~$\ocwstring{"zrambh"}~\ocwbc{} vizrambhita \ocwec{}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"skambh"}~\ocwbc{} vi.skabdha \ocwec{}~$\mid{}~$\ocwstring{"stambh"}~\ocwbc{} stabdha stabhita \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"zvas"}~\ocwbc{} samaazvasta \ocwec{}~$\rightarrow{}~\ocwlowerid{vet}~$\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"cak.s"}~$\mid{}~$\ocwstring{"jak.s"}~$\mid{}~$\ocwstring{"bh.rjj"}~\ocwbc{} ca.s.ta bh.r.s.ta \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"ra\~{}nj"}~$\mid{}~$\ocwstring{"sa\~{}nj"}~$\mid{}~$\ocwstring{"bandh"}~\ocwbc{} rakta sakta baddha \ocwec{}~$\rightarrow{}~\ocwlowerid{anit}~$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{aa\_it}~\ocwlowerid{root}~\lor{}~\ocwlowerid{ii\_it}~\ocwlowerid{root}~\lor{}~\ocwlowerid{u\_it}~\ocwlowerid{root}~\lor{}~\ocwlowerid{uu\_it}~\ocwlowerid{root}~$\ocweol
\ocwindent{10.50em}
\ocwkw{then}~$\ocwlowerid{anit}~$\ocweol
\ocwindent{9.00em}
\ocwkw{else}~$\ocwlowerid{set}$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_empty}~11$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{intercalate\_tvaa}~\ocwlowerid{root}~\ocwlowerid{rstem}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{set}~=~[~1~]~$\ocwbc{} intercalate i \ocwec{}~\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{anit}~=~[~0~]~$\ocwbc{} no intercalation \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{vet}~=~[~0;~1~]~$\ocwbc{} intercalate i optionally \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"zam\#2"}~$\rightarrow{}~[\,]~$\ocwbc{} unused without preverb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"av"}~$\rightarrow{}~[\,]~$\ocwbc{} WR no absol \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"ka.s"}~$\mid{}~$\ocwstring{"dh.r.s"}~$\mid{}~$\ocwstring{"am"}~$\mid{}~$\ocwstring{"tvar"}~$\mid{}~$\ocwstring{".r.s"}~$\rightarrow{}~\ocwlowerid{set}~$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"nud"}~$\rightarrow{}~\ocwlowerid{anit}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{uu\_it}~\ocwlowerid{root}~\lor{}~\ocwlowerid{u\_it}~\ocwlowerid{root}~$\ocwkw{then}~$\ocwlowerid{vet}$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~$\ocwlowerid{intercalate\_pp}~\ocwlowerid{root}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{is\_set\_pp}~\ocwlowerid{root}~\ocwlowerid{rstem}~=~\ocwupperid{List.}\ocwlowerid{mem}~1~(\ocwlowerid{intercalate\_pp}~\ocwlowerid{root}~\ocwlowerid{rstem})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{is\_anit\_pp}~\ocwlowerid{root}~\ocwlowerid{rstem}~=~\ocwupperid{List.}\ocwlowerid{mem}~0~(\ocwlowerid{intercalate\_pp}~\ocwlowerid{root}~\ocwlowerid{rstem})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{is\_set\_tvaa}~\ocwlowerid{root}~\ocwlowerid{rstem}~=~\ocwupperid{List.}\ocwlowerid{mem}~1~(\ocwlowerid{intercalate\_tvaa}~\ocwlowerid{root}~\ocwlowerid{rstem})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{is\_anit\_tvaa}~\ocwlowerid{root}~\ocwlowerid{rstem}~=~\ocwupperid{List.}\ocwlowerid{mem}~0~(\ocwlowerid{intercalate\_tvaa}~\ocwlowerid{root}~\ocwlowerid{rstem})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{ppp\_suffix}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Na}~$\ocwkw{of}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Tia}~$\ocwkw{of}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} allowing i intercalation \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ta}~$\ocwkw{of}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} not allowing intercalation \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Va}~$\ocwkw{of}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ka}~$\ocwkw{of}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} The ppp constructors as postfix operators applied to a stem given as string \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sNa}~\ocwlowerid{s}~=~\ocwupperid{Na}~(\ocwlowerid{revstem}~\ocwlowerid{s})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sTa}~\ocwlowerid{s}~=~\ocwupperid{Ta}~(\ocwlowerid{revstem}~\ocwlowerid{s})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sTia}~\ocwlowerid{s}~=~\ocwupperid{Tia}~(\ocwlowerid{revstem}~\ocwlowerid{s})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sVa}~\ocwlowerid{s}~=~\ocwupperid{Va}~(\ocwlowerid{revstem}~\ocwlowerid{s})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Computes the Primary ppp stems of roots \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_ppp\_stems}~\ocwlowerid{entry}~\ocwlowerid{rstem}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~$\ocwbc{} we first filter out roots with no attested ppp \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwstring{"ak.s"}~\ocwbc{} vedic a.s.ta overgenerates with a.s.tan \ocwec{}~$\mid{}~$\ocwstring{"as\#1"}~$\mid{}~$\ocwstring{"kan"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"k.si"}~$\mid{}~$\ocwstring{"gaa\#1"}~$\mid{}~$\ocwstring{"paz"}~$\mid{}~$\ocwstring{"paa\#2"}~$\mid{}~$\ocwstring{"praa\#1"}~\ocwbc{} vedic praata omitted \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"bal"}~$\mid{}~$\ocwstring{"ma.mh"}~$\mid{}~$\ocwstring{"vaz"}~$\mid{}~$\ocwstring{"vyac"}~$\mid{}~$\ocwstring{"zaz"}~$\mid{}~$\ocwstring{"zam\#2"}~$\mid{}~$\ocwstring{"sac"}~\ocwbc{} | \ocwstring{"spaz\#1"} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"h.r\#2"}~\ocweol
\ocwindent{3.00em}
$\rightarrow{}~[\,]$\ocweol
\ocwindent{3.00em}
\ocwbc{} now participles in -na \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vrazc"}~$\rightarrow{}~[~\ocwlowerid{sNa}~$\ocwstring{"v.rk"}~$]~$\ocwbc{} exception - v.rk root stem of vrazc \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwbc{} Most roots starting with 2 consonants take -na \Pan{8,2,43} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"iir"}~$\mid{}~$\ocwstring{"und"}~$\mid{}~$\ocwstring{"k.rr"}~$\mid{}~$\ocwstring{"klid"}~$\mid{}~$\ocwstring{"k.sii"}~$\mid{}~$\ocwstring{"k.sud"}~$\mid{}~$\ocwstring{"k.svid"}~$\mid{}~$\ocwstring{"khid"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"g.rr\#1"}~$\mid{}~$\ocwstring{"glai"}~$\mid{}~$\ocwstring{"chad\#1"}~$\mid{}~$\ocwstring{"chid\#1"}~$\mid{}~$\ocwstring{"ch.rd"}~$\mid{}~$\ocwstring{"j.rr"}~$\mid{}~$\ocwstring{".dii"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"tud\#1"}~$\mid{}~$\ocwstring{"t.rd"}~$\mid{}~$\ocwstring{"t.rr"}~$\mid{}~$\ocwstring{"dagh"}~$\mid{}~$\ocwstring{"d.rr"}~$\mid{}~$\ocwstring{"dev"}~$\mid{}~$\ocwstring{"draa\#1"}~$\mid{}~$\ocwstring{"draa\#2"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"nud"}~$\mid{}~$\ocwstring{"pad\#1"}~$\mid{}~$\ocwstring{"pi\#2"}~$\mid{}~$\ocwstring{"p.rr"}~$\mid{}~$\ocwstring{"pyaa"}~$\mid{}~$\ocwstring{"bha\~{}nj"}~$\mid{}~$\ocwstring{"bhid\#1"}~$\mid{}~$\ocwstring{"bhuj\#1"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"majj"}~$\mid{}~$\ocwstring{"man"}~$\mid{}~$\ocwstring{"mid"}~$\mid{}~$\ocwstring{"mlaa"}~$\mid{}~$\ocwstring{"ri"}~$\mid{}~$\ocwstring{"lii"}~$\mid{}~$\ocwstring{"luu\#1"}~$\mid{}~$\ocwstring{"vij"}~$\mid{}~$\ocwstring{"vid\#2"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zad"}~$\mid{}~$\ocwstring{"zuu"}~$\mid{}~$\ocwstring{"z.rr"}~$\mid{}~$\ocwstring{"sad\#1"}~$\mid{}~$\ocwstring{"skand"}~$\mid{}~$\ocwstring{"syand"}~$\mid{}~$\ocwstring{"st.rr"}~$\mid{}~$\ocwstring{"styaa"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"had"}~$\mid{}~$\ocwstring{"svid\#2"}~$\mid{}~$\ocwstring{"haa\#2"}~\ocwbc{} but not \ocwstring{"k.svi.d"} \ocwstring{"zrath"} \ocwec{}\ocweol
\ocwindent{3.00em}
$\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwbc{} except lag which is \ocwstring{"nipaatana"} \Pan{7,2,18} \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{ppna}~\ocwlowerid{w}~=~[~\ocwupperid{Na}~\ocwlowerid{w}~]~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[~2~::~\ocwlowerid{\_}~]~\mid{}~[~4~::~\ocwlowerid{\_}~]~\mid{}~[~6~::~\ocwlowerid{\_}~]~$\ocwbc{} stems in aa ii uu \ocwec{}\ocweol
\ocwindent{4.00em}
$\rightarrow{}~\ocwlowerid{ppna}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~3~::~\ocwlowerid{r}~]~\rightarrow{}~\ocwlowerid{ppna}~[~4~::~\ocwlowerid{r}~]~$\ocwbc{} piina rii.na \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~8~::~\ocwlowerid{r}~]~$\ocwbc{} .rr -> r+vow \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{vow}~=~$\ocweol
\ocwindent{5.00em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~$\ocwstring{"p.rr"}~$\rightarrow{}~6~$\ocwbc{} uu \ocwec{}~\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~4~$\ocwbc{} ii \ocwec{}~\ocweol
\ocwindent{7.00em}
\ocwbc{} \ocwstring{"k.rr"} | \ocwstring{"g.rr\#1"} | \ocwstring{"j.rr"} | \ocwstring{"t.rr"} | \ocwstring{"d.rr"} | \ocwstring{"st.rr"} \ocwec{}\ocweol
\ocwindent{5.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~[~43~$\ocwbc{} r \ocwec{}~::~$[~\ocwlowerid{vow}~::~\ocwlowerid{r}~]~]~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"p.rr"}~$\rightarrow{}~[~\ocwupperid{Ta}~\ocwlowerid{stem}~::~\ocwlowerid{ppna}~\ocwlowerid{stem}~]~$\ocwbc{} alternate form puurta \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"st.rr"}~$\rightarrow{}~[~\ocwupperid{Ta}~[~7~::~\ocwlowerid{r}~]~::~\ocwlowerid{ppna}~\ocwlowerid{stem}~]~$\ocwbc{} alternate form st.rta \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{ppna}~\ocwlowerid{stem}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~11~::~\ocwlowerid{r}~]~$\ocwbc{} ai \ocwec{}~$\rightarrow{}~\ocwlowerid{ppna}~[~2~::~\ocwlowerid{r}~]~$\ocwbc{} glaana \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~19~::~\ocwlowerid{\_}~]~\mid{}~[~20~::~\ocwlowerid{\_}~]~$\ocwbc{} g gh \ocwec{}~$\rightarrow{}~\ocwlowerid{ppna}~\ocwlowerid{rstem}~$\ocwbc{} daghna \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~24~::~\ocwlowerid{r}~]~$\ocwbc{} j \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}~\ocweol
\ocwindent{9.50em}
$[~[~26~::~\ocwlowerid{s}~]~$\ocwbc{} ~n \ocwec{}~\ocwbc{} bhagna \ocwec{}\ocweol
\ocwindent{9.50em}
$\mid{}~[~24~::~\ocwlowerid{s}~]~$\ocwbc{} j \ocwec{}~$\rightarrow{}~[~19~::~\ocwlowerid{s}~]~$\ocwbc{} magna \ocwec{}\ocweol
\ocwindent{9.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~19~::~\ocwlowerid{r}~]~$\ocwbc{} revert to guttural g \ocwec{}\ocweol
\ocwindent{9.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{ppna}~\ocwlowerid{stem}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~34~$\ocwbc{} d \ocwec{}~::~$([~36~$\ocwbc{} n \ocwec{}~::~$\ocwlowerid{\_}~]~$\ocwkw{as}~$\ocwlowerid{r})~]~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwbc{} d is dropped eg und skand \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{ppn}~=~\ocwlowerid{ppna}~\ocwlowerid{r}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"und"}~$\rightarrow{}~[~\ocwlowerid{sTa}~$\ocwstring{"ud"}~::~$\ocwlowerid{ppn}~]~$\ocwbc{} for utta and abs -udya \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{ppn}~$\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{3.00em}
$\mid{}~[~34~$\ocwbc{} d \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwbc{} assimilation of d to n - special sandhi Macdonnel§60 foot 1 \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{ppn}~=~\ocwlowerid{ppna}~[~36~$\ocwbc{} n \ocwec{}~::~$\ocwlowerid{r}~]~$\ocwkw{in}~\ocwbc{} en fait il faudrait d'+n->nn \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"vid\#2"}~$\rightarrow{}~[~\ocwupperid{Ta}~\ocwlowerid{rstem}~::~\ocwlowerid{ppn}~]~$\ocwbc{} 2 forms \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"nud"}~$\rightarrow{}~[~\ocwupperid{Ta}~\ocwlowerid{rstem}~::~[~\ocwupperid{Tia}~\ocwlowerid{rstem}~::~\ocwlowerid{ppn}~]~]~$\ocwbc{} 3 forms \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{ppn}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~36~::~([~1~::~\ocwlowerid{r}~]~$\ocwkw{as}~$\ocwlowerid{w})~]~$\ocwbc{} -an \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{6.50em}
$[~\ocwupperid{Ta}~\ocwlowerid{w}~::~\ocwlowerid{ppna}~[~2~::~\ocwlowerid{r}~]~]~$\ocwbc{} mata+maana \ocwec{}~\ocweol
\ocwindent{3.00em}
$\mid{}~[~43~$\ocwbc{} r \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~\ocwlowerid{ppna}~\ocwlowerid{rstem}~$\ocwbc{} iir.na \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~45~$\ocwbc{} v \ocwec{}~::~$[~10~$\ocwbc{} e \ocwec{}~::~$\ocwlowerid{r}~]~]~\rightarrow{}~$\ocwbc{} dev \ocwec{}\ocweol
\ocwindent{6.50em}
$\ocwlowerid{ppna}~[~6~$\ocwbc{} uu \ocwec{}~::~$[~42~$\ocwbc{} y \ocwec{}~::~$\ocwlowerid{r}~]~]~$\ocwbc{} dyuuna \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unexpected\ocwvspace{}ppp\ocwvspace{}in\ocwvspace{}\symbol{45}na\ocwvspace{}for\ocwvspace{}"}~\^{}~$\ocwlowerid{entry})$\ocweol
\ocwindent{3.00em}
$]~$\ocwbc{} end participles in -na \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"pac"}~$\rightarrow{}~[~\ocwlowerid{sVa}~$\ocwstring{"pak"}~$]~$\ocwbc{} exception \Pan{8.2.51} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zu.s"}~$\rightarrow{}~[~\ocwupperid{Ka}~\ocwlowerid{rstem}~]~$\ocwbc{} exception \Pan{8.2.52} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwbc{} otherwise participle in -ta (Panini kta) \ocwec{}\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{ppstems}~=$\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{ppstem}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{5.50em}
$[~$\ocwstring{"dhaa\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"hi"}~\ocwbc{} double weakening hi-ta \Pan{7,4,42} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"bh.rjj"}~$\rightarrow{}~[~124;~7;~40~]~$\ocwbc{} bh.rj' - mrijification of truncate \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{".rc\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"arc"}~\ocwbc{} strong \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{".rj"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"arj"}~\ocwbc{} strong \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"k.svi.d"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"k.sve.d"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"vip"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"vep"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"jak.s"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"jagh"}~\ocwbc{} jagdha \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"trai"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"traa"}~\ocwbc{} glai given in -na section \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"k.san"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"k.sa"}~\ocwbc{} removal of final nasal \ocwec{}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"gam"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"ga"}~\ocwbc{} \Pan{6,4,37} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"tan\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"ta"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"nam"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"na"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"yam"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"ya"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"ram"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"ra"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"van"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"va"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"han\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"ha"}~\ocwbc{} also \ocwstring{"man"} mata given with maana \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"khan"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"khaa"}~\ocwbc{} \Pan{6,4,42} lengthening of vowel \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"jan"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"jaa"}~\ocwbc{} id \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"san\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"saa"}~\ocwbc{} id \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"am"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"aan"}~\ocwbc{} -am -> -aan \Pan{6,4,15} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"kam"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"kaan"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"kram"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"kraan"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"cam"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"caan"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"k.sam"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"k.saan"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"dam\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"daan"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"bhram"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"bhraan"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"vam"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"vaan"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"zram"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"zraan"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"zam\#1"}~$\mid{}~$\ocwstring{"zam\#2"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"zaan"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"dhvan"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"dhvaan"}~\ocwbc{} id. for final n \ocwec{}~\ocwbc{} Whit§955a \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"daa\#2"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"di"}~\ocwbc{} aa -> i \Pan{7,4,40} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"maa\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"mi"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"zaa"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"zi"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"saa\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"si"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"sthaa\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"sthi"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"diiv\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"dyuu"}~\ocwbc{} iiv -> yuu \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"siiv"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"syuu"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"daa\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"dad"}~\ocwbc{} ad hoc \Pan{7,4,46} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"dham"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"dhmaa"}~\ocwbc{} \Pan{7,3,78} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"dhaav\#2"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"dhau"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"dhv.r"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"dhuur"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"puuy"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"puu"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"bhi.saj\#2"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"bhi.sajy"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"skambh"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"skabh"}~\ocwbc{} skambh -> skabh \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"zrath"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"zranth"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"muurch"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"muur"}~\ocwbc{} muurta \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"av"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"uu"}~\ocwbc{} uuta \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"i"}~$\mid{}~$\ocwstring{".r"}~$\mid{}~$\ocwstring{"k.r\#1"}~$\mid{}~$\ocwstring{"kyaa"}~$\mid{}~$\ocwstring{"khyaa"}~$\mid{}~$\ocwstring{"gu\~{}nj"}~$\mid{}~$\ocwstring{"gh.r"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"ghraa"}~$\mid{}~$\ocwstring{"ci"}~$\mid{}~$\ocwstring{"cyu"}~$\mid{}~$\ocwstring{"ji"}~$\mid{}~$\ocwstring{"daa\#3"}~$\mid{}~$\ocwstring{"du"}~$\mid{}~$\ocwstring{"dru\#1"}~$\mid{}~$\ocwstring{"dh.r"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"dhyaa"}~$\mid{}~$\ocwstring{"dhru"}~$\mid{}~$\ocwstring{"nu\#1"}~$\mid{}~$\ocwstring{"praa\#1"}~$\mid{}~$\ocwstring{"bh.r"}~$\mid{}~$\ocwstring{"mi"}~$\mid{}~$\ocwstring{"m.r"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"yaa\#1"}~$\mid{}~$\ocwstring{"yu\#1"}~$\mid{}~$\ocwstring{"yu\#2"}~$\mid{}~$\ocwstring{"raa\#1"}~$\mid{}~$\ocwstring{"ru"}~$\mid{}~$\ocwstring{"va\~{}nc"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"vaa\#2"}~$\mid{}~$\ocwstring{"v.r\#1"}~$\mid{}~$\ocwstring{"v.r\#2"}~$\mid{}~$\ocwstring{"zaas"}~$\mid{}~$\ocwstring{"zri"}~$\mid{}~$\ocwstring{"zru"}~$\mid{}~$\ocwstring{"su\#2"}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"s.r"}~$\mid{}~$\ocwstring{"stu"}~$\mid{}~$\ocwstring{"snaa"}~$\mid{}~$\ocwstring{"snu"}~$\mid{}~$\ocwstring{"smi"}~$\mid{}~$\ocwstring{"sm.r"}~$\mid{}~$\ocwstring{"haa\#1"}~$\mid{}~$\ocwstring{"hi\#2"}~\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"hu"}~$\mid{}~$\ocwstring{"h.r\#1"}~$\rightarrow{}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{6.00em}
\ocwbc{} roots ending in a vowel do not take \ocwbegindcode{}$\ocwlowerid{passive\_stem}$\ocwenddcode{} in general ? \ocwec{}\ocweol
\ocwindent{6.00em}
\ocwbc{} vérifier forme passive pour racines ci-dessus \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{passive\_stem}~\ocwlowerid{entry}~\ocwlowerid{rstem}~$\ocwbc{} possibly duhified and mirjified \ocwec{}\ocweol
\ocwindent{5.50em}
$]~$\ocwkw{in}~$[~\ocwupperid{Ta}~\ocwlowerid{ppstem}~::~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{10.00em}
$[~$\ocwstring{".rc\#1"}~$\mid{}~$\ocwstring{".rj"}~$\mid{}~$\ocwstring{"k.svi.d"}~$\mid{}~$\ocwstring{"ba.mh"}~$\mid{}~$\ocwstring{"ma.mh"}~$\mid{}~$\ocwstring{"manth"}~\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"yaj\#1"}~$\mid{}~$\ocwstring{"vyadh"}~$\mid{}~$\ocwstring{"grah"}~$\mid{}~$\ocwstring{"vrazc"}~$\mid{}~$\ocwstring{"praz"}~$\mid{}~$\ocwstring{"zrath"}~\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"svap"}~$\rightarrow{}$\ocweol
\ocwindent{13.50em}
$[~\ocwupperid{Tia}~\ocwlowerid{ppstem}~]~$\ocwbc{} avoids *ma.mhita \ocwec{}~\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"vaz"}~$\mid{}~$\ocwstring{"vac"}~$\mid{}~$\ocwstring{"vap"}~$\mid{}~$\ocwstring{"vap\#1"}~$\mid{}~$\ocwstring{"vap\#2"}~$\mid{}~$\ocwstring{"vad"}~\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"vas\#1"}~$\mid{}~$\ocwstring{"vas\#4"}~$\rightarrow{}$\ocweol
\ocwindent{13.50em}
$[~\ocwupperid{Tia}~\ocwlowerid{rstem};~\ocwupperid{Tia}~\ocwlowerid{ppstem}~]$\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"guh"}~$\rightarrow{}~[~\ocwupperid{Tia}~(\ocwlowerid{revstem}~$\ocwstring{"guuh"}$)~]~$\ocwbc{} \Pan{6,4,89} \ocwec{}\ocweol
\ocwindent{10.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~\ocwupperid{Tia}~\ocwlowerid{rstem}~]~$\ocwbc{} standard Paninian way \ocwec{}\ocweol
\ocwindent{10.00em}
$]~$\ocweol
\ocwindent{8.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{extra\_forms}~=~$\ocweol
\ocwindent{5.50em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} supplementary forms \ocwec{}\ocweol
\ocwindent{5.50em}
$[~$\ocwstring{"a\~{}nc"}~$\rightarrow{}~[~\ocwlowerid{sNa}~$\ocwstring{"ak"}~::~$[~\ocwlowerid{sTia}~$\ocwstring{"a\~{}nc"}~$]~]~$\ocwbc{} \ocwstring{"akna"}, \ocwstring{"a\~{}ncita"} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"kuc"}~$\rightarrow{}~[~\ocwlowerid{sTia}~$\ocwstring{"ku\~{}nc"}~$]~$\ocwbc{} \ocwstring{"ku\~{}ncita"} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"grah"}~$\rightarrow{}~[~\ocwlowerid{sTa}~$\ocwstring{"g.rbh"}~::~$[~\ocwlowerid{sTia}~$\ocwstring{"g.rbh"}~$]~]~$\ocwbc{} \ocwstring{"g.rbhiita"} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"car"}~$\rightarrow{}~[~\ocwlowerid{sNa}~$\ocwstring{"ciir"}~$]~$\ocwbc{} irreg. na ppp \ocwstring{"ciir.na"} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"tvar"}~$\rightarrow{}~[~\ocwlowerid{sNa}~$\ocwstring{"tuur"}~$]~$\ocwbc{} irreg. na ppp \ocwstring{"tuur.na"} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"du"}~$\rightarrow{}~[~\ocwlowerid{sNa}~$\ocwstring{"duu"}~$]~$\ocwbc{} \ocwstring{"duuna"} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"lag"}~$\rightarrow{}~[~\ocwlowerid{sNa}~$\ocwstring{"lag"}~$]~$\ocwbc{} irreg. na ppp \ocwstring{"lagna"} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"druh\#1"}~$\rightarrow{}~[~\ocwlowerid{sTa}~$\ocwstring{"druh"}~$]~$\ocwbc{} opt. duhify \ocwstring{"druu.dha"} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"dhuu\#1"}~$\rightarrow{}~[~\ocwlowerid{sTa}~$\ocwstring{"dhu"}~$]$\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"muh"}~$\rightarrow{}~[~\ocwlowerid{sTa}~$\ocwstring{"muh"}~$]~$\ocwbc{} opt. duhify \ocwstring{"muu.dha"} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"mlecch"}~$\rightarrow{}~[~\ocwlowerid{sTa}~$\ocwstring{"mlich"}~$]~$\ocwbc{} \ocwstring{"mli.s.ta"} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"vaa\#3"}~$\rightarrow{}~[~\ocwlowerid{sTa}~$\ocwstring{"u"}~$]$\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"sah\#1"}~$\rightarrow{}~[~\ocwlowerid{sTa}~$\ocwstring{"soh"}~$]~$\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"suu\#1"}~$\rightarrow{}~[~\ocwlowerid{sTa}~$\ocwstring{"su"}~$]$\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"snih\#1"}~$\rightarrow{}~[~\ocwlowerid{sTa}~$\ocwstring{"snih"}~$]~$\ocwbc{} opt. duhify \ocwstring{"snii.dha"} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"snuh\#1"}~$\rightarrow{}~[~\ocwlowerid{sTa}~$\ocwstring{"snuh"}~$]~$\ocwbc{} opt. duhify \ocwstring{"snuu.dha"} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"haa\#1"}~$\rightarrow{}~[~\ocwlowerid{sNa}~$\ocwstring{"hii"}~::~$[~\ocwlowerid{sNa}~$\ocwstring{"haa"}~$]~]~$\ocwbc{} irreg. na ppp \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"hrii\#1"}~$\rightarrow{}~[~\ocwlowerid{sNa}~$\ocwstring{"hrii"}~$]~$\ocwbc{} \ocwstring{"hrii.na"} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[\,]$\ocweol
\ocwindent{5.50em}
$]~$\ocwkw{in}~$\ocwlowerid{extra\_forms}~@~\ocwlowerid{ppstems}~$\ocweol
\ocwindent{2.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Metathesis -arx -> -rax 
\ocweol
\label{verbs.ml:101469}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ar\_ra}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~[~43~::~[~1~::~\ocwlowerid{r}~]~]~]~\rightarrow{}~[~\ocwlowerid{c}~::~[~1~::~[~43~::~\ocwlowerid{r}~]~]~]~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{w}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"metathesis\ocwvspace{}failure\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{rdecode}~\ocwlowerid{w})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Stems used for periphrastic futur, infinitive, and gerundive in -tavya \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Redundancy with intercalates ought to be addressed. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{perstems}~\ocwlowerid{rstem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{sstem}~=~\ocwlowerid{strong\_stem}~\ocwlowerid{entry}~\ocwlowerid{rstem}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{inter}~=~$\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[~7;~45~$\ocwbc{} v.r \ocwec{}~$]~\rightarrow{}~[~1;~2~]~$\ocwbc{} i/ii* \ocwbegindcode{}$\ocwlowerid{v}.\ocwlowerid{r}\#1$\ocwenddcode{} and \ocwbegindcode{}$\ocwlowerid{v}.\ocwlowerid{r}\#2$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~7~$\ocwbc{}.r \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~[~0~]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~$\ocwstring{"gam"}~$\mid{}~$\ocwstring{"dham"}~$\mid{}~$\ocwstring{"praz"}~$\mid{}~$\ocwstring{"vaa\#3"}~$\mid{}~$\ocwstring{"za.ms"}~$\mid{}~$\ocwstring{"han\#1"}~$\mid{}~$\ocwstring{"huu"}\ocweol
\ocwindent{7.50em}
$\rightarrow{}~[~0~]$\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"v.rj"}~$\rightarrow{}~[~1~]$\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"zuc\#1"}~$\rightarrow{}~[~0;~1~]~$\ocwbc{} zoktum \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"d.rz\#1"}~$\rightarrow{}~[~3~]~$\ocwbc{} ar -> ra dra.s.tum \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"k.r.s"}~$\mid{}~$\ocwstring{"bh.rjj"}~$\rightarrow{}~[~0;~3~]~$\ocwbc{} berk \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"naz\#1"}~$\rightarrow{}~[~0;~1;~4~]~$\ocwbc{} berk - (1 not in WR) \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"radh"}~$\mid{}~$\ocwstring{"trap\#1"}~$\mid{}~$\ocwstring{"d.rp"}~$\mid{}~$\ocwstring{"druh\#1"}~$\mid{}~$\ocwstring{"muh"}~$\mid{}~$\ocwstring{"rudh\#2"}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"snih\#1"}~$\mid{}~$\ocwstring{"snuh\#1"}~\ocwbc{} \Pan{7,2,45} \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"i.s\#1"}~$\mid{}~$\ocwstring{"sah\#1"}~$\mid{}~$\ocwstring{"lubh"}~$\mid{}~$\ocwstring{"ru.s\#1"}~$\mid{}~$\ocwstring{"ri.s"}~\ocwbc{} \Pan{7,2,48} \ocwec{}\ocweol
\ocwindent{8.50em}
$\rightarrow{}~[~0;~1~]$\ocweol
\ocwindent{6.50em}
\ocwbc{} TODO: also optionally all \ocwbegindcode{}$\ocwlowerid{uu}-\ocwlowerid{it}$\ocwenddcode{} roots - \Pan{7,2,44} \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{intercalates}~\ocwlowerid{entry}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{6.50em}
$]~$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{map}~\ocwlowerid{insert\_sfx}~\ocwlowerid{inter}$\ocweol
\ocwindent{2.50em}
$\ocwlowerid{where}~\ocwlowerid{insert\_sfx}~=~$\ocwkw{fun}\ocweol
\ocwindent{3.50em}
$[~0~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{7.00em}
$[~$\ocwstring{"majj"}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"mafk"}~\ocwbc{} Whitney§936a \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"jan"}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"jaa"}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"dham"}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"dhmaa"}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"nij"}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"nej"}~\ocwbc{} for gana 3 \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"vah\#1"}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"voh"}~\ocwbc{} vo.dhaa \Pan{6,3,112} \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"sah"}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"soh"}~\ocwbc{} so.dhum \Pan{6,3,112} \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"likh"}~$\mid{}~$\ocwstring{"vij"}~$\rightarrow{}~\ocwlowerid{rev}~[~3~::~\ocwlowerid{rstem}~]~$\ocwbc{} i with weak stem \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"vrazc"}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"vraz"}~\ocwbc{} ought to be truncated by int sandhi \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"za.ms"}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"zas"}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"huu"}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"hvaa"}~\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{rev}~($\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}~\ocweol
\ocwindent{10.50em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}\ocweol
\ocwindent{12.50em}
$[~10~\mid{}~11~\mid{}~12~\mid{}~13~\rightarrow{}~[~2~::~\ocwlowerid{r}~]~$\ocwbc{} eg gai -> gaa \ocwec{}\ocweol
\ocwindent{12.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{sstem}$\ocweol
\ocwindent{12.50em}
$]$\ocweol
\ocwindent{10.50em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_empty}~12$\ocweol
\ocwindent{10.50em}
$])$\ocweol
\ocwindent{7.00em}
$]~$\ocweol
\ocwindent{3.50em}
$\mid{}~1~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{8.00em}
$[~$\ocwstring{"uc"}~$\mid{}~$\ocwstring{"mil"}~$\mid{}~$\ocwstring{"sphu.t"}~$\mid{}~$\ocwstring{"sphur"}~$\rightarrow{}~\ocwlowerid{rstem}$\ocweol
\ocwindent{8.00em}
$\mid{}~$\ocwstring{"guh"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"guuh"}~\ocwbc{} \Pan{6,4,89} \ocwec{}\ocweol
\ocwindent{8.00em}
$\mid{}~$\ocwstring{"sad\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"siid"}~\ocweol
\ocwindent{8.00em}
$\mid{}~$\ocwstring{"sp.rh"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"sp.rhay"}\ocweol
\ocwindent{8.00em}
$\mid{}~$\ocwstring{"haa\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"jah"}~\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{sstem}$\ocweol
\ocwindent{8.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{7.00em}
$\ocwlowerid{sandhi}~\ocwlowerid{w}~(\ocwlowerid{code}~$\ocwstring{"i"}$)~$\ocwbc{} sandhi sanitizes a possible j' or h' \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~2~\rightarrow{}~\ocwlowerid{sandhi}~\ocwlowerid{sstem}~(\ocwlowerid{code}~$\ocwstring{"ii"}$)~$\ocwbc{} grah \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~3~\rightarrow{}~\ocwlowerid{rev}~(\ocwlowerid{ar\_ra}~\ocwlowerid{sstem})~$\ocwbc{} metathesis: kra.s.taa bhra.s.taa dra.s.taa \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~4~\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"na.mz"}~\ocwbc{} exception naz \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"perstems:\ocwvspace{}weird\ocwvspace{}intercalate\ocwvspace{}code"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_future\_gen}~\ocwlowerid{rstem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{sstem}~=~\ocwlowerid{strong\_stem}~\ocwlowerid{entry}~\ocwlowerid{rstem}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stems}~=~\ocwlowerid{map}~\ocwlowerid{insert\_sfx}~(\ocwlowerid{intercalates}~\ocwlowerid{entry}~\ocwlowerid{rstem})$\ocweol
\ocwindent{2.50em}
$\ocwlowerid{where}~\ocwlowerid{insert\_sfx}~=~$\ocwkw{fun}~\ocweol
\ocwindent{3.50em}
$[~0~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~$\ocwstring{"naz"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"nafk"}~\ocwbc{} Whitney§936a \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"majj"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"mafk"}~\ocwbc{} Whitney§936a \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"d.rz\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"drak"}~\ocwbc{} drak.sya \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"gai"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"gaa"}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"jan"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"jaa"}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"nij"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"nej"}~\ocwbc{} consistent with gana 3 \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"bharts"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"bhart"}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"likh"}~$\mid{}~$\ocwstring{"vij"}~$\rightarrow{}~[~3~::~\ocwlowerid{rstem}~]~$\ocwbc{} i with weak stem (hack) \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"vas\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"vat"}~\ocwbc{} vatsyati Whitney§167 \Pan{7,4,49} \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"vrazc"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"vrak"}~\ocwbc{} vrak.sya \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"saa\#1"}~$\rightarrow{}~\ocwlowerid{rstem}~$\ocwbc{} saa si \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{sstem}~$\ocwbc{} for nij gana 3 \ocwec{}\ocweol
\ocwindent{6.50em}
$]~$\ocwkw{in}~$\ocwlowerid{sandhi}~\ocwlowerid{w}~(\ocwlowerid{code}~$\ocwstring{"sya"}$)~$\ocwbc{} eg dah -> dhak.sya \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~1~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~$\ocwstring{"uc"}~$\mid{}~$\ocwstring{"mil"}~$\mid{}~$\ocwstring{"sphu.t"}~$\mid{}~$\ocwstring{"sphur"}~$\rightarrow{}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"guh"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"guuh"}~\ocwbc{} \Pan{6,4,89} \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"dabh"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"dambh"}~\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"nij"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"ni\~{}nj"}~\ocwbc{} consistent with gana 2 \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"sad\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"siid"}~\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"vaa\#3"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"ve"}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"haa\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"jah"}~\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"huu"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"hve"}~\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{sstem}$\ocweol
\ocwindent{6.50em}
$]~$\ocwkw{in}~$\ocwlowerid{sandhi}~\ocwlowerid{w}~(\ocwlowerid{code}~$\ocwstring{"i.sya"}$)$\ocweol
\ocwindent{3.50em}
$\mid{}~2~\rightarrow{}~\ocwlowerid{sandhi}~\ocwlowerid{sstem}~(\ocwlowerid{code}~$\ocwstring{"ii.sya"}$)~$\ocwbc{} grah \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~3~\rightarrow{}~\ocwlowerid{sandhi}~(\ocwlowerid{ar\_ra}~\ocwlowerid{sstem})~(\ocwlowerid{code}~$\ocwstring{"sya"}$)~$\ocwbc{} metathesis k.r.s bh.rjj s.rj \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Weird\ocwvspace{}intercalate\ocwvspace{}code"}\ocweol
\ocwindent{3.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{iter}~\ocwlowerid{mk\_future}~\ocwlowerid{stems}~$\ocweol
\ocwindent{3.50em}
$\ocwlowerid{where}~\ocwlowerid{mk\_future}~\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{stem}~$\ocwkw{with}\ocweol
\ocwindent{4.50em}
$[~[~1~::~\ocwlowerid{st}~]~\rightarrow{}~\ocwlowerid{compute\_future}~\ocwlowerid{st}~\ocwlowerid{entry}$\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{error\_empty}~13~$\ocweol
\ocwindent{4.50em}
$]~$\ocwbc{} Note that sandhi with sy would fail with finalize \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_future\_10}~\ocwlowerid{rstem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{fsuf}~=~\ocwlowerid{revcode}~$\ocwstring{"i.sy"}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"tul"}~$\rightarrow{}~$\ocwkw{do}~\ocwbc{} 2 forms \ocwec{}\ocweol
\ocwindent{3.50em}
\{~$\ocwlowerid{compute\_future}~(\ocwlowerid{fsuf}~@~(\ocwlowerid{revcode}~$\ocwstring{"tulay"}$))~\ocwlowerid{entry}$\ocweol
\ocwindent{3.50em}
;~$\ocwlowerid{compute\_future}~(\ocwlowerid{fsuf}~@~(\ocwlowerid{revcode}~$\ocwstring{"tolay"}$))~\ocwlowerid{entry}$\ocweol
\ocwindent{3.50em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{strengthen\_10}~\ocwlowerid{rstem}~\ocwlowerid{entry}~$\ocwkw{in}~\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{aystem}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~(\ocwlowerid{sandhi}~\ocwlowerid{stem}~[~1;~42~]~$\ocwbc{} ay \ocwec{}$)~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{fstem}~=~\ocwlowerid{fsuf}~@~\ocwlowerid{aystem}~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{compute\_future}~\ocwlowerid{fstem}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Passive system 
\ocweol
\label{verbs.ml:106805}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{admits\_passive}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~$\ocwbc{} We filter out roots with no attested passive forms \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwstring{"an\#2"}~$\mid{}~$\ocwstring{"av"}~$\mid{}~$\ocwstring{"as\#1"}~$\mid{}~$\ocwstring{"iiz\#1"}~$\mid{}~$\ocwstring{"uc"}~$\mid{}~$\ocwstring{"kan"}~$\mid{}~$\ocwstring{"kuu"}~$\mid{}~$\ocwstring{"k.lp"}$\mid{}~$\ocwstring{"k.si"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"kha.n.d"}~$\mid{}~$\ocwstring{"daa\#2"}~$\mid{}~$\ocwstring{"dyut\#1"}~$\mid{}~$\ocwstring{"dru\#1"}~$\mid{}~$\ocwstring{"pat\#2"}~$\mid{}~$\ocwstring{"paz"}~$\mid{}~$\ocwstring{"paa\#2"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"pi\#2"}~$\mid{}~$\ocwstring{"praa\#1"}~$\mid{}~$\ocwstring{"ruc\#1"}~$\mid{}~$\ocwstring{"vas\#4"}~$\mid{}~$\ocwstring{"vidh\#1"}~$\mid{}~$\ocwstring{"vip"}~$\mid{}~$\ocwstring{"vyac"}~$\mid{}~$\ocwstring{"zam\#1"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"zrambh"}~$\mid{}~$\ocwstring{"zvit"}~$\mid{}~$\ocwstring{"siiv"}~$\mid{}~$\ocwstring{"spaz\#1"}~$\mid{}~$\ocwstring{"spardh"}~$\mid{}~$\ocwstring{"h.r\#2"}~$\mid{}~$\ocwstring{"hrii\#1"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"ma.mh"}~\ocwbc{} supplied by \ocwstring{"mah"} \ocwec{}\ocweol
\ocwindent{3.00em}
$\rightarrow{}~\ocwupperid{False}~$\ocweol
\ocwindent{0.00em}
\ocwbc{} But \ocwstring{"iiz\#1"} \ocwstring{"uc"} \ocwstring{"kuu"} \ocwstring{"k.lp"} \ocwstring{"dru\#1"} \ocwstring{"pi\#2"} \ocwstring{"ruc\#1"} \ocwstring{"vip"} \ocwstring{"zam\#1"} 
       \ocwstring{"zrambh"} \ocwstring{"siiv"} \ocwstring{"spardh"} \ocwstring{"hrii\#1"} admit ppp. and \ocwstring{"k.lp"} admits pfp. \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{True}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Similar to \ocwbegindcode{}$\ocwlowerid{compute\_thematic\_middle}$\ocwenddcode{}  
\ocweol
\label{verbs.ml:107466}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_passive\_present}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~\ocwlowerid{verbal}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ase"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ate"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"tap"}~\ocwkw{then}~$[~\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ati"}~::~$\ocwlowerid{l}~]~$\ocwkw{else}~$\ocwlowerid{l}$\ocweol
\ocwindent{6.50em}
\ocwbc{} Bergaigne exception tapyati \ocwec{}$)$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aavahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ethe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ete"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aamahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"adhve"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ante"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_passive\_imperfect}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~\ocwlowerid{verbal}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"athaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ata"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aavahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ethaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"etaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aamahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"adhvam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"anta"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_passive\_optative}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~\ocwlowerid{verbal}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"eya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ethaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"eta"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"evahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"eyaathaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"eyaataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"emahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"edhvam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"eran"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_passive\_imperative}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~\ocwlowerid{verbal}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"ai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"asva"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aavahai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ethaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"etaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aamahai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"adhvam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"antaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Same as (reversed) internal sandhi of (reversed) stem and \ocwstring{"y"} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{affix\_y}~\ocwlowerid{stem}~=~$\ocweol
\ocwindent{1.00em}
$[~42~$\ocwbc{} y \ocwec{}~::~$\ocwupperid{Int\_sandhi.}\ocwlowerid{restore\_stem}~\ocwlowerid{stem}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_passive\_system}~\ocwlowerid{conj}~\ocwlowerid{root}~\ocwlowerid{pastem}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_passive\_present}~(\ocwlowerid{fpresp}~\ocwlowerid{conj})~\ocwlowerid{pastem}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_passive\_imperfect}~(\ocwlowerid{fimpftp}~\ocwlowerid{conj})~\ocwlowerid{pastem}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_passive\_optative}~(\ocwlowerid{foptp}~\ocwlowerid{conj})~\ocwlowerid{pastem}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_passive\_imperative}~(\ocwlowerid{fimperp}~\ocwlowerid{conj})~\ocwlowerid{pastem}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part\_m\_th}~(\ocwlowerid{vpprp}~\ocwlowerid{conj})~\ocwlowerid{pastem}~\ocwlowerid{root}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_passive}~\ocwlowerid{conj}~\ocwlowerid{root}~\ocwlowerid{stem}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{ps\_stem}~=~\ocwlowerid{affix\_y}~\ocwlowerid{stem}~$\ocwbc{} \ocwstring{"y"} marks passive \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{compute\_passive\_system}~\ocwlowerid{conj}~\ocwlowerid{root}~\ocwlowerid{ps\_stem}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_passive\_raw}~\ocwlowerid{root}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{ps\_stem}~=~\ocwlowerid{passive\_stem}~\ocwlowerid{root}~(\ocwlowerid{revstem}~\ocwlowerid{root})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{compute\_passive}~\ocwupperid{Primary}~\ocwlowerid{root}~\ocwlowerid{ps\_stem}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_passive\_10}~\ocwlowerid{root}~\ocwlowerid{ps\_stem}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"tul"}~$\rightarrow{}~($\ocwbc{} no passive\ocwec{}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{compute\_passive}~\ocwupperid{Primary}~\ocwlowerid{root}~\ocwlowerid{ps\_stem}~$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_passive\_11}~\ocwlowerid{root}~\ocwlowerid{ps\_stem}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"adhvara"}~$\mid{}~$\ocwstring{"asuuya"}~$\mid{}~$\ocwstring{"iras"}~$\mid{}~$\ocwstring{"ka.n.du"}~$\mid{}~$\ocwstring{"karu.na"}~$\mid{}~$\ocwstring{"tapas"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"namas"}~$\rightarrow{}~($\ocwbc{} no passive \ocwec{}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{compute\_passive}~\ocwupperid{Primary}~\ocwlowerid{root}~\ocwlowerid{ps\_stem}~$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Perfect system 
\ocweol
\ocwindent{0.00em}
Reduplication for perfect. \ocwbegindcode{}$\ocwlowerid{redup\_perf}$\ocwenddcode{} takes a string, and returns 
   \ocwbegindcode{}$(\ocwlowerid{s},\ocwlowerid{w},\ocwlowerid{o},\ocwlowerid{e},\ocwlowerid{b})$\ocwenddcode{} where \ocwbegindcode{}$\ocwlowerid{s}$\ocwenddcode{} is the (reversed) strong stem word,
   \ocwbegindcode{}$\ocwlowerid{w}$\ocwenddcode{} is the (reversed) weak stem word, 
   \ocwbegindcode{}$\ocwlowerid{o}$\ocwenddcode{} is an optional lengthened stem word,
   \ocwbegindcode{}$\ocwlowerid{e}$\ocwenddcode{} is a boolean flag (True if 2nd sg weak) 
   \ocwbegindcode{}$\ocwlowerid{b}$\ocwenddcode{} is a boolean flag (True if optional union-vowel i) 
\ocweol
\ocwindent{0.00em}
NB b=iopt not sufficient. See Whitney§797 
\ocweol
\ocwindent{0.00em}
Warning: baroque code ahead 
\ocweol
\label{verbs.ml:111195}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{redup\_perf}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{revw},\ocwlowerid{revs},\ocwlowerid{revl})~=~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~$\ocwstring{"ji"}~$\rightarrow{}~\ocwlowerid{stems}~$\ocwstring{"gi"}~\ocwbc{} palatal -> velar \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"ci"}~$\rightarrow{}~\ocwlowerid{stems}~$\ocwstring{"ki"}~\ocwbc{} idem \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"cit\#1"}~$\rightarrow{}~\ocwlowerid{stems}~$\ocwstring{"kit"}~\ocwbc{} idem \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"umbh"}~$\rightarrow{}~\ocwlowerid{stems}~$\ocwstring{"ubh"}~\ocwbc{} remove penultimate nasal \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"sva\~{}nj"}~$\rightarrow{}~\ocwlowerid{stems}~$\ocwstring{"svaj"}~\ocwbc{} idem \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"han\#1"}~$\rightarrow{}~\ocwlowerid{stems}~$\ocwstring{"ghan"}~\ocwbc{} velar h -> gh \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"hi\#2"}~$\rightarrow{}~\ocwlowerid{stems}~$\ocwstring{"ghi"}~\ocwbc{} idem \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"guh"}~$\rightarrow{}~\ocwlowerid{stems}~$\ocwstring{"guuh"}~\ocwbc{} \Pan{6,4,89} \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"dham"}~$\rightarrow{}~\ocwlowerid{stems}~$\ocwstring{"dhmaa"}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"praz"}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w}~=~\ocwlowerid{revcode}~$\ocwstring{"pracch"}~\ocwkw{in}~$(\ocwlowerid{w},\ocwlowerid{w},\ocwlowerid{w})~$\ocwbc{} Whitney§794c \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"zaas"}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w}~=~\ocwlowerid{revcode}~\ocwlowerid{root}~$\ocwkw{in}~$(\ocwlowerid{w},\ocwlowerid{w},\ocwlowerid{w})~$\ocwbc{} redup voy a, not i \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{stems}~\ocwlowerid{root}~$\ocwbc{} NB: keep penultimate nasal \ocwstring{"ta\~{}nc"} \ocwec{}\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{rev}~\ocwlowerid{revw}~$\ocwkw{with}~\ocwbc{} ugly double reversal gets the stem from its rev \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{error\_empty}~14$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c1}~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c1}~$\ocwkw{then}~\ocwkw{let}~$(\ocwlowerid{s},\ocwlowerid{w})~=~$\ocwkw{match}~$\ocwlowerid{c1}~$\ocwkw{with}\ocweol
\ocwindent{4.50em}
$[~1~$\ocwbc{} a \ocwec{}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~[~\ocwlowerid{c2}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{root}~=~$\ocwstring{"az\#1"}~\ocwkw{then}~$(\ocwlowerid{revw}~@~[~36;~2~])~$\ocwbc{} aan- az1 \ocwec{}\ocweol
\ocwindent{11.50em}
\ocwkw{else}~$([~\ocwlowerid{c2};~2~$\ocwbc{} aa \ocwec{}$])$\ocweol
\ocwindent{5.50em}
$\mid{}~[~17;~\ocwlowerid{\_}~]~\mid{}~[~26;~\ocwlowerid{\_}~]~\mid{}~[~43;~22~]~\mid{}~[~43;~49~]~$\ocweol
\ocwindent{7.50em}
$\rightarrow{}~(\ocwlowerid{revw}~@~[~36;~2~])$\ocweol
\ocwindent{7.50em}
\ocwbc{} aan- for \ocwbegindcode{}$\ocwlowerid{ak}.\ocwlowerid{s},~\ocwlowerid{a}$\~{}$\ocwlowerid{nc},~\ocwlowerid{a}$\~{}$\ocwlowerid{nj},~\ocwlowerid{arc}~(\ocwlowerid{en}~\ocwlowerid{fait}~.\ocwlowerid{rc}),~\ocwlowerid{arh}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~(\ocwlowerid{revw}~@~[~36;~1~]~$\ocwbc{} an- \ocwec{}$)$\ocweol
\ocwindent{5.50em}
$]~$\ocwkw{in}~$(\ocwlowerid{strong}~\ocwlowerid{w},~\ocwlowerid{w})$\ocweol
\ocwindent{4.50em}
$\mid{}~3~$\ocwbc{} i \ocwec{}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{wk}~=~[~4~$\ocwbc{} ii \ocwec{}~::~\ocwkw{if}~$\ocwlowerid{r}~=~[~47~]~$\ocwbc{} i.s \ocwec{}~\ocwkw{then}~$\ocwlowerid{r}~$\ocweol
\ocwindent{24.50em}
\ocwkw{else}~$[~42~$\ocwbc{} y \ocwec{}~::~$\ocwlowerid{r}~]~]$\ocweol
\ocwindent{12.00em}
\ocwkw{and}~$\ocwlowerid{st}~=~[~3;~42;~10~]~$\ocwbc{} iye \ocwec{}~@~$\ocwlowerid{r}~$\ocwkw{in}\ocweol
\ocwindent{12.00em}
$(\ocwlowerid{rev}~\ocwlowerid{st},~\ocwlowerid{rev}~\ocwlowerid{wk})$\ocweol
\ocwindent{4.50em}
$\mid{}~5~$\ocwbc{} u \ocwec{}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{wk}~=~[~6~$\ocwbc{} uu \ocwec{}~::~$\ocwlowerid{r}~]$\ocweol
\ocwindent{12.00em}
\ocwkw{and}~$\ocwlowerid{redup}~=~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{14.00em}
$[~$\ocwstring{"vaz"}~$\rightarrow{}~2~\mid{}~\ocwlowerid{\_}~\rightarrow{}~12~]~$\ocwkw{in}\ocweol
\ocwindent{12.00em}
\ocwkw{let}~$\ocwlowerid{st}~=~[~5;~45;~\ocwlowerid{redup}~]~$\ocwbc{} uvo/uvaa \ocwec{}~@~$\ocwlowerid{r}~$\ocwkw{in}\ocweol
\ocwindent{12.00em}
$(\ocwlowerid{rev}~\ocwlowerid{st},~\ocwlowerid{rev}~\ocwlowerid{wk})$\ocweol
\ocwindent{4.50em}
$\mid{}~7~$\ocwbc{} .r \ocwec{}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{w}~=~$\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}\ocweol
\ocwindent{10.00em}
$[~[~22~]~\mid{}~[~35~]~\mid{}~[~47~]~\rightarrow{}~$\ocwbc{} Whitney§788a \ocwec{}\ocweol
\ocwindent{10.50em}
$(\ocwlowerid{revw}~@~[~36;~2~])~$\ocwbc{} aan- for \ocwbegindcode{}.$\ocwlowerid{rc1}$\ocwenddcode{}, \ocwbegindcode{}.$\ocwlowerid{rdh}$\ocwenddcode{}, \ocwbegindcode{}.$\ocwlowerid{r}.\ocwlowerid{s}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{10.00em}
$\mid{}~[\,]~\rightarrow{}~[~43;~1~]~$\ocwbc{} ar for .r \ocwec{}\ocweol
\ocwindent{10.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{revw}$\ocweol
\ocwindent{10.00em}
$]~$\ocwkw{in}~$(\ocwlowerid{strong}~\ocwlowerid{w},~\ocwlowerid{w})$\medskip

\label{verbs.ml:113414}%
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{\_}~$\ocwbc{} aa ii uu \ocwec{}~$\rightarrow{}~(\ocwlowerid{revs},~\ocwlowerid{revw})$\ocweol
\ocwindent{4.50em}
$]~$\ocwkw{in}~$(\ocwlowerid{s},~\ocwlowerid{w},~\ocwupperid{None},~\ocwupperid{False},~\ocwupperid{False})$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$(\ocwlowerid{v},\ocwlowerid{p},\ocwlowerid{a})~=~\ocwlowerid{lookvoy}~\ocwlowerid{r}~$\ocwbc{} p = prosodically long, a = vriddhi augment \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwbc{} lookvoy computes the vowel v, and the two booleans p and a \ocwec{}\ocweol
\ocwindent{4.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{lookvoy}~=~$\ocwkw{fun}\ocweol
\ocwindent{5.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{error\_vowel}~1$\ocweol
\ocwindent{5.50em}
$\mid{}~[~\ocwlowerid{c2}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c2}~$\ocwkw{then}~$(\ocwlowerid{c2},\ocwupperid{False},\ocwupperid{True})$\ocweol
\ocwindent{11.50em}
\ocwkw{else}~$\ocwlowerid{error\_vowel}~2$\ocweol
\ocwindent{5.50em}
$\mid{}~[~\ocwlowerid{c2}~::~\ocwlowerid{r2}~]~\rightarrow{}~$\ocweol
\ocwindent{11.50em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c2}~$\ocwkw{then}~\ocweol
\ocwindent{13.00em}
\ocwkw{let}~$\ocwlowerid{l}~=~\ocwlowerid{length}~(\ocwlowerid{contract}~\ocwlowerid{r2})~$\ocwkw{in}\ocweol
\ocwindent{13.00em}
\ocwkw{let}~$\ocwlowerid{p}~=~\ocwlowerid{long\_vowel}~\ocwlowerid{c2}~\lor{}~\ocwlowerid{l}>1~$\ocweol
\ocwindent{13.00em}
\ocwkw{and}~$\ocwlowerid{a}~=~\ocwlowerid{c2}=1~$\ocwbc{} a \ocwec{}~$\land{}~\ocwlowerid{l}=1~$\ocwkw{in}~\ocweol
\ocwindent{13.00em}
$(\ocwlowerid{c2},\ocwlowerid{p},\ocwlowerid{a})$\ocweol
\ocwindent{11.50em}
\ocwkw{else}~$\ocwlowerid{lookvoy}~\ocwlowerid{r2}$\ocweol
\ocwindent{5.50em}
$]~$\ocwkw{in}~\ocwbc{} c is reduplicating consonant candidate \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{c}~=~$\ocwkw{if}~$\ocwlowerid{sibilant}~\ocwlowerid{c1}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}\ocweol
\ocwindent{8.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{error\_vowel}~3$\ocweol
\ocwindent{8.50em}
$\mid{}~[~\ocwlowerid{c2}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{stop}~\ocwlowerid{c2}~$\ocwkw{then}~$\ocwlowerid{c2}~$\ocwkw{else}~$\ocwlowerid{c1}$\ocweol
\ocwindent{10.50em}
\ocwbc{} =    if vowel c2 then c1
                        else if nasal c2 then c1
                        else if stop  c2 then c2
                        else \ocwbc{} semivowel c2 \ocwec{} c1 \ocwec{}\ocweol
\ocwindent{8.50em}
$]~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{c1}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{rv}~=~$\ocwbc{} rv is reduplicating vowel \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{v}>6~$\ocwbc{} .r .rr .l dipht \ocwec{}~\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~$\ocwstring{"ce.s.t"}~$\mid{}~$\ocwstring{"dev"}~$\mid{}$\ocwstring{"sev"}~$\mid{}~$\ocwstring{"mlecch"}~$\mid{}~$\ocwstring{"vye"}~\ocweol
\ocwindent{7.00em}
$\rightarrow{}~3~$\ocwbc{} i \ocwec{}~\ocwbc{} vye for vyaa \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~1~$\ocwbc{} a \ocwec{}~\ocwbc{} also bhuu elsewhere \ocwec{}\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~$\ocwstring{"maa\#3"}~$\rightarrow{}~3~$\ocwbc{} i \ocwec{}~\ocwbc{} analogy with present \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"vyath"}~$\mid{}~$\ocwstring{"vyadh"}~$\mid{}~$\ocwstring{"vyaa"}~$\mid{}~$\ocwstring{"jyaa\#1"}~$\mid{}~$\ocwstring{"pyaa"}~$\mid{}~$\ocwstring{"syand"}~$\mid{}~$\ocwstring{"dyut\#1"}\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"myak.s"}~$\rightarrow{}~3$\ocweol
\ocwindent{6.00em}
\ocwbc{} Whitney§785 also \ocwstring{"vyac"} and ved. \ocwstring{"tyaj\#1"}; \ocwstring{"vyaa"} treated other \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"kan"}~$\mid{}~$\ocwstring{"mah"}~$\rightarrow{}~2~$\ocwbc{} ved lengthened redup vow Whitney§786a \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{short}~\ocwlowerid{v}~$\ocwbc{} reduplicated vowel is short \ocwec{}\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{rc}~=~$\ocwbc{} reduplicating consonant \ocwec{}~\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~17~\mid{}~18~$\ocwbc{} k kh \ocwec{}~$\rightarrow{}~22~$\ocwbc{} c \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~19~\mid{}~20~\mid{}~49~$\ocwbc{} g gh h \ocwec{}~$\rightarrow{}~24~$\ocwbc{} j \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~23~\mid{}~25~\mid{}~28~\mid{}~30~\mid{}~33~\mid{}~35~\mid{}~38~\mid{}~40~\rightarrow{}~\ocwlowerid{c}-1~$\ocwbc{} xh -> x \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{c}~$\ocwbc{} by default c \ocwec{}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$(\ocwlowerid{affix},\ocwlowerid{sampra})~=~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}~\ocwbc{} ya -> ii va -> uu \ocwec{}\ocweol
\ocwindent{5.00em}
$[~$\ocwstring{"yaj\#1"}~$\rightarrow{}~([~3~$\ocwbc{} i \ocwec{}$],\ocwupperid{Some}~(\ocwlowerid{mrijify}~(\ocwlowerid{revcode}~$\ocwstring{"iij"}$)))$\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"vac"}~$\rightarrow{}~([~5~$\ocwbc{} u \ocwec{}$],\ocwupperid{Some}~(\ocwlowerid{revcode}~$\ocwstring{"uuc"}$))$\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"vad"}~$\rightarrow{}~([~5~$\ocwbc{} u \ocwec{}$],\ocwupperid{Some}~(\ocwlowerid{revcode}~$\ocwstring{"uud"}$))$\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"vap"}~$\mid{}~$\ocwstring{"vap\#1"}~$\mid{}~$\ocwstring{"vap\#2"}~$\rightarrow{}~([~5~$\ocwbc{} u \ocwec{}~$],\ocwupperid{Some}~(\ocwlowerid{revcode}~$\ocwstring{"uup"}$))$\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"vaz"}~$\rightarrow{}~([~5~$\ocwbc{} u \ocwec{}$],\ocwupperid{Some}~(\ocwlowerid{revcode}~$\ocwstring{"uuz"}$))$\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"vas\#1"}~$\mid{}~$\ocwstring{"vas\#4"}~$\rightarrow{}~([~5~$\ocwbc{} u \ocwec{}$],\ocwupperid{Some}~(\ocwlowerid{revcode}~$\ocwstring{"uus"}$))$\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"vah\#1"}~$\rightarrow{}~([~5~$\ocwbc{} u \ocwec{}$],\ocwupperid{Some}~(\ocwlowerid{revcode}~$\ocwstring{"uuh"}$))$\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"vaa\#3"}~$\rightarrow{}~([~5~$\ocwbc{} u \ocwec{}$],\ocwupperid{Some}~(\ocwlowerid{revcode}~$\ocwstring{"uuv"}$))$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~([~\ocwlowerid{rv};~\ocwlowerid{rc}~],\ocwupperid{None})$\ocweol
\ocwindent{5.00em}
$]~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{vriddhi}~=~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~$\ocwstring{"vyadh"}~$\mid{}~$\ocwstring{"svap"}~$\mid{}~$\ocwstring{"grah"}~$\rightarrow{}~\ocwupperid{True}~$\ocweol
\ocwindent{6.00em}
\ocwbc{} since special weak stem returned by stems \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{a}$\ocweol
\ocwindent{5.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{glue}~=~\ocwlowerid{revaffix}~\ocwlowerid{affix}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$(\ocwlowerid{weak},\ocwlowerid{eweak},\ocwlowerid{iopt})~=~$\ocwkw{match}~$\ocwlowerid{sampra}~$\ocwkw{with}~\ocwbc{} iopt = optional i \ocwec{}~\ocweol
\ocwindent{5.00em}
$[~\ocwupperid{Some}~\ocwlowerid{weak}~\rightarrow{}~(\ocwlowerid{weak},\ocwupperid{False},\ocwupperid{True})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{rc}=\ocwlowerid{c}~\lor{}~\ocwlowerid{root}=$\ocwstring{"bhaj"}~\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~1~::~\ocwlowerid{w}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{7.00em}
$[~$\ocwstring{"jan"}~$\rightarrow{}~(\ocwlowerid{glue}~(\ocwlowerid{revcode}~$\ocwstring{"j\~{}n"}$),\ocwupperid{True},\ocwupperid{True})$\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"val"}~$\mid{}~$\ocwstring{"mah"}~$\rightarrow{}~(\ocwlowerid{glue}~\ocwlowerid{revw},\ocwupperid{False},\ocwupperid{False})~$\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{w}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~[~\ocwlowerid{c'}~]~$\ocwkw{when}~$\ocwlowerid{consonant}~\ocwlowerid{c'}~\rightarrow{}~$\ocweol
\ocwindent{10.50em}
$(\ocwlowerid{revaffix}~[~10~$\ocwbc{} e \ocwec{};~$\ocwlowerid{c}~]~\ocwlowerid{w},\ocwupperid{True},\ocwupperid{True})$\ocweol
\ocwindent{10.50em}
\ocwbc{} roots of form c.a.c' with c,c' consonant or .m Scharf \ocwec{}\ocweol
\ocwindent{10.50em}
\ocwbc{} ZZ may lead to hiatus \ocwec{}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~(\ocwlowerid{glue}~\ocwlowerid{revw},\ocwupperid{False},\ocwupperid{False})$\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{7.00em}
$]~$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~(\ocwlowerid{glue}~\ocwlowerid{revw},\ocwupperid{False},\ocwupperid{False})$\ocweol
\ocwindent{6.00em}
$]~$\ocwkw{else}~\ocweol
\ocwindent{7.00em}
\ocwkw{let}~$(\ocwlowerid{short},\ocwlowerid{iopt})~=~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~$\ocwstring{"gam"}~$\rightarrow{}~(\ocwlowerid{revcode}~$\ocwstring{"gm"},$\ocwupperid{True})~$\ocwbc{} actually i forbidden \ocwec{}\ocweol
\ocwindent{8.00em}
$\mid{}~$\ocwstring{"ghas"}~$\rightarrow{}~(\ocwlowerid{revcode}~$\ocwstring{"k.s"},$\ocwupperid{False})$\ocweol
\ocwindent{8.00em}
$\mid{}~$\ocwstring{"han\#1"}~$\rightarrow{}~(\ocwlowerid{revcode}~$\ocwstring{"ghn"},$\ocwupperid{True})$\ocweol
\ocwindent{8.00em}
$\mid{}~$\ocwstring{"khan"}~$\rightarrow{}~(\ocwlowerid{revcode}~$\ocwstring{"khn"},$\ocwupperid{False})$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~(\ocwlowerid{revw},\ocwupperid{False})$\ocweol
\ocwindent{8.00em}
$]~$\ocwkw{in}~$(\ocwlowerid{glue}~\ocwlowerid{short},\ocwupperid{False},\ocwlowerid{iopt})~$\ocweol
\ocwindent{5.00em}
$]~$\ocweol
\ocwindent{3.50em}
\ocwkw{and}~$\ocwlowerid{strong}~=~\ocwlowerid{glue}~($\ocwkw{if}~$\ocwlowerid{p}~$\ocwkw{then}~$\ocwlowerid{revw}~$\ocwkw{else}~$\ocwlowerid{revs})~$\ocweol
\ocwindent{3.50em}
\ocwkw{and}~$\ocwlowerid{longifvr}~=~$\ocwkw{if}~$\ocwlowerid{vriddhi}~$\ocwkw{then}~$\ocwlowerid{revl}~$\ocwkw{else}~$\ocwlowerid{revs}~$\ocwkw{in}~\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{olong}~=~$\ocwkw{if}~$\ocwlowerid{p}~$\ocwkw{then}~$\ocwupperid{None}~$\ocwkw{else}~$\ocwupperid{Some}~(\ocwlowerid{glue}~\ocwlowerid{longifvr})~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
$(\ocwlowerid{strong},~\ocwlowerid{weak},~\ocwlowerid{olong},~\ocwlowerid{eweak},~\ocwlowerid{iopt})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfecta}~\ocwlowerid{conj}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{olengthened}~\ocwlowerid{eweak}~\ocwlowerid{iopt}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{fperfa}~\ocwlowerid{conj})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=~$\ocwkw{match}~$\ocwlowerid{olengthened}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~\ocwupperid{Some}~\ocwlowerid{lengthened}~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{conjugl}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{lengthened}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugl}~\ocwupperid{First}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~\ocwkw{let}~$\ocwlowerid{conjug}~=~$\ocwkw{if}~$\ocwlowerid{eweak}~$\ocwkw{then}~$\ocwlowerid{conjugw}~$\ocwkw{else}~$\ocwlowerid{conjugs}~$\ocwkw{in}\ocweol
\ocwindent{5.00em}
$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"itha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugl}~\ocwupperid{Third}~$\ocwstring{"a"}~\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"a"}~\ocwbc{} ex: aap -> aapa \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"itha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"a"}~\ocweol
\ocwindent{4.00em}
$]~@~$\ocwkw{if}~$\ocwlowerid{entry}=$\ocwstring{"az\#1"}~\ocwkw{then}~\ocweol
\ocwindent{5.00em}
\ocwkw{let}~$\ocwlowerid{optstrong}~=~\ocwlowerid{revcode}~$\ocwstring{"aana.mz"}~\ocwkw{in}\ocweol
\ocwindent{5.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{optstrong}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"a"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"itha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"a"}~\ocwbc{} actually also regular aaza Whitney§788a \ocwec{}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{else}~$[\,]~$\ocwbc{} Whitney§788a \ocwec{}\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{iopt}~$\ocwkw{then}~$[~\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"tha"}~::~$\ocwlowerid{l}~]~$\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"iva"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"athur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"atur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"ima"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{entry}=$\ocwstring{"raaj\#1"}~\ocwkw{then}~$(\ocwupperid{Third},~\ocwlowerid{code}~$\ocwstring{"rejur"}$)$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ur"}~\ocwbc{} Henry: paptur véd. pat1 \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])~$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{pstem}~=~$\ocwkw{if}~$\ocwlowerid{entry}=$\ocwstring{"raaj\#1"}~\ocwkw{then}~$(\ocwlowerid{revcode}~$\ocwstring{"rej"}$)~$\ocwkw{else}~$\ocwlowerid{weak}~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
$\ocwlowerid{record\_part}~(\ocwupperid{Ppfta\_}~\ocwlowerid{conj}~\ocwlowerid{pstem}~\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfectm}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{fperfm}~\ocwlowerid{conj})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"e"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"i.se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"e"}~\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"guh"}~\ocwkw{then}\ocweol
\ocwindent{8.00em}
\ocwkw{let}~$\ocwlowerid{juguhe}~=~\ocwlowerid{code}~$\ocwstring{"juguhe"}~\ocwkw{in}~\ocwbc{} Whitney§793i \ocwec{}\ocweol
\ocwindent{8.00em}
$\ocwlowerid{l}~@~[~(\ocwupperid{First},\ocwlowerid{juguhe});~(\ocwupperid{Third},\ocwlowerid{juguhe})~]$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{l})$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"ivahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"aathe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"aate"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"imahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"idhve"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ire"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part\_m\_ath}~(\ocwlowerid{vppftm}~\ocwlowerid{conj})~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocwbc{} -aana \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfect\_c}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{olengthened}~\ocwlowerid{eweak}~\ocwlowerid{iopt}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{voices\_of}~\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Para}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{compute\_perfecta}~\ocwupperid{Primary}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{olengthened}~\ocwlowerid{eweak}~\ocwlowerid{iopt}~\ocwlowerid{entry}$\ocweol
\ocwindent{3.00em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"cit\#1"}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{5.50em}
\{~$\ocwlowerid{compute\_perfectm}~\ocwupperid{Primary}~\ocwlowerid{weak}~\ocwlowerid{entry}$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{compute\_perfectm}~\ocwupperid{Primary}~(\ocwlowerid{revcode}~$\ocwstring{"cikitr"}$)~\ocwlowerid{entry}~$\ocwbc{} WR \ocwec{}\ocweol
\ocwindent{5.50em}
\}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"vac"}~$\rightarrow{}~\ocwlowerid{record\_part\_m\_ath}~\ocwlowerid{ppftm}~\ocwlowerid{weak}~\ocwlowerid{entry}~$\ocwbc{} anuucaana \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Atma}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{11.50em}
$[~$\ocwstring{"cak.s"}~$\mid{}~$\ocwstring{"ba.mh"}~$\rightarrow{}~\ocwlowerid{strong}$\ocweol
\ocwindent{11.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{weak}$\ocweol
\ocwindent{11.50em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{6.00em}
$\ocwlowerid{compute\_perfectm}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{compute\_perfecta}~\ocwupperid{Primary}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{olengthened}~\ocwlowerid{eweak}~\ocwlowerid{iopt}~\ocwlowerid{entry}$\ocweol
\ocwindent{6.00em}
;~\ocwkw{let}~$\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{12.50em}
$[~$\ocwstring{"kan"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"cak"}~\ocwbc{} kan -> kaa \ocwec{}\ocweol
\ocwindent{12.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{weak}$\ocweol
\ocwindent{12.50em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{7.00em}
$\ocwlowerid{compute\_perfectm}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{6.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfecta\_aa}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~\ocwlowerid{perfa}~$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"itha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"aatha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"au"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"iva"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"athur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"atur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"ima"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part}~(\ocwupperid{Ppfta\_}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfectm\_aa}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~\ocwlowerid{perfm}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"e"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"i.se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"e"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"ivahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"aathe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"aate"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"imahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"idhve"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ire"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part\_m\_ath}~\ocwlowerid{ppftm}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocwbc{} stem-aana \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwbc{} middle part rare - eg cakraa.na pecaana anuucaana zepaana \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfect\_aa}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{voices\_of}~\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Para}~\rightarrow{}~\ocwlowerid{compute\_perfecta\_aa}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Atma}~\rightarrow{}~\ocwlowerid{compute\_perfectm\_aa}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{compute\_perfecta\_aa}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{compute\_perfectm\_aa}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{6.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} dissymetric in i and u - problematic \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fix\_dup}~\ocwlowerid{weak}~\ocwlowerid{suff}~\ocwlowerid{mc}~=~$\ocwbc{} Gonda §18.I §6 \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{s}~=~\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{in}~\ocwkw{match}~$\ocwlowerid{s}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~5~$\ocwbc{} u \ocwec{}~::~$\ocwlowerid{l}~]~\mid{}~[~6~$\ocwbc{} uu \ocwec{}~::~$\ocwlowerid{l}~]~$\ocwbc{} eg stu \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{sf}~=~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$[~45~$\ocwbc{} v \ocwec{}~::~$\ocwlowerid{s}~]~$\ocwkw{else}~$\ocwlowerid{s}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{sandhi}~[~5~::~\ocwlowerid{l}~]~\ocwlowerid{sf}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~3~$\ocwbc{} i \ocwec{}~::~$\ocwlowerid{l}~]~\mid{}~[~4~$\ocwbc{} ii \ocwec{}~::~$\ocwlowerid{l}~]~$\ocwbc{} eg nii \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{sf}~=~[~42~$\ocwbc{} y \ocwec{}~::~\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{s}$\ocweol
\ocwindent{16.50em}
\ocwkw{else}~$[~3~$\ocwbc{} i \ocwec{}~::~$\ocwlowerid{s}~]~]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{isf}~=~$\ocwkw{if}~$\ocwlowerid{mc}~$\ocwbc{} multiconsonant roots eg krii \ocwec{}~\ocweol
\ocwindent{10.50em}
\ocwkw{then}~$[~3~$\ocwbc{} i \ocwec{}~::~$\ocwlowerid{sf}~]~$\ocweol
\ocwindent{9.00em}
\ocwkw{else}~$\ocwlowerid{sf}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{sandhi}~\ocwlowerid{l}~\ocwlowerid{isf}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{sandhi}~\ocwlowerid{weak}~\ocwlowerid{s}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{error\_suffix}~12$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{multi\_consonant}~\ocwlowerid{root}~=~$\ocwkw{match}~$\ocwlowerid{revcode}~\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{v}~::~\ocwlowerid{r}~]~\rightarrow{}~\ocwlowerid{vowel}~\ocwlowerid{v}~\land{}~\ocwlowerid{length}~\ocwlowerid{r}~>~1$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_empty}~15$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfecta\_v}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{lengthened}~=~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"i"}~\ocwkw{then}~$\ocwlowerid{revcode}~$\ocwstring{"iyai"}\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{lengthened}~\ocwlowerid{weak}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{iforb}~=~\ocwupperid{List.}\ocwlowerid{mem}~\ocwlowerid{entry}~$\ocwbc{} option intercalating i forbidden Whitney§797c \ocwec{}\ocweol
\ocwindent{7.50em}
$[~$\ocwstring{"k.r\#1"};~\ocwstring{"bh.r"};~\ocwstring{"v.r\#2"};~\ocwstring{"s.r"};~\ocwstring{"dru\#1"};~\ocwstring{"zru"};~\ocwstring{"stu"};~\ocwstring{"sru"}~$]$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{mc}~=~\ocwlowerid{multi\_consonant}~\ocwlowerid{entry}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_dup}~\ocwlowerid{weak}~\ocwlowerid{suff}~\ocwlowerid{mc})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugl}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{lengthened}~\ocwlowerid{suff})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~\ocwlowerid{perfa}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{let}~$\ocwlowerid{l}~=$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugl}~\ocwupperid{First}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"tha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugl}~\ocwupperid{Third}~$\ocwstring{"a"}~\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{iforb}~$\ocwkw{then}~$\ocwlowerid{l}~$\ocwkw{else}~$[~\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"itha"}~::~$\ocwlowerid{l}~])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"va"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"athur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"atur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"ma"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part}~(\ocwupperid{Ppfta\_}~\ocwupperid{Primary}~\ocwlowerid{weak}~\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfectar}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugl}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~(\ocwlowerid{lengthened}~\ocwlowerid{stem})~\ocwlowerid{suff})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{fperfa}~\ocwlowerid{conj})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugl}~\ocwupperid{First}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"itha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugl}~\ocwupperid{Third}~$\ocwstring{"a"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"iva"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"athur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"atur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"ima"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part}~(\ocwupperid{Ppfta\_}~\ocwlowerid{conj}~\ocwlowerid{stem}~\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfect\_ril}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} -.rr or multiconsonant -.r \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{voices\_of}~\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Para}~\rightarrow{}~\ocwlowerid{compute\_perfectar}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Atma}~\rightarrow{}~\ocwlowerid{compute\_perfectm}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{compute\_perfectar}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{9.00em}
;~$\ocwlowerid{compute\_perfectm}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{9.00em}
\}\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfectm\_v}~\ocwlowerid{weak}~\ocwlowerid{mc}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_dup}~\ocwlowerid{weak}~\ocwlowerid{suff}~\ocwlowerid{mc})~$\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~\ocwlowerid{perfm}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"e"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"se"}\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"m.r"}~\ocwkw{then}~$(\ocwupperid{Third},~\ocwlowerid{code}~$\ocwstring{"mamre"}$)$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"e"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"vahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"aathe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"aate"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"mahe"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"dhve"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ire"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part\_m\_ath}~\ocwlowerid{ppftm}~\ocwlowerid{weak}~\ocwlowerid{entry}~$\ocwbc{} weak-aana \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwbc{} middle part rare - eg cakraa.na pecaana anuucaana zepaana \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfect\_bhuu}~()~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~(\ocwlowerid{revcode}~$\ocwstring{"babhuu"}$)~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~$\ocwstring{"bhuu\#1"}~$(\ocwupperid{Conju}~\ocwlowerid{perfa}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"va"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"tha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"vitha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"va"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"viva"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"vathur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"vatur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"vima"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"va"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"vur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfect\_vid}~()~=~$\ocwbc{} perfect in the sense of present \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~(\ocwlowerid{revcode}~$\ocwstring{"vid"}$)~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~(\ocwlowerid{revcode}~$\ocwstring{"ved"}$)~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~$\ocwstring{"vid\#1"}~$(\ocwupperid{Conju}~\ocwlowerid{perfa}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"tha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"a"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"va"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"thur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"tur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"ma"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfect\_ah}~()~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~$\ocwstring{"ah"}~$(\ocwupperid{Conju}~\ocwlowerid{perfa}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~(\ocwupperid{Second},~\ocwlowerid{code}~$\ocwstring{"aattha"}$)$\ocweol
\ocwindent{4.00em}
;~$(\ocwupperid{Third},~\ocwlowerid{code}~$\ocwstring{"aaha"}$)~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~(\ocwupperid{Second},~\ocwlowerid{code}~$\ocwstring{"aahathur"}$)$\ocweol
\ocwindent{4.00em}
;~$(\ocwupperid{Third},~\ocwlowerid{code}~$\ocwstring{"aahatur"}$)$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~(\ocwupperid{Third},~\ocwlowerid{code}~$\ocwstring{"aahur"}$)$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfect\_vyaa}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwbc{} This code is consistent with Dhaaturuupaprapa~nca, except for
     middle 1st sg where it lists \ocwstring{"vivyaye"} rather than \ocwstring{"vivye"} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{weak}~=~\ocwlowerid{revcode}~$\ocwstring{"vivii"}~\ocwbc{} redup de vii Whitney§801c \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{strong}~=~\ocwlowerid{revcode}~$\ocwstring{"vivye"}~\ocwbc{} \Pan{6,1,46} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{long}~=~\ocwlowerid{revcode}~$\ocwstring{"vivyai"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_dup}~\ocwlowerid{weak}~\ocwlowerid{suff}~\ocwupperid{False})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugl}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{long}~\ocwlowerid{suff})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~\ocwlowerid{perfa}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugl}~\ocwupperid{First}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"itha"}~\ocwbc{} \Pan{7,2,66} \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugl}~\ocwupperid{Third}~$\ocwstring{"a"}~\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"va"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"athur"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"atur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"ma"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"a"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part}~(\ocwupperid{Ppfta\_}~\ocwupperid{Primary}~\ocwlowerid{weak}~\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_perfectm\_v}~\ocwlowerid{weak}~\ocwupperid{False}~\ocwlowerid{entry}~$\ocwbc{} mc=False! \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfect\_v}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{mc}~=~\ocwlowerid{multi\_consonant}~\ocwlowerid{entry}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{voices\_of}~\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Para}~\rightarrow{}~\ocwlowerid{compute\_perfecta\_v}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Atma}~\rightarrow{}~\ocwlowerid{compute\_perfectm\_v}~\ocwlowerid{weak}~\ocwlowerid{mc}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ubha}~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{compute\_perfecta\_v}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{compute\_perfectm\_v}~\ocwlowerid{weak}~\ocwlowerid{mc}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.50em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfect}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"bhuu\#1"}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{compute\_perfect\_bhuu}~()~$\ocwbc{} No middle forms Whitney§800d \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{record\_part}~(\ocwupperid{Ppfta\_}~\ocwupperid{Primary}~(\ocwlowerid{revcode}~$\ocwstring{"babhuu"}$)~\ocwlowerid{entry})$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{record\_part\_m\_ath}~\ocwlowerid{ppftm}~(\ocwlowerid{revcode}~$\ocwstring{"babhuuv"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vid\#1"}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{compute\_perfect\_vid}~()~$\ocwbc{} middle forms ? \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{record\_part}~(\ocwupperid{Ppfta\_}~\ocwupperid{Primary}~(\ocwlowerid{revcode}~$\ocwstring{"vid"}$)~\ocwlowerid{entry})$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"ah"}~$\rightarrow{}~\ocwlowerid{compute\_perfect\_ah}~()$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vyaa"}~$\rightarrow{}~\ocwlowerid{compute\_perfect\_vyaa}~$\ocwstring{"vyaa"}~\ocwbc{} does not fit standard aa scheme \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"i"}~$\rightarrow{}~$\ocwkw{let}~$(\ocwlowerid{strong},~\ocwlowerid{weak},\ocwlowerid{\_},\ocwlowerid{\_},\ocwlowerid{\_})~=~\ocwlowerid{redup\_perf}~\ocwlowerid{entry}~$\ocwkw{in}\ocweol
\ocwindent{6.50em}
$\ocwlowerid{compute\_perfect\_v}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{entry}~$\ocwbc{} semble inutile ? \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zvaa"}~$\rightarrow{}~$\ocwkw{let}~$(\ocwlowerid{strong},~\ocwlowerid{weak},\ocwlowerid{\_},\ocwlowerid{\_},\ocwlowerid{\_})~=~\ocwlowerid{redup\_perf}~$\ocwstring{"zuu"}~\ocwkw{in}~\ocwbc{} \Pan{6,1,30} \ocwec{}\ocweol
\ocwindent{6.50em}
$\ocwlowerid{compute\_perfect\_v}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{entry}~$\ocwbc{} Whitney 794b zizvaaya \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Whitney 794b also jyaa pyaa vyaa hvaa; we treat vyaa above, and hvaa is huu.
   Thus pyaa is covered by pii. jyaa1 as jii gives jijyau same WR \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"indh"}~$\rightarrow{}~\ocwlowerid{compute\_perfectm}~\ocwupperid{Primary}~(\ocwlowerid{revcode}~$\ocwstring{"iidh"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"mah"}~$\rightarrow{}~$\ocwkw{let}~$(\ocwlowerid{strong},~\ocwlowerid{weak},~\ocwlowerid{\_},~\ocwlowerid{\_},~\ocwlowerid{\_})~=~\ocwlowerid{redup\_perf}~\ocwlowerid{entry}~$\ocwkw{in}\ocweol
\ocwindent{7.50em}
$\ocwlowerid{compute\_perfectm}~\ocwupperid{Primary}~\ocwlowerid{strong}~\ocwlowerid{entry}~$\ocwbc{} ZZ Atma for Para root \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{let}~$(\ocwlowerid{strong},~\ocwlowerid{weak},~\ocwlowerid{olong},~\ocwlowerid{eweak},~\ocwlowerid{iopt})~=~\ocwlowerid{redup\_perf}~\ocwlowerid{entry}~$\ocwkw{in}~\ocweol
\ocwindent{5.50em}
\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}~\ocweol
\ocwindent{5.50em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{6.50em}
\ocwkw{if}~$\ocwlowerid{c}=2~$\ocwbc{} aa \ocwec{}~$\lor{}~(\ocwlowerid{c}>9~\land{}~\ocwlowerid{c}<14)~$\ocwbc{} e ai o au \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwkw{then}~$\ocwlowerid{compute\_perfect\_aa}~\ocwlowerid{rest}~\ocwlowerid{entry}~$\ocwbc{} shortened weak stem \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{c}>2~\land{}~\ocwlowerid{c}<7~$\ocwbc{} i ii u uu \ocwec{}\ocweol
\ocwindent{9.00em}
\ocwkw{then}~$\ocwlowerid{compute\_perfect\_v}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{entry}$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{c}=7~$\ocwbc{} .r \ocwec{}~$\land{}~\ocwlowerid{multi\_consonant}~\ocwlowerid{entry}~\lor{}~\ocwlowerid{c}=8~$\ocwbc{} .rr \ocwec{}~\ocweol
\ocwindent{9.00em}
\ocwkw{then}~$\ocwlowerid{compute\_perfect\_ril}~\ocwlowerid{strong}~\ocwlowerid{entry}$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{c}=7~$\ocwbc{} .r \ocwec{}~\ocwkw{then}~$\ocwlowerid{compute\_perfect\_v}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{entry}$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{compute\_perfect\_c}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{olong}~\ocwlowerid{eweak}~\ocwlowerid{iopt}~\ocwlowerid{entry}$\ocweol
\ocwindent{5.50em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_empty}~16$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perfect\_desida}~\ocwlowerid{st}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{entry}:$\ocwbt{string}\ocwenddcode{} is the root, \ocwbegindcode{}$\ocwlowerid{st}$\ocwenddcode{} is the desiderative (reverse word) stem. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} We create a fake root from \ocwbegindcode{}$\ocwlowerid{st}$\ocwenddcode{} to reuse \ocwbegindcode{}$\ocwlowerid{redup\_perf}$\ocwenddcode{} which uses a string.\ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{strong},~\ocwlowerid{weak},~\ocwlowerid{olong},~\ocwlowerid{eweak},~\ocwlowerid{iopt})~=~\ocwlowerid{redup\_perf}~(\ocwupperid{Canon.}\ocwlowerid{rdecode}~\ocwlowerid{st})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{compute\_perfecta}~\ocwupperid{Desiderative}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{olong}~\ocwlowerid{eweak}~\ocwlowerid{iopt}~\ocwlowerid{entry}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_perfect\_desidm}~\ocwlowerid{st}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{\_},~\ocwlowerid{weak},~\ocwlowerid{\_},~\ocwlowerid{\_},~\ocwlowerid{\_})~=~\ocwlowerid{redup\_perf}~(\ocwupperid{Canon.}\ocwlowerid{rdecode}~\ocwlowerid{st})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{compute\_perfectm}~\ocwupperid{Desiderative}~\ocwlowerid{weak}~\ocwlowerid{entry}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{}**********************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Periphrastic perfect \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}**********************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Construction of the periphrastic perfect, used for perfect of secondary 
conjugations, denominative verbs and a few roots. It builds a form in -aam
suffixed by a perfect form of the auxiliairies k.r bhuu et as \Pan{3,1,35-40} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{peri\_perf}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"iik.s"}~$\mid{}~$\ocwstring{"ii.d"}~$\mid{}~$\ocwstring{"iir"}~$\mid{}~$\ocwstring{"iih"}~$\mid{}~$\ocwstring{"uk.s"}~$\mid{}~$\ocwstring{"uc"}~$\mid{}~$\ocwstring{"ujjh"}~$\mid{}~$\ocwstring{"edh"}~\ocweol
\ocwindent{2.00em}
\ocwbc{} Macdonell§140a1 \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"ind"}~$\mid{}~$\ocwstring{"indh"}~$\mid{}~$\ocwstring{"inv"}~$\mid{}~$\ocwstring{"umbh"}~$\mid{}~$\ocwstring{"cakaas"}~$\rightarrow{}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"aas\#2"}~$\rightarrow{}~$\ocwstring{"aas"}~\ocwbc{} trim \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"u.s"}~$\rightarrow{}~$\ocwstring{"o.s"}~\ocwbc{} guna WR \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"jaag.r"}~$\rightarrow{}~$\ocwstring{"jaagar"}~\ocwbc{} Macdonell§140a2 \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"bh.r"}~$\rightarrow{}~$\ocwstring{"bibhar"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"nii\#1"}~$\rightarrow{}~$\ocwstring{"nay"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"vyaa"}~$\rightarrow{}~$\ocwstring{"vye"}~\ocwbc{} Whitney roots \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"huu"}~$\rightarrow{}~$\ocwstring{"hve"}~\ocwbc{} Macdonell§140a3 \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"hrii\#1"}~$\rightarrow{}~$\ocwstring{"jihre"}~\ocwbc{} Whitney roots \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Not\_attested}~$\ocwbc{} no known periphrastic perfect \ocwec{}\ocweol
\ocwindent{1.00em}
$]~$\ocwkw{in}~$\ocwlowerid{revcode}~\ocwlowerid{stem}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_perpft}~\ocwlowerid{c}~\ocwlowerid{abstem}~\ocwlowerid{root}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{root}~(\ocwupperid{Invar}~(\ocwlowerid{c},\ocwupperid{Perpft})~(\ocwlowerid{fix}~\ocwlowerid{abstem}~$\ocwstring{"aam"}$))$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Aorist system 
\ocweol
\ocwindent{0.00em}
augment True for aorist, False for injunctive 
\ocweol
\label{verbs.ml:132301}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sigma}~\ocwlowerid{augment}~\ocwlowerid{stem}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{sfx}~=~\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{ssfx}~=~$\ocwkw{match}~$\ocwlowerid{sfx}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[~32~$\ocwbc{} t \ocwec{}~::~$\ocwlowerid{\_}~]~$\ocweol
\ocwindent{2.00em}
$\mid{}~[~33~$\ocwbc{} th \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~\lor{}~\ocwlowerid{nasal}~\ocwlowerid{c}~\lor{}~\ocwlowerid{c}=43~$\ocwbc{} r \ocwec{}~\ocwkw{then}~$[~48~$\ocwbc{} s \ocwec{}~::~$\ocwlowerid{sfx}~]$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~$\ocwlowerid{sfx}~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{error\_empty}~17$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~[~48~$\ocwbc{} s \ocwec{}~::~$\ocwlowerid{sfx}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{error\_empty}~18$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{form}~=~\ocwlowerid{sandhi}~\ocwlowerid{stem}~\ocwlowerid{ssfx}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{augment}~$\ocwkw{then}~$\ocwlowerid{aug}~\ocwlowerid{form}~$\ocwkw{else}~$\ocwlowerid{form}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sigma\_paradigm}~\ocwlowerid{conjug}~=$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"iis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"iit"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"va"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"ma"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_ath\_s\_aorista}~\ocwlowerid{long}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{sigma}~\ocwupperid{True}~\ocwlowerid{long}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{aora}~4)~(\ocwlowerid{sigma\_paradigm}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_ath\_s\_injuncta}~\ocwlowerid{long}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{sigma}~\ocwupperid{False}~\ocwlowerid{long}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{inja}~4)~(\ocwlowerid{sigma\_paradigm}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_ath\_s\_aoristm}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{sigma}~\ocwupperid{True}~\ocwlowerid{stem}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugroot}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugdhvam}~\ocwlowerid{person}~=~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~[~1~$\ocwbc{} a \ocwec{}~::~$\ocwlowerid{\_}~]~\mid{}~[~2~$\ocwbc{} aa \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~$\ocwstring{"dhvam"}\ocweol
\ocwindent{5.00em}
$\mid{}~[~43~$\ocwbc{} r \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~$\ocwstring{".dhvam"}\ocweol
\ocwindent{5.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocwstring{".dhvam"}~\ocwkw{else}~\ocwstring{"dhvam"}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{error\_empty}~19$\ocweol
\ocwindent{5.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugc}~=~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"k.r\#1"}~\ocwkw{then}~$\ocwlowerid{conjugroot}~$\ocwkw{else}~$\ocwlowerid{conjug}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{aorm}~4)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugc}~\ocwupperid{Second}~$\ocwstring{"thaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugc}~\ocwupperid{Third}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"vahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"aathaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"aataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"mahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugdhvam}~\ocwupperid{Second}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ata"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_ath\_s\_injunctm}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{sigma}~\ocwupperid{False}~\ocwlowerid{stem}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugroot}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugdhvam}~\ocwlowerid{person}~=~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{suff}~=~$\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~[~1~$\ocwbc{} a \ocwec{}~::~$\ocwlowerid{\_}~]~\mid{}~[~2~$\ocwbc{} aa \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~$\ocwstring{"dhvam"}\ocweol
\ocwindent{5.00em}
$\mid{}~[~43~$\ocwbc{} r \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~$\ocwstring{".dhvam"}\ocweol
\ocwindent{5.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocwstring{".dhvam"}~\ocwkw{else}~\ocwstring{"dhvam"}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{error\_empty}~20$\ocweol
\ocwindent{5.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugc}~=~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"k.r\#1"}~\ocwkw{then}~$\ocwlowerid{conjugroot}~$\ocwkw{else}~$\ocwlowerid{conjug}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{injm}~4)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugc}~\ocwupperid{Second}~$\ocwstring{"thaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugc}~\ocwupperid{Third}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"vahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"aathaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"aataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"mahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugdhvam}~\ocwupperid{Second}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ata"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{isigma}~\ocwlowerid{augm}~\ocwlowerid{stem}~\ocwlowerid{suff}~\ocwlowerid{long\_i}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{sfx}~=~\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{sfx'}~=~$\ocwkw{match}~$\ocwlowerid{sfx}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~[~4~$\ocwbc{} ii \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{sfx}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{ivoy}~=~$\ocwkw{if}~$\ocwlowerid{long\_i}~$\ocwkw{then}~4~\ocwbc{} ii \ocwec{}~\ocwkw{else}~3~\ocwbc{} i \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{5.50em}
\ocwbc{} long i for root grah - Whitney§900b \ocwec{}\ocweol
\ocwindent{5.50em}
$\ocwupperid{Int\_sandhi.}\ocwlowerid{int\_sandhi}~[~47;~\ocwlowerid{ivoy}~]~$\ocwbc{} i.s \ocwec{}~$\ocwlowerid{sfx}$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{form}~=~\ocwlowerid{sandhi}~\ocwlowerid{stem}~\ocwlowerid{sfx'}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{augm}~$\ocwkw{then}~$\ocwlowerid{aug}~\ocwlowerid{form}~$\ocwkw{else}~$\ocwlowerid{form}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_ath\_is\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{long\_i}~=~(\ocwlowerid{entry}~=~$\ocwstring{"grah"}$)~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{isigma}~\ocwupperid{True}~\ocwlowerid{stem}~\ocwlowerid{suff}~\ocwlowerid{long\_i})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{aora}~5)~(\ocwlowerid{sigma\_paradigm}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_ath\_is\_injuncta}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{long\_i}~=~(\ocwlowerid{entry}~=~$\ocwstring{"grah"}$)~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{isigma}~\ocwupperid{False}~\ocwlowerid{stem}~\ocwlowerid{suff}~\ocwlowerid{long\_i})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{inja}~5)~(\ocwlowerid{sigma\_paradigm}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{isigma\_m\_paradigm}~\ocwlowerid{conjug}~\ocwlowerid{conjugdhvam}~=$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"thaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"vahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"aathaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"aataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"mahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugdhvam}~\ocwupperid{Second}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ata"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_ath\_is\_aoristm}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{long\_i}~=~(\ocwlowerid{entry}~=~$\ocwstring{"grah"}$)~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{isigma}~\ocwupperid{True}~\ocwlowerid{stem}~\ocwlowerid{suff}~\ocwlowerid{long\_i})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugdhvam}~\ocwlowerid{person}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{stem}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{where}~\ocwlowerid{suff}~=~($\ocwkw{if}~$\ocwlowerid{long\_i}~$\ocwkw{then}~\ocwstring{"ii"}~\ocwkw{else}~\ocwstring{"i"}$)~$\^{}~\ocwstring{"dhvam"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{aorm}~5)~(\ocwlowerid{isigma\_m\_paradigm}~\ocwlowerid{conjug}~\ocwlowerid{conjugdhvam}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_ath\_is\_injunctm}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{long\_i}~=~(\ocwlowerid{entry}~=~$\ocwstring{"grah"}$)~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{isigma}~\ocwupperid{False}~\ocwlowerid{stem}~\ocwlowerid{suff}~\ocwlowerid{long\_i})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugdhvam}~\ocwlowerid{person}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{where}~\ocwlowerid{suff}~=~($\ocwkw{if}~$\ocwlowerid{long\_i}~$\ocwkw{then}~\ocwstring{"ii"}~\ocwkw{else}~\ocwstring{"i"}$)~$\^{}~\ocwstring{"dhvam"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{injm}~5)~(\ocwlowerid{isigma\_m\_paradigm}~\ocwlowerid{conjug}~\ocwlowerid{conjugdhvam}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sisigma}~\ocwlowerid{augm}~\ocwlowerid{stem}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{sfx}~=~\ocwlowerid{code}~\ocwlowerid{suff}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{ssfx}~=~$\ocwkw{match}~$\ocwlowerid{sfx}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~[~4~::~\ocwlowerid{\_}~]~\rightarrow{}~[~48~$\ocwbc{} s \ocwec{}~::~$\ocwlowerid{sfx}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Int\_sandhi.}\ocwlowerid{int\_sandhi}~[~47;~3;~48~]~$\ocwbc{} si.s \ocwec{}~$\ocwlowerid{sfx}$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{form}~=~\ocwlowerid{sandhi}~\ocwlowerid{stem}~\ocwlowerid{ssfx}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{augm}~$\ocwkw{then}~$\ocwlowerid{aug}~\ocwlowerid{form}~$\ocwkw{else}~$\ocwlowerid{form}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_ath\_sis\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{sisigma}~\ocwupperid{True}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{aora}~6)~(\ocwlowerid{sigma\_paradigm}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_ath\_sis\_injuncta}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{sisigma}~\ocwupperid{False}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{inja}~6)~(\ocwlowerid{sigma\_paradigm}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sasigma}~\ocwlowerid{augm}~\ocwlowerid{stem}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{sfx}~=~\ocwlowerid{fix}~[~48~]~$\ocwbc{} s \ocwec{}~$\ocwlowerid{suff}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{form}~=~\ocwlowerid{sandhi}~\ocwlowerid{stem}~\ocwlowerid{sfx}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{augm}~$\ocwkw{then}~$\ocwlowerid{aug}~\ocwlowerid{form}~$\ocwkw{else}~$\ocwlowerid{form}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sa\_aorist\_a}~\ocwlowerid{conjug}~=$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"at"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aava"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"atam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aama"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"ata"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"an"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_ath\_sa\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{sasigma}~\ocwupperid{True}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{aora}~7)~(\ocwlowerid{sa\_aorist\_a}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_ath\_sa\_injuncta}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{sasigma}~\ocwupperid{False}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{inja}~7)~(\ocwlowerid{sa\_aorist\_a}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sa\_aorist\_m}~\ocwlowerid{conjug}~=$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"athaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"ata"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aavahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"aathaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"aataam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"aamahi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"adhvam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"anta"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_ath\_sa\_aoristm}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{sasigma}~\ocwupperid{True}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{aorm}~7)~(\ocwlowerid{sa\_aorist\_m}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_ath\_sa\_injunctm}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{sasigma}~\ocwupperid{False}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{injm}~7)~(\ocwlowerid{sa\_aorist\_m}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_root\_aorista}~\ocwlowerid{weak}~\ocwlowerid{strong}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{weak}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{strong}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{aora}~1)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"bhuu\#1"}~\ocwkw{then}~\ocwbc{} Whitney§830 \ocwec{}\ocweol
\ocwindent{4.00em}
$[~(\ocwupperid{First},~\ocwlowerid{code}~$\ocwstring{"abhuuvam"}$)~$\ocwbc{} RV abhuvam \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{else}~\ocwbc{} Whitney§831 \ocwec{}\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"s"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"va"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"ma"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~$(\ocwupperid{Third},~$\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~2~$\ocwbc{} aa \ocwec{}~::~$\ocwlowerid{r}~]~$\ocweol
\ocwindent{8.00em}
$\rightarrow{}~\ocwlowerid{fix\_augment}~\ocwlowerid{r}~$\ocwstring{"ur"}\ocweol
\ocwindent{6.00em}
$\mid{}~[~41;~1;~43;~17~]~$\ocwbc{} kram \ocwec{}~\ocwbc{} Whitney§833a \ocwec{}\ocweol
\ocwindent{8.00em}
$\rightarrow{}~\ocwlowerid{fix\_augment}~\ocwlowerid{weak}~$\ocwstring{"ur"}~\ocwbc{} also yam dabh n.rt mand \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~6;~40~]~$\ocwbc{} bhuu \ocwec{}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"abhuuvan"}\ocweol
\ocwindent{6.00em}
$\mid{}~[~41;~1;~19~]~$\ocwbc{} gam \ocwec{}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"agman"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{fix\_augment}~\ocwlowerid{weak}~$\ocwstring{"an"}\ocweol
\ocwindent{6.00em}
$])$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_root\_injuncta}~\ocwlowerid{weak}~\ocwlowerid{strong}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{weak}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{inja}~1)$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"bhuu\#1"}~\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$[~(\ocwupperid{First},~\ocwlowerid{code}~$\ocwstring{"bhuuvam"}$)~$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{else}~\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"s"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"va"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"ma"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~$(\ocwupperid{Third},~$\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~2~$\ocwbc{} aa \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~\ocwlowerid{fix}~\ocwlowerid{r}~$\ocwstring{"ur"}\ocweol
\ocwindent{6.00em}
$\mid{}~[~6;~40~]~$\ocwbc{} bhuu \ocwec{}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"bhuuvan"}\ocweol
\ocwindent{6.00em}
$\mid{}~[~41;~1;~19~]~$\ocwbc{} gam \ocwec{}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"gman"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{fix}~\ocwlowerid{weak}~$\ocwstring{"an"}\ocweol
\ocwindent{6.00em}
$])$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_root\_aoristm}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} rare \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{aorm}~1)~(\ocwlowerid{conjugs\_past\_m}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_root\_injunctm}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} rare \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{injm}~1)~(\ocwlowerid{conjugs\_past\_m}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_root\_aoristp}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} passive aorist Whitney§843 \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} TODO use Kümmel 1996 for Vedic plural 3rd forms \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conju3}~=~\ocwupperid{Conju}~\ocwlowerid{aorp1}~[~(\ocwupperid{Singular},[~\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"i"}~$])~]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~\ocwlowerid{conju3}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_root\_injunctp}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocwbc{} passive injunctive ? \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conju3}~=~\ocwupperid{Conju}~\ocwlowerid{injp1}~[~(\ocwupperid{Singular},[~\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"i"}~$])~]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~\ocwlowerid{conju3}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} identical to \ocwbegindcode{}$\ocwlowerid{compute\_thematic\_impfta}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_thematic\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{aora}~2)~(\ocwlowerid{thematic\_preterit\_a}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_thematic\_injuncta}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{inja}~2)~(\ocwlowerid{thematic\_preterit\_a}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} identical to \ocwbegindcode{}$\ocwlowerid{compute\_thematic\_impftm}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_thematic\_aoristm}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{aorm}~2)~(\ocwlowerid{thematic\_preterit\_m}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_thematic\_injunctm}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{injm}~2)~(\ocwlowerid{thematic\_preterit\_m}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} identical to \ocwbegindcode{}$\ocwlowerid{compute\_thematic\_impfta}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwbc{} de Saussure (Memoire sur le systeme primitif des voyelles dans les langues IE)
   says: reduplicated aorists represent imperfects of a verbal class. \ocwec{}~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_redup\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{aora}~3)~(\ocwlowerid{thematic\_preterit\_a}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{1.00em}
\ocwbc{} NB Macdonnel dixit -- Gonda says \ocwstring{"ur"} for Third Plural \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_redup\_injuncta}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{inja}~3)~(\ocwlowerid{thematic\_preterit\_a}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} identical to \ocwbegindcode{}$\ocwlowerid{compute\_thematic\_impftm}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_redup\_aoristm}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{aorm}~3)~(\ocwlowerid{thematic\_preterit\_m}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_redup\_injunctm}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{injm}~3)~(\ocwlowerid{thematic\_preterit\_m}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{amui}~=~$\ocwkw{fun}~\ocwbc{} root with a amui - used in \ocwbegindcode{}$\ocwlowerid{redup\_aor}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"kath"}~$\rightarrow{}~\ocwupperid{True}~$\ocwbc{} \Pan{7,4,93} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Reduplication for aorist/injunctive \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{redup\_aor}~\ocwlowerid{weak}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{mess}~=~$\ocwstring{"Redup\_aor\ocwvspace{}"}~\^{}~$\ocwlowerid{root}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{rev}~\ocwlowerid{weak}~$\ocwkw{with}~\ocwbc{} ugly double reversal \ocwec{}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{error\_empty}~21$\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{c1}~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c1}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{c1}~$\ocwkw{with}~\ocwbc{} very rare - Whitney§862 \ocwec{}\ocweol
\ocwindent{4.50em}
$[~1~$\ocwbc{} a \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~[~\ocwlowerid{c2}~]~\rightarrow{}~\ocwlowerid{weak}~@~[~\ocwlowerid{c2};~1~$\ocwbc{} a \ocwec{}$]~$\ocwbc{} am aorist aamamat \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~\ocwlowerid{mess}$\ocweol
\ocwindent{6.50em}
$]~$\ocweol
\ocwindent{4.50em}
$\mid{}~4~$\ocwbc{} ii \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~[~17;~47~]~$\ocwbc{} iik.s \ocwec{}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"iicik.s"}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~\ocwlowerid{mess}$\ocweol
\ocwindent{6.50em}
$]~$\ocweol
\ocwindent{4.50em}
$\mid{}~7~$\ocwbc{} .r \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~[~22~]~$\ocwbc{} .rc1 \ocwec{}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{".rcic"}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~\ocwlowerid{mess}$\ocweol
\ocwindent{6.50em}
$]~$\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~\ocwlowerid{mess}$\ocweol
\ocwindent{4.50em}
$]~$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$(\ocwlowerid{v},\ocwlowerid{heavy})~=~\ocwlowerid{lookvoy}~\ocwlowerid{r}~$\ocweol
\ocwindent{5.00em}
\ocwbc{} heavy syllable = long vowel, or 
                              short before two consonants (long by position) \ocwec{}\ocweol
\ocwindent{4.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{lookvoy}~=~$\ocwkw{fun}\ocweol
\ocwindent{5.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~\ocwlowerid{mess}$\ocweol
\ocwindent{5.50em}
$\mid{}~[~\ocwlowerid{c2}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c2}~$\ocwkw{then}~$(\ocwlowerid{c2},\lnot{}~(\ocwlowerid{short\_vowel}~\ocwlowerid{c2}))$\ocweol
\ocwindent{11.50em}
\ocwkw{else}~$\ocwlowerid{failwith}~\ocwlowerid{mess}$\ocweol
\ocwindent{5.50em}
$\mid{}~[~\ocwlowerid{c2}~::~\ocwlowerid{r2}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c2}~$\ocwkw{then}~\ocweol
\ocwindent{16.00em}
\ocwkw{let}~$\ocwlowerid{h}~=~$\ocwkw{if}~$\ocwlowerid{short\_vowel}~\ocwlowerid{c2}~$\ocwkw{then}~$\ocwlowerid{mult}~\ocwlowerid{r2}$\ocweol
\ocwindent{20.00em}
\ocwkw{else}~$\ocwupperid{True}~$\ocwkw{in}\ocweol
\ocwindent{16.00em}
$(\ocwlowerid{c2},\ocwlowerid{h})~$\ocweol
\ocwindent{14.50em}
\ocwkw{else}~$\ocwlowerid{lookvoy}~\ocwlowerid{r2}$\ocweol
\ocwindent{5.50em}
$]~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{c}~=~$\ocwkw{if}~$\ocwlowerid{sibilant}~\ocwlowerid{c1}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~\ocwlowerid{mess}$\ocweol
\ocwindent{5.50em}
$\mid{}~[~\ocwlowerid{c2}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c2}~$\ocwkw{then}~$\ocwlowerid{c1}$\ocweol
\ocwindent{14.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{nasal}~\ocwlowerid{c2}~$\ocwkw{then}~$\ocwlowerid{c1}$\ocweol
\ocwindent{14.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{stop}~\ocwlowerid{c2}~$\ocwkw{then}~$\ocwlowerid{c2}$\ocweol
\ocwindent{14.00em}
\ocwkw{else}~\ocwbc{} semivowel c2 \ocwec{}~$\ocwlowerid{c1}$\ocweol
\ocwindent{5.50em}
$]~$\ocwkw{else}~$\ocwlowerid{c1}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{rv}~=~$\ocwbc{} rv is reduplicating vowel \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{v}~=~5~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~$\ocwstring{"dru\#1"}~$\mid{}~$\ocwstring{"zru"}~$\mid{}~$\ocwstring{"stu"}~$\rightarrow{}~5~$\ocweol
\ocwindent{5.50em}
$\mid{}~$\ocwstring{"dyut\#1"}~$\rightarrow{}~3~$\ocwbc{} also \ocwstring{"zru"} azizravat (WR) \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~6~$\ocwbc{} u -> uu \ocwec{}\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{v}~=~6~$\ocwkw{then}~5~\ocwbc{} uu \R u \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~$\ocwstring{"klid"}~$\mid{}~$\ocwstring{"tvar"}~$\mid{}~$\ocwstring{"tvi.s\#1"}~$\mid{}~$\ocwstring{"zri"}~$\mid{}~$\ocwstring{"grah"}~$\mid{}~$\ocwstring{"vrazc"}~$\rightarrow{}~3~$\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"j\~{}naa\#1"}~$\mid{}~$\ocwstring{"sthaa\#1"}~\ocwbc{} hidden heavy since stem in i \ocwec{}~$\rightarrow{}~3~$\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"gaah"}~\ocwbc{} heavy exception \ocwec{}~$\rightarrow{}~4~$\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{heavy}~\lor{}~\ocwlowerid{amui}~\ocwlowerid{root}~$\ocwkw{then}~\ocweol
\ocwindent{11.50em}
\ocwkw{if}~$\ocwlowerid{v}=1~\lor{}~\ocwlowerid{v}=2~\lor{}~\ocwlowerid{v}=7~$\ocwkw{then}~1~\ocwbc{} Whitney§860 \ocwec{}~\ocweol
\ocwindent{11.50em}
\ocwkw{else}~3~\ocwbc{} short \R ii, long \R i \ocwec{}~\ocwbc{} \Pan{7,4,93} \ocwec{}\ocweol
\ocwindent{10.00em}
\ocwkw{else}~4~\ocweol
\ocwindent{6.50em}
$]~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{rc}~=~$\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}~\ocwbc{} c is reduplicating consonant \ocwec{}\ocweol
\ocwindent{4.00em}
$[~17~\mid{}~18~$\ocwbc{} k kh \ocwec{}~$\rightarrow{}~22~$\ocwbc{} c \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~19~\mid{}~20~\mid{}~49~$\ocwbc{} g gh h \ocwec{}~$\rightarrow{}~24~$\ocwbc{} j \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~23~\mid{}~25~\mid{}~28~\mid{}~30~\mid{}~33~\mid{}~35~\mid{}~38~\mid{}~40~\rightarrow{}~\ocwlowerid{c}-1~$\ocwbc{} xh \R x \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{c}$\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{strengthened}~=~$\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"ji"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"jay"}~\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{8.50em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}\ocweol
\ocwindent{14.00em}
$[~3~\mid{}~4~$\ocwbc{} i ii \ocwec{}~$\rightarrow{}~[~42~$\ocwbc{} y \ocwec{}~::~$\ocwlowerid{weak}~]$\ocweol
\ocwindent{14.00em}
$\mid{}~5~\mid{}~6~$\ocwbc{} u uu \ocwec{}~$\rightarrow{}~[~45~$\ocwbc{} v \ocwec{}~::~$\ocwlowerid{weak}~]$\ocweol
\ocwindent{6.00em}
\ocwbc{} or \ocwbegindcode{}~45~::~[~1~::~$\ocwlowerid{r}~]~$\ocwenddcode{} (stu) 'atu.s.tavam tu.s.t'avat RV (WR) \ocwec{}\ocweol
\ocwindent{14.00em}
$\mid{}~7~\mid{}~8~$\ocwbc{} .r .rr \ocwec{}~$\rightarrow{}~[~43~::~[~1~$\ocwbc{} ar \ocwec{}~::~$\ocwlowerid{r}~]~]$\ocweol
\ocwindent{14.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{weak}~$\ocwbc{} Whitney§866-868 \ocwec{}\ocweol
\ocwindent{14.00em}
$]~$\ocweol
\ocwindent{8.50em}
\ocwkw{else}~$\ocwlowerid{weak}$\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{error\_empty}~22$\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{revaffix}~[~\ocwlowerid{rv};~\ocwlowerid{rc}~]~\ocwlowerid{strengthened}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_aorist}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{weak},\ocwlowerid{strong},\ocwlowerid{long})~=~\ocwlowerid{stems}~\ocwlowerid{entry}~$\ocwkw{in}~\ocwkw{do}~\ocwbc{} 7 families \ocwec{}\ocweol
\ocwindent{1.00em}
\{~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} 1. root aorist - Panini sic-luk \ocwec{}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"k.r\#1"}~$\mid{}~$\ocwstring{"kram"}~$\mid{}~$\ocwstring{"gam"}~$\mid{}~$\ocwstring{"gaa\#1"}~$\mid{}~$\ocwstring{"jan"}~$\mid{}~$\ocwstring{"j\~{}naa\#1"}~$\mid{}~$\ocwstring{"daa\#1"}~$\mid{}~$\ocwstring{"daa\#2"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"dhaa\#1"}~$\mid{}~$\ocwstring{"dhaa\#2"}~$\mid{}~$\ocwstring{"paa\#1"}~$\mid{}~$\ocwstring{"bhuu\#1"}~$\mid{}~$\ocwstring{"muc\#1"}~$\mid{}~$\ocwstring{"zaa"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"saa\#1"}~$\mid{}~$\ocwstring{"sthaa\#1"}~$\mid{}~$\ocwstring{"has"}~$\mid{}~$\ocwstring{"haa\#1"}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{compute\_root\_aorista}~\ocwlowerid{weak}~\ocwlowerid{strong}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
;~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"k.r\#1"}~$\lor{}~\ocwlowerid{entry}~=~$\ocwstring{"gam"}~$\lor{}~\ocwlowerid{entry}~=~$\ocwstring{"jan"}~\ocweol
\ocwindent{5.50em}
\ocwkw{then}~$\ocwlowerid{compute\_root\_aoristm}~\ocwlowerid{weak}~\ocwlowerid{entry}~$\ocwbc{} rare \ocwec{}~\ocweol
\ocwindent{4.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"sthaa\#1"}~\ocwbc{} Whitney §834a. \ocwec{}\ocweol
\ocwindent{8.00em}
\ocwkw{then}~$\ocwlowerid{compute\_root\_aoristm}~(\ocwlowerid{revstem}~$\ocwstring{"sthi"}$)~\ocwlowerid{entry}~$\ocwbc{} asthita \ocwec{}~\ocweol
\ocwindent{5.50em}
\ocwkw{else}~$()$\ocweol
\ocwindent{3.00em}
;~\ocwkw{let}~$\ocwlowerid{stem}~=~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"muc\#1"}~\ocwkw{then}~$\ocwlowerid{strong}~$\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{long}~$\ocwkw{with}~\ocweol
\ocwindent{6.00em}
$[~[~2~$\ocwbc{} aa \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~[~42~$\ocwbc{} y \ocwec{}~::~$\ocwlowerid{long}~]$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{long}$\ocweol
\ocwindent{6.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
$\ocwlowerid{compute\_root\_aoristp}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocwbc{} passive \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwbc{} for root aorist participles, see Whitney§840 and Burrow p178 \ocwec{}\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"prii"}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{st}~=~\ocwlowerid{revcode}~$\ocwstring{"priiyaa"}~\ocwkw{in}~$\ocwlowerid{compute\_root\_aorista}~\ocwlowerid{st}~\ocwlowerid{st}~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"svid\#2"}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{st}~=~\ocwlowerid{revcode}~$\ocwstring{"svidyaa"}~\ocwkw{in}~$\ocwlowerid{compute\_root\_aorista}~\ocwlowerid{st}~\ocwlowerid{st}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"iik.s"}~$\mid{}~$\ocwstring{"m.r"}~$\rightarrow{}~\ocwlowerid{compute\_root\_aoristm}~\ocwlowerid{weak}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
\ocwbc{} Now other passive/impersonal aorist in -i \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vac"}~$\rightarrow{}~$\ocwkw{do}~\ocwbc{} passive aorist \ocwec{}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{compute\_root\_aoristp}~\ocwlowerid{long}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{compute\_root\_aoristp}~(\ocwlowerid{revcode}~$\ocwstring{"voc"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"d.rz\#1"}~$\mid{}~$\ocwstring{"dvi.s\#1"}~$\mid{}~$\ocwstring{"budh\#1"}~$\mid{}~$\ocwstring{"vid\#1"}$\mid{}~$\ocwstring{"s.rj\#1"}~\ocweol
\ocwindent{4.00em}
$\rightarrow{}~\ocwlowerid{compute\_root\_aoristp}~\ocwlowerid{strong}~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"rabh"}~$\rightarrow{}~\ocwlowerid{compute\_root\_aoristp}~(\ocwlowerid{revcode}~$\ocwstring{"rambh"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"jaag.r"}~$\mid{}~$\ocwstring{"t.rr"}~$\mid{}~$\ocwstring{"pac"}~$\mid{}~$\ocwstring{"zru"}~$\mid{}~$\ocwstring{"stu"}~$\mid{}~$\ocwstring{"hu"}\ocweol
\ocwindent{4.00em}
$\rightarrow{}~\ocwlowerid{compute\_root\_aoristp}~\ocwlowerid{long}~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.00em}
\ocwbc{} \ocwstring{"zru"} -> azraayi Whitney§844a typo ? (azraayi WR) \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()~$\ocwbc{} \ocwstring{"i"} -> iiyaat difficile \ocwec{}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} 2. thematic aorist af \ocwec{}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"aap"}~$\mid{}~$\ocwstring{"krudh"}~$\mid{}~$\ocwstring{"gam"}~$\mid{}~$\ocwstring{"g.rdh"}~$\mid{}~$\ocwstring{"ghas"}~$\mid{}~$\ocwstring{"das"}~$\mid{}~$\ocwstring{"dyut\#1"}~$\mid{}~$\ocwstring{"muc\#1"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"yuj\#1"}~$\mid{}~$\ocwstring{"ric"}~$\mid{}~$\ocwstring{"ruc\#1"}~$\mid{}~$\ocwstring{"rudh\#2"}~$\mid{}~$\ocwstring{"ruh"}~$\mid{}~$\ocwstring{"vid\#2"}~$\mid{}~$\ocwstring{"v.rt\#1"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zuc\#1"}~$\mid{}~$\ocwstring{"zudh"}~$\mid{}~$\ocwstring{"sic"}~$\mid{}~$\ocwstring{"stan"}~$\mid{}~$\ocwstring{"huu"}~\ocweol
\ocwindent{2.50em}
$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{compute\_thematic\_aorista}~\ocwlowerid{weak}~\ocwlowerid{entry}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{compute\_thematic\_aoristm}~\ocwlowerid{weak}~\ocwlowerid{entry}~$\ocwbc{} middle is very rare \ocwec{}\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vyaa"}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~$\ocwstring{"vi"}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{compute\_thematic\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{compute\_thematic\_aoristm}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zuu"}~$\mid{}~$\ocwstring{"zcut\#1"}~$\rightarrow{}~\ocwlowerid{compute\_thematic\_aorista}~\ocwlowerid{weak}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zru"}~$\rightarrow{}~\ocwlowerid{compute\_thematic\_aorista}~(\ocwlowerid{revcode}~$\ocwstring{"zrav"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"khyaa"}~$\rightarrow{}~\ocwlowerid{compute\_thematic\_aorista}~(\ocwlowerid{revcode}~$\ocwstring{"khya"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"as\#2"}~$\rightarrow{}~\ocwlowerid{compute\_thematic\_aorista}~(\ocwlowerid{revcode}~$\ocwstring{"asth"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"pat\#1"}~$\rightarrow{}~\ocwlowerid{compute\_thematic\_aorista}~(\ocwlowerid{revcode}~$\ocwstring{"papt"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vac"}~$\rightarrow{}~\ocwlowerid{compute\_thematic\_aorista}~(\ocwlowerid{revcode}~$\ocwstring{"voc"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwbc{} roots in .r or .rr take strong stem \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwstring{".r"}~$\mid{}~$\ocwstring{"d.rz\#1"}~$\rightarrow{}~\ocwlowerid{compute\_thematic\_aorista}~\ocwlowerid{strong}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()~$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} 3. reduplicated aorist caf \ocwec{}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"am"}~$\mid{}~$\ocwstring{".rc\#1"}~$\mid{}~$\ocwstring{"kath"}~$\mid{}~$\ocwstring{"k.r.s"}~$\mid{}~$\ocwstring{"ga.n"}~$\mid{}~$\ocwstring{"gam"}~$\mid{}~$\ocwstring{"gaah"}~$\mid{}~$\ocwstring{"car"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"ce.s.t"}~$\mid{}~$\ocwstring{"jan"}~$\mid{}~$\ocwstring{"ji"}~$\mid{}~$\ocwstring{"tvar"}~$\mid{}~$\ocwstring{"tvi.s\#1"}~$\mid{}~$\ocwstring{"dah\#1"}~$\mid{}~$\ocwstring{"diz\#1"}~$\mid{}~$\ocwstring{"dih"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"diip"}~$\mid{}~$\ocwstring{"dru\#1"}~$\mid{}~$\ocwstring{"dh.r"}~$\mid{}~$\ocwstring{"naz"}~$\mid{}~$\ocwstring{"pac"}~$\mid{}~$\ocwstring{"pa.th"}~$\mid{}~$\ocwstring{"miil"}~$\mid{}~$\ocwstring{"muc\#1"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"yaj\#1"}~$\mid{}~$\ocwstring{"rak.s"}~$\mid{}~$\ocwstring{"ric"}~$\mid{}~$\ocwstring{"viz\#1"}~$\mid{}~$\ocwstring{"v.r\#1"}~$\mid{}~$\ocwstring{"v.rt\#1"}~$\mid{}~$\ocwstring{"vyadh"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zri"}~$\mid{}~$\ocwstring{"zru"}~$\mid{}~$\ocwstring{"stu"}~\ocwbc{} | \ocwstring{"dhaa\#1"} \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{redup\_aor}~\ocwlowerid{weak}~\ocwlowerid{entry}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{compute\_redup\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocwbc{} but atu.s.tavam RV (WR) \ocwec{}~\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{compute\_redup\_aoristm}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"iik.s"}~$\mid{}~$\ocwstring{"klid"}~$\mid{}~$\ocwstring{"gup"}~$\mid{}~$\ocwstring{"cur"}~$\mid{}~$\ocwstring{"m.r"}~$\mid{}~$\ocwstring{"d.rz\#1"}~$\mid{}~$\ocwstring{"dyut\#1"}~$\mid{}~$\ocwstring{"vrazc"}~\ocweol
\ocwindent{3.00em}
$\rightarrow{}~$\ocwbc{} active only \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{redup\_aor}~\ocwlowerid{weak}~\ocwlowerid{entry}~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
$\ocwlowerid{compute\_redup\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"grah"}~$\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{3.00em}
\{~\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{redup\_aor}~(\ocwlowerid{revcode}~$\ocwstring{"grah"}$)~\ocwlowerid{entry}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{compute\_redup\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{compute\_redup\_aoristm}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{3.00em}
;~\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{redup\_aor}~(\ocwlowerid{revcode}~$\ocwstring{"grabh"}$)~\ocwlowerid{entry}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\ocwbc{} ved -- Whitney§223g \ocwec{}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{compute\_redup\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{compute\_redup\_aoristm}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"daa\#1"}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{stem}~=~(\ocwlowerid{revcode}~$\ocwstring{"diidad"}$)~$\ocwbc{} ad hoc \ocwec{}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{compute\_redup\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{compute\_redup\_aoristm}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{3.00em}
\ocwbc{} then exceptions to treatment of aa with intercalaring ii \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"raadh"}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{redup\_aor}~(\ocwlowerid{revcode}~$\ocwstring{"radh"}$)~\ocwlowerid{entry}~$\ocwkw{in}~\ocwbc{} riiradh \ocwec{}~\ocweol
\ocwindent{8.50em}
$\ocwlowerid{compute\_redup\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocwbc{} Macdonnel p 126 \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"haa\#1"}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~$\ocwstring{"jiijah"}~\ocwkw{in}~\ocweol
\ocwindent{8.50em}
$\ocwlowerid{compute\_redup\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()~$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} reduplicated aorist - extra forms, secondary conjs \ocwec{}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"naz"}~$\rightarrow{}~\ocwlowerid{compute\_redup\_aorista}~(\ocwlowerid{revcode}~$\ocwstring{"nez"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()~$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} 4. sigma aorist sic \ocwec{}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"aap"}~$\mid{}~$\ocwstring{"k.r\#1"}~$\mid{}~$\ocwstring{"gup"}~$\mid{}~$\ocwstring{"chid\#1"}~$\mid{}~$\ocwstring{"ji"}~$\mid{}~$\ocwstring{"tud"}~$\mid{}~$\ocwstring{"t.rr"}~$\mid{}~$\ocwstring{"dah\#1"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"daa\#1"}~$\mid{}~$\ocwstring{"d.rz\#1"}~$\mid{}~$\ocwstring{"draa\#2"}~$\mid{}~$\ocwstring{"dhyaa"}~$\mid{}~$\ocwstring{"dhyai"}~$\mid{}~$\ocwstring{"dhv.r"}~$\mid{}~$\ocwstring{"nak.s"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"nii\#1"}~$\mid{}~$\ocwstring{"pac"}~$\mid{}~$\ocwstring{"praz"}~$\mid{}~$\ocwstring{"prii"}~$\mid{}~$\ocwstring{"budh\#1"}~$\mid{}~$\ocwstring{"bhaa\#1"}~$\mid{}~$\ocwstring{"bhii\#1"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"muc\#1"}~$\mid{}~$\ocwstring{"yaj\#1"}~$\mid{}~$\ocwstring{"yuj\#1"}~$\mid{}~$\ocwstring{"ram"}~$\mid{}~$\ocwstring{"labh"}~$\mid{}~$\ocwstring{"v.r\#2"}~$\mid{}~$\ocwstring{"vyadh"}~$\mid{}~$\ocwstring{"zru"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"s.rj\#1"}~$\mid{}~$\ocwstring{"stu"}~$\mid{}~$\ocwstring{"sp.rz\#1"}~$\mid{}~$\ocwstring{"hu"}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~\ocwkw{let}~$\ocwlowerid{stema}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~$\ocwstring{"d.rz\#1"}~$\mid{}~$\ocwstring{"s.rj\#1"}~$\mid{}~$\ocwstring{"sp.rz\#1"}~$\rightarrow{}~\ocwlowerid{long\_metathesis}~\ocwlowerid{weak}$\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"ram"}~$\rightarrow{}~\ocwlowerid{weak}~$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{long}$\ocweol
\ocwindent{6.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{compute\_ath\_s\_aorista}~\ocwlowerid{stema}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
;~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"yuj\#1"}~$\lor{}~\ocwlowerid{entry}~=~$\ocwstring{"chid\#1"}~\ocweol
\ocwindent{5.50em}
\ocwkw{then}~$\ocwlowerid{compute\_ath\_s\_aorista}~\ocwlowerid{strong}~\ocwlowerid{entry}~$\ocwkw{else}~$()$\ocweol
\ocwindent{4.00em}
\ocwbc{} ayok.siit and acchetsiit besides ayauk.siit and acchaitsiit \ocwec{}\ocweol
\ocwindent{3.00em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"gup"}~$\rightarrow{}~()~$\ocwbc{} active only \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{stemm}~=~$\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}~\ocweol
\ocwindent{8.00em}
$[~3~\mid{}~4~\mid{}~5~\mid{}~6~$\ocwbc{} i ii u uu \ocwec{}~$\rightarrow{}~\ocwlowerid{strong}$\ocweol
\ocwindent{8.00em}
$\mid{}~2~$\ocwbc{} aa \ocwec{}~$\rightarrow{}~[~3~::~\ocwlowerid{r}~]$\ocweol
\ocwindent{8.00em}
$\mid{}~7~$\ocwbc{} .r \ocwec{}~$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"dhv.r"}~\ocwkw{then}~$\ocwlowerid{revcode}~$\ocwstring{"dhuur"}~\ocwkw{else}~$\ocwlowerid{weak}$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{weak}$\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{error\_empty}~23$\ocweol
\ocwindent{6.00em}
$]~$\ocwkw{in}~$\ocwlowerid{compute\_ath\_s\_aoristm}~\ocwlowerid{stemm}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vrazc"}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~$\ocwstring{"vraak"}~\ocwkw{in}~\ocwbc{} as for future \ocwec{}~\ocweol
\ocwindent{8.50em}
$\ocwlowerid{compute\_ath\_s\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"spaz\#1"}~$\mid{}~$\ocwstring{"haa\#2"}~$\rightarrow{}~\ocwlowerid{compute\_ath\_s\_aoristm}~\ocwlowerid{weak}~\ocwlowerid{entry}~$\ocwbc{} middle only \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} 5. i.s aorist se.t-sic \ocwec{}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"ak.s"}~$\mid{}~$\ocwstring{"aj"}~$\mid{}~$\ocwstring{"aas\#2"}~$\mid{}~$\ocwstring{"i.s\#1"}~$\mid{}~$\ocwstring{"iik.s"}~$\mid{}~$\ocwstring{"uk.s"}~$\mid{}~$\ocwstring{"uc"}~$\mid{}~$\ocwstring{"u.s"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"uuh"}~$\mid{}~$\ocwstring{".rc\#1"}~$\mid{}~$\ocwstring{"k.rt\#1"}~$\mid{}~$\ocwstring{"krand"}~$\mid{}~$\ocwstring{"kram"}~$\mid{}~$\ocwstring{"khan"}~$\mid{}~$\ocwstring{"car"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"ce.s.t"}~$\mid{}~$\ocwstring{"jalp"}~$\mid{}~$\ocwstring{"jaag.r"}~$\mid{}~$\ocwstring{"t.rr"}~$\mid{}~$\ocwstring{"pa.th"}~$\mid{}~$\ocwstring{"puu\#1"}~$\mid{}~$\ocwstring{"p.rc"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"baadh"}~$\mid{}~$\ocwstring{"budh\#1"}~$\mid{}~$\ocwstring{"mad\#1"}~$\mid{}~$\ocwstring{"mud\#1"}~$\mid{}~$\ocwstring{"muurch"}~$\mid{}~$\ocwstring{"mlecch"}~$\mid{}~$\ocwstring{"yaac"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"ruc\#1"}~$\mid{}~$\ocwstring{"lu\~{}nc"}~$\mid{}~$\ocwstring{"luu\#1"}~$\mid{}~$\ocwstring{"vad"}~$\mid{}~$\ocwstring{"vadh"}~$\mid{}~$\ocwstring{"vid\#1"}~$\mid{}~$\ocwstring{"v.r\#1"}~$\mid{}~$\ocwstring{"vraj"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"z.rr"}~$\mid{}~$\ocwstring{"sidh\#2"}~$\mid{}~$\ocwstring{"skhal"}~$\mid{}~$\ocwstring{"stan"}~$\mid{}~$\ocwstring{"stu"}~$\mid{}~$\ocwstring{"hi.ms"}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~\ocwkw{let}~$\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~7~$\ocwbc{} .r \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~$\ocweol
\ocwindent{7.00em}
\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"jaag.r"}~\ocwkw{then}~$\ocwlowerid{strong}~$\ocwbc{} jaagari.sam RF IC 2 p 88 \ocwec{}\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{long}~$\ocwbc{} avaariit \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~8~$\ocwbc{} .rr \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~$\ocweol
\ocwindent{7.00em}
\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"z.rr"}~\ocwkw{then}~$\ocwlowerid{strong}~$\ocwbc{} azariit \ocwec{}\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{long}~$\ocweol
\ocwindent{6.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocweol
\ocwindent{7.00em}
\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$\ocwlowerid{long}~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{9.50em}
$[~$\ocwstring{"kan"}~$\mid{}~$\ocwstring{"khan"}~$\mid{}$\ocwstring{"car"}~$\mid{}~$\ocwstring{"mad\#1"}~$\mid{}~$\ocwstring{"vad"}~$\mid{}~$\ocwstring{"skhal"}~$\rightarrow{}~\ocwlowerid{long}~$\ocweol
\ocwindent{9.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{strong}$\ocweol
\ocwindent{9.50em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_empty}~24$\ocweol
\ocwindent{6.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{compute\_ath\_is\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{compute\_ath\_is\_aoristm}~\ocwlowerid{strong}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
\}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"gup"}~$\mid{}~$\ocwstring{"vrazc"}~$\mid{}~$\ocwstring{"zcut\#1"}~$\mid{}~$\ocwstring{"sphu.t"}~$\rightarrow{}~$\ocwbc{} active only \ocwec{}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{compute\_ath\_is\_aorista}~\ocwlowerid{strong}~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zuu"}~$\rightarrow{}~$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{compute\_ath\_is\_aorista}~(\ocwlowerid{revcode}~$\ocwstring{"zve"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"kan"}~$\mid{}~$\ocwstring{"k.r\#2"}$\mid{}~$\ocwstring{"p.rr"}~$\rightarrow{}~$\ocwbc{} active only \ocwec{}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{compute\_ath\_is\_aorista}~\ocwlowerid{long}~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"jan"}~$\mid{}~$\ocwstring{"zii\#1"}~$\mid{}~$\ocwstring{"spand"}~$\rightarrow{}~$\ocwbc{} middle only \ocwec{}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{compute\_ath\_is\_aoristm}~\ocwlowerid{strong}~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"grah"}~$\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{3.00em}
\{~\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~$\ocwstring{"grah"}~\ocwkw{in}~\ocwkw{do}~\ocwbc{} same as group above \ocwec{}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{compute\_ath\_is\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{compute\_ath\_is\_aoristm}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.00em}
\}~\ocweol
\ocwindent{3.00em}
;~\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~$\ocwstring{"grabh"}~\ocwkw{in}~\ocwkw{do}~\ocwbc{} supplement (ved) -- Whitney§900b \ocwec{}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{compute\_ath\_is\_aorista}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{compute\_ath\_is\_aoristm}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.00em}
\}~\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} 6. si.s aorist se.t-sic \ocwec{}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"j\~{}naa\#1"}~$\mid{}~$\ocwstring{"dhyaa"}~$\mid{}~$\ocwstring{"dhyai"}~$\mid{}~$\ocwstring{"nam"}~$\mid{}~$\ocwstring{"paa\#2"}~$\mid{}~$\ocwstring{"mnaa"}~$\mid{}~$\ocwstring{"yaa\#1"}~$\mid{}~$\ocwstring{"laa"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zaa"}~$\rightarrow{}~$\ocwkw{do}~\ocwbc{} dhyai for dhyaa \ocwec{}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{compute\_ath\_sis\_aorista}~\ocwlowerid{strong}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{compute\_ath\_is\_aoristm}~\ocwlowerid{strong}~\ocwlowerid{entry}~$\ocwbc{} is aorist (5) used in middle \ocwec{}\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} 7. sa aorist ksa \ocwec{}\ocweol
\ocwindent{3.00em}
$[~$\ocwstring{"guh"}~$\mid{}~$\ocwstring{"diz\#1"}~$\mid{}~$\ocwstring{"dih"}~$\mid{}~$\ocwstring{"duh\#1"}~$\mid{}~$\ocwstring{"lih\#1"}~$\mid{}~$\ocwstring{"viz\#1"}~$\mid{}~$\ocwstring{"v.rj"}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.00em}
\ocwbc{} \Pan{7,3,72-73} \ocwec{}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{compute\_ath\_sa\_aorista}~\ocwlowerid{weak}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{compute\_ath\_sa\_aoristm}~\ocwlowerid{weak}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"pac"}~$\rightarrow{}~$\ocwkw{do}~\ocwbc{} Kiparsky apaak.sam \ocwec{}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{compute\_ath\_sa\_aorista}~\ocwlowerid{long}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{compute\_ath\_sa\_aoristm}~\ocwlowerid{long}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} First approximation: we compute same forms as corresponding aorists. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Then restriction to attested usage \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_injunctive}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{weak},\ocwlowerid{strong},\ocwlowerid{long})~=~\ocwlowerid{stems}~\ocwlowerid{entry}~$\ocwkw{in}~\ocwkw{do}~\ocwbc{} 7 families \ocwec{}\ocweol
\ocwindent{1.00em}
\{~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} 1. root injunct \ocwec{}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"gam"}~$\mid{}~$\ocwstring{"gaa\#1"}~$\mid{}~$\ocwstring{"bhuu\#1"}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{compute\_root\_injuncta}~\ocwlowerid{weak}~\ocwlowerid{strong}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
;~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"gam"}~\ocwkw{then}~$\ocwlowerid{compute\_root\_injunctm}~\ocwlowerid{weak}~\ocwlowerid{entry}~$\ocwbc{} rare \ocwec{}~\ocwkw{else}~$()$\ocweol
\ocwindent{3.00em}
;~\ocwkw{let}~$\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{long}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~2~$\ocwbc{} aa \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~[~42~$\ocwbc{} y \ocwec{}~::~$\ocwlowerid{long}~]$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{long}$\ocweol
\ocwindent{6.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
$\ocwlowerid{compute\_root\_injunctp}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocwbc{} passive \ocwec{}\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"k.r\#1"}~$\rightarrow{}~\ocwlowerid{compute\_root\_injunctm}~\ocwlowerid{weak}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()~$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} 2. thematic injunct \ocwec{}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"gam"}~$\mid{}~$\ocwstring{"g.rdh"}~$\mid{}~$\ocwstring{"zuc\#1"}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{compute\_thematic\_injuncta}~\ocwlowerid{weak}~\ocwlowerid{entry}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{compute\_thematic\_injunctm}~\ocwlowerid{weak}~\ocwlowerid{entry}~$\ocwbc{} middle is very rare \ocwec{}\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vac"}~$\rightarrow{}~\ocwlowerid{compute\_thematic\_injuncta}~(\ocwlowerid{revcode}~$\ocwstring{"voc"}$)~\ocwlowerid{entry}~$\ocwbc{} vocat \ocwec{}\medskip

\label{verbs.ml:157334}%
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()~$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} 3. reduplicated injunct \ocwec{}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"gam"}~$\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{redup\_aor}~\ocwlowerid{weak}~\ocwlowerid{entry}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{compute\_redup\_injuncta}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{compute\_redup\_injunctm}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()~$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} 4. sigma injunct \ocwec{}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"k.r\#1"}~$\mid{}~$\ocwstring{"chid\#1"}~$\mid{}~$\ocwstring{"pac"}~$\mid{}~$\ocwstring{"bhii\#1"}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~\ocwkw{let}~$\ocwlowerid{stema}~=~\ocwlowerid{long}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{compute\_ath\_s\_injuncta}~\ocwlowerid{stema}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
;~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"chid\#1"}~\ocwkw{then}~$\ocwlowerid{compute\_ath\_s\_injuncta}~\ocwlowerid{strong}~\ocwlowerid{entry}~$\ocwkw{else}~$()$\ocweol
\ocwindent{4.00em}
\ocwbc{} cchetsiit besides cchaitsiit \ocwec{}\ocweol
\ocwindent{3.00em}
;~\ocwkw{let}~$\ocwlowerid{stemm}~=~$\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}~\ocweol
\ocwindent{7.50em}
$[~3~\mid{}~4~\mid{}~5~\mid{}~6~$\ocwbc{} i ii u uu \ocwec{}~$\rightarrow{}~\ocwlowerid{strong}$\ocweol
\ocwindent{7.50em}
$\mid{}~2~$\ocwbc{} aa \ocwec{}~$\rightarrow{}~[~3~::~\ocwlowerid{r}~]~$\ocwbc{} turn aa to i \ocwec{}\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{weak}$\ocweol
\ocwindent{7.50em}
$]$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{error\_empty}~25$\ocweol
\ocwindent{6.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{compute\_ath\_s\_injunctm}~\ocwlowerid{stemm}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Aorist of causative \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_redup\_aorista\_ca}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{caaora}~3)~(\ocwlowerid{thematic\_preterit\_a}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{1.00em}
\ocwbc{} NB Macdonnel dixit -- Gonda says \ocwstring{"ur"} for Third Plural \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_redup\_aoristm\_ca}~\ocwlowerid{stem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{caaorm}~3)~(\ocwlowerid{thematic\_preterit\_m}~\ocwlowerid{conjug}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_aor\_ca}~\ocwlowerid{cpstem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~$\ocwbc{} Whitney§861b \ocwec{}~\ocwstring{"j\~{}naa\#1"}~$\mid{}~$\ocwstring{"daa\#1"}~$\mid{}~$\ocwstring{"sthaa\#1"}~\ocweol
\ocwindent{2.00em}
\ocwbc{} Henry§339: \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"diip"}~\ocwbc{} adidiipat \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"du.s"}~\ocwbc{} aduudu.sat \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"ri.s"}~\ocwbc{} ariiri.sat \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"p.r\#1"}~\ocwbc{} apiiparat \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"t.rr"}~\ocwbc{} atiitarat \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"vah\#1"}~\ocwbc{} aviivahat \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwbc{}  | \ocwstring{"jan"}  \ocwbc{} wrong *ajijiinat for ajiijanat \ocwec{}
    | \ocwstring{"sp.rz\#1"} \ocwbc{} wrong *apii.spazat for apisp.rzat \ocwec{} TODO \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwlowerid{cpstem}~$\ocwkw{with}~\ocwbc{} cpstem-ayati is the ca stem \ocwec{}\ocweol
\ocwindent{2.50em}
$[~[~37~::~[~2~::~\ocwlowerid{w}~]~]~\rightarrow{}~$\ocwbc{} w-aapayati \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{voy}~=~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"daa\#1"}~\ocwkw{then}~1~\ocwbc{} a \ocwec{}\ocweol
\ocwindent{9.50em}
\ocwkw{else}~3~\ocwbc{} i \ocwec{}~\ocwbc{} aap -> ip Whitney§861b \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{istem}~=~[~37~::~[~\ocwlowerid{voy}~::~\ocwlowerid{w}~]~]~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{redup\_aor}~\ocwlowerid{istem}~\ocwlowerid{entry}~$\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{4.50em}
\{~$\ocwlowerid{compute\_redup\_aorista\_ca}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocwbc{} ati.s.thipat adiidapat \ocwec{}\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{compute\_redup\_aoristm\_ca}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.50em}
\}\ocweol
\ocwindent{2.50em}
$\mid{}~[~37~::~[~1~::~\ocwlowerid{\_}~]~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{redup\_aor}~\ocwlowerid{cpstem}~\ocwlowerid{entry}~$\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{4.50em}
\{~$\ocwlowerid{compute\_redup\_aorista\_ca}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocwbc{} ajij~napat \ocwec{}\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{compute\_redup\_aoristm\_ca}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.50em}
\}\ocweol
\ocwindent{2.50em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{w}~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$(\ocwlowerid{v},\ocwlowerid{light},\ocwlowerid{r})~=~\ocwlowerid{look\_rec}~\ocwupperid{True}~\ocwlowerid{w}$\ocweol
\ocwindent{7.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{look\_rec}~\ocwlowerid{b}~=~$\ocwkw{fun}\ocweol
\ocwindent{10.50em}
$[~[~]~\rightarrow{}~\ocwlowerid{error\_empty}~31$\ocweol
\ocwindent{10.50em}
$\mid{}~[~\ocwlowerid{x}~::~\ocwlowerid{w'}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{x}~$\ocwkw{then}~$(\ocwlowerid{x},\ocwlowerid{b}~\land{}~\ocwlowerid{short\_vowel}~\ocwlowerid{x},\ocwlowerid{w'})$\ocweol
\ocwindent{19.00em}
\ocwkw{else}~$\ocwlowerid{look\_rec}~\ocwupperid{False}~\ocwlowerid{w'}~$\ocweol
\ocwindent{10.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{voy}~=~$\ocwkw{match}~$\ocwlowerid{v}~$\ocwkw{with}\ocweol
\ocwindent{7.00em}
$[~5~$\ocwbc{} u \ocwec{}~$\rightarrow{}~6~$\ocweol
\ocwindent{7.00em}
$\mid{}~6~$\ocwbc{} uu \ocwec{}~$\rightarrow{}~5$\ocweol
\ocwindent{7.00em}
$\mid{}~1~\mid{}~2~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{light}~$\ocwkw{then}~4~\ocwbc{} ii \ocwec{}\ocweol
\ocwindent{10.50em}
\ocwkw{else}~1~\ocwbc{} a \ocwec{}~\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{light}~$\ocwkw{then}~4~\ocwbc{} ii \ocwec{}\ocweol
\ocwindent{10.50em}
\ocwkw{else}~3~\ocwbc{} i \ocwec{}~\ocweol
\ocwindent{7.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{istem}~=~[~\ocwlowerid{c}~::~[~\ocwlowerid{voy}~::~\ocwlowerid{r}~]~]~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{redup\_aor}~\ocwlowerid{istem}~\ocwlowerid{entry}~$\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{4.50em}
\{~$\ocwlowerid{compute\_redup\_aorista\_ca}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocwbc{} adidiipat \ocwec{}~\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{compute\_redup\_aoristm\_ca}~\ocwlowerid{stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.50em}
\}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{error\_empty}~26$\ocweol
\ocwindent{2.50em}
$]~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()~$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Periphrastic future, Infinitive, Passive future participle in -tavya 
\ocweol
\label{verbs.ml:160854}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_peri\_fut}~\ocwlowerid{conj}~\ocwlowerid{perstem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjug}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{sandhi}~\ocwlowerid{perstem}~(\ocwlowerid{code}~\ocwlowerid{suff}))~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~(\ocwlowerid{conj},\ocwupperid{Perfut}~\ocwupperid{Active})$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"taasmi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"taasi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"taa"}\ocweol
\ocwindent{4.00em}
$]~)$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"taasvas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"taasthas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"taarau"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjug}~\ocwupperid{First}~$\ocwstring{"taasmas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Second}~$\ocwstring{"taastha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjug}~\ocwupperid{Third}~$\ocwstring{"taaras"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_pfp\_tavya}~\ocwlowerid{conj}~\ocwlowerid{perstem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pfp\_stem}~=~\ocwlowerid{fix}~\ocwlowerid{perstem}~$\ocwstring{"tavya"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{record\_part}~(\ocwupperid{Pfutp\_}~\ocwlowerid{conj}~(\ocwlowerid{rev}~\ocwlowerid{pfp\_stem})~\ocwlowerid{entry})~$\ocwbc{} rev compat entry by Pfpart \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_infinitive}~\ocwlowerid{c}~\ocwlowerid{inf\_stem}~\ocwlowerid{root}~=~$\ocwkw{do}\ocweol
\ocwindent{0.00em}
\ocwbc{} By default, for Causative, we get eg bhaavayitum, and later forms such as 
   bhaavitum have to be entered as supplements; see Witney§1051c. \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{root}~(\ocwupperid{Invar}~(\ocwlowerid{c},\ocwupperid{Infi})~(\ocwlowerid{fix}~\ocwlowerid{inf\_stem}~$\ocwstring{"tum"}$))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~\ocwlowerid{root}~(\ocwupperid{Inftu}~\ocwlowerid{c}~(\ocwlowerid{fix}~\ocwlowerid{inf\_stem}~$\ocwstring{"tu"}$))~$\ocwbc{} Xtu-kaama compounds \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} NB. bahuv cpds in -kaama and -manas constructed with infinitives in -tu 
   See Renou HLS p72 from Patanjali; also Assimil p194 eg tyaktukaama
   anu.s.thaatukaama \ocwstring{"desirious\ocwvspace{}to\ocwvspace{}proceed"} vaktukaama \ocwstring{"who\ocwvspace{}wants\ocwvspace{}to\ocwvspace{}speak"}
   dra.s.tumanas \ocwstring{"inclined\ocwvspace{}to\ocwvspace{}see"} \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{perif}~\ocwlowerid{conj}~\ocwlowerid{perstem}~\ocwlowerid{entry}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"cint"}~$\rightarrow{}~()~$\ocwbc{} no future \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{compute\_peri\_fut}~\ocwlowerid{conj}~\ocwlowerid{perstem}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{inf\_stem}~=~$\ocwkw{match}~$\ocwlowerid{conj}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Primary}~\rightarrow{}~$\ocwbc{} Difference infinitive/tavya forms and peri-future \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} should rather appear in perstems \ocwec{}\ocweol
\ocwindent{6.50em}
$[~$\ocwstring{"g.rr\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"giri"}~\ocwbc{} giritum, not gariitum \ocwec{}~\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"jak.s"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"jagh"}~\ocwbc{} jagdhum \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"p.rr"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"puuri"}~\ocwbc{} puuritum \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"sva\~{}nj"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"svaj"}~\ocwbc{} svaktum \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~$\ocwstring{"sa\~{}nj"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"saj"}~\ocwbc{} saktum \ocwec{}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{perstem}$\ocweol
\ocwindent{6.50em}
$]~$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{perstem}~$\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
$\ocwlowerid{build\_infinitive}~\ocwlowerid{conj}~\ocwlowerid{inf\_stem}~\ocwlowerid{entry}~$\ocwbc{} pb saa1 setum WR -situm \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwlowerid{admits\_passive}~\ocwlowerid{entry}~$\ocwkw{then}~$\ocwlowerid{record\_pfp\_tavya}~\ocwlowerid{conj}~\ocwlowerid{perstem}~\ocwlowerid{entry}~$\ocwkw{else}~$()$\ocweol
\ocwindent{1.00em}
\ocwbc{} other pfps generated from \ocwbegindcode{}$\ocwlowerid{pfp\_ya}$\ocwenddcode{} et \ocwbegindcode{}$\ocwlowerid{pfp\_aniiya}$\ocwenddcode{} below \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_perif}~\ocwlowerid{rstem}~\ocwlowerid{entry}=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pstems}~=~\ocwlowerid{perstems}~\ocwlowerid{rstem}~\ocwlowerid{entry}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{iter}~($\ocwkw{fun}~$\ocwlowerid{st}~\rightarrow{}~\ocwlowerid{perif}~\ocwupperid{Primary}~(\ocwlowerid{rev}~\ocwlowerid{st})~\ocwlowerid{entry})~\ocwlowerid{pstems}$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Passive future participle in -ya and -aniiya in all conjugations 
\ocweol
\label{verbs.ml:163413}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{palatal\_exception}~\ocwlowerid{root}~=~\ocwupperid{List.}\ocwlowerid{mem}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"aj"};~\ocwstring{"vraj"}~\ocwbc{} \Pan{7,3,60} \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"yaj\#1"};~\ocwstring{"yaac"};~\ocwstring{"ruc\#1"};~\ocwstring{".rc\#1"}~\ocwbc{} \Pan{7,3,66} \ocwec{}~\ocweol
\ocwindent{1.00em}
;~\ocwstring{"tyaj\#1"}~\ocwbc{} tyaajya Vaartika on \Pan{7,3,66} \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"s.rj\#1"};~\ocwstring{"v.rj"};~\ocwstring{"p.rc"}~\ocwbc{} because of -kyap \Pan{3,1,110} \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"raaj\#1"}~\ocwbc{} in order not to get raagya - unjustified by Panini ? \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rfix\_pfp\_ya}~\ocwlowerid{rstem}~=~$\ocwbc{} \Pan{7,3,52} \ocwec{}~\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rstem}~$\ocwkw{with}~\ocwbc{} double rev \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~$\ocwkw{when}~$\ocwlowerid{velar}~\ocwlowerid{c}~\rightarrow{}~\ocwlowerid{rfix}~\ocwlowerid{rstem}~$\ocwstring{"ya"}~\ocwbc{} \Pan{7,3,59} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Actually the following velarification should be registered as an optional
form, since \Pan{7,3,65} says that it does not apply in the sense of necessity \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{st}~=~$\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}~\ocwbc{} \ocwbegindcode{}$\ocwupperid{Int\_sandhi}.\ocwlowerid{restore\_stem}$\ocwenddcode{} not needed \ocwec{}\ocweol
\ocwindent{2.00em}
$[~[~22~$\ocwbc{} c \ocwec{}~::~$[~26~$\ocwbc{} ~n \ocwec{}~::~$\ocwlowerid{r}~]~]~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
$[~17~$\ocwbc{} k \ocwec{}~::~$[~21~$\ocwbc{} f \ocwec{}~::~$\ocwlowerid{r}~]~]~$\ocwbc{} vafkya \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~22~$\ocwbc{} c \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~[~17~$\ocwbc{} k \ocwec{}~::~$\ocwlowerid{r}~]~$\ocwbc{} paakya vaakya \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~24~$\ocwbc{} j \ocwec{}~::~$[~24~$\ocwbc{} j \ocwec{}~::~$\ocwlowerid{r}~]~]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
$[~19~$\ocwbc{} g \ocwec{}~::~$[~19~$\ocwbc{} g \ocwec{}~::~$\ocwlowerid{r}~]~]~$\ocwbc{} bh.rggya \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~24~$\ocwbc{} j \ocwec{}~::~$[~26~$\ocwbc{} ~n \ocwec{}~::~$\ocwlowerid{r}~]~]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
$[~19~$\ocwbc{} g \ocwec{}~::~$[~21~$\ocwbc{} f \ocwec{}~::~$\ocwlowerid{r}~]~]~$\ocwbc{} safgya \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~24~$\ocwbc{} j \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~[~19~$\ocwbc{} g \ocwec{}~::~$\ocwlowerid{r}~]~$\ocwbc{} maargya \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{rstem}$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~$\ocwlowerid{rfix}~\ocwlowerid{st}~$\ocwstring{"ya"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_pfp\_ya}~\ocwlowerid{conj}~\ocwlowerid{ya\_stem}~\ocwlowerid{root}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pfp\_stem}~=~$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{conj}=\ocwupperid{Primary}~$\ocwkw{then}~\ocweol
\ocwindent{4.50em}
\ocwkw{if}~$\ocwlowerid{palatal\_exception}~\ocwlowerid{root}~$\ocwkw{then}~$\ocwlowerid{rfix}~\ocwlowerid{ya\_stem}~$\ocwstring{"ya"}\ocweol
\ocwindent{4.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}~\ocweol
\ocwindent{7.00em}
$[~$\ocwstring{"hi.ms"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"hi.msya"}~\ocwbc{} no retroflex s Whitney§183a \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{rfix\_pfp\_ya}~\ocwlowerid{ya\_stem}~$\ocwbc{} .nyat \ocwec{}\ocweol
\ocwindent{7.00em}
$]$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~$\ocwlowerid{rfix}~\ocwlowerid{ya\_stem}~$\ocwstring{"ya"}~\ocwbc{} yat \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{record\_part}~(\ocwupperid{Pfutp\_}~\ocwlowerid{conj}~\ocwlowerid{pfp\_stem}~\ocwlowerid{root})~$\ocweol
\ocwindent{0.50em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_pfp\_aniiya}~\ocwlowerid{conj}~\ocwlowerid{iya\_stem}~\ocwlowerid{root}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pfp\_stem}~=~\ocwlowerid{rfix}~\ocwlowerid{iya\_stem}~$\ocwstring{"aniiya"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{record\_part}~(\ocwupperid{Pfutp\_}~\ocwlowerid{conj}~\ocwlowerid{pfp\_stem}~\ocwlowerid{root})~$\ocweol
\ocwindent{0.50em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Primary conjugation pfp in -ya except for ganas 10 and 11 \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pfp\_ya}~\ocwlowerid{rstem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{\_},~\ocwlowerid{strong},~\ocwlowerid{long})~=~\ocwlowerid{stems}~\ocwlowerid{entry}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwbc{} NB we do not use \ocwbegindcode{}$\ocwlowerid{weak\_stem}$\ocwenddcode{} and thus rstem is not mrijified/duhified \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{ya\_stem}~=~$\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[~1~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{2.00em}
$\mid{}~[~2~::~\ocwlowerid{r}~]~$\ocweol
\ocwindent{2.00em}
$\mid{}~[~11~$\ocwbc{} ai \ocwec{}~::~$\ocwlowerid{r}~]~$\ocweol
\ocwindent{2.00em}
$\mid{}~[~12~$\ocwbc{} o \ocwec{}~::~$\ocwlowerid{r}~]~$\ocweol
\ocwindent{2.00em}
$\mid{}~[~13~$\ocwbc{} au \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"mnaa"}~$\mid{}~$\ocwstring{"zaa"}~$\mid{}~$\ocwstring{"saa\#1"}~$\rightarrow{}~\ocwlowerid{rstem}~$\ocwbc{} mnaaya zaaya avasaaya \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~10~::~\ocwlowerid{r}~]~$\ocwbc{} deya \ocwec{}\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{2.00em}
$\mid{}~[~3~::~\ocwlowerid{\_}~]~\mid{}~[~4~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{strong}~$\ocweol
\ocwindent{2.00em}
$\mid{}~[~5~$\ocwbc{} u \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"stu"}~$\rightarrow{}~[~45~::~[~2~::~\ocwlowerid{r}~]~]~$\ocwbc{} u -> aav \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"yu\#1"}~$\rightarrow{}~[~6~::~\ocwlowerid{r}~]~$\ocwbc{} u -> uu \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"yu\#2"}~$\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Not\_attested}~$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{strong}~$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{2.00em}
$\mid{}~[~6~$\ocwbc{} uu \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"huu"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"hav"}~\ocwbc{} havya WR (?) \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"bruu"}~$\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Not\_attested}~$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{strong}~$\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{2.00em}
$\mid{}~[~7~$\ocwbc{} .r \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"dhv.r"}~$\rightarrow{}~\ocwlowerid{strong}~$\ocwbc{} dhvarya \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"d.r\#1"}~$\mid{}~$\ocwstring{"v.r\#2"}~$\rightarrow{}~[~32~::~\ocwlowerid{rstem}~]~$\ocwbc{} d.rtya v.rtya \Pan{3,1,109} \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwbc{} others as supplementary forms with interc t in \ocwbegindcode{}$\ocwlowerid{record\_pfp}$\ocwenddcode{} below \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{long}~$\ocwbc{} kaarya (k.rt .nyat) \Pan{3,1,124} \ocwec{}\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{2.00em}
$\mid{}~[~8~$\ocwbc{} .rr \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"st.rr"}~$\rightarrow{}~\ocwlowerid{strong}~$\ocwbc{} starya \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{long}$\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{3.00em}
\ocwbc{} now consonant rules \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~22;~7~]~$\ocwbc{} .rc \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~[~24;~7~]~$\ocwbc{} .rj \ocwec{}~$\rightarrow{}~\ocwlowerid{strong}~$\ocwbc{} arc arj \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~24;~7;~41~]~$\ocwbc{} m.rj \ocwec{}~$\rightarrow{}~\ocwlowerid{long}~$\ocwbc{} maarj \Pan{7,2,114} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~47;~7~]~$\ocwbc{} .r.sya autonomous \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~32;~7;~17~]~$\ocwbc{} k.rt \ocwec{}~$\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Not\_attested}~$\ocwbc{} k.rtya comes from k.r1 \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~48;~1~]~$\ocwbc{} as1 \ocwec{}~$\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Not\_attested}~$\ocwbc{} bhuu for as \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~[~33;~36;~1;~43;~19~]~$\ocwbc{} granth \ocwec{}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"grath"}~\ocweol
\ocwindent{2.00em}
$\mid{}~[~35;~1;~45~]~$\ocwbc{} vadh/han \ocwec{}~$\rightarrow{}~\ocwlowerid{rstem}~$\ocwbc{} vadhya \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~[~36;~1;~49~]~$\ocwbc{} han \ocwec{}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"ghaat"}~\ocwbc{} (h=h') \Pan{7,3,32+54} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~35;~1;~42;~45~]~$\ocwbc{} vyadh \ocwec{}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"vedh"}\ocweol
\ocwindent{2.00em}
$\mid{}~[~46;~1;~43;~37~]~$\ocwbc{} praz \ocwec{}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"p.rcch"}\ocweol
\ocwindent{2.00em}
$\mid{}~[~46;~1;~37~]~$\ocwbc{} paz \ocwec{}~$\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Not\_attested}~$\ocwbc{} pazya WR -Panini \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~46;~1;~45~]~$\ocwbc{} vaz \ocwec{}~$\rightarrow{}~\ocwlowerid{rstem}~$\ocwbc{} vazya (?) \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~49;~43;~1~]~$\ocwbc{} arh \ocwec{}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"argh"}~\ocwbc{} arghya (h=h') \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~17;~1;~46~]~$\ocwbc{} zak \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~[~49;~1;~48~]~$\ocwbc{} sah \ocwec{}~$\rightarrow{}~\ocwlowerid{rstem}~$\ocwbc{} zakya sahya \Pan{3,1,99} -yat \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~[~24;~1~]~$\ocwbc{} aj \ocwec{}~$\rightarrow{}~\ocwlowerid{rstem}~$\ocwbc{} ajya \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{c}~::~[~1~::~\ocwlowerid{\_}~]~]~$\ocwkw{when}~$\ocwlowerid{labial}~\ocwlowerid{c}~\rightarrow{}~\ocwlowerid{rstem}~$\ocwbc{} \Pan{3,1,98} -yat \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{c}~::~[~1~::~\ocwlowerid{r}~]~]~\rightarrow{}~[~\ocwlowerid{c}~::~[~2~::~\ocwlowerid{r}~]~]~$\ocwbc{} a lengthened if last non labial \ocwec{}\ocweol
\ocwindent{11.00em}
\ocwbc{} above often optional, see \ocwbegindcode{}$\ocwlowerid{record\_extra\_pfp\_ya}$\ocwenddcode{} below \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{c}~::~[~7~::~\ocwlowerid{\_}~]~]~\rightarrow{}~\ocwlowerid{rstem}~$\ocwbc{} d.rz1 v.r.s but NOT m.rj \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{c}~::~[~\ocwlowerid{v}~::~\ocwlowerid{\_}~]~]~$\ocwkw{when}~$\ocwlowerid{short\_vowel}~\ocwlowerid{v}~$\ocwbc{} gunify \ocwec{}~$\rightarrow{}~\ocwlowerid{strong}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{rstem}$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{record\_pfp\_ya}~\ocwupperid{Primary}~\ocwlowerid{ya\_stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{0.50em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Primary conjugation pfp in -ya for gana 10 \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pfp\_ya\_10}~\ocwlowerid{rstem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pfp\_stem}~=~\ocwlowerid{rfix}~\ocwlowerid{rstem}~$\ocwstring{"ya"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{record\_part}~(\ocwupperid{Pfutp\_}~\ocwupperid{Primary}~\ocwlowerid{pfp\_stem}~\ocwlowerid{entry})~$\ocweol
\ocwindent{0.50em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Primary conjugation pfp in -aniiya \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pfp\_aniiya}~\ocwlowerid{rstem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{iya\_stem}~=~$\ocweol
\ocwindent{2.50em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~$\ocwstring{"uk.s"}~$\mid{}~$\ocwstring{"cint"}~$\rightarrow{}~\ocwlowerid{rstem}~\mid{}~$\ocwstring{"as\#1"}~$\mid{}~$\ocwstring{"yu\#1"}~$\mid{}~$\ocwstring{"yu\#2"}~$\mid{}~$\ocwstring{"bruu"}~$\mid{}~$\ocwstring{"paz"}~$\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Not\_attested}~$\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"dham"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"dhmaa"}~\ocwbc{} \Pan{7,3,78} \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"vyadh"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"vedh"}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{match}~$\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rstem}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~4~::~\ocwlowerid{\_}~]~\mid{}~[~6~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{rstem}~$\ocwbc{} ii- uu- no guna \ocwec{}~\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{strong\_stem}~\ocwlowerid{entry}~\ocwlowerid{rstem}$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{2.50em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{record\_pfp\_aniiya}~\ocwupperid{Primary}~\ocwlowerid{iya\_stem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{0.50em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_pfp\_10}~\ocwlowerid{entry}~\ocwlowerid{rstem}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~\ocwkw{try}~$\ocwlowerid{pfp\_ya\_10}~\ocwlowerid{rstem}~\ocwlowerid{entry}~$\ocwkw{with}~$[~\ocwupperid{Not\_attested}~\rightarrow{}~()~]$\ocweol
\ocwindent{1.00em}
;~\ocwkw{try}~$\ocwlowerid{pfp\_aniiya}~\ocwlowerid{rstem}~\ocwlowerid{entry}~$\ocwkw{with}~$[~\ocwupperid{Not\_attested}~\rightarrow{}~()~]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Absolutive and Past Participle 
\ocweol
\label{verbs.ml:169047}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_part\_ppp}~\ocwlowerid{ppstem}~\ocwlowerid{entry}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{record\_part}~(\ocwupperid{Ppp\_}~\ocwupperid{Primary}~\ocwlowerid{ppstem}~\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part}~(\ocwupperid{Pppa\_}~\ocwupperid{Primary}~[~45~::~\ocwlowerid{ppstem}~]~\ocwlowerid{entry})~$\ocwbc{} pp-vat (krid tavat) \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_abso\_ya}~\ocwlowerid{form}~\ocwlowerid{entry}~=~\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Invar}~(\ocwupperid{Primary},\ocwupperid{Absoya})~\ocwlowerid{form})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{record\_abso\_tvaa}~\ocwlowerid{form}~\ocwlowerid{entry}~=~\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Absotvaa}~\ocwupperid{Primary}~\ocwlowerid{form})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} First absolutives in -ya \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_abs\_ya}~\ocwlowerid{entry}~\ocwlowerid{rstem}~\ocwlowerid{w}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\ocwbc{} intercalate t for light roots Kiparsky\ocwbegindcode{}159\ocwenddcode{} Macdonell§165 \ocwec{}\ocweol
\ocwindent{1.00em}
\{~\ocwkw{let}~$\ocwlowerid{absya}~=~$\ocweol
\ocwindent{3.50em}
\ocwkw{if}~$\ocwlowerid{light}~\ocwlowerid{rstem}~$\ocwkw{then}~$\ocwlowerid{fix}~\ocwlowerid{w}~$\ocwstring{"tya"}~\ocwbc{} check test light \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwkw{else}~\ocwkw{let}~$\ocwlowerid{rst}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~$\ocwbc{} roots in -m and -n in gana 8 \Pan{6,4,37} \ocwec{}\ocweol
\ocwindent{8.00em}
\ocwstring{"van"}~$\mid{}~$\ocwstring{"man"}~$\mid{}~$\ocwstring{"tan\#1"}~\ocwbc{} man also in gana 4 \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"gam"}~$\mid{}~$\ocwstring{"nam"}~$\mid{}~$\ocwstring{"yam"}~$\mid{}~$\ocwstring{"han\#1"}~\ocwbc{} anudatta ? \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"kram"}~$\mid{}~$\ocwstring{"klam"}~$\mid{}~$\ocwstring{"zam\#2"}~$\mid{}~$\ocwstring{"zram"}~\ocwbc{} \Pan{6,4,15} \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"daa\#2"}~$\mid{}~$\ocwstring{"saa\#1"}~$\mid{}~$\ocwstring{"sthaa\#1"}~$\mid{}~$\ocwstring{"maa\#1"}~\ocwbc{} \Pan{7,4,40} \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"daa\#1"}~\ocwbc{} \Pan{7,4,46} \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"dhaa\#1"}~\ocwbc{} \Pan{7,4,42} \ocwec{}\ocweol
\ocwindent{9.50em}
$\rightarrow{}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"zii\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"zay"}~\ocwbc{} \Pan{7,4,22} \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{w}$\ocweol
\ocwindent{6.00em}
$]~$\ocwkw{in}~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{8.50em}
$[~$\ocwstring{"hi.ms"}~$\rightarrow{}~\ocwlowerid{code}~$\ocwstring{"hi.msya"}~\ocwbc{} no retroflex s Whitney§183 \ocwec{}\ocweol
\ocwindent{8.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{fix}~\ocwlowerid{rst}~$\ocwstring{"ya"}~\ocweol
\ocwindent{8.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{record\_abso\_ya}~\ocwlowerid{absya}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} alternate forms in -ya and -tvaa \ocwec{}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"gam"}~$\mid{}~$\ocwstring{"tan\#1"}~$\mid{}~$\ocwstring{"nam"}~$\mid{}~$\ocwstring{"man"}~$\mid{}~$\ocwstring{"van"}~$\mid{}~$\ocwstring{"han\#1"}~$\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwbc{} a+nasal optional assimilation to light roots \ocwec{}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{record\_abso\_ya}~(\ocwlowerid{fix}~\ocwlowerid{w}~$\ocwstring{"tya"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"dhaa\#1"}~$\rightarrow{}~\ocwlowerid{record\_abso\_tvaa}~(\ocwlowerid{code}~$\ocwstring{"dhitvaa"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"plu"}~$\rightarrow{}~\ocwlowerid{record\_abso\_ya}~(\ocwlowerid{code}~$\ocwstring{"pluuya"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"b.rh\#1"}~$\rightarrow{}~\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{revcode}~$\ocwstring{"b.r.mhita"}$)~\ocwlowerid{entry}~$\ocwbc{} MW -WR \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"v.r\#2"}~$\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{record\_abso\_tvaa}~(\ocwlowerid{code}~$\ocwstring{"varitvaa"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{10.00em}
;~$\ocwlowerid{record\_abso\_tvaa}~(\ocwlowerid{code}~$\ocwstring{"variitvaa"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{10.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"kram"}~$\rightarrow{}~\ocwlowerid{record\_abso\_tvaa}~(\ocwlowerid{code}~$\ocwstring{"krantvaa"}$)~\ocwlowerid{entry}~$\ocwbc{} \Pan{6,4,18} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zaas"}~$\rightarrow{}~$\ocwbc{} passive stem zi.s \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{w}~=~\ocwlowerid{revcode}~$\ocwstring{"zi.s"}~\ocwkw{in}~\ocwkw{do}~\ocwbc{} as if ipad=0 \ocwec{}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{rfix}~\ocwlowerid{w}~$\ocwstring{"ta"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{record\_abso\_tvaa}~(\ocwlowerid{fix}~\ocwlowerid{w}~$\ocwstring{"tvaa"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{record\_abso\_ya}~(\ocwlowerid{fix}~\ocwlowerid{w}~$\ocwstring{"ya"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{2.00em}
$]~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{alternate\_pp}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"m.r.s"}~$\mid{}~$\ocwstring{"svid\#2"}~$\mid{}~$\ocwstring{"dh.r.s"}~$\mid{}~$\ocwstring{"puu\#1"}~\ocwbc{} next roots of gu.na 1 have penultimate \ocwstring{"u"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"kul"}~$\mid{}~$\ocwstring{"k.sud"}~$\mid{}~$\ocwstring{"guh"}~$\mid{}~$\ocwstring{"jyut"}~$\mid{}~$\ocwstring{"dyut\#1"}~$\mid{}~$\ocwstring{"mud\#1"}~$\mid{}~$\ocwstring{"rud\#1"}~$\mid{}~$\ocwstring{"ruh\#1"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"lul"}~$\mid{}~$\ocwstring{"zuc\#1"}~$\mid{}~$\ocwstring{"zubh\#1"}~$\mid{}~$\ocwstring{"zu.s"}~$\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Condition for extra abs in -tvaa with guna: root starts with consonant
   and ends in any consonant but y or v and has i or u as penultimate. 
   Given by \Pan{1,2,26}. Example: sidh1 \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{alternate\_tvaa}~\ocwlowerid{entry}~\ocwlowerid{rstem}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rstem}~$\ocwkw{with}~\ocwbc{} double rev \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{consonant}~\ocwlowerid{c}~\land{}~$\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~42~$\ocwbc{} y \ocwec{}~::~$\ocwlowerid{\_}~]~\mid{}~[~45~$\ocwbc{} v \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~\ocwlowerid{c'}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{consonant}~\ocwlowerid{c'}~\land{}~$\ocwkw{match}~$\ocwlowerid{rest}~$\ocwkw{with}~\ocweol
\ocwindent{5.00em}
$[~[~3~$\ocwbc{} i \ocwec{}~::~$\ocwlowerid{\_}~]~\mid{}~[~5~$\ocwbc{} u \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~\ocwupperid{True}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{4.50em}
$[~$\ocwstring{"t.r.s\#1"}~$\mid{}~$\ocwstring{"m.r.s"}~$\mid{}~$\ocwstring{"k.rz"}~\ocwbc{} \Pan{1,2,25} \ocwec{}\ocweol
\ocwindent{4.50em}
$\mid{}~$\ocwstring{"puu\#1"}~\ocwbc{} \Pan{1,2,22} \ocwec{}~$\rightarrow{}~\ocwupperid{True}~$\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Records the (reversed) ppp stem (computed by \ocwbegindcode{}$\ocwlowerid{compute\_ppp\_stems}$\ocwenddcode{})
   and builds absolutives in -tvaa and -ya ( should be separated some day). \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_ppp\_abs\_stems}~\ocwlowerid{entry}~\ocwlowerid{rstem}~\ocwlowerid{ppstems}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{process\_ppstem}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.50em}
$[~\ocwupperid{Na}~\ocwlowerid{w}~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{rfix}~\ocwlowerid{w}~$\ocwstring{"na"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.00em}
;~\ocwkw{let}~$\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} roots in -d \ocwec{}~\ocweol
\ocwindent{6.00em}
$[~$\ocwstring{"k.sud"}~$\mid{}~$\ocwstring{"chad\#1"}~$\mid{}~$\ocwstring{"chid\#1"}~$\mid{}~$\ocwstring{"ch.rd"}~$\mid{}~$\ocwstring{"tud\#1"}~$\mid{}~$\ocwstring{"t.rd"}~$\mid{}~$\ocwstring{"nud"}~\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"pad\#1"}~$\mid{}~$\ocwstring{"bhid\#1"}~$\mid{}~$\ocwstring{"mid"}~$\mid{}~$\ocwstring{"vid\#2"}~$\mid{}~$\ocwstring{"zad"}~$\mid{}~$\ocwstring{"sad\#1"}~$\mid{}~$\ocwstring{"had"}~\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"svid\#2"}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{w}~$\ocwkw{with}~\ocweol
\ocwindent{13.00em}
$[~[~36~$\ocwbc{} n \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~[~34~$\ocwbc{} d \ocwec{}~::~$\ocwlowerid{r}~]~$\ocweol
\ocwindent{13.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Anomaly\ocwvspace{}Verbs"}\ocweol
\ocwindent{13.00em}
$]~$\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"vrazc"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"v.rz"}~\ocwbc{} not v.rk \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"und"}~$\mid{}~$\ocwstring{"skand"}~$\mid{}~$\ocwstring{"syand"}~$\rightarrow{}~[~34~$\ocwbc{} d \ocwec{}~::~$\ocwlowerid{w}~]$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{w}~$\ocweol
\ocwindent{6.00em}
$]~$\ocwkw{in}~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{6.00em}
$[~$\ocwstring{"mid"}~$\rightarrow{}~$\ocweol
\ocwindent{10.00em}
\ocwkw{let}~$\ocwlowerid{abs\_mid}~\ocwlowerid{st}~=~\ocwlowerid{record\_abso\_tvaa}~(\ocwlowerid{fix}~\ocwlowerid{st}~$\ocwstring{"itvaa"}$)~\ocwlowerid{entry}~$\ocwkw{in}\ocweol
\ocwindent{10.00em}
\ocwkw{do}~\{~$\ocwlowerid{abs\_mid}~\ocwlowerid{stem};~\ocwlowerid{abs\_mid}~(\ocwlowerid{revcode}~$\ocwstring{"med"}$)~$\ocwbc{} guna \ocwec{}\}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{record\_abso\_tvaa}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"tvaa"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{11.50em}
;~$\ocwlowerid{record\_abso\_ya}~(\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"ya"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{11.50em}
\}\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Ka}~\ocwlowerid{w}~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{4.50em}
\{~$\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{rfix}~\ocwlowerid{w}~$\ocwstring{"ka"}$)~\ocwlowerid{entry}~$\ocwbc{} zu.ska \Pan{8,2,51} \ocwec{}\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{record\_abso\_ya}~(\ocwlowerid{fix}~\ocwlowerid{w}~$\ocwstring{"ya"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{4.50em}
\}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Va}~\ocwlowerid{w}~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{4.50em}
\{~$\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{rfix}~\ocwlowerid{w}~$\ocwstring{"va"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{record\_abso\_tvaa}~(\ocwlowerid{fix}~\ocwlowerid{w}~$\ocwstring{"tvaa"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{record\_abso\_ya}~(\ocwlowerid{fix}~\ocwlowerid{w}~$\ocwstring{"ya"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{4.50em}
\}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Ta}~\ocwlowerid{w}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{4.50em}
\{~\ocwkw{if}~$\ocwlowerid{is\_anit\_pp}~\ocwlowerid{entry}~\ocwlowerid{rstem}~$\ocwkw{then}~$\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{rfix}~\ocwlowerid{w}~$\ocwstring{"ta"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{5.50em}
\ocwkw{else}~$($\ocwbc{} taken care of as Tia \ocwec{}$)$\ocweol
\ocwindent{4.50em}
;~\ocwkw{if}~$\ocwlowerid{is\_anit\_tvaa}~\ocwlowerid{entry}~\ocwlowerid{rstem}~$\ocwkw{then}~$\ocwlowerid{record\_abso\_tvaa}~(\ocwlowerid{fix}~\ocwlowerid{w}~$\ocwstring{"tvaa"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{5.50em}
\ocwkw{else}~$($\ocwbc{} taken care of as Tia \ocwec{}$)$\ocweol
\ocwindent{4.50em}
;~\ocwbc{} abs -ya computed whether set or anit \ocwec{}~\ocweol
\ocwindent{5.50em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{5.50em}
$[~$\ocwstring{"av"}~$\rightarrow{}~\ocwlowerid{record\_abs\_ya}~\ocwlowerid{entry}~\ocwlowerid{rstem}~(\ocwlowerid{revcode}~$\ocwstring{"aav"}$)~$\ocwbc{} -aavya \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{record\_abs\_ya}~\ocwlowerid{entry}~\ocwlowerid{rstem}~\ocwlowerid{w}$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{4.50em}
\}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Tia}~\ocwlowerid{w}~\rightarrow{}~$\ocwkw{let}~$(\ocwlowerid{ita},\ocwlowerid{itvaa})~=~$\ocwkw{if}~$\ocwlowerid{entry}=$\ocwstring{"grah"}~\ocwkw{then}~$($\ocwstring{"iita"},\ocwstring{"iitvaa"}$)~$\ocweol
\ocwindent{17.00em}
\ocwkw{else}~$($\ocwstring{"ita"},\ocwstring{"itvaa"}$)~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.50em}
\{~\ocwkw{if}~$\ocwlowerid{is\_set\_pp}~\ocwlowerid{entry}~\ocwlowerid{rstem}~$\ocwkw{then}~\ocweol
\ocwindent{7.00em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{7.00em}
$[~$\ocwstring{"dh.r.s"}~$\mid{}~$\ocwstring{"zii\#1"}~\ocwbc{} \ocwstring{"svid\#2"} \ocwstring{"k.svid"} \ocwstring{"mid"} \Pan{1,2,19} \ocwec{}\ocweol
\ocwindent{8.50em}
$\rightarrow{}~\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{rfix}~(\ocwlowerid{strong}~\ocwlowerid{w})~\ocwlowerid{ita})~\ocwlowerid{entry}$\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{8.00em}
\{~$\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{rfix}~\ocwlowerid{w}~\ocwlowerid{ita})~\ocwlowerid{entry}$\ocweol
\ocwindent{8.00em}
;~\ocwkw{if}~$\ocwlowerid{alternate\_pp}~\ocwlowerid{entry}~$\ocwkw{then}~\ocweol
\ocwindent{10.50em}
$\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{rfix}~(\ocwlowerid{strong}~\ocwlowerid{w})~\ocwlowerid{ita})~\ocwlowerid{entry}$\ocweol
\ocwindent{9.00em}
\ocwkw{else}~$()$\ocweol
\ocwindent{8.00em}
\}\ocweol
\ocwindent{7.00em}
$]$\ocweol
\ocwindent{5.50em}
\ocwkw{else}~$()$\ocweol
\ocwindent{4.50em}
;~\ocwkw{if}~$\ocwlowerid{is\_set\_tvaa}~\ocwlowerid{entry}~\ocwlowerid{rstem}~$\ocwkw{then}~\ocwkw{do}~\ocweol
\ocwindent{7.00em}
\{~\ocwkw{let}~$\ocwlowerid{tstem}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{10.00em}
$[~$\ocwstring{"m.rj"}~$\rightarrow{}~\ocwlowerid{lengthened}~\ocwlowerid{rstem}~$\ocwbc{} maarj \ocwec{}\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"yaj\#1"}~$\mid{}~$\ocwstring{"vyadh"}~$\mid{}~$\ocwstring{"grah"}~$\mid{}~$\ocwstring{"vrazc"}~$\mid{}~$\ocwstring{"praz"}~$\mid{}~$\ocwstring{"svap"}~\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"vaz"}~$\mid{}~$\ocwstring{"vac"}~$\mid{}~$\ocwstring{"vap"}~$\mid{}~$\ocwstring{"vap\#1"}~$\mid{}~$\ocwstring{"vap\#2"}~$\mid{}~$\ocwstring{"vad"}~\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"vas\#1"}~$\mid{}~$\ocwstring{"vas\#4"}~$\rightarrow{}~\ocwlowerid{w}$\ocweol
\ocwindent{10.00em}
$\mid{}~$\ocwstring{"siiv"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"sev"}~\ocwbc{} gu.na \ocwec{}\ocweol
\ocwindent{10.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{strong}~\ocwlowerid{w}$\ocweol
\ocwindent{10.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{8.00em}
$\ocwlowerid{record\_abso\_tvaa}~(\ocwlowerid{fix}~\ocwlowerid{tstem}~\ocwlowerid{itvaa})~\ocwlowerid{entry}$\ocweol
\ocwindent{7.00em}
;~\ocwkw{if}~$\ocwlowerid{alternate\_tvaa}~\ocwlowerid{entry}~\ocwlowerid{rstem}~$\ocwkw{then}~\ocweol
\ocwindent{9.50em}
$\ocwlowerid{record\_abso\_tvaa}~(\ocwlowerid{fix}~\ocwlowerid{w}~$\ocwstring{"itvaa"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~$()$\ocweol
\ocwindent{7.00em}
\}\ocweol
\ocwindent{5.50em}
\ocwkw{else}~$()$\ocweol
\ocwindent{4.50em}
\}\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{iter}~\ocwlowerid{process\_ppstem}~\ocwlowerid{ppstems}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Simple version for denominatives - tentative \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_ppp\_abs\_den}~\ocwlowerid{ystem}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{0.50em}
\ocwkw{let}~$\ocwlowerid{ppstem}~=~\ocwlowerid{trunc}~(\ocwlowerid{revstem}~\ocwlowerid{entry})~$\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{rfix}~\ocwlowerid{ppstem}~$\ocwstring{"ita"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_abso\_tvaa}~(\ocwlowerid{fix}~\ocwlowerid{ystem}~$\ocwstring{"itvaa"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
\ocwbc{} no \ocwbegindcode{}$\ocwlowerid{record\_abso\_ya}$\ocwenddcode{} since usually no preverb to denominatives \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Absolutive in -am - Macdonell§166 Stenzler§288 \Pan{3,4,22} .namul          \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Registered both in Invar and in Absotvaa, since may be used with preverbs.  \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Used specially for verbs that may be iterated - having done again and again \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_abso\_am}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{record}~\ocwlowerid{form}~=~$\ocwkw{do}~\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{record\_abso\_tvaa}~(\ocwlowerid{code}~\ocwlowerid{form})~\ocwlowerid{root}~$\ocwbc{} no preverb \ocwec{}\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{record\_abso\_ya}~(\ocwlowerid{code}~\ocwlowerid{form})~\ocwlowerid{root}~$\ocwbc{} some preverb \ocwec{}\ocweol
\ocwindent{3.00em}
\}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{root}~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"as\#2"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"aasam"}~\ocwbc{} may overgenerate \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"ka.s"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"kaa.sam"}~\ocwbc{} \Pan{3,4,34} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"kram"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"kraamam"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"k.r\#1"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"kaaram"}~\ocwbc{} \Pan{3,4,26-28} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"khan"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"khaanam"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"t.r.s\#1"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"tar.sam"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"daa\#1"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"daayam"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"paa\#1"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"paayam"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"pi.s"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"pe.sam"}~\ocwbc{} \Pan{3,4,35+38} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"pu.s\#1"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"po.sam"}~\ocwbc{} \Pan{3,4,40} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"puur\#1"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"puuram"}~\ocwbc{} \Pan{3,4,31} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"praz"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"p.rccham"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"bandh"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"bandham"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"bhuj\#1"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"bhojam"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"bhuu\#1"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"bhaavam"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"vad"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"vaadam"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"v.rt\#1"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"vartam"}~\ocwbc{} \Pan{3,4,39} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"zru"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"zraavam"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"sa\~{}nj"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"sa\~{}ngam"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"s.r"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"saaram"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"han"}~$\rightarrow{}~\ocwlowerid{record}~$\ocwstring{"ghaatam"}~\ocwbc{} \Pan{3,4,36+37} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} absolutive of secondary conjugations \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_absolutive}~\ocwlowerid{c}~\ocwlowerid{abs\_stem\_tvaa}~\ocwlowerid{abs\_stem\_ya}~\ocwlowerid{intercal}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{record\_abso\_ya}~\ocwlowerid{form}~=~\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Invar}~(\ocwlowerid{c},\ocwupperid{Absoya})~\ocwlowerid{form})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{record\_abso\_tvaa}~\ocwlowerid{form}~=~\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Absotvaa}~\ocwlowerid{c}~\ocwlowerid{form})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~\ocwkw{let}~$\ocwlowerid{sfx}~=~$\ocwkw{if}~$\ocwlowerid{intercal}~$\ocwkw{then}~\ocwstring{"itvaa"}~\ocwkw{else}~\ocwstring{"tvaa"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{record\_abso\_tvaa}~(\ocwlowerid{fix}~\ocwlowerid{abs\_stem\_tvaa}~\ocwlowerid{sfx})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_abso\_ya}~(\ocwlowerid{fix}~\ocwlowerid{abs\_stem\_ya}~$\ocwstring{"ya"}$)$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_pppca}~\ocwlowerid{cpstem}~\ocwlowerid{cstem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{ppstem}~=~[~1~::~[~32~::~[~3~::~\ocwlowerid{cpstem}~]~]~]~$\ocwbc{} cp-ita \ocwec{}~\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{record\_part}~(\ocwupperid{Ppp\_}~\ocwupperid{Causative}~\ocwlowerid{ppstem}~\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part}~(\ocwupperid{Pppa\_}~\ocwupperid{Causative}~[~45~::~\ocwlowerid{ppstem}~]~\ocwlowerid{entry})~$\ocwbc{} pp-vat \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{abs\_stem\_ya}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} Whitney§1051d \ocwec{}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"aap"}~$\mid{}~$\ocwstring{".r"}~$\mid{}~$\ocwstring{".rc\#1"}~$\mid{}~$\ocwstring{".rdh"}~$\mid{}~$\ocwstring{"kal"}~$\mid{}~$\ocwstring{"k.lp"}~$\mid{}~$\ocwstring{"kram"}~$\mid{}~$\ocwstring{"gam"}~\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"jan"}~$\mid{}~$\ocwstring{"jval"}~$\mid{}~$\ocwstring{"dh.r"}~$\mid{}~$\ocwstring{"rac"}~$\mid{}~$\ocwstring{"zam"}~$\mid{}~$\ocwstring{"p.rr"}~$\mid{}~$\ocwstring{"bhak.s"}~$\mid{}~$\ocwstring{"v.rj"}~\ocweol
\ocwindent{6.00em}
$\rightarrow{}~\ocwlowerid{cstem}~$\ocwbc{} retains ay: -gamayya to distinguish from -gamya \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{cpstem}~$\ocwbc{} eg -vaadya -vezya \ocwec{}\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{abs\_stem\_tvaa}~=~\ocwlowerid{cstem}~$\ocwbc{} retains ay: gamayitvaa \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{record\_absolutive}~\ocwupperid{Causative}~\ocwlowerid{abs\_stem\_tvaa}~\ocwlowerid{abs\_stem\_ya}~\ocwupperid{True}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.50em}
\ocwbc{} cp-ita -> cp-ayitvaa, -cp-ayya ou -cp-ya \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_pppdes}~\ocwlowerid{stem}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{ppstem}~=~[~1~::~[~32~::~[~3~::~\ocwlowerid{stem}~]~]~]~$\ocwkw{in}~\ocwbc{} s-ita \ocwec{}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{record\_part}~(\ocwupperid{Ppp\_}~\ocwupperid{Desiderative}~\ocwlowerid{ppstem}~\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part}~(\ocwupperid{Pppa\_}~\ocwupperid{Desiderative}~[~45~::~\ocwlowerid{ppstem}~]~\ocwlowerid{entry})~$\ocwbc{} pp-vat \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{abs\_stem\_tvaa}~=~[~3~::~\ocwlowerid{stem}~]~$\ocwbc{} s-i \ocwec{}~\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{abs\_stem\_ya}~=~\ocwlowerid{stem}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{record\_absolutive}~\ocwupperid{Desiderative}~\ocwlowerid{abs\_stem\_tvaa}~\ocwlowerid{abs\_stem\_ya}~\ocwupperid{False}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.50em}
\ocwbc{} s-ita -> s-itvaa, -s-iya \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Intensive or frequentative 
\ocweol
\label{verbs.ml:179020}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_intensive\_presenta}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{0.00em}
\ocwbc{} info not used for check because of ambiguity of third sg - we want no
   error message in the conjugation engine display \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix3w}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwupperid{False}~\ocwlowerid{suff})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~\ocwlowerid{intensa}~$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"mi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"iimi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"si"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"iisi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"ti"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"iiti"}~$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"thas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"tas"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"mas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tha"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ati"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{wstem}~=~$\ocwkw{if}~$\ocwlowerid{iiflag}~$\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}~\ocweol
\ocwindent{4.50em}
$[~[~4~::~\ocwlowerid{w}~]~\rightarrow{}~\ocwlowerid{w}~$\ocwbc{} ii disappears before vowels in special roots \ocwec{}\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Wrong\ocwvspace{}weak\ocwvspace{}stem\ocwvspace{}of\ocwvspace{}special\ocwvspace{}intensive"}\ocweol
\ocwindent{4.50em}
$]~$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~$\ocwlowerid{weak}~$\ocwkw{in}~\ocwbc{} 3rd pl weak stem \ocwec{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{record\_part}~(\ocwupperid{Pprared\_}~\ocwupperid{Intensive}~\ocwlowerid{wstem}~\ocwlowerid{entry})~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_intensive\_impfta}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix\_augment}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix3w\_augment}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwupperid{False}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~\ocwlowerid{intimpfta}~$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Second}~$\ocwstring{"s"}~\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"iis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"t"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"iit"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"va"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugw}~\ocwupperid{First}~$\ocwstring{"ma"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"ur"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_intensive\_optativea}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix3w}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwupperid{False}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwlowerid{conjug\_optativea}~\ocwlowerid{int\_gana}~\ocwupperid{Intensive}~\ocwlowerid{conjugw})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_intensive\_imperativea}~\ocwlowerid{strong}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conjugs}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix}~\ocwlowerid{strong}~\ocwlowerid{suff})$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conjugw}~\ocwlowerid{person}~\ocwlowerid{suff}~=~(\ocwlowerid{person},\ocwlowerid{fix3w}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwupperid{False}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~\ocwlowerid{entry}~(\ocwupperid{Conju}~\ocwlowerid{intimpera}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$(\ocwupperid{Second},~$\ocwkw{match}~$\ocwlowerid{weak}~$\ocwkw{with}~\ocweol
\ocwindent{6.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{fix3w}~\ocwlowerid{weak}~\ocwlowerid{iiflag}~\ocwupperid{False}~\ocwlowerid{suff}~$\ocweol
\ocwindent{7.00em}
$\ocwlowerid{where}~\ocwlowerid{suff}~=~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~\ocwstring{"hi"}~\ocwbc{} \ocwstring{"dhi"} or \ocwstring{"hi"} after vowel \ocwec{}\ocweol
\ocwindent{14.00em}
\ocwkw{else}~\ocwstring{"dhi"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{error\_empty}~27$\ocweol
\ocwindent{6.00em}
$]~)~$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"tu"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugs}~\ocwupperid{Third}~$\ocwstring{"iitu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aava"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"tam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"taam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{conjugs}~\ocwupperid{First}~$\ocwstring{"aama"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Second}~$\ocwstring{"ta"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{conjugw}~\ocwupperid{Third}~$\ocwstring{"atu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Reduplication for the intensive conjugation - TODO Macdonell§173 
\ocwbegindcode{}$\ocwlowerid{value}~\ocwlowerid{redup\_int}~\ocwlowerid{entry}~=~...$\ocwenddcode{}
For the moment, the reduplicated stem is read from the lexicon. 
It is not clear whether there are enough intensive forms to warrant a paradigm
rather than a table. \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Similar to \ocwbegindcode{}$\ocwlowerid{compute\_active\_present3}$\ocwenddcode{} with Intensive, plus optional ii forms 
\ocweol
\label{verbs.ml:182220}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_intensivea}~\ocwlowerid{wstem}~\ocwlowerid{sstem}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{iiflag}~=~\ocwupperid{False}~$\ocwkw{in}~\ocwbc{} \ocwbegindcode{}\ocwkw{let}~$(\ocwlowerid{sstem},\ocwlowerid{wstem})~=~\ocwlowerid{redup\_int}~\ocwlowerid{entry}~$\ocwkw{in}\ocwenddcode{} \ocwec{}~\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_intensive\_presenta}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~$\ocwbc{} no third \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_intensive\_impfta}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_intensive\_optativea}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_intensive\_imperativea}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwlowerid{entry}=$\ocwstring{"bhuu\#1"}~\ocwbc{} bobhoti \ocwec{}~\ocwkw{then}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~$\ocwstring{"bobhav"}~\ocwkw{in}~$\ocwlowerid{build\_perpft}~\ocwupperid{Intensive}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$()~$\ocwbc{} EXPERIMENTAL \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Takes reduplicated stem from lexicon. A generative version would use 
   \ocwbegindcode{}$\ocwlowerid{redup3}$\ocwenddcode{} and add \ocwstring{"ya"} like passive \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_intensivem}~=~\ocwlowerid{compute\_thematic\_middle}~\ocwlowerid{int\_gana}~\ocwupperid{Intensive}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_intensivem2}~\ocwlowerid{st}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{compute\_athematic\_present3m}~\ocwupperid{Intensive}~\ocwlowerid{int\_gana}~\ocwlowerid{st}~\ocwupperid{False}~$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Present system 
\ocweol
\label{verbs.ml:183097}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_present\_system}~\ocwlowerid{entry}~\ocwlowerid{rstem}~\ocwlowerid{gana}~\ocwlowerid{pada}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{try}\ocweol
\ocwindent{1.50em}
\ocwbc{} pada=True for active (parasmaipade), False for middle (aatmanepade) \ocwec{}\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$\ocwlowerid{padam}~=~$\ocwkw{if}~$\ocwlowerid{third}=[\,]~$\ocwkw{then}~$\ocwupperid{False}~$\ocwkw{else}~$\ocwlowerid{pada}~$\ocwkw{in}~\ocwbc{} artifact for fake below \ocwec{}\ocweol
\ocwindent{1.50em}
\ocwkw{match}~$\ocwlowerid{gana}~$\ocwkw{with}\ocweol
\ocwindent{1.50em}
$[~1~\mid{}~4~\mid{}~6~\mid{}~10~$\ocwbc{} thematic conjugation \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{compute\_thematic\_present}~\ocwlowerid{stem}~=~$\ocweol
\ocwindent{4.50em}
\ocwkw{match}~$\ocwlowerid{voices\_of\_gana}~\ocwlowerid{gana}~\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{4.50em}
$[~\ocwupperid{Para}~\rightarrow{}~$\ocwbc{} active only \ocwec{}~\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}\ocweol
\ocwindent{6.50em}
$\ocwlowerid{compute\_thematic\_active}~\ocwlowerid{gana}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{18.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{".r"}~\ocwkw{then}~\ocwbc{} for sam- \ocwec{}\ocweol
\ocwindent{6.50em}
$\ocwlowerid{compute\_thematic\_middle}~\ocwlowerid{gana}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{emit\_warning}~($\ocwstring{"Unexpected\ocwvspace{}middle\ocwvspace{}form:\ocwvspace{}"}~\^{}~$\ocwlowerid{entry})~$\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwupperid{Atma}~\rightarrow{}~$\ocwbc{} middle only \ocwec{}~\ocweol
\ocwindent{6.50em}
\ocwkw{if}~$\ocwlowerid{padam}~$\ocwkw{then}~$\ocwlowerid{emit\_warning}~($\ocwstring{"Unexpected\ocwvspace{}active\ocwvspace{}form:\ocwvspace{}"}~\^{}~$\ocwlowerid{entry})~$\ocweol
\ocwindent{6.50em}
\ocwkw{else}~$\ocwlowerid{compute\_thematic\_middle}~\ocwlowerid{gana}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwupperid{Ubha}~\rightarrow{}~$\ocweol
\ocwindent{6.50em}
\ocwkw{let}~$\ocwlowerid{thirda}~=~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~$\ocwlowerid{third}~$\ocwkw{else}~$[\,]$\ocweol
\ocwindent{6.50em}
\ocwkw{and}~$\ocwlowerid{thirdm}~=~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~$[\,]~$\ocwkw{else}~$\ocwlowerid{third}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{6.50em}
\{~$\ocwlowerid{compute\_thematic\_active}~\ocwlowerid{gana}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{thirda}$\ocweol
\ocwindent{6.50em}
;~$\ocwlowerid{compute\_thematic\_middle}~\ocwlowerid{gana}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{thirdm}$\ocweol
\ocwindent{6.50em}
\}\ocweol
\ocwindent{4.50em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{2.50em}
\ocwkw{match}~$\ocwlowerid{gana}~$\ocwkw{with}\ocweol
\ocwindent{2.50em}
$[~1~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{6.00em}
$[~$\ocwstring{"kram"}~$\rightarrow{}~$\ocwkw{do}~\ocwbc{} 2 forms Whitney§745d \ocwec{}\ocweol
\ocwindent{7.50em}
\{~$\ocwlowerid{compute\_thematic\_present}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{7.50em}
;~$\ocwlowerid{compute\_thematic\_present}~(\ocwlowerid{revcode}~$\ocwstring{"kraam"}$)~$\ocwbc{} lengthen \ocwec{}\ocweol
\ocwindent{7.50em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"cam"}~$\rightarrow{}~$\ocwkw{do}~\ocwbc{} 2 forms Whitney§745d \ocwec{}\ocweol
\ocwindent{7.50em}
\{~$\ocwlowerid{compute\_thematic\_present}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{7.50em}
;~$\ocwlowerid{compute\_thematic\_present}~(\ocwlowerid{revcode}~$\ocwstring{"caam"}$)~$\ocwbc{} lengthen \ocwec{}\ocweol
\ocwindent{7.50em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"t.rr"}~$\rightarrow{}~$\ocwkw{do}~\ocwbc{} 2 forms \ocwec{}\ocweol
\ocwindent{7.50em}
\{~$\ocwlowerid{compute\_thematic\_present}~(\ocwlowerid{revcode}~$\ocwstring{"tir"}$)~$\ocweol
\ocwindent{7.50em}
;~$\ocwlowerid{compute\_thematic\_present}~(\ocwlowerid{revcode}~$\ocwstring{"tar"}$)~$\ocweol
\ocwindent{7.50em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"manth"}~$\rightarrow{}~$\ocwkw{do}~\ocwbc{} 2 forms \ocwec{}\ocweol
\ocwindent{7.50em}
\{~$\ocwlowerid{compute\_thematic\_present}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{7.50em}
;~$\ocwlowerid{compute\_thematic\_present}~(\ocwlowerid{revcode}~$\ocwstring{"math"}$)~$\ocwbc{} suppr nasal \ocwec{}\ocweol
\ocwindent{7.50em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"a\~{}nc"}~$\rightarrow{}~$\ocwkw{do}~\ocwbc{} 2 forms \ocwec{}\ocweol
\ocwindent{7.50em}
\{~$\ocwlowerid{compute\_thematic\_present}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{7.50em}
;~$\ocwlowerid{compute\_thematic\_present}~(\ocwlowerid{revcode}~$\ocwstring{"ac"}$)~$\ocwbc{} suppr nasal \ocwec{}\ocweol
\ocwindent{7.50em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"uuh"}~$\rightarrow{}~$\ocwkw{do}~\ocwbc{} 2 forms \ocwec{}\ocweol
\ocwindent{7.50em}
\{~$\ocwlowerid{compute\_thematic\_present}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{7.50em}
\ocwbc{} \ocwbegindcode{}~$\ocwlowerid{compute\_thematic\_middle}~1~\ocwupperid{Primary}~(\ocwlowerid{strong}~\ocwlowerid{rstem})~\ocwlowerid{entry}~
~($\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~$[\,]~$\ocwkw{else}~$\ocwlowerid{third})~$\ocwenddcode{} \ocwbc{} ohate ved \ocwec{} \ocwec{}\ocweol
\ocwindent{7.50em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"huu"}~$\rightarrow{}~$\ocwkw{do}~\ocwbc{} 2 forms \ocwec{}~\ocwbc{} hvayati, havate \ocwec{}\ocweol
\ocwindent{7.50em}
\{~$\ocwlowerid{compute\_thematic\_present}~(\ocwlowerid{revcode}~$\ocwstring{"hve"}$)~$\ocweol
\ocwindent{7.50em}
;~$\ocwlowerid{compute\_thematic\_middle}~1~\ocwupperid{Primary}~(\ocwlowerid{revcode}~$\ocwstring{"hav"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{10.00em}
$($\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~$[\,]~$\ocwkw{else}~$\ocwlowerid{third})~$\ocwbc{} havate \ocwec{}\ocweol
\ocwindent{7.50em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{7.00em}
$[~$\ocwstring{".r"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{".rcch"}~\ocwbc{} \Pan{7,3,78} Whitney§747 \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"gam"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"gacch"}~\ocwbc{} \Pan{7,3,77} Whitney§747 \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"yam"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"yacch"}~\ocwbc{} \Pan{7,3,77} \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"yu\#2"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"yucch"}~\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"kuc"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"ku\~{}nc"}~\ocwbc{} add nasal \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"da.mz"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"daz"}~\ocwbc{} suppr penult nasal \Pan{6,4,25} \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"ra\~{}nj"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"raj"}~\ocwbc{} id \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"sa\~{}nj"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"saj"}~\ocwbc{} id \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"sva\~{}nj"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"svaj"}~\ocwbc{} id \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"daa\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"dad"}~\ocwbc{} dupl Whitney§672 ved \ocwec{}\ocweol
\ocwindent{8.50em}
\ocwbc{} \Pan{7,3,78}: yacch for prayacch in meaning of giving  \ocwec{}\ocweol
\ocwindent{8.50em}
\ocwbc{} also \ocwstring{"s.r"}  -> \ocwstring{"dhau"} (corresponds to dhaav1)
                         \ocwstring{"dmaa"} -> \ocwstring{"dham"} (cf ppstem) \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"dhaa\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"dadh"}~\ocwbc{} id \ocwec{}~\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"paa\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"pib"}~\ocwbc{} fake 3rd gana \Pan{7,3,78} \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"ghraa"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"jighr"}~\ocwbc{} id \Pan{7,3,78} \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"sthaa\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"ti.s.th"}~\ocwbc{} id \Pan{7,3,78} \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"d.rh"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"d.r.mh"}~\ocwbc{} .rh -> .r.mh \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"b.rh\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"b.r.mh"}~\ocwbc{} WR; Bucknell adds barhati \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"iir.s"}~$\mid{}~$\ocwstring{"gaa\#2"}~\ocwbc{} = gai \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"daa\#3"}~$\mid{}~$\ocwstring{"dyaa"}~$\mid{}~$\ocwstring{"dhyaa"}~$\mid{}~$\ocwstring{"pyaa"}~\ocwbc{} = pyai \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"zu.s"}~$\mid{}~$\ocwstring{"zyaa"}~$\mid{}~$\ocwstring{"sphaa"}~$\rightarrow{}~[~42~$\ocwbc{} y \ocwec{}~::~$\ocwlowerid{rstem}~]~$\ocwbc{} add y \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"maa\#4"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"may"}~\ocwbc{} shorten add y \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"vyaa"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"vyay"}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"zuu"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"zve"}~\ocwbc{} zvayati - similar to huu/hve \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"guh"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"guuh"}~\ocwbc{} lengthen \Pan{6,4,89} \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"grah"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"g.rh.n"}~\ocwbc{} WR \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"das"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"daas"}~\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"mnaa"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"man"}~\ocwbc{} \Pan{7,3,78} \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"zad"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"ziiy"}~\ocwbc{} \Pan{7,3,78} \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"sad\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"siid"}~\ocwbc{} \Pan{7,3,78} \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{".sad"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{".siid"}~\ocwbc{} fictive retro-root of sad1 \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"m.rj"}~$\rightarrow{}~\ocwlowerid{mrijify}~(\ocwlowerid{revcode}~$\ocwstring{"maarj"}$)~$\ocwbc{} vriddhi \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"yaj\#1"}~$\mid{}~$\ocwstring{"vraj"}~$\mid{}~$\ocwstring{"raaj\#1"}~$\mid{}~$\ocwstring{"bhraaj"}~$\rightarrow{}~\ocwlowerid{mrijify}~\ocwlowerid{rstem}$\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"kliiba"}~$\mid{}~$\ocwstring{"puula"}~$\rightarrow{}~$\ocwbc{} kliibate etc \ocwec{}~\ocwbc{} denominative verbs \ocwec{}\ocweol
\ocwindent{9.00em}
$\ocwupperid{Phonetics.}\ocwlowerid{trunc\_a}~\ocwlowerid{rstem}~$\ocwbc{} since thematic a added \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~$\ocwstring{"k.rp"}~$\rightarrow{}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{strong}~\ocwlowerid{rstem}~$\ocwbc{} default \ocwec{}\ocweol
\ocwindent{7.00em}
$]~$\ocwkw{in}~$\ocwlowerid{compute\_thematic\_present}~\ocwlowerid{stem}~$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~4~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{weak}~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~$\ocwstring{"bhra.mz"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"bhraz"}~\ocwbc{} suppr penult nasal \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"ra\~{}nj"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"raj"}~\ocwbc{} id \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"i"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"ii"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"jan"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"jaa"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"kan"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"kaa"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"klam"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"klaam"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"j.rr"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"jiir"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"jyaa\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"jii"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"tam"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"taam"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"dam\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"daam"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"daa\#2"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"d"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"d.rz\#1"}~$\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Not\_attested}~$\ocwbc{} replaced by paz \Pan{7,3,78} \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"dhaa\#2"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"dha"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"bhram"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"bhraam"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"mad\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"maad"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"mid"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"med"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"ri"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"rii"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"vaa\#3"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"va"}~\ocwbc{} bizarre - should be ve class 1 \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"vyadh"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"vidh"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"zam\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"zaam"}~\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"zam\#2"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"zama"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"zaa"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"z"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"zram"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"zraam"}\ocweol
\ocwindent{6.00em}
$\mid{}~$\ocwstring{"saa\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"s"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{rstem}$\ocweol
\ocwindent{6.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{ystem}~=~[~42~::~\ocwlowerid{weak}~]~$\ocwbc{} root-y \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{4.50em}
$\ocwlowerid{compute\_thematic\_present}~\ocwlowerid{ystem}~$\ocweol
\ocwindent{2.50em}
$\mid{}~6~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~3~::~\ocwlowerid{rest}~]~\mid{}~[~4~::~\ocwlowerid{rest}~]\rightarrow{}~[~42~::~[~3~::~\ocwlowerid{rest}~]~]~$\ocweol
\ocwindent{7.00em}
\ocwbc{} -.i -> -iy eg \ocwbegindcode{}$\ocwlowerid{k}.\ocwlowerid{si}$\ocwenddcode{} \ocwbegindcode{}$\ocwlowerid{pi}\#2$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~5~::~\ocwlowerid{rest}~]~\mid{}~[~6~::~\ocwlowerid{rest}~]~\rightarrow{}~[~45~::~[~5~::~\ocwlowerid{rest}~]~]~$\ocweol
\ocwindent{7.00em}
\ocwbc{} -.u -> -uv eg \ocwbegindcode{}$\ocwlowerid{dhru}$\ocwenddcode{} also kuu -> kuv \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~7~::~\ocwlowerid{rest}~]~\rightarrow{}~[~42~::~[~3~::~[~43~::~\ocwlowerid{rest}~]~]~]~$\ocwbc{} mriyate \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~[~8~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{9.50em}
$[~$\ocwstring{"p.rr"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"p.r.n"}~\ocwbc{} ugly duckling \ocwec{}\ocweol
\ocwindent{9.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~43~::~[~3~::~\ocwlowerid{rest}~]~]~$\ocwbc{} .rr/ir \ocwec{}\ocweol
\ocwindent{9.50em}
$]$\ocweol
\ocwindent{7.00em}
\ocwbc{} -.rr -> -ir eg \ocwbegindcode{}$\ocwlowerid{t}.\ocwlowerid{rr}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{9.50em}
$[~$\ocwstring{"i.s\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"icch"}~\ocwbc{} \Pan{7,3,78} \ocwec{}\ocweol
\ocwindent{9.50em}
$\mid{}~$\ocwstring{"vas\#4"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"ucch"}\ocweol
\ocwindent{9.50em}
$\mid{}~$\ocwstring{".rj"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{".r\~{}nj"}~\ocweol
\ocwindent{9.50em}
$\mid{}~$\ocwstring{"k.rt\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"k.rnt"}~\ocweol
\ocwindent{9.50em}
$\mid{}~$\ocwstring{"piz\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"pi.mz"}\ocweol
\ocwindent{9.50em}
$\mid{}~$\ocwstring{"muc\#1"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"mu\~{}nc"}\ocweol
\ocwindent{9.50em}
$\mid{}~$\ocwstring{"rudh\#2"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"rundh"}\ocweol
\ocwindent{9.50em}
$\mid{}~$\ocwstring{"sic"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"si\~{}nc"}\ocweol
\ocwindent{9.50em}
$\mid{}~$\ocwstring{"lip"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"limp"}\ocweol
\ocwindent{9.50em}
$\mid{}~$\ocwstring{"lup"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"lump"}\ocweol
\ocwindent{9.50em}
$\mid{}~$\ocwstring{"vid\#2"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"vind"}\ocweol
\ocwindent{9.50em}
$\mid{}~$\ocwstring{"praz"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"p.rcch"}~\ocwbc{} ra/.r \ocwec{}\ocweol
\ocwindent{9.50em}
$\mid{}~$\ocwstring{"vrazc"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"v.rzc"}~\ocwbc{} id déploiement vocalique \ocwec{}\ocweol
\ocwindent{9.50em}
$\mid{}~$\ocwstring{"s.rj"}~$\rightarrow{}~\ocwlowerid{mrijify}~\ocwlowerid{rstem}$\ocweol
\ocwindent{9.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{rstem}~$\ocwbc{} root stem \ocwec{}\ocweol
\ocwindent{9.50em}
$]$\ocweol
\ocwindent{6.00em}
$]~$\ocwkw{in}~$\ocwlowerid{compute\_thematic\_present}~\ocwlowerid{stem}~$\ocweol
\ocwindent{2.50em}
$\mid{}~10~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{process10}~\ocwlowerid{y\_stem}~=~$\ocwkw{do}\ocweol
\ocwindent{8.50em}
\{~$\ocwlowerid{compute\_thematic\_present}~\ocwlowerid{y\_stem}~$\ocweol
\ocwindent{8.50em}
;~$\ocwlowerid{build\_perpft}~\ocwupperid{Primary}~\ocwlowerid{y\_stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{8.50em}
;~\ocwkw{let}~$\ocwlowerid{perstem}~=~[~3~::~\ocwlowerid{y\_stem}~]~$\ocwbc{} -ayi \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{9.50em}
$\ocwlowerid{perif}~\ocwupperid{Primary}~\ocwlowerid{perstem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{8.50em}
\}~\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"tul"}~$\rightarrow{}~$\ocwkw{do}~\ocwbc{} 2 forms \ocwec{}\ocweol
\ocwindent{6.00em}
\{~$\ocwlowerid{process10}~(\ocwlowerid{revcode}~$\ocwstring{"tulay"}$)$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{process10}~(\ocwlowerid{revcode}~$\ocwstring{"tolay"}$)~$\ocwbc{} guna \ocwec{}\ocweol
\ocwindent{6.00em}
\}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"gup"}~$\rightarrow{}~\ocwlowerid{process10}~(\ocwlowerid{revcode}~$\ocwstring{"gopay"}$)~$\ocwbc{} guna \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"mid"}~$\rightarrow{}~\ocwlowerid{process10}~(\ocwlowerid{revcode}~$\ocwstring{"minday"}$)~$\ocwbc{} nasal \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{base\_stem}~=~\ocwlowerid{strengthen\_10}~\ocwlowerid{rstem}~\ocwlowerid{entry}~$\ocwkw{in}~\ocweol
\ocwindent{7.50em}
\ocwkw{let}~$\ocwlowerid{ystem}~=~\ocwlowerid{rev}~(\ocwlowerid{sandhi}~\ocwlowerid{base\_stem}~[~1;~42~]~$\ocwbc{} ay \ocwec{}$)~$\ocwkw{in}~\ocweol
\ocwindent{7.50em}
$\ocwlowerid{process10}~\ocwlowerid{ystem}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Anomaly\ocwvspace{}Verbs"}\ocweol
\ocwindent{2.50em}
$]~$\ocwbc{} end of thematic conjugation \ocwec{}~\ocweol
\ocwindent{1.50em}
$\mid{}~2~\rightarrow{}~$\ocwbc{} athematic conjugation: 2nd class (root class) \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{set}~=~\ocwlowerid{intercalate\_2}~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.50em}
\ocwkw{and}~$\ocwlowerid{sstem}~=~\ocwlowerid{strong\_stem}~\ocwlowerid{entry}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{2.50em}
\ocwkw{and}~$\ocwlowerid{wstem}~=~$\ocwkw{if}~$\ocwlowerid{entry}=$\ocwstring{"as\#1"}~\ocwkw{then}~$[~48~]~$\ocwkw{else}~$\ocwlowerid{weak\_stem}~\ocwlowerid{entry}~\ocwlowerid{rstem}~$\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{2.50em}
\{~\ocwkw{match}~$\ocwlowerid{voices\_of\_gana}~2~\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Para}~\rightarrow{}~$\ocwbc{} active only \ocwec{}~\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}\ocweol
\ocwindent{5.00em}
$\ocwlowerid{compute\_active\_present2}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{set}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{emit\_warning}~($\ocwstring{"Unexpected\ocwvspace{}middle\ocwvspace{}form:\ocwvspace{}"}~\^{}~$\ocwlowerid{entry})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Atma}~$\ocwbc{} middle only \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{padam}~$\ocwkw{then}~$\ocwlowerid{emit\_warning}~($\ocwstring{"Unexpected\ocwvspace{}active\ocwvspace{}form:\ocwvspace{}"}~\^{}~$\ocwlowerid{entry})$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{compute\_middle\_present2}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{set}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Ubha}~\rightarrow{}$\ocweol
\ocwindent{5.00em}
\ocwkw{let}~$\ocwlowerid{thirda}~=~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~$\ocwlowerid{third}~$\ocwkw{else}~$[\,]$\ocweol
\ocwindent{5.00em}
\ocwkw{and}~$\ocwlowerid{thirdm}~=~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~$[\,]~$\ocwkw{else}~$\ocwlowerid{third}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{5.00em}
\{~$\ocwlowerid{compute\_active\_present2}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{set}~\ocwlowerid{entry}~\ocwlowerid{thirda}$\ocweol
\ocwindent{5.00em}
;~$\ocwlowerid{compute\_middle\_present2}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{set}~\ocwlowerid{entry}~\ocwlowerid{thirdm}$\ocweol
\ocwindent{5.00em}
\}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.50em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} special cases \ocwec{}\ocweol
\ocwindent{3.50em}
$[~$\ocwstring{"as\#1"}~$\rightarrow{}~$\ocwbc{} rare middle forms of as \ocwec{}\ocweol
\ocwindent{4.50em}
$\ocwlowerid{compute\_athematic\_present2m}~\ocwlowerid{sstem}~[~48~]~\ocwlowerid{set}~\ocwlowerid{entry}~(\ocwlowerid{code}~$\ocwstring{"ste"}$)$\ocweol
\ocwindent{0.00em}
\ocwbc{}\ocwbegindcode{}~$\mid{}~$\ocwstring{"vac"}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{weak}~=~\ocwlowerid{revcode}~$\ocwstring{"vaz"}~$(\times{}~\ocwlowerid{douteux}~-\ocwupperid{WR}~\times{})~$\ocwkw{in}
~$\ocwlowerid{compute\_athematic\_present2m}~\ocwlowerid{sstem}~\ocwlowerid{weak}~\ocwlowerid{set}~\ocwlowerid{entry}~[\,]~$\ocwenddcode{}\ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.50em}
\}\ocweol
\ocwindent{1.50em}
$\mid{}~3~\rightarrow{}~$\ocwkw{let}~$(\ocwlowerid{sstem},\ocwlowerid{wstem},\ocwlowerid{iiflag})~=~\ocwlowerid{redup3}~\ocwlowerid{entry}~\ocwlowerid{rstem}~$\ocwkw{in}\ocweol
\ocwindent{5.00em}
\ocwkw{match}~$\ocwlowerid{voices\_of\_gana}~3~\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Para}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}\ocweol
\ocwindent{5.00em}
$\ocwlowerid{compute\_active\_present3}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{emit\_warning}~($\ocwstring{"Unexpected\ocwvspace{}middle\ocwvspace{}form:\ocwvspace{}"}~\^{}~$\ocwlowerid{entry})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Atma}~\rightarrow{}~$\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{padam}~$\ocwkw{then}~$\ocwlowerid{emit\_warning}~($\ocwstring{"Unexpected\ocwvspace{}active\ocwvspace{}form:\ocwvspace{}"}~\^{}~$\ocwlowerid{entry})$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{compute\_middle\_present3}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Ubha}~\rightarrow{}$\ocweol
\ocwindent{5.00em}
\ocwkw{let}~$\ocwlowerid{thirda}~=~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~$\ocwlowerid{third}~$\ocwkw{else}~$[\,]$\ocweol
\ocwindent{5.00em}
\ocwkw{and}~$\ocwlowerid{thirdm}~=~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~$[\,]~$\ocwkw{else}~$\ocwlowerid{third}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{5.00em}
\{~$\ocwlowerid{compute\_active\_present3}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~\ocwlowerid{thirda}$\ocweol
\ocwindent{5.00em}
;~$\ocwlowerid{compute\_middle\_present3}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{iiflag}~\ocwlowerid{entry}~\ocwlowerid{thirdm}$\ocweol
\ocwindent{5.00em}
\}\ocweol
\ocwindent{3.50em}
$]~$\ocweol
\ocwindent{1.50em}
$\mid{}~5~\rightarrow{}~$\ocwbc{} athematic conjugation: 5th class \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$(\ocwlowerid{stem},\ocwlowerid{vow})~=~$\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}~\ocweol
\ocwindent{4.50em}
$[~[~36;~3~]~$\ocwbc{} in \ocwec{}~$\rightarrow{}~([~3~]~$\ocwbc{} i \ocwec{},$\ocwupperid{True})~$\ocwbc{} Whitney §716a \ocwec{}\ocweol
\ocwindent{4.50em}
$\mid{}~[~5;~43;~46~]~$\ocwbc{} zru \ocwec{}~$\rightarrow{}~([~7;~46~]~$\ocwbc{} z.r \ocwec{},$\ocwupperid{True})~$\ocweol
\ocwindent{4.50em}
$\mid{}~[~40~::~[~41~::~\ocwlowerid{r}~]~]~\rightarrow{}~([~40~::~\ocwlowerid{r}~],\ocwupperid{False})~$\ocwbc{} skambh -> skabh \ocwec{}\ocweol
\ocwindent{5.50em}
\ocwbc{} possibly other penultimate nasal lopa ? \ocwec{}\ocweol
\ocwindent{4.50em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{vowel}~\ocwlowerid{c}~$\ocwkw{then}~$([~\ocwlowerid{short}~\ocwlowerid{c}~::~\ocwlowerid{rest}~],\ocwupperid{True})$\ocweol
\ocwindent{14.00em}
\ocwkw{else}~$(\ocwlowerid{rstem},\ocwupperid{False})~$\ocweol
\ocwindent{4.50em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_empty}~28$\ocweol
\ocwindent{4.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{wstem}~=~\ocwlowerid{rev}~(\ocwlowerid{sandhi}~\ocwlowerid{stem}~[~36;~5~])~$\ocwbc{} stem-nu \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{and}~$\ocwlowerid{sstem}~=~\ocwlowerid{rev}~(\ocwlowerid{sandhi}~\ocwlowerid{stem}~[~36;~12~])~$\ocwbc{} stem-no \ocwec{}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{compute\_present5}~5~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{vow}~\ocwlowerid{entry}~\ocwlowerid{third}~\ocwlowerid{pada}~\ocwlowerid{padam}$\ocweol
\ocwindent{2.50em}
;~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"v.r\#1"}~\ocwkw{then}~\ocwbc{} extra derivation \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{let}~$\ocwlowerid{wstem}~=~\ocwlowerid{revcode}~$\ocwstring{"uur.nu"}~\ocwkw{and}~$\ocwlowerid{sstem}~=~\ocwlowerid{revcode}~$\ocwstring{"uur.no"}~\ocwkw{in}~\ocweol
\ocwindent{5.00em}
$\ocwlowerid{compute\_present5}~5~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwupperid{True}~\ocwlowerid{entry}~\ocwlowerid{third}~\ocwlowerid{pada}~\ocwlowerid{padam}$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~$()$\ocweol
\ocwindent{2.50em}
\}\ocweol
\ocwindent{1.50em}
$\mid{}~7~\rightarrow{}~$\ocwbc{} athematic conjugation: 7th class \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{rest}~]~$\ocwkw{when}~$\ocwlowerid{consonant}~\ocwlowerid{c}~\rightarrow{}$\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{rest}~$\ocwkw{with}~\ocweol
\ocwindent{5.50em}
$[~[~\ocwlowerid{hd}~::~\ocwlowerid{tl}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{nasal}~\ocwlowerid{hd}~$\ocwkw{then}~$\ocwlowerid{tl}~$\ocwkw{else}~$\ocwlowerid{rest}~$\ocwbc{} hi.ms \ocwec{}\ocweol
\ocwindent{5.50em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_empty}~29$\ocweol
\ocwindent{5.50em}
$]~$\ocweol
\ocwindent{3.50em}
\ocwkw{and}~$\ocwlowerid{nasal}~=~\ocwlowerid{homonasal}~\ocwlowerid{c}~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{wstem}~=~[~\ocwlowerid{c}~::~\ocwlowerid{rev}~(\ocwlowerid{sandhi}~\ocwlowerid{stem}~[~\ocwlowerid{nasal}~])~]~$\ocwbc{} stem-n \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwkw{and}~$\ocwlowerid{sstem}~=~[~\ocwlowerid{c}~::~\ocwlowerid{rev}~(\ocwlowerid{sandhi}~\ocwlowerid{stem}~[~36;~1~])~]~$\ocwbc{} stem-na \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{3.50em}
$\ocwlowerid{compute\_present7}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{entry}~\ocwlowerid{third}~\ocwlowerid{pada}~\ocwlowerid{padam}$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{warning}~(\ocwlowerid{entry}~$\^{}~\ocwstring{"\ocwvspace{}atypic\ocwvspace{}7\symbol{92}n"}$)$\ocweol
\ocwindent{2.50em}
$]$\ocweol
\ocwindent{1.50em}
$\mid{}~8~\rightarrow{}~$\ocwbc{} k.r1 k.san tan1 man san1 \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~[~36~$\ocwbc{} n \ocwec{}~::~$\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{wstem}~=~\ocwlowerid{rev}~(\ocwlowerid{sandhi}~\ocwlowerid{rest}~[~36;~5~])~$\ocwbc{} stem-nu \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwkw{and}~$\ocwlowerid{sstem}~=~\ocwlowerid{rev}~(\ocwlowerid{sandhi}~\ocwlowerid{rest}~[~36;~12~])~$\ocwbc{} stem-no \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{3.50em}
$\ocwlowerid{compute\_present5}~8~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwupperid{True}~\ocwlowerid{entry}~\ocwlowerid{third}~\ocwlowerid{pada}~\ocwlowerid{padam}$\ocweol
\ocwindent{2.50em}
$\mid{}~[~7;~17~]~$\ocwbc{} k.r \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{wstem}~=~\ocwlowerid{revcode}~$\ocwstring{"kuru"}\ocweol
\ocwindent{3.50em}
\ocwkw{and}~$\ocwlowerid{short}~=~\ocwlowerid{revcode}~$\ocwstring{"kur"}~\ocwbc{} before suffix -m -y -v Macdonell§134E \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwkw{and}~$\ocwlowerid{sstem}~=~\ocwlowerid{revcode}~$\ocwstring{"karo"}~\ocwkw{in}\ocweol
\ocwindent{3.50em}
$\ocwlowerid{compute\_presentk}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{warning}~(\ocwlowerid{entry}~$\^{}~\ocwstring{"\ocwvspace{}atypic\ocwvspace{}8\symbol{92}n"}$)$\ocweol
\ocwindent{2.50em}
$]$\ocweol
\ocwindent{1.50em}
$\mid{}~9~\rightarrow{}~$\ocwkw{let}~$(\ocwlowerid{stem},\ocwlowerid{vow})~=~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} vow = vowel ending root \ocwec{}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"j\~{}naa\#1"}~$\rightarrow{}~(\ocwlowerid{revcode}~$\ocwstring{"jaa"}~,$\ocwupperid{True})~$\ocwbc{} \Pan{7,3,79} \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"jyaa\#1"}~$\rightarrow{}~(\ocwlowerid{revcode}~$\ocwstring{"ji"}~,$\ocwupperid{True})$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"umbh"}~$\rightarrow{}~(\ocwlowerid{revcode}~$\ocwstring{"ubh"}~,$\ocwupperid{False})~$\ocwbc{} elision penul nasal \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"granth"}~$\rightarrow{}~(\ocwlowerid{revcode}~$\ocwstring{"grath"},$\ocwupperid{False})~$\ocwbc{} id \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"bandh"}~$\rightarrow{}~(\ocwlowerid{revcode}~$\ocwstring{"badh"}~,$\ocwupperid{False})~$\ocwbc{} id \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"skambh"}~$\rightarrow{}~(\ocwlowerid{revcode}~$\ocwstring{"skabh"},$\ocwupperid{False})~$\ocwbc{} id \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"stambh"}~$\rightarrow{}~(\ocwlowerid{revcode}~$\ocwstring{"stabh"},$\ocwupperid{False})~$\ocwbc{} id \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"grah"}~$\rightarrow{}~(\ocwlowerid{revcode}~$\ocwstring{"g.rh"}~,$\ocwupperid{False})~$\ocwbc{} plus \ocwstring{"g.rbh"} added below \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"k.sii"}~$\rightarrow{}~(\ocwlowerid{revcode}~$\ocwstring{"k.si"}~,$\ocwupperid{True})$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}~\ocweol
\ocwindent{6.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{w}~]~\rightarrow{}~(\ocwlowerid{st},\ocwlowerid{vowel}~\ocwlowerid{c})~$\ocweol
\ocwindent{7.00em}
$\ocwlowerid{where}~\ocwlowerid{st}~=~$\ocwkw{if}~$\ocwlowerid{c}=6~$\ocwbc{} uu \ocwec{}~\ocwkw{then}~$[~5~::~\ocwlowerid{w}~]~$\ocwbc{} Whitney§728a \ocwec{}\ocweol
\ocwindent{12.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{c}=8~$\ocwbc{} .rr \ocwec{}~\ocwkw{then}~$[~7~::~\ocwlowerid{w}~]~$\ocweol
\ocwindent{12.50em}
\ocwkw{else}~$\ocwlowerid{rstem}$\ocweol
\ocwindent{6.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{error\_empty}~30$\ocweol
\ocwindent{6.00em}
$]~$\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}~\ocwbc{} Macdonell§127.6 \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwbc{} NB Retroflexion prevented in k.subh: k.subhnaati \Pan{8,4,39} - TODO \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{retn}~=~$\ocwkw{if}~$\ocwupperid{Int\_sandhi.}\ocwlowerid{retron}~\ocwlowerid{stem}~$\ocwkw{then}~31~\ocwbc{} .n \ocwec{}~\ocwkw{else}~36~\ocwbc{} n \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{sstem}~=~\ocwlowerid{rev}~(\ocwlowerid{sandhi}~\ocwlowerid{stem}~[~36;~2~])~$\ocwbc{} stem-naa \ocwec{}~\ocwbc{} naa accented \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{and}~$\ocwlowerid{wstem}~=~\ocwlowerid{rev}~(\ocwlowerid{sandhi}~\ocwlowerid{stem}~[~36;~4~])~$\ocwbc{} stem-nii \ocwec{}~\ocwbc{} nii unaccented \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{and}~$\ocwlowerid{short}~=~[~\ocwlowerid{retn}~::~\ocwlowerid{stem}~]~$\ocwbc{} stem-n \ocwec{}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{compute\_present9}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{vow}~\ocwlowerid{stem}~\ocwlowerid{entry}~\ocwlowerid{third}~\ocwlowerid{pada}~\ocwlowerid{padam}$\ocweol
\ocwindent{2.50em}
;~\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"grah"}~\ocwkw{then}~\ocwbc{} ved alternative form \ocwstring{"g.rbh"} Vt1 \Pan{8,2,35} \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~$\ocwstring{"g.rbh"}~\ocwkw{in}~\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{sstem}~=~\ocwlowerid{rev}~(\ocwlowerid{sandhi}~\ocwlowerid{stem}~[~36;~2~])~$\ocwbc{} stem-naa \ocwec{}~\ocweol
\ocwindent{4.50em}
\ocwkw{and}~$\ocwlowerid{wstem}~=~\ocwlowerid{rev}~(\ocwlowerid{sandhi}~\ocwlowerid{stem}~[~36;~4~])~$\ocwbc{} stem-nii \ocwec{}~\ocweol
\ocwindent{4.50em}
\ocwkw{and}~$\ocwlowerid{short}~=~[~31~::~\ocwlowerid{stem}~]~$\ocwbc{} stem-.n \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{4.50em}
$\ocwlowerid{compute\_present9}~\ocwlowerid{sstem}~\ocwlowerid{wstem}~\ocwlowerid{short}~\ocwlowerid{vow}~\ocwlowerid{stem}~\ocwlowerid{entry}~[\,]~\ocwlowerid{pada}~\ocwlowerid{padam}$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~$()$\ocweol
\ocwindent{2.50em}
\}\ocweol
\ocwindent{1.50em}
$\mid{}~0~\rightarrow{}~()~$\ocwbc{} secondary conjugations - unused in this version \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Illegal\ocwvspace{}present\ocwvspace{}class"}\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwupperid{Not\_attested}~\rightarrow{}~()~]$\ocweol
\ocwindent{0.00em}
\ocwbc{} end Present system \ocwec{}~\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Passive system 
\ocweol
\ocwindent{0.00em}
NB. For gana 4 verbs passive differs from middle mostly by accent
   but distinction necessary since different regime 
\ocweol
\label{verbs.ml:198093}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_passive\_primary}~\ocwlowerid{entry}~\ocwlowerid{ps\_stem}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{admits\_passive}~\ocwlowerid{entry}~$\ocwkw{then}~$\ocwlowerid{compute\_passive}~\ocwupperid{Primary}~\ocwlowerid{entry}~\ocwlowerid{ps\_stem}~$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~$()$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Passive future participle (gerundive) in -ya and -aniiya \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_pfp}~\ocwlowerid{entry}~\ocwlowerid{rstem}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~\ocwkw{try}~$\ocwlowerid{pfp\_ya}~\ocwlowerid{rstem}~\ocwlowerid{entry}~$\ocwkw{with}~$[~\ocwupperid{Not\_attested}~\rightarrow{}~()~]$\ocweol
\ocwindent{1.00em}
;~\ocwkw{try}~$\ocwlowerid{pfp\_aniiya}~\ocwlowerid{rstem}~\ocwlowerid{entry}~$\ocwkw{with}~$[~\ocwupperid{Not\_attested}~\rightarrow{}~()~]$\ocweol
\ocwindent{1.00em}
;~\ocwbc{} Supplements \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{record\_extra\_pfp\_ya}~\ocwlowerid{form}~=~$\ocweol
\ocwindent{4.00em}
$\ocwlowerid{record\_part}~(\ocwupperid{Pfutp\_}~\ocwupperid{Primary}~(\ocwlowerid{revcode}~\ocwlowerid{form})~\ocwlowerid{entry})~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"k.r\#1"}~\ocwbc{} \Pan{3,1,120} .duk.r~n + kyap \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"stu"}~$\mid{}~$\ocwstring{"bh.r"}~$\mid{}~$\ocwstring{"i"}~$\mid{}~$\ocwstring{"m.r"}~$\rightarrow{}~$\ocwbc{} \Pan{3,1,109} Renou§155e \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwbc{} intercalate t after roots ending in short vowel Renou§146 \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pfp\_tya}~=~\ocwlowerid{rfix}~\ocwlowerid{rstem}~$\ocwstring{"tya"}~\ocwkw{in}~\ocwbc{} k.rtya stutya bh.rtya itya m.rtya \ocwec{}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{record\_part}~(\ocwupperid{Pfutp\_}~\ocwupperid{Primary}~\ocwlowerid{pfp\_tya}~\ocwlowerid{entry})$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"ju.s"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"ju.sya"}~\ocwbc{} jo.sya \Pan{3,1,109} \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"khan"}~$\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"khaanya"}~\ocwbc{} add to khanya \Pan{3,1,123} \ocwec{}\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"kheya"}~\ocwbc{} further \Pan{3,1,111} \ocwec{}\ocweol
\ocwindent{3.00em}
\}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"ji"}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"jitya"}~\ocwbc{} Renou§155e \Pan{3,1,117} \ocwec{}\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"jayya"}~\ocwbc{} (jeya) \Pan{6,1,81} \ocwec{}\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"k.sii"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"k.sayya"}~\ocwbc{} (k.seya) \Pan{6,1,81} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"grah"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"g.rhya"}~\ocwbc{} \Pan{3,1,119} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"cuu.s"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"co.sya"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"ci"}~$\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{3.50em}
\{~$\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"caayya"}\ocweol
\ocwindent{4.50em}
\ocwbc{} \Pan{3,1,131} fire only with pari- upa- sam- \ocwec{}\ocweol
\ocwindent{3.50em}
;~$\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"citya"}~\ocwbc{} \Pan{3,1,131} in sense of fire \ocwec{}\ocweol
\ocwindent{3.50em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vad"}~$\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"udya"}~\ocwbc{} \Pan{3,1,106} for brahmodya \ocwec{}\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"vadya"}~\ocwbc{} id for brahmavadya sn \ocwec{}\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"bhuu\#1"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"bhaavya"}~\ocwbc{} (bhavya) \Pan{3,1,123} \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwbc{} NB \ocwstring{"bhuuya"} is lexicalized as noun - \Pan{3,1,107} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"m.rj"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"m.rjya"}~\ocwbc{} (maargya) \Pan{3,1,113} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"yuj\#1"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"yugya"}~\ocwbc{} (yogya) \Pan{3,1,121} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"v.r\#2"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"vare.nya"}~\ocwbc{} vara.niiya (-aniiya) \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"guh"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"guhya"}~\ocwbc{} Vart \Pan{3,1,109} \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"duh\#1"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"duhya"}~\ocwbc{} idem \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"za.ms"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"zasya"}~\ocwbc{} idem \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zaas"}~$\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"zi.sya"}~\ocwbc{} \Pan{3,1,109} \ocwec{}\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"za.sya"}~\ocwbc{} (zaasya) \ocwec{}\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{3.00em}
\ocwbc{} Following examples show that gunification is often optional. \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwbc{} Some of the following forms seem actually preferable. \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{".r"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"arya"}~\ocwbc{} (aarya) \Pan{3,1,103} (owner) \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"kup"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"kupya"}~\ocwbc{} (kopya) \Pan{3,1,114} \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"gad"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"gadya"}~\ocwbc{} gaadya for pv- \Pan{3,1,100} \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"car"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"carya"}~\ocwbc{} caarya for pv- \Pan{3,1,100} \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"mad"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"madya"}~\ocwbc{} maadya for pv- \Pan{3,1,100} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"tyaj\#1"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"tyajya"}~\ocwbc{} for sa.mtyajya (tyaajya) \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"bhid\#1"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"bhidya"}~\ocwbc{} \Pan{3,1,115} for river \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"d.rz\#1"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"darzya"}~\ocwbc{} WR only RV. \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"yaj\#1"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"yajya"}~\ocwbc{} devayajya \Pan{3,1,123} \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"yat"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"yatya"}~\ocwbc{} Vart \Pan{3,1,97} -WR \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"ruc\#1"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"rucya"}~\ocwbc{} (rocya) \Pan{3,1,114} \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"va\~{}nc"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"va\~{}ncya"}~\ocwbc{} \Pan{7,3,63} for motion \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vah\#1"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"vahya"}~\ocwbc{} (vaahya) \Pan{3,1,102} instr. \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"v.r.s"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"var.sya"}~\ocwbc{} \Pan{3,1,120} (v.r.sya) \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"sa\~{}nj"}~$\rightarrow{}~\ocwlowerid{record\_extra\_pfp\_ya}~$\ocwstring{"sajya"}~\ocwbc{} for prasajya (not Paninian?) \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwbc{} ? takya catya hasya \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Gana 11. Denominatives 
\ocweol
\ocwindent{0.00em}
Denominative verbs are given ga.na 11, and their stems are computed by
\ocwbegindcode{}$\ocwlowerid{den\_stem\_a}$\ocwenddcode{} and \ocwbegindcode{}$\ocwlowerid{den\_stem\_m}$\ocwenddcode{} below (for Para and Atma respectively).
They are derivative verbs from dative forms of substantives.
Roots kept in ga.na 10 (debatable, this is subject to change), are:
   ka.n.d kath kal kiirt kuts ga.n garh gup gha.t.t cint cur .damb 
   tandr tark tul bharts m.r.d rac rah ruup lok suud sp.rh 
\ocweol
\ocwindent{0.00em}
Also gave.s, because possible ga.na 1 and pp - should be added separately 
\ocweol
\ocwindent{0.00em}
Also lelaa, which has a strange status (marked as verb rather than root) 
\ocweol
\ocwindent{0.00em}
asu is bizarre, lexicalized under asuuya 
\ocweol
\ocwindent{0.00em}
The next two functions are used only by the Grammar interface, the forms
   memorized are computed from the lexicalized 3rd sg form 
\ocweol
\ocwindent{0.00em}
BEWARE. the entry forms given in the next two functions must be in normalized
   form - no non-genuine anusvaara 
   This should be replaced by the recording of the 3rd sg form, like others. 
\ocweol
\label{verbs.ml:202948}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{den\_stem\_a}~\ocwlowerid{entry}~=~$\ocwbc{} in general transitive Whitney§1059c \ocwec{}\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$\ocwlowerid{rstem}~=~\ocwlowerid{revstem}~\ocwlowerid{entry}~$\ocwkw{in}~\ocweol
\ocwindent{1.50em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{1.50em}
$[~$\ocwstring{"putrakaama"}~$\mid{}~$\ocwstring{"rathakaama"}~\ocwbc{} \Pan{3,1,9} \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"pu.spa"}~$\mid{}~$\ocwstring{"sukha"}~$\mid{}~$\ocwstring{"du.hkha"}~\ocwbc{} also \ocwstring{"adhvara"} \ocwstring{"m.rga"} below \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"i.sudhi"}~$\mid{}~$\ocwstring{"gadgada"}~\ocwbc{} \Pan{3,1,27} \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"agada"}~\ocwbc{} Kale§660 \ocwec{}~$\mid{}~$\ocwstring{"iras"}~\ocweol
\ocwindent{3.50em}
$\rightarrow{}~\ocwlowerid{trunc}~\ocwlowerid{rstem}~$\ocwbc{} -()yati \ocwec{}~\ocwbc{} lopa \ocwec{}~\ocweol
\ocwindent{1.50em}
\ocwbc{} \ocwstring{"maarg"} \ocwstring{"mok.s"} \ocwstring{"lak.s"} \ocwstring{"suuc"} presently roots class 10 \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"kutsaa"}~$\mid{}~$\ocwstring{"maalaa"}~$\mid{}~$\ocwstring{"mudraa"}~$\mid{}~$\ocwstring{"medhaa"}~\ocweol
\ocwindent{3.50em}
$\rightarrow{}~[~1~::~\ocwlowerid{trunc\_aa}~\ocwlowerid{rstem}~]~$\ocwbc{} -()ayati - shortening final aa \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"udazru"}~\ocweol
\ocwindent{3.50em}
$\rightarrow{}~[~1~::~\ocwlowerid{trunc\_u}~\ocwlowerid{rstem}~]~$\ocwbc{} -()ayati - final u becomes a \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"agha"}~$\mid{}~$\ocwstring{"azana\#2"}~$\mid{}~$\ocwstring{"azva"}~$\mid{}~$\ocwstring{"ka.n.du"}~$\mid{}~$\ocwstring{"khela"}~$\mid{}~$\ocwstring{"jihma"}~$\mid{}~$\ocwstring{"pramada"}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"lohita"}~$\mid{}~$\ocwstring{"mantu"}~$\mid{}~$\ocwstring{"manda"}~$\mid{}~$\ocwstring{"valgu"}~$\mid{}~$\ocwstring{"sakhi"}~$\mid{}~$\ocwstring{"samudra\#1"}~\ocweol
\ocwindent{2.50em}
\ocwbc{} to become \Pan{3,1,13} kya.s \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"asu"}~\ocwbc{} lexicalized under \ocwstring{"asuuya"} \ocwec{}\ocweol
\ocwindent{3.50em}
$\rightarrow{}~\ocwlowerid{lengthen}~\ocwlowerid{rstem}~$\ocwbc{} lengthening -aayati \ocwec{}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"asuuya"}~\ocwbc{} \ocwstring{"asu"} lengthened \ocwec{}~$\mid{}~$\ocwstring{"gomaya"}~\ocwbc{} euphony \ocwec{}\ocweol
\ocwindent{3.50em}
$\rightarrow{}~\ocwlowerid{trunc}~(\ocwlowerid{trunc}~\ocwlowerid{rstem})~$\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"artha"}~$\mid{}~$\ocwstring{"veda"}~$\mid{}~$\ocwstring{"satya"}~\ocwbc{} \Pan{3,1,25} vt. \ocwec{}\ocweol
\ocwindent{3.50em}
$\rightarrow{}~[~1~::~[~37~::~[~2~::~\ocwlowerid{trunc}~\ocwlowerid{rstem}~]~]~]~$\ocwbc{} -aapayati - interc p \ocwec{}~\ocweol
\ocwindent{1.50em}
\ocwbc{} |  \ocwbc{} very rare Whitney§1059d e.g. \ocwstring{"putra"} \ocwec{}
       -> \ocwbegindcode{}~3~::~$\ocwlowerid{trunc\_a}~\ocwlowerid{rstem}~$\ocwenddcode{} \ocwbc{} -()iyati \ocwec{} \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"adhvara"}~$\mid{}~$\ocwstring{"tavi.sa"}~$\mid{}~$\ocwstring{"putra"}~$\mid{}~$\ocwstring{"praasaada"}~\ocwbc{} treat as \Pan{3,1,10} \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"udaka"}~$\mid{}~$\ocwstring{"kavi"}~$\mid{}~$\ocwstring{"dhana"}~$\mid{}~$\ocwstring{"maa.msa"}~$\mid{}~$\ocwstring{"vastra"}~\ocwbc{} desire Kale§643 \ocwec{}~\ocweol
\ocwindent{3.50em}
$\rightarrow{}~[~4~::~\ocwlowerid{trunc}~\ocwlowerid{rstem}~]~$\ocwbc{} -()iiyati \ocwec{}~\ocwbc{} \Pan{3,1,8} kyac \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"kart.r"}~$\rightarrow{}~[~4~::~[~43~::~\ocwlowerid{trunc}~\ocwlowerid{rstem}~]~]~$\ocwbc{} .r -> rii  Kale§642 \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"go"}~$\rightarrow{}~[~45~::~[~1~::~\ocwlowerid{trunc}~\ocwlowerid{rstem}~]~]~$\ocwbc{} o -> av    Kale§642 \ocwec{}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"nau\#1"}~$\rightarrow{}~[~45~::~[~2~::~\ocwlowerid{trunc}~\ocwlowerid{rstem}~]~]~$\ocwbc{} au -> aav  Kale§642 \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"raajan"}~$\rightarrow{}~[~4~::~\ocwlowerid{trunc}~(\ocwlowerid{trunc}~\ocwlowerid{rstem})~]~$\ocwbc{} nasal amui Kale§642 \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwbc{} now the general case: keep the nominal stem - to cause (transitive) \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"a.mza"}~$\mid{}~$\ocwstring{"afka"}~$\mid{}~$\ocwstring{"afkha"}~$\mid{}~$\ocwstring{"andha"}~$\mid{}~$\ocwstring{"aparok.sa"}~$\mid{}~$\ocwstring{"amitra"}~$\mid{}~$\ocwstring{"aakar.na"}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"aakula"}~$\mid{}~$\ocwstring{"aavila"}~$\mid{}~$\ocwstring{"i.sa"}~$\mid{}~$\ocwstring{"upahasta"}~$\mid{}~$\ocwstring{"ka.thora"}~$\mid{}~$\ocwstring{"kadartha"}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"kar.na"}~$\mid{}~$\ocwstring{"kalafka"}~$\mid{}~$\ocwstring{"kalu.sa"}~$\mid{}~$\ocwstring{"kavala"}~$\mid{}~$\ocwstring{"ku.t.ta"}~$\mid{}~$\ocwstring{"kusuma"}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"kha.da"}~$\mid{}~$\ocwstring{"garva"}~$\mid{}~$\ocwstring{"gopaa"}~$\mid{}~$\ocwstring{"carca"}~$\mid{}~$\ocwstring{"cuur.na"}~$\mid{}~$\ocwstring{"chala"}~$\mid{}~$\ocwstring{"chidra"}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"tantra"}~$\mid{}~$\ocwstring{"tarafga"}~$\mid{}~$\ocwstring{"taru.na"}~$\mid{}~$\ocwstring{"tuhina"}~$\mid{}~$\ocwstring{"da.n.da"}~$\mid{}~$\ocwstring{"deva"}~$\mid{}~$\ocwstring{"dola"}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"dhiira\#1"}~$\mid{}~$\ocwstring{"nuutana"}~$\mid{}~$\ocwstring{"pa.tapa.taa"}~$\mid{}~$\ocwstring{"pallava"}~$\mid{}~$\ocwstring{"pavitra"}~$\mid{}~$\ocwstring{"paaza"}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"pi.n.da"}~$\mid{}~$\ocwstring{"pulaka"}~$\mid{}~$\ocwstring{"puula"}~$\mid{}~$\ocwstring{"pratikuula"}~$\mid{}~$\ocwstring{"prati.sedha"}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"pradak.si.na"}~$\mid{}~$\ocwstring{"prasaada"}~$\mid{}~$\ocwstring{"bhi.saj"}~$\mid{}~$\ocwstring{"mantra"}~$\mid{}~$\ocwstring{"malina"}~$\mid{}~$\ocwstring{"mizra"}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"mukula"}~$\mid{}~$\ocwstring{"mukhara"}~$\mid{}~$\ocwstring{"mu.n.da"}~$\mid{}~$\ocwstring{"muutra"}~$\mid{}~$\ocwstring{"m.rga"}~$\mid{}~$\ocwstring{"yantra"}~$\mid{}~$\ocwstring{"rasa"}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"ruuk.sa"}~$\mid{}~$\ocwstring{"lagha"}~\ocwbc{} u -> a \ocwec{}~$\mid{}~$\ocwstring{"var.na"}~$\mid{}~$\ocwstring{"vaasa\#3"}~$\mid{}~$\ocwstring{"vizada"}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"vra.na"}~$\mid{}~$\ocwstring{"zaanta"}~$\mid{}~$\ocwstring{"zithila"}~$\mid{}~$\ocwstring{"zyena"}~$\mid{}~$\ocwstring{".sa.n.dha"}~$\mid{}~$\ocwstring{"sapi.n.da"}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"saphala"}~$\mid{}~$\ocwstring{"sabhaaja"}~$\mid{}~$\ocwstring{"saantva"}~$\mid{}~$\ocwstring{"saavadhaana"}~$\mid{}~$\ocwstring{"suutra"}~$\mid{}~$\ocwstring{"stena"}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"sthaga"}~$\mid{}~$\ocwstring{"tapas"}~\ocwbc{} practice \Pan{3,1,15} \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"u.sas"}~$\mid{}~$\ocwstring{"namas"}~$\mid{}~$\ocwstring{"varivas"}~\ocwbc{} do \Pan{3,1,19} \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"udan"}~\ocwbc{} Kale§645 \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"kelaa"}~$\mid{}~$\ocwstring{"rekhaa"}~$\mid{}~$\ocwstring{"tiras"}~$\mid{}~$\ocwstring{"uras"}~$\mid{}~$\ocwstring{"payas"}~\ocwbc{} Kale§660 \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"vaac"}~\ocwbc{} consonant Kale§642 \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"dantura"}~\ocwbc{} possess \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"viira"}~$\mid{}~$\ocwstring{"zabda"}~$\mid{}~$\ocwstring{"tira"}~\ocwbc{} MW \ocwec{}~$\mid{}~$\ocwstring{"ma\~{}njara"}~\ocweol
\ocwindent{3.50em}
$\rightarrow{}~\ocwlowerid{rstem}~$\ocwbc{} -yati \ocwec{}~\ocwbc{} standard causative meaning \ocwec{}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"madhu"}~$\mid{}~$\ocwstring{"v.r.sa"}~\ocwbc{} also madhvasyati v.r.siiyati \ocwec{}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"k.siira"}~$\mid{}~$\ocwstring{"lava.na"}~\ocwbc{} also putra \ocwec{}\ocweol
\ocwindent{3.50em}
$\rightarrow{}~[~48~::~\ocwlowerid{rstem}~]~$\ocwbc{} -syati \ocwec{}~\ocwbc{} Kale§643 \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}denominative\ocwvspace{}"}~\^{}~$\ocwlowerid{entry})$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{den\_stem\_m}~\ocwlowerid{entry}~=~$\ocwbc{} in general intransitive or reflexive Whitney§1059c \ocwec{}\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$\ocwlowerid{rstem}~=~\ocwlowerid{revstem}~\ocwlowerid{entry}~$\ocwkw{in}~\ocweol
\ocwindent{1.50em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{1.50em}
$[~$\ocwstring{"artha"}~$\mid{}~$\ocwstring{"i.sa"}~$\mid{}~$\ocwstring{"kuha"}~$\mid{}~$\ocwstring{"carca"}~$\mid{}~$\ocwstring{"mantra"}~$\mid{}~$\ocwstring{"muutra"}~$\mid{}~$\ocwstring{"m.rga"}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"viira"}~$\mid{}~$\ocwstring{"safgraama"}~$\mid{}~$\ocwstring{"suutra"}~\ocwbc{} also zithila below \ocwec{}\ocweol
\ocwindent{3.50em}
$\rightarrow{}~\ocwlowerid{rstem}~$\ocwbc{} -ayate \ocwec{}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"asuuya"}~\ocwbc{} \ocwstring{"asu"} lengthened \ocwec{}\ocweol
\ocwindent{3.50em}
$\rightarrow{}~\ocwlowerid{trunc}~(\ocwlowerid{trunc}~\ocwlowerid{rstem})~$\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"tavi.sa"}~$\mid{}~$\ocwstring{"citra"}~\ocwbc{} do \Pan{3,1,19} \ocwec{}~$\mid{}~$\ocwstring{"sajja"}\ocweol
\ocwindent{3.50em}
$\rightarrow{}~[~4~::~\ocwlowerid{trunc\_a}~\ocwlowerid{rstem}~]~$\ocwbc{} -()iiyate \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"apsaras"}~$\mid{}~$\ocwstring{"sumanas"}~\ocwbc{} act as , become \Pan{3,1,11-12} \ocwec{}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"unmanas"}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"uu.sman"}~\ocwbc{} emit \Pan{3,1,16} \ocwec{}\ocweol
\ocwindent{3.50em}
$\rightarrow{}~\ocwlowerid{lengthen}~(\ocwlowerid{trunc}~\ocwlowerid{rstem})~$\ocwbc{} final consonant dropped \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwbc{} now the general case: lengthen the nominal vowel stem \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"pa.tapa.taa"}~$\mid{}~$\ocwstring{"mahii\#2"}~$\mid{}~$\ocwstring{"m.r.saa"}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"laalaa"}~$\mid{}~$\ocwstring{"svalpazilaa"}~$\mid{}~$\ocwstring{"vimanaa"}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"ajira"}~$\mid{}~$\ocwstring{"kalu.sa"}~$\mid{}~$\ocwstring{"k.rpa.na"}~$\mid{}~$\ocwstring{"kliiba"}~$\mid{}~$\ocwstring{"garva"}~$\mid{}~$\ocwstring{"jala"}~$\mid{}~$\ocwstring{"jihma"}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"taru.na"}~$\mid{}~$\ocwstring{"nika.sa"}~$\mid{}~$\ocwstring{"parok.sa"}~$\mid{}~$\ocwstring{"piiyuu.savar.sa"}~$\mid{}~$\ocwstring{"pu.spa"}~$\mid{}~$\ocwstring{"priya"}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"bh.rza"}~$\mid{}~$\ocwstring{"maalyagu.na"}~$\mid{}~$\ocwstring{"lohita"}~$\mid{}~$\ocwstring{"zalabha"}~$\mid{}~$\ocwstring{"zithila"}~$\mid{}~$\ocwstring{"ziighra"}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"zyaama"}~$\mid{}~$\ocwstring{"zyena"}~$\mid{}~$\ocwstring{"safka.ta"}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"ka.n.du"}~$\mid{}~$\ocwstring{"karu.naa"}~$\mid{}~$\ocwstring{"sukhaa"}~\ocwbc{} feel \Pan{3,1,18} \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"abhra"}~$\mid{}~$\ocwstring{"ka.nva"}~$\mid{}~$\ocwstring{"kalaha"}~$\mid{}~$\ocwstring{"k.sepa"}~$\mid{}~$\ocwstring{"megha"}~$\mid{}~$\ocwstring{"vaira"}~$\mid{}~$\ocwstring{"zabda"}~\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"z.rfga"}~\ocwbc{} do \Pan{3,1,17} \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"durdina"}~$\mid{}~$\ocwstring{"sudina"}~$\mid{}~$\ocwstring{"niihaara"}~\ocwbc{} id. vaartika \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"ka.s.ta"}~$\mid{}~$\ocwstring{"k.rcchra"}~\ocwbc{} strive to \Pan{3,1,14} \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"romantha"}~\ocwbc{} practice \Pan{3,1,15} \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"dhuuma"}~$\mid{}~$\ocwstring{"baa.spa"}~$\mid{}~$\ocwstring{"phena"}~\ocwbc{} emit \Pan{3,1,16} \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"kurafga"}~$\mid{}~$\ocwstring{"pu.skara"}~$\mid{}~$\ocwstring{"yuga"}~$\mid{}~$\ocwstring{"vi.sa"}~$\mid{}~$\ocwstring{"zizu"}~$\mid{}~$\ocwstring{"samudra\#1"}~\ocweol
\ocwindent{2.50em}
\ocwbc{} resemble \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"puru.sa"}~\ocwbc{} imitate \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwstring{"manda"}~$\mid{}~$\ocwstring{"bhuusvarga"}~\ocwbc{} to become \ocwec{}\ocweol
\ocwindent{3.50em}
$\rightarrow{}~\ocwlowerid{lengthen}~\ocwlowerid{rstem}~$\ocwbc{} reflexive causative middle to become \Pan{3,1,13} \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}denominative\ocwvspace{}"}~\^{}~$\ocwlowerid{entry})$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_denom}~\ocwlowerid{stem}~\ocwlowerid{ystem}~\ocwlowerid{entry}~=~$\ocwkw{do}~\ocwbc{} other than present system - rare \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{build\_perpft}~\ocwupperid{Primary}~\ocwlowerid{ystem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{fsuf}~=~\ocwlowerid{revcode}~$\ocwstring{"i.sy"}~\ocwkw{in}~\ocwbc{} rare - similar to \ocwbegindcode{}$\ocwlowerid{compute\_future\_10}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{compute\_future}~(\ocwlowerid{fsuf}~@~\ocwlowerid{ystem})~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{perstem}~=~[~3~::~\ocwlowerid{ystem}~]~$\ocwbc{} -yi \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{2.00em}
$\ocwlowerid{perif}~\ocwupperid{Primary}~\ocwlowerid{perstem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[~1~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"asuuya"}~$\rightarrow{}~()~$\ocwbc{} wrong asya \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{do}~\ocwbc{} experimental - rare acc. to Whitney \ocwec{}\ocweol
\ocwindent{7.50em}
\{~$\ocwlowerid{compute\_passive\_11}~\ocwlowerid{entry}~\ocwlowerid{rest}$\ocweol
\ocwindent{7.50em}
;~$\ocwlowerid{record\_pfp\_10}~\ocwlowerid{entry}~\ocwlowerid{rest}$\ocweol
\ocwindent{7.50em}
\}\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()~$\ocwbc{} specially wrong for consonant stems \ocwec{}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_denominative\_a}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{third}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~3~::~[~32~::~[~1~::~([~42~::~\ocwlowerid{s}~]~$\ocwkw{as}~$\ocwlowerid{ystem})~]~]~]~$\ocwbc{} -yati \ocwec{}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{6.00em}
\{~$\ocwlowerid{compute\_thematic\_active}~11~\ocwupperid{Primary}~\ocwlowerid{ystem}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{compute\_denom}~\ocwlowerid{s}~\ocwlowerid{ystem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{record\_ppp\_abs\_den}~\ocwlowerid{ystem}~\ocwlowerid{entry}$\ocweol
\ocwindent{6.00em}
\}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Anomalous\ocwvspace{}denominative\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{third})$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_denominative\_m}~\ocwlowerid{entry}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{third}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~10~::~[~32~::~[~1~::~([~42~::~\ocwlowerid{s}~]~$\ocwkw{as}~$\ocwlowerid{ystem})~]~]~]~$\ocwbc{} -yate \ocwec{}~$\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{6.00em}
\{~$\ocwlowerid{compute\_thematic\_middle}~11~\ocwupperid{Primary}~\ocwlowerid{ystem}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{compute\_denom}~\ocwlowerid{s}~\ocwlowerid{ystem}~\ocwlowerid{entry}$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{record\_ppp\_abs\_den}~\ocwlowerid{ystem}~\ocwlowerid{entry}$\ocweol
\ocwindent{6.00em}
\}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Anomalous\ocwvspace{}denominative\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{third})$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We use the lexicalized third stem \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_denominative}~\ocwlowerid{entry}~\ocwlowerid{pada}~\ocwlowerid{third}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{third}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[\,]~$\ocwbc{} fake \ocwec{}~$\rightarrow{}~$\ocwkw{do}~\ocwbc{} pada not informative, we try both \ocwec{}\ocweol
\ocwindent{2.50em}
\{~\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{den\_stem\_a}~\ocwlowerid{entry}~$\ocwkw{in}~\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{ystem}~=~[~42~::~\ocwlowerid{stem}~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{5.50em}
\{~$\ocwlowerid{compute\_thematic\_active}~11~\ocwupperid{Primary}~\ocwlowerid{ystem}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{compute\_denom}~\ocwlowerid{stem}~\ocwlowerid{ystem}~\ocwlowerid{entry}$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{record\_ppp\_abs\_den}~\ocwlowerid{ystem}~\ocwlowerid{entry}$\ocweol
\ocwindent{5.50em}
\}\ocweol
\ocwindent{3.50em}
\ocwkw{with}~$[~\ocwupperid{Failure}~\ocwlowerid{\_}~\rightarrow{}~()~]$\ocweol
\ocwindent{2.50em}
;~\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{den\_stem\_m}~\ocwlowerid{entry}~$\ocwkw{in}~\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{ystem}~=~[~42~::~\ocwlowerid{stem}~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{5.50em}
\{~$\ocwlowerid{compute\_thematic\_middle}~11~\ocwupperid{Primary}~\ocwlowerid{ystem}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{compute\_denom}~\ocwlowerid{stem}~\ocwlowerid{ystem}~\ocwlowerid{entry}$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{record\_ppp\_abs\_den}~\ocwlowerid{ystem}~\ocwlowerid{entry}$\ocweol
\ocwindent{5.50em}
\}\ocweol
\ocwindent{3.50em}
\ocwkw{with}~$[~\ocwupperid{Failure}~\ocwlowerid{\_}~\rightarrow{}~()~]$\ocweol
\ocwindent{2.50em}
\}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{pada}~$\ocwkw{then}~\ocwbc{} Para \ocwec{}~$\ocwlowerid{compute\_denominative\_a}~\ocwlowerid{entry}~\ocwlowerid{third}~$\ocweol
\ocwindent{8.50em}
\ocwkw{else}~\ocwbc{} Atma \ocwec{}~$\ocwlowerid{compute\_denominative\_m}~\ocwlowerid{entry}~\ocwlowerid{third}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{}*************************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Main conjugation engine \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}*************************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{compute\_conjugs\_stems}~:~$\ocwbt{string}~$\rightarrow{}~\ocwupperid{Conj\_infos}.\ocwlowerid{vmorph}~\rightarrow{}~$\ocwbt{unit}\ocwenddcode{}           \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} called by \ocwbegindcode{}$\ocwlowerid{compute\_conjugs}$\ocwenddcode{} and \ocwbegindcode{}$\ocwlowerid{fake\_compute\_conjugs}$\ocwenddcode{} below 
   and \ocwbegindcode{}$\ocwupperid{Conjugation}.\ocwlowerid{secondary\_conjugs}$\ocwenddcode{}   \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_conjugs\_stems}~\ocwlowerid{entry}~(\ocwlowerid{vmorph},\ocwlowerid{aa})~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{admits\_aa.}\ocwlowerid{val}~:=~\ocwlowerid{aa}~$\ocwbc{} sets the flag for phantom forms for aa- preverb \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{vmorph}~$\ocwkw{with}~\ocweol
\ocwindent{0.50em}
$[~\ocwupperid{Conj\_infos.Prim}~11~\ocwlowerid{pada}~\ocwlowerid{third}~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwbc{} note: pada of denominative verbs is lexicalized \ocwec{}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{compute\_denominative}~\ocwlowerid{entry}~\ocwlowerid{pada}~\ocwlowerid{third}$\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwupperid{Conj\_infos.Prim}~\ocwlowerid{gana}~\ocwlowerid{pada}~\ocwlowerid{third}~\rightarrow{}~$\ocweol
\ocwindent{1.50em}
\ocwbc{} gana is root class, pada is True for Para, False for Atma of third form \ocwec{}\ocweol
\ocwindent{1.50em}
\ocwbc{} Primary conjugation \ocwec{}\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$\ocwlowerid{rstem}~=~\ocwlowerid{revstem}~\ocwlowerid{entry}~$\ocwkw{in}~\ocwbc{} root stem reversed \ocwec{}~\ocweol
\ocwindent{1.50em}
\ocwkw{try}~\ocwkw{do}\ocweol
\ocwindent{1.50em}
\{~$\ocwlowerid{compute\_present\_system}~\ocwlowerid{entry}~\ocwlowerid{rstem}~\ocwlowerid{gana}~\ocwlowerid{pada}~\ocwlowerid{third}~$\ocwbc{} Present system \ocwec{}\ocweol
\ocwindent{1.50em}
;~\ocwbc{} Future and Conditional \ocwec{}~\ocweol
\ocwindent{2.50em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{2.50em}
$[~$\ocwstring{"ifg"}~$\mid{}~$\ocwstring{"paz"}~$\mid{}~$\ocwstring{"cint"}~\ocwbc{} d.rz cit \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"bruu"}~\ocwbc{} vac \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"cud"}~$\mid{}~$\ocwstring{"dhii\#1"}~$\mid{}~$\ocwstring{"pat\#2"}~$\mid{}$\ocwstring{"praa\#1"}~$\mid{}~$\ocwstring{"vidh\#1"}~$\mid{}~$\ocwstring{"zlath"}\ocweol
\ocwindent{4.00em}
$\rightarrow{}~()~$\ocwbc{} no future \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"tud\#1"}~$\mid{}~$\ocwstring{"cakaas"}~$\rightarrow{}~()~$\ocwbc{} only periphrastic \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"bharts"}~$\rightarrow{}~\ocwlowerid{compute\_future\_gen}~\ocwlowerid{rstem}~\ocwlowerid{entry}~$\ocwbc{} exception gana 10 \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"umbh"}~$\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{compute\_future\_gen}~(\ocwlowerid{revcode}~$\ocwstring{"ubh"}$)~\ocwlowerid{entry}~$\ocwbc{} 2 forms \ocwec{}\ocweol
\ocwindent{10.00em}
;~$\ocwlowerid{compute\_future\_gen}~\ocwlowerid{rstem}~\ocwlowerid{entry}$\ocweol
\ocwindent{10.00em}
\}\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"saa\#1"}~$\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{compute\_future\_gen}~(\ocwlowerid{revcode}~$\ocwstring{"si"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{10.50em}
;~$\ocwlowerid{compute\_future\_gen}~\ocwlowerid{rstem}~\ocwlowerid{entry}$\ocweol
\ocwindent{10.50em}
\}\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"vyadh"}~$\rightarrow{}~\ocwlowerid{compute\_future\_gen}~(\ocwlowerid{revcode}~$\ocwstring{"vidh"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"zuu"}~$\rightarrow{}~\ocwlowerid{compute\_future\_gen}~(\ocwlowerid{revcode}~$\ocwstring{"zve"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{gana}=10~$\ocwkw{then}~$\ocwlowerid{compute\_future\_10}~\ocwlowerid{rstem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~$\ocwlowerid{compute\_future\_gen}~\ocwlowerid{rstem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.50em}
$]$\ocweol
\ocwindent{1.50em}
;~\ocwbc{} Periphrastic future, Infinitive, Passive future part. in -tavya \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{if}~$\ocwlowerid{gana}=10~$\ocwkw{then}~$()~$\ocwbc{} see \ocwbegindcode{}$\ocwlowerid{process10}$\ocwenddcode{} above \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~$\ocwstring{"ifg"}~$\mid{}~$\ocwstring{"paz"}~\ocwbc{} d.rz \ocwec{}~$\mid{}~$\ocwstring{"bruu"}~\ocwbc{} vac \ocwec{}~\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"cud"}~$\mid{}~$\ocwstring{"dhii\#1"}~$\mid{}~$\ocwstring{"pat\#2"}~$\mid{}~$\ocwstring{"praa\#1"}~$\mid{}~$\ocwstring{"vidh\#1"}\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"haa\#2"}~$\rightarrow{}~()~$\ocwbc{} no perif \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"saa\#1"}~$\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{compute\_perif}~(\ocwlowerid{revcode}~$\ocwstring{"si"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{13.00em}
;~$\ocwlowerid{compute\_perif}~\ocwlowerid{rstem}~\ocwlowerid{entry}$\ocweol
\ocwindent{13.00em}
\}\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"vyadh"}~$\rightarrow{}~\ocwlowerid{compute\_perif}~(\ocwlowerid{revcode}~$\ocwstring{"vidh"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"zuu"}~$\rightarrow{}~\ocwlowerid{compute\_perif}~(\ocwlowerid{revcode}~$\ocwstring{"zve"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{compute\_perif}~\ocwlowerid{rstem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{1.50em}
;~\ocwbc{} Precative - active rare, middle unknown in classical language except
        2 occs in Abhisamayaalafkaara (David Reigle) \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{2.50em}
$[~$\ocwstring{"budh\#1"}~$\mid{}~$\ocwstring{"bhuu\#1"}~$\rightarrow{}~$\ocwbc{} Macdonell§150 \ocwec{}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{conjug\_benedictivea}~\ocwupperid{Primary}~\ocwlowerid{rstem}~\ocwlowerid{entry}~$\ocwbc{} Whitney§922b \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"k.r\#1"}~$\mid{}~$\ocwstring{"grah"}~$\mid{}~$\ocwstring{"bandh"}~$\mid{}~$\ocwstring{"yaj\#1"}~$\mid{}~$\ocwstring{"zaas"}~$\mid{}~$\ocwstring{"stu"}~$\rightarrow{}~$\ocweol
\ocwindent{4.00em}
$\ocwlowerid{conjug\_benedictivea}~\ocwupperid{Primary}~(\ocwlowerid{passive\_stem}~\ocwlowerid{entry}~\ocwlowerid{rstem})~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"puu\#1"}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{wstem}~=~\ocwlowerid{revcode}~$\ocwstring{"punii"}~\ocwbc{} weak stem of gana 9 \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{conjug\_benedictivea}~\ocwupperid{Primary}~\ocwlowerid{wstem}~\ocwlowerid{entry}~$\ocwbc{} puniiyaat Vi.s.nu sahasran \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"daa\#1"}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{wstem}~=~\ocwlowerid{revcode}~$\ocwstring{"de"}~\ocwbc{} Henry§298 aa {\R} e \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{conjug\_benedictivea}~\ocwupperid{Primary}~\ocwlowerid{wstem}~\ocwlowerid{entry}~$\ocwbc{} puissé-je donner! \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"m.r"}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{sibstem}~=~\ocwlowerid{revcode}~$\ocwstring{"m.r.s"}~\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{conjug\_benedictivem}~\ocwupperid{Primary}~\ocwlowerid{sibstem}~\ocwlowerid{entry}~$\ocwbc{} m.r.sii.s.ta \Pan{1,3,61} \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"luu\#1"}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{sibstem}~=~\ocwlowerid{revcode}~$\ocwstring{"lavi.s"}~\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{conjug\_benedictivem}~\ocwupperid{Primary}~\ocwlowerid{sibstem}~\ocwlowerid{entry}~$\ocwbc{} lavi.sii.s.ta \Pan{3,4,116} \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{2.50em}
$]$\ocweol
\ocwindent{1.50em}
;~\ocwbc{} Passive \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{ps\_stem}~=~\ocwlowerid{passive\_stem}~\ocwlowerid{entry}~\ocwlowerid{rstem}~$\ocwkw{in}~\ocweol
\ocwindent{2.50em}
\ocwkw{if}~$\ocwlowerid{gana}=10~$\ocwkw{then}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{compute\_passive\_10}~\ocwlowerid{entry}~(\ocwlowerid{strong}~\ocwlowerid{ps\_stem})$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{record\_pfp\_10}~\ocwlowerid{entry}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{2.50em}
\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{compute\_passive\_primary}~\ocwlowerid{entry}~\ocwlowerid{ps\_stem}$\ocweol
\ocwindent{5.00em}
\ocwbc{} Passive future participle (gerundive) in -ya and -aniiya \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{record\_pfp}~\ocwlowerid{entry}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{1.50em}
;~\ocwbc{} Ppp computation and recording (together with absolutives) \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{2.50em}
$[~$\ocwstring{"bruu"}~\ocwbc{} vac \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"paz"}~\ocwbc{} d.rz \ocwec{}~\ocweol
\ocwindent{2.50em}
$\mid{}~$\ocwstring{"zvit"}~$\rightarrow{}~()$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{gana}=10~$\ocwkw{then}~\ocweol
\ocwindent{7.00em}
\ocwkw{let}~$\ocwlowerid{ystem}~=~\ocwlowerid{rfix}~\ocwlowerid{rstem}~$\ocwstring{"ay"}~\ocweol
\ocwindent{7.00em}
\ocwkw{and}~$\ocwlowerid{ppstem}~=~\ocwlowerid{rfix}~\ocwlowerid{rstem}~$\ocwstring{"ita"}~\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{7.00em}
\{~$\ocwlowerid{record\_part\_ppp}~\ocwlowerid{ppstem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{7.00em}
;~$\ocwlowerid{record\_abso\_tvaa}~(\ocwlowerid{fix}~\ocwlowerid{ystem}~$\ocwstring{"itvaa"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{7.00em}
;~\ocwkw{let}~$\ocwlowerid{ya\_stem}~=~$\ocwkw{if}~$\ocwlowerid{light\_10}~\ocwlowerid{rstem}~$\ocwkw{then}~$\ocwlowerid{ystem}~$\ocwkw{else}~$\ocwlowerid{rstem}~$\ocwkw{in}\ocweol
\ocwindent{8.00em}
$\ocwlowerid{record\_abso\_ya}~(\ocwlowerid{fix}~\ocwlowerid{ya\_stem}~$\ocwstring{"ya"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{7.00em}
\}\ocweol
\ocwindent{6.00em}
\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{7.00em}
\{~\ocwkw{let}~$\ocwlowerid{ppstems}~=~\ocwlowerid{compute\_ppp\_stems}~\ocwlowerid{entry}~\ocwlowerid{rstem}~$\ocwkw{in}~\ocweol
\ocwindent{8.00em}
$\ocwlowerid{record\_ppp\_abs\_stems}~\ocwlowerid{entry}~\ocwlowerid{rstem}~\ocwlowerid{ppstems}$\ocweol
\ocwindent{7.00em}
;~$\ocwlowerid{record\_abso\_am}~\ocwlowerid{entry}~$\ocwbc{} rare \ocwec{}\ocweol
\ocwindent{7.00em}
\}\ocweol
\ocwindent{2.50em}
$]$\ocweol
\ocwindent{1.50em}
;~\ocwbc{} Perfect \ocwec{}~\ocweol
\ocwindent{2.50em}
\ocwkw{if}~$\ocwlowerid{gana}=10~$\ocwkw{then}~$()~$\ocwbc{} use periphrastic perfect \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~$\ocwstring{"paz"}~\ocwbc{} d.rz \ocwec{}~$\mid{}~$\ocwstring{"bruu"}~\ocwbc{} vac \ocwec{}~$\mid{}~$\ocwstring{"ma.mh"}~\ocwbc{} mah \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"ind"}~$\mid{}~$\ocwstring{"indh"}~$\mid{}~$\ocwstring{"inv"}~$\mid{}~$\ocwstring{"cakaas"}~$\mid{}~$\ocwstring{"dhii\#1"}~$\mid{}~$\ocwstring{"vidh\#1"}~$\rightarrow{}~()$\ocweol
\ocwindent{6.00em}
\ocwbc{} no perfect \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{compute\_perfect}~\ocwlowerid{entry}~$\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{1.50em}
;~\ocwbc{} Periphrastic Perfect \ocwec{}~\ocwbc{} on demand - except gana 10 above \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{peri\_perf}~\ocwlowerid{entry}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$\ocwlowerid{build\_perpft}~\ocwupperid{Primary}~\ocwlowerid{stem}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.50em}
\ocwkw{with}~$[~\ocwupperid{Not\_attested}~\rightarrow{}~()~]$\ocweol
\ocwindent{1.50em}
;~\ocwbc{} Aorist \ocwec{}~$\ocwlowerid{compute\_aorist}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.50em}
;~\ocwbc{} Injunctive \ocwec{}~$\ocwlowerid{compute\_injunctive}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.50em}
\}\ocweol
\ocwindent{2.00em}
\ocwkw{with}~$[~\ocwupperid{Control.Warning}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{output\_string}~\ocwlowerid{stdout}~(\ocwlowerid{s}~$\^{}~\ocwstring{"\symbol{92}n"}$)~]$\ocweol
\ocwindent{1.50em}
\ocwbc{} end of Primary conjugation (including passive) \ocwec{}~\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwupperid{Conj\_infos.Causa}~\ocwlowerid{third}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
\ocwbc{} Here we extract the causative stem from the third given in Dico \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwbc{} rather than implementing all special cases of Whitney§1042.     \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwbc{} Alternative: compute cstem instead of reading it from the lexicon.    
        Voir Panini krit \ocwstring{".ni"} \Pan{7,3,36-43}                           \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$(\ocwlowerid{cstem},\ocwlowerid{active})~=~$\ocwkw{match}~$\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{third}~$\ocwkw{with}\ocweol
\ocwindent{4.50em}
$[~[~3~::~[~32~::~[~1~::~\ocwlowerid{st}~]~]~]~$\ocwbc{} remove -ati \ocwec{}\ocweol
\ocwindent{6.50em}
$\rightarrow{}~(\ocwlowerid{st},\ocwupperid{True})$\ocweol
\ocwindent{4.50em}
$\mid{}~[~10~::~[~32~::~[~1~::~\ocwlowerid{st}~]~]~]~$\ocwbc{} remove -ate \ocwec{}\ocweol
\ocwindent{6.50em}
$\rightarrow{}~(\ocwlowerid{st},\ocwupperid{False})$\ocweol
\ocwindent{5.50em}
\ocwbc{} We lose some information, but generate both active and middle \ocwec{}\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Weird\ocwvspace{}causative\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{third})$\ocweol
\ocwindent{4.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{cpstem}~=~$\ocwkw{match}~$\ocwlowerid{cstem}~$\ocwkw{with}\ocweol
\ocwindent{4.50em}
$[~[~42~::~[~1~::~\ocwlowerid{st}~]~]~$\ocwbc{} -ay \ocwec{}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~$\ocwstring{"dhvan"}~$\rightarrow{}~\ocwlowerid{revcode}~$\ocwstring{"dhvaan"}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{st}~$\ocweol
\ocwindent{6.00em}
\ocwbc{} doubt: ambiguity in ps when the ca stem is not lengthened       \ocwec{}\ocweol
\ocwindent{6.00em}
\ocwbc{} eg gamyate. Whitney§1052a says \ocwstring{"causatively\ocwvspace{}strengthened\ocwvspace{}stem"}? \ocwec{}\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{4.50em}
\ocwbc{} Why no ca in -aayati while such forms exist for ga.na 10 and 11 ?  \ocwec{}\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Anomalous\ocwvspace{}causative\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{third})$\ocweol
\ocwindent{4.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{icstem}~=~[~3~::~\ocwlowerid{cstem}~]~$\ocwbc{} -ayi \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{compute\_causative}~\ocwlowerid{stem}~=~$\ocwkw{do}~\ocwbc{} both active and middle are generated \ocwec{}\ocweol
\ocwindent{4.50em}
\{~$\ocwlowerid{compute\_causativea}~\ocwlowerid{stem}~\ocwlowerid{entry}~($\ocwkw{if}~$\ocwlowerid{active}~$\ocwkw{then}~$\ocwlowerid{third}~$\ocwkw{else}~$[\,])$\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{compute\_causativem}~\ocwlowerid{stem}~\ocwlowerid{entry}~($\ocwkw{if}~$\ocwlowerid{active}~$\ocwkw{then}~$[\,]~$\ocwkw{else}~$\ocwlowerid{third})$\ocweol
\ocwindent{4.50em}
\}~\ocwkw{in}~\ocweol
\ocwindent{2.50em}
\ocwkw{do}~\ocwbc{} active, middle, passive present; active middle future, aor \ocwec{}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{compute\_causative}~\ocwlowerid{cstem}$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{compute\_passive}~\ocwupperid{Causative}~\ocwlowerid{entry}~\ocwlowerid{cpstem}~$\ocwbc{} adapt \ocwbegindcode{}$\ocwlowerid{compute\_passive\_10}$\ocwenddcode{}? \ocwec{}\ocweol
\ocwindent{2.50em}
;~\ocwkw{let}~$\ocwlowerid{fsuf}~=~\ocwlowerid{revcode}~$\ocwstring{"i.sy"}~\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{fustem}~=~\ocwlowerid{fsuf}~@~\ocwlowerid{cstem}~$\ocwkw{in}~\ocweol
\ocwindent{3.50em}
$\ocwlowerid{compute\_future\_ca}~\ocwlowerid{fustem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{compute\_aor\_ca}~\ocwlowerid{cpstem}~\ocwlowerid{entry}~$\ocwbc{} Whitney§861b Henry§339 \ocwec{}\ocweol
\ocwindent{2.50em}
;~\ocwbc{} Passive future participle in -ya \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~$\ocwstring{"yam"}~$\mid{}~$\ocwstring{"has"}~$\rightarrow{}~()~$\ocwbc{} to avoid redundancy with Primary pfp \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwbc{} zi.s : justified redundancy with Primary pfp \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{record\_pfp\_ya}~\ocwupperid{Causative}~\ocwlowerid{cpstem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.50em}
;~\ocwbc{} Passive future participle in -aniiya \ocwec{}\ocweol
\ocwindent{3.50em}
$\ocwlowerid{record\_pfp\_aniiya}~\ocwupperid{Causative}~\ocwlowerid{cpstem}~\ocwlowerid{entry}$\ocweol
\ocwindent{3.50em}
\ocwbc{} Passive past participle and absolutives \ocwec{}\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{record\_pppca}~\ocwlowerid{cpstem}~\ocwlowerid{cstem}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.50em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} additional forms \ocwec{}\ocweol
\ocwindent{3.50em}
$[~$\ocwstring{"j\~{}naa\#1"}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{st}~=~\ocwlowerid{revcode}~$\ocwstring{"j\~{}nap"}~\ocwkw{in}~\ocwbc{} optional j~napita \ocwec{}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{record\_pppca}~\ocwlowerid{st}~\ocwlowerid{st}~\ocwlowerid{entry}~$\ocwbc{} vet \Pan{7,2,27} \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{3.50em}
$]~$\ocweol
\ocwindent{3.50em}
\ocwbc{} Periphrastic future, Infinitive, Gerundive/pfp in -tavya \ocwec{}\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{perif}~\ocwupperid{Causative}~\ocwlowerid{icstem}~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.50em}
\ocwbc{} Periphrastic perfect Whitney§1045 \ocwec{}\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{build\_perpft}~\ocwupperid{Causative}~\ocwlowerid{cstem}~\ocwlowerid{entry}~$\ocwbc{} gamayaa.mcakaara \ocwec{}\ocweol
\ocwindent{2.50em}
\}~\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwupperid{Conj\_infos.Inten}~\ocwlowerid{third}~\rightarrow{}~$\ocwbc{} TODO passive, perfect, future, aorist, parts \ocwec{}~\ocweol
\ocwindent{2.50em}
\ocwkw{match}~$\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{third}~$\ocwkw{with}~\ocwbc{} active or middle are generated on demand \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwbc{} paras. in -ati, -iiti, -arti (k.r2), -aati (draa1, yaj1), -etti (vid1) \ocwec{}\ocweol
\ocwindent{2.50em}
$[~[~3~::~[~32~::~[~4~::~([~45~::~[~1~::~\ocwlowerid{w}~]~]~$\ocwkw{as}~$\ocwlowerid{wk})~]~]~]~$\ocwbc{} x-aviiti \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{st}~=~[~12~::~\ocwlowerid{w}~]~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwbc{} x-o eg for hu johavitti -> joho -> johomi johavaani \ocwec{}\ocweol
\ocwindent{4.50em}
$\ocwlowerid{compute\_intensivea}~\ocwlowerid{wk}~\ocwlowerid{st}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{2.50em}
$\mid{}~[~3~::~[~32~::~[~4~::~\ocwlowerid{wk}~]~]~]~$\ocwbc{} other -iiti \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{st}~=~\ocwlowerid{strong}~\ocwlowerid{wk}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$\ocwlowerid{compute\_intensivea}~\ocwlowerid{wk}~\ocwlowerid{st}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{2.50em}
$\mid{}~[~3~::~[~32~::~\ocwlowerid{st}~]~]~$\ocwbc{} ti \ocwec{}~\ocweol
\ocwindent{2.50em}
$\mid{}~[~3~::~[~27~::~\ocwlowerid{st}~]~]~$\ocwbc{} .ti eg veve.s.ti \ocwec{}~$\rightarrow{}$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{wk}~=~\ocwlowerid{st}~$\ocwkw{in}~\ocwbc{} TEMP - no easy way to get weak stem from strong one \ocwec{}\ocweol
\ocwindent{12.00em}
\ocwbc{} eg vevid from vevetti=veved+ti nenij from nenekti \ocwec{}\ocweol
\ocwindent{4.50em}
$\ocwlowerid{compute\_intensivea}~\ocwlowerid{wk}~\ocwlowerid{st}~\ocwlowerid{entry}~\ocwlowerid{third}~$\ocweol
\ocwindent{2.50em}
$\mid{}~[~10~::~[~32~::~[~1~::~\ocwlowerid{st}~]~]~]~\rightarrow{}~$\ocwbc{} -ate \ocwec{}~\ocweol
\ocwindent{4.50em}
$\ocwlowerid{compute\_intensivem}~\ocwlowerid{st}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{2.50em}
$\mid{}~[~10~::~[~32~::~\ocwlowerid{st}~]~]~\rightarrow{}~$\ocwbc{} -te : nenikte \ocwec{}~\ocweol
\ocwindent{4.50em}
$\ocwlowerid{compute\_intensivem2}~\ocwlowerid{st}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Weird\ocwvspace{}intensive\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{third})$\ocweol
\ocwindent{2.50em}
$]~$\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwupperid{Conj\_infos.Desid}~\ocwlowerid{third}~\rightarrow{}~$\ocwbc{} TODO passive, future, aorist, more parts \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{compute\_krid}~\ocwlowerid{st}~=~$\ocwkw{do}~\ocwbc{} ppp pfp inf \ocwec{}\ocweol
\ocwindent{4.50em}
\{~$\ocwlowerid{record\_pppdes}~\ocwlowerid{st}~\ocwlowerid{entry}$\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{record\_pfp\_aniiya}~\ocwupperid{Desiderative}~\ocwlowerid{st}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{record\_pfp\_ya}~\ocwupperid{Desiderative}~\ocwlowerid{st}~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{perif}~\ocwupperid{Desiderative}~[~3~::~\ocwlowerid{st}~]~\ocwlowerid{entry}~$\ocweol
\ocwindent{4.50em}
\}~\ocwkw{in}\ocweol
\ocwindent{2.50em}
\ocwkw{match}~$\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{third}~$\ocwkw{with}~\ocwbc{} active or middle are generated on demand \ocwec{}\ocweol
\ocwindent{3.50em}
$[~[~3~::~[~32~::~[~1~::~\ocwlowerid{st}~]~]~]~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{5.50em}
\{~$\ocwlowerid{compute\_desiderativea}~\ocwlowerid{st}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{compute\_passive}~\ocwupperid{Desiderative}~\ocwlowerid{entry}~\ocwlowerid{st}~$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{compute\_futurea}~\ocwupperid{Desiderative}~[~42~::~\ocwlowerid{st}~]~\ocwlowerid{entry}~$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{compute\_perfect\_desida}~\ocwlowerid{st}~\ocwlowerid{entry}~$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{compute\_krid}~\ocwlowerid{st}~$\ocweol
\ocwindent{5.50em}
\}\ocweol
\ocwindent{3.50em}
$\mid{}~[~10~::~[~32~::~[~1~::~\ocwlowerid{st}~]~]~]~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{5.50em}
\{~$\ocwlowerid{compute\_desiderativem}~\ocwlowerid{st}~\ocwlowerid{entry}~\ocwlowerid{third}$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{compute\_passive}~\ocwupperid{Desiderative}~\ocwlowerid{entry}~\ocwlowerid{st}~$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{compute\_futurem}~\ocwupperid{Desiderative}~[~42~::~\ocwlowerid{st}~]~\ocwlowerid{entry}~$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{compute\_perfect\_desidm}~\ocwlowerid{st}~\ocwlowerid{entry}~$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{compute\_krid}~\ocwlowerid{st}$\ocweol
\ocwindent{5.50em}
\}\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Weird\ocwvspace{}desiderative\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{third})$\ocweol
\ocwindent{3.50em}
$]~$\ocweol
\ocwindent{0.50em}
$]~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Extra participial forms - intensive, desiderative, no present, etc \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_extra\_participles}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{revstem}~$\ocwstring{"gupta"}$)~$\ocwstring{"gup"}~\ocwbc{} gup gana 10 \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{revstem}~$\ocwstring{"zaata"}$)~$\ocwstring{"zaa"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{revstem}~$\ocwstring{"kaanta"}$)~$\ocwstring{"kam"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{revstem}~$\ocwstring{"spa.s.ta"}$)~$\ocwstring{"spaz\#1"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part}~(\ocwupperid{Ppra\_}~1~\ocwupperid{Intensive}~(\ocwlowerid{revstem}~$\ocwstring{"jaajam"}$)~(\ocwlowerid{revstem}~$\ocwstring{"jaajamat"}$)~$\ocwstring{"jam"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_pfp}~$\ocwstring{"d.r\#1"}~$(\ocwlowerid{revcode}~$\ocwstring{"d.r"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_pfp}~$\ocwstring{"vadh"}~$(\ocwlowerid{revcode}~$\ocwstring{"vadh"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part}~(\ocwupperid{Pprm\_}~1~\ocwupperid{Primary}~(\ocwlowerid{revcode}~$\ocwstring{"gacchamaana"}$)~$\ocwstring{"gam"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_part}~(\ocwupperid{Pprm\_}~4~\ocwupperid{Primary}~(\ocwlowerid{revcode}~$\ocwstring{"kaayamaana"}$)~$\ocwstring{"kan"}$)$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_auxi\_kridantas}~()~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stems}~\ocwlowerid{str}~=~$\ocwkw{let}~$\ocwlowerid{st}~=~\ocwlowerid{revstem}~\ocwlowerid{str}~$\ocwkw{in}~\ocwkw{match}~$\ocwlowerid{st}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~1~::~\ocwlowerid{rst}~]~\rightarrow{}~(\ocwlowerid{rst},\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{st})~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"auxi\_kridantas"}~\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}~\ocwkw{do}~\ocwbc{} A few auxiliary action nouns are generative for cvi compounds \ocwec{}\ocweol
\ocwindent{1.00em}
\{~\ocwkw{let}~$(\ocwlowerid{rst},\ocwlowerid{st})~=~\ocwlowerid{stems}~$\ocwstring{"kara.na"}~\ocwkw{in}~\ocweol
\ocwindent{2.00em}
$\ocwlowerid{build\_part\_a\_n}~(\ocwupperid{Primary},\ocwupperid{Action\_noun})~\ocwlowerid{rst}~\ocwlowerid{st}~$\ocwstring{"k.r\#1"}~\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$(\ocwlowerid{rst},\ocwlowerid{st})~=~\ocwlowerid{stems}~$\ocwstring{"kaara"}~\ocwkw{in}~\ocwbc{} actually, should be \ocwbegindcode{}$\ocwupperid{Agent\_noun}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{build\_part\_a\_m}~(\ocwupperid{Primary},\ocwupperid{Action\_noun})~\ocwlowerid{rst}~\ocwlowerid{st}~$\ocwstring{"k.r\#1"}~\ocwbc{} also fem in -ii? \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$(\ocwlowerid{rst},\ocwlowerid{st})~=~\ocwlowerid{stems}~$\ocwstring{"bhaavana"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{build\_part\_a\_m}~(\ocwupperid{Primary},\ocwupperid{Action\_noun})~\ocwlowerid{rst}~\ocwlowerid{st}~$\ocwstring{"bhuu\#1"}\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$(\ocwlowerid{rst},\ocwlowerid{st})~=~\ocwlowerid{stems}~$\ocwstring{"bhaava"}~\ocwkw{in}~\ocweol
\ocwindent{2.00em}
$\ocwlowerid{build\_part\_a\_m}~(\ocwupperid{Primary},\ocwupperid{Action\_noun})~\ocwlowerid{rst}~\ocwlowerid{st}~$\ocwstring{"bhuu\#1"}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Called by \ocwbegindcode{}$\ocwupperid{Make\_roots}.\ocwlowerid{roots\_to\_conjugs}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_conjugs}~\ocwlowerid{root}~(\ocwlowerid{infos}~:~\ocwupperid{Conj\_infos.}\ocwlowerid{root\_infos})~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~\ocwkw{let}~$\ocwlowerid{root\_entry}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{root}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{compute\_conjugs\_stems}~\ocwlowerid{root\_entry}~\ocwlowerid{infos}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_participles}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_participles}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_auxi\_kridantas}~()$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Supplementary forms \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_extra\_car}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~$\ocwstring{"car"}~$(\ocwupperid{Absotvaa}~\ocwupperid{Primary}~(\ocwlowerid{code}~$\ocwstring{"cartvaa"}$))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"car"}~$(\ocwupperid{Absotvaa}~\ocwupperid{Primary}~(\ocwlowerid{code}~$\ocwstring{"ciirtvaa"}$))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"car"}~$(\ocwupperid{Invar}~(\ocwupperid{Primary},\ocwupperid{Infi})~(\ocwlowerid{code}~$\ocwstring{"cartum"}$))~$\ocwbc{} epic \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.50em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_zru}~()~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~$\ocwstring{"zru"}~\ocwbc{} ved écoute \ocwec{}~\ocweol
\ocwindent{4.50em}
$(\ocwupperid{Conju}~(\ocwlowerid{impera}~5)~[~(\ocwupperid{Singular},[~(\ocwupperid{Second},~\ocwlowerid{code}~$\ocwstring{"zrudhi"}$)~])~])$\ocweol
\ocwindent{0.00em}
\ocwbc{} TODO  (Subjunctive \ocwbegindcode{}~$(\ocwupperid{Singular},[~(\ocwupperid{Third},~\ocwlowerid{code}~$\ocwstring{"zro.sat"}$)~])~$\ocwenddcode{}) 
         \ocwstring{"qu'il\ocwvspace{}(dieu)\ocwvspace{}nous\ocwvspace{}entende"} but could be just injunctive like vocat ? \ocwec{}\ocweol
\ocwindent{0.50em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_muc}~()~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~\ocwbc{} ved precative `fasse que je sois libéré' \ocwec{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{enter1}~$\ocwstring{"muc\#1"}~$(\ocwupperid{Conju}~\ocwlowerid{benem}~[~(\ocwupperid{Singular},[~(\ocwupperid{First},~\ocwlowerid{code}~$\ocwstring{"muk.siiya"}$)~])~])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{build\_infinitive}~\ocwupperid{Causative}~(\ocwlowerid{revcode}~$\ocwstring{"moci"}$)~$\ocwstring{"muc\#1"}~\ocwbc{} Whitney§1051c \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.50em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_prr}~()~=~$\ocwbc{} paaryate as well as puuryate above \ocwec{}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~$\ocwstring{"paar"}~\ocwkw{in}~$\ocwlowerid{compute\_passive}~\ocwupperid{Primary}~$\ocwstring{"p.rr"}~$\ocwlowerid{stem}$\ocweol
\ocwindent{0.50em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_rc}~()~=~$\ocwbc{} vedic - \Pan{7,1,38} \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~$\ocwstring{".rc\#1"}~$(\ocwupperid{Absotvaa}~\ocwupperid{Primary}~(\ocwlowerid{code}~$\ocwstring{"arcya"}$))~$\ocwbc{} abs -ya with no preverb \ocwec{}\ocweol
\ocwindent{0.50em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_zaas}~()~=~$\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$\ocwlowerid{e}~=~$\ocwstring{"zaas"}~\ocwkw{in}~\ocwkw{do}~\ocwbc{} epics zaasyate + Renou gram §29 \ocwec{}~\ocweol
\ocwindent{2.50em}
\{~\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{revcode}~\ocwlowerid{e}~$\ocwkw{in}~$\ocwlowerid{compute\_passive}~\ocwupperid{Primary}~\ocwlowerid{e}~\ocwlowerid{stem}~$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{enter1}~\ocwlowerid{e}~(\ocwupperid{Conju}~(\ocwupperid{Primary},\ocwlowerid{via}~2)~[~(\ocwupperid{Singular},[~(\ocwupperid{Second},~\ocwlowerid{code}~$\ocwstring{"azaat"}$)~])~])$\ocweol
\ocwindent{2.50em}
\}\ocweol
\ocwindent{0.50em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_dhaa}~()~=~$\ocwbc{} Gaayatrii dhiimahi precative m. Whitney§837b \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~$\ocwstring{"dhaa\#1"}~$(\ocwupperid{Conju}~\ocwlowerid{benem}~[~(\ocwupperid{Plural},[~(\ocwupperid{First},~\ocwlowerid{code}~$\ocwstring{"dhiimahi"}$)~])~])$\ocweol
\ocwindent{0.00em}
\ocwbc{} also \ocwstring{"vidmahi"} on yantra ? \ocwec{}\ocweol
\ocwindent{0.50em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_cud}~()~=~$\ocwbc{} Gaayatrii pracodayaat \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~$\ocwstring{"cud"}~$(\ocwupperid{Conju}~\ocwlowerid{benea}~[~(\ocwupperid{Singular},[~(\ocwupperid{Third},~\ocwlowerid{code}~$\ocwstring{"codayaat"}$)~])~])$\ocweol
\ocwindent{0.50em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_bhr}~()~=~$\ocwbc{} Epics sa.mbhriyantu Oberlies 8.7 \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~$\ocwstring{"bh.r"}~$(\ocwupperid{Conju}~(\ocwupperid{Primary},\ocwlowerid{vmp})~[~(\ocwupperid{Plural},[~(\ocwupperid{Third},~\ocwlowerid{code}~$\ocwstring{"bhriyantu"}$)~])~])$\ocweol
\ocwindent{0.50em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_bhram}~()~=~$\ocwbc{} MW: Mah \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~$\ocwstring{"bhram"}~$(\ocwupperid{Conju}~\ocwlowerid{perfa}~[~(\ocwupperid{Plural},[~(\ocwupperid{Third},~\ocwlowerid{code}~$\ocwstring{"bhremur"}$)~])~])$\ocweol
\ocwindent{0.50em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_bhaas}~()~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~$\ocwstring{"bhaa.s"}~$(\ocwupperid{Invar}~(\ocwupperid{Primary},\ocwupperid{Infi})~(\ocwlowerid{code}~$\ocwstring{"bhaa.s.tum"}$))~$\ocwbc{} WR epic \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_hims}~()~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~\ocwbc{} Renou gram §29 \ocwec{}~$\ocwlowerid{enter1}~$\ocwstring{"hi.ms"}~\ocweol
\ocwindent{2.00em}
$(\ocwupperid{Conju}~(\ocwupperid{Primary},\ocwlowerid{via}~7)~[~(\ocwupperid{Singular},[~(\ocwupperid{Second},~\ocwlowerid{code}~$\ocwstring{"ahi.msat"}$)~])~])$\ocweol
\ocwindent{1.00em}
;~\ocwbc{} MW \ocwec{}~$\ocwlowerid{enter1}~$\ocwstring{"hi.ms"}~\ocweol
\ocwindent{2.00em}
$(\ocwupperid{Conju}~(\ocwlowerid{presa}~7)~[~(\ocwupperid{Singular},[~(\ocwupperid{Second},~\ocwlowerid{code}~$\ocwstring{"hi.msi"}$)~])~])$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_nind}~()~=~$\ocwbc{} WR: RV \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter1}~$\ocwstring{"nand"}~$(\ocwupperid{Conju}~\ocwlowerid{perfa}~[~(\ocwupperid{Plural},[~(\ocwupperid{Third},~\ocwlowerid{code}~$\ocwstring{"ninidus"}$)~])$\ocweol
\ocwindent{14.50em}
;~$(\ocwupperid{Plural},[~(\ocwupperid{First},~\ocwlowerid{code}~$\ocwstring{"nindimas"}$)~])~])$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_sanj}~()~=~$\ocwbc{} WR \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{root}~=~$\ocwstring{"sa\~{}nj"}~\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conj}~=~\ocwupperid{Primary}$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{pastem}~=~\ocwlowerid{revcode}~$\ocwstring{"sajj"}~\ocwbc{} \ocwstring{"y"} replaced by j in passive \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{compute\_passive\_system}~\ocwlowerid{conj}~\ocwlowerid{root}~\ocwlowerid{pastem}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_khan}~()~=~$\ocwbc{} WR MW \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{root}~=~$\ocwstring{"khan"}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{conj}~=~\ocwupperid{Primary}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{pstem}~=~\ocwlowerid{revcode}~$\ocwstring{"khaa"}~\ocwbc{} khaa substituted optionally in ps \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{compute\_passive}~\ocwlowerid{conj}~\ocwlowerid{root}~\ocwlowerid{pstem}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_vadh}~()~=~$\ocwbc{} no present - use \ocwstring{"han\#1"} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{root}~=~$\ocwstring{"vadh"}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{rstem}~=~\ocwlowerid{revcode}~$\ocwstring{"vadh"}~\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_aorist}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_future\_gen}~\ocwlowerid{rstem}~\ocwlowerid{root}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_passive\_raw}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{record\_pfp}~\ocwlowerid{root}~\ocwlowerid{rstem}$\ocwenddcode{} is computed by \ocwbegindcode{}$\ocwlowerid{compute\_extra\_participles}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_skand}~()~=~$\ocwkw{do}~\ocwbc{} WR \ocwec{}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{enter1}~$\ocwstring{"skand"}~$(\ocwupperid{Invar}~(\ocwupperid{Primary},\ocwupperid{Infi})~(\ocwlowerid{code}~$\ocwstring{"skanditum"}$))~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_abso\_ya}~(\ocwlowerid{code}~$\ocwstring{"skadya"}$)~$\ocwstring{"skand"}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_syand}~()~=~$\ocwkw{do}~\ocwbc{} WR \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{record\_abso\_tvaa}~(\ocwlowerid{code}~$\ocwstring{"syattvaa"}$)~$\ocwstring{"syand"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{record\_abso\_ya}~(\ocwlowerid{code}~$\ocwstring{"syadya"}$)~$\ocwstring{"syand"}~\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{compute\_extra\_huu}~()~=~$\ocwkw{do}~\ocwbc{} WR \ocwec{}\ocweol
\ocwindent{1.50em}
\{~$\ocwlowerid{compute\_futurem}~\ocwupperid{Primary}~(\ocwlowerid{revstem}~$\ocwstring{"hvaasy"}$)~$\ocwstring{"huu"}~\ocweol
\ocwindent{1.50em}
;~$\ocwlowerid{enter1}~$\ocwstring{"huu"}~$(\ocwupperid{Invar}~(\ocwupperid{Primary},\ocwupperid{Infi})~(\ocwlowerid{code}~$\ocwstring{"hvayitum"}$))~$\ocweol
\ocwindent{1.50em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} For verbs without present forms and variants, \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} called by \ocwbegindcode{}$\ocwupperid{Make\_roots}.\ocwlowerid{verbs\_to\_conjugs}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_extra}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{compute\_perfect}~$\ocwstring{"ah"}~\ocwbc{} verbs with no present system \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_perfect}~$\ocwstring{"kam"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_aorist}~$\ocwstring{"kan"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_perfect}~$\ocwstring{"kam"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_perfect}~$\ocwstring{"ghas"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_perfect}~$\ocwstring{"ta.d"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_perfect}~$\ocwstring{"spaz\#1"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_aorist}~$\ocwstring{"spaz\#1"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_aorist}~$\ocwstring{"k.r\#2"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_vadh}~()~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_passive\_raw}~$\ocwstring{"d.r\#1"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_passive\_raw}~$\ocwstring{"p.r\#2"}\ocweol
\ocwindent{1.00em}
\ocwbc{} Now for specific extra forms \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_rc}~()~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_khan}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_car}~()~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_cud}~()~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_dhaa}~()~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_nind}~()~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_prr}~()~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_bhaas}~()~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_bhr}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_bhram}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_muc}~()~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_vadh}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_zaas}~()~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_zru}~()~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_sanj}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_skand}~()~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_syand}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_hims}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{compute\_extra\_huu}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{build\_infinitive}~\ocwupperid{Primary}~(\ocwlowerid{revcode}~$\ocwstring{"rami"}$)~$\ocwstring{"ram"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{build\_infinitive}~\ocwupperid{Causative}~(\ocwlowerid{revcode}~$\ocwstring{"bhaavi"}$)~$\ocwstring{"bhuu\#1"}~\ocwbc{} Whitney§1051c \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{build\_infinitive}~\ocwupperid{Causative}~(\ocwlowerid{revcode}~$\ocwstring{"dhaari"}$)~$\ocwstring{"dh.r"}~\ocwbc{} Whitney§1051c \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{build\_infinitive}~\ocwupperid{Causative}~(\ocwlowerid{revcode}~$\ocwstring{"ze.si"}$)~$\ocwstring{"zi.s"}~\ocwbc{} Whitney§1051c \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{build\_infinitive}~\ocwupperid{Causative}~(\ocwlowerid{revcode}~$\ocwstring{"j\~{}naap"}$)~$\ocwstring{"j\~{}naa\#1"}~\ocwbc{} WR epics \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwbc{} Infinitives in -as (kasun k.rt) \Pan{3,4,17} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"s.rp"}~$(\ocwupperid{Invar}~(\ocwupperid{Primary},\ocwupperid{Infi})~(\ocwlowerid{code}~$\ocwstring{"s.rpas"}$))~$\ocwbc{} vi.s.rpas \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{enter1}~$\ocwstring{"t.rd"}~$(\ocwupperid{Invar}~(\ocwupperid{Primary},\ocwupperid{Infi})~(\ocwlowerid{code}~$\ocwstring{"t.rdas"}$))~$\ocwbc{} aat.rdas \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{st}~=~\ocwlowerid{revcode}~$\ocwstring{"si.saadhayi.s"}~\ocwkw{in}~\ocwbc{} des of ca of sidh1 \ocwec{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{compute\_desiderativea}~\ocwlowerid{st}~$\ocwstring{"saadh"}~$[\,]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Called by \ocwbegindcode{}$\ocwupperid{Conjugation}.\ocwlowerid{look\_up}$\ocwenddcode{} and \ocwbegindcode{}$\ocwupperid{Morpho\_debug}.\ocwlowerid{test\_conj}$\ocwenddcode{}            \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Remark. For the present system only the queried \ocwbegindcode{}$\ocwlowerid{gana}$\ocwenddcode{} is displayed,    \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} but all forms of other systems are displayed after it.                  \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} It is for the moment impossible to list forms of roots without present. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fake\_compute\_conjugs}~(\ocwlowerid{gana}~:~$\ocwbt{int}$)~(\ocwlowerid{entry}~:~$\ocwbt{string}$)~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{morpho\_gen.}\ocwlowerid{val}~:=~\ocwupperid{False}~$\ocwbc{} Do not generate phantom forms \ocwec{}~\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{no\_third}~=~[\,]~$\ocwkw{and}~$\ocwlowerid{pada}~=~\ocwupperid{True}~$\ocwkw{in}~\ocwbc{} hacks to disable check warning \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{vmorph}~=~\ocwupperid{Conj\_infos.Prim}~\ocwlowerid{gana}~\ocwlowerid{pada}~\ocwlowerid{no\_third}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{compute\_conjugs\_stems}~\ocwlowerid{entry}~(\ocwlowerid{vmorph},\ocwupperid{False})$\ocweol
\ocwindent{2.00em}
;~\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocwbc{} extra forms - to be completed from \ocwbegindcode{}$\ocwlowerid{compute\_extra}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{3.00em}
$[~$\ocwstring{".rc\#1"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_rc}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"khan"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_khan}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"gup"}~$\rightarrow{}~\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{revcode}~$\ocwstring{"gupta"}$)~\ocwlowerid{entry}~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"car"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_car}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"cud"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_cud}~()~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"dhaa\#1"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_dhaa}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"nind"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_nind}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"p.rr"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_prr}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"bhaa.s"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_bhaas}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"bh.r"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_bhr}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"bhram"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_bhram}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"muc\#1"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_muc}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"vadh"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_vadh}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"zaa"}~$\rightarrow{}~\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{revcode}~$\ocwstring{"zaata"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"zaas"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_zaas}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"zru"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_zru}~()~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"sa\~{}nj"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_sanj}~()~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"skand"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_skand}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"spaz\#1"}~$\rightarrow{}~\ocwlowerid{record\_part\_ppp}~(\ocwlowerid{revcode}~$\ocwstring{"spa.s.ta"}$)~\ocwlowerid{entry}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"syand"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_syand}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"hi.ms"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_hims}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"huu"}~$\rightarrow{}~\ocwlowerid{compute\_extra\_huu}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Parts.ml}
\ocwmodule{Parts}
\label{parts.ml:0}%
Computes the declensions of participles from stored stems.
\ocweol
\label{parts.ml:715}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Encode};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{rev\_code\_string}$\ocwenddcode{}, \ocwbegindcode{}$\ocwlowerid{code\_string}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phonetics};~$\ocwbc{} monosyllabic aug \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Inflected};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{enter}~\ocwlowerid{enter1}~\ocwlowerid{enter\_form}~\ocwlowerid{enter\_forms}~\ocwlowerid{access\_krid}~\ocwlowerid{register\_krid}$\ocwenddcode{} \ocwec{}\medskip

\label{parts.ml:909}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{mirror}~=~\ocwupperid{Word.}\ocwlowerid{mirror}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Used for storing participial stems in the \ocwbegindcode{}$\ocwlowerid{participles}$\ocwenddcode{} list. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} This structure is essential for fast online computation of verbal forms. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Beware - the stem argument is a reversed word, the string is the root. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{memo\_part}~=$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Ppp\_}~$\ocwkw{of}~$\ocwlowerid{conjugation}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~\ocwbt{string}~\ocwbc{} Past Passive Part \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pppa\_}~$\ocwkw{of}~$\ocwlowerid{conjugation}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~\ocwbt{string}~\ocwbc{} Past Active Part \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppra\_}~$\ocwkw{of}~$\ocwlowerid{gana}~$\ocwkw{and}~$\ocwlowerid{conjugation}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~\ocwbt{string}~\ocwbc{} Present Active Part \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pprared\_}~$\ocwkw{of}~$\ocwlowerid{conjugation}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~\ocwbt{string}~\ocwbc{} idem reduplicated \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pprm\_}~$\ocwkw{of}~$\ocwlowerid{gana}~$\ocwkw{and}~$\ocwlowerid{conjugation}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~\ocwbt{string}~\ocwbc{} Present Middle Part \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pprp\_}~$\ocwkw{of}~$\ocwlowerid{conjugation}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~\ocwbt{string}~\ocwbc{} Present Passive Part \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppfta\_}~$\ocwkw{of}~$\ocwlowerid{conjugation}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~\ocwbt{string}~\ocwbc{} Perfect Active Part \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppftm\_}~$\ocwkw{of}~$\ocwlowerid{conjugation}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~\ocwbt{string}~\ocwbc{} Perfect Middle Part \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfutm\_}~$\ocwkw{of}~$\ocwlowerid{conjugation}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~\ocwbt{string}~\ocwbc{} Future Middle Part \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfuta\_}~$\ocwkw{of}~$\ocwlowerid{conjugation}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~\ocwbt{string}~\ocwbc{} Future Active Part \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfutp\_}~$\ocwkw{of}~$\ocwlowerid{conjugation}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~\ocwbt{string}~\ocwbc{} Future Passive Part \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Special gana values for present forms of secondary conjugations \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{cau\_gana}~=~12$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{des\_gana}~=~13$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{int\_gana}~=~14$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} This is to avoid redundant generation of present system participles
   when stems may come from a distinct gana. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{redundant\_gana}~\ocwlowerid{k}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"svap"}~$\rightarrow{}~\ocwlowerid{k}=1$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"rud\#1"}~$\rightarrow{}~\ocwlowerid{k}=6$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Affixing a suffix to a (reversed) stem \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{fix}:~\ocwupperid{Word}.\ocwlowerid{word}~\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~\ocwupperid{Word}.\ocwlowerid{word}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fix}~\ocwlowerid{revstem}~\ocwlowerid{suff}~=~$\ocweol
\ocwindent{1.00em}
$\ocwupperid{Int\_sandhi.}\ocwlowerid{int\_sandhi}~\ocwlowerid{revstem}~(\ocwlowerid{code\_string}~\ocwlowerid{suff})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rfix}~\ocwlowerid{revstem}~\ocwlowerid{suff}~=~\ocwlowerid{mirror}~(\ocwlowerid{fix}~\ocwlowerid{revstem}~\ocwlowerid{suff})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fix\_augment}~\ocwlowerid{revstem}~\ocwlowerid{suff}~=~\ocwlowerid{aug}~(\ocwlowerid{fix}~\ocwlowerid{revstem}~\ocwlowerid{suff})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} NB. Internal sandhi will take care of consonant elision in e.g.
ppp \ocwstring{"tak.s"} = \ocwstring{"tak.s"}+\ocwstring{"ta"}=\ocwstring{"ta.s.ta"} 
idem for cak.s tvak.s Pan{8,2,29} \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Generation of unique names for kridantas, specially participial stems 
\ocweol
\label{parts.ml:2995}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{gensym}~\ocwlowerid{stem}~\ocwlowerid{n}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{n}=0~$\ocwkw{then}~$\ocwlowerid{stem}~$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~$\ocwlowerid{mirror}~[~(\ocwlowerid{n}+50)~::~\ocwlowerid{mirror}~\ocwlowerid{stem}~]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We look up in the kridantas database if the given stem has been registered
   (possibly with some homo index) for the same (verbal,root). If not, we 
   generate the name affixing to stem the next available homo \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{gen\_stem}~(\ocwlowerid{k},\ocwlowerid{root})~\ocwlowerid{stem}~=~$\ocwbc{} stem is a bare stem with no homo index \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{morpho\_gen.}\ocwlowerid{val}~$\ocwkw{then}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{etym}~=~(\ocwlowerid{k},\ocwlowerid{code\_string}~\ocwlowerid{root})~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{alist}~=~\ocwlowerid{access\_krid}~\ocwlowerid{stem}~$\ocwkw{in}~\ocweol
\ocwindent{2.50em}
\ocwkw{try}~$\ocwlowerid{gensym}~\ocwlowerid{stem}~(\ocwupperid{List.}\ocwlowerid{assoc}~\ocwlowerid{etym}~\ocwlowerid{alist})~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Not\_found}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{alist}~$\ocwkw{with}~\ocweol
\ocwindent{5.00em}
$[~[\,]~\rightarrow{}~$\ocwbc{} no current homonym of stem \ocwec{}~\ocwkw{do}~\ocweol
\ocwindent{6.00em}
\{~$\ocwlowerid{register\_krid}~\ocwlowerid{stem}~(\ocwlowerid{etym},0)$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{stem}$\ocweol
\ocwindent{6.00em}
\}\ocweol
\ocwindent{5.00em}
$\mid{}~[~(\ocwlowerid{\_},\ocwlowerid{n})~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwbc{} last homonym entered \ocwbegindcode{}$\ocwlowerid{stem\_n}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{6.00em}
\ocwkw{let}~$\ocwlowerid{p}=\ocwlowerid{n}+1~$\ocwkw{in}~\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{p}>9~$\ocwkw{then}~$\ocwlowerid{failwith}~$\ocwstring{"Gensym\ocwvspace{}exceeds\ocwvspace{}homo\ocwvspace{}index"}~\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{6.00em}
\{~$\ocwlowerid{register\_krid}~\ocwlowerid{stem}~(\ocwlowerid{etym},\ocwlowerid{p})$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{gensym}~\ocwlowerid{stem}~\ocwlowerid{p}$\ocweol
\ocwindent{6.00em}
\}\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~$\ocwlowerid{stem}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Now for participle forming paradigms \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Similar to \ocwbegindcode{}$\ocwupperid{Nouns}.\ocwlowerid{build\_mas\_at}~[1~::~\ocwlowerid{stem}]$\ocwenddcode{} if vat=False
   and to \ocwbegindcode{}$\ocwupperid{Nouns}.\ocwlowerid{build\_mas\_mat}~\ocwlowerid{stem}$\ocwenddcode{} if vat=True 
\ocweol
\label{parts.ml:4134}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_part\_at\_m}~\ocwlowerid{vat}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{stem\_at}~\ocwlowerid{root}~=~$\ocwbc{} invoked by \ocwbegindcode{}$\ocwupperid{Ppra\_}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gen\_entry}~=~\ocwlowerid{gen\_stem}~(\ocwlowerid{verbal},\ocwlowerid{root})~\ocwlowerid{stem\_at}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{krid}~=~\ocwupperid{Krid}~\ocwlowerid{verbal}~\ocwlowerid{root}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter\_forms}~\ocwlowerid{gen\_entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwlowerid{krid}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"an"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~($\ocwkw{if}~$\ocwlowerid{vat}~$\ocwkw{then}~\ocwstring{"aan"}~\ocwkw{else}~\ocwstring{"an"}$)$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"antam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ataa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ate"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ati"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"antau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"antau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"antau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"atos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"atos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"antas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"antas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"adbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"adbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"adbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ataam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"atsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwlowerid{krid}~\ocwlowerid{stem\_at}~$\ocwbc{} e.g. b.rhadazva \ocwec{}\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Similar to \ocwbegindcode{}$\ocwupperid{Nouns}.\ocwlowerid{build\_mas\_red}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_part\_at\_m\_red}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{stem\_at}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gen\_entry}~=~\ocwlowerid{gen\_stem}~(\ocwlowerid{verbal},\ocwlowerid{root})~\ocwlowerid{stem\_at}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{krid}~=~\ocwupperid{Krid}~\ocwlowerid{verbal}~\ocwlowerid{root}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter\_forms}~\ocwlowerid{gen\_entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwlowerid{krid}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"at"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"at"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"atam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ataa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ate"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ati"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"atau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"atau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"atau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"atos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"atos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"adbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"adbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"adbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ataam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"atsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwlowerid{krid}~\ocwlowerid{stem\_at}~$\ocwbc{} at - e.g. b.rhadazva \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Similar to \ocwbegindcode{}$\ocwupperid{Nouns}.\ocwlowerid{build\_neu\_at}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_part\_at\_n}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{stem\_at}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gen\_entry}~=~\ocwlowerid{gen\_stem}~(\ocwlowerid{verbal},\ocwlowerid{root})~\ocwlowerid{stem\_at}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{krid}~=~\ocwupperid{Krid}~\ocwlowerid{verbal}~\ocwlowerid{root}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter\_forms}~\ocwlowerid{gen\_entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwlowerid{krid}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"at"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"at"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"at"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ataa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ate"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ati"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"atii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"antii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"atii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"antii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"atii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"antii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"atos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"atos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"anti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"anti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"anti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"adbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"adbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"adbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ataam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"atsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwlowerid{krid}~\ocwlowerid{stem\_at}~$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Similar to \ocwbegindcode{}$\ocwupperid{Nouns}.\ocwlowerid{build\_neu\_red}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_part\_at\_n\_red}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{stem\_at}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gen\_entry}~=~\ocwlowerid{gen\_stem}~(\ocwlowerid{verbal},\ocwlowerid{root})~\ocwlowerid{stem\_at}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{krid}~=~\ocwupperid{Krid}~\ocwlowerid{verbal}~\ocwlowerid{root}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter\_forms}~\ocwlowerid{gen\_entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwlowerid{krid}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"at"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"at"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"atam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ataa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ate"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"atas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ati"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"atii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"atii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"atii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"adbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"atos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"atos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"ati"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"anti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ati"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"anti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"ati"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"anti"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"adbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"adbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"adbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ataam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"atsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwlowerid{krid}~\ocwlowerid{stem\_at}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Similar to \ocwbegindcode{}$\ocwupperid{Nouns}.\ocwlowerid{build\_fem\_ii}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_part\_ii}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{prati}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem\_ii}~=~\ocwlowerid{mirror}~[~4~::~\ocwlowerid{stem}~]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gen\_entry}~=~\ocwlowerid{gen\_stem}~(\ocwlowerid{verbal},\ocwlowerid{root})~\ocwlowerid{prati}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{krid}~=~\ocwupperid{Krid}~\ocwlowerid{verbal}~\ocwlowerid{root}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter\_forms}~\ocwlowerid{gen\_entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwlowerid{krid}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"i"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"ii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iim"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"yaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"yai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"yaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"yaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"yaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"yau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"yau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"yau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iibhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"yos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"yos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"yas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"yas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"iis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"iibhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"iibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"iibhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"iinaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ii.su"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwlowerid{krid}~\ocwlowerid{stem\_ii}~$\ocwbc{} productive ? \ocwec{}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Similar to \ocwbegindcode{}$\ocwupperid{Nouns}.\ocwlowerid{build\_mas\_a}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_part\_a\_m}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{prati}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gen\_entry}~=~\ocwlowerid{gen\_stem}~(\ocwlowerid{verbal},\ocwlowerid{root})~\ocwlowerid{prati}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{krid}~=~\ocwupperid{Krid}~\ocwlowerid{verbal}~\ocwlowerid{root}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter\_forms}~\ocwlowerid{gen\_entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwlowerid{krid}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"a"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"as"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ena"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aaya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"asya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"au"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ais"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aanaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"esu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwlowerid{krid}~\ocwlowerid{prati}$\ocweol
\ocwindent{1.50em}
\ocwbc{} what follows needs adapting \ocwbegindcode{}$\ocwupperid{Inflected}.\ocwlowerid{enter\_form}$\ocwenddcode{}
   ; Avyayaf (fix stem \ocwstring{"am"}) \ocwbc{} yathaav.rddham \ocwec{}  
     possible Cvi usage: see \ocwbegindcode{}$\ocwupperid{Nouns}.\ocwlowerid{iiv\_krids}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Similar to \ocwbegindcode{}$\ocwupperid{Nouns}.\ocwlowerid{build\_neu\_a}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_part\_a\_n}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{prati}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gen\_entry}~=~\ocwlowerid{gen\_stem}~(\ocwlowerid{verbal},\ocwlowerid{root})~\ocwlowerid{prati}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{krid}~=~\ocwupperid{Krid}~\ocwlowerid{verbal}~\ocwlowerid{root}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter\_forms}~\ocwlowerid{gen\_entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwlowerid{krid}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"a"}\ocweol
\ocwindent{3.50em}
\ocwbc{} decline Voc \ocwstring{"am"} - rare - disconnected for avoiding overgeneration \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"am"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ena"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aaya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"asya"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aani"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ais"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"ebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"ebhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aanaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"esu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Bare}~\ocwlowerid{krid}~\ocwlowerid{prati}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Similar to \ocwbegindcode{}$\ocwupperid{Nouns}.\ocwlowerid{build\_fem\_aa}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_part\_aa}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{prati}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gen\_entry}~=~\ocwlowerid{gen\_stem}~(\ocwlowerid{verbal},\ocwlowerid{root})~\ocwlowerid{prati}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{krid}~=~\ocwupperid{Krid}~\ocwlowerid{verbal}~\ocwlowerid{root}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter\_forms}~\ocwlowerid{gen\_entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwlowerid{krid}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"ayaa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aayai"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aayaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aayaas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"aayaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"e"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"ayos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"aas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"aabhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"aabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"aabhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"aanaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"aasu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Similar to \ocwbegindcode{}$\ocwupperid{Nouns}.\ocwlowerid{build\_mas\_vas}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Except for proper intercalation of i \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_mas\_ppfa}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{inter}~\ocwlowerid{stem\_vas}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gen\_entry}~=~\ocwlowerid{gen\_stem}~(\ocwlowerid{verbal},\ocwlowerid{root})~\ocwlowerid{stem\_vas}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{krid}~=~\ocwupperid{Krid}~\ocwlowerid{verbal}~\ocwlowerid{root}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinev}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suffi})~\ocwlowerid{where}~$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{suffi}~=~$\ocwkw{if}~$\ocwlowerid{inter}~$\ocwkw{then}~\ocwstring{"i"}~\^{}~$\ocwlowerid{suff}~$\ocwkw{else}~$\ocwlowerid{suff}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter\_forms}~\ocwlowerid{gen\_entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwlowerid{krid}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinev}~\ocwupperid{Voc}~$\ocwstring{"van"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Nom}~$\ocwstring{"vaan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Acc}~$\ocwstring{"vaa.msam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"u.saa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"u.se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"u.si"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinev}~\ocwupperid{Voc}~$\ocwstring{"vaa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Nom}~$\ocwstring{"vaa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Acc}~$\ocwstring{"vaa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Ins}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Dat}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Abl}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.sos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"u.sos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinev}~\ocwupperid{Voc}~$\ocwstring{"vaa.msas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Nom}~$\ocwstring{"vaa.msas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Ins}~$\ocwstring{"vadbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Dat}~$\ocwstring{"vadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Abl}~$\ocwstring{"vadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.saam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Loc}~$\ocwstring{"vatsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Similar to \ocwbegindcode{}$\ocwupperid{Nouns}.\ocwlowerid{build\_neu\_vas}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_neu\_ppfa}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{inter}~\ocwlowerid{stem\_vas}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gen\_entry}~=~\ocwlowerid{gen\_stem}~(\ocwlowerid{verbal},\ocwlowerid{root})~\ocwlowerid{stem\_vas}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{krid}~=~\ocwupperid{Krid}~\ocwlowerid{verbal}~\ocwlowerid{root}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{decline}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suff})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{declinev}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~\ocwlowerid{suffi})~\ocwlowerid{where}~$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{suffi}~=~$\ocwkw{if}~$\ocwlowerid{inter}~$\ocwkw{then}~\ocwstring{"i"}~\^{}~$\ocwlowerid{suff}~$\ocwkw{else}~$\ocwlowerid{suff}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{enter\_forms}~\ocwlowerid{gen\_entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwlowerid{krid}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinev}~\ocwupperid{Voc}~$\ocwstring{"vat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Nom}~$\ocwstring{"vat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Acc}~$\ocwstring{"vat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Ins}~$\ocwstring{"u.saa"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Dat}~$\ocwstring{"u.se"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Abl}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.sas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"u.si"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{decline}~\ocwupperid{Voc}~$\ocwstring{"u.sii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Nom}~$\ocwstring{"u.sii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Acc}~$\ocwstring{"u.sii"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Ins}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Dat}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Abl}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.sos"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Loc}~$\ocwstring{"u.sos"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinev}~\ocwupperid{Voc}~$\ocwstring{"vaa.msi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Nom}~$\ocwstring{"vaa.msi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Acc}~$\ocwstring{"vaa.msi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Ins}~$\ocwstring{"vadbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Dat}~$\ocwstring{"vadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Abl}~$\ocwstring{"vadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{decline}~\ocwupperid{Gen}~$\ocwstring{"u.saam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Loc}~$\ocwstring{"vatsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Supplementary forms with intercalation of i \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_more\_ppfa}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{stem\_vas}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gen\_entry}~=~\ocwlowerid{gen\_stem}~(\ocwlowerid{verbal},\ocwlowerid{root})~\ocwlowerid{stem\_vas}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{krid}~=~\ocwupperid{Krid}~\ocwlowerid{verbal}~\ocwlowerid{root}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{declinev}~\ocwlowerid{case}~\ocwlowerid{suff}~=~(\ocwlowerid{case},\ocwlowerid{fix}~\ocwlowerid{stem}~($\ocwstring{"i"}~\^{}~$\ocwlowerid{suff}))~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.50em}
\{~$\ocwlowerid{enter\_forms}~\ocwlowerid{gen\_entry}~$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Declined}~\ocwlowerid{krid}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinev}~\ocwupperid{Voc}~$\ocwstring{"van"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Nom}~$\ocwstring{"vaan"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Acc}~$\ocwstring{"vaa.msam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinev}~\ocwupperid{Voc}~$\ocwstring{"vaa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Nom}~$\ocwstring{"vaa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Acc}~$\ocwstring{"vaa.msau"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Ins}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Dat}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Abl}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinev}~\ocwupperid{Voc}~$\ocwstring{"vaa.msas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Nom}~$\ocwstring{"vaa.msas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Ins}~$\ocwstring{"vadbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Dat}~$\ocwstring{"vadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Abl}~$\ocwstring{"vadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Loc}~$\ocwstring{"vatsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Declined}~\ocwlowerid{krid}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.50em}
$[~(\ocwupperid{Singular},$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinev}~\ocwupperid{Voc}~$\ocwstring{"vat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Nom}~$\ocwstring{"vat"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Acc}~$\ocwstring{"vat"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Dual},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinev}~\ocwupperid{Ins}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Dat}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Abl}~$\ocwstring{"vadbhyaam"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
;~$(\ocwupperid{Plural},~$\ocweol
\ocwindent{4.00em}
$[~\ocwlowerid{declinev}~\ocwupperid{Voc}~$\ocwstring{"vaa.msi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Nom}~$\ocwstring{"vaa.msi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Acc}~$\ocwstring{"vaa.msi"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Ins}~$\ocwstring{"vadbhis"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Dat}~$\ocwstring{"vadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Abl}~$\ocwstring{"vadbhyas"}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{declinev}~\ocwupperid{Loc}~$\ocwstring{"vatsu"}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.50em}
$]~]$\ocweol
\ocwindent{1.50em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_part\_a}~\ocwlowerid{part\_kind}~\ocwlowerid{stem}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{prati}~=~\ocwlowerid{mirror}~[~1~::~\ocwlowerid{stem}~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{build\_part\_a\_m}~\ocwlowerid{part\_kind}~\ocwlowerid{stem}~\ocwlowerid{prati}~\ocwlowerid{root}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{build\_part\_a\_n}~\ocwlowerid{part\_kind}~\ocwlowerid{stem}~\ocwlowerid{prati}~\ocwlowerid{root}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{build\_part\_aa}~\ocwlowerid{part\_kind}~\ocwlowerid{stem}~\ocwlowerid{prati}~\ocwlowerid{root}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{build\_part\_at}~\ocwlowerid{part\_kind}~\ocwlowerid{stem}~\ocwlowerid{stemf}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{prati}~=~\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"at"}~\ocwkw{in}~\ocwkw{do}~\ocwbc{} \ocwbegindcode{}$\ocwupperid{Ppra\_}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{build\_part\_at\_m}~\ocwupperid{False}~\ocwlowerid{part\_kind}~\ocwlowerid{stem}~\ocwlowerid{prati}~\ocwlowerid{root}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{build\_part\_at\_n}~\ocwlowerid{part\_kind}~\ocwlowerid{stem}~\ocwlowerid{prati}~\ocwlowerid{root}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{build\_part\_ii}~\ocwlowerid{part\_kind}~\ocwlowerid{stemf}~\ocwlowerid{prati}~\ocwlowerid{root}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{build\_part\_at\_red}~\ocwlowerid{part\_kind}~\ocwlowerid{stem}~\ocwlowerid{stemf}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{prati}~=~\ocwlowerid{mirror}~[~32~::~[~1~::~\ocwlowerid{stem}~]~]~$\ocwkw{in}~\ocwkw{do}~\ocwbc{} \ocwbegindcode{}$\ocwupperid{Pprared\_}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{build\_part\_at\_m\_red}~\ocwlowerid{part\_kind}~\ocwlowerid{stem}~\ocwlowerid{prati}~\ocwlowerid{root}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{build\_part\_at\_n\_red}~\ocwlowerid{part\_kind}~\ocwlowerid{stem}~\ocwlowerid{prati}~\ocwlowerid{root}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{build\_part\_ii}~\ocwlowerid{part\_kind}~\ocwlowerid{stemf}~\ocwlowerid{prati}~\ocwlowerid{root}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{build\_part\_vat}~\ocwlowerid{part\_kind}~\ocwlowerid{stem}~\ocwlowerid{stemf}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{prati}~=~\ocwlowerid{mirror}~[~32~::~[~1~::~\ocwlowerid{stem}~]~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{build\_part\_at\_m}~\ocwupperid{True}~\ocwlowerid{part\_kind}~\ocwlowerid{stem}~\ocwlowerid{prati}~\ocwlowerid{root}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{build\_part\_at\_n}~\ocwlowerid{part\_kind}~\ocwlowerid{stem}~\ocwlowerid{prati}~\ocwlowerid{root}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{build\_part\_ii}~\ocwlowerid{part\_kind}~\ocwlowerid{stemf}~\ocwlowerid{prati}~\ocwlowerid{root}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{build\_part\_vas}~\ocwlowerid{c}~\ocwlowerid{stem}~\ocwlowerid{inter}~\ocwlowerid{stemf}~\ocwlowerid{root}~=~$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{prati}~=~\ocwlowerid{fix}~\ocwlowerid{stem}~($\ocwkw{if}~$\ocwlowerid{inter}~$\ocwkw{then}~\ocwstring{"ivas"}~\ocwkw{else}~\ocwstring{"vas"}$)~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{verbal}~=~(\ocwlowerid{c},\ocwupperid{Ppfta})~$\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{build\_mas\_ppfa}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{inter}~\ocwlowerid{prati}~\ocwlowerid{root}~$\ocwbc{} (i)vas \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{build\_neu\_ppfa}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{inter}~\ocwlowerid{prati}~\ocwlowerid{root}~$\ocwbc{} (i)vas \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$(\ocwlowerid{root}=$\ocwstring{"d.rz\#1"}~$\lor{}~\ocwlowerid{root}=$\ocwstring{"vid\#2"}~$\lor{}~\ocwlowerid{root}=$\ocwstring{"viz\#1"}$)~\land{}~\ocwlowerid{c}=\ocwupperid{Primary}$\ocweol
\ocwindent{2.00em}
\ocwkw{then}~$\ocwlowerid{build\_more\_ppfa}~\ocwlowerid{verbal}~\ocwlowerid{stem}~\ocwlowerid{prati}~\ocwlowerid{root}~$\ocwbc{} Whitney §805b \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{build\_part\_ii}~\ocwlowerid{verbal}~\ocwlowerid{stemf}~\ocwlowerid{prati}~\ocwlowerid{root}~$\ocwbc{} u.sii \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Participles are stored here by calls in Verbs to \ocwbegindcode{}$\ocwlowerid{record\_part}$\ocwenddcode{} below; \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} this is necessary for the conjugation cgi to display participle stems \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} That is, the internal morphology generation is done in a first pass
   generating kridanta stems. The stems are declined in a second pass,
   reading from the participles list. This data structure holds just the
   lemmas of kridanta stems corresponding to one root. Then \ocwbegindcode{}$\ocwlowerid{compute\_participles}$\ocwenddcode{}
   invoked from \ocwbegindcode{}$\ocwupperid{Verbs}.\ocwlowerid{compute\_conjugs}$\ocwenddcode{} declines the stems to fill in the 
   morphology data banks for each root. This mechanism is also used by the
   conjugation engine, in order to display the kridanta stems associated to
   the argument root. Thus \ocwbegindcode{}$\ocwlowerid{participles}$\ocwenddcode{} is always a short list just used as
   a stack and not searched, so no need of sophisticated data structure. \ocwec{}\medskip

\label{parts.ml:19593}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{participles}~=~$\ocwbt{ref}~$([\,]~:~$\ocwbt{list}~$\ocwlowerid{memo\_part})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_part}~\ocwlowerid{memo}~=~$\ocwbc{} called from Verbs \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{participles.}\ocwlowerid{val}~:=~\ocwupperid{List2.}\ocwlowerid{union1}~\ocwlowerid{memo}~\ocwlowerid{participles.}\ocwlowerid{val}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Called by \ocwbegindcode{}$\ocwlowerid{compute\_participles}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_part}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Ppp\_}~\ocwlowerid{c}~\ocwlowerid{stem}~\ocwlowerid{root}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~[~1~::~\ocwlowerid{r}~]~\rightarrow{}~\ocwlowerid{build\_part\_a}~(\ocwlowerid{c},\ocwupperid{Ppp})~\ocwlowerid{r}~\ocwlowerid{root}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Weird\ocwvspace{}Ppp:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{rdecode}~\ocwlowerid{stem})$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfutp\_}~\ocwlowerid{c}~\ocwlowerid{stem}~\ocwlowerid{root}~\rightarrow{}~$\ocwbc{} k ought to be carried by \ocwbegindcode{}$\ocwupperid{Pfutp\_}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~[~1~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{k}~=~$\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}\ocweol
\ocwindent{7.00em}
$[~[~42~::~[~45~::~[~1~::~[~32~::~\ocwlowerid{\_}~]~]~]~]~\rightarrow{}~3~$\ocwbc{} -tavya \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~[~42~::~[~4~::~\ocwlowerid{\_}~]~]~\rightarrow{}~2~$\ocwbc{} -aniiya \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~[~42~::~\ocwlowerid{\_}~]~\rightarrow{}~1~$\ocwbc{} -ya \ocwec{}~\ocwbc{} ambiguité possible avec -iiya ? \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Weird\ocwvspace{}Pfp:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{rdecode}~\ocwlowerid{stem})$\ocweol
\ocwindent{7.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{build\_part\_a}~(\ocwlowerid{c},\ocwupperid{Pfutp}~\ocwlowerid{k})~\ocwlowerid{r}~\ocwlowerid{root}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Weird\ocwvspace{}Pfp:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{rdecode}~\ocwlowerid{stem})$\ocweol
\ocwindent{2.00em}
$]~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pppa\_}~\ocwlowerid{c}~\ocwlowerid{m\_stem}~\ocwlowerid{root}~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{f\_stem}~=~\ocwlowerid{rfix}~\ocwlowerid{m\_stem}~$\ocwstring{"at"}~\ocwbc{} atii \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{build\_part\_vat}~(\ocwlowerid{c},\ocwupperid{Pppa})~\ocwlowerid{m\_stem}~\ocwlowerid{f\_stem}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppra\_}~\ocwlowerid{k}~\ocwlowerid{c}~\ocwlowerid{m\_stem}~\ocwlowerid{f\_stem}~\ocwlowerid{root}~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{redundant\_gana}~\ocwlowerid{k}~\ocwlowerid{root}~$\ocwkw{then}~$()$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~$\ocwlowerid{build\_part\_at}~(\ocwlowerid{c},\ocwupperid{Ppra}~\ocwlowerid{k})~\ocwlowerid{m\_stem}~\ocwlowerid{f\_stem}~\ocwlowerid{root}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pprared\_}~\ocwlowerid{c}~\ocwlowerid{stem}~\ocwlowerid{root}~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{k}~=~$\ocwkw{if}~$\ocwlowerid{c}~=~\ocwupperid{Intensive}~$\ocwkw{then}~$\ocwlowerid{int\_gana}~$\ocwkw{else}~3~\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{f\_stem}~=~\ocwlowerid{rfix}~\ocwlowerid{stem}~$\ocwstring{"at"}~\ocwbc{} atii \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{3.00em}
$\ocwlowerid{build\_part\_at\_red}~(\ocwlowerid{c},\ocwupperid{Ppra}~\ocwlowerid{k})~\ocwlowerid{stem}~\ocwlowerid{f\_stem}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pprm\_}~\ocwlowerid{k}~\ocwlowerid{c}~\ocwlowerid{stem}~\ocwlowerid{root}~\rightarrow{}~\ocwlowerid{build\_part\_a}~(\ocwlowerid{c},\ocwupperid{Pprm}~\ocwlowerid{k})~\ocwlowerid{stem}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pprp\_}~\ocwlowerid{c}~\ocwlowerid{stem}~\ocwlowerid{root}~\rightarrow{}~\ocwlowerid{build\_part\_a}~(\ocwlowerid{c},\ocwupperid{Pprp})~\ocwlowerid{stem}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppfta\_}~\ocwlowerid{c}~\ocwlowerid{stem}~\ocwlowerid{root}~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{inter}~=~$\ocwkw{if}~$\ocwlowerid{monosyllabic}~\ocwlowerid{stem}~$\ocwkw{then}~\ocwbc{} intercalating i \ocwec{}\ocweol
\ocwindent{10.50em}
\ocwkw{if}~$\ocwlowerid{root}=$\ocwstring{"vid\#1"}~\ocwkw{then}~$\ocwupperid{False}$\ocweol
\ocwindent{12.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{vid}\#1$\ocwenddcode{} stem=vid \ocwbegindcode{}$\ocwlowerid{vid}\#2$\ocwenddcode{} stem=vivid \ocwec{}\ocweol
\ocwindent{10.50em}
\ocwkw{else}~$\ocwupperid{True}~$\ocweol
\ocwindent{9.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{root}=$\ocwstring{"likh"}~\ocwkw{then}~$\ocwupperid{True}~$\ocwbc{} source ? \ocwec{}\ocweol
\ocwindent{9.00em}
\ocwkw{else}~$\ocwupperid{False}$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{f\_stem}~=~\ocwlowerid{rfix}~\ocwlowerid{stem}~$\ocwstring{"u.s"}~\ocwkw{in}~\ocweol
\ocwindent{3.00em}
$\ocwlowerid{build\_part\_vas}~\ocwlowerid{c}~\ocwlowerid{stem}~\ocwlowerid{inter}~\ocwlowerid{f\_stem}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppftm\_}~\ocwlowerid{c}~\ocwlowerid{stem}~\ocwlowerid{root}~\rightarrow{}~\ocwlowerid{build\_part\_a}~(\ocwlowerid{c},\ocwupperid{Ppftm})~\ocwlowerid{stem}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfuta\_}~\ocwlowerid{c}~\ocwlowerid{stem}~\ocwlowerid{root}~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{f\_stem}~=~\ocwlowerid{rfix}~\ocwlowerid{stem}~$\ocwstring{"ant"}~\ocwbc{} antii \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{build\_part\_at}~(\ocwlowerid{c},\ocwupperid{Pfuta})~\ocwlowerid{stem}~\ocwlowerid{f\_stem}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfutm\_}~\ocwlowerid{c}~\ocwlowerid{stem}~\ocwlowerid{root}~\rightarrow{}~\ocwlowerid{build\_part\_a}~(\ocwlowerid{c},\ocwupperid{Pfutm})~\ocwlowerid{stem}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Called by \ocwbegindcode{}$\ocwupperid{Verbs}.\ocwlowerid{compute\_conjugs}$\ocwenddcode{}, in order to create \ocwbegindcode{}$\ocwupperid{Install}.\ocwlowerid{parts\_file}$\ocwenddcode{} 
   globally for all roots by \ocwbegindcode{}$\ocwupperid{Make\_roots}.\ocwlowerid{make\_roots}$\ocwenddcode{}. It is also invoked
   by \ocwbegindcode{}$\ocwupperid{Conjugation}.\ocwlowerid{look\_up\_and\_display}$\ocwenddcode{} through \ocwbegindcode{}$\ocwupperid{Verbs}.\ocwlowerid{fake\_compute\_conjugs}$\ocwenddcode{}. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compute\_participles}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{build\_part}~\ocwlowerid{participles.}\ocwlowerid{val}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{participles.}\ocwlowerid{val}~:=~[\,]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Conj_infos.mli}
\ocwinterface{Conj\_infos}
\label{conj_infos.mli:0}%
NB no module value, \ocwbegindcode{}$\ocwupperid{Conj\_infos}$\ocwenddcode{} is a purely defining types signature 
\ocweol
\label{conj_infos.mli:729}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{vmorph}~=$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Prim}~$\ocwkw{of}~\ocwbt{int}~\ocwkw{and}~\ocwbt{bool}~\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} primary conjugation \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwbc{} gana    pada     form of present 3rd sg for checking   \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Causa}~$\ocwkw{of}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} causative 3rd sg conjugation    \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inten}~$\ocwkw{of}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} intensive 3rd sg conjugation    \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Desid}~$\ocwkw{of}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} desiderative 3rd sg conjugation \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{root\_infos}~=~(\ocwlowerid{vmorph}~\times{}~$\ocwbt{bool}$)~$\ocwbc{} \ocwbegindcode{}$\ocwupperid{True}$\ocwenddcode{} means root admits preverb aa- \ocwec{}\ocweol
\ocwindent{0.00em}
;~\ocwbc{} NB should be (list vmorph * bool) for good factorisation \ocwec{}\ocweol
\ocwendcode{}\typeout{OcamlWeb file Morpho_string.ml}
\ocwmodule{Morpho\_string}
\label{morpho_string.ml:0}%
Linearizes morphological information as a string.
   Used in \ocwbegindcode{}$\ocwupperid{Morpho},~\ocwupperid{Morpho\_tex},~\ocwupperid{Lexer}$\ocwenddcode{}. 
\ocweol
\label{morpho_string.ml:716}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{inflected}$\ocwenddcode{}, \ocwbegindcode{}$\ocwupperid{Noun\_form}$\ocwenddcode{}, ... \ocwec{}\medskip

\label{morpho_string.ml:786}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{gana\_str}~\ocwlowerid{k}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{k}=11~$\ocwkw{then}~\ocwstring{"\ocwvspace{}[vn.]"}\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{k}>10~$\ocwbc{} redundant with conjugation \ocwec{}~\ocwkw{then}~\ocwstring{""}\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{k}=0~$\ocwkw{then}~$\ocwlowerid{failwith}~$\ocwstring{"gana\_str"}\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwstring{"\ocwvspace{}["}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{k}~$\^{}~\ocwstring{"]"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{string\_voice}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Active}~\rightarrow{}~$\ocwstring{"\ocwvspace{}ac."}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Middle}~\rightarrow{}~$\ocwstring{"\ocwvspace{}md."}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Passive}~\rightarrow{}~$\ocwstring{"\ocwvspace{}ps."}~\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{string\_conjugation}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Primary}~\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Causative}~\rightarrow{}~$\ocwstring{"ca.\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Intensive}~\rightarrow{}~$\ocwstring{"int.\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Desiderative}~\rightarrow{}~$\ocwstring{"des.\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{string\_nominal}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Ppp}~\rightarrow{}~$\ocwstring{"pp."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pppa}~\rightarrow{}~$\ocwstring{"ppa."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppra}~\ocwlowerid{k}~\rightarrow{}~$\ocwstring{"ppr."}~\^{}~$(\ocwlowerid{gana\_str}~\ocwlowerid{k})~$\^{}~\ocwstring{"\ocwvspace{}ac."}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pprm}~\ocwlowerid{k}~\rightarrow{}~$\ocwstring{"ppr."}~\^{}~$(\ocwlowerid{gana\_str}~\ocwlowerid{k})~$\^{}~\ocwstring{"\ocwvspace{}md."}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pprp}~\rightarrow{}~$\ocwstring{"ppr."}~\^{}~\ocwstring{"\ocwvspace{}ps."}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppfta}~\rightarrow{}~$\ocwstring{"ppf."}~\^{}~\ocwstring{"\ocwvspace{}ac."}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppftm}~\rightarrow{}~$\ocwstring{"ppf."}~\^{}~\ocwstring{"\ocwvspace{}md."}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfuta}~\rightarrow{}~$\ocwstring{"pfu."}~\^{}~\ocwstring{"\ocwvspace{}ac."}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfutm}~\rightarrow{}~$\ocwstring{"pfu."}~\^{}~\ocwstring{"\ocwvspace{}md."}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfutp}~\ocwlowerid{k}~\rightarrow{}~$\ocwstring{"pfp."}~\^{}~$(\ocwlowerid{gana\_str}~\ocwlowerid{k})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Action\_noun}~\rightarrow{}~$\ocwstring{"act."}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{string\_tense}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Future}~\rightarrow{}~$\ocwstring{"fut."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Perfect}~\rightarrow{}~$\ocwstring{"pft."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Aorist}~\ocwlowerid{k}~\rightarrow{}~$\ocwstring{"aor."}~\^{}~$(\ocwlowerid{gana\_str}~\ocwlowerid{k})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Injunctive}~\ocwlowerid{k}~\rightarrow{}~$\ocwstring{"inj."}~\^{}~$(\ocwlowerid{gana\_str}~\ocwlowerid{k})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Conditional}~\rightarrow{}~$\ocwstring{"cond."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Benedictive}~\rightarrow{}~$\ocwstring{"ben."}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{string\_case}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Nom}~\rightarrow{}~$\ocwstring{"nom."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Acc}~\rightarrow{}~$\ocwstring{"acc."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ins}~\rightarrow{}~$\ocwstring{"i."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Dat}~\rightarrow{}~$\ocwstring{"dat."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Abl}~\rightarrow{}~$\ocwstring{"abl."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Gen}~\rightarrow{}~$\ocwstring{"g."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Loc}~\rightarrow{}~$\ocwstring{"loc."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Voc}~\rightarrow{}~$\ocwstring{"voc."}~\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{string\_number}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Singular}~\rightarrow{}~$\ocwstring{"\ocwvspace{}sg.\ocwvspace{}"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Dual}~\rightarrow{}~$\ocwstring{"\ocwvspace{}du.\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Plural}~\rightarrow{}~$\ocwstring{"\ocwvspace{}pl.\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{string\_gender}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Mas}~\rightarrow{}~$\ocwstring{"m."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"n."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"f."}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Deictic}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"*"}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{string\_pr\_mode}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Present}~\rightarrow{}~$\ocwstring{"pr."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Imperative}~\rightarrow{}~$\ocwstring{"imp."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Optative}~\rightarrow{}~$\ocwstring{"opt."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Imperfect}~\rightarrow{}~$\ocwstring{"impft."}\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{string\_person}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{First}~\rightarrow{}~$\ocwstring{"1"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Second}~\rightarrow{}~$\ocwstring{"2"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Third}~\rightarrow{}~$\ocwstring{"3"}~\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{string\_ind\_kind}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Part}~\rightarrow{}~$\ocwstring{"part."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Prep}~\rightarrow{}~$\ocwstring{"prep."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Conj}~\rightarrow{}~$\ocwstring{"conj."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Abs}~\rightarrow{}~$\ocwstring{"abs."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Adv}~\rightarrow{}~$\ocwstring{"adv."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Tas}~\rightarrow{}~$\ocwstring{"tasil"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"ind."}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{string\_invar}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Infi}~\rightarrow{}~$\ocwstring{"inf."}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Absoya}~\rightarrow{}~$\ocwstring{"abs."}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Perpft}~\rightarrow{}~$\ocwstring{"per.\ocwvspace{}pft."}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{string\_paradigm}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Conjug}~\ocwlowerid{t}~\ocwlowerid{v}~\rightarrow{}~(\ocwlowerid{string\_tense}~\ocwlowerid{t})~$\^{}~$(\ocwlowerid{string\_voice}~\ocwlowerid{v})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Presenta}~\ocwlowerid{k}~\ocwlowerid{pr}~\rightarrow{}~(\ocwlowerid{string\_pr\_mode}~\ocwlowerid{pr})~$\^{}~$(\ocwlowerid{gana\_str}~\ocwlowerid{k})~$\^{}~\ocwstring{"\ocwvspace{}ac."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Presentm}~\ocwlowerid{k}~\ocwlowerid{pr}~\rightarrow{}~(\ocwlowerid{string\_pr\_mode}~\ocwlowerid{pr})~$\^{}~$(\ocwlowerid{gana\_str}~\ocwlowerid{k})~$\^{}~\ocwstring{"\ocwvspace{}md."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Presentp}~\ocwlowerid{pr}~\rightarrow{}~(\ocwlowerid{string\_pr\_mode}~\ocwlowerid{pr}~)~$\^{}~\ocwstring{"\ocwvspace{}ps."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Perfut}~\ocwlowerid{v}~\rightarrow{}~$\ocwstring{"per.\ocwvspace{}fut."}~\^{}~$(\ocwlowerid{string\_voice}~\ocwlowerid{v})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{string\_finite}~(\ocwlowerid{c},\ocwlowerid{p})~=~(\ocwlowerid{string\_conjugation}~\ocwlowerid{c})~$\^{}~$(\ocwlowerid{string\_paradigm}~\ocwlowerid{p})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{string\_verbal}~(\ocwlowerid{c},\ocwlowerid{n})~=~(\ocwlowerid{string\_conjugation}~\ocwlowerid{c})~$\^{}~$(\ocwlowerid{string\_nominal}~\ocwlowerid{n})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{string\_modal}~(\ocwlowerid{c},\ocwlowerid{i})~=~(\ocwlowerid{string\_conjugation}~\ocwlowerid{c})~$\^{}~$(\ocwlowerid{string\_invar}~\ocwlowerid{i})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{string\_morph}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Noun\_form}~\ocwlowerid{g}~\ocwlowerid{n}~\ocwlowerid{c}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Part\_form}~\ocwlowerid{\_}~\ocwlowerid{g}~\ocwlowerid{n}~\ocwlowerid{c}~\rightarrow{}~(\ocwlowerid{string\_case}~\ocwlowerid{c})~$\^{}~$(\ocwlowerid{string\_number}~\ocwlowerid{n})~$\^{}~$(\ocwlowerid{string\_gender}~\ocwlowerid{g})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Bare\_stem}~\mid{}~\ocwupperid{Avyayai\_form}~\rightarrow{}~$\ocwstring{"iic."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Avyayaf\_form}~\rightarrow{}~$\ocwstring{"ind."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Verb\_form}~\ocwlowerid{f}~\ocwlowerid{n}~\ocwlowerid{p}~\rightarrow{}~(\ocwlowerid{string\_finite}~\ocwlowerid{f})~$\^{}~$(\ocwlowerid{string\_number}~\ocwlowerid{n})~$\^{}~$(\ocwlowerid{string\_person}~\ocwlowerid{p})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind\_form}~\ocwlowerid{k}~\rightarrow{}~\ocwlowerid{string\_ind\_kind}~\ocwlowerid{k}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Abs\_root}~\ocwlowerid{c}~\rightarrow{}~(\ocwlowerid{string\_conjugation}~\ocwlowerid{c})~$\^{}~\ocwstring{"abs."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Auxi\_form}~\rightarrow{}~$\ocwstring{"iiv."}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind\_verb}~\ocwlowerid{m}~\rightarrow{}~\ocwlowerid{string\_modal}~\ocwlowerid{m}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Unanalysed}~\rightarrow{}~$\ocwstring{"?"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{PV}~\ocwlowerid{pvs}~\rightarrow{}~$\ocwstring{"pv."}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} end; \ocwec{}\ocweol
\ocwendcode{}\typeout{OcamlWeb file Morpho.ml}
\ocwmodule{Morpho}
\label{morpho.ml:0}%
Prints morphological information, including derivative morphology.
   Used in \ocwbegindcode{}$\ocwupperid{Morpho\_html}$\ocwenddcode{} and \ocwbegindcode{}$\ocwupperid{Morpho\_ext}$\ocwenddcode{} 
\ocweol
\label{morpho.ml:735}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocweol
\ocwindent{1.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{inflected}$\ocwenddcode{} and its constructors \ocwbegindcode{}$\ocwupperid{Noun\_form}$\ocwenddcode{}, ..., \ocwbegindcode{}$\ocwlowerid{homo\_krid}$\ocwenddcode{}  \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Naming};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{homo\_undo}~\ocwlowerid{look\_up\_homo}~\ocwlowerid{unique\_kridantas}~\ocwlowerid{lexical\_kridantas}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morpho\_string}~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{string\_morph}~\ocwlowerid{string\_verbal}$\ocwenddcode{} \ocwec{};\medskip

\label{morpho.ml:977}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Morpho\_out}~(\ocwupperid{Chan}:~$\ocwkw{sig}~$\ocwlowerid{value}~\ocwlowerid{chan}:~$\ocwbt{ref}~$\ocwlowerid{out\_channel};~$\ocwkw{end}$)~$\ocweol
\ocwindent{0.50em}
=~\ocwkw{struct}\medskip

\label{morpho.ml:1054}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ps}~\ocwlowerid{s}~=~\ocwlowerid{output\_string}~\ocwupperid{Chan.chan.}\ocwlowerid{val}~\ocwlowerid{s}~$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pl}~\ocwlowerid{s}~=~\ocwlowerid{ps}~(\ocwlowerid{s}~$\^{}~\ocwstring{"\symbol{92}n"}$)$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pr\_word}~\ocwlowerid{w}~=~\ocwlowerid{ps}~(\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{w})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_morph}~\ocwlowerid{m}~=~\ocwlowerid{ps}~(\ocwlowerid{string\_morph}~\ocwlowerid{m})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_verbal}~\ocwlowerid{vb}~=~\ocwlowerid{ps}~(\ocwlowerid{string\_verbal}~\ocwlowerid{vb})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{select\_morph}~(\ocwlowerid{seg\_num},\ocwlowerid{sub},\ocwlowerid{seg\_count})~\ocwlowerid{morph}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~\ocwkw{let}~$\ocwlowerid{string\_num}~=~\ocwlowerid{string\_of\_int}~\ocwlowerid{seg\_num}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{seg}~=~(\ocwlowerid{string\_of\_int}~\ocwlowerid{sub})~$\^{}~\ocwstring{","}~\^{}~$(\ocwlowerid{string\_of\_int}~\ocwlowerid{seg\_count})~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{radio\_cond}~=~\ocwupperid{Html.}\ocwlowerid{radio\_input\_dft}~\ocwlowerid{string\_num}~\ocwlowerid{seg}~$\ocwstring{""}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$(\ocwlowerid{sub},\ocwlowerid{seg\_count})~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~(1,1)~\rightarrow{}~\ocwlowerid{ps}~(\ocwlowerid{radio\_cond}~\ocwupperid{True}~$\^{}~\ocwstring{"\ocwvspace{}"}$)~$\ocweol
\ocwindent{9.00em}
\ocwbc{} NB: only the first button is selected \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{ps}~(\ocwlowerid{radio\_cond}~\ocwupperid{False}~$\^{}~\ocwstring{"\ocwvspace{}"}$)$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_morph}~\ocwlowerid{morph}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{select\_morphs}~(\ocwlowerid{seg\_num},\ocwlowerid{sub})~\ocwlowerid{seg\_count}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{last}~::~[\,]~]~\rightarrow{}~\ocwlowerid{select\_morph}~(\ocwlowerid{seg\_num},\ocwlowerid{sub},\ocwlowerid{seg\_count})~\ocwlowerid{last}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{first}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{select\_morph}~(\ocwlowerid{seg\_num},\ocwlowerid{sub},\ocwlowerid{seg\_count})~\ocwlowerid{first}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{select\_morphs}~(\ocwlowerid{seg\_num},\ocwlowerid{sub})~(\ocwlowerid{seg\_count}+1)~\ocwlowerid{rest}$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_morphs}~(\ocwlowerid{seg\_num},\ocwlowerid{sub})~\ocwlowerid{morphs}~=~$\ocwkw{match}~$\ocwlowerid{seg\_num}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~0~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{bar}~()~=~\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~\ocwkw{in}\ocweol
\ocwindent{4.50em}
$\ocwupperid{List2.}\ocwlowerid{process\_list\_sep}~\ocwlowerid{print\_morph}~\ocwlowerid{bar}~\ocwlowerid{morphs}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{select\_morphs}~(\ocwlowerid{seg\_num},\ocwlowerid{sub})~1~\ocwlowerid{morphs}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwbc{} The following print functions insert in the HTML output links to entries 
   in the lexicon, also radio buttons and other marks for user choices. \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
\ocwbegindcode{}$\ocwlowerid{pe}~:~\ocwlowerid{word}~\rightarrow{}~$\ocwbt{unit}\ocwenddcode{} is \ocwbegindcode{}$\ocwupperid{Morpho\_html}.\ocwlowerid{print\_entry}$\ocwenddcode{} with hyperlink,
   \ocwbegindcode{}$\ocwlowerid{pne}~:~\ocwlowerid{word}~\rightarrow{}~$\ocwbt{unit}\ocwenddcode{} is \ocwbegindcode{}$\ocwupperid{Morpho\_html}.\ocwlowerid{print\_stem}$\ocwenddcode{},
   \ocwbegindcode{}$\ocwlowerid{pu}~:~\ocwlowerid{word}~\rightarrow{}~$\ocwbt{unit}\ocwenddcode{} prints un-analysed chunks. 
\ocweol
\label{morpho.ml:2587}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_inv\_morpho}~\ocwlowerid{pe}~\ocwlowerid{pne}~\ocwlowerid{pu}~\ocwlowerid{form}~(\ocwlowerid{seg\_num},\ocwlowerid{sub})~\ocwlowerid{generative}~(\ocwlowerid{delta},\ocwlowerid{morphs})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwupperid{Word.}\ocwlowerid{patch}~\ocwlowerid{delta}~\ocwlowerid{form}~$\ocwkw{in}~\ocwkw{do}~\ocwbc{} stem may have homo index \ocwec{}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{ps}~$\ocwstring{"\{\ocwvspace{}"}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{print\_morphs}~(\ocwlowerid{seg\_num},\ocwlowerid{sub})~\ocwlowerid{morphs}~$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}\}["}~\ocweol
\ocwindent{2.00em}
;~\ocwkw{if}~$\ocwlowerid{generative}~$\ocwkw{then}~\ocwbc{} interpret stem as unique name \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$(\ocwlowerid{homo},\ocwlowerid{bare\_stem})~=~\ocwlowerid{homo\_undo}~\ocwlowerid{stem}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{krit\_infos}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{bare\_stem}~\ocwlowerid{unique\_kridantas}~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{try}~\ocwkw{let}~$(\ocwlowerid{verbal},\ocwlowerid{root})~=~\ocwlowerid{look\_up\_homo}~\ocwlowerid{homo}~\ocwlowerid{krit\_infos}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{bare\_stem}~\ocwlowerid{lexical\_kridantas}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~[\,]~$\ocwbc{} not in lexicon \ocwec{}~$\rightarrow{}~\ocwlowerid{pne}~\ocwlowerid{bare\_stem}$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{entries}~$\ocwbc{} bare stem is lexicalized \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{7.00em}
\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{exists}~($\ocwkw{fun}~$(\ocwlowerid{\_},\ocwlowerid{h})~\rightarrow{}~\ocwlowerid{h}=\ocwlowerid{homo})~\ocwlowerid{entries}$\ocweol
\ocwindent{8.50em}
\ocwkw{then}~$\ocwlowerid{pe}~\ocwlowerid{stem}~$\ocwbc{} stem with exact homo is lexical entry \ocwec{}\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{pne}~\ocwlowerid{bare\_stem}$\ocweol
\ocwindent{5.00em}
$]~$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}\{\ocwvspace{}"};~$\ocwlowerid{print\_verbal}~\ocwlowerid{verbal};~\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}\}["};~$\ocwlowerid{pe}~\ocwlowerid{root};~\ocwlowerid{ps}~$\ocwstring{"]"}\ocweol
\ocwindent{4.00em}
\}~\ocwkw{with}~$[~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{pu}~\ocwlowerid{bare\_stem}~]$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{morphs}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~[~\ocwupperid{Unanalysed}~]~\rightarrow{}~\ocwlowerid{pu}~\ocwlowerid{stem}~$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{pe}~\ocwlowerid{stem}~$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"]"}\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Used in \ocwbegindcode{}$\ocwupperid{Morpho\_html}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_inv\_morpho\_link}~\ocwlowerid{pvs}~\ocwlowerid{pe}~\ocwlowerid{pne}~\ocwlowerid{pu}~\ocwlowerid{form}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pv}~=~$\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{phantomatic}~\ocwlowerid{form}~$\ocwkw{then}~$[~2~]~$\ocwbc{} aa- \ocwec{}\ocweol
\ocwindent{5.50em}
\ocwkw{else}~$\ocwlowerid{pvs}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{encaps}~\ocwlowerid{print}~\ocwlowerid{e}~=~$\ocwbc{} encapsulates prefixing with possible preverbs \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{if}~$\ocwlowerid{pv}~=~[\,]~$\ocwkw{then}~$\ocwlowerid{print}~\ocwlowerid{e}~$\ocwkw{else}~\ocwkw{do}~\{~$\ocwlowerid{pe}~\ocwlowerid{pvs};~\ocwlowerid{ps}~$\ocwstring{"\symbol{45}"};~$\ocwlowerid{print}~\ocwlowerid{e}~\}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{print\_inv\_morpho}~(\ocwlowerid{encaps}~\ocwlowerid{pe})~(\ocwlowerid{encaps}~\ocwlowerid{pne})~\ocwlowerid{pu}~\ocwlowerid{form}$\ocweol
\ocwindent{0.00em}
\ocwbc{} Possible overgeneration when derivative of a root non attested with pv 
   since only existential test in \ocwbegindcode{}$\ocwupperid{Dispatcher}.\ocwlowerid{validate\_pv}$\ocwenddcode{}. Thus
   \ocwbegindcode{}$\ocwlowerid{anusandhiiyate}$\ocwenddcode{} should show \ocwbegindcode{}$\ocwlowerid{dhaa}\#1$\ocwenddcode{}, not \ocwbegindcode{}$\ocwlowerid{dhaa}\#2$\ocwenddcode{}, \ocwbegindcode{}$\ocwlowerid{dhii}\#1$\ocwenddcode{} or \ocwbegindcode{}$\ocwlowerid{dhyaa}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_inv\_morpho\_tad}~\ocwlowerid{pv}~\ocwlowerid{pe}~\ocwlowerid{pne}~\ocwlowerid{pu}~\ocwlowerid{stem}~\ocwlowerid{sfx\_form}~(\ocwlowerid{seg\_num},\ocwlowerid{sub})~$\ocweol
\ocwindent{13.50em}
$\ocwlowerid{generative}~(\ocwlowerid{delta},\ocwlowerid{morphs})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{sfx}~=~\ocwupperid{Word.}\ocwlowerid{patch}~\ocwlowerid{delta}~\ocwlowerid{sfx\_form}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{ps}~$\ocwstring{"\{\ocwvspace{}"}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{print\_morphs}~(\ocwlowerid{seg\_num},\ocwlowerid{sub})~\ocwlowerid{morphs}~$\ocwbc{} taddhitaanta declension \ocwec{}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}\}["}\ocweol
\ocwindent{2.00em}
;~\ocwkw{if}~$\ocwlowerid{generative}~$\ocwkw{then}~\ocwbc{} interpret stem as unique name \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$(\ocwlowerid{homo},\ocwlowerid{bare\_stem})~=~\ocwlowerid{homo\_undo}~\ocwlowerid{stem}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{krit\_infos}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{bare\_stem}~\ocwlowerid{unique\_kridantas}~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{try}~\ocwkw{let}~$(\ocwlowerid{verbal},\ocwlowerid{root})~=~\ocwlowerid{look\_up\_homo}~\ocwlowerid{homo}~\ocwlowerid{krit\_infos}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{bare\_stem}~\ocwlowerid{lexical\_kridantas}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~[\,]~$\ocwbc{} not in lexicon \ocwec{}~$\rightarrow{}~\ocwlowerid{pne}~\ocwlowerid{bare\_stem}~$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{entries}~$\ocwbc{} bare stem is lexicalized \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{7.00em}
\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{exists}~($\ocwkw{fun}~$(\ocwlowerid{\_},\ocwlowerid{h})~\rightarrow{}~\ocwlowerid{h}=\ocwlowerid{homo})~\ocwlowerid{entries}$\ocweol
\ocwindent{8.50em}
\ocwkw{then}~$\ocwlowerid{pe}~\ocwlowerid{stem}~$\ocwbc{} stem with exact homo is lexical entry \ocwec{}\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{pne}~\ocwlowerid{bare\_stem}$\ocweol
\ocwindent{5.00em}
$]~$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}\{\ocwvspace{}"};~$\ocwlowerid{print\_verbal}~\ocwlowerid{verbal};~\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}\}["};~$\ocwlowerid{pe}~\ocwlowerid{root};~\ocwlowerid{ps}~$\ocwstring{"]"}\ocweol
\ocwindent{4.00em}
\}~\ocwkw{with}~$[~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{pu}~\ocwlowerid{bare\_stem}~]$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~$\ocwlowerid{pe}~\ocwlowerid{stem}~$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{pne}~\ocwlowerid{sfx};~\ocwlowerid{ps}~$\ocwstring{"]"}~\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} variant with link for printing of taddhitaantas \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_inv\_morpho\_link\_tad}~\ocwlowerid{pvs}~\ocwlowerid{pe}~\ocwlowerid{pne}~\ocwlowerid{pu}~\ocwlowerid{stem}~\ocwlowerid{sfx\_form}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pv}~=~$\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{phantomatic}~\ocwlowerid{stem}~$\ocwkw{then}~$[~2~]~$\ocwbc{} aa- \ocwec{}~\ocweol
\ocwindent{5.50em}
\ocwkw{else}~$\ocwlowerid{pvs}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{print\_inv\_morpho\_tad}~\ocwlowerid{pv}~\ocwlowerid{pe}~\ocwlowerid{pne}~\ocwlowerid{pu}~\ocwlowerid{stem}~\ocwlowerid{sfx\_form}$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Used in \ocwbegindcode{}$\ocwupperid{Lexer}.\ocwlowerid{record\_tagging}$\ocwenddcode{} for regression analysis 
\ocweol
\label{morpho.ml:5526}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{report\_morph}~\ocwlowerid{gen}~\ocwlowerid{form}~(\ocwlowerid{delta},\ocwlowerid{morphs})~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwupperid{Word.}\ocwlowerid{patch}~\ocwlowerid{delta}~\ocwlowerid{form}~$\ocwkw{in}~\ocwkw{do}~\ocwbc{} stem may have homo index \ocwec{}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{ps}~$\ocwstring{"\{\ocwvspace{}"}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{print\_morphs}~(0,0)~\ocwlowerid{morphs}~$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}\}["}~\ocweol
\ocwindent{2.00em}
;~\ocwkw{if}~$\ocwlowerid{gen}~$\ocwkw{then}~\ocwbc{} interpret stem as unique name \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$(\ocwlowerid{homo},\ocwlowerid{bare\_stem})~=~\ocwlowerid{homo\_undo}~\ocwlowerid{stem}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{krid\_infos}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{bare\_stem}~\ocwlowerid{unique\_kridantas}~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$(\ocwlowerid{vb},\ocwlowerid{root})~=~\ocwlowerid{look\_up\_homo}~\ocwlowerid{homo}~\ocwlowerid{krid\_infos}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{stem}~\ocwlowerid{lexical\_kridantas}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~[\,]~$\ocwbc{} not in lexicon \ocwec{}~$\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{ps}~$\ocwstring{"G:"};~$\ocwlowerid{pr\_word}~\ocwlowerid{bare\_stem}~\}$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~$\ocwbc{} stem is lexical entry \ocwec{}~$\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{ps}~$\ocwstring{"L:"};~$\ocwlowerid{pr\_word}~\ocwlowerid{stem}~\}$\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}\{\ocwvspace{}"};~$\ocwlowerid{print\_verbal}~\ocwlowerid{vb};~\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}\}["};~$\ocwlowerid{pr\_word}~\ocwlowerid{root};~\ocwlowerid{ps}~$\ocwstring{"]"}\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{3.00em}
\ocwkw{else}~$\ocwlowerid{pr\_word}~\ocwlowerid{stem}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"]"}\ocweol
\ocwindent{2.00em}
\}~\ocweol
\ocwindent{0.00em}
;\medskip

\label{morpho.ml:6282}%
\ocwindent{0.00em}
\ocwkw{end};\ocweol
\ocwendcode{}\typeout{OcamlWeb file Declension.ml}
\ocwmodule{Declension}
\label{declension.ml:0}%
CGI-bin declension for computing declensions.                          
\ocweol
\ocwindent{0.00em}
This CGI is triggered by page \ocwbegindcode{}$\ocwlowerid{grammar\_page}$\ocwenddcode{} in \ocwbegindcode{}$\ocwlowerid{dico\_dir}$\ocwenddcode{}.            
\ocweol
\ocwindent{0.00em}
Reads its input in shell variable \ocwbegindcode{}$\ocwupperid{QUERY\_STRING}$\ocwenddcode{} URI-encoded.          
\ocweol
\ocwindent{0.00em}
Prints an html document of substantive declinations on \ocwbegindcode{}$\ocwlowerid{stdout}$\ocwenddcode{}.       
\ocweol
\label{declension.ml:1118}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocwbc{} \ocwbegindcode{}$\ocwupperid{Noun\_form}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps pl etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Cgi};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Multilingual};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{font}~\ocwupperid{Deva}~\ocwupperid{Roma}~\ocwlowerid{compound\_name}~\ocwlowerid{avyaya\_name}$\ocwenddcode{} \ocwec{}\medskip

\label{declension.ml:1291}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{dtitle}~\ocwlowerid{font}~=~\ocwlowerid{h1\_title}~(\ocwlowerid{declension\_title}~\ocwlowerid{narrow\_screen}~\ocwlowerid{font})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{meta\_title}~=~\ocwlowerid{title}~$\ocwstring{"Sanskrit\ocwvspace{}Grammarian\ocwvspace{}Declension\ocwvspace{}Engine"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{back\_ground}~=~\ocwlowerid{background}~\ocwupperid{Chamois}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{hyperlink\_title}~\ocwlowerid{font}~\ocwlowerid{link}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{narrow\_screen}~$\ocwkw{then}~$\ocwlowerid{link}$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~$\ocwlowerid{declension\_caption}~\ocwlowerid{font}~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}~$\ocwlowerid{link}$\ocweol
\ocwindent{0.00em}
;\medskip

\label{declension.ml:1566}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pr}~\ocwlowerid{code}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{ps}~(\ocwlowerid{html\_red}~(\ocwupperid{Canon.}\ocwlowerid{uniromcode}~\ocwlowerid{code}))~$\ocwbc{} roman with diacritics \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pr\_deva}~\ocwlowerid{code}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{ps}~(\ocwlowerid{html\_devared}~(\ocwupperid{Canon.}\ocwlowerid{unidevcode}~\ocwlowerid{code}))~$\ocwbc{} devanagari \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pr\_f}~\ocwlowerid{font}~\ocwlowerid{word}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{code}~=~\ocwupperid{Morpho\_html.}\ocwlowerid{final}~\ocwlowerid{word}~$\ocwbc{} visarga correction \ocwec{}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~\ocwkw{match}~$\ocwlowerid{font}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~\ocwlowerid{pr\_deva}~\ocwlowerid{code}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~\ocwlowerid{pr}~\ocwlowerid{code}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pr\_i}~\ocwlowerid{font}~\ocwlowerid{word}~=~$\ocwkw{do}~\ocwbc{} special for iic \ocwec{}\ocweol
\ocwindent{1.00em}
\{~\ocwkw{match}~$\ocwlowerid{font}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{pr\_deva}~\ocwlowerid{word};~\ocwlowerid{pr\_deva}~[~0~]~\}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{pr}~\ocwlowerid{word};~\ocwlowerid{pr}~[~0~]~\}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{prlist\_font}~\ocwlowerid{font}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pr}~=~\ocwlowerid{pr\_f}~\ocwlowerid{font}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bar}~=~\ocwlowerid{html\_green}~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{prlistrec}~$\ocweol
\ocwindent{2.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{prlistrec}~=~$\ocwkw{fun}\ocweol
\ocwindent{3.50em}
$[~[\,]~\rightarrow{}~()$\ocweol
\ocwindent{3.50em}
$\mid{}~[~\ocwlowerid{x}~]~\rightarrow{}~\ocwlowerid{pr}~\ocwlowerid{x}$\ocweol
\ocwindent{3.50em}
$\mid{}~[~\ocwlowerid{x}~::~\ocwlowerid{l}~]~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{pr}~\ocwlowerid{x};~\ocwlowerid{ps}~\ocwlowerid{bar};~\ocwlowerid{prlistrec}~\ocwlowerid{l}~\}$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display\_title}~\ocwlowerid{font}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{html\_paragraph}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_begin}~(\ocwlowerid{centered}~\ocwupperid{Mauve})~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_begin}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{th\_begin}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{dtitle}~\ocwlowerid{font}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{th\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_end}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_end}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocwbc{} Mauve \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_paragraph}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{display\_subtitle}~\ocwlowerid{title}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{html\_paragraph}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_begin}~(\ocwlowerid{centered}~\ocwupperid{Deep\_sky})~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_begin}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{th\_begin}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{title}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{th\_end}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_end}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_end}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocwbc{} Centered \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_paragraph}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{cases\_of}~\ocwlowerid{decls}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{reorg}~(\ocwlowerid{v},\ocwlowerid{n},\ocwlowerid{a},\ocwlowerid{i},\ocwlowerid{d},\ocwlowerid{ab},\ocwlowerid{g},\ocwlowerid{l})~(\ocwlowerid{c},\ocwlowerid{form})~=~$\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Voc}~\rightarrow{}~([~\ocwlowerid{form}~::~\ocwlowerid{v}~],\ocwlowerid{n},\ocwlowerid{a},\ocwlowerid{i},\ocwlowerid{d},\ocwlowerid{ab},\ocwlowerid{g},\ocwlowerid{l})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Nom}~\rightarrow{}~(\ocwlowerid{v},[~\ocwlowerid{form}~::~\ocwlowerid{n}~],\ocwlowerid{a},\ocwlowerid{i},\ocwlowerid{d},\ocwlowerid{ab},\ocwlowerid{g},\ocwlowerid{l})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Acc}~\rightarrow{}~(\ocwlowerid{v},\ocwlowerid{n},[~\ocwlowerid{form}~::~\ocwlowerid{a}~],\ocwlowerid{i},\ocwlowerid{d},\ocwlowerid{ab},\ocwlowerid{g},\ocwlowerid{l})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Ins}~\rightarrow{}~(\ocwlowerid{v},\ocwlowerid{n},\ocwlowerid{a},[~\ocwlowerid{form}~::~\ocwlowerid{i}~],\ocwlowerid{d},\ocwlowerid{ab},\ocwlowerid{g},\ocwlowerid{l})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Dat}~\rightarrow{}~(\ocwlowerid{v},\ocwlowerid{n},\ocwlowerid{a},\ocwlowerid{i},[~\ocwlowerid{form}~::~\ocwlowerid{d}~],\ocwlowerid{ab},\ocwlowerid{g},\ocwlowerid{l})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Abl}~\rightarrow{}~(\ocwlowerid{v},\ocwlowerid{n},\ocwlowerid{a},\ocwlowerid{i},\ocwlowerid{d},[~\ocwlowerid{form}~::~\ocwlowerid{ab}~],\ocwlowerid{g},\ocwlowerid{l})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Gen}~\rightarrow{}~(\ocwlowerid{v},\ocwlowerid{n},\ocwlowerid{a},\ocwlowerid{i},\ocwlowerid{d},\ocwlowerid{ab},[~\ocwlowerid{form}~::~\ocwlowerid{g}~],\ocwlowerid{l})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Loc}~\rightarrow{}~(\ocwlowerid{v},\ocwlowerid{n},\ocwlowerid{a},\ocwlowerid{i},\ocwlowerid{d},\ocwlowerid{ab},\ocwlowerid{g},[~\ocwlowerid{form}~::~\ocwlowerid{l}~])$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{init}~=~([\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,])$\ocweol
\ocwindent{1.00em}
\ocwkw{in}~$\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{reorg}~\ocwlowerid{init}~\ocwlowerid{decls}~$\ocwbc{} (v,n,a,i,d,ab,g,l) \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_ro1}~\ocwlowerid{caption}~\ocwlowerid{s}~\ocwlowerid{d}~\ocwlowerid{p}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{tr\_begin}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{th\_begin}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{caption}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{xml\_next}~$\ocwstring{"th"}~|\ensuremath{>}~$\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{s}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{xml\_next}~$\ocwstring{"th"}~|\ensuremath{>}~$\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{d}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{xml\_next}~$\ocwstring{"th"}~|\ensuremath{>}~$\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{p}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{th\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_row\_font}~\ocwlowerid{font}~\ocwlowerid{case}~\ocwlowerid{s}~\ocwlowerid{d}~\ocwlowerid{p}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{prlist}~=~\ocwlowerid{prlist\_font}~\ocwlowerid{font}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{tr\_mouse\_begin}~(\ocwlowerid{color}~\ocwupperid{Light\_blue})~(\ocwlowerid{color}~\ocwupperid{Pale\_yellow})~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{th\_begin}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{case}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{xml\_next}~$\ocwstring{"th"}~|\ensuremath{>}~$\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{s}~|\ensuremath{>}~\ocwlowerid{prlist}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{xml\_next}~$\ocwstring{"th"}~|\ensuremath{>}~$\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{d}~|\ensuremath{>}~\ocwlowerid{prlist}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{xml\_next}~$\ocwstring{"th"}~|\ensuremath{>}~$\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{p}~|\ensuremath{>}~\ocwlowerid{prlist}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{th\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display\_gender}~\ocwlowerid{font}~\ocwlowerid{gender}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{l}~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{reorg}~(\ocwlowerid{sg},\ocwlowerid{du},\ocwlowerid{pl})~(\ocwlowerid{n},\ocwlowerid{c},\ocwlowerid{form})~=~$\ocwkw{match}~$\ocwlowerid{n}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Singular}~\rightarrow{}~([~(\ocwlowerid{c},\ocwlowerid{form})~::~\ocwlowerid{sg}~],\ocwlowerid{du},\ocwlowerid{pl})$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Dual}~\rightarrow{}~(\ocwlowerid{sg},[~(\ocwlowerid{c},\ocwlowerid{form})~::~\ocwlowerid{du}~],\ocwlowerid{pl})$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Plural}~\rightarrow{}~(\ocwlowerid{sg},\ocwlowerid{du},[~(\ocwlowerid{c},\ocwlowerid{form})~::~\ocwlowerid{pl}~])$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{init}~=~([\,],[\,],[\,])~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$(\ocwlowerid{s},\ocwlowerid{d},\ocwlowerid{p})~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{reorg}~\ocwlowerid{init}~\ocwlowerid{l}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$(\ocwlowerid{v1},\ocwlowerid{n1},\ocwlowerid{a1},\ocwlowerid{i1},\ocwlowerid{d1},\ocwlowerid{b1},\ocwlowerid{g1},\ocwlowerid{l1})~=~\ocwlowerid{cases\_of}~\ocwlowerid{s}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$(\ocwlowerid{v2},\ocwlowerid{n2},\ocwlowerid{a2},\ocwlowerid{i2},\ocwlowerid{d2},\ocwlowerid{b2},\ocwlowerid{g2},\ocwlowerid{l2})~=~\ocwlowerid{cases\_of}~\ocwlowerid{d}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$(\ocwlowerid{v3},\ocwlowerid{n3},\ocwlowerid{a3},\ocwlowerid{i3},\ocwlowerid{d3},\ocwlowerid{b3},\ocwlowerid{g3},\ocwlowerid{l3})~=~\ocwlowerid{cases\_of}~\ocwlowerid{p}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{caption}~=~\ocwlowerid{gender\_caption}~\ocwlowerid{gender}~\ocwlowerid{font}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{print\_row}~=~\ocwlowerid{print\_row\_font}~\ocwlowerid{font}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_paragraph}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{table\_begin\_style}~\ocwupperid{Inflexion}~[~($\ocwstring{"border"},\ocwstring{"2"}$);~\ocwlowerid{padding5}~])$\ocweol
\ocwindent{2.00em}
;~\ocwkw{let}~$\ocwlowerid{sing}~=~\ocwlowerid{number\_caption}~\ocwupperid{Singular}~\ocwlowerid{font}$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{dual}~=~\ocwlowerid{number\_caption}~\ocwupperid{Dual}~\ocwlowerid{font}~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{plur}~=~\ocwlowerid{number\_caption}~\ocwupperid{Plural}~\ocwlowerid{font}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{print\_ro1}~\ocwlowerid{caption}~\ocwlowerid{sing}~\ocwlowerid{dual}~\ocwlowerid{plur}~$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{print\_row}~(\ocwlowerid{case\_caption}~\ocwupperid{Nom}~\ocwlowerid{font})~\ocwlowerid{n1}~\ocwlowerid{n2}~\ocwlowerid{n3}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{print\_row}~(\ocwlowerid{case\_caption}~\ocwupperid{Voc}~\ocwlowerid{font})~\ocwlowerid{v1}~\ocwlowerid{v2}~\ocwlowerid{v3}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{print\_row}~(\ocwlowerid{case\_caption}~\ocwupperid{Acc}~\ocwlowerid{font})~\ocwlowerid{a1}~\ocwlowerid{a2}~\ocwlowerid{a3}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{print\_row}~(\ocwlowerid{case\_caption}~\ocwupperid{Ins}~\ocwlowerid{font})~\ocwlowerid{i1}~\ocwlowerid{i2}~\ocwlowerid{i3}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{print\_row}~(\ocwlowerid{case\_caption}~\ocwupperid{Dat}~\ocwlowerid{font})~\ocwlowerid{d1}~\ocwlowerid{d2}~\ocwlowerid{d3}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{print\_row}~(\ocwlowerid{case\_caption}~\ocwupperid{Abl}~\ocwlowerid{font})~\ocwlowerid{b1}~\ocwlowerid{b2}~\ocwlowerid{b3}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{print\_row}~(\ocwlowerid{case\_caption}~\ocwupperid{Gen}~\ocwlowerid{font})~\ocwlowerid{g1}~\ocwlowerid{g2}~\ocwlowerid{g3}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{print\_row}~(\ocwlowerid{case\_caption}~\ocwupperid{Loc}~\ocwlowerid{font})~\ocwlowerid{l1}~\ocwlowerid{l2}~\ocwlowerid{l3}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{table\_end}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_paragraph}$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display\_iic}~\ocwlowerid{font}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{l}~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{html\_paragraph}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{h3\_begin}~\ocwupperid{C3}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{compound\_name}~\ocwlowerid{font}~|\ensuremath{>}~\ocwlowerid{ps};~\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}"}\ocweol
\ocwindent{2.00em}
;~\ocwkw{let}~$\ocwlowerid{print\_iic}~\ocwlowerid{w}~=~\ocwlowerid{pr\_i}~\ocwlowerid{font}~\ocwlowerid{w}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{print\_iic}~\ocwlowerid{l}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{h3\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display\_avy}~\ocwlowerid{font}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{l}~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{html\_paragraph}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{h3\_begin}~\ocwupperid{C3}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{avyaya\_name}~\ocwlowerid{font}~|\ensuremath{>}~\ocwlowerid{ps};~\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}"}\ocweol
\ocwindent{2.00em}
;~\ocwkw{let}~$\ocwlowerid{ifc\_form}~\ocwlowerid{w}~=~[~0~]~$\ocwbc{} - \ocwec{}~@~$\ocwlowerid{w}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{print\_iic}~\ocwlowerid{w}~=~\ocwlowerid{pr\_f}~\ocwlowerid{font}~(\ocwlowerid{ifc\_form}~\ocwlowerid{w})~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{print\_iic}~\ocwlowerid{l}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{h3\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sort\_out}~\ocwlowerid{accu}~\ocwlowerid{form}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.50em}
$[~[~(\ocwlowerid{\_},\ocwlowerid{morphs})~]~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{fold\_left}~(\ocwlowerid{reorg}~\ocwlowerid{form})~\ocwlowerid{accu}~\ocwlowerid{morphs}$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{where}~\ocwlowerid{reorg}~\ocwlowerid{f}~(\ocwlowerid{mas},\ocwlowerid{fem},\ocwlowerid{neu},\ocwlowerid{any},\ocwlowerid{iic},\ocwlowerid{avy})~=~$\ocwkw{fun}\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Noun\_form}~\ocwlowerid{g}~\ocwlowerid{n}~\ocwlowerid{c}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{t}~=~(\ocwlowerid{n},\ocwlowerid{c},\ocwlowerid{f})~$\ocwkw{in}~\ocweol
\ocwindent{6.00em}
\ocwkw{match}~$\ocwlowerid{g}~$\ocwkw{with}~\ocweol
\ocwindent{7.00em}
$[~\ocwupperid{Mas}~\rightarrow{}~([~\ocwlowerid{t}~::~\ocwlowerid{mas}~],\ocwlowerid{fem},\ocwlowerid{neu},\ocwlowerid{any},\ocwlowerid{iic},\ocwlowerid{avy})$\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwupperid{Fem}~\rightarrow{}~(\ocwlowerid{mas},[~\ocwlowerid{t}~::~\ocwlowerid{fem}~],\ocwlowerid{neu},\ocwlowerid{any},\ocwlowerid{iic},\ocwlowerid{avy})$\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~(\ocwlowerid{mas},\ocwlowerid{fem},[~\ocwlowerid{t}~::~\ocwlowerid{neu}~],\ocwlowerid{any},\ocwlowerid{iic},\ocwlowerid{avy})$\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwupperid{Deictic}~\ocwlowerid{\_}~\rightarrow{}~(\ocwlowerid{mas},\ocwlowerid{fem},\ocwlowerid{neu},[~\ocwlowerid{t}~::~\ocwlowerid{any}~],\ocwlowerid{iic},\ocwlowerid{avy})$\ocweol
\ocwindent{7.00em}
$]$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Bare\_stem}~\mid{}~\ocwupperid{Auxi\_form}~\rightarrow{}~(\ocwlowerid{mas},\ocwlowerid{fem},\ocwlowerid{neu},\ocwlowerid{any},[~\ocwlowerid{f}~::~\ocwlowerid{iic}~],\ocwlowerid{avy})$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Avyayaf\_form}~\rightarrow{}~(\ocwlowerid{mas},\ocwlowerid{fem},\ocwlowerid{neu},\ocwlowerid{any},\ocwlowerid{iic},[~\ocwlowerid{f}~::~\ocwlowerid{avy}~])$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Ind\_form}~\ocwlowerid{\_}~\mid{}~\ocwupperid{Verb\_form}~\ocwlowerid{\_}~\ocwlowerid{\_}~\ocwlowerid{\_}~\mid{}~\ocwupperid{Ind\_verb}~\ocwlowerid{\_}~\mid{}~\ocwupperid{Abs\_root}~\ocwlowerid{\_}~$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Avyayai\_form}~\mid{}~\ocwupperid{Unanalysed}~\mid{}~\ocwupperid{PV}~\ocwlowerid{\_}~$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Part\_form}~\ocwlowerid{\_}~\ocwlowerid{\_}~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}$\ocweol
\ocwindent{5.00em}
$\ocwlowerid{failwith}~$\ocwstring{"Unexpected\ocwvspace{}form\ocwvspace{}in\ocwvspace{}declensions"}\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Weird\ocwvspace{}table"}\ocweol
\ocwindent{2.50em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{init}~=~([\,],[\,],[\,],[\,],[\,],[\,])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display\_inflected}~\ocwlowerid{font}~(\ocwlowerid{gen\_deco},\ocwlowerid{pn\_deco},\ocwlowerid{voca\_deco},\ocwlowerid{iic\_deco},\ocwlowerid{avy\_deco})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{nouns}~=~\ocwupperid{Deco.}\ocwlowerid{fold}~\ocwlowerid{sort\_out}~\ocwlowerid{init}~\ocwlowerid{gen\_deco}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{non\_vocas}~=~\ocwupperid{Deco.}\ocwlowerid{fold}~\ocwlowerid{sort\_out}~\ocwlowerid{nouns}~\ocwlowerid{pn\_deco}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{mas},\ocwlowerid{fem},\ocwlowerid{neu},\ocwlowerid{any},\ocwlowerid{\_},\ocwlowerid{\_})~=~\ocwupperid{Deco.}\ocwlowerid{fold}~\ocwlowerid{sort\_out}~\ocwlowerid{non\_vocas}~\ocwlowerid{voca\_deco}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{iic}~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwlowerid{fst}~(\ocwupperid{Deco.}\ocwlowerid{contents}~\ocwlowerid{iic\_deco})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{avy}~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwlowerid{fst}~(\ocwupperid{Deco.}\ocwlowerid{contents}~\ocwlowerid{avy\_deco})~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{center\_begin}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{display\_gender}~\ocwlowerid{font}~\ocwupperid{Mas}~\ocwlowerid{mas}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{display\_gender}~\ocwlowerid{font}~\ocwupperid{Fem}~\ocwlowerid{fem}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{display\_gender}~\ocwlowerid{font}~\ocwupperid{Neu}~\ocwlowerid{neu}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{display\_gender}~\ocwlowerid{font}~(\ocwupperid{Deictic}~\ocwupperid{Numeral})~\ocwlowerid{any}~$\ocwbc{} arbitrary \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{display\_iic}~\ocwlowerid{font}~\ocwlowerid{iic}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{display\_avy}~\ocwlowerid{font}~\ocwlowerid{avy}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{center\_end}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_paragraph}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{entry}:\ocwlowerid{skt}$\ocwenddcode{} \ocwbegindcode{}$\ocwlowerid{part}:$\ocwbt{string}\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{emit\_decls}~\ocwlowerid{font}~\ocwlowerid{entry}~\ocwlowerid{decli}~\ocwlowerid{part}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{inflected}~=~\ocwupperid{Nouns.}\ocwlowerid{fake\_compute\_decls}~(\ocwlowerid{entry},\ocwlowerid{decli})~\ocwlowerid{part}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{display\_inflected}~\ocwlowerid{font}~\ocwlowerid{inflected}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{look\_up}~\ocwlowerid{font}~\ocwlowerid{entry}~\ocwlowerid{decli}~\ocwlowerid{part}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{code}~=~\ocwupperid{Encode.}\ocwlowerid{code\_string}~\ocwlowerid{entry}~$\ocwkw{in}~\ocwbc{} normalisation \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{e}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{code}~$\ocwkw{in}~\ocwbc{} coercion skt to string \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{emit\_decls}~\ocwlowerid{font}~\ocwlowerid{e}~\ocwlowerid{decli}~\ocwlowerid{part}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} This is very fragile: lexicon update induces code adaptation. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Temporary - should be subsumed by unique naming structure. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{resolve\_homonym}~\ocwlowerid{stem}~=~$\ocwkw{match}~$\ocwlowerid{stem}~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"atra"}~$\mid{}~$\ocwstring{"ad"}~$\mid{}~$\ocwstring{"abhii"}~$\mid{}~$\ocwstring{"iiz"}~$\mid{}~$\ocwstring{".rc"}~$\mid{}~$\ocwstring{"chad"}~$\mid{}~$\ocwstring{"dam"}~$\mid{}~$\ocwstring{"dah"}~$\mid{}~$\ocwstring{"daa"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"diz"}~$\mid{}~$\ocwstring{"diiv"}~$\mid{}~$\ocwstring{"duh"}~$\mid{}~$\ocwstring{"d.rz"}~$\mid{}~$\ocwstring{"druh"}~$\mid{}~$\ocwstring{"dvi.s"}~$\mid{}~$\ocwstring{"dhii"}~$\mid{}~$\ocwstring{"nas"}~$\mid{}~$\ocwstring{"nii"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"pad"}~$\mid{}~$\ocwstring{"budh"}~$\mid{}~$\ocwstring{"bhii"}~$\mid{}~$\ocwstring{"bhuu"}~$\mid{}~$\ocwstring{"math"}~$\mid{}~$\ocwstring{"yaa"}~$\mid{}~$\ocwstring{"yuj"}~$\mid{}~$\ocwstring{"raa"}~$\mid{}~$\ocwstring{"raaj"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"luu"}~$\mid{}~$\ocwstring{"viraaj"}~$\mid{}~$\ocwstring{"viz"}~$\mid{}~$\ocwstring{"vii"}~$\mid{}~$\ocwstring{"zubh"}~$\mid{}~$\ocwstring{"sa"}~$\mid{}~$\ocwstring{"sah"}~$\mid{}~$\ocwstring{"saa"}~$\mid{}~$\ocwstring{"s.rj"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"snih"}~$\mid{}~$\ocwstring{"snuh"}~$\mid{}~$\ocwstring{"han"}~\ocweol
\ocwindent{2.00em}
$\rightarrow{}~\ocwlowerid{stem}~$\^{}~\ocwstring{"\#2"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"agha"}~$\mid{}~$\ocwstring{"afga"}~$\mid{}~$\ocwstring{"aja"}~$\mid{}~$\ocwstring{"aaza"}~$\mid{}~$\ocwstring{"e.sa"}~$\mid{}~$\ocwstring{"ka"}~$\mid{}~$\ocwstring{"kara"}~$\mid{}~$\ocwstring{"tapas"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"dhaavat"}~$\mid{}~$\ocwstring{"nimita"}~$\mid{}~$\ocwstring{"pa"}~$\mid{}~$\ocwstring{"bhavat"}~$\mid{}~$\ocwstring{"bhaama"}~$\mid{}~$\ocwstring{"ya"}~$\mid{}~$\ocwstring{"yama"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"yaat.r"}~\ocwbc{} 1/2 \ocwec{}~$\mid{}~$\ocwstring{"vaasa"}~$\mid{}~$\ocwstring{"zaava"}~$\mid{}~$\ocwstring{"zrava.na"}~$\mid{}~$\ocwstring{"zvan"}~$\mid{}~$\ocwstring{"sthaa"}\ocweol
\ocwindent{2.00em}
$\rightarrow{}~\ocwlowerid{stem}~$\^{}~\ocwstring{"\#1"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"paa"}~$\rightarrow{}~\ocwlowerid{stem}~$\^{}~\ocwstring{"\#3"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{stem}$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{in\_lexicon}~\ocwlowerid{entry}~=~$\ocwbc{} entry as a string in VH transliteration \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwupperid{Index.}\ocwlowerid{is\_in\_lexicon}~(\ocwupperid{Encode.}\ocwlowerid{code\_string}~\ocwlowerid{entry})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{doubt}~\ocwlowerid{s}~=~$\ocwstring{"?"}~\^{}~$\ocwlowerid{s}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{gender\_of}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"Mas"}~$\rightarrow{}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Fem"}~$\rightarrow{}~\ocwupperid{Fem}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Neu"}~$\rightarrow{}~\ocwupperid{Neu}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Any"}~$\rightarrow{}~\ocwupperid{Deictic}~\ocwupperid{Numeral}~$\ocwbc{} arbitrary \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Weird\ocwvspace{}gender"}~\^{}~$\ocwlowerid{s})$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{decls\_engine}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{http\_header}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_begin}~\ocwlowerid{meta\_title}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{body\_begin}~\ocwlowerid{back\_ground})$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{query}~=~\ocwupperid{Sys.}\ocwlowerid{getenv}~$\ocwstring{"QUERY\_STRING"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{env}~=~\ocwlowerid{create\_env}~\ocwlowerid{query}~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{url\_encoded\_entry}~=~$\ocwkw{try}~$\ocwupperid{List.}\ocwlowerid{assoc}~$\ocwstring{"q"}~$\ocwlowerid{env}~$\ocweol
\ocwindent{14.00em}
\ocwkw{with}~$[~\ocwupperid{Not\_found}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Entry\ocwvspace{}name\ocwvspace{}missing"}~$]$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_gender}~=~\ocwlowerid{get}~$\ocwstring{"g"}~$\ocwlowerid{env}~$\ocwstring{"Mas"}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_participle}~=~\ocwlowerid{get}~$\ocwstring{"p"}~$\ocwlowerid{env}~$\ocwstring{""}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_source}~=~\ocwlowerid{get}~$\ocwstring{"r"}~$\ocwlowerid{env}~$\ocwstring{""}\ocweol
\ocwindent{4.00em}
\ocwbc{} optional root origin - used by participles in conjugation tables \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{font}~=~\ocwlowerid{font\_of\_string}~(\ocwlowerid{get}~$\ocwstring{"font"}~$\ocwlowerid{env}~\ocwupperid{Paths.}\ocwlowerid{default\_display\_font})$\ocweol
\ocwindent{0.00em}
\ocwbc{}  and stamp = get \ocwstring{"v"} env \ocwstring{""} - Obsolete \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{translit}~=~\ocwlowerid{get}~$\ocwstring{"t"}~$\ocwlowerid{env}~$\ocwstring{"VH"}~\ocwbc{} DICO created in VH trans \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{lex}~=~\ocwlowerid{get}~$\ocwstring{"lex"}~$\ocwlowerid{env}~$\ocwstring{"SH"}~\ocwbc{} default Heritage \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{entry\_tr}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_entry}~$\ocwbc{} : string in translit \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{gender}~=~\ocwlowerid{gender\_of}~(\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_gender})$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{part}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_participle}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{code}~=~\ocwupperid{Encode.}\ocwlowerid{switch\_code}~\ocwlowerid{translit}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{lang}~=~\ocwlowerid{language\_of}~\ocwlowerid{lex}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{source}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_source}~$\ocwbc{} cascading from conjug \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$()~=~\ocwlowerid{toggle\_lexicon}~\ocwlowerid{lex}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{try}~\ocwkw{do}~\ocweol
\ocwindent{3.00em}
\{~\ocwbc{} if lex=\ocwstring{"MW"} then () else if stamp=Install.stamp then ()
           else raise (Control.Anomaly \ocwstring{"Corrupt\ocwvspace{}lexicon"}); - OBS \ocwec{}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{display\_title}~\ocwlowerid{font}$\ocweol
\ocwindent{3.00em}
;~\ocwkw{let}~$\ocwlowerid{word}~=~\ocwlowerid{code}~\ocwlowerid{entry\_tr}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{entry\_VH}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{word}~$\ocwkw{in}~\ocwbc{} ugly detour via VH string \ocwec{}~\ocweol
\ocwindent{11.50em}
\ocwbc{} will be avoided by unique name lookup \ocwec{}~\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{entry}~=~\ocwlowerid{resolve\_homonym}~\ocwlowerid{entry\_VH}~$\ocwkw{in}~\ocwbc{} compute homonymy index \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{link}~=$\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{in\_lexicon}~\ocwlowerid{entry}~$\ocwkw{then}~$\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_anchor}~\ocwupperid{False}~\ocwlowerid{font}~\ocwlowerid{entry}$\ocweol
\ocwindent{6.50em}
\ocwbc{} We should check it is indeed a substantive entry 
                and that Any is used for deictics/numbers (TODO) \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{let}~$\ocwlowerid{root}~=~$\ocwkw{if}~$\ocwlowerid{source}~=~$\ocwstring{""}~\ocwkw{then}~\ocwstring{"?"}~\ocwbc{} unknown in lexicon \ocwec{}\ocweol
\ocwindent{13.00em}
\ocwkw{else}~\ocwstring{"\ocwvspace{}from\ocwvspace{}"}~\^{}~\ocweol
\ocwindent{7.50em}
\ocwkw{if}~$\ocwlowerid{in\_lexicon}~\ocwlowerid{source}~$\ocwkw{then}~$\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_anchor}~\ocwupperid{False}~\ocwlowerid{font}~\ocwlowerid{source}$\ocweol
\ocwindent{7.50em}
\ocwkw{else}~$\ocwlowerid{doubt}~(\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_roma}~\ocwlowerid{source})~$\ocwkw{in}\ocweol
\ocwindent{7.50em}
$\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_roma}~\ocwlowerid{entry}~$\^{}~$\ocwlowerid{root}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{subtitle}~=~\ocwlowerid{hyperlink\_title}~\ocwlowerid{font}~\ocwlowerid{link}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{display\_subtitle}~(\ocwlowerid{h1\_center}~\ocwlowerid{subtitle})$\ocweol
\ocwindent{4.00em}
;~\ocwkw{try}~$\ocwlowerid{look\_up}~\ocwlowerid{font}~\ocwlowerid{entry}~(\ocwupperid{Nouns.Gender}~\ocwlowerid{gender})~\ocwlowerid{part}$\ocweol
\ocwindent{5.00em}
\ocwkw{with}~$[~\ocwupperid{Stream.Error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{failwith}~\ocwlowerid{s}~]~$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{page\_end}~\ocwlowerid{lang}~\ocwupperid{True}$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
\ocwkw{with}~$[~\ocwupperid{Stream.Error}~\ocwlowerid{\_}~\rightarrow{}~$\ocweol
\ocwindent{6.50em}
$\ocwlowerid{abort}~\ocwlowerid{lang}~($\ocwstring{"Illegal\ocwvspace{}"}~\^{}~$\ocwlowerid{translit}~$\^{}~\ocwstring{"\ocwvspace{}transliteration\ocwvspace{}"}$)~\ocwlowerid{entry\_tr}~]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{safe\_engine}~()~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{abor}~=~\ocwlowerid{abort}~\ocwlowerid{default\_language}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwlowerid{decls\_engine}~()~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Sys\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{sys\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Stream.Error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{stream\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Invalid\_argument}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} sub \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Failure}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Control.Fatal}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Not\_found}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"assoc"}~\ocwbc{} assoc \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Control.Anomaly}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~($\ocwstring{"Anomaly:\ocwvspace{}"}~\^{}~$\ocwlowerid{s})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Nouns.Report}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Gender\ocwvspace{}anomaly\ocwvspace{}\symbol{45}\ocwvspace{}"}~$\ocwlowerid{s}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{End\_of\_file}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"EOF"}~\ocwbc{} EOF \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Encode.In\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Wrong\_input\ocwvspace{}"}~$\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Exit}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Wrong\ocwvspace{}character\ocwvspace{}in\ocwvspace{}input\ocwvspace{}\symbol{45}\ocwvspace{}"}~\ocwstring{"use\ocwvspace{}ASCII"}~\ocwbc{} Sanskrit \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"anomaly"}~\ocwbc{} ? \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{safe\_engine}~()$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Conjugation.ml}
\ocwmodule{Conjugation}
\label{conjugation.ml:0}%
CGI-bin conjugation for computing root conjugations.                   
\ocweol
\ocwindent{0.00em}
This CGI is triggered by page \ocwbegindcode{}$\ocwlowerid{grammar\_page}$\ocwenddcode{} in \ocwbegindcode{}$\ocwlowerid{dico\_dir}$\ocwenddcode{}.            
\ocweol
\ocwindent{0.00em}
Reads its input in shell variable \ocwbegindcode{}$\ocwupperid{QUERY\_STRING}$\ocwenddcode{} URI-encoded.          
\ocweol
\ocwindent{0.00em}
Prints an html document of root conjugations on \ocwbegindcode{}$\ocwlowerid{stdout}$\ocwenddcode{}.              
\ocweol
\label{conjugation.ml:1119}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocwbc{} inflected \ocwbegindcode{}$\ocwupperid{Verb\_form}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Conj\_infos};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{vmorph}~\ocwupperid{Causa}~\ocwupperid{Inten}~\ocwupperid{Desid}~\ocwlowerid{root\_infos}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Inflected};~$\ocwbc{} roots.val indecls.val etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps pl etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Cgi};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Multilingual};~$\ocwbc{} font gentense \ocwbegindcode{}$\ocwlowerid{tense\_name}$\ocwenddcode{} Deva Roma captions \ocwec{}\medskip

\label{conjugation.ml:1415}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ctitle}~\ocwlowerid{font}~=~\ocwlowerid{h1\_title}~(\ocwlowerid{conjugation\_title}~\ocwlowerid{narrow\_screen}~\ocwlowerid{font})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{meta\_title}~=~\ocwlowerid{title}~$\ocwstring{"Sanskrit\ocwvspace{}Grammarian\ocwvspace{}Conjugation\ocwvspace{}Engine"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{back\_ground}~=~\ocwlowerid{background}~\ocwupperid{Chamois}$\ocweol
\ocwindent{0.00em}
\ocwbc{} obs \ocwbegindcode{}\ocwkw{if}~$\ocwupperid{Install}.\ocwlowerid{narrow\_screen}~$\ocwkw{then}~$\ocwlowerid{background}~\ocwupperid{Mauve}~$\ocwkw{else}~$\ocwupperid{Pict\_gan}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{hyperlink\_title}~\ocwlowerid{font}~\ocwlowerid{link}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{narrow\_screen}~$\ocwkw{then}~$\ocwlowerid{link}$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~$\ocwlowerid{conjugation\_caption}~\ocwlowerid{font}~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}~$\ocwlowerid{link}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Wrong}~$\ocwkw{of}~\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
For non-unicode compliant browsers replace Canon.uniromcode by Canon.decode 
\ocweol
\label{conjugation.ml:1877}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pr}~\ocwlowerid{code}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{ps}~(\ocwlowerid{html\_red}~(\ocwupperid{Canon.}\ocwlowerid{uniromcode}~\ocwlowerid{code})~$\^{}~\ocwstring{"\ocwvspace{}"}$)~$\ocwbc{} roman with diacritics \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pr\_deva}~\ocwlowerid{code}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{ps}~(\ocwlowerid{html\_devared}~(\ocwupperid{Canon.}\ocwlowerid{unidevcode}~\ocwlowerid{code})~$\^{}~\ocwstring{"\ocwvspace{}"}$)~$\ocwbc{} devanagari \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pr\_f}~\ocwlowerid{font}~\ocwlowerid{word}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{code}~=~\ocwupperid{Morpho\_html.}\ocwlowerid{final}~\ocwlowerid{word}~$\ocwkw{in}~\ocwbc{} visarga correction \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{font}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~\ocwlowerid{pr\_deva}~\ocwlowerid{code}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~\ocwlowerid{pr}~\ocwlowerid{code}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{prlist\_font}~\ocwlowerid{font}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pr}~=~\ocwlowerid{pr\_f}~\ocwlowerid{font}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{bar}~=~\ocwlowerid{html\_green}~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{prlistrec}~$\ocweol
\ocwindent{2.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{prlistrec}~=~$\ocwkw{fun}\ocweol
\ocwindent{3.50em}
$[~[\,]~\rightarrow{}~()$\ocweol
\ocwindent{3.50em}
$\mid{}~[~\ocwlowerid{x}~]~\rightarrow{}~\ocwlowerid{pr}~\ocwlowerid{x}$\ocweol
\ocwindent{3.50em}
$\mid{}~[~\ocwlowerid{x}~::~\ocwlowerid{l}~]~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{pr}~\ocwlowerid{x};~\ocwlowerid{ps}~\ocwlowerid{bar};~\ocwlowerid{prlistrec}~\ocwlowerid{l}~\}$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{persons\_of}~\ocwlowerid{decls}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{reorg}~(\ocwlowerid{one},\ocwlowerid{two},\ocwlowerid{three})~(\ocwlowerid{p},\ocwlowerid{form})~=~$\ocwkw{match}~$\ocwlowerid{p}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{First}~\rightarrow{}~([~\ocwlowerid{form}~::~\ocwlowerid{one}~],\ocwlowerid{two},\ocwlowerid{three})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Second}~\rightarrow{}~(\ocwlowerid{one},[~\ocwlowerid{form}~::~\ocwlowerid{two}~],\ocwlowerid{three})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Third}~\rightarrow{}~(\ocwlowerid{one},\ocwlowerid{two},[~\ocwlowerid{form}~::~\ocwlowerid{three}~])$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{init}~=~([\,],[\,],[\,])~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{reorg}~\ocwlowerid{init}~\ocwlowerid{decls}~$\ocwbc{} (one,two,three) \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{numbers\_of}~\ocwlowerid{l}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{reorg}~(\ocwlowerid{sg},\ocwlowerid{du},\ocwlowerid{pl})~(\ocwlowerid{n},\ocwlowerid{p},\ocwlowerid{form})~=~$\ocwkw{match}~$\ocwlowerid{n}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Singular}~\rightarrow{}~([~(\ocwlowerid{p},\ocwlowerid{form})~::~\ocwlowerid{sg}~],\ocwlowerid{du},\ocwlowerid{pl})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Dual}~\rightarrow{}~(\ocwlowerid{sg},[~(\ocwlowerid{p},\ocwlowerid{form})~::~\ocwlowerid{du}~],\ocwlowerid{pl})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Plural}~\rightarrow{}~(\ocwlowerid{sg},\ocwlowerid{du},[~(\ocwlowerid{p},\ocwlowerid{form})~::~\ocwlowerid{pl}~])$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.50em}
\ocwkw{and}~$\ocwlowerid{init}~=~([\,],[\,],[\,])~$\ocwkw{in}\ocweol
\ocwindent{1.50em}
$\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{reorg}~\ocwlowerid{init}~\ocwlowerid{l}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{acell}~\ocwlowerid{display}~\ocwlowerid{s}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{display}~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_row1}~\ocwlowerid{caption}~\ocwlowerid{s}~\ocwlowerid{d}~\ocwlowerid{p}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{acell}~\ocwlowerid{ps}~\ocwlowerid{caption}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{acell}~\ocwlowerid{ps}~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{acell}~\ocwlowerid{ps}~\ocwlowerid{d}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{acell}~\ocwlowerid{ps}~\ocwlowerid{p}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{tr\_end}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_row\_font}~\ocwlowerid{font}~\ocwlowerid{caption}~\ocwlowerid{s}~\ocwlowerid{d}~\ocwlowerid{p}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{prlist}~=~\ocwlowerid{prlist\_font}~\ocwlowerid{font}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{tr\_mouse\_begin}~(\ocwlowerid{color}~\ocwupperid{Light\_blue})~(\ocwlowerid{color}~\ocwupperid{Pale\_yellow}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{acell}~\ocwlowerid{ps}~\ocwlowerid{caption}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{acell}~\ocwlowerid{prlist}~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{acell}~\ocwlowerid{prlist}~\ocwlowerid{d}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{acell}~\ocwlowerid{prlist}~\ocwlowerid{p}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{tr\_end}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display}~\ocwlowerid{font}~\ocwlowerid{ovoice}~\ocwlowerid{l}~=$\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$(\ocwlowerid{s},\ocwlowerid{d},\ocwlowerid{p})~=~\ocwlowerid{numbers\_of}~\ocwlowerid{l}~$\ocwkw{in}\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$(\ocwlowerid{f1},\ocwlowerid{s1},\ocwlowerid{t1})~=~\ocwlowerid{persons\_of}~\ocwlowerid{s}$\ocweol
\ocwindent{1.50em}
\ocwkw{and}~$(\ocwlowerid{f2},\ocwlowerid{s2},\ocwlowerid{t2})~=~\ocwlowerid{persons\_of}~\ocwlowerid{d}$\ocweol
\ocwindent{1.50em}
\ocwkw{and}~$(\ocwlowerid{f3},\ocwlowerid{s3},\ocwlowerid{t3})~=~\ocwlowerid{persons\_of}~\ocwlowerid{p}$\ocweol
\ocwindent{1.50em}
\ocwkw{and}~$\ocwlowerid{caption}~=~\ocwlowerid{voice\_name}~\ocwlowerid{ovoice}~\ocwlowerid{font}$\ocweol
\ocwindent{1.50em}
\ocwkw{and}~$\ocwlowerid{print\_row}~=~\ocwlowerid{print\_row\_font}~\ocwlowerid{font}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{3.50em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{3.50em}
;~$\ocwlowerid{pl}~(\ocwlowerid{table\_begin\_style}~\ocwupperid{Inflexion}~[~($\ocwstring{"border"},\ocwstring{"2"}$);~\ocwlowerid{padding5}~])$\ocweol
\ocwindent{3.50em}
;~\ocwkw{let}~$\ocwlowerid{sing}~=~\ocwlowerid{number\_caption}~\ocwupperid{Singular}~\ocwlowerid{font}$\ocweol
\ocwindent{4.50em}
\ocwkw{and}~$\ocwlowerid{dual}~=~\ocwlowerid{number\_caption}~\ocwupperid{Dual}~\ocwlowerid{font}~$\ocweol
\ocwindent{4.50em}
\ocwkw{and}~$\ocwlowerid{plur}~=~\ocwlowerid{number\_caption}~\ocwupperid{Plural}~\ocwlowerid{font}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$\ocwlowerid{print\_row1}~\ocwlowerid{caption}~\ocwlowerid{sing}~\ocwlowerid{dual}~\ocwlowerid{plur}~$\ocweol
\ocwindent{3.50em}
;~\ocwkw{match}~$\ocwlowerid{font}~$\ocwkw{with}\ocweol
\ocwindent{4.50em}
$[~\ocwupperid{Deva}~\rightarrow{}~$\ocwkw{do}~\ocwbc{} Indian style \ocwec{}\ocweol
\ocwindent{6.00em}
\{~$\ocwlowerid{print\_row}~(\ocwlowerid{person\_name}~\ocwupperid{Third}~\ocwupperid{Deva})~\ocwlowerid{t1}~\ocwlowerid{t2}~\ocwlowerid{t3}$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{print\_row}~(\ocwlowerid{person\_name}~\ocwupperid{Second}~\ocwupperid{Deva})~\ocwlowerid{s1}~\ocwlowerid{s2}~\ocwlowerid{s3}$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{print\_row}~(\ocwlowerid{person\_name}~\ocwupperid{First}~\ocwupperid{Deva})~\ocwlowerid{f1}~\ocwlowerid{f2}~\ocwlowerid{f3}$\ocweol
\ocwindent{6.00em}
\}\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~$\ocwkw{do}~\ocwbc{} Western style \ocwec{}\ocweol
\ocwindent{6.00em}
\{~$\ocwlowerid{print\_row}~(\ocwlowerid{person\_name}~\ocwupperid{First}~\ocwupperid{Roma})~\ocwlowerid{f1}~\ocwlowerid{f2}~\ocwlowerid{f3}$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{print\_row}~(\ocwlowerid{person\_name}~\ocwupperid{Second}~\ocwupperid{Roma})~\ocwlowerid{s1}~\ocwlowerid{s2}~\ocwlowerid{s3}$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{print\_row}~(\ocwlowerid{person\_name}~\ocwupperid{Third}~\ocwupperid{Roma})~\ocwlowerid{t1}~\ocwlowerid{t2}~\ocwlowerid{t3}$\ocweol
\ocwindent{6.00em}
\}\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{3.50em}
;~$\ocwlowerid{ps}~\ocwlowerid{table\_end}~$\ocweol
\ocwindent{3.50em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{3.50em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display\_table}~\ocwlowerid{font}~\ocwlowerid{ovoice}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{l}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{ps}~\ocwlowerid{th\_begin};~\ocwlowerid{display}~\ocwlowerid{font}~\ocwlowerid{ovoice}~\ocwlowerid{l};~\ocwlowerid{ps}~\ocwlowerid{th\_end}~\}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_caption}~\ocwlowerid{font}~\ocwlowerid{tense}~=~\ocwlowerid{ps}~(\ocwlowerid{tense\_name}~\ocwlowerid{tense}~\ocwlowerid{font})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display\_amp}~\ocwlowerid{font}~\ocwlowerid{otense}~\ocwlowerid{da}~\ocwlowerid{dm}~\ocwlowerid{dp}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{table\_begin}~(\ocwlowerid{centered}~\ocwupperid{Mauve}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwupperid{Gen.}\ocwlowerid{optional}~(\ocwlowerid{print\_caption}~\ocwlowerid{font})~\ocwlowerid{otense}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{xml\_begin}~$\ocwstring{"table"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{display\_table}~\ocwlowerid{font}~\ocwupperid{Active}~\ocwlowerid{da}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{display\_table}~\ocwlowerid{font}~\ocwupperid{Middle}~\ocwlowerid{dm}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{display\_table}~\ocwlowerid{font}~\ocwupperid{Passive}~\ocwlowerid{dp}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{tr\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{table\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{tr\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{table\_end}~$\ocwbc{} Mauve \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{display\_perfut}~\ocwlowerid{font}~\ocwlowerid{pfa}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{table\_begin\_style}~(\ocwlowerid{centered}~\ocwupperid{Mauve})~[\,])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{perfut\_name}~\ocwlowerid{font})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{xml\_begin}~$\ocwstring{"table"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{display\_table}~\ocwlowerid{font}~\ocwupperid{Active}~\ocwlowerid{pfa}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{tr\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{table\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{tr\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{table\_end}~$\ocwbc{} Mauve \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sort\_out\_v}~\ocwlowerid{accu}~\ocwlowerid{form}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~(\ocwlowerid{\_}~$\ocwbc{} delta \ocwec{},$\ocwlowerid{morphs})~]~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{reorg}~\ocwlowerid{accu}~\ocwlowerid{morphs}~$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{where}~\ocwlowerid{reorg}~(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})~=~$\ocwkw{fun}~\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Verb\_form}~(\ocwlowerid{\_}$\ocwbc{} conj \ocwec{},$\ocwlowerid{te})~\ocwlowerid{n}~\ocwlowerid{p}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{t}~=~(\ocwlowerid{n},\ocwlowerid{p},\ocwlowerid{form})~$\ocwkw{in}~\ocwkw{match}~$\ocwlowerid{te}~$\ocwkw{with}~\ocweol
\ocwindent{5.00em}
$[~\ocwupperid{Presenta}~\ocwlowerid{\_}~\ocwupperid{Present}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$([~\ocwlowerid{t}~::~\ocwlowerid{pa}~],\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Presentm}~\ocwlowerid{\_}~\ocwupperid{Present}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},[~\ocwlowerid{t}~::~\ocwlowerid{pm}~],\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Presenta}~\ocwlowerid{\_}~\ocwupperid{Imperfect}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},[~\ocwlowerid{t}~::~\ocwlowerid{ia}~],\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Presentm}~\ocwlowerid{\_}~\ocwupperid{Imperfect}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},[~\ocwlowerid{t}~::~\ocwlowerid{im}~],\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Presenta}~\ocwlowerid{\_}~\ocwupperid{Optative}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},[~\ocwlowerid{t}~::~\ocwlowerid{oa}~],\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Presentm}~\ocwlowerid{\_}~\ocwupperid{Optative}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},[~\ocwlowerid{t}~::~\ocwlowerid{om}~],\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Presenta}~\ocwlowerid{\_}~\ocwupperid{Imperative}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},[~\ocwlowerid{t}~::~\ocwlowerid{ea}~],\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Presentm}~\ocwlowerid{\_}~\ocwupperid{Imperative}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},[~\ocwlowerid{t}~::~\ocwlowerid{em}~],\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Conjug}~\ocwupperid{Future}~\ocwupperid{Active}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},[~\ocwlowerid{t}~::~\ocwlowerid{fa}~],\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Conjug}~\ocwupperid{Future}~\ocwupperid{Middle}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},[~\ocwlowerid{t}~::~\ocwlowerid{fm}~],\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Conjug}~\ocwupperid{Perfect}~\ocwupperid{Active}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},[~\ocwlowerid{t}~::~\ocwlowerid{pfa}~],\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Conjug}~\ocwupperid{Perfect}~\ocwupperid{Middle}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},[~\ocwlowerid{t}~::~\ocwlowerid{pfm}~],\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Conjug}~(\ocwupperid{Aorist}~\ocwlowerid{\_})~\ocwupperid{Active}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},[~\ocwlowerid{t}~::~\ocwlowerid{aa}~],\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Conjug}~(\ocwupperid{Aorist}~\ocwlowerid{\_})~\ocwupperid{Middle}~\mid{}~\ocwupperid{Conjug}~(\ocwupperid{Aorist}~\ocwlowerid{\_})~\ocwupperid{Passive}~\rightarrow{}~$\ocwbc{} passive-middle \ocwec{}\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},[~\ocwlowerid{t}~::~\ocwlowerid{am}],\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Conjug}~(\ocwupperid{Injunctive}~\ocwlowerid{\_})~\ocwupperid{Active}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},[~\ocwlowerid{t}~::~\ocwlowerid{ja}~],\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Conjug}~(\ocwupperid{Injunctive}~\ocwlowerid{\_})~\ocwupperid{Middle}~\mid{}~\ocwupperid{Conjug}~(\ocwupperid{Injunctive}~\ocwlowerid{\_})~\ocwupperid{Passive}~\rightarrow{}~$\ocwbc{} passive-middle \ocwec{}\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},[~\ocwlowerid{t}~::~\ocwlowerid{jm}~],\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Conjug}~\ocwupperid{Benedictive}~\ocwupperid{Active}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},[~\ocwlowerid{t}~::~\ocwlowerid{ba}~],\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Conjug}~\ocwupperid{Benedictive}~\ocwupperid{Middle}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},[~\ocwlowerid{t}~::~\ocwlowerid{bm}~],\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Perfut}~\ocwupperid{Active}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},[~\ocwlowerid{t}~::~\ocwlowerid{fpa}~],\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Presentp}~\ocwupperid{Present}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},[~\ocwlowerid{t}~::~\ocwlowerid{ps}~],\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Presentp}~\ocwupperid{Imperfect}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},[~\ocwlowerid{t}~::~\ocwlowerid{ip}~],\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Presentp}~\ocwupperid{Optative}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},[~\ocwlowerid{t}~::~\ocwlowerid{op}~],\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Presentp}~\ocwupperid{Imperative}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},[~\ocwlowerid{t}~::~\ocwlowerid{ep}~],\ocwlowerid{ca},\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Conjug}~\ocwupperid{Conditional}~\ocwupperid{Active}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},[~\ocwlowerid{t}~::~\ocwlowerid{ca}~],\ocwlowerid{cm})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Conjug}~\ocwupperid{Conditional}~\ocwupperid{Middle}~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},[~\ocwlowerid{t}~::~\ocwlowerid{cm}~])$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unknown\ocwvspace{}paradigm"}\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Fatal}~$\ocwstring{"Unexpected\ocwvspace{}verbal\ocwvspace{}form"}$)$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Fatal}~$\ocwstring{"Weird\ocwvspace{}inverse\ocwvspace{}map\ocwvspace{}V"}$)$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{init\_v}~=~([\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,],[\,])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display\_tense3}~\ocwlowerid{font}~\ocwlowerid{tense}~\ocwlowerid{la}~\ocwlowerid{lm}~\ocwlowerid{lp}~=$\ocweol
\ocwindent{1.50em}
\ocwkw{if}~$\ocwlowerid{la}=[\,]~\land{}~\ocwlowerid{lm}=[\,]~\land{}~\ocwlowerid{lp}=~[\,]~$\ocwkw{then}~$()$\ocweol
\ocwindent{1.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{target}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Simputer}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{5.00em}
\{~\ocwkw{if}~$\ocwlowerid{la}=[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~$\ocwlowerid{display\_amp}~\ocwlowerid{font}~(\ocwupperid{Some}~\ocwlowerid{tense})~\ocwlowerid{la}~[\,]~[\,]$\ocweol
\ocwindent{5.00em}
;~\ocwkw{let}~$\ocwlowerid{caption}~=~$\ocwkw{if}~$\ocwlowerid{la}=[\,]~$\ocwkw{then}~$\ocwupperid{Some}~\ocwlowerid{tense}~$\ocwkw{else}~$\ocwupperid{None}~$\ocwkw{in}\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{lm}=[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~$\ocwlowerid{display\_amp}~\ocwlowerid{font}~\ocwlowerid{caption}~[\,]~\ocwlowerid{lm}~[\,]$\ocweol
\ocwindent{5.00em}
;~\ocwkw{let}~$\ocwlowerid{caption}~=~$\ocwkw{if}~$\ocwlowerid{la}=[\,]~\land{}~\ocwlowerid{lm}=[\,]~$\ocwkw{then}~$\ocwupperid{Some}~\ocwlowerid{tense}~$\ocwkw{else}~$\ocwupperid{None}~$\ocwkw{in}\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{lp}=[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~$\ocwlowerid{display\_amp}~\ocwlowerid{font}~\ocwlowerid{caption}~[\,]~[\,]~\ocwlowerid{lp}$\ocweol
\ocwindent{5.00em}
\}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{display\_amp}~\ocwlowerid{font}~(\ocwupperid{Some}~\ocwlowerid{tense})~\ocwlowerid{la}~\ocwlowerid{lm}~\ocwlowerid{lp}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{display\_tense2}~\ocwlowerid{font}~\ocwlowerid{tense}~\ocwlowerid{la}~\ocwlowerid{lm}~=$\ocweol
\ocwindent{1.50em}
\ocwkw{if}~$\ocwlowerid{la}=[\,]~\land{}~\ocwlowerid{lm}=[\,]~$\ocwkw{then}~$()$\ocweol
\ocwindent{1.50em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{target}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Simputer}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{5.00em}
\{~\ocwkw{if}~$\ocwlowerid{la}=[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~$\ocwlowerid{display\_amp}~\ocwlowerid{font}~(\ocwupperid{Some}~\ocwlowerid{tense})~\ocwlowerid{la}~[\,]~[\,]$\ocweol
\ocwindent{5.00em}
;~\ocwkw{let}~$\ocwlowerid{caption}~=~$\ocwkw{if}~$\ocwlowerid{la}=[\,]~$\ocwkw{then}~$\ocwupperid{Some}~\ocwlowerid{tense}~$\ocwkw{else}~$\ocwupperid{None}~$\ocwkw{in}\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{lm}=[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~$\ocwlowerid{display\_amp}~\ocwlowerid{font}~\ocwlowerid{caption}~[\,]~\ocwlowerid{lm}~[\,]$\ocweol
\ocwindent{5.00em}
\}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{display\_amp}~\ocwlowerid{font}~(\ocwupperid{Some}~\ocwlowerid{tense})~\ocwlowerid{la}~\ocwlowerid{lm}~[\,]$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display\_conjug}~\ocwlowerid{font}~\ocwlowerid{conj}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_paragraph}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{table\_begin}~(\ocwlowerid{centered}~\ocwupperid{Cyan}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{conjugation\_name}~\ocwlowerid{conj}~\ocwlowerid{font})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{table\_end}~$\ocwbc{} Cyan \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_paragraph}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{display\_title}~\ocwlowerid{font}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_paragraph}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{table\_begin}~(\ocwlowerid{centered}~\ocwupperid{Mauve}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{ctitle}~\ocwlowerid{font})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{table\_end}~$\ocwbc{} Mauve \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_paragraph}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{display\_subtitle}~\ocwlowerid{title}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_paragraph}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{table\_begin}~(\ocwlowerid{centered}~\ocwupperid{Deep\_sky}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{title}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{table\_end}~$\ocwbc{} Centered \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_paragraph}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display\_inflected\_v}~\ocwlowerid{font}~$\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{pa},\ocwlowerid{pm},\ocwlowerid{ia},\ocwlowerid{im},\ocwlowerid{oa},\ocwlowerid{om},\ocwlowerid{ea},\ocwlowerid{em},\ocwlowerid{fa},\ocwlowerid{fm},\ocwlowerid{pfa},\ocwlowerid{pfm},\ocwlowerid{aa},\ocwlowerid{am},\ocwlowerid{ja},\ocwlowerid{jm},\ocwlowerid{ba},\ocwlowerid{bm},\ocwlowerid{fpa},\ocwlowerid{ps},\ocwlowerid{ip},\ocwlowerid{op},\ocwlowerid{ep},\ocwlowerid{ca},\ocwlowerid{cm})~=~$\ocwkw{do}\ocweol
\ocwindent{0.50em}
\{~$\ocwlowerid{pl}~\ocwlowerid{center\_begin}~$\ocweol
\ocwindent{0.50em}
;~\ocwkw{let}~$\ocwlowerid{tense}~=~\ocwupperid{Present\_tense}~\ocwupperid{Present}~$\ocwkw{in}\ocweol
\ocwindent{1.50em}
$\ocwlowerid{display\_tense3}~\ocwlowerid{font}~\ocwlowerid{tense}~\ocwlowerid{pa}~\ocwlowerid{pm}~\ocwlowerid{ps}$\ocweol
\ocwindent{0.50em}
;~\ocwkw{if}~$\ocwlowerid{ia}=[\,]~\land{}~\ocwlowerid{im}=[\,]~\land{}~\ocwlowerid{ip}=[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break};~$\ocwkw{let}~$\ocwlowerid{tense}~=~\ocwupperid{Present\_tense}~\ocwupperid{Imperfect}~$\ocwkw{in}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{display\_tense3}~\ocwlowerid{font}~\ocwlowerid{tense}~\ocwlowerid{ia}~\ocwlowerid{im}~\ocwlowerid{ip}~\}$\ocweol
\ocwindent{0.50em}
;~\ocwkw{if}~$\ocwlowerid{oa}=[\,]~\land{}~\ocwlowerid{om}=[\,]~\land{}~\ocwlowerid{op}=[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break};~$\ocwkw{let}~$\ocwlowerid{tense}~=~\ocwupperid{Present\_tense}~\ocwupperid{Optative}~$\ocwkw{in}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{display\_tense3}~\ocwlowerid{font}~\ocwlowerid{tense}~\ocwlowerid{oa}~\ocwlowerid{om}~\ocwlowerid{op}~\}$\ocweol
\ocwindent{0.50em}
;~\ocwkw{if}~$\ocwlowerid{ea}=[\,]~\land{}~\ocwlowerid{em}=[\,]~\land{}~\ocwlowerid{ep}=[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break};~$\ocwkw{let}~$\ocwlowerid{tense}~=~\ocwupperid{Present\_tense}~\ocwupperid{Imperative}~$\ocwkw{in}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{display\_tense3}~\ocwlowerid{font}~\ocwlowerid{tense}~\ocwlowerid{ea}~\ocwlowerid{em}~\ocwlowerid{ep}~\}$\ocweol
\ocwindent{0.50em}
;~\ocwkw{if}~$\ocwlowerid{fa}=[\,]~\land{}~\ocwlowerid{fm}=[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break};~$\ocwkw{let}~$\ocwlowerid{tense}~=~\ocwupperid{Other\_tense}~\ocwupperid{Future}~$\ocwkw{in}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{display\_tense2}~\ocwlowerid{font}~\ocwlowerid{tense}~\ocwlowerid{fa}~\ocwlowerid{fm}~\}$\ocweol
\ocwindent{0.50em}
;~\ocwkw{if}~$\ocwlowerid{ca}=[\,]~\land{}~\ocwlowerid{cm}=[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break};~$\ocwkw{let}~$\ocwlowerid{tense}~=~\ocwupperid{Other\_tense}~\ocwupperid{Conditional}~$\ocwkw{in}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{display\_tense2}~\ocwlowerid{font}~\ocwlowerid{tense}~\ocwlowerid{ca}~\ocwlowerid{cm}~\}$\ocweol
\ocwindent{0.50em}
;~\ocwkw{if}~$\ocwlowerid{fpa}=[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break};~\ocwlowerid{display\_perfut}~\ocwlowerid{font}~\ocwlowerid{fpa}~\}$\ocweol
\ocwindent{0.50em}
;~\ocwkw{if}~$\ocwlowerid{pfa}=[\,]~\land{}~\ocwlowerid{pfm}=[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}~\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break};~$\ocwkw{let}~$\ocwlowerid{tense}~=~\ocwupperid{Other\_tense}~\ocwupperid{Perfect}~$\ocwkw{in}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{display\_tense2}~\ocwlowerid{font}~\ocwlowerid{tense}~\ocwlowerid{pfa}~\ocwlowerid{pfm}~\}$\ocweol
\ocwindent{0.50em}
;~\ocwkw{if}~$\ocwlowerid{aa}=[\,]~\land{}~\ocwlowerid{am}=[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break};~$\ocwkw{let}~$\ocwlowerid{tense}~=~\ocwupperid{Other\_tense}~(\ocwupperid{Aorist}~0)~$\ocwkw{in}~\ocwbc{} forget class \ocwec{}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{display\_tense2}~\ocwlowerid{font}~\ocwlowerid{tense}~\ocwlowerid{aa}~\ocwlowerid{am}~\}$\ocweol
\ocwindent{0.50em}
;~\ocwkw{if}~$\ocwlowerid{ja}=[\,]~\land{}~\ocwlowerid{jm}=[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break};~$\ocwkw{let}~$\ocwlowerid{tense}~=~\ocwupperid{Other\_tense}~(\ocwupperid{Injunctive}~0)~$\ocwkw{in}~\ocwbc{} forget class \ocwec{}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{display\_tense2}~\ocwlowerid{font}~\ocwlowerid{tense}~\ocwlowerid{ja}~\ocwlowerid{jm}~\}$\ocweol
\ocwindent{0.50em}
;~\ocwkw{if}~$\ocwlowerid{ba}=[\,]~\land{}~\ocwlowerid{bm}=[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break};~$\ocwkw{let}~$\ocwlowerid{tense}~=~\ocwupperid{Other\_tense}~\ocwupperid{Benedictive}~$\ocwkw{in}~\ocweol
\ocwindent{11.00em}
$\ocwlowerid{display\_tense2}~\ocwlowerid{font}~\ocwlowerid{tense}~\ocwlowerid{ba}~\ocwlowerid{bm}~\}$\ocweol
\ocwindent{0.50em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_end}$\ocweol
\ocwindent{0.50em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_paragraph}$\ocweol
\ocwindent{0.50em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display\_ind}~\ocwlowerid{ind}~\ocwlowerid{font}~=~\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{disp}~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~\ocwlowerid{disp}~(\ocwlowerid{\_conj},\ocwlowerid{f})~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{h3\_begin}~\ocwupperid{B3})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{ind}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pr\_f}~\ocwlowerid{font}~\ocwlowerid{f}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{h3\_end}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display\_inflected\_u}~\ocwlowerid{font}~\ocwlowerid{inf}~\ocwlowerid{absya}~\ocwlowerid{per}~\ocwlowerid{abstva}~=~$\ocwkw{do}\ocweol
\ocwindent{0.50em}
\{~$\ocwlowerid{pl}~\ocwlowerid{center\_begin}~$\ocweol
\ocwindent{0.50em}
;~$\ocwlowerid{display\_ind}~(\ocwlowerid{infinitive\_caption}~\ocwlowerid{font})~\ocwlowerid{font}~\ocwlowerid{inf}$\ocweol
\ocwindent{0.50em}
;~$\ocwlowerid{display\_ind}~(\ocwlowerid{absolutive\_caption}~\ocwupperid{True}~\ocwlowerid{font})~\ocwlowerid{font}~\ocwlowerid{abstva}$\ocweol
\ocwindent{0.50em}
;~$\ocwlowerid{display\_ind}~(\ocwlowerid{absolutive\_caption}~\ocwupperid{False}~\ocwlowerid{font})~\ocwlowerid{font}~(\ocwupperid{List.}\ocwlowerid{map}~\ocwlowerid{prefix\_dash}~\ocwlowerid{absya})$\ocweol
\ocwindent{1.50em}
$\ocwlowerid{where}~\ocwlowerid{prefix\_dash}~(\ocwlowerid{c},\ocwlowerid{w})~=~(\ocwlowerid{c},[~0~::~\ocwlowerid{w}~])~$\ocweol
\ocwindent{0.50em}
;~$\ocwlowerid{display\_ind}~(\ocwlowerid{peripft\_caption}~\ocwlowerid{font})~\ocwlowerid{font}~\ocwlowerid{per}$\ocweol
\ocwindent{0.50em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_end}$\ocweol
\ocwindent{0.50em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{encode\_part}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Ppp}~\rightarrow{}~$\ocwstring{"Ppp"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pppa}~\rightarrow{}~$\ocwstring{"Pppa"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppra}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"Ppra"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pprm}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"Pprm"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pprp}~\rightarrow{}~$\ocwstring{"Pprp"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppfta}~\rightarrow{}~$\ocwstring{"Ppfta"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppftm}~\rightarrow{}~$\ocwstring{"Ppftm"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfuta}~\rightarrow{}~$\ocwstring{"Pfuta"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfutm}~\rightarrow{}~$\ocwstring{"Pfutm"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfutp}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"Pfutp"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Action\_noun}~\rightarrow{}~$\ocwstring{"Act"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} inspired from \ocwbegindcode{}$\ocwupperid{Print\_html}.\ocwlowerid{decl\_url}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{decl\_url}~\ocwlowerid{g}~\ocwlowerid{s}~\ocwlowerid{f}~\ocwlowerid{r}~\ocwlowerid{part}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{gen},\ocwlowerid{link})~=~$\ocwkw{match}~$\ocwlowerid{g}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~\ocwupperid{Mas}~\rightarrow{}~($\ocwstring{"Mas"},\ocwstring{"m."}$)$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~($\ocwstring{"Neu"},\ocwstring{"n."}$)$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Fem}~\rightarrow{}~($\ocwstring{"Fem"},\ocwstring{"f."}$)$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unexpected\ocwvspace{}deictic"}\ocweol
\ocwindent{2.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{invoke}~=~\ocwlowerid{decls\_cgi}~$\^{}~\ocwstring{"?q="}~\^{}~$(\ocwupperid{Transduction.}\ocwlowerid{encode\_url}~\ocwlowerid{s})$\ocweol
\ocwindent{2.50em}
\^{}~\ocwstring{";g="}~\^{}~$\ocwlowerid{gen}~$\^{}~\ocwstring{";font="}~\^{}~$\ocwlowerid{f}~$\^{}~\ocwstring{";r="}~\^{}~$(\ocwupperid{Transduction.}\ocwlowerid{encode\_url}~\ocwlowerid{r})~$\ocweol
\ocwindent{2.50em}
\^{}~\ocwstring{";p="}~\^{}~$(\ocwlowerid{encode\_part}~\ocwlowerid{part})~$\^{}~\ocwstring{";lex="}~\^{}~$\ocwlowerid{lexicon\_toggle.}\ocwlowerid{val}~$\ocwbc{} Keeping the language \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{anchor}~\ocwupperid{Red\_}~\ocwlowerid{invoke}~\ocwlowerid{link}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display\_part}~\ocwlowerid{font}~\ocwlowerid{entry}~\ocwlowerid{part}~\ocwlowerid{stem\_mn}~\ocwlowerid{stem\_f}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{str\_mn}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{stem\_mn}$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{str\_f}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{stem\_f}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{str\_font}~=~\ocwlowerid{string\_of\_font}~\ocwlowerid{font}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{h3\_begin}~\ocwupperid{B3})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{participle\_name}~\ocwlowerid{part}~\ocwlowerid{font})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pr\_f}~\ocwlowerid{font}~\ocwlowerid{stem\_mn}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{decl\_url}~\ocwupperid{Mas}~\ocwlowerid{str\_mn}~\ocwlowerid{str\_font}~\ocwlowerid{entry}~\ocwlowerid{part})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{decl\_url}~\ocwupperid{Neu}~\ocwlowerid{str\_mn}~\ocwlowerid{str\_font}~\ocwlowerid{entry}~\ocwlowerid{part})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pr\_f}~\ocwlowerid{font}~\ocwlowerid{stem\_f}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{decl\_url}~\ocwupperid{Fem}~\ocwlowerid{str\_f}~\ocwlowerid{str\_font}~\ocwlowerid{entry}~\ocwlowerid{part})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{h3\_end}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{abort\_display}~\ocwlowerid{mess}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{th\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{table\_end}~$\ocwbc{} Mauve \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{failwith}~\ocwlowerid{mess}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{look\_up\_and\_display}~\ocwlowerid{font}~\ocwlowerid{gana}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{print\_conjug}~\ocwlowerid{conj}~\ocwlowerid{parts}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{process\_pp}~=~\ocwlowerid{p}~[\,]~\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{p}~\ocwlowerid{acc}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{acc}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{x}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{x}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Parts.Ppp\_}~\ocwlowerid{con}~\ocwlowerid{rstem}~\ocwlowerid{\_}~$\ocwkw{when}~$\ocwlowerid{con}=\ocwlowerid{conj}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}\ocweol
\ocwindent{4.50em}
$[~[~1~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{sm}~=~\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{5.50em}
\ocwkw{and}~$\ocwlowerid{sf}~=~\ocwupperid{List.}\ocwlowerid{rev}~[~2~::~\ocwlowerid{r}~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{5.50em}
\{~$\ocwlowerid{display\_part}~\ocwlowerid{font}~\ocwlowerid{entry}~\ocwupperid{Ppp}~\ocwlowerid{sm}~\ocwlowerid{sf}$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{p}~\ocwlowerid{acc}~\ocwlowerid{rest}$\ocweol
\ocwindent{5.50em}
\}\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abort\_display}~$\ocwstring{"Weird\ocwvspace{}Ppp"}\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{other}~\rightarrow{}~\ocwlowerid{p}~[~\ocwlowerid{other}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{process\_ppa}~=~\ocwlowerid{p}~[\,]~\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{p}~\ocwlowerid{acc}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{acc}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{x}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{x}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Parts.Pppa\_}~\ocwlowerid{con}~\ocwlowerid{stem}~\ocwlowerid{\_}~$\ocwkw{when}~$\ocwlowerid{con}=\ocwlowerid{conj}~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{sm}~=~\ocwupperid{Parts.}\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"at"}\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{sf}~=~\ocwupperid{Parts.}\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"atii"}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{display\_part}~\ocwlowerid{font}~\ocwlowerid{entry}~\ocwupperid{Pppa}~\ocwlowerid{sm}~\ocwlowerid{sf}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{p}~\ocwlowerid{acc}~\ocwlowerid{rest}$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{other}~\rightarrow{}~\ocwlowerid{p}~[~\ocwlowerid{other}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{process\_pra}~=~\ocwlowerid{p}~[\,]~\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{p}~\ocwlowerid{acc}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{acc}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{x}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{x}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Parts.Ppra\_}~\ocwlowerid{k}~\ocwlowerid{con}~\ocwlowerid{m\_stem}~\ocwlowerid{f\_stem}~\ocwlowerid{\_}~$\ocwkw{when}~$\ocwlowerid{con}=\ocwlowerid{conj}~\rightarrow{}$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{sm}~=~\ocwupperid{Parts.}\ocwlowerid{fix}~\ocwlowerid{m\_stem}~$\ocwstring{"at"}\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{sf}~=~\ocwupperid{Parts.}\ocwlowerid{fix}~\ocwlowerid{f\_stem}~$\ocwstring{"ii"}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{display\_part}~\ocwlowerid{font}~\ocwlowerid{entry}~(\ocwupperid{Ppra}~\ocwlowerid{k})~\ocwlowerid{sm}~\ocwlowerid{sf}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{p}~\ocwlowerid{acc}~\ocwlowerid{rest}$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Parts.Pprared\_}~\ocwlowerid{con}~\ocwlowerid{stem}~\ocwlowerid{\_}~$\ocwkw{when}~$\ocwlowerid{con}=\ocwlowerid{conj}~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{k}~=~$\ocwkw{if}~$\ocwlowerid{con}=\ocwupperid{Intensive}~$\ocwkw{then}~$\ocwupperid{Parts.}\ocwlowerid{int\_gana}~$\ocwkw{else}~3~\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{sm}~=~\ocwupperid{Parts.}\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"at"}\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{sf}~=~\ocwupperid{Parts.}\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"atii"}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{display\_part}~\ocwlowerid{font}~\ocwlowerid{entry}~(\ocwupperid{Ppra}~\ocwlowerid{k})~\ocwlowerid{sm}~\ocwlowerid{sf}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{p}~\ocwlowerid{acc}~\ocwlowerid{rest}$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{other}~\rightarrow{}~\ocwlowerid{p}~[~\ocwlowerid{other}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{process\_prm}~=~\ocwlowerid{p}~[\,]~\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{p}~\ocwlowerid{acc}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{acc}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{x}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{x}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Parts.Pprm\_}~\ocwlowerid{k}~\ocwlowerid{con}~\ocwlowerid{stem}~\ocwlowerid{\_}~$\ocwkw{when}~$\ocwlowerid{con}=\ocwlowerid{conj}~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{sm}~=~\ocwupperid{List.}\ocwlowerid{rev}~[~1~::~\ocwlowerid{stem}~]$\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{sf}~=~\ocwupperid{List.}\ocwlowerid{rev}~[~2~::~\ocwlowerid{stem}~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{display\_part}~\ocwlowerid{font}~\ocwlowerid{entry}~(\ocwupperid{Pprm}~\ocwlowerid{k})~\ocwlowerid{sm}~\ocwlowerid{sf}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{p}~\ocwlowerid{acc}~\ocwlowerid{rest}$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{other}~\rightarrow{}~\ocwlowerid{p}~[~\ocwlowerid{other}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{process\_prp}~=~\ocwlowerid{p}~[\,]~\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{p}~\ocwlowerid{acc}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{acc}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{x}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{x}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Parts.Pprp\_}~\ocwlowerid{con}~\ocwlowerid{stem}~\ocwlowerid{\_}~$\ocwkw{when}~$\ocwlowerid{con}=\ocwlowerid{conj}~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{sm}~=~\ocwupperid{List.}\ocwlowerid{rev}~[~1~::~\ocwlowerid{stem}~]$\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{sf}~=~\ocwupperid{List.}\ocwlowerid{rev}~[~2~::~\ocwlowerid{stem}~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{display\_part}~\ocwlowerid{font}~\ocwlowerid{entry}~\ocwupperid{Pprp}~\ocwlowerid{sm}~\ocwlowerid{sf}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{p}~\ocwlowerid{acc}~\ocwlowerid{rest}$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{other}~\rightarrow{}~\ocwlowerid{p}~[~\ocwlowerid{other}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{process\_pfta}~=~\ocwlowerid{p}~[\,]~\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{p}~\ocwlowerid{acc}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{acc}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{x}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{x}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Parts.Ppfta\_}~\ocwlowerid{con}~\ocwlowerid{stem}~\ocwlowerid{\_}~$\ocwkw{when}~$\ocwlowerid{con}=\ocwlowerid{conj}~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{vstem}~=~$\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{monosyllabic}~\ocwlowerid{stem}~$\ocwkw{then}\ocweol
\ocwindent{11.50em}
\ocwkw{if}~$\ocwlowerid{stem}~=~[~34;~3;~45~]~$\ocwbc{} vid \ocwec{}~\ocwkw{then}~$\ocwlowerid{stem}~$\ocwbc{} should test entry \ocwec{}\ocweol
\ocwindent{11.50em}
\ocwkw{else}~$\ocwupperid{List.}\ocwlowerid{rev}~(\ocwupperid{Parts.}\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"i"}$)~$\ocwbc{} intercalating i \ocwec{}\ocweol
\ocwindent{10.00em}
\ocwkw{else}~$\ocwlowerid{stem}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{sm}~=~\ocwupperid{Parts.}\ocwlowerid{fix}~\ocwlowerid{vstem}~$\ocwstring{"vas"}\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{sf}~=~\ocwupperid{Parts.}\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"u.sii"}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{display\_part}~\ocwlowerid{font}~\ocwlowerid{entry}~\ocwupperid{Ppfta}~\ocwlowerid{sm}~\ocwlowerid{sf}$\ocweol
\ocwindent{4.00em}
;~\ocwkw{if}~$\ocwlowerid{con}=\ocwupperid{Primary}~\land{}~$\ocweol
\ocwindent{7.00em}
$(~\ocwlowerid{stem}~=~[~34;~3;~45~]~$\ocwbc{} vid \ocwec{}~\ocwbc{} \ocwbegindcode{}$\ocwupperid{Parts}.\ocwlowerid{build\_more\_ppfa}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{7.00em}
$\lor{}~\ocwlowerid{stem}~=~[~46;~3;~45;~3;~45~]~$\ocwbc{} vivi's \ocwec{}~\ocwbc{} horrible code \ocwec{}\ocweol
\ocwindent{7.00em}
$\lor{}~\ocwlowerid{stem}~=~[~46;~7;~34;~1;~34~]~$\ocwbc{} dad.r's \ocwec{}~\ocweol
\ocwindent{7.00em}
$)$\ocweol
\ocwindent{5.00em}
\ocwkw{then}~\ocwkw{let}~$\ocwlowerid{sm}~=~\ocwupperid{Parts.}\ocwlowerid{fix}~\ocwlowerid{vstem}~$\ocwstring{"ivas"}~\ocwkw{in}~\ocweol
\ocwindent{7.50em}
$\ocwlowerid{display\_part}~\ocwlowerid{font}~\ocwlowerid{entry}~\ocwupperid{Ppfta}~\ocwlowerid{sm}~\ocwlowerid{sf}$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$()$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{p}~\ocwlowerid{acc}~\ocwlowerid{rest}$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{other}~\rightarrow{}~\ocwlowerid{p}~[~\ocwlowerid{other}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{process\_pftm}~=~\ocwlowerid{p}~[\,]~\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{p}~\ocwlowerid{acc}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{acc}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{x}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{x}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Parts.Ppftm\_}~\ocwlowerid{con}~\ocwlowerid{stem}~\ocwlowerid{\_}~$\ocwkw{when}~$\ocwlowerid{con}=\ocwlowerid{conj}~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{sm}~=~\ocwupperid{List.}\ocwlowerid{rev}~[~1~::~\ocwlowerid{stem}~]$\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{sf}~=~\ocwupperid{List.}\ocwlowerid{rev}~[~2~::~\ocwlowerid{stem}~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{display\_part}~\ocwlowerid{font}~\ocwlowerid{entry}~\ocwupperid{Ppftm}~\ocwlowerid{sm}~\ocwlowerid{sf}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{p}~\ocwlowerid{acc}~\ocwlowerid{rest}$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{other}~\rightarrow{}~\ocwlowerid{p}~[~\ocwlowerid{other}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{process\_futa}~=~\ocwlowerid{p}~[\,]~\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{p}~\ocwlowerid{acc}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{acc}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{x}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{x}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Parts.Pfuta\_}~\ocwlowerid{con}~\ocwlowerid{stem}~\ocwlowerid{\_}~$\ocwkw{when}~$\ocwlowerid{con}=\ocwlowerid{conj}~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{sm}~=~\ocwupperid{Parts.}\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"at"}~\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{sf}~=~\ocwupperid{Parts.}\ocwlowerid{fix}~\ocwlowerid{stem}~$\ocwstring{"antii"}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{display\_part}~\ocwlowerid{font}~\ocwlowerid{entry}~\ocwupperid{Pfuta}~\ocwlowerid{sm}~\ocwlowerid{sf}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{p}~\ocwlowerid{acc}~\ocwlowerid{rest}$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{other}~\rightarrow{}~\ocwlowerid{p}~[~\ocwlowerid{other}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{process\_futm}~=~\ocwlowerid{p}~[\,]~\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{p}~\ocwlowerid{acc}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{acc}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{x}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{x}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Parts.Pfutm\_}~\ocwlowerid{con}~\ocwlowerid{stem}~\ocwlowerid{\_}~$\ocwkw{when}~$\ocwlowerid{con}=\ocwlowerid{conj}~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{sm}~=~\ocwupperid{List.}\ocwlowerid{rev}~[~1~::~\ocwlowerid{stem}~]$\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{sf}~=~\ocwupperid{List.}\ocwlowerid{rev}~[~2~::~\ocwlowerid{stem}~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{display\_part}~\ocwlowerid{font}~\ocwlowerid{entry}~\ocwupperid{Pfutm}~\ocwlowerid{sm}~\ocwlowerid{sf}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{p}~\ocwlowerid{acc}~\ocwlowerid{rest}$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{other}~\rightarrow{}~\ocwlowerid{p}~[~\ocwlowerid{other}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{process\_pfp}~=~\ocwlowerid{p}~[\,]~\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{p}~\ocwlowerid{acc}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{acc}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{x}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{x}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Parts.Pfutp\_}~\ocwlowerid{con}~\ocwlowerid{rstem}~\ocwlowerid{\_}~$\ocwkw{when}~$\ocwlowerid{con}=\ocwlowerid{conj}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{rstem}~$\ocwkw{with}\ocweol
\ocwindent{4.50em}
$[~[~1~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{k}~=~$\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}\ocweol
\ocwindent{7.00em}
$[~[~42~::~[~45~::~[~1~::~[~32~::~\ocwlowerid{\_}~]~]~]~]~\rightarrow{}~3~$\ocwbc{} -tavya \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~[~42~::~[~4~::~\ocwlowerid{\_}~]~]~\rightarrow{}~2~$\ocwbc{} -aniiya \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~[~42~::~\ocwlowerid{\_}~]~\rightarrow{}~1~$\ocwbc{} -ya \ocwec{}\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Weird\ocwvspace{}Pfp:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{rdecode}~\ocwlowerid{rstem})$\ocweol
\ocwindent{7.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{sm}~=~\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{rstem}~$\ocweol
\ocwindent{5.50em}
\ocwkw{and}~$\ocwlowerid{sf}~=~\ocwupperid{List.}\ocwlowerid{rev}~[~2~::~\ocwlowerid{r}~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{5.50em}
\{~$\ocwlowerid{display\_part}~\ocwlowerid{font}~\ocwlowerid{entry}~(\ocwupperid{Pfutp}~\ocwlowerid{k})~\ocwlowerid{sm}~\ocwlowerid{sf}$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{p}~\ocwlowerid{acc}~\ocwlowerid{rest}$\ocweol
\ocwindent{5.50em}
\}\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Weird\ocwvspace{}Pfutp"}\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{other}~\rightarrow{}~\ocwlowerid{p}~[~\ocwlowerid{other}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{sort\_out\_u}~\ocwlowerid{accu}~\ocwlowerid{form}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~(\ocwlowerid{\_},\ocwlowerid{morphs})~]~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{fold\_left}~(\ocwlowerid{reorg}~\ocwlowerid{form})~\ocwlowerid{accu}~\ocwlowerid{morphs}$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{where}~\ocwlowerid{reorg}~\ocwlowerid{f}~(\ocwlowerid{inf},\ocwlowerid{absya},\ocwlowerid{per},\ocwlowerid{abstva})~=~$\ocwkw{fun}\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Ind\_verb}~(\ocwlowerid{c},\ocwupperid{Infi})~$\ocwkw{when}~$\ocwlowerid{c}=\ocwlowerid{conj}~\rightarrow{}~([~(\ocwlowerid{c},\ocwlowerid{f})~::~\ocwlowerid{inf}~],\ocwlowerid{absya},\ocwlowerid{per},\ocwlowerid{abstva})~$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Ind\_verb}~(\ocwlowerid{c},\ocwupperid{Absoya})~$\ocwkw{when}~$\ocwlowerid{c}=\ocwlowerid{conj}~\rightarrow{}~(\ocwlowerid{inf},[~(\ocwlowerid{c},\ocwlowerid{f})~::~\ocwlowerid{absya}~],\ocwlowerid{per},\ocwlowerid{abstva})~$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Ind\_verb}~(\ocwlowerid{c},\ocwupperid{Perpft})~$\ocwkw{when}~$\ocwlowerid{c}=\ocwlowerid{conj}~\rightarrow{}~(\ocwlowerid{inf},\ocwlowerid{absya},[~(\ocwlowerid{c},\ocwlowerid{f})~::~\ocwlowerid{per}~],\ocwlowerid{abstva})~$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Abs\_root}~\ocwlowerid{c}~$\ocwkw{when}~$\ocwlowerid{c}=\ocwlowerid{conj}~\rightarrow{}~(\ocwlowerid{inf},\ocwlowerid{absya},\ocwlowerid{per},[~(\ocwlowerid{c},\ocwlowerid{f})~::~\ocwlowerid{abstva}~])~$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~(\ocwlowerid{inf},\ocwlowerid{absya},\ocwlowerid{per},\ocwlowerid{abstva})$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Fatal}~$\ocwstring{"Weird\ocwvspace{}inverse\ocwvspace{}map\ocwvspace{}N"}$)$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{init\_u}~=~([\,],[\,],[\,],[\,])$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{buckets}~=~\ocwupperid{Deco.}\ocwlowerid{fold}~\ocwlowerid{sort\_out\_v}~\ocwlowerid{init\_v}~\ocwlowerid{roots.}\ocwlowerid{val}~$\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\ocwbc{} Main \ocwbegindcode{}$\ocwlowerid{print\_conjug}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{display\_conjug}~\ocwlowerid{font}~\ocwlowerid{conj}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{display\_inflected\_v}~\ocwlowerid{font}~\ocwlowerid{buckets}~$\ocwbc{} Display finite root forms \ocwec{}\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_paragraph}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_begin}~$\ocwbc{} Now display participial root forms \ocwec{}\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{table\_begin\_style}~(\ocwlowerid{centered}~\ocwupperid{Mauve})~[\,])$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}~$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}~$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{participles\_caption}~\ocwlowerid{font})$\ocweol
\ocwindent{3.00em}
;~\ocwkw{let}~$\ocwlowerid{rest}~=~\ocwlowerid{process\_pp}~\ocwlowerid{parts}~$\ocwkw{in}~\ocwbc{} Past Passive \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{rest}~=~\ocwlowerid{process\_ppa}~\ocwlowerid{rest}~$\ocwkw{in}~\ocwbc{} Past Active \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{rest}~=~\ocwlowerid{process\_pra}~\ocwlowerid{rest}~$\ocwkw{in}~\ocwbc{} Present Active \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{rest}~=~\ocwlowerid{process\_prm}~\ocwlowerid{rest}~$\ocwkw{in}~\ocwbc{} Present Middle \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{rest}~=~\ocwlowerid{process\_prp}~\ocwlowerid{rest}~$\ocwkw{in}~\ocwbc{} Present Passive \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{rest}~=~\ocwlowerid{process\_futa}~\ocwlowerid{rest}~$\ocwkw{in}~\ocwbc{} Future Active \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{rest}~=~\ocwlowerid{process\_futm}~\ocwlowerid{rest}~$\ocwkw{in}~\ocwbc{} Future Middle \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{rest}~=~\ocwlowerid{process\_pfp}~\ocwlowerid{rest}~$\ocwkw{in}~\ocwbc{} Future Passive = gerundive \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{rest}~=~\ocwlowerid{process\_pfta}~\ocwlowerid{rest}~$\ocwkw{in}~\ocwbc{} Perfect Active \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{\_}~=~\ocwlowerid{process\_pftm}~\ocwlowerid{rest}~$\ocwkw{in}~\ocwbc{} Perfect Middle \ocwec{}~\ocwkw{do}\ocweol
\ocwindent{5.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{th\_end}~$\ocweol
\ocwindent{5.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}~$\ocweol
\ocwindent{5.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{table\_end}~$\ocwbc{} Mauve \ocwec{}\ocweol
\ocwindent{5.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_end}$\ocweol
\ocwindent{5.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_paragraph}~$\ocwbc{} Now display indeclinable root forms if any \ocwec{}\ocweol
\ocwindent{5.00em}
;~\ocwkw{let}~$(\ocwlowerid{inf},\ocwlowerid{\_},\ocwlowerid{\_},\ocwlowerid{\_})~=~\ocwupperid{Deco.}\ocwlowerid{fold}~\ocwlowerid{sort\_out\_u}~\ocwlowerid{init\_u}~\ocwlowerid{indecls.}\ocwlowerid{val}~$\ocweol
\ocwindent{6.00em}
\ocwkw{and}~$(\ocwlowerid{\_},\ocwlowerid{absya},\ocwlowerid{\_},\ocwlowerid{\_})~=~\ocwupperid{Deco.}\ocwlowerid{fold}~\ocwlowerid{sort\_out\_u}~\ocwlowerid{init\_u}~\ocwlowerid{absya.}\ocwlowerid{val}$\ocweol
\ocwindent{6.00em}
\ocwkw{and}~$(\ocwlowerid{\_},\ocwlowerid{\_},\ocwlowerid{per},\ocwlowerid{\_})~=~\ocwupperid{Deco.}\ocwlowerid{fold}~\ocwlowerid{sort\_out\_u}~\ocwlowerid{init\_u}~\ocwlowerid{peri.}\ocwlowerid{val}$\ocweol
\ocwindent{6.00em}
\ocwkw{and}~$(\ocwlowerid{\_},\ocwlowerid{\_},\ocwlowerid{\_},\ocwlowerid{abstvaa})~=~\ocwupperid{Deco.}\ocwlowerid{fold}~\ocwlowerid{sort\_out\_u}~\ocwlowerid{init\_u}~\ocwlowerid{abstvaa.}\ocwlowerid{val}~$\ocwkw{in}\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{absya}=[\,]~\land{}~\ocwlowerid{per}=[\,]~\land{}~\ocwlowerid{abstvaa}=[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{6.00em}
\ocwbc{} Display indeclinable forms \ocwec{}\ocweol
\ocwindent{6.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{center\_begin}~$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{table\_begin\_style}~(\ocwlowerid{centered}~\ocwupperid{Mauve})~[\,])$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{indeclinables\_caption}~\ocwlowerid{font})$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{display\_inflected\_u}~\ocwlowerid{font}~\ocwlowerid{inf}~\ocwlowerid{absya}~\ocwlowerid{per}~\ocwlowerid{abstvaa}~$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}$\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{table\_end}~$\ocwbc{} Mauve \ocwec{}\ocweol
\ocwindent{6.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_end}$\ocweol
\ocwindent{6.00em}
\}\ocweol
\ocwindent{5.00em}
\}~\ocweol
\ocwindent{2.50em}
\}~\ocwbc{} end \ocwbegindcode{}$\ocwlowerid{print\_conjug}$\ocwenddcode{} \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{compute\_conjugs}~=~\ocwupperid{List.}\ocwlowerid{iter}~(\ocwupperid{Verbs.}\ocwlowerid{compute\_conjugs\_stems}~\ocwlowerid{entry})~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{secondary\_conjugs}~\ocwlowerid{infos}~=$\ocweol
\ocwindent{6.00em}
\ocwkw{let}~$\ocwlowerid{cau\_filter}~=~$\ocwkw{fun}~$[~(\ocwupperid{Causa}~\ocwlowerid{\_},\ocwlowerid{\_})~\rightarrow{}~\ocwupperid{True}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{int\_filter}~=~$\ocwkw{fun}~$[~(\ocwupperid{Inten}~\ocwlowerid{\_},\ocwlowerid{\_})~\rightarrow{}~\ocwupperid{True}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{des\_filter}~=~$\ocwkw{fun}~$[~(\ocwupperid{Desid}~\ocwlowerid{\_},\ocwlowerid{\_})~\rightarrow{}~\ocwupperid{True}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~\ocwkw{let}~$\ocwlowerid{causatives}~=~\ocwupperid{List.}\ocwlowerid{filter}~\ocwlowerid{cau\_filter}~\ocwlowerid{infos}~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{causatives}~=~[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}~\ocweol
\ocwindent{5.00em}
\{~$\ocwlowerid{roots.}\ocwlowerid{val}~:=~\ocwupperid{Deco.}\ocwlowerid{empty}~$\ocweol
\ocwindent{5.00em}
;~$\ocwlowerid{compute\_conjugs}~\ocwlowerid{causatives}$\ocweol
\ocwindent{5.00em}
;~$\ocwlowerid{print\_conjug}~\ocwupperid{Causative}~\ocwupperid{Parts.participles.}\ocwlowerid{val}$\ocweol
\ocwindent{5.00em}
\}~\ocweol
\ocwindent{3.00em}
;~\ocwkw{let}~$\ocwlowerid{intensives}~=~\ocwupperid{List.}\ocwlowerid{filter}~\ocwlowerid{int\_filter}~\ocwlowerid{infos}~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{intensives}~=~[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{5.00em}
\{~$\ocwlowerid{roots.}\ocwlowerid{val}~:=~\ocwupperid{Deco.}\ocwlowerid{empty}~$\ocweol
\ocwindent{5.00em}
;~$\ocwlowerid{compute\_conjugs}~\ocwlowerid{intensives}$\ocweol
\ocwindent{5.00em}
;~$\ocwlowerid{print\_conjug}~\ocwupperid{Intensive}~\ocwupperid{Parts.participles.}\ocwlowerid{val}~$\ocweol
\ocwindent{5.00em}
\}~\ocweol
\ocwindent{3.00em}
;~\ocwkw{let}~$\ocwlowerid{desideratives}~=~\ocwupperid{List.}\ocwlowerid{filter}~\ocwlowerid{des\_filter}~\ocwlowerid{infos}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{desideratives}~=~[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{5.00em}
\{~$\ocwlowerid{roots.}\ocwlowerid{val}~:=~\ocwupperid{Deco.}\ocwlowerid{empty}~$\ocweol
\ocwindent{5.00em}
;~$\ocwlowerid{compute\_conjugs}~\ocwlowerid{desideratives}$\ocweol
\ocwindent{5.00em}
;~$\ocwlowerid{print\_conjug}~\ocwupperid{Desiderative}~\ocwupperid{Parts.participles.}\ocwlowerid{val}$\ocweol
\ocwindent{5.00em}
\}~\ocweol
\ocwindent{3.00em}
\}~\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{1.50em}
\ocwbc{} Main \ocwbegindcode{}$\ocwlowerid{look\_up\_and\_display}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.50em}
\{~$\ocwupperid{Verbs.}\ocwlowerid{fake\_compute\_conjugs}~\ocwlowerid{gana}~\ocwlowerid{entry}~$\ocwbc{} builds temporaries roots.val etc \ocwec{}\ocweol
\ocwindent{1.50em}
;~\ocwkw{let}~$\ocwlowerid{infos}~=~$\ocwbc{} should be a call to a service that gives one \ocwbegindcode{}$\ocwlowerid{entry\_infos}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.50em}
$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwlowerid{public\_roots\_infos\_file}~:~\ocwupperid{Deco.}\ocwlowerid{deco}~\ocwlowerid{root\_infos})~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{entry\_infos}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~(\ocwupperid{Encode.}\ocwlowerid{code\_string}~\ocwlowerid{entry})~\ocwlowerid{infos}~$\ocwkw{in}~\ocweol
\ocwindent{2.50em}
\ocwkw{if}~$\ocwlowerid{gana}~=~0~$\ocwkw{then}~$\ocwlowerid{secondary\_conjugs}~\ocwlowerid{entry\_infos}~$\ocweol
\ocwindent{2.50em}
\ocwkw{else}~$\ocwlowerid{print\_conjug}~\ocwupperid{Primary}~\ocwupperid{Parts.participles.}\ocwlowerid{val}~$\ocweol
\ocwindent{1.50em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{in\_lexicon}~\ocwlowerid{entry}~=~$\ocwbc{} entry as a string in VH transliteration \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwupperid{Index.}\ocwlowerid{is\_in\_lexicon}~(\ocwupperid{Encode.}\ocwlowerid{code\_string}~\ocwlowerid{entry})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{doubt}~\ocwlowerid{s}~=~$\ocwstring{"?"}~\^{}~$\ocwlowerid{s}$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwbc{} Compute homonym index for a given present class. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} This is very fragile: lexicon update induces code adaptation. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Temporary - should be subsumed by unique naming structure. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{resolve\_homonym}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{first}~\ocwlowerid{e}~=~\ocwlowerid{e}~$\^{}~\ocwstring{"\#1"}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{second}~\ocwlowerid{e}~=~\ocwlowerid{e}~$\^{}~\ocwstring{"\#2"}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{third}~\ocwlowerid{e}~=~\ocwlowerid{e}~$\^{}~\ocwstring{"\#3"}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{fourth}~\ocwlowerid{e}~=~\ocwlowerid{e}~$\^{}~\ocwstring{"\#4"}~\ocwkw{in}~\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~1~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{".rc"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"krudh"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"cit"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"chad"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"tyaj"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"tvi.s"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"dah"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"daa"}~\ocwbc{} ambiguous with \ocwbegindcode{}\ocwstring{"daa\#3"}\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"diz"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"d.rz"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"dyut"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"dru"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"dhaa"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"dhaav"}~\ocwbc{} ambiguous with \ocwbegindcode{}\ocwstring{"dhaav\#2"}\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"nii"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"pat"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"paa"}~\ocwbc{} ambiguous with \ocwbegindcode{}\ocwstring{"paa\#2"}\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"budh"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"b.rh"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"bhuu"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"m.rd"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"mud"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"yaj"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"yat"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"raaj"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"ruc"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"rud"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"rudh"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vas"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vah"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"v.r"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"v.rdh"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vi.s"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zii"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zuc"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zubh"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zcut"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"sad"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"sah"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"suu"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"sthaa"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"snih"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"spaz"}~\ocwbc{} no present \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"h.r"}~$\rightarrow{}~\ocwlowerid{first}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"gaa"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"yu"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vap"}~\ocwbc{} ambiguous with \ocwbegindcode{}$\ocwlowerid{vap}\#1$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"sidh"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"svid"}~$\rightarrow{}~\ocwlowerid{second}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"maa"}~$\rightarrow{}~\ocwlowerid{fourth}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"arc"}~$\rightarrow{}~$\ocwstring{".rc\#1"}~\ocwbc{} link - bizarre \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~2~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"ad"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"as"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"iiz"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"duh"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"draa"}~\ocwbc{} ambiguous with \ocwbegindcode{}\ocwstring{"draa\#2"}\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"dvi.s"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"praa"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"praa.n"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"bhaa"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"maa"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"yaa"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"yu"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"raa"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"rud"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"lih"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vid"}~\ocwbc{} ambiguous with \ocwbegindcode{}\ocwstring{"vid\#2"}\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vii"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zii"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zvas"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"suu"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"han"}~$\rightarrow{}~\ocwlowerid{first}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"an"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"aas"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"daa"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"paa"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vas"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vaa"}~$\rightarrow{}~\ocwlowerid{second}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"nii"}~$\rightarrow{}~\ocwlowerid{third}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~3~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"gaa"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"daa"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"dhaa"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"p.r"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"bhii"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"maa"}~\ocwbc{} ambiguous with \ocwbegindcode{}\ocwstring{"maa\#3"}\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vi.s"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"haa"}~$\rightarrow{}~\ocwlowerid{first}~\ocwlowerid{entry}~$\ocwbc{} ambiguous with \ocwbegindcode{}\ocwstring{"haa\#2"}\ocwenddcode{} used in middle \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"yu"}~$\rightarrow{}~\ocwlowerid{second}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~4~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"k.sudh"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"dam"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"d.rz"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"druh"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"dhii"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"naz"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"pu.s"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"budh"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"mad"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"saa"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"sidh"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"snih"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"snuh"}~$\rightarrow{}~\ocwlowerid{first}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"as"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"i.s"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"tan"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"daa"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"draa"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"dhaa"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"pat"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"zam"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"svid"}~$\rightarrow{}~\ocwlowerid{second}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vaa"}~$\rightarrow{}~\ocwlowerid{third}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~5~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"az"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"k.r"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"dhuu"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"v.r"}~$\rightarrow{}~\ocwlowerid{first}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"su"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"hi"}~$\rightarrow{}~\ocwlowerid{second}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~6~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"i.s"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"k.rt"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"g.rr"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"tud"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"diz"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"d.r"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"pi"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"bhuj"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"muc"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"yu"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"rud"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"viz"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"suu"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"s.rj"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"sp.rz"}~\ocweol
\ocwindent{3.00em}
$\rightarrow{}~\ocwlowerid{first}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"p.r"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"b.rh"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"rudh"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vid"}~\ocwbc{} ambiguous with \ocwbegindcode{}\ocwstring{"vid\#1"}\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{3.00em}
$\rightarrow{}~\ocwlowerid{second}~\ocwlowerid{entry}~$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"vas"}~$\rightarrow{}~\ocwlowerid{fourth}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~7~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"chid"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"bhid"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"yuj"}~$\rightarrow{}~\ocwlowerid{first}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"bhuj"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"rudh"}~$\rightarrow{}~\ocwlowerid{second}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~8~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"k.r"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"tan"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"san"}~$\rightarrow{}~\ocwlowerid{first}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~9~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"az"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"g.rr"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"j\~{}naa"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"jyaa"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"puu"}\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"m.rd"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"luu"}~$\rightarrow{}~\ocwlowerid{first}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"v.r"}~\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"h.r"}~$\rightarrow{}~\ocwlowerid{second}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$]~$\ocweol
\ocwindent{1.00em}
$\mid{}~10~\rightarrow{}~\ocwlowerid{entry}$\ocweol
\ocwindent{1.00em}
$\mid{}~11~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"mahii"}~$\rightarrow{}~\ocwlowerid{second}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{entry}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.50em}
$\mid{}~0~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{in\_lexicon}~\ocwlowerid{entry}~$\ocwbc{} ad-hoc disambiguation for secondary conjugs \ocwec{}\ocweol
\ocwindent{6.50em}
\ocwkw{then}~$\ocwlowerid{entry}$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{let}~$\ocwlowerid{fentry}~=~\ocwlowerid{first}~\ocwlowerid{entry}~$\ocwkw{in}~\ocweol
\ocwindent{7.50em}
\ocwkw{if}~$\ocwlowerid{in\_lexicon}~\ocwlowerid{fentry}~$\ocwkw{then}~$\ocwlowerid{fentry}~$\ocwkw{else}~$\ocwlowerid{raise}~(\ocwupperid{Wrong}~\ocwlowerid{entry})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{conjs\_engine}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{http\_header}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_begin}~\ocwlowerid{meta\_title}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{body\_begin}~\ocwlowerid{back\_ground})$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{query}~=~\ocwupperid{Sys.}\ocwlowerid{getenv}~$\ocwstring{"QUERY\_STRING"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{env}~=~\ocwlowerid{create\_env}~\ocwlowerid{query}~$\ocwkw{in}\ocweol
\ocwindent{1.50em}
\ocwkw{try}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{url\_encoded\_entry}~=~\ocwupperid{List.}\ocwlowerid{assoc}~$\ocwstring{"q"}~$\ocwlowerid{env}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_class}~=~\ocwupperid{List.}\ocwlowerid{assoc}~$\ocwstring{"c"}~$\ocwlowerid{env}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{font}~=~\ocwlowerid{font\_of\_string}~(\ocwlowerid{get}~$\ocwstring{"font"}~$\ocwlowerid{env}~\ocwupperid{Paths.}\ocwlowerid{default\_display\_font})$\ocweol
\ocwindent{2.00em}
\ocwbc{} OBS and stamp = get \ocwstring{"v"} env \ocwstring{""} \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{translit}~=~\ocwlowerid{get}~$\ocwstring{"t"}~$\ocwlowerid{env}~$\ocwstring{"VH"}~\ocwbc{} DICO created in VH trans \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{lex}~=~\ocwlowerid{get}~$\ocwstring{"lex"}~$\ocwlowerid{env}~$\ocwstring{"SH"}~\ocwbc{} default Heritage \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{entry\_tr}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_entry}~$\ocwbc{} : string in translit \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{lang}~=~\ocwlowerid{language\_of}~\ocwlowerid{lex}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{gana}~=~$\ocwkw{match}~$\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_class}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~$\ocwstring{"1"}~$\rightarrow{}~1~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"2"}~$\rightarrow{}~2$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"3"}~$\rightarrow{}~3$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"4"}~$\rightarrow{}~4$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"5"}~$\rightarrow{}~5$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"6"}~$\rightarrow{}~6$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"7"}~$\rightarrow{}~7$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"8"}~$\rightarrow{}~8$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"9"}~$\rightarrow{}~9$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"10"}~$\rightarrow{}~10$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"11"}~$\rightarrow{}~11~$\ocwbc{} denominative verbs \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"0"}~$\rightarrow{}~0~$\ocwbc{} secondary conjugations \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Fatal}~($\ocwstring{"Weird\ocwvspace{}present\ocwvspace{}class:\ocwvspace{}"}~\^{}~$\ocwlowerid{s}))~$\ocweol
\ocwindent{3.00em}
$]~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{encoding\_function}~=~\ocwupperid{Encode.}\ocwlowerid{switch\_code}~\ocwlowerid{translit}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$()~=~\ocwlowerid{toggle\_lexicon}~\ocwlowerid{lex}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{word}~=~\ocwlowerid{encoding\_function}~\ocwlowerid{entry\_tr}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{entry\_VH}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{word}~$\ocwkw{in}~\ocwbc{} ugly detour via VH string \ocwec{}~\ocweol
\ocwindent{4.00em}
\ocwbc{} Beware - 46 decodes as \ocwstring{"z"} and 21 as \ocwstring{"f"} \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{entry}~=~\ocwlowerid{resolve\_homonym}~\ocwlowerid{entry\_VH}~\ocwlowerid{gana}~$\ocwkw{in}~\ocwbc{} VH string with homo \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{known}~=~\ocwlowerid{in\_lexicon}~\ocwlowerid{entry}~$\ocwbc{} in lexicon? \ocwec{}~\ocweol
\ocwindent{5.00em}
\ocwbc{} we should check it is indeed a root or denominative \ocwec{}~\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{display\_title}~\ocwlowerid{font}~$\ocweol
\ocwindent{4.00em}
;~\ocwkw{let}~$\ocwlowerid{link}~=~$\ocwkw{if}~$\ocwlowerid{known}~$\ocwkw{then}~$\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_anchor}~\ocwupperid{False}~\ocwlowerid{font}~\ocwlowerid{entry}~$\ocweol
\ocwindent{10.50em}
\ocwkw{else}~$\ocwlowerid{doubt}~(\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_roma}~\ocwlowerid{entry})~$\ocwkw{in}~\ocweol
\ocwindent{5.00em}
\ocwkw{let}~$\ocwlowerid{subtitle}~=~\ocwlowerid{hyperlink\_title}~\ocwlowerid{font}~\ocwlowerid{link}~$\ocwkw{in}\ocweol
\ocwindent{5.00em}
$\ocwlowerid{display\_subtitle}~(\ocwlowerid{h1\_center}~\ocwlowerid{subtitle})$\ocweol
\ocwindent{4.00em}
;~\ocwkw{try}~$\ocwlowerid{look\_up\_and\_display}~\ocwlowerid{font}~\ocwlowerid{gana}~\ocwlowerid{entry}~$\ocweol
\ocwindent{5.00em}
\ocwkw{with}~$[~\ocwupperid{Stream.Error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Wrong}~\ocwlowerid{s})~]$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{page\_end}~\ocwlowerid{lang}~\ocwupperid{True}$\ocweol
\ocwindent{4.00em}
\}~\ocweol
\ocwindent{2.00em}
\ocwkw{with}~$[~\ocwupperid{Stream.Error}~\ocwlowerid{\_}~\rightarrow{}~$\ocweol
\ocwindent{6.50em}
$\ocwlowerid{abort}~\ocwlowerid{lang}~($\ocwstring{"Illegal\ocwvspace{}"}~\^{}~$\ocwlowerid{translit}~$\^{}~\ocwstring{"\ocwvspace{}transliteration\ocwvspace{}"}$)~\ocwlowerid{entry\_tr}~]$\ocweol
\ocwindent{1.50em}
\ocwkw{with}~$[~\ocwupperid{Not\_found}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"parameters\ocwvspace{}q\ocwvspace{}or\ocwvspace{}c\ocwvspace{}missing"}~$]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{safe\_engine}~()~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{abor}~=~\ocwlowerid{abort}~\ocwlowerid{default\_language}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwlowerid{conjs\_engine}~()~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Sys\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{sys\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Stream.Error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{stream\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Invalid\_argument}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} sub \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Wrong}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Error\ocwvspace{}\symbol{45}\ocwvspace{}wrong\ocwvspace{}root\ocwvspace{}or\ocwvspace{}class\ocwvspace{}?\ocwvspace{}\symbol{45}\ocwvspace{}"}~$\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Failure}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Wrong\_input\ocwvspace{}?\ocwvspace{}"}~$\ocwlowerid{s}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Control.Fatal}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Not\_found}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"assoc"}~\ocwbc{} assoc \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Control.Anomaly}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~($\ocwstring{"Anomaly:\ocwvspace{}"}~\^{}~$\ocwlowerid{s})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{End\_of\_file}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"EOF"}~\ocwbc{} EOF \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Encode.In\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Wrong\_input\ocwvspace{}"}~$\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Exit}~$\ocwbc{} Sanskrit \ocwec{}~$\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Wrong\ocwvspace{}character\ocwvspace{}in\ocwvspace{}input\ocwvspace{}\symbol{45}\ocwvspace{}"}~\ocwstring{"use\ocwvspace{}ASCII"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"anomaly"}~\ocwbc{} ? \ocwec{}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{safe\_engine}~()~$\ocwbc{} Should always produce a legal xhtml page \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Indexer.ml}
\ocwmodule{Indexer}
\label{indexer.ml:0}%
CGI-bin indexer for indexing in sanskrit dictionary.                   
\ocweol
\ocwindent{0.00em}
This CGI is triggered by page \ocwbegindcode{}$\ocwlowerid{index}.\ocwlowerid{html}$\ocwenddcode{} in \ocwbegindcode{}$\ocwlowerid{dico\_dir}$\ocwenddcode{}.              
\ocweol
\ocwindent{0.00em}
Reads its input in shell variable \ocwbegindcode{}$\ocwupperid{QUERY\_STRING}$\ocwenddcode{} URI-encoded.          
\ocweol
\label{indexer.ml:1038}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};~$\ocwbc{} abort \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps pl etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Cgi};$\medskip

\label{indexer.ml:1099}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{answer\_begin}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{table\_begin}~\ocwupperid{Yellow\_cent})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{answer\_end}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{th\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{table\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_paragraph}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ok}~(\ocwlowerid{mess},\ocwlowerid{s})~=~$\ocwkw{do}~\{~$\ocwlowerid{ps}~\ocwlowerid{mess};~\ocwlowerid{pl}~(\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_anchor\_R}~\ocwupperid{False}~\ocwlowerid{s})~\}$\ocweol
\ocwindent{0.50em}
\ocwkw{and}~$\ocwlowerid{ok2}~(\ocwlowerid{mess},\ocwlowerid{s1},\ocwlowerid{s2})~=~$\ocwkw{do}~\{~$\ocwlowerid{ps}~\ocwlowerid{mess};~\ocwlowerid{pl}~(\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_anchor\_R2}~\ocwlowerid{s1}~\ocwlowerid{s2})~\}$\ocweol
\ocwindent{2.50em}
\ocwbc{} ok2 prints the entry under the spelling given by the user, i.e. without 
        normalisation, thus e.g. sandhi is not written sa.mdhi, and possibly 
        suffixed by homonymy index 1, e.g. b.rh. \ocwec{}\ocweol
\ocwindent{1.50em}
;\ocweol
\ocwindent{1.50em}
\ocwbc{} Should share \ocwbegindcode{}$\ocwupperid{Lemmatizer}.\ocwlowerid{load\_inflected}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{load\_inflected}~\ocwlowerid{file}~=~(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwlowerid{file}~:~\ocwupperid{Morphology.}\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{load\_nouns}~()~=~\ocwlowerid{load\_inflected}~\ocwlowerid{public\_nouns\_file}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{load\_roots}~()~=~\ocwlowerid{load\_inflected}~\ocwlowerid{public\_roots\_file}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{load\_vocas}~()~=~\ocwlowerid{load\_inflected}~\ocwlowerid{public\_vocas\_file}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{load\_indecls}~()~=~\ocwlowerid{load\_inflected}~\ocwlowerid{public\_inde\_file}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{load\_parts}~()~=~\ocwlowerid{load\_inflected}~\ocwlowerid{public\_parts\_file}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{back\_ground}~=~\ocwlowerid{background}~\ocwupperid{Chamois}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display}~\ocwlowerid{word}~\ocwlowerid{l}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}found\ocwvspace{}as\ocwvspace{}inflected\ocwvspace{}form:"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{pi}~\ocwlowerid{inv}~=~\ocwupperid{Morpho\_html.}\ocwlowerid{print\_inflected}~\ocwupperid{False}~\ocwlowerid{word}~\ocwlowerid{inv}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{pi}~\ocwlowerid{l}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{report\_failure}~\ocwlowerid{s}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}not\ocwvspace{}found\ocwvspace{}in\ocwvspace{}dictionary"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"Closest\ocwvspace{}entry\ocwvspace{}in\ocwvspace{}lexical\ocwvspace{}order:\ocwvspace{}"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_anchor\_R}~\ocwupperid{False}~\ocwlowerid{s})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{1.50em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{try\_declensions}~\ocwlowerid{word}~\ocwlowerid{before}~=~$\ocweol
\ocwindent{1.00em}
\ocwbc{} before is last lexical item before word in lexical order \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} This is costly because of the size of inverted inflected databases \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{inflectedn}~=~\ocwlowerid{load\_nouns}~()~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{word}~\ocwlowerid{inflectedn}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~$\ocwbc{} Not found; we try vocative forms \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{inflectedv}~=~\ocwlowerid{load\_vocas}~()~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{word}~\ocwlowerid{inflectedv}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~$\ocwbc{} Not found; we try root forms \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{inflectedr}~=~\ocwlowerid{load\_roots}~()~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{word}~\ocwlowerid{inflectedr}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~$\ocwbc{} Not found; we try adverbial forms \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{inflecteda}~=~\ocwlowerid{load\_indecls}~()~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{word}~\ocwlowerid{inflecteda}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{report\_failure}~\ocwlowerid{before}$\ocweol
\ocwindent{2.00em}
\ocwbc{} NB - no look-up in parts forms since big and partly lexicalized \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{l}~\rightarrow{}~\ocwlowerid{display}~\ocwlowerid{word}~\ocwlowerid{l}$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{l}~\rightarrow{}~\ocwlowerid{display}~\ocwlowerid{word}~\ocwlowerid{l}$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{l}~\rightarrow{}~\ocwlowerid{display}~\ocwlowerid{word}~\ocwlowerid{l}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{l}~\rightarrow{}~\ocwlowerid{display}~\ocwlowerid{word}~\ocwlowerid{l}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_word\_unique}~\ocwlowerid{word}~(\ocwlowerid{entry},\ocwlowerid{lex},\ocwlowerid{page})~=~$\ocwbc{} lex=\ocwstring{"other"} allowed \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{link}~=~\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_anchor\_M}~\ocwlowerid{word}~\ocwlowerid{entry}~\ocwlowerid{page}~\ocwupperid{False}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{pl}~(\ocwlowerid{link}~$\^{}~\ocwstring{"\ocwvspace{}[\ocwvspace{}"}~\^{}~$\ocwlowerid{lex}~$\^{}~\ocwstring{"\ocwvspace{}]"}~\^{}~$\ocwlowerid{xml\_empty}~$\ocwstring{"br"}$)$\ocweol
\ocwindent{1.00em}
\ocwbc{} this allows access to a pseudo-entry such as \ocwstring{"hvaaya"} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_word}~\ocwlowerid{word}~(\ocwlowerid{entry},\ocwlowerid{lex},\ocwlowerid{page})~=~$\ocwkw{match}~$\ocwlowerid{lex}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"other"}~$\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{print\_word\_unique}~\ocwlowerid{word}~(\ocwlowerid{entry},\ocwlowerid{lex},\ocwlowerid{page})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{read\_mw\_index}~()~=~$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwlowerid{public\_mw\_index\_file}~:~\ocwupperid{Deco.}\ocwlowerid{deco}~($\ocwbt{string}~$\times{}~$\ocwbt{string}~$\times{}~$\ocwbt{string}$))~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{index\_engine}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{http\_header}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_begin}~\ocwlowerid{heritage\_dictionary\_title}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{body\_begin}~\ocwlowerid{back\_ground})$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{query}~=~\ocwupperid{Sys.}\ocwlowerid{getenv}~$\ocwstring{"QUERY\_STRING"}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{env}~=~\ocwlowerid{create\_env}~\ocwlowerid{query}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{translit}~=~\ocwlowerid{get}~$\ocwstring{"t"}~$\ocwlowerid{env}~\ocwupperid{Paths.}\ocwlowerid{default\_transliteration}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{lex}~=~\ocwlowerid{get}~$\ocwstring{"lex"}~$\ocwlowerid{env}~\ocwupperid{Paths.}\ocwlowerid{default\_lexicon}~$\ocwbc{} default by config \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_entry}~=~\ocwlowerid{get}~$\ocwstring{"q"}~$\ocwlowerid{env}~$\ocwstring{""}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{lang}~=~\ocwlowerid{language\_of}~\ocwlowerid{lex}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{print\_title\_solid}~\ocwupperid{Mauve}~(\ocwupperid{Some}~\ocwlowerid{lang})~(\ocwlowerid{dico\_title}~\ocwlowerid{lang})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{answer\_begin}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{div\_begin}~\ocwupperid{Latin12})$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{str}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_entry}~$\ocwbc{} in translit \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{encode}~=~\ocwupperid{Encode.}\ocwlowerid{switch\_code}~\ocwlowerid{translit}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$()~=~\ocwlowerid{toggle\_lexicon}~\ocwlowerid{lex}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{word}~=~\ocwlowerid{encode}~\ocwlowerid{str}~$\ocwbc{} normalization \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{str\_VH}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{word}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~\ocwkw{match}~$\ocwlowerid{lex}~$\ocwkw{with}~\ocweol
\ocwindent{5.00em}
$[~$\ocwstring{"MW"}~$\rightarrow{}~$\ocweol
\ocwindent{6.00em}
\ocwkw{let}~$\ocwlowerid{mw\_index}~=~\ocwlowerid{read\_mw\_index}~()~$\ocwkw{in}~\ocweol
\ocwindent{6.00em}
\ocwkw{let}~$\ocwlowerid{words}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{word}~\ocwlowerid{mw\_index}~$\ocwkw{in}\ocweol
\ocwindent{6.00em}
\ocwkw{match}~$\ocwlowerid{words}~$\ocwkw{with}\ocweol
\ocwindent{7.00em}
$[~[\,]~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{ps}~(\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_red}~\ocwlowerid{str\_VH})$\ocweol
\ocwindent{12.50em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}not\ocwvspace{}found\ocwvspace{}in\ocwvspace{}MW\ocwvspace{}dictionary"}\ocweol
\ocwindent{12.50em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{12.50em}
\}\ocweol
\ocwindent{7.00em}
$\mid{}~[~\ocwlowerid{unique}~]~\rightarrow{}~\ocwlowerid{print\_word\_unique}~\ocwlowerid{str\_VH}~\ocwlowerid{unique}$\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{iter}~(\ocwlowerid{print\_word}~\ocwlowerid{str\_VH})~(\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{words})~$\ocweol
\ocwindent{7.00em}
$]~$\ocweol
\ocwindent{5.00em}
$\mid{}~$\ocwstring{"SH"}~$\rightarrow{}~$\ocwkw{do}~\ocwbc{} richer search engine \ocwec{}\ocweol
\ocwindent{6.00em}
\{~\ocwkw{let}~$\ocwlowerid{sh\_index}~=~\ocwupperid{Index.}\ocwlowerid{read\_entries}~()~$\ocwkw{in}~\ocweol
\ocwindent{7.00em}
\ocwkw{try}~\ocwkw{let}~$(\ocwlowerid{s},\ocwlowerid{b},\ocwlowerid{h})~=~\ocwupperid{Index.}\ocwlowerid{search}~\ocwlowerid{word}~\ocwlowerid{sh\_index}~$\ocwkw{in}~\ocweol
\ocwindent{9.00em}
\ocwkw{if}~$\ocwlowerid{b}~\lor{}~\ocwlowerid{h}~$\ocwkw{then}~\ocweol
\ocwindent{10.50em}
\ocwkw{let}~$\ocwlowerid{r}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{word}~$\ocwkw{in}~\ocweol
\ocwindent{10.50em}
\ocwkw{let}~$\ocwlowerid{hr}~=~$\ocwkw{if}~$\ocwlowerid{h}~$\ocwkw{then}~$\ocwlowerid{r}~$\^{}~\ocwstring{"\_1"}~\ocwkw{else}~$\ocwlowerid{r}~$\ocwkw{in}\ocweol
\ocwindent{10.50em}
$\ocwlowerid{ok2}~($\ocwstring{"Entry\ocwvspace{}found:\ocwvspace{}"},$\ocwlowerid{s},\ocwlowerid{hr})$\ocweol
\ocwindent{9.00em}
\ocwkw{else}~$\ocwlowerid{ok}~($\ocwstring{"First\ocwvspace{}matching\ocwvspace{}entry:\ocwvspace{}"},$\ocwlowerid{s})$\ocweol
\ocwindent{10.00em}
\ocwbc{} remark that s may be str with some suffix,   \ocwec{}\ocweol
\ocwindent{10.00em}
\ocwbc{} even though str may exist as inflected form  \ocwec{}\ocweol
\ocwindent{7.00em}
\ocwkw{with}~\ocwbc{} Matching entry not found - we try declensions \ocwec{}\ocweol
\ocwindent{9.00em}
$[~\ocwupperid{Index.Last}~\ocwlowerid{last}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{11.00em}
\{~$\ocwlowerid{ps}~(\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_red}~\ocwlowerid{str\_VH})$\ocweol
\ocwindent{11.00em}
;~$\ocwlowerid{try\_declensions}~\ocwlowerid{word}~\ocwlowerid{last}$\ocweol
\ocwindent{11.00em}
\}\ocweol
\ocwindent{9.00em}
$]$\ocweol
\ocwindent{6.00em}
\}\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unknown\ocwvspace{}lexicon"}\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{div\_end}~$\ocwbc{} Latin12 \ocwec{}\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{answer\_end}~()$\ocweol
\ocwindent{4.00em}
;~$()~$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{page\_end}~\ocwlowerid{lang}~\ocwupperid{True}$\ocweol
\ocwindent{4.00em}
\}~\ocweol
\ocwindent{2.00em}
\ocwkw{with}~$[~\ocwupperid{Stream.Error}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~$\ocwstring{"Illegal\ocwvspace{}transliteration\ocwvspace{}"}~$\ocwlowerid{str}~]$\ocweol
\ocwindent{1.00em}
\}~\ocwbc{} do \ocwec{}\ocweol
\ocwindent{1.00em}
\}~\ocwbc{} do \ocwec{}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{safe\_index\_engine}~()~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{abor}~=~\ocwlowerid{abort}~\ocwupperid{Html.French}~$\ocwbc{} may not preserve the current language \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwlowerid{index\_engine}~()~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Sys\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{sys\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Stream.Error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{stream\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Invalid\_argument}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} sub \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Failure}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Control.Fatal}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Not\_found}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"assoc"}~\ocwbc{} assoc \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{End\_of\_file}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"EOF"}~\ocwbc{} EOF \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Encode.In\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Wrong\_input\ocwvspace{}"}~$\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Exit}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Wrong\ocwvspace{}character\ocwvspace{}in\ocwvspace{}input\ocwvspace{}\symbol{45}\ocwvspace{}"}~\ocwstring{"use\ocwvspace{}ASCII"}~\ocwbc{} Sanskrit \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"Unexpected\ocwvspace{}anomaly"}~\ocwbc{} ? \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} typical invocation is \ocwbegindcode{}$\ocwlowerid{http}://\ocwlowerid{skt\_server\_url}/\ocwlowerid{cgi}-\ocwlowerid{bin}/\ocwlowerid{sktindex}?\ocwlowerid{t}=\ocwupperid{VH}\land{}\ocwlowerid{lex}=\ocwupperid{SH}\land{}\ocwlowerid{q}=\ocwlowerid{input}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{safe\_index\_engine}~()$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Indexerd.ml}
\ocwmodule{Indexerd}
\label{indexerd.ml:0}%
CGI-bin indexerd for indexing in sanskrit dico without diacritics.     
\ocweol
\ocwindent{0.00em}
This CGI is triggered by page \ocwbegindcode{}$\ocwlowerid{index}.\ocwlowerid{html}$\ocwenddcode{} in \ocwbegindcode{}$\ocwlowerid{dico\_dir}$\ocwenddcode{}.              
\ocweol
\ocwindent{0.00em}
Reads its input in shell variable \ocwbegindcode{}$\ocwupperid{QUERY\_STRING}$\ocwenddcode{} URI-encoded.          
\ocweol
\label{indexerd.ml:1040}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps pl etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Cgi};$\medskip

\label{indexerd.ml:1089}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{answer\_begin}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{table\_begin}~\ocwupperid{Yellow\_cent})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{answer\_end}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{th\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{table\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_paragraph}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{back\_ground}~=~\ocwlowerid{background}~\ocwupperid{Chamois}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{prelude}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{http\_header}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_begin}~\ocwlowerid{heritage\_dictionary\_title}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{body\_begin}~\ocwlowerid{back\_ground})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_paragraph}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_title\_solid}~\ocwupperid{Mauve}~(\ocwupperid{Some}~\ocwupperid{Html.French})~\ocwlowerid{dico\_title\_fr}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{postlude}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_end}~\ocwupperid{Html.French}~\ocwupperid{True}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_word}~\ocwlowerid{c}~=~\ocwlowerid{pl}~(\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_anchor\_R}~\ocwupperid{False}~(\ocwupperid{Canon.}\ocwlowerid{decode\_ref}~\ocwlowerid{c}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Each dummy is mapped to a list of words - all the words which
   give back the dummy by normalisation such as removing diacritics \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{read\_dummies}~()~=$\ocweol
\ocwindent{0.50em}
$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwlowerid{public\_dummies\_file}~:~\ocwupperid{Deco.}\ocwlowerid{deco}~\ocwupperid{Word.}\ocwlowerid{word})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{index\_engine}~()~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{abor}~=~\ocwlowerid{abort}~\ocwupperid{Html.French}~$\ocwbc{} may not preserve the current lang \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{dummies\_deco}~=~\ocwlowerid{read\_dummies}~()~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{prelude}~()~$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{answer\_begin}~()$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{ps}~(\ocwlowerid{div\_begin}~\ocwupperid{Latin12})$\ocweol
\ocwindent{2.50em}
;~\ocwkw{let}~$\ocwlowerid{query}~=~\ocwupperid{Sys.}\ocwlowerid{getenv}~$\ocwstring{"QUERY\_STRING"}~\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{alist}~=~\ocwlowerid{create\_env}~\ocwlowerid{query}~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwbc{} We do not assume transliteration, just ordinary roman letters \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwbc{} TODO: adapt to MW search along Indexer \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{url\_encoded\_entry}~=~\ocwupperid{List.}\ocwlowerid{assoc}~$\ocwstring{"q"}~$\ocwlowerid{alist}~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{str}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_entry}~$\ocwkw{in}~\ocweol
\ocwindent{3.50em}
\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{word}~=~\ocwupperid{Encode.}\ocwlowerid{code\_skt\_ref\_d}~\ocwlowerid{str}~$\ocwbc{} normalization \ocwec{}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{5.50em}
\{~\ocwkw{let}~$\ocwlowerid{words}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{word}~\ocwlowerid{dummies\_deco}~$\ocwkw{in}\ocweol
\ocwindent{6.50em}
\ocwkw{match}~$\ocwlowerid{words}~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~[\,]~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{ps}~(\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_red}~\ocwlowerid{str})$\ocweol
\ocwindent{13.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}not\ocwvspace{}found\ocwvspace{}in\ocwvspace{}Heritage\ocwvspace{}dictionary"}\ocweol
\ocwindent{13.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{html\_break};~\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{13.00em}
\}\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{print\_word}~\ocwlowerid{words}$\ocweol
\ocwindent{7.50em}
$]~$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{ps}~\ocwlowerid{div\_end}~$\ocwbc{} Latin12 \ocwec{}\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{answer\_end}~()$\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{postlude}~()$\ocweol
\ocwindent{5.50em}
\}\ocweol
\ocwindent{3.50em}
\ocwkw{with}~$[~\ocwupperid{Stream.Error}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Illegal\ocwvspace{}input\ocwvspace{}"}~$\ocwlowerid{str}~]$\ocweol
\ocwindent{2.50em}
\}\ocweol
\ocwindent{0.50em}
\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Sys\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{sys\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Stream.Error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{stream\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Invalid\_argument}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} sub \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Failure}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Control.Fatal}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Not\_found}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"assoc"}~\ocwbc{} assoc \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{End\_of\_file}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"EOF"}~\ocwbc{} EOF \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Encode.In\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Wrong\_input\ocwvspace{}"}~$\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Exit}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Wrong\ocwvspace{}character\ocwvspace{}in\ocwvspace{}input\ocwvspace{}\symbol{45}\ocwvspace{}"}~\ocwstring{"use\ocwvspace{}ASCII"}~\ocwbc{} Sanskrit \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"Unexpected\ocwvspace{}anomaly"}~\ocwbc{} ? \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{index\_engine}~()$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Phases.ml}
\ocwmodule{Phases}
\label{phases.ml:0}%
\label{phases.ml:620}%
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Phases}~=~$\ocwkw{struct}~\ocweol
\ocwindent{0.00em}
\ocwbc{} Lexical sorts as phases, i.e. states of the modular transducer \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{phase}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Noun}~\mid{}~\ocwupperid{Noun2}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pron}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Root}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inde}~$\ocwbc{} indeclinable forms \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Absv}~$\ocwbc{} vowel-initial abs-tvaa \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Absc}~$\ocwbc{} consonant-initial abs-tvaa \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Abso}~$\ocwbc{} abs in -ya \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Voca}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inv}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iic}~\mid{}~\ocwupperid{Iic2}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiif}~$\ocwbc{} iic of ifc, atteinable from previous iic eg -vartin iic -varti- \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiv}~\mid{}~\ocwupperid{Iivv}~\mid{}~\ocwupperid{Iivc}~$\ocwbc{} inchoatives - cvi verbal compounds \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Auxi}~\mid{}~\ocwupperid{Auxik}~\mid{}~\ocwupperid{Auxiick}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ifc}~\mid{}~\ocwupperid{Ifc2}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Peri}~$\ocwbc{} periphrastic perfect \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Lopa}~$\ocwbc{} e/o conjugated root forms with lopa \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Lopak}~$\ocwbc{} e/o kridantas forms with lopa \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pv}~$\ocwbc{} Preverb optional before Root or Lopa or mandatory before Abso \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pvk}~\mid{}~\ocwupperid{Pvkc}~\mid{}~\ocwupperid{Pvkv}~$\ocwbc{} Preverb optional before Krid or Iik or Lopak \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{A}~\mid{}~\ocwupperid{An}~$\ocwbc{} privative nan-compounds \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ai}~\mid{}~\ocwupperid{Ani}~$\ocwbc{} initial privative nan-compounds \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iicv}~\mid{}~\ocwupperid{Iicc}~$\ocwbc{} split of Iic by first letter resp. vowel or consonant \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Nouv}~\mid{}~\ocwupperid{Nouc}~$\ocwbc{} idem for Noun \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Krid}~$\ocwbc{} Kridantas eg participles \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Vok}~$\ocwbc{} Kridanta vocatives \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iik}~$\ocwbc{} Kridanta iics \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iikv}~\mid{}~\ocwupperid{Iikc}~\mid{}~\ocwupperid{Kriv}~\mid{}~\ocwupperid{Kric}~\mid{}~\ocwupperid{Vocv}~\mid{}~\ocwupperid{Vocc}~\mid{}~\ocwupperid{Vokv}~\mid{}~\ocwupperid{Vokc}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiy}~\mid{}~\ocwupperid{Avy}~$\ocwbc{} Avyayiibhaavas \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inftu}~\mid{}~\ocwupperid{Kama}~$\ocwbc{} vaktukaama cpds \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Sfx}~\mid{}~\ocwupperid{Isfx}~$\ocwbc{} Taddhita suffixes for padas and iics \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Cache}~$\ocwbc{} Lexicon acquisition \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Unknown}~$\ocwbc{} Unrecognized chunk \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} now pseudo phase tagging root/kridanta forms with preverbs \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Comp}~$\ocwkw{of}~$\ocwlowerid{tag}~$\ocwkw{and}~\ocwbc{} pv \ocwec{}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~\ocwbc{} root/krid in tag \ocwec{}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocweol
\ocwindent{1.00em}
\ocwbc{} finally pseudo-phase tagging nominal forms/stems with taddhita suffixes \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Tad}~$\ocwkw{of}~$\ocwlowerid{tag}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} nominal form in tag \ocwec{}~\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} sfx \ocwec{}\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{tag}~=~(\ocwlowerid{phase}~\times{}~\ocwlowerid{phase})~$\ocwbc{} preverb phase and root/taddhita phase \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} NB. It is essential to keep both phases to identify transition checkpoints \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{phases}~=~$\ocwbt{list}~$\ocwlowerid{phase}$\ocweol
\ocwindent{0.00em}
\ocwbc{} NB. In Simplified mode, we use only 10 phases:
   \ocwbegindcode{}[~$\ocwupperid{Noun2};~\ocwupperid{Pron};~\ocwupperid{Iic2};~\ocwupperid{Ifc2};~\ocwupperid{Root};~\ocwupperid{Inde};~\ocwupperid{Pv};~\ocwupperid{Iiv};~\ocwupperid{Abso};~\ocwupperid{Lopa}~]$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Marshalling for cgi invocations \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{string\_of\_phase}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Noun}~\rightarrow{}~$\ocwstring{"Noun"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Noun2}~\rightarrow{}~$\ocwstring{"Noun2"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pron}~\rightarrow{}~$\ocwstring{"Pron"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Root}~\rightarrow{}~$\ocwstring{"Root"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inde}~\rightarrow{}~$\ocwstring{"Inde"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Absv}~\rightarrow{}~$\ocwstring{"Absv"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Absc}~\rightarrow{}~$\ocwstring{"Absc"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Abso}~\rightarrow{}~$\ocwstring{"Abso"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Voca}~\rightarrow{}~$\ocwstring{"Voca"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inv}~\rightarrow{}~$\ocwstring{"Inv"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iic}~\rightarrow{}~$\ocwstring{"Iic"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iic2}~\rightarrow{}~$\ocwstring{"Iic2"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiif}~\rightarrow{}~$\ocwstring{"Iiif"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiv}~\rightarrow{}~$\ocwstring{"Iiv"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iivv}~\rightarrow{}~$\ocwstring{"Iivv"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iivc}~\rightarrow{}~$\ocwstring{"Iivc"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Auxi}~\rightarrow{}~$\ocwstring{"Auxi"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Auxik}~\rightarrow{}~$\ocwstring{"Auxik"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Auxiick}~\rightarrow{}~$\ocwstring{"Auxiick"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ifc}~\rightarrow{}~$\ocwstring{"Ifc"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ifc2}~\rightarrow{}~$\ocwstring{"Ifc2"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Lopa}~\rightarrow{}~$\ocwstring{"Lopa"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Lopak}~\rightarrow{}~$\ocwstring{"Lopak"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pv}~\rightarrow{}~$\ocwstring{"Pv"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pvk}~\rightarrow{}~$\ocwstring{"Pvk"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pvkc}~\rightarrow{}~$\ocwstring{"Pvkc"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pvkv}~\rightarrow{}~$\ocwstring{"Pvkv"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{A}~\rightarrow{}~$\ocwstring{"A"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{An}~\rightarrow{}~$\ocwstring{"An"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ai}~\rightarrow{}~$\ocwstring{"Ai"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ani}~\rightarrow{}~$\ocwstring{"Ani"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iicv}~\rightarrow{}~$\ocwstring{"Iicv"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iicc}~\rightarrow{}~$\ocwstring{"Iicc"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Nouv}~\rightarrow{}~$\ocwstring{"Nouv"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Nouc}~\rightarrow{}~$\ocwstring{"Nouc"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Krid}~\rightarrow{}~$\ocwstring{"Krid"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Vok}~\rightarrow{}~$\ocwstring{"Vok"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Vokv}~\rightarrow{}~$\ocwstring{"Vokv"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Vokc}~\rightarrow{}~$\ocwstring{"Vokc"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iik}~\rightarrow{}~$\ocwstring{"Iik"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iikv}~\rightarrow{}~$\ocwstring{"Iikv"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iikc}~\rightarrow{}~$\ocwstring{"Iikc"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiy}~\rightarrow{}~$\ocwstring{"Iiy"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Avy}~\rightarrow{}~$\ocwstring{"Avya"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Kriv}~\rightarrow{}~$\ocwstring{"Kriv"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Kric}~\rightarrow{}~$\ocwstring{"Kric"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Vocv}~\rightarrow{}~$\ocwstring{"Vocv"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Vocc}~\rightarrow{}~$\ocwstring{"Vocc"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Peri}~\rightarrow{}~$\ocwstring{"Peri"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inftu}~\rightarrow{}~$\ocwstring{"Inftu"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Kama}~\rightarrow{}~$\ocwstring{"Kama"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Sfx}~\rightarrow{}~$\ocwstring{"Sfx"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Isfx}~\rightarrow{}~$\ocwstring{"Isfx"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Cache}~\rightarrow{}~$\ocwstring{"Cache"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Unknown}~\rightarrow{}~$\ocwstring{"Unknown"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"string\_of\_phase"}\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{phase\_of\_string}~=~$\ocwkw{fun}~\ocwbc{} unsafe \ocwec{}~\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"Noun"}~$\rightarrow{}~\ocwupperid{Noun}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Noun2"}~$\rightarrow{}~\ocwupperid{Noun2}~$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Pron"}~$\rightarrow{}~\ocwupperid{Pron}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Root"}~$\rightarrow{}~\ocwupperid{Root}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Inde"}~$\rightarrow{}~\ocwupperid{Inde}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Abso"}~$\rightarrow{}~\ocwupperid{Abso}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Absv"}~$\rightarrow{}~\ocwupperid{Absv}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Absc"}~$\rightarrow{}~\ocwupperid{Absc}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Voca"}~$\rightarrow{}~\ocwupperid{Voca}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Inv"}~$\rightarrow{}~\ocwupperid{Inv}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Iic"}~$\rightarrow{}~\ocwupperid{Iic}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Iic2"}~$\rightarrow{}~\ocwupperid{Iic2}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Iiif"}~$\rightarrow{}~\ocwupperid{Iiif}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Iiv"}~$\rightarrow{}~\ocwupperid{Iiv}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Iivv"}~$\rightarrow{}~\ocwupperid{Iivv}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Iivc"}~$\rightarrow{}~\ocwupperid{Iivc}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Auxi"}~$\rightarrow{}~\ocwupperid{Auxi}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Auxik"}~$\rightarrow{}~\ocwupperid{Auxik}~$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Auxiick"}~$\rightarrow{}~\ocwupperid{Auxiick}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Ifc"}~$\rightarrow{}~\ocwupperid{Ifc}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Ifc2"}~$\rightarrow{}~\ocwupperid{Ifc2}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Lopa"}~$\rightarrow{}~\ocwupperid{Lopa}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Lopak"}~$\rightarrow{}~\ocwupperid{Lopak}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Pv"}~$\rightarrow{}~\ocwupperid{Pv}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Pvk"}~$\rightarrow{}~\ocwupperid{Pvk}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Pvkc"}~$\rightarrow{}~\ocwupperid{Pvkc}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Pvkv"}~$\rightarrow{}~\ocwupperid{Pvkv}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"A"}~$\rightarrow{}~\ocwupperid{A}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"An"}~$\rightarrow{}~\ocwupperid{An}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Ai"}~$\rightarrow{}~\ocwupperid{Ai}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Ani"}~$\rightarrow{}~\ocwupperid{Ani}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Iicv"}~$\rightarrow{}~\ocwupperid{Iicv}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Iicc"}~$\rightarrow{}~\ocwupperid{Iicc}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Nouv"}~$\rightarrow{}~\ocwupperid{Nouv}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Nouc"}~$\rightarrow{}~\ocwupperid{Nouc}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Krid"}~$\rightarrow{}~\ocwupperid{Krid}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Vokv"}~$\rightarrow{}~\ocwupperid{Vokv}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Vokc"}~$\rightarrow{}~\ocwupperid{Vokc}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Iik"}~$\rightarrow{}~\ocwupperid{Iik}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Iikv"}~$\rightarrow{}~\ocwupperid{Iikv}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Iikc"}~$\rightarrow{}~\ocwupperid{Iikc}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Iiy"}~$\rightarrow{}~\ocwupperid{Iiy}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Avya"}~$\rightarrow{}~\ocwupperid{Avy}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Kriv"}~$\rightarrow{}~\ocwupperid{Kriv}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Kric"}~$\rightarrow{}~\ocwupperid{Kric}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Vocv"}~$\rightarrow{}~\ocwupperid{Vocv}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Vocc"}~$\rightarrow{}~\ocwupperid{Vocc}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Sfx"}~$\rightarrow{}~\ocwupperid{Sfx}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Isfx"}~$\rightarrow{}~\ocwupperid{Isfx}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Peri"}~$\rightarrow{}~\ocwupperid{Peri}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Inftu"}~$\rightarrow{}~\ocwupperid{Inftu}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Kama"}~$\rightarrow{}~\ocwupperid{Kama}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Unknown"}~$\rightarrow{}~\ocwupperid{Unknown}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Cache"}~$\rightarrow{}~\ocwupperid{Cache}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}phase\ocwvspace{}"}~\^{}~$\ocwlowerid{s})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{unknown}~=~\ocwupperid{Unknown}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{aa\_phase}~=~$\ocwkw{fun}~\ocwbc{} phase of preverb \ocwstring{"aa"} according to following phase \ocwec{}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Root}~\mid{}~\ocwupperid{Abso}~\mid{}~\ocwupperid{Peri}~\rightarrow{}~\ocwupperid{Pv}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Pvkv}~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{un\_lopa}~=~$\ocwkw{fun}~\ocwbc{} phase of origin of lopa \ocwec{}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Lopa}~\rightarrow{}~\ocwupperid{Root}~\mid{}~\ocwupperid{Lopak}~\rightarrow{}~\ocwupperid{Kriv}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"un\_lopa"}~$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{preverb\_phase}~=~$\ocwkw{fun}~\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Pv}~\mid{}~\ocwupperid{Pvk}~\mid{}~\ocwupperid{Pvkc}~\mid{}~\ocwupperid{Pvkv}~\rightarrow{}~\ocwupperid{True}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{krid\_phase}~=~$\ocwkw{fun}~$[~\ocwupperid{Krid}~\mid{}~\ocwupperid{Kric}~\mid{}~\ocwupperid{Kriv}~\rightarrow{}~\ocwupperid{True}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{ikrid\_phase}~=~$\ocwkw{fun}~$[~\ocwupperid{Iik}~\mid{}~\ocwupperid{Iikc}~\mid{}~\ocwupperid{Iikv}~\rightarrow{}~\ocwupperid{True}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vkrid\_phase}~=~$\ocwkw{fun}~$[~\ocwupperid{Vokc}~\mid{}~\ocwupperid{Vokv}~\rightarrow{}~\ocwupperid{True}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{ii\_phase}~=~$\ocwkw{fun}~$[~\ocwupperid{Iicv}~\mid{}~\ocwupperid{Iicc}~\mid{}~\ocwupperid{Iikv}~\mid{}~\ocwupperid{Iikc}~\mid{}~\ocwupperid{A}~\mid{}~\ocwupperid{An}~\mid{}~\ocwupperid{Isfx}~\rightarrow{}~\ocwupperid{True}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{is\_cache}~\ocwlowerid{phase}~=~(\ocwlowerid{phase}~=~\ocwupperid{Cache})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Needed as argument of \ocwbegindcode{}$\ocwupperid{Morpho}.\ocwlowerid{print\_inv\_morpho}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{generative}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Krid}~\mid{}~\ocwupperid{Kriv}~\mid{}~\ocwupperid{Kric}~\mid{}~\ocwupperid{Vokv}~\mid{}~\ocwupperid{Vokc}~\mid{}~\ocwupperid{Iik}~\mid{}~\ocwupperid{Iikv}~\mid{}~\ocwupperid{Iikc}~\mid{}~\ocwupperid{Auxik}~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Comp}~(\ocwlowerid{\_},\ocwlowerid{ph})~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{generative}~\ocwlowerid{ph}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end};~\ocwbc{} Phases \ocwec{}\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Lemmatizer.ml}
\ocwmodule{Lemmatizer}
\label{lemmatizer.ml:0}%
CGI-bin lemmatizer for searching the inflected forms databases         
\ocweol
\ocwindent{0.00em}
This CGI is triggered by page \ocwbegindcode{}$\ocwlowerid{index\_page}$\ocwenddcode{} in \ocwbegindcode{}$\ocwlowerid{dico\_dir}$\ocwenddcode{}.              
\ocweol
\ocwindent{0.00em}
Reads its input in shell variable \ocwbegindcode{}$\ocwupperid{QUERY\_STRING}$\ocwenddcode{} URI-encoded.          
\ocweol
\ocwindent{0.00em}
Prints an HTML document of lemma information on \ocwbegindcode{}$\ocwlowerid{stdout}$\ocwenddcode{}.              
\ocweol
\label{lemmatizer.ml:1118}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps pl etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Cgi};$\medskip

\label{lemmatizer.ml:1167}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ps}~=~\ocwlowerid{print\_string}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pl}~\ocwlowerid{s}~=~$\ocwkw{do}~\{~$\ocwlowerid{ps}~\ocwlowerid{s};~\ocwlowerid{print\_newline}~()~\}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display\_rom\_red}~\ocwlowerid{s}~=~\ocwlowerid{html\_red}~(\ocwupperid{Transduction.}\ocwlowerid{skt\_to\_html}~\ocwlowerid{s})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{back\_ground}~=~\ocwlowerid{background}~\ocwupperid{Chamois}$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{prelude}~\ocwlowerid{lang}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{http\_header}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_begin}~\ocwlowerid{heritage\_dictionary\_title}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{body\_begin}~\ocwlowerid{back\_ground})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_title\_solid}~\ocwupperid{Mauve}~(\ocwupperid{Some}~\ocwlowerid{lang})~\ocwlowerid{stem\_title\_en}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{postlude}~\ocwlowerid{lang}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{page\_end}~\ocwlowerid{lang}~\ocwupperid{True}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{abor}~=~\ocwlowerid{abort}~\ocwlowerid{default\_language}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{give\_up}~\ocwlowerid{phase}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{mess}~=~$\ocwstring{"Missing\ocwvspace{}"}~\^{}~$\ocwlowerid{phase}~$\^{}~\ocwstring{"\ocwvspace{}morphology"}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{sys\_err\_mess}~\ocwlowerid{mess};~\ocwlowerid{exit}~0~\}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{load\_inflected}~\ocwlowerid{phase}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{file}~=~$\ocwkw{match}~$\ocwlowerid{phase}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~$\ocwstring{"Noun"}~$\rightarrow{}~\ocwlowerid{public\_nouns2\_file}~$\ocwbc{} bigger than nouns \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Pron"}~$\rightarrow{}~\ocwlowerid{public\_pronouns\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Verb"}~$\rightarrow{}~\ocwlowerid{public\_roots\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Part"}~$\rightarrow{}~\ocwlowerid{public\_parts\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Inde"}~$\rightarrow{}~\ocwlowerid{public\_inde\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Absya"}~$\rightarrow{}~\ocwlowerid{public\_absya\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Abstvaa"}~$\rightarrow{}~\ocwlowerid{public\_abstvaa\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Iic"}~$\rightarrow{}~\ocwlowerid{public\_iics2\_file}~$\ocwbc{} bigger than iics \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Iiv"}~$\rightarrow{}~\ocwlowerid{public\_iivs\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Ifc"}~$\rightarrow{}~\ocwlowerid{public\_ifcs2\_file}~$\ocwbc{} bigger than ifcs \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Piic"}~$\rightarrow{}~\ocwlowerid{public\_piics\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Voca"}~$\rightarrow{}~\ocwlowerid{public\_vocas\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Fatal}~$\ocwstring{"Unexpected\ocwvspace{}phase"}$)~$\ocwbc{} Pv Auxi Eort \ocwec{}\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwlowerid{file}~:~\ocwupperid{Morphology.}\ocwlowerid{inflected\_map})$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{give\_up}~\ocwlowerid{phase}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{generative}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"Part"}~$\mid{}~$\ocwstring{"Piic"}~$\rightarrow{}~\ocwupperid{True}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{answer\_begin}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{center\_begin}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{table\_begin\_style}~(\ocwlowerid{centered}~\ocwupperid{Yellow})~[~\ocwlowerid{noborder};~($\ocwstring{"cellspacing"},\ocwstring{"20pt"}$)~])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{answer\_end}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{th\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{table\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{unvisarg\_rev}~=~$\ocwkw{fun}~\ocwbc{} we revert a final visarga to s \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[~16~::~\ocwlowerid{w}~]~\rightarrow{}~[~48~::~\ocwlowerid{w}~]~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{w}~\rightarrow{}~\ocwlowerid{w}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{unvisarg}~\ocwlowerid{word}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~(\ocwlowerid{unvisarg\_rev}~(\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{word}))$\ocweol
\ocwindent{0.00em}
\ocwbc{} thus we may input raama.h and search for raamas in the morphological tables
   but we can't input puna.h or anta.h and search for punar or antar or also 
   verbal ninyu.h, stored as ninyur even though it is displayed as ninyu.h \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Main \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{lemmatizer\_engine}~()~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{query}~=~\ocwupperid{Sys.}\ocwlowerid{getenv}~$\ocwstring{"QUERY\_STRING"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{env}~=~\ocwlowerid{create\_env}~\ocwlowerid{query}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{translit}~=~\ocwlowerid{get}~$\ocwstring{"t"}~$\ocwlowerid{env}~\ocwupperid{Paths.}\ocwlowerid{default\_transliteration}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{lex}~=~\ocwlowerid{get}~$\ocwstring{"lex"}~$\ocwlowerid{env}~\ocwupperid{Paths.}\ocwlowerid{default\_lexicon}$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_entry}~=~\ocwlowerid{get}~$\ocwstring{"q"}~$\ocwlowerid{env}~$\ocwstring{""}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_cat}~=~\ocwlowerid{get}~$\ocwstring{"c"}~$\ocwlowerid{env}~$\ocwstring{"Noun"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{str}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_entry}~$\ocwbc{} in translit \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{cat}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_cat}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{lang}~=~\ocwlowerid{language\_of}~\ocwlowerid{lex}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{encode}~=~\ocwupperid{Encode.}\ocwlowerid{switch\_code}~\ocwlowerid{translit}~$\ocwbc{} normalized input \ocwec{}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{prelude}~\ocwlowerid{lang}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{word}~=~\ocwlowerid{unvisarg}~(\ocwlowerid{encode}~\ocwlowerid{str})~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{inflected\_cat}~=~\ocwlowerid{load\_inflected}~\ocwlowerid{cat}~$\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{gen}~=~\ocwlowerid{generative}~\ocwlowerid{cat}~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{react}~\ocwlowerid{inflected}~=~$\ocwkw{do}\ocweol
\ocwindent{5.00em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{display\_rom\_red}~(\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{word}))~$\ocwbc{} in romanized \ocwec{}\ocweol
\ocwindent{5.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{span\_begin}~\ocwupperid{Latin12})$\ocweol
\ocwindent{5.00em}
;~\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{word}~\ocwlowerid{inflected}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[\,]~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{7.00em}
\{~$\ocwlowerid{ps}~($\ocwstring{"\ocwvspace{}not\ocwvspace{}found\ocwvspace{}as\ocwvspace{}a\ocwvspace{}"}~\^{}~$\ocwlowerid{cat}~$\^{}~\ocwstring{"\ocwvspace{}form"}$)$\ocweol
\ocwindent{7.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{7.00em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{le}~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{7.00em}
\{~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}lemmatizes\ocwvspace{}as:"}\ocweol
\ocwindent{7.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{7.00em}
;~\ocwkw{let}~$\ocwlowerid{pi}~=~\ocwupperid{Morpho\_html.}\ocwlowerid{print\_inflected}~\ocwlowerid{gen}~\ocwlowerid{word}~$\ocwkw{in}~\ocweol
\ocwindent{8.00em}
$\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{pi}~\ocwlowerid{le}$\ocweol
\ocwindent{7.00em}
\}\ocweol
\ocwindent{6.00em}
$]~$\ocweol
\ocwindent{5.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{span\_end}$\ocweol
\ocwindent{5.00em}
\}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{answer\_begin}~()~$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{react}~\ocwlowerid{inflected\_cat}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{answer\_end}~()$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{postlude}~\ocwlowerid{lang}$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{2.00em}
\ocwkw{with}~$[~\ocwupperid{Stream.Error}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Illegal\ocwvspace{}transliteration\ocwvspace{}"}~$\ocwlowerid{str}~]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{safe\_lemmatizer\_engine}~()~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwlowerid{lemmatizer\_engine}~()~$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~\ocwbc{} sanitized service \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Encode.In\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Wrong\_input\ocwvspace{}"}~$\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Exit}~$\ocwbc{} Sanskrit \ocwec{}~$\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Wrong\ocwvspace{}character\ocwvspace{}in\ocwvspace{}input\ocwvspace{}\symbol{45}\ocwvspace{}"}~\ocwstring{"use\ocwvspace{}ASCII"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Sys\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{sys\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Stream.Error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{stream\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Invalid\_argument}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} sub \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Failure}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Control.Fatal}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Not\_found}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"assoc"}~\ocwbc{} assoc \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{End\_of\_file}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"EOF"}~\ocwbc{} EOF \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"Unexpected\ocwvspace{}anomaly"}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{safe\_lemmatizer\_engine}~()$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Auto.mli}
\ocwinterface{Auto}
\label{auto.mli:0}%
The auto structure 
\ocweol
\label{auto.mli:645}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Auto}~:~$\ocwkw{sig}\medskip

\label{auto.mli:664}%
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{rule}~=~(\ocwupperid{Word.}\ocwlowerid{word}~\times{}~\ocwupperid{Word.}\ocwlowerid{word}~\times{}~\ocwupperid{Word.}\ocwlowerid{word});~$\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$(\ocwlowerid{w},\ocwlowerid{u},\ocwlowerid{v})$\ocwenddcode{} such that \ocwbegindcode{}$(\ocwlowerid{rev}~\ocwlowerid{u})\mid{}\ocwlowerid{v}~\rightarrow{}~\ocwlowerid{w}$\ocwenddcode{} \ocwec{}\medskip

\label{auto.mli:758}%
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{auto}~=~[~\ocwupperid{State}~$\ocwkw{of}~$($\ocwbt{bool}~$\times{}~\ocwlowerid{deter}~\times{}~\ocwlowerid{choices})~]$\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}\ocwbt{bool}\ocwenddcode{} is \ocwbegindcode{}$\ocwupperid{True}$\ocwenddcode{} for accepting states \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Possible refinement - order choices by right-hand sides of sandhi rules \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{deter}~=~$\ocwbt{list}~$(\ocwupperid{Word.}\ocwlowerid{letter}~\times{}~\ocwlowerid{auto})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{choices}~=~$\ocwbt{list}~$\ocwlowerid{rule};$\medskip

\label{auto.mli:994}%
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{stack}~=~$\ocwbt{list}~$\ocwlowerid{choices};~$\ocwbc{} choice points stack \ocwec{}\medskip

\label{auto.mli:1049}%
\ocwindent{0.00em}
\ocwkw{end};\ocweol
\ocwendcode{}\typeout{OcamlWeb file Load_transducers.ml}
\ocwmodule{Load\_transducers}
\label{load_transducers.ml:0}%
\ocwbegindcode{}$\ocwupperid{Load\_transducers}$\ocwenddcode{} 
\ocweol
\ocwindent{0.00em}
Used for loading the transducers as well as root informations 
\ocweol
\ocwindent{0.00em}
Caution. This is an executable, that actually loads the transducers at
   link time. It also has some redundancy with \ocwbegindcode{}$\ocwupperid{Load\_morphs}$\ocwenddcode{}. 
\ocweol
\label{load_transducers.ml:851}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Auto.Auto};~$\ocwbc{} auto State \ocwec{}\medskip

\label{load_transducers.ml:904}%
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{transducer\_vect}~=~$\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{nouv}~:~\ocwlowerid{auto}~$\ocwbc{} vowel-initial nouns \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{nouc}~:~\ocwlowerid{auto}~$\ocwbc{} consonant-initial nouns \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}; noun : auto \ocwbc{} declined nouns and undeclinables \ocwec{} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{noun2}~:~\ocwlowerid{auto}~$\ocwbc{} idem in mode non gen \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pron}~:~\ocwlowerid{auto}~$\ocwbc{} declined pronouns \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{root}~:~\ocwlowerid{auto}~$\ocwbc{} conjugated root forms \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}; krid : auto \ocwbc{} kridantas forms \ocwec{} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{lopa}~:~\ocwlowerid{auto}~$\ocwbc{} e/o conjugated root forms with lopa \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{lopak}~:~\ocwlowerid{auto}~$\ocwbc{} e/o kridantas forms with lopa \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{inde}~:~\ocwlowerid{auto}~$\ocwbc{} indeclinables + infinitives \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{abso}~:~\ocwlowerid{auto}~$\ocwbc{} abso-ya \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{absv}~:~\ocwlowerid{auto}~$\ocwbc{} vowel-initial abso-tvaa \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{absc}~:~\ocwlowerid{auto}~$\ocwbc{} consonant-initial abso-tvaa \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{peri}~:~\ocwlowerid{auto}~$\ocwbc{} periphrastic perfect \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{vokv}~:~\ocwlowerid{auto}~$\ocwbc{} kridanta vocatives \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{vokc}~:~\ocwlowerid{auto}~$\ocwbc{} id \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{inv}~:~\ocwlowerid{auto}~$\ocwbc{} invocations \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwbc{}; iic  : auto \ocwbc{} iic stems \ocwec{} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iic2}~:~\ocwlowerid{auto}~$\ocwbc{} iic stems in mode non gen \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iifc}~:~\ocwlowerid{auto}~$\ocwbc{} iic forms of ifc stems \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwbc{}; iik  : auto \ocwbc{} iik stems \ocwec{} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iiv}~:~\ocwlowerid{auto}~$\ocwbc{} iiv periphrastic stems \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{auxi}~:~\ocwlowerid{auto}~$\ocwbc{} their k.r and bhuu finite forms supports \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{auxik}~:~\ocwlowerid{auto}~$\ocwbc{} their k.r and bhuu kridanta forms supports \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{auxiick}~:~\ocwlowerid{auto}~$\ocwbc{} their k.r and bhuu iic kridanta forms supports \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ifc}~:~\ocwlowerid{auto}~$\ocwbc{} ifc forms \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}  ; ifcv : auto \ocwbc{} vowel-initial ifc \ocwec{}
  ; ifcc : auto \ocwbc{} consonant-initial ifc \ocwec{} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ifc2}~:~\ocwlowerid{auto}~$\ocwbc{} ifc forms in mode non gen \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iiy}~:~\ocwlowerid{auto}~$\ocwbc{} iic avyayiibhava \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{avya}~:~\ocwlowerid{auto}~$\ocwbc{} ifc avyayiibhava \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{inftu}~:~\ocwlowerid{auto}~$\ocwbc{} infinitives in -tu \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{kama}~:~\ocwlowerid{auto}~$\ocwbc{} forms of kaama \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{prev}~:~\ocwlowerid{auto}~$\ocwbc{} preverb sequences \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pvc}~:~\ocwlowerid{auto}~$\ocwbc{} preverb sequences starting with consonant \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pvv}~:~\ocwlowerid{auto}~$\ocwbc{} preverb sequences starting with vowel \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{a}~:~\ocwlowerid{auto}~$\ocwbc{} privative a \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{an}~:~\ocwlowerid{auto}~$\ocwbc{} privative an \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iicv}~:~\ocwlowerid{auto}~$\ocwbc{} vowel-initial iic \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iicc}~:~\ocwlowerid{auto}~$\ocwbc{} consonant-initial iic \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iivv}~:~\ocwlowerid{auto}~$\ocwbc{} vowel-initial iiv \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iivc}~:~\ocwlowerid{auto}~$\ocwbc{} consonant-initial iiv \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{vocv}~:~\ocwlowerid{auto}~$\ocwbc{} vowel-initial vocatives \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{vocc}~:~\ocwlowerid{auto}~$\ocwbc{} consonant-initial vocatives \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iikv}~:~\ocwlowerid{auto}~$\ocwbc{} vowel-initial iik \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iikc}~:~\ocwlowerid{auto}~$\ocwbc{} consonant-initial iik \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{kriv}~:~\ocwlowerid{auto}~$\ocwbc{} vowel-initial krids \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{kric}~:~\ocwlowerid{auto}~$\ocwbc{} consonant-initial krids \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{sfx}~:~\ocwlowerid{auto}~$\ocwbc{} taddhita suffixes \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{isfx}~:~\ocwlowerid{auto}~$\ocwbc{} taddhita suffixes for iic stems \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{cache}~:~\ocwlowerid{auto}~$\ocwbc{} user-defined supplement to noun \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\label{load_transducers.ml:3240}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Trans}~$\ocwbc{} takes its prelude and control arguments as parameters \ocwec{}\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Prel}:~$\ocwkw{sig}~$\ocwlowerid{value}~\ocwlowerid{prelude}~:~$\ocwbt{unit}~$\rightarrow{}~$\ocwbt{unit};~\ocwkw{end}$)~$\ocweol
\ocwindent{0.50em}
=~\ocwkw{struct}\medskip

\label{load_transducers.ml:3374}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{abort}~\ocwlowerid{cat}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{mess}~=~$\ocwstring{"Missing\ocwvspace{}"}~\^{}~$\ocwlowerid{cat}~$\^{}~\ocwstring{"\ocwvspace{}database"}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~\ocwlowerid{mess})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{empty\_trans}~=~\ocwupperid{State}(\ocwupperid{False},[\,],[\,])~$\ocwbc{} dummy empty transducer \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Load persistent transducer automaton of given phase (lexical category). \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} These files have been copied from their development version \ocwbegindcode{}$\ocwlowerid{transn\_file}$\ocwenddcode{}
   etc. created by \ocwbegindcode{}$\ocwupperid{Make\_inflected}$\ocwenddcode{} followed by \ocwbegindcode{}$\ocwupperid{Make\_automaton}$\ocwenddcode{}. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{load\_transducer}~\ocwlowerid{cat}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{file}~=~$\ocwkw{match}~$\ocwlowerid{cat}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~$\ocwstring{"Noun"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transn\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Noun2"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transn2\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Pron"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transpn\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Verb"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transr\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Krid"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transpa\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Vok"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transpav\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Peri"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transperi\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Lopa"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_translopa\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Lopak"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_translopak\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Inde"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transinde\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Iic"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transic\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Iic2"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transic2\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Iiif"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transiif\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Iik"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transpic\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Iiv"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transiv\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Ifc"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transif\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Ifc2"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transif2\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Iiy"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transiiy\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Avya"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transavy\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Abstvaa"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transabstvaa\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Absya"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transabsya\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Inftu"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transinftu\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Kama"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transkama\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Auxi"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transauxi\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Auxik"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transauxik\_file}~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Auxiick"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transauxiick\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Voca"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transvoca\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Inv"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transinv\_file}~$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Prev"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transp\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Sfx"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transsfx\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Isfx"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transisfx\_file}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"Cache"}~$\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{public\_transca\_file}~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unexpected\ocwvspace{}category:\ocwvspace{}"}~\^{}~$\ocwlowerid{cat})~$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwlowerid{file}~:~\ocwlowerid{auto})~$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{cat}=$\ocwstring{"Cache"}~\ocwbc{} uninitialized cache \ocwec{}\ocweol
\ocwindent{8.50em}
\ocwkw{then}~$\ocwlowerid{empty\_trans}~$\ocwbc{} initialised to empty transducer \ocwec{}\ocweol
\ocwindent{7.00em}
\ocwkw{else}~\ocwkw{do}~\{~$\ocwupperid{Prel.}\ocwlowerid{prelude}~();~\ocwlowerid{abort}~\ocwlowerid{cat}~\}~]$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwbc{} privative prefixes automata \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{a\_trans}~=~\ocwupperid{State}(\ocwupperid{False},[(1,\ocwupperid{State}(\ocwupperid{True},[\,],[\,]))],[\,])$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{an\_trans}~=~$\ocwkw{let}~$\ocwlowerid{n\_trans}~=~\ocwupperid{State}(\ocwupperid{False},[(36,\ocwupperid{State}(\ocwupperid{True},[\,],[\,]))],[\,])~$\ocwkw{in}\ocweol
\ocwindent{8.00em}
$\ocwupperid{State}(\ocwupperid{False},[(1,\ocwlowerid{n\_trans})],[\,])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Splitting an automaton into vowel-initial and consonant-initial solutions \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} with maximum sharing. Assumes deter is in increasing order of phonemes.   \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{split}~\ocwlowerid{deter}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{rv},\ocwlowerid{c})~=~\ocwlowerid{split\_rec}~[\,]~\ocwlowerid{deter}~$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{split\_rec}~\ocwlowerid{vow}~\ocwlowerid{con}~=~$\ocwkw{match}~$\ocwlowerid{con}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~(\ocwlowerid{vow},[\,])$\ocweol
\ocwindent{2.00em}
$\mid{}~[~((\ocwlowerid{c},\ocwlowerid{\_})~$\ocwkw{as}~$\ocwlowerid{arc})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{c}>16~$\ocwkw{then}~$(\ocwlowerid{vow},\ocwlowerid{con})~$\ocwkw{else}~$\ocwlowerid{split\_rec}~[~\ocwlowerid{arc}~::~\ocwlowerid{vow}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$(\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{rv},\ocwlowerid{c})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{split\_auto}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{State}~(\ocwupperid{False},\ocwlowerid{det},[\,])~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$(\ocwlowerid{vow},\ocwlowerid{con})~=~\ocwlowerid{split}~\ocwlowerid{det}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$(\ocwupperid{State}~(\ocwupperid{False},\ocwlowerid{vow},[\,]),\ocwupperid{State}~(\ocwupperid{False},\ocwlowerid{con},[\,]))$\ocweol
\ocwindent{2.00em}
\ocwbc{} This assumes no non-determinism at the top node \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{State}~(\ocwupperid{False},\ocwlowerid{det},\ocwlowerid{rules})~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$(\ocwlowerid{vow},\ocwlowerid{con})~=~\ocwlowerid{split}~\ocwlowerid{det}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$(\ocwupperid{State}~(\ocwupperid{False},\ocwlowerid{vow},\ocwlowerid{rules}),\ocwupperid{State}~(\ocwupperid{False},\ocwlowerid{con},[\,]))$\ocweol
\ocwindent{2.00em}
\ocwbc{} This assumes non-determinism at the top node, and is needed for the 
       preverb automaton. It assumes that the rules concern the vowel part. \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Split\_auto"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{transducers}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{transn}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Noun"}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{transi}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Iic"}~\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{transf}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Ifc"}~\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{transk}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Krid"}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{transik}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Iik"}~\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{transv}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Voca"}~\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{vok}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Vok"}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{iiv}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Iiv"}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{abstvaa}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Abstvaa"}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{pv}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Prev"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwbc{} now we split the subanta stems and forms starting with vowel or consonant \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{transnv},\ocwlowerid{transnc})~=~\ocwlowerid{split\_auto}~\ocwlowerid{transn}$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$(\ocwlowerid{transiv},\ocwlowerid{transic})~=~\ocwlowerid{split\_auto}~\ocwlowerid{transi}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$(\ocwlowerid{kriv},\ocwlowerid{kric})~=~\ocwlowerid{split\_auto}~\ocwlowerid{transk}$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$(\ocwlowerid{iikv},\ocwlowerid{iikc})~=~\ocwlowerid{split\_auto}~\ocwlowerid{transik}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$(\ocwlowerid{iivv},\ocwlowerid{iivc})~=~\ocwlowerid{split\_auto}~\ocwlowerid{iiv}$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$(\ocwlowerid{vocv},\ocwlowerid{vocc})~=~\ocwlowerid{split\_auto}~\ocwlowerid{transv}$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$(\ocwlowerid{vokv},\ocwlowerid{vokc})~=~\ocwlowerid{split\_auto}~\ocwlowerid{vok}$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$(\ocwlowerid{absv},\ocwlowerid{absc})~=~\ocwlowerid{split\_auto}~\ocwlowerid{abstvaa}$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$(\ocwlowerid{pvkv},\ocwlowerid{pvkc})~=~\ocwlowerid{split\_auto}~\ocwlowerid{pv}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{noun2}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Noun2"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{root}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Verb"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pron}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Pron"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{peri}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Peri"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{lopa}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Lopa"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{lopak}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Lopak"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{inde}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Inde"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{abso}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Absya"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iic2}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Iic2"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iifc}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Iiif"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ifc}~=~\ocwlowerid{transf}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ifc2}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Ifc2"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iiv}~=~\ocwlowerid{iiv}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{auxi}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Auxi"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{auxik}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Auxik"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{auxiick}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Auxiick"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{inv}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Inv"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iiy}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Iiy"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{avya}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Avya"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{inftu}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Inftu"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{kama}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Kama"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{prev}~=~\ocwlowerid{pv}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pvc}~=~\ocwlowerid{pvkc}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pvv}~=~\ocwlowerid{pvkv}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{a}~=~\ocwlowerid{a\_trans}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{an}~=~\ocwlowerid{an\_trans}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iicv}~=~\ocwlowerid{transiv}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iicc}~=~\ocwlowerid{transic}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iivv}~=~\ocwlowerid{iivv}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iivc}~=~\ocwlowerid{iivc}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{nouv}~=~\ocwlowerid{transnv}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{nouc}~=~\ocwlowerid{transnc}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{vocv}~=~\ocwlowerid{vocv}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{vocc}~=~\ocwlowerid{vocc}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{vokv}~=~\ocwlowerid{vokv}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{vokc}~=~\ocwlowerid{vokc}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{kriv}~=~\ocwlowerid{kriv}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{kric}~=~\ocwlowerid{kric}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iikv}~=~\ocwlowerid{iikv}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iikc}~=~\ocwlowerid{iikc}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{absv}~=~\ocwlowerid{absv}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{absc}~=~\ocwlowerid{absc}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{sfx}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Sfx"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{isfx}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Isfx"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{cache}~=~\ocwlowerid{load\_transducer}~$\ocwstring{"Cache"}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Lexicalized root informations needed for Dispatcher 
\ocweol
\label{load_transducers.ml:8801}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{roots\_usage}~=~$\ocwbc{} attested preverb sequences \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwupperid{Web.}\ocwlowerid{public\_roots\_usage\_file}~:~\ocwupperid{Deco.}\ocwlowerid{deco}~$\ocwbt{string}$)~$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwupperid{Prel.}\ocwlowerid{prelude}~();~\ocwlowerid{abort}~$\ocwstring{"RU"}~\}~$]$\ocweol
\ocwindent{0.00em}
;\medskip

\label{load_transducers.ml:8977}%
\ocwindent{0.00em}
\ocwkw{end}~\ocwbc{} Trans \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Dispatcher.mli}
\ocwinterface{Dispatcher}
\label{dispatcher.mli:0}%
Dispatcher: Sanskrit Engine in 55 phases automaton (plus 2 fake ones) 
\ocweol
\ocwindent{0.00em}
The Dispatch functor maps a transducer vector of 39 aums into     
\ocweol
\ocwindent{0.00em}
- a dispatch automaton implementing a regular description over   
\ocweol
\ocwindent{0.00em}
45 phases of lexical analysis                                  
\ocweol
\ocwindent{0.00em}
- an initial vector of initial resumptions                       
\ocweol
\ocwindent{0.00em}
- a final test for lexical acceptance                            
\ocweol
\ocwindent{0.00em}
- a consistency check of the output of the segmenting transducer 
\ocweol
\ocwindent{0.00em}
Dispatch, instantiated by Transducers, is used as parameter of the 
   Segment functor from Segmenter or Interface.   
\ocweol
\label{dispatcher.mli:1254}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Auto.Auto};~$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Load\_transducers};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{transducer\_vect}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{inflexion\_tag}~\ocwupperid{Verb\_form}~\ocwlowerid{pada\_tag}~\ocwlowerid{morphology}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phases.Phases};~$\ocwbc{} phase etc. \ocwec{}\medskip

\label{dispatcher.mli:1425}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Dispatch}~:~$\ocwkw{functor}~\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Trans}:~$\ocwkw{sig}~$\ocwlowerid{value}~\ocwlowerid{transducers}~:~\ocwlowerid{transducer\_vect};~$\ocweol
\ocwindent{7.00em}
$\ocwlowerid{value}~\ocwlowerid{roots\_usage}~:~\ocwupperid{Deco.}\ocwlowerid{deco}~$\ocwbt{string};~\ocwkw{end}$)~\rightarrow{}~$\ocwkw{functor}\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Lem}:~$\ocwkw{sig}~$\ocwlowerid{value}~\ocwlowerid{morpho}~:~\ocwlowerid{morphology};~$\ocwkw{end}$)~\rightarrow{}~$\ocwkw{sig}\medskip

\label{dispatcher.mli:1624}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{transducer}~:~\ocwlowerid{phase}~\rightarrow{}~\ocwlowerid{auto}~$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{initial}:~$\ocwbt{bool}~$\rightarrow{}~\ocwlowerid{phases}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{dispatch}:~$\ocwbt{bool}~$\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~\ocwlowerid{phase}~\rightarrow{}~\ocwlowerid{phases}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{accepting}:~\ocwlowerid{phase}~\rightarrow{}~$\ocwbt{bool}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{input}~=~\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} input sentence represented as a word \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transition}~=~$\ocwbc{} Reflexive relation \ocwec{}~\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Euphony}~$\ocwkw{of}~$\ocwlowerid{rule}~$\ocwbc{} \ocwbegindcode{}$(\ocwlowerid{w},\ocwlowerid{rev}~\ocwlowerid{u},\ocwlowerid{v})$\ocwenddcode{} such that \ocwbegindcode{}$\ocwlowerid{u}\mid{}\ocwlowerid{v}~\rightarrow{}~\ocwlowerid{w}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Id}~$\ocwbc{} identity or no sandhi \ocwec{}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{segment}~=~(\ocwlowerid{phase}~\times{}~\ocwupperid{Word.}\ocwlowerid{word}~\times{}~\ocwlowerid{transition})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{output}~=~$\ocwbt{list}~$\ocwlowerid{segment};$\medskip

\label{dispatcher.mli:2089}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{valid\_morpho}~:~$\ocweol
\ocwindent{1.00em}
\ocwbt{bool}~$\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~\ocwupperid{Morphology.}\ocwlowerid{inflexion\_tag}~\rightarrow{}~$\ocwbt{bool}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{trim\_tags}~:~$\ocweol
\ocwindent{1.00em}
\ocwbt{bool}~$\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~\ocwupperid{Morphology.}\ocwlowerid{multitag}~\rightarrow{}~\ocwupperid{Morphology.}\ocwlowerid{multitag}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{validate}~:~\ocwlowerid{output}~\rightarrow{}~\ocwlowerid{output}~$\ocwbc{} consistency check and glueing \ocwec{}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{color\_of\_phase}~:~\ocwlowerid{phase}~\rightarrow{}~\ocwupperid{Html.}\ocwlowerid{color};$\medskip

\label{dispatcher.mli:2397}%
\ocwindent{0.00em}
\ocwkw{end};\ocweol
\ocwendcode{}\typeout{OcamlWeb file Dispatcher.ml}
\ocwmodule{Dispatcher}
\label{dispatcher.ml:0}%
Dispatcher: Sanskrit Engine in 53 phases automaton (plus 2 fake ones) 
\ocweol
\ocwindent{0.00em}
The Dispatch functor maps a transducer vector of 39 aums into     
\ocweol
\ocwindent{0.00em}
- a dispatch automaton implementing a regular description over   
\ocweol
\ocwindent{0.00em}
45 phases of lexical analysis                                  
\ocweol
\ocwindent{0.00em}
- an initial vector of initial resumptions                       
\ocweol
\ocwindent{0.00em}
- a final test for lexical acceptance                            
\ocweol
\ocwindent{0.00em}
- a consistency check of the output of the segmenting transducer 
\ocweol
\ocwindent{0.00em}
Dispatch, instantiated by Transducers, is used as parameter of the 
   Segment functor from Segmenter or Interface.   
\ocweol
\label{dispatcher.ml:1254}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Auto.Auto};~$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Load\_transducers};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{transducer\_vect}~\ocwupperid{Trans}~\ocwlowerid{roots\_morpho}~\ocwlowerid{krids\_morpho}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{inflected}~\ocwlowerid{inflected\_map}~\ocwupperid{Verb\_form}~\ocwlowerid{morphology}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Naming};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{homo\_undo}~\ocwlowerid{look\_up\_homo}~\ocwlowerid{unique\_kridantas}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phases.Phases};~$\ocwbc{} phase etc. \ocwec{}\medskip

\label{dispatcher.ml:1537}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Dispatch}~$\ocweol
\ocwindent{1.00em}
\ocwbc{} To be instantiated by Transducers from Lexer or Interface \ocwec{}~\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Trans}:~$\ocwkw{sig}~$\ocwlowerid{value}~\ocwlowerid{transducers}~:~\ocwlowerid{transducer\_vect};~$\ocweol
\ocwindent{7.00em}
$\ocwlowerid{value}~\ocwlowerid{roots\_usage}~:~\ocwupperid{Deco.}\ocwlowerid{deco}~$\ocwbt{string};~\ocwkw{end}$)~$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Lem}:~$\ocwkw{sig}~$\ocwlowerid{value}~\ocwlowerid{morpho}~:~\ocwlowerid{morphology};~$\ocwkw{end}$)~=~$\ocwkw{struct}~\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Trans};~$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Lem};$\medskip

\ocwendcode{}\ocwindent{0.00em}
\ocwbegindcode{}~$\ocwlowerid{transducer}~:~\ocwlowerid{phase}~\rightarrow{}~\ocwlowerid{auto}~$\ocwenddcode{} 
\ocweol
\label{dispatcher.ml:1849}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{transducer}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Nouv}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{nouv}~$\ocwbc{} vowel-initial noun \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Nouc}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{nouc}~$\ocwbc{} consonant-initial noun \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Noun2}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{noun2}~$\ocwbc{} idem in mode non gen \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pron}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{pron}~$\ocwbc{} declined pronouns \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Root}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{root}~$\ocwbc{} conjugated root forms and infinitives \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Vokv}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{vokv}~$\ocwbc{} vowel-initial vocative k.rdaantas \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Vokc}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{vokc}~$\ocwbc{} consonant-initial vocative k.rdaantas \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inde}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{inde}~$\ocwbc{} indeclinables, particles  \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Absv}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{absv}~$\ocwbc{} vowel-initial absolutives in -tvaa \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Absc}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{absc}~$\ocwbc{} consonant-initial absolutives in -tvaa \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Abso}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{abso}~$\ocwbc{} absolutives in -ya \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iic2}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{iic2}~$\ocwbc{} idem in mode non gen \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiif}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{iifc}~$\ocwbc{} fake iic of ifc stems \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiv}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{iiv}~$\ocwbc{} in initio verbi nominal stems, perpft \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inv}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{inv}~$\ocwbc{} invocations \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Auxi}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{auxi}~$\ocwbc{} k.r and bhuu finite forms \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Auxik}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{auxik}~$\ocwbc{} k.r and bhuu kridanta forms \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Auxiick}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{auxiick}~$\ocwbc{} k.r and bhuu kridanta bare forms \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Peri}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{peri}~$\ocwbc{} periphrastic perfect \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Lopa}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{lopa}~$\ocwbc{} e/o root forms \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Lopak}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{lopak}~$\ocwbc{} e/o kridanta forms \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ifc}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{ifc}~$\ocwbc{} in fine composi forms \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ifc2}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{ifc2}~$\ocwbc{} idem in mode non gen \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pv}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{prev}~$\ocwbc{} preverbs \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pvkc}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{pvc}~$\ocwbc{} preverbs starting with consonant \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pvkv}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{pvv}~$\ocwbc{} preverbs starting with vowel \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{A}~\mid{}~\ocwupperid{Ai}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{a}~$\ocwbc{} privative a \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{An}~\mid{}~\ocwupperid{Ani}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{an}~$\ocwbc{} privative an \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iicv}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{iicv}~$\ocwbc{} vowel-initial iic \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iicc}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{iicc}~$\ocwbc{} consonant-initial iic \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iikv}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{iikv}~$\ocwbc{} vowel-initial iic k.rdaanta \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iikc}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{iikc}~$\ocwbc{} consonant-initial iic k.rdaanta \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iivv}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{iivv}~$\ocwbc{} vowel-initial iiv (cvi) \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iivc}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{iivc}~$\ocwbc{} consonant-initial iiv (cvi) \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Kriv}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{kriv}~$\ocwbc{} vowel-initial krid \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Kric}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{kric}~$\ocwbc{} consonant-initial krid \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Vocv}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{vocv}~$\ocwbc{} vowel-initial vocatives \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Vocc}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{vocc}~$\ocwbc{} consonant-initial vocatives \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiy}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{iiy}~$\ocwbc{} iic avyayiibhava \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Avy}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{avya}~$\ocwbc{} ifc avyayiibhava \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inftu}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{inftu}~$\ocwbc{} infinitives in -tu iic. Renou HLS 72 \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Kama}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{kama}~$\ocwbc{} ifcs of kaama/manas: tyaktukaama dra.s.tumanas \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Sfx}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{sfx}~$\ocwbc{} ifc taddhita suffixes \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Isfx}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{isfx}~$\ocwbc{} iifc taddhita suffixes \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Cache}~\rightarrow{}~\ocwlowerid{transducers.}\ocwlowerid{cache}~$\ocwbc{} cached forms \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Noun}~\mid{}~\ocwupperid{Iic}~\mid{}~\ocwupperid{Iik}~\mid{}~\ocwupperid{Voca}~\mid{}~\ocwupperid{Krid}~\mid{}~\ocwupperid{Pvk}~\mid{}~\ocwupperid{Vok}$\ocweol
\ocwindent{2.00em}
$\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"composite\ocwvspace{}phase"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Unknown}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"transducer\ocwvspace{}\symbol{45}\ocwvspace{}Unknown"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"no\ocwvspace{}transducer\ocwvspace{}for\ocwvspace{}fake\ocwvspace{}phase"}$)~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwbc{} Tests whether a word starts with a phantom phoneme (precooked aa-prefixed
   finite or participial or infinitive or abs-ya root form \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{phantomatic}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{c}<(-2)$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwbc{} Amuitic forms start wiih -2 = \ocwbegindcode{}-\ocwenddcode{} which elides preceding -a or -aa from Pv \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{amuitic}=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~-2~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwupperid{True}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We recognize $S = (Subst + Pron + Verb + Inde + Voca)^+$\\
   with $Verb = (1 + Pv).Root + Pv.Abso + Iiv.Auxi$,\\
       $Subst = Noun + Iic.Ifc + Iic.Subst + Iiv.Auxik$,\\
       $Noun = Nounv + Nounc$ and
       $Iic = Iicv + Iicc$\\
NB. $Abso$ = absolutives in -ya, 
    $Inde$ contains absolutives in -tvaa and infinitives,
    $Voca = Vocv + Vocc$ (vocatives),
    $Auxi$ = finite forms of bhuu and k.r.\\
The following is obtained from the above recursion equation by Brzozowski's 
derivatives like in Berry-Sethi's translator. \ocwec{}\medskip

\label{dispatcher.ml:5732}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{cached}~=~$\ocwbc{} potentially cached lexicon acquisitions \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwupperid{Web.cache\_active.}\ocwlowerid{val}=$\ocwstring{"t"}~\ocwkw{then}~$[~\ocwupperid{Cache}~]~$\ocwkw{else}~$[\,]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} initial1, initial2: phases \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{initial1}~=$\ocweol
\ocwindent{1.50em}
\ocwbc{} All phases but Ifc, Abso, Auxi, Auxik, Auxiick, Lopa, Lopak, Sfx, Isfx. \ocwec{}\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Inde};~\ocwupperid{Iicv};~\ocwupperid{Iicc};~\ocwupperid{Nouv};~\ocwupperid{Nouc};~\ocwupperid{Pron};~\ocwupperid{A};~\ocwupperid{An};~\ocwupperid{Root};~\ocwupperid{Kriv};~\ocwupperid{Kric};~\ocwupperid{Iikv};~\ocwupperid{Iikc}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Peri};~\ocwupperid{Pv};~\ocwupperid{Pvkv};~\ocwupperid{Pvkc};~\ocwupperid{Iiv};~\ocwupperid{Iivv};~\ocwupperid{Iivc};~\ocwupperid{Iiy};~\ocwupperid{Inv};~\ocwupperid{Ai};~\ocwupperid{Ani};~\ocwupperid{Absv};~\ocwupperid{Absc};~\ocwupperid{Inftu}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Vocv};~\ocwupperid{Vocc};~\ocwupperid{Vokv};~\ocwupperid{Vokc}~]~@~\ocwlowerid{cached}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{initial2}~=~$\ocwbc{} simplified segmenter with less phases, no generation \ocwec{}\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Inde};~\ocwupperid{Iic2};~\ocwupperid{Noun2};~\ocwupperid{Pron};~\ocwupperid{Root};~\ocwupperid{Pv};~\ocwupperid{Iiv};~\ocwupperid{Absv};~\ocwupperid{Absc}~]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{initial}~\ocwlowerid{full}~=~$\ocwkw{if}~$\ocwlowerid{full}~$\ocwkw{then}~$\ocwlowerid{initial1}~$\ocwkw{else}~$\ocwlowerid{initial2}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} dispatch1: Word.word -> phase -> phases \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{dispatch1}~\ocwlowerid{w}~=~$\ocwkw{fun}~\ocwbc{} w is the current input word \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Nouv}~\mid{}~\ocwupperid{Nouc}~\mid{}~\ocwupperid{Pron}~\mid{}~\ocwupperid{Inde}~\mid{}~\ocwupperid{Abso}~\mid{}~\ocwupperid{Auxi}~\mid{}~\ocwupperid{Auxik}~\mid{}~\ocwupperid{Kama}~\mid{}~\ocwupperid{Ifc}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Kriv}~\mid{}~\ocwupperid{Kric}~\mid{}~\ocwupperid{Absv}~\mid{}~\ocwupperid{Absc}~\mid{}~\ocwupperid{Avy}~\mid{}~\ocwupperid{Lopak}~\mid{}~\ocwupperid{Sfx}~\mid{}~\ocwupperid{Root}~\mid{}~\ocwupperid{Lopa}~\rightarrow{}$\ocweol
\ocwindent{3.50em}
\ocwkw{if}~$\ocwlowerid{phantomatic}~\ocwlowerid{w}~$\ocwkw{then}~$[~\ocwupperid{Root};~\ocwupperid{Kriv};~\ocwupperid{Kric};~\ocwupperid{Iikv};~\ocwupperid{Iikc};~\ocwupperid{Abso}~]~$\ocwbc{} aa- pv \ocwec{}~\ocweol
\ocwindent{3.50em}
\ocwkw{else}~$\ocwlowerid{initial1}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{A}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{phantomatic}~\ocwlowerid{w}~$\ocwkw{then}~$[\,]$\ocweol
\ocwindent{4.50em}
\ocwkw{else}~$[~\ocwupperid{Iicc};~\ocwupperid{Nouc};~\ocwupperid{Iikc};~\ocwupperid{Kric};~\ocwupperid{Pvkc};~\ocwupperid{Iivc};~\ocwupperid{Vocc};~\ocwupperid{Vokc}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{An}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{phantomatic}~\ocwlowerid{w}~$\ocwkw{then}~$[\,]~$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$[~\ocwupperid{Iicv};~\ocwupperid{Nouv};~\ocwupperid{Iikv};~\ocwupperid{Kriv};~\ocwupperid{Pvkv};~\ocwupperid{Iivv};~\ocwupperid{Vocv};~\ocwupperid{Vokv}$\ocweol
\ocwindent{5.00em}
;~$\ocwupperid{A}~$\ocwbc{} eg anak.sara \ocwec{}~;~$\ocwupperid{An}~$\ocwbc{} attested ? \ocwec{}~$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ai}~\rightarrow{}~[~\ocwupperid{Absc}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ani}~\rightarrow{}~[~\ocwupperid{Absv}~]$\ocweol
\ocwindent{2.00em}
\ocwbc{} This assumes that privative prefixes cannot prefix Ifc forms 
       justified by \Pan{2,2,6} a-x only if x is a subanta. \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iicv}~\mid{}~\ocwupperid{Iicc}~\mid{}~\ocwupperid{Iikv}~\mid{}~\ocwupperid{Iikc}~\mid{}~\ocwupperid{Iiif}~\mid{}~\ocwupperid{Auxiick}~\rightarrow{}~$\ocwbc{} Compounding \ocwec{}\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Iicv};~\ocwupperid{Iicc};~\ocwupperid{Nouv};~\ocwupperid{Nouc};~\ocwupperid{A};~\ocwupperid{An};~\ocwupperid{Ifc};~\ocwupperid{Iikv};~\ocwupperid{Iikc};~\ocwupperid{Kriv};~\ocwupperid{Kric}$\ocweol
\ocwindent{3.50em}
;~$\ocwupperid{Pvkv};~\ocwupperid{Pvkc};~\ocwupperid{Iiif};~\ocwupperid{Iivv};~\ocwupperid{Iivc};~\ocwupperid{Vocv};~\ocwupperid{Vocc};~\ocwupperid{Vokv};~\ocwupperid{Vokc}~]~@~$\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Sfx};~\ocwupperid{Isfx}~]~@~\ocwlowerid{cached}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pv}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{phantomatic}~\ocwlowerid{w}~$\ocwkw{then}~$[\,]~$\ocwkw{else}~\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{amuitic}~\ocwlowerid{w}~$\ocwkw{then}~$[~\ocwupperid{Lopa}~]~$\ocwkw{else}~$[~\ocwupperid{Root};~\ocwupperid{Abso};~\ocwupperid{Peri};~\ocwupperid{Inftu}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pvkc}~\mid{}~\ocwupperid{Pvkv}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{phantomatic}~\ocwlowerid{w}~$\ocwkw{then}~$[\,]~$\ocwkw{else}~\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{amuitic}~\ocwlowerid{w}~$\ocwkw{then}~$[~\ocwupperid{Lopak}~]~$\ocwkw{else}~$[~\ocwupperid{Iikv};~\ocwupperid{Iikc};~\ocwupperid{Kriv};~\ocwupperid{Kric};~\ocwupperid{Vokv};~\ocwupperid{Vokc}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiv}~\rightarrow{}~[~\ocwupperid{Auxi}~]~$\ocwbc{} as bhuu and k.r finite forms \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iivv}~\mid{}~\ocwupperid{Iivc}~\rightarrow{}~[~\ocwupperid{Auxik};~\ocwupperid{Auxiick}~]~$\ocwbc{} bhuu and k.r kridanta forms \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiy}~\rightarrow{}~[~\ocwupperid{Avy}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Isfx}~\rightarrow{}~$\ocwbc{} Compounding with taddhita \ocwec{}\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Iicv};~\ocwupperid{Iicc};~\ocwupperid{Nouv};~\ocwupperid{Nouc};~\ocwupperid{A};~\ocwupperid{An};~\ocwupperid{Ifc};~\ocwupperid{Iikv};~\ocwupperid{Iikc};~\ocwupperid{Kriv};~\ocwupperid{Kric}$\ocweol
\ocwindent{3.50em}
;~$\ocwupperid{Pvkv};~\ocwupperid{Pvkc};~\ocwupperid{Iiif};~\ocwupperid{Iivv};~\ocwupperid{Iivc};~\ocwupperid{Vocv};~\ocwupperid{Vocc};~\ocwupperid{Vokv};~\ocwupperid{Vokc}~]~@~\ocwlowerid{cached}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Peri}~\rightarrow{}~[~\ocwupperid{Auxi}~]~$\ocwbc{} overgenerates, should be only perfect forms \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inftu}~\rightarrow{}~[~\ocwupperid{Kama}~]~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Vocc}~\mid{}~\ocwupperid{Vocv}~\mid{}~\ocwupperid{Vokv}~\mid{}~\ocwupperid{Vokc}~\mid{}~\ocwupperid{Cache}~\rightarrow{}~[\,]~$\ocweol
\ocwindent{3.00em}
\ocwbc{} only chunk-final vocatives so no Iic overlap \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inv}~\rightarrow{}~[~\ocwupperid{Vocv};~\ocwupperid{Vocc};~\ocwupperid{Vokv};~\ocwupperid{Vokc}~]~$\ocwbc{} invocations before vocatives \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwbc{} Privative prefixes A and An are not allowed to prefix Ifc like a-dhii \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Noun}~\mid{}~\ocwupperid{Iic}~\mid{}~\ocwupperid{Iik}~\mid{}~\ocwupperid{Voca}~\mid{}~\ocwupperid{Krid}~\mid{}~\ocwupperid{Noun2}~\mid{}~\ocwupperid{Iic2}~\mid{}~\ocwupperid{Ifc2}~\mid{}~\ocwupperid{Pvk}~\mid{}~\ocwupperid{Vok}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Unknown}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Dispatcher\ocwvspace{}anomaly"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Dispatcher\ocwvspace{}fake\ocwvspace{}phase"}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{dispatch2}~\ocwlowerid{w}~=~$\ocwkw{fun}~\ocwbc{} simplified segmenter \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Noun2}~\mid{}~\ocwupperid{Pron}~\mid{}~\ocwupperid{Inde}~\mid{}~\ocwupperid{Abso}~\mid{}~\ocwupperid{Absv}~\mid{}~\ocwupperid{Absc}~\mid{}~\ocwupperid{Auxi}~\mid{}~\ocwupperid{Ifc2}~\rightarrow{}$\ocweol
\ocwindent{3.50em}
\ocwkw{if}~$\ocwlowerid{phantomatic}~\ocwlowerid{w}~$\ocwkw{then}~$[~\ocwupperid{Root};~\ocwupperid{Abso}~]$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~$\ocwlowerid{initial2}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Root}~\mid{}~\ocwupperid{Lopa}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{phantomatic}~\ocwlowerid{w}~$\ocwkw{then}~$[\,]~$\ocwbc{} no consecutive verbs in chunk \ocwec{}\ocweol
\ocwindent{9.50em}
\ocwkw{else}~$[~\ocwupperid{Inde};~\ocwupperid{Iic2};~\ocwupperid{Noun2};~\ocwupperid{Pron}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iic2}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{phantomatic}~\ocwlowerid{w}~$\ocwkw{then}~$[\,]$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~$[~\ocwupperid{Iic2};~\ocwupperid{Noun2};~\ocwupperid{Ifc2}~]~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pv}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{phantomatic}~\ocwlowerid{w}~$\ocwkw{then}~$[\,]~$\ocwkw{else}~\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{amuitic}~\ocwlowerid{w}~$\ocwkw{then}~$[~\ocwupperid{Lopa}~]~$\ocwkw{else}~$[~\ocwupperid{Root};~\ocwupperid{Abso}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiv}~\rightarrow{}~[~\ocwupperid{Auxi}~]~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Dispatcher\ocwvspace{}anomaly"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} dispatch: bool -> Word.word -> phase -> phases \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{dispatch}~\ocwlowerid{full}~=~$\ocwkw{if}~$\ocwlowerid{full}~$\ocwkw{then}~$\ocwlowerid{dispatch1}~$\ocwkw{else}~$\ocwlowerid{dispatch2}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{terminal}~=~$\ocwbc{} Accepting phases \ocwec{}\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Nouv};~\ocwupperid{Nouc};~\ocwupperid{Noun2}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Pron}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Root}~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Kriv}~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Kric}~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Inde}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Abso};~\ocwupperid{Absv};~\ocwupperid{Absc}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Ifc};~\ocwupperid{Ifc2}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Auxi};~\ocwupperid{Auxik}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Vocc};~\ocwupperid{Vocv};~\ocwupperid{Vokv};~\ocwupperid{Vokc};~\ocwupperid{Inv}~$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Lopa};~\ocwupperid{Lopak}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Avy};~\ocwupperid{Kama}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Sfx}$\ocweol
\ocwindent{1.50em}
;~$\ocwupperid{Cache}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
accepting: phase -> bool 
\ocweol
\label{dispatcher.ml:9414}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{accepting}~\ocwlowerid{phase}~=~\ocwupperid{List.}\ocwlowerid{mem}~\ocwlowerid{phase}~\ocwlowerid{terminal}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Segmenter control \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{input}~=~\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} input sentence represented as a word \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transition}~=~$\ocwbc{} Reflexive relation \ocwec{}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Euphony}~$\ocwkw{of}~$\ocwlowerid{rule}~$\ocwbc{} \ocwbegindcode{}$(\ocwlowerid{w},\ocwlowerid{rev}~\ocwlowerid{u},\ocwlowerid{v})$\ocwenddcode{} such that \ocwbegindcode{}$\ocwlowerid{u}\mid{}\ocwlowerid{v}~\rightarrow{}~\ocwlowerid{w}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Id}~$\ocwbc{} identity or no sandhi \ocwec{}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{segment}~=~(\ocwlowerid{phase}~\times{}~\ocwupperid{Word.}\ocwlowerid{word}~\times{}~\ocwlowerid{transition})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{output}~=~$\ocwbt{list}~$\ocwlowerid{segment}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Now consistency check - we check that preverbs usage is consistent with
   root px declaration in lexicon \ocwec{}\medskip

\label{dispatcher.ml:9908}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{assoc\_word}~\ocwlowerid{word}~\ocwlowerid{deco}~=$\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$\ocwlowerid{infos}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{word}~\ocwlowerid{deco}~$\ocwkw{in}\ocweol
\ocwindent{1.50em}
\ocwkw{if}~$\ocwlowerid{infos}~=~[\,]~$\ocwkw{then}~$\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}form:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{word})$\ocweol
\ocwindent{1.50em}
\ocwkw{else}~$\ocwlowerid{infos}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{autonomous}~\ocwlowerid{root}~=~$\ocwbc{} root form allowed without preverb \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{infos}~=~\ocwlowerid{assoc\_word}~\ocwlowerid{root}~\ocwlowerid{roots\_usage}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{infos}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{""}~::~$\ocwlowerid{\_}~]~\rightarrow{}~\ocwupperid{True}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{attested}~\ocwlowerid{prev}~\ocwlowerid{root}~=~$\ocwbc{} prev is attested preverb sequence for root \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pvs}~=~\ocwlowerid{assoc\_word}~\ocwlowerid{root}~\ocwlowerid{roots\_usage}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{mem}~\ocwlowerid{prev}~\ocwlowerid{pvs}~$\ocwbc{} NB attested here means lexicalized entry \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Now we retrieve finer discrimination for verbs forms preceded by preverbs.
   This is experimental, and incurs too many conversions betweeen strings
   and words, suggesting a restructuring of preverbs representation. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{preverbs\_structure}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwupperid{Web.}\ocwlowerid{public\_preverbs\_file}~:~\ocwupperid{Deco.}\ocwlowerid{deco}~\ocwupperid{Word.}\ocwlowerid{word})~$\ocweol
\ocwindent{10.00em}
\ocwkw{with}~$[~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"preverbs\_structure"}~$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{gana\_o}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{None}~\rightarrow{}~0~$\ocwbc{} arbitrary \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Some}~\ocwlowerid{g}~\rightarrow{}~\ocwlowerid{g}~$\ocwbc{} only used for \ocwstring{"tap"} \ocwec{}\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{voice\_o}~\ocwlowerid{v}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{None}~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Some}~\ocwlowerid{voice}~\rightarrow{}~\ocwlowerid{voice}~=~\ocwlowerid{v}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} pvs is a list of preverb words \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} upasarga closest to the root form \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{main\_preverb}~\ocwlowerid{pvs}~=~\ocwupperid{List2.}\ocwlowerid{last}~\ocwlowerid{pvs}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{main\_preverb\_string}~\ocwlowerid{pv}~=~$\ocweol
\ocwindent{1.00em}
$\ocwupperid{Canon.}\ocwlowerid{decode}~(\ocwlowerid{main\_preverb}~(\ocwlowerid{assoc\_word}~\ocwlowerid{pv}~\ocwlowerid{preverbs\_structure}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{attested\_verb}~(\ocwlowerid{o\_gana},\ocwlowerid{o\_voice})~\ocwlowerid{pv}~\ocwlowerid{root}~=~\ocwlowerid{attested}~\ocwlowerid{pv}~\ocwlowerid{root}~\land{}~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gana}~=~\ocwlowerid{gana\_o}~\ocwlowerid{o\_gana}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{upasarga}~=~\ocwlowerid{main\_preverb\_string}~(\ocwupperid{Encode.}\ocwlowerid{code\_string}~\ocwlowerid{pv})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{pada}~=~\ocwupperid{Pada.}\ocwlowerid{voices\_of\_pv}~\ocwlowerid{upasarga}~\ocwlowerid{gana}~(\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{root})~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwlowerid{pada}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Pada.Ubha}~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{voice\_o}~\ocwlowerid{pada}~\ocwlowerid{o\_voice}~$\ocweol
\ocwindent{3.00em}
$]~$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwupperid{Pada.Unattested}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Similarly for root forms used without preverb \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{autonomous\_root}~(\ocwlowerid{o\_gana},\ocwlowerid{o\_voice})~\ocwlowerid{root}~=~\ocwlowerid{autonomous}~\ocwlowerid{root}~\land{}~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gana}~=~\ocwlowerid{gana\_o}~\ocwlowerid{o\_gana}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{pada}~=~\ocwupperid{Pada.}\ocwlowerid{voices\_of\_pv}~$\ocwstring{""}~$\ocwlowerid{gana}~(\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{root})~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwlowerid{pada}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Pada.Ubha}~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{voice\_o}~\ocwlowerid{pada}~\ocwlowerid{o\_voice}~$\ocweol
\ocwindent{3.00em}
$]~$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwupperid{Pada.Unattested}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pada\_of\_voice}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Active}~\rightarrow{}~\ocwupperid{Some}~\ocwupperid{Pada.Para}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Middle}~\rightarrow{}~\ocwupperid{Some}~\ocwupperid{Pada.Atma}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{None}~$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Unvoiced}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{extract\_gana\_pada}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Verb\_form}~(\ocwlowerid{conj},\ocwlowerid{paradigm})~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~$\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$(\ocwlowerid{o\_gana},\ocwlowerid{voice})~=~$\ocwkw{match}~$\ocwlowerid{paradigm}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~\ocwupperid{Presenta}~\ocwlowerid{g}~\ocwlowerid{\_}~\rightarrow{}~(\ocwupperid{Some}~\ocwlowerid{g},\ocwupperid{Active})$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwupperid{Presentm}~\ocwlowerid{g}~\ocwlowerid{\_}~\rightarrow{}~(\ocwupperid{Some}~\ocwlowerid{g},\ocwupperid{Middle})$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwupperid{Presentp}~\ocwlowerid{\_}~\rightarrow{}~(\ocwupperid{None},\ocwupperid{Passive})$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwupperid{Conjug}~\ocwlowerid{\_}~\ocwlowerid{v}~\mid{}~\ocwupperid{Perfut}~\ocwlowerid{v}~\rightarrow{}~(\ocwupperid{None},\ocwlowerid{v})$\ocweol
\ocwindent{5.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
$(\ocwlowerid{conj},(\ocwlowerid{o\_gana},\ocwlowerid{pada\_of\_voice}~\ocwlowerid{voice}))$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind\_verb}~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Unvoiced}~$\ocwbc{} could be refined \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unexpected\ocwvspace{}root\ocwvspace{}form"}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{extract\_gana\_pada\_k}~\ocwlowerid{krit}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$(\ocwlowerid{o\_gana},\ocwlowerid{voice})~=~$\ocwkw{match}~$\ocwlowerid{krit}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Ppp}~\mid{}~\ocwupperid{Pprp}~\mid{}~\ocwupperid{Pfutp}~\ocwlowerid{\_}~\rightarrow{}~(\ocwupperid{None},\ocwupperid{Passive})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Pppa}~\mid{}~\ocwupperid{Ppfta}~\mid{}~\ocwupperid{Pfuta}~\rightarrow{}~(\ocwupperid{None},\ocwupperid{Active})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Ppftm}~\mid{}~\ocwupperid{Pfutm}~\rightarrow{}~(\ocwupperid{None},\ocwupperid{Middle})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Ppra}~\ocwlowerid{g}~\rightarrow{}~(\ocwupperid{Some}~\ocwlowerid{g},\ocwupperid{Active})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Pprm}~\ocwlowerid{g}~\rightarrow{}~(\ocwupperid{Some}~\ocwlowerid{g},\ocwupperid{Middle})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Unvoiced}~$\ocwbc{} could be refined \ocwec{}\ocweol
\ocwindent{3.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$(\ocwlowerid{o\_gana},\ocwlowerid{pada\_of\_voice}~\ocwlowerid{voice})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fail\_inconsistency}~\ocwlowerid{form}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~($\ocwstring{"Unknown\ocwvspace{}root\ocwvspace{}form:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{form}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{valid\_morph\_pv}~\ocwlowerid{pv}~\ocwlowerid{root}~(\ocwlowerid{morph}~:~\ocwupperid{Morphology.}\ocwlowerid{inflexion\_tag})~=~$\ocwkw{try}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{conj},\ocwlowerid{gana\_pada})~=~\ocwlowerid{extract\_gana\_pada}~\ocwlowerid{morph}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{conj}=\ocwupperid{Primary}~$\ocwkw{then}~$\ocwlowerid{attested\_verb}~\ocwlowerid{gana\_pada}~\ocwlowerid{pv}~\ocwlowerid{root}~$\ocwkw{else}~$\ocwlowerid{attested}~\ocwlowerid{pv}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwupperid{Unvoiced}~\rightarrow{}~\ocwlowerid{attested}~\ocwlowerid{pv}~\ocwlowerid{root}~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{valid\_morph\_aut}~\ocwlowerid{root}~(\ocwlowerid{morph}~:~\ocwupperid{Morphology.}\ocwlowerid{inflexion\_tag})~=~$\ocwkw{try}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{conj},\ocwlowerid{gana\_pada})~=~\ocwlowerid{extract\_gana\_pada}~\ocwlowerid{morph}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{conj}=\ocwupperid{Primary}~$\ocwkw{then}~$\ocwlowerid{autonomous\_root}~\ocwlowerid{gana\_pada}~\ocwlowerid{root}~$\ocweol
\ocwindent{9.00em}
\ocwkw{else}~$\ocwlowerid{autonomous}~\ocwlowerid{root}~$\ocwbc{} eg. kalpaya Para ca. while k.lp Atma \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwupperid{Unvoiced}~\rightarrow{}~\ocwlowerid{autonomous}~\ocwlowerid{root}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{valid\_morph\_pv\_k}~\ocwlowerid{pv}~\ocwlowerid{krit\_stem}~\ocwlowerid{morph}~=~$\ocwbc{} morph of form \ocwbegindcode{}$\ocwupperid{Part\_form}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{homo},\ocwlowerid{bare\_stem})~=~\ocwlowerid{homo\_undo}~\ocwlowerid{krit\_stem}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{krit\_infos}~=~\ocwlowerid{assoc\_word}~\ocwlowerid{bare\_stem}~\ocwlowerid{unique\_kridantas}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$((\ocwlowerid{conj},\ocwlowerid{krit}),\ocwlowerid{root})~=~\ocwlowerid{look\_up\_homo}~\ocwlowerid{homo}~\ocwlowerid{krit\_infos}~$\ocwkw{in}~\ocwkw{try}\ocweol
\ocwindent{1.00em}
\ocwbc{} Asymmetry of treatment: conj is deduced from \ocwbegindcode{}$\ocwlowerid{krit\_stem}$\ocwenddcode{}, not from morph \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gana\_pada}~=~\ocwlowerid{extract\_gana\_pada\_k}~\ocwlowerid{krit}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{conj}=\ocwupperid{Primary}~$\ocwkw{then}~$\ocwlowerid{attested\_verb}~\ocwlowerid{gana\_pada}~\ocwlowerid{pv}~\ocwlowerid{root}~$\ocwkw{else}~$\ocwlowerid{attested}~\ocwlowerid{pv}~\ocwlowerid{root}~$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwupperid{Unvoiced}~\rightarrow{}~\ocwlowerid{attested}~\ocwlowerid{pv}~\ocwlowerid{root}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{validate\_pv}~\ocwlowerid{pv}~\ocwlowerid{root\_form}~=~$\ocwbc{} generalizes \ocwbegindcode{}$\ocwlowerid{roots\_of}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{root\_form}~\ocwlowerid{morpho.}\ocwlowerid{roots}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{fail\_inconsistency}~\ocwlowerid{root\_form}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{tags}~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{exists}~\ocwlowerid{valid}~\ocwlowerid{tags}~$\ocweol
\ocwindent{7.00em}
\ocwbc{} NB later on the lexer will refine in filtering validity \ocwec{}\ocweol
\ocwindent{7.00em}
$\ocwlowerid{where}~\ocwlowerid{valid}~(\ocwlowerid{delta},\ocwlowerid{morphs})~=~$\ocweol
\ocwindent{8.00em}
\ocwkw{let}~$\ocwlowerid{root}~=~\ocwupperid{Word.}\ocwlowerid{patch}~\ocwlowerid{delta}~\ocwlowerid{root\_form}~$\ocwkw{in}~\ocweol
\ocwindent{8.00em}
$\ocwupperid{List.}\ocwlowerid{exists}~(\ocwlowerid{valid\_morph\_pv}~\ocwlowerid{pv}~\ocwlowerid{root})~\ocwlowerid{morphs}$\ocweol
\ocwindent{2.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{validate\_pv\_tu}~\ocwlowerid{pv}~\ocwlowerid{root\_form}~=~$\ocwbc{} special case infinitive forms in -tu \ocwec{}~\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{root\_form}~\ocwlowerid{morpho.}\ocwlowerid{inftu}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{fail\_inconsistency}~\ocwlowerid{root\_form}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{tags}~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{exists}~\ocwlowerid{valid}~\ocwlowerid{tags}~$\ocweol
\ocwindent{7.00em}
\ocwbc{} NB later on the lexer will refine in filtering validity \ocwec{}\ocweol
\ocwindent{7.00em}
$\ocwlowerid{where}~\ocwlowerid{valid}~(\ocwlowerid{delta},\ocwlowerid{morphs})~=~$\ocweol
\ocwindent{8.00em}
\ocwkw{let}~$\ocwlowerid{root}~=~\ocwupperid{Word.}\ocwlowerid{patch}~\ocwlowerid{delta}~\ocwlowerid{root\_form}~$\ocwkw{in}~\ocweol
\ocwindent{8.00em}
$\ocwupperid{List.}\ocwlowerid{exists}~(\ocwlowerid{valid\_morph\_pv}~\ocwlowerid{pv}~\ocwlowerid{root})~\ocwlowerid{morphs}$\ocweol
\ocwindent{2.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{validate\_pv\_k}~\ocwlowerid{pv}~\ocwlowerid{krit\_form}~(\ocwlowerid{delta},\ocwlowerid{\_})~=~$\ocwbc{} see \ocwbegindcode{}$\ocwupperid{Morpho}.\ocwlowerid{print\_inv\_morpho}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{krit\_stem}~=~\ocwupperid{Word.}\ocwlowerid{patch}~\ocwlowerid{delta}~\ocwlowerid{krit\_form}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{homo},\ocwlowerid{bare\_stem})~=~\ocwlowerid{homo\_undo}~\ocwlowerid{krit\_stem}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{krit\_infos}~=~\ocwlowerid{assoc\_word}~\ocwlowerid{bare\_stem}~\ocwlowerid{unique\_kridantas}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$((\ocwlowerid{conj},\ocwlowerid{krit}),\ocwlowerid{root})~=~\ocwlowerid{look\_up\_homo}~\ocwlowerid{homo}~\ocwlowerid{krit\_infos}~$\ocwkw{in}~\ocwkw{try}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gana\_pada}~=~\ocwlowerid{extract\_gana\_pada\_k}~\ocwlowerid{krit}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{conj}=\ocwupperid{Primary}~$\ocwkw{then}~$\ocwlowerid{attested\_verb}~\ocwlowerid{gana\_pada}~\ocwlowerid{pv}~\ocwlowerid{root}~$\ocwkw{else}~$\ocwlowerid{attested}~\ocwlowerid{pv}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwupperid{Unvoiced}~\rightarrow{}~\ocwlowerid{attested}~\ocwlowerid{pv}~\ocwlowerid{root}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We should verify aa- validation for phantomatic forms \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{autonomous\_form}~\ocwlowerid{root\_form}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{root\_form}~\ocwlowerid{morpho.}\ocwlowerid{roots}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{fail\_inconsistency}~\ocwlowerid{root\_form}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{tags}~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{exists}~\ocwlowerid{valid}~\ocwlowerid{tags}~$\ocwbc{} Lexer will filter later on \ocwec{}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{where}~\ocwlowerid{valid}~(\ocwlowerid{delta},\ocwlowerid{morphs})~=~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{root}~=~\ocwupperid{Word.}\ocwlowerid{patch}~\ocwlowerid{delta}~\ocwlowerid{root\_form}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwupperid{List.}\ocwlowerid{exists}~(\ocwlowerid{valid\_morph\_aut}~\ocwlowerid{root})~\ocwlowerid{morphs}~$\ocweol
\ocwindent{2.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} This allows to rule out ifc only kridantas even when root autonomous \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{filter\_out\_krit}~\ocwlowerid{krit}~\ocwlowerid{root}~=~$\ocwkw{match}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{root}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"i"}~$\mid{}~$\ocwstring{"dagh"}~$\rightarrow{}~\ocwlowerid{krit}~=~\ocwupperid{Ppp}~$\ocwbc{} -ita -daghna \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We should verify aa- validation for phantomatic forms \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{autonomous\_form\_k}~\ocwlowerid{krid\_form}~(\ocwlowerid{delta},\ocwlowerid{\_})~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwupperid{Word.}\ocwlowerid{patch}~\ocwlowerid{delta}~\ocwlowerid{krid\_form}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{homo},\ocwlowerid{bare\_stem})~=~\ocwlowerid{homo\_undo}~\ocwlowerid{stem}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{krid\_infos}~=~\ocwlowerid{assoc\_word}~\ocwlowerid{bare\_stem}~\ocwlowerid{unique\_kridantas}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$((\ocwlowerid{conj},\ocwlowerid{krit}),\ocwlowerid{root})~=~\ocwlowerid{look\_up\_homo}~\ocwlowerid{homo}~\ocwlowerid{krid\_infos}~$\ocwkw{in}~\ocwkw{try}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gana\_pada}~=~\ocwlowerid{extract\_gana\_pada\_k}~\ocwlowerid{krit}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{conj}=\ocwupperid{Primary}~$\ocwkw{then}~\ocwkw{if}~$\ocwlowerid{filter\_out\_krit}~\ocwlowerid{krit}~\ocwlowerid{root}~$\ocwkw{then}~$\ocwupperid{False}$\ocweol
\ocwindent{11.50em}
\ocwkw{else}~$\ocwlowerid{autonomous\_root}~\ocwlowerid{gana\_pada}~\ocwlowerid{root}~$\ocwkw{else}~$\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwupperid{Unvoiced}~\rightarrow{}~\ocwlowerid{autonomous}~\ocwlowerid{root}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Checks whether a verbal or participial form is attested/validated \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{valid\_morpho}~\ocwlowerid{gen}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{gen}~$\ocwkw{then}~$\ocwlowerid{valid\_morph\_pv\_k}~$\ocwkw{else}~$\ocwlowerid{valid\_morph\_pv}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} This inspects a multitag in order to filter out pv-inconsistent taggings. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} It is used by Interface and Lexer for Reader and Parser \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{trim\_tags}~\ocwlowerid{gen}~\ocwlowerid{form}~\ocwlowerid{pv}~\ocwlowerid{tags}~=~\ocwupperid{List.}\ocwlowerid{fold\_right}~\ocwlowerid{trim}~\ocwlowerid{tags}~[\,]$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{where}~\ocwlowerid{trim}~(\ocwlowerid{delta},\ocwlowerid{morphs})~\ocwlowerid{acc}~=~$\ocwbc{} tags : Morphology.multitag \ocwec{}~\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwupperid{Word.}\ocwlowerid{patch}~\ocwlowerid{delta}~\ocwlowerid{form}~$\ocwkw{in}~\ocwbc{} root or kridanta \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{valid\_pv}~=~\ocwlowerid{valid\_morpho}~\ocwlowerid{gen}~\ocwlowerid{pv}~\ocwlowerid{stem}~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{ok\_morphs}~=~\ocwupperid{List.}\ocwlowerid{filter}~\ocwlowerid{valid\_pv}~\ocwlowerid{morphs}~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{ok\_morphs}~=~[\,]~$\ocwkw{then}~$\ocwlowerid{acc}~$\ocwkw{else}~$[~(\ocwlowerid{delta},\ocwlowerid{ok\_morphs})~::~\ocwlowerid{acc}~]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Preventing overgeneration of forms \ocwstring{"sa"} and \ocwstring{"e.sa"} \Pan{6,1,132} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{not\_sa\_v}~=~$\ocwkw{fun}~\ocwbc{} Assumes next pada starts with a vowel \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[~(\ocwupperid{Pron},[~1;~48~],\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~$\ocwbc{} sa \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwupperid{Pron},[~1;~47;~10~],\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~$\ocwbc{} e.sa \ocwec{}~$\rightarrow{}~\ocwupperid{False}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sa\_before\_check}~\ocwlowerid{form}~=~$\ocwkw{fun}~\ocwbc{} Next pada should start with a consonant \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[~(\ocwupperid{Pron},[~1;~48~],\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~$\ocwbc{} sa \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwupperid{Pron},[~1;~47;~10~],\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~$\ocwbc{} e.sa \ocwec{}~$\rightarrow{}~\ocwupperid{Phonetics.}\ocwlowerid{consonant\_initial}~\ocwlowerid{form}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Similar to \ocwbegindcode{}$\ocwupperid{List2}.\ocwlowerid{subtract}$\ocwenddcode{} but raises Anomaly exception \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{chop}~\ocwlowerid{word}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{word}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{word}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~[~\ocwlowerid{c'}~::~\ocwlowerid{r'}~]~$\ocwkw{when}~$\ocwlowerid{c'}=\ocwlowerid{c}~\rightarrow{}~\ocwlowerid{chop}~\ocwlowerid{r'}~\ocwlowerid{r}$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"Wrong\ocwvspace{}transition\ocwvspace{}between\ocwvspace{}segments"}$)$\ocweol
\ocwindent{2.50em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sfx\_phase}~=~$\ocwkw{fun}~$[~\ocwupperid{Sfx}~\mid{}~\ocwupperid{Isfx}~\rightarrow{}~\ocwupperid{True}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{iic\_phase}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Iicv}~\mid{}~\ocwupperid{Iicc}~\mid{}~\ocwupperid{Iikv}~\mid{}~\ocwupperid{Iikc}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Comp}~(\ocwlowerid{\_},\ocwupperid{Iikv})~\ocwlowerid{\_}~\ocwlowerid{\_}~\mid{}~\ocwupperid{Comp}~(\ocwlowerid{\_},\ocwupperid{Iikc})~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{apply\_sandhi}~\ocwlowerid{rleft}~\ocwlowerid{right}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{ru},\ocwlowerid{v})~\rightarrow{}~$\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{rl}~=~\ocwlowerid{chop}~\ocwlowerid{rleft}~\ocwlowerid{ru}$\ocweol
\ocwindent{3.50em}
\ocwkw{and}~$\ocwlowerid{r}~=~\ocwlowerid{chop}~\ocwlowerid{right}~\ocwlowerid{v}~$\ocwkw{in}~$\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{rl}~(\ocwlowerid{w}~@~\ocwlowerid{r})$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Id}~\rightarrow{}~\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{rleft}~\ocwlowerid{right}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{validate}~:~\ocwlowerid{output}~\rightarrow{}~\ocwlowerid{output}$\ocwenddcode{} - dynamic consistency check in Segmenter.
   It refines the regular language of dispatch by contextual conditions
   expressing that preverbs are consistent with the following verbal form. 
   The forms are then compounded, otherwise rejected. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Things would be much simpler if we generated forms of verbs and kridantas
 with (only valid) preverbs attached, since this check would be unnecessary.
 On the other hand, we would have to solve the ihehi problem. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} A similar kind of aggregation is effected for a few generative taddhitas,
   but this is still experimental. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{validate}~\ocwlowerid{out}~=~$\ocwkw{match}~$\ocwlowerid{out}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~[\,]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwupperid{Root},\ocwlowerid{rev\_root\_form},\ocwlowerid{s})~::~[~(\ocwupperid{Pv},\ocwlowerid{prev},\ocwlowerid{sv})~::~\ocwlowerid{r}~]~]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{prev}~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv\_str}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{pv}~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{root\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_root\_form}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{validate\_pv}~\ocwlowerid{pv\_str}~\ocwlowerid{root\_form}~$\ocwkw{then}~\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{form}~=~\ocwlowerid{apply\_sandhi}~\ocwlowerid{prev}~\ocwlowerid{root\_form}~\ocwlowerid{sv}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{verb\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{form}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwbc{} We glue the two segments with a composite tag keeping information \ocwec{}\ocweol
\ocwindent{4.50em}
$[~(\ocwupperid{Comp}~(\ocwupperid{Pv},\ocwupperid{Root})~\ocwlowerid{pv}~\ocwlowerid{root\_form},\ocwlowerid{verb\_form},\ocwlowerid{s})~::~\ocwlowerid{r}~]~$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~$[\,]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwupperid{Root},\ocwlowerid{rev\_root\_form},\ocwlowerid{\_})~::~\ocwlowerid{next}~]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{root\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_root\_form}~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{autonomous\_form}~\ocwlowerid{root\_form}~\land{}~\ocwlowerid{sa\_before\_check}~\ocwlowerid{root\_form}~\ocwlowerid{next}$\ocweol
\ocwindent{3.00em}
\ocwkw{then}~$\ocwlowerid{out}~$\ocwkw{else}~$[\,]~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwupperid{Lopa},\ocwlowerid{rev\_lopa\_form},\ocwlowerid{s})~::~[~(\ocwupperid{Pv},\ocwlowerid{prev},\ocwlowerid{sv})~::~\ocwlowerid{r}~]~]~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{prev}~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv\_str}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{pv}~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{lopa\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_lopa\_form}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{root\_form}~=~$\ocwkw{match}~$\ocwlowerid{lopa\_form}~$\ocwkw{with}~\ocweol
\ocwindent{11.00em}
$[~[~-2~::~\ocwlowerid{rf}~]~\rightarrow{}~\ocwlowerid{rf}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Wrong\ocwvspace{}lopa\ocwvspace{}form"}~$]~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{validate\_pv}~\ocwlowerid{pv\_str}~\ocwlowerid{root\_form}~$\ocwkw{then}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{form}~=~\ocwlowerid{apply\_sandhi}~\ocwlowerid{prev}~\ocwlowerid{lopa\_form}~\ocwlowerid{sv}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{verb\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{form}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$[~(\ocwupperid{Comp}~(\ocwupperid{Pv},\ocwupperid{Lopa})~\ocwlowerid{pv}~\ocwlowerid{lopa\_form},\ocwlowerid{verb\_form},\ocwlowerid{s})~::~\ocwlowerid{r}~]~$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~$[\,]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwupperid{Lopa},\ocwlowerid{rev\_lopa\_form},\ocwlowerid{\_})~::~\ocwlowerid{next}~]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{lopa\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_lopa\_form}~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{autonomous\_form}~\ocwlowerid{lopa\_form}$\ocweol
\ocwindent{3.00em}
$\land{}~\ocwlowerid{sa\_before\_check}~\ocwlowerid{lopa\_form}~\ocwlowerid{next}$\ocweol
\ocwindent{3.00em}
\ocwkw{then}~$\ocwlowerid{out}~$\ocwkw{else}~$[\,]$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwbc{} infinitives in -tu with preverbs \ocwec{}\ocweol
\ocwindent{2.00em}
$[~(\ocwupperid{Inftu},\ocwlowerid{rev\_root\_form},\ocwlowerid{s})~::~[~(\ocwupperid{Pv},\ocwlowerid{prev},\ocwlowerid{sv})~::~\ocwlowerid{r}~]~]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{prev}~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv\_str}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{pv}~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{root\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_root\_form}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{validate\_pv\_tu}~\ocwlowerid{pv\_str}~\ocwlowerid{root\_form}~$\ocwkw{then}~\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{form}~=~\ocwlowerid{apply\_sandhi}~\ocwlowerid{prev}~\ocwlowerid{root\_form}~\ocwlowerid{sv}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{verb\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{form}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwbc{} We glue the two segments with a composite tag keeping information \ocwec{}\ocweol
\ocwindent{4.50em}
$[~(\ocwupperid{Comp}~(\ocwupperid{Pv},\ocwupperid{Inftu})~\ocwlowerid{pv}~\ocwlowerid{root\_form},\ocwlowerid{verb\_form},\ocwlowerid{s})~::~\ocwlowerid{r}~]~$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~$[\,]$\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwbc{} kridanta forms with preverbs \ocwec{}\ocweol
\ocwindent{2.50em}
$[~(\ocwlowerid{phk},\ocwlowerid{rev\_krid\_form},\ocwlowerid{s})~::~[~(\ocwlowerid{ph},\ocwlowerid{prev},\ocwlowerid{sv})~::~\ocwlowerid{r}~]~]~$\ocweol
\ocwindent{4.50em}
\ocwkw{when}~$\ocwlowerid{krid\_phase}~\ocwlowerid{phk}~\land{}~\ocwlowerid{preverb\_phase}~\ocwlowerid{ph}~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{prev}~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv\_str}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{pv}~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{krid\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_krid\_form}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{krid\_form}~\ocwlowerid{morpho.}\ocwlowerid{krids}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}krid\_form:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{krid\_form})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{tags}~\rightarrow{}~$\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{exists}~(\ocwlowerid{validate\_pv\_k}~\ocwlowerid{pv\_str}~\ocwlowerid{krid\_form})~\ocwlowerid{tags}~$\ocwkw{then}\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{form}~=~\ocwlowerid{apply\_sandhi}~\ocwlowerid{prev}~\ocwlowerid{krid\_form}~\ocwlowerid{sv}~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{cpd\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{form}~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
$[~(\ocwupperid{Comp}~(\ocwlowerid{ph},\ocwlowerid{phk})~\ocwlowerid{pv}~\ocwlowerid{krid\_form},\ocwlowerid{cpd\_form},\ocwlowerid{s})~::~\ocwlowerid{r}~]~$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~$[\,]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwupperid{Kriv},\ocwlowerid{rev\_krid\_form},\ocwlowerid{\_})~::~\ocwlowerid{next}~]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{krid\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_krid\_form}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{phantomatic}~\ocwlowerid{krid\_form}~$\ocwkw{then}~$\ocwlowerid{failwith}~$\ocwstring{"Kriv\ocwvspace{}phantom"}~\ocwkw{else}~\ocwbc{} PB \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{krid\_form}~\ocwlowerid{morpho.}\ocwlowerid{krids}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}krid\_form:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{krid\_form})~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{tags}~\rightarrow{}~$\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{exists}~(\ocwlowerid{autonomous\_form\_k}~\ocwlowerid{krid\_form})~\ocwlowerid{tags}~\land{}~\ocwlowerid{not\_sa\_v}~\ocwlowerid{next}$\ocweol
\ocwindent{8.00em}
\ocwkw{then}~$\ocwlowerid{out}~$\ocwkw{else}~$[\,]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwupperid{Kric},\ocwlowerid{rev\_krid\_form},\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{krid\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_krid\_form}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{krid\_form}~\ocwlowerid{morpho.}\ocwlowerid{krids}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}krid\_form:\ocwvspace{}"}~\^{}~$(\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{krid\_form}))$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{tags}~\rightarrow{}~$\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{exists}~(\ocwlowerid{autonomous\_form\_k}~\ocwlowerid{krid\_form})~\ocwlowerid{tags}$\ocweol
\ocwindent{8.00em}
\ocwkw{then}~$\ocwlowerid{out}~$\ocwkw{else}~$[\,]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.50em}
$\mid{}~$\ocwbc{} iic kridanta forms with preverbs \ocwec{}\ocweol
\ocwindent{2.50em}
$[~(\ocwlowerid{phk},\ocwlowerid{rev\_ikrid\_form},\ocwlowerid{s})~::~[~(\ocwlowerid{ph},\ocwlowerid{prev},\ocwlowerid{sv})~::~\ocwlowerid{r}~]~]~$\ocweol
\ocwindent{4.50em}
\ocwkw{when}~$\ocwlowerid{ikrid\_phase}~\ocwlowerid{phk}~\land{}~\ocwlowerid{preverb\_phase}~\ocwlowerid{ph}~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{prev}~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv\_str}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{pv}~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{ikrid\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_ikrid\_form}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{ikrid\_form}~\ocwlowerid{morpho.}\ocwlowerid{iiks}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}ikrid\_form:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{ikrid\_form})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{tags}~\rightarrow{}~$\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{exists}~(\ocwlowerid{validate\_pv\_k}~\ocwlowerid{pv\_str}~\ocwlowerid{ikrid\_form})~\ocwlowerid{tags}~$\ocwkw{then}\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{form}~=~\ocwlowerid{apply\_sandhi}~\ocwlowerid{prev}~\ocwlowerid{ikrid\_form}~\ocwlowerid{sv}~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{cpd\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{form}~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
$[~(\ocwupperid{Comp}~(\ocwlowerid{ph},\ocwlowerid{phk})~\ocwlowerid{pv}~\ocwlowerid{ikrid\_form},\ocwlowerid{cpd\_form},\ocwlowerid{s})~::~\ocwlowerid{r}~]~$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~$[\,]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwupperid{Iikv},\ocwlowerid{rev\_krid\_form},\ocwlowerid{\_})~::~\ocwlowerid{next}~]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{krid\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_krid\_form}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{krid\_form}~\ocwlowerid{morpho.}\ocwlowerid{iiks}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}krid\_form:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{krid\_form})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{tags}~\rightarrow{}~$\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{exists}~(\ocwlowerid{autonomous\_form\_k}~\ocwlowerid{krid\_form})~\ocwlowerid{tags}~\land{}~\ocwlowerid{not\_sa\_v}~\ocwlowerid{next}$\ocweol
\ocwindent{8.00em}
\ocwkw{then}~$\ocwlowerid{out}~$\ocwkw{else}~$[\,]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwupperid{Iikc},\ocwlowerid{rev\_krid\_form},\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{krid\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_krid\_form}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{krid\_form}~\ocwlowerid{morpho.}\ocwlowerid{iiks}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}krid\_form:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{krid\_form})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{tags}~\rightarrow{}~$\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{exists}~(\ocwlowerid{autonomous\_form\_k}~\ocwlowerid{krid\_form})~\ocwlowerid{tags}$\ocweol
\ocwindent{8.00em}
\ocwkw{then}~$\ocwlowerid{out}~$\ocwkw{else}~$[\,]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwbc{} vocative kridanta forms with preverbs \ocwec{}\ocweol
\ocwindent{2.00em}
$[~(\ocwlowerid{phk},\ocwlowerid{rev\_krid\_form},\ocwlowerid{s})~::~[~(\ocwlowerid{ph},\ocwlowerid{prev},\ocwlowerid{sv})~::~\ocwlowerid{r}~]~]~$\ocweol
\ocwindent{4.50em}
\ocwkw{when}~$\ocwlowerid{vkrid\_phase}~\ocwlowerid{phk}~\land{}~\ocwlowerid{preverb\_phase}~\ocwlowerid{ph}~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{prev}~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv\_str}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{pv}~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{krid\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_krid\_form}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{krid\_form}~\ocwlowerid{morpho.}\ocwlowerid{voks}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}krid\_form:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{krid\_form})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{tags}~\rightarrow{}~$\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{exists}~(\ocwlowerid{validate\_pv\_k}~\ocwlowerid{pv\_str}~\ocwlowerid{krid\_form})~\ocwlowerid{tags}~$\ocwkw{then}\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{form}~=~\ocwlowerid{apply\_sandhi}~\ocwlowerid{prev}~\ocwlowerid{krid\_form}~\ocwlowerid{sv}~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{cpd\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{form}~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
$[~(\ocwupperid{Comp}~(\ocwlowerid{ph},\ocwlowerid{phk})~\ocwlowerid{pv}~\ocwlowerid{krid\_form},\ocwlowerid{cpd\_form},\ocwlowerid{s})~::~\ocwlowerid{r}~]~$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~$[\,]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwupperid{Vokv},\ocwlowerid{rev\_krid\_form},\ocwlowerid{\_})~::~\ocwlowerid{next}~]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{krid\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_krid\_form}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{krid\_form}~\ocwlowerid{morpho.}\ocwlowerid{voks}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}krid\_form:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{krid\_form})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{tags}~\rightarrow{}~$\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{exists}~(\ocwlowerid{autonomous\_form\_k}~\ocwlowerid{krid\_form})~\ocwlowerid{tags}~\land{}~\ocwlowerid{not\_sa\_v}~\ocwlowerid{next}$\ocweol
\ocwindent{8.00em}
\ocwkw{then}~$\ocwlowerid{out}~$\ocwkw{else}~$[\,]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwupperid{Vokc},\ocwlowerid{rev\_krid\_form},\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{krid\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_krid\_form}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{krid\_form}~\ocwlowerid{morpho.}\ocwlowerid{voks}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}krid\_form:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{krid\_form})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{tags}~\rightarrow{}~$\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{exists}~(\ocwlowerid{autonomous\_form\_k}~\ocwlowerid{krid\_form})~\ocwlowerid{tags}$\ocweol
\ocwindent{8.00em}
\ocwkw{then}~$\ocwlowerid{out}~$\ocwkw{else}~$[\,]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwupperid{Lopak},\ocwlowerid{rev\_lopak\_form},\ocwlowerid{s})~::~[~(\ocwlowerid{ph},\ocwlowerid{prev},\ocwlowerid{sv})~::~\ocwlowerid{r}~]~]~$\ocweol
\ocwindent{4.00em}
\ocwkw{when}~$\ocwlowerid{preverb\_phase}~\ocwlowerid{ph}~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{prev}~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv\_str}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{pv}~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{lopak\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_lopak\_form}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{krid\_form}~=~$\ocwkw{match}~$\ocwlowerid{lopak\_form}~$\ocwkw{with}~\ocweol
\ocwindent{11.00em}
$[~[~-2~::~\ocwlowerid{rf}~]~\rightarrow{}~\ocwlowerid{rf}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Wrong\ocwvspace{}lopa\ocwvspace{}form"}~$]~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{krid\_form}~\ocwlowerid{morpho.}\ocwlowerid{lopaks}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}krid\_form:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{krid\_form})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{tags}~\rightarrow{}~$\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{exists}~(\ocwlowerid{validate\_pv\_k}~\ocwlowerid{pv\_str}~\ocwlowerid{krid\_form})~\ocwlowerid{tags}~$\ocwkw{then}\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{form}~=~\ocwlowerid{apply\_sandhi}~\ocwlowerid{prev}~\ocwlowerid{krid\_form}~\ocwlowerid{sv}~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{cpd\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{form}~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
$[~(\ocwupperid{Comp}~(\ocwlowerid{ph},\ocwupperid{Lopak})~\ocwlowerid{pv}~\ocwlowerid{krid\_form},\ocwlowerid{cpd\_form},\ocwlowerid{s})~::~\ocwlowerid{r}~]$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~$[\,]$\ocweol
\ocwindent{3.00em}
$]~\mid{}~[~(\ocwupperid{Peri},\ocwlowerid{rev\_peri\_form},\ocwlowerid{s})~::~[~(\ocwupperid{Pv},\ocwlowerid{prev},\ocwlowerid{sv})~::~\ocwlowerid{r}~]~]~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{prev}~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv\_str}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{pv}~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{peri\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_peri\_form}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{peri\_form}~\ocwlowerid{morpho.}\ocwlowerid{peris}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}peri\_form:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{peri\_form})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{tags}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{valid}~(\ocwlowerid{delta},\ocwlowerid{morphs})~=~$\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{root}~=~\ocwupperid{Word.}\ocwlowerid{patch}~\ocwlowerid{delta}~\ocwlowerid{peri\_form}~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
$\ocwlowerid{attested}~\ocwlowerid{pv\_str}~\ocwlowerid{root}~$\ocwkw{in}~\ocweol
\ocwindent{8.00em}
\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{exists}~\ocwlowerid{valid}~\ocwlowerid{tags}~$\ocwkw{then}\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{form}~=~\ocwlowerid{apply\_sandhi}~\ocwlowerid{prev}~\ocwlowerid{peri\_form}~\ocwlowerid{sv}~$\ocwkw{in}~\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{cpd\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{form}~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
$[~(\ocwupperid{Comp}~(\ocwupperid{Pv},\ocwupperid{Peri})~\ocwlowerid{pv}~\ocwlowerid{peri\_form},\ocwlowerid{cpd\_form},\ocwlowerid{s})~::~\ocwlowerid{r}~]$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~$[\,]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwupperid{Abso},\ocwlowerid{rev\_abso\_form},\ocwlowerid{s})~::~[~(\ocwupperid{Pv},\ocwlowerid{prev},\ocwlowerid{sv})~::~\ocwlowerid{r}~]~]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwbc{} Takes care of absolutives in -ya and of infinitives with preverbs \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{prev}~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{pv\_str}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{pv}~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{abso\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rev\_abso\_form}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{abso\_form}~\ocwlowerid{morpho.}\ocwlowerid{absya}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}abs\_form:\ocwvspace{}"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{abso\_form})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{tags}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{valid}~(\ocwlowerid{delta},\ocwlowerid{morphs})~=~$\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{root}~=~\ocwupperid{Word.}\ocwlowerid{patch}~\ocwlowerid{delta}~\ocwlowerid{abso\_form}~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
$\ocwlowerid{attested}~\ocwlowerid{pv\_str}~\ocwlowerid{root}~$\ocwkw{in}~\ocweol
\ocwindent{8.00em}
\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{exists}~\ocwlowerid{valid}~\ocwlowerid{tags}~$\ocwkw{then}\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{form}~=~\ocwlowerid{apply\_sandhi}~\ocwlowerid{prev}~\ocwlowerid{abso\_form}~\ocwlowerid{sv}~$\ocwkw{in}~\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{cpd\_form}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{form}~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
$[~(\ocwupperid{Comp}~(\ocwupperid{Pv},\ocwupperid{Abso})~\ocwlowerid{pv}~\ocwlowerid{abso\_form},\ocwlowerid{cpd\_form},\ocwlowerid{s})~::~\ocwlowerid{r}~]$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~$[\,]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
\ocwbc{} We now prevent overgeneration of forms \ocwstring{"sa"} and \ocwstring{"e.sa"} \Pan{6,1,132} \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~(\ocwlowerid{ph},\ocwlowerid{form},\ocwlowerid{\_})~::~[~(\ocwupperid{Pron},[~1;~48~],\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~]~$\ocwbc{} sa \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwlowerid{ph},\ocwlowerid{form},\ocwlowerid{\_})~::~[~(\ocwupperid{Pron},[~1;~47;~10~],\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~]~$\ocwbc{} e.sa \ocwec{}~$\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{consonant\_initial}~(\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{form})~$\ocweol
\ocwindent{3.00em}
\ocwkw{then}~$\ocwlowerid{out}~$\ocwkw{else}~$[\,]~$\ocweol
\ocwindent{0.00em}
\ocwbc{} Alternative: put infinitives in Root rather than Indecl+Abso 
 \ocwbegindcode{}$\mid{}~[~(\ocwupperid{Absc},\ocwlowerid{\_},\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~
~\mid{}~[~(\ocwupperid{Absv},\ocwlowerid{\_},\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{check}~\ocwlowerid{root}~\ocwlowerid{is}~\ocwlowerid{autonomous}~
~\ocwlowerid{idem}~$\ocwkw{for}~$\ocwlowerid{infinitives},~\ocwlowerid{but}~\ocwlowerid{they}~\ocwlowerid{need}~\ocwlowerid{their}~\ocwlowerid{own}~\ocwlowerid{phase}/\ocwlowerid{color}~\times{})
(\times{}~\ocwupperid{Finally}~\ocwlowerid{we}~\ocwlowerid{glue}~\ocwlowerid{taddita}~\ocwlowerid{suffix}~$\ocwstring{"forms"}~\ocwkw{to}~$\ocwlowerid{the}~\ocwlowerid{previous}~(\ocwlowerid{iic})~\ocwlowerid{segment}~\times{})
(\times{}~\ocwupperid{NB}~\ocwupperid{This}~\ocwlowerid{cumulates}~$\ocwkw{with}~$\ocwlowerid{the}~\ocwlowerid{preverb}~\ocwlowerid{glueing}~\ocwlowerid{but}~\lnot{}~$\ocwkw{with}~$\ocwlowerid{itself}~\times{})
~\mid{}~[~(\ocwlowerid{sfxph},\ocwlowerid{sfx},\ocwlowerid{s})~::~[~(\ocwlowerid{ph},\ocwlowerid{rstem},\ocwlowerid{sv})~::~\ocwlowerid{r}~]~]~$\ocwkw{when}~$\ocwlowerid{sfx\_phase}~\ocwlowerid{sfxph}~
~\land{}~\ocwlowerid{iic\_phase}~\ocwlowerid{ph}~\rightarrow{}
~$\ocwkw{let}~$\ocwlowerid{sfx\_form}~=~\ocwupperid{Word}.\ocwlowerid{mirror}~\ocwlowerid{sfx}~$\ocwkw{in}~
~\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwupperid{Word}.\ocwlowerid{mirror}~\ocwlowerid{rstem}~$\ocwkw{in}
~\ocwkw{let}~$\ocwlowerid{tad\_form}~=~\ocwupperid{Word}.\ocwlowerid{mirror}~(\ocwlowerid{apply\_sandhi}~\ocwlowerid{rstem}~\ocwlowerid{sfx\_form}~\ocwlowerid{sv})~$\ocwkw{in}
~[~$(\ocwupperid{Tad}~(\ocwlowerid{ph},\ocwlowerid{sfxph})~\ocwlowerid{stem}~\ocwlowerid{sfx\_form},\ocwlowerid{tad\_form},\ocwlowerid{s})~::~\ocwlowerid{r}~]
~\mid{}~[~(\ocwlowerid{phase},\ocwlowerid{\_},\ocwlowerid{\_})~::~[~(\ocwlowerid{pv},\ocwlowerid{\_},\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~]~$\ocwkw{when}~$\ocwlowerid{preverb\_phase}~\ocwlowerid{pv}~\rightarrow{}~
~$\ocwkw{let}~$\ocwlowerid{m}~=~$\ocwstring{"validate:\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_phase}~\ocwlowerid{pv}~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_phase}~\ocwlowerid{phase}~$\ocwkw{in}~
~$\ocwlowerid{raise}~(\ocwupperid{Control}.\ocwupperid{Anomaly}~\ocwlowerid{m})~(\times{}~\ocwlowerid{all}~\ocwlowerid{preverbs}~\ocwlowerid{ought}~$\ocwkw{to}~$\ocwlowerid{have}~\ocwlowerid{been}~\ocwlowerid{processed}~\times{})
(\times{}~[~\mid{}~[~(\ocwlowerid{pv},\ocwlowerid{\_},\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~$\ocwkw{when}~$\ocwlowerid{preverb\_phase}~\ocwlowerid{pv}~\rightarrow{}~\ocwlowerid{out}~]~\ocwlowerid{noop}
\ocwupperid{This}~\ocwlowerid{pv}~\ocwlowerid{is}~\lnot{}~\ocwlowerid{terminal},~$\ocwkw{and}~$\ocwlowerid{should}~\ocwlowerid{be}~\ocwlowerid{chopped}~\ocwlowerid{off}~\ocwlowerid{by}~\ocwlowerid{the}~\ocwlowerid{next}~\ocwlowerid{item}~\times{})~
~\mid{}~[~\ocwlowerid{\_}~::~[~(\ocwlowerid{\_},\ocwlowerid{w},\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~]~$\ocwkw{when}~$\ocwlowerid{phantomatic}~(\ocwupperid{Word}.\ocwlowerid{mirror}~\ocwlowerid{w})~\rightarrow{}~
~\ocwlowerid{raise}~(\ocwupperid{Control}.\ocwupperid{Anomaly}~$\ocwstring{"Bug\ocwvspace{}phantomatic\ocwvspace{}segment"}$)
~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{out}~(\times{}~\ocwlowerid{default}~\ocwlowerid{identity}~\times{})
~$\ocwenddcode{}
;\medskip

\label{dispatcher.ml:28975}%
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{color\_of\_phase}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Noun}~\mid{}~\ocwupperid{Noun2}~\mid{}~\ocwupperid{Lopak}~\mid{}~\ocwupperid{Nouc}~\mid{}~\ocwupperid{Nouv}~\mid{}~\ocwupperid{Kriv}~\mid{}~\ocwupperid{Kric}~\mid{}~\ocwupperid{Krid}~\mid{}~\ocwupperid{Auxik}~\mid{}~\ocwupperid{Kama}$\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwupperid{Cache}~\rightarrow{}~\ocwupperid{Deep\_sky}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pron}~\rightarrow{}~\ocwupperid{Light\_blue}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Root}~\mid{}~\ocwupperid{Auxi}~\mid{}~\ocwupperid{Lopa}~\rightarrow{}~\ocwupperid{Carmin}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inde}~\mid{}~\ocwupperid{Abso}~\mid{}~\ocwupperid{Absv}~\mid{}~\ocwupperid{Absc}~\mid{}~\ocwupperid{Ai}~\mid{}~\ocwupperid{Ani}~\rightarrow{}~\ocwupperid{Mauve}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiy}~\rightarrow{}~\ocwupperid{Lavender}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Avy}~\rightarrow{}~\ocwupperid{Magenta}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inftu}~\rightarrow{}~\ocwupperid{Salmon}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iic}~\mid{}~\ocwupperid{Iic2}~\mid{}~\ocwupperid{A}~\mid{}~\ocwupperid{An}~\mid{}~\ocwupperid{Iicv}~\mid{}~\ocwupperid{Iicc}~\mid{}~\ocwupperid{Iik}~\mid{}~\ocwupperid{Iikv}~\mid{}~\ocwupperid{Iikc}~\mid{}~\ocwupperid{Iiif}~$\ocweol
\ocwindent{4.00em}
$\rightarrow{}~\ocwupperid{Yellow}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Auxiick}~\mid{}~\ocwupperid{Iivv}~\mid{}~\ocwupperid{Iivc}~\mid{}~\ocwupperid{Peri}~\mid{}~\ocwupperid{Iiv}~\rightarrow{}~\ocwupperid{Orange}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Voca}~\mid{}~\ocwupperid{Vocv}~\mid{}~\ocwupperid{Vocc}~\mid{}~\ocwupperid{Inv}~\mid{}~\ocwupperid{Vok}~\mid{}~\ocwupperid{Vokv}~\mid{}~\ocwupperid{Vokc}~\rightarrow{}~\ocwupperid{Lawngreen}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ifc}~\mid{}~\ocwupperid{Ifc2}~\rightarrow{}~\ocwupperid{Cyan}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Unknown}~\rightarrow{}~\ocwupperid{Grey}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Comp}~(\ocwlowerid{\_},\ocwlowerid{ph})~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{color\_of\_phase}~\ocwlowerid{ph}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Tad}~(\ocwlowerid{\_},\ocwlowerid{ph})~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{ph}=\ocwupperid{Sfx}~$\ocwkw{then}~$\ocwupperid{Deep\_sky}~$\ocwkw{else}~$\ocwupperid{Yellow}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pv}~\mid{}~\ocwupperid{Pvk}~\mid{}~\ocwupperid{Pvkc}~\mid{}~\ocwupperid{Pvkv}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Illegal\ocwvspace{}preverb\ocwvspace{}segment"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Sfx}~\rightarrow{}~\ocwupperid{Deep\_sky}~$\ocwbc{} necessary for \ocwbegindcode{}$\ocwupperid{Lexer}.\ocwlowerid{print\_segment2}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Isfx}~\rightarrow{}~\ocwupperid{Yellow}~$\ocwbc{} idem \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\label{dispatcher.ml:29864}%
\ocwindent{0.00em}
\ocwkw{end};\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Segmenter.ml}
\ocwmodule{Segmenter}
\label{segmenter.ml:0}%
Sanskrit sentence segmenter - analyses (external) sandhi 
\ocweol
\ocwindent{0.00em}
Runs the segmenting transducer defined by parameter module \ocwbegindcode{}$\ocwupperid{Eilenberg}$\ocwenddcode{}. 
\ocweol
\ocwindent{0.00em}
Used by \ocwbegindcode{}$\ocwupperid{Lexer}$\ocwenddcode{}, and thus by \ocwbegindcode{}$\ocwupperid{Reader}$\ocwenddcode{} for segmenting, tagging and parsing. 
\ocweol
\ocwindent{0.00em}
Same logic as old \ocwbegindcode{}$\ocwupperid{Segmenter1}$\ocwenddcode{} but modular with multiple phases 
\ocweol
\ocwindent{0.00em}
Eilenberg is a finite Eilenberg machine, Control gives command parameters. 
\ocweol
\ocwindent{0.00em}
In the Sanskrit application, \ocwbegindcode{}$\ocwupperid{Word}.\ocwlowerid{word}$\ocwenddcode{} is (reverse of) inflected form. 
\ocweol
\ocwindent{0.00em}
Id means sandhi is optional. It is an optimisation, since it avoids 
   listing all identity sandhi rules such as \ocwbegindcode{}$\ocwlowerid{con}\mid{}\ocwlowerid{voy}~\rightarrow{}~\ocwlowerid{con}.\ocwlowerid{voy}$\ocwenddcode{}. 
   Such rules are nonetheless checked as legitimate. 
\ocweol
\ocwindent{0.00em}
NB. This segmenter is used by Reader and Parser, but not by Interface, that
uses \ocwbegindcode{}$\ocwupperid{Graph\_segmenter}$\ocwenddcode{} instead. 
\ocweol
\label{segmenter.ml:1383}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Auto};~$\ocwbc{} Auto \ocwec{}\medskip

\label{segmenter.ml:1406}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Segment}~$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Phases}:~$\ocwkw{sig}\ocweol
\ocwindent{4.50em}
\ocwkw{type}~$\ocwlowerid{phase}~$\ocweol
\ocwindent{4.50em}
\ocwkw{and}~$\ocwlowerid{phases}~=~$\ocwbt{list}~$\ocwlowerid{phase};$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{string\_of\_phase}~:~\ocwlowerid{phase}~\rightarrow{}~$\ocwbt{string};\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{aa\_phase}~:~\ocwlowerid{phase}~\rightarrow{}~\ocwlowerid{phase};$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{preverb\_phase}~:~\ocwlowerid{phase}~\rightarrow{}~$\ocwbt{bool};\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{ii\_phase}~:~\ocwlowerid{phase}~\rightarrow{}~$\ocwbt{bool};\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{un\_lopa}~:~\ocwlowerid{phase}~\rightarrow{}~\ocwlowerid{phase};$\ocweol
\ocwindent{4.50em}
\ocwkw{end}$)$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Eilenberg}:~$\ocwkw{sig}~\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{transducer}~:~\ocwupperid{Phases.}\ocwlowerid{phase}~\rightarrow{}~\ocwupperid{Auto.}\ocwlowerid{auto};$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{initial}~:~$\ocwbt{bool}~$\rightarrow{}~\ocwupperid{Phases.}\ocwlowerid{phases};$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{dispatch}~:~$\ocwbt{bool}~$\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~\ocwupperid{Phases.}\ocwlowerid{phase}~\rightarrow{}~\ocwupperid{Phases.}\ocwlowerid{phases};$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{accepting}~:~\ocwupperid{Phases.}\ocwlowerid{phase}~\rightarrow{}~$\ocwbt{bool};\ocweol
\ocwindent{4.50em}
\ocwkw{type}~$\ocwlowerid{input}~=~\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} input sentence represented as a word \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwkw{and}~$\ocwlowerid{transition}~=~$\ocwbc{} junction relation \ocwec{}\ocweol
\ocwindent{6.00em}
$[~\ocwupperid{Euphony}~$\ocwkw{of}~$\ocwupperid{Auto.}\ocwlowerid{rule}~$\ocwbc{} \ocwbegindcode{}$(\ocwlowerid{w},\ocwlowerid{rev}~\ocwlowerid{u},\ocwlowerid{v})$\ocwenddcode{} such that \ocwbegindcode{}$\ocwlowerid{u}\mid{}\ocwlowerid{v}~\rightarrow{}~\ocwlowerid{w}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Id}~$\ocwbc{} identity or no sandhi \ocwec{}\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{4.50em}
\ocwkw{and}~$\ocwlowerid{segment}~=~(\ocwupperid{Phases.}\ocwlowerid{phase}~\times{}~\ocwupperid{Word.}\ocwlowerid{word}~\times{}~\ocwlowerid{transition})$\ocweol
\ocwindent{4.50em}
\ocwkw{and}~$\ocwlowerid{output}~=~$\ocwbt{list}~$\ocwlowerid{segment};$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{validate}~:~\ocwlowerid{output}~\rightarrow{}~\ocwlowerid{output};~$\ocwbc{} consistency check / compress \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwkw{end}$)$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Control}:~$\ocwkw{sig}~$\ocwlowerid{value}~\ocwlowerid{star}~:~$\ocwbt{ref}~\ocwbt{bool};~\ocwbc{} chunk= if star then word+ else word \ocwec{}~\ocweol
\ocwindent{8.00em}
$\ocwlowerid{value}~\ocwlowerid{full}~:~$\ocwbt{ref}~\ocwbt{bool};~\ocwbc{} all kridantas and nan cpds if full \ocwec{}\ocweol
\ocwindent{6.00em}
\ocwkw{end}$)~$\ocweol
\ocwindent{1.00em}
=~\ocwkw{struct}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phases};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Eilenberg};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Control};$\medskip

\ocwendcode{}\ocwindent{0.00em}
The summarizing structure sharing sub-solutions 
\ocweol
\ocwindent{0.00em}
It represents the union of all solutions 
\ocweol
\label{segmenter.ml:2781}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{max\_input\_length}~=~600$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{phased\_padas}~=~(\ocwlowerid{phase}~\times{}~$\ocwbt{list}~$\ocwupperid{Word.}\ocwlowerid{word})~$\ocwbc{} padas of given phase \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{segments}~=~$\ocwbt{list}~$\ocwlowerid{phased\_padas}~$\ocwbc{} forgetting sandhi \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Checkpoints structure (sparse subgraph with mandatory positioned padas) \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{phased\_pada}~=~(\ocwlowerid{phase}~\times{}~\ocwupperid{Word.}\ocwlowerid{word})~$\ocwbc{} for checkpoints \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{check}~=~($\ocwbt{int}~$\times{}~\ocwlowerid{phased\_pada}~\times{}~$\ocwbt{bool}$)~$\ocwbc{} checkpoint validation \ocwec{}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{all\_checks}~=~$\ocwbt{ref}~$([\,]:~$\ocwbt{list}~$\ocwlowerid{check})~$\ocwbc{} checkpoints in rest of input \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{offset\_chunk}~=~$\ocwbt{ref}~0\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{segmentable\_chunk}~=~$\ocwbt{ref}~$\ocwupperid{False}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Used by \ocwbegindcode{}$\ocwupperid{Reader}.\ocwlowerid{segment\_chunks\_filter}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{set\_offset}~(\ocwlowerid{offset},\ocwlowerid{checkpoints})~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{offset\_chunk.}\ocwlowerid{val}~:=~\ocwlowerid{offset}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{all\_checks.}\ocwlowerid{val}~:=~\ocwlowerid{checkpoints}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} The offset permits to align the padas with the input string \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{offset}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},\ocwlowerid{v})~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{off}~=~$\ocwkw{if}~$\ocwlowerid{w}=[\,]~$\ocwkw{then}~1~\ocwbc{} amui/lopa from Lopa/Lopak \ocwec{}\ocweol
\ocwindent{11.00em}
\ocwkw{else}~$\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{w}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{off}~-~(\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{u}~+~\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{v})~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Id}~\rightarrow{}~0$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{contains}~\ocwlowerid{phase\_w}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwlowerid{phase},\ocwlowerid{word},\ocwlowerid{\_})~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{phase\_w}=(\ocwlowerid{phase},\ocwlowerid{word})~\lor{}~\ocwlowerid{contains}~\ocwlowerid{phase\_w}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} This validation comes from the Summarize mode, which sets checkpoints that
   have to be verified for each solution. This is probably temporary, 
   \ocwbegindcode{}$\ocwlowerid{solution}$\ocwenddcode{} ought to be checked progressively by \ocwbegindcode{}$\ocwlowerid{react}$\ocwenddcode{}, 
   with proper pruning of backtracking. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{check\_chunk}~\ocwlowerid{solution}~=~$\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$\ocwlowerid{position}~=~\ocwlowerid{offset\_chunk.}\ocwlowerid{val}~$\ocweol
\ocwindent{1.50em}
\ocwkw{and}~$\ocwlowerid{checkpoints}~=~\ocwlowerid{all\_checks.}\ocwlowerid{val}~$\ocwkw{in}\ocweol
\ocwindent{1.50em}
$\ocwlowerid{check\_rec}~\ocwlowerid{position}~(\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{solution})~\ocwlowerid{checkpoints}$\ocweol
\ocwindent{2.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{check\_rec}~\ocwlowerid{index}~\ocwlowerid{sol}~\ocwlowerid{checks}~=~$\ocwkw{match}~$\ocwlowerid{checks}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{True}~$\ocwbc{} all checkpoints verified \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~(\ocwlowerid{pos},\ocwlowerid{phase\_word},\ocwlowerid{select})~::~\ocwlowerid{more}~]~\rightarrow{}~$\ocweol
\ocwindent{5.00em}
\ocwbc{} select=True for check \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{index}~>~\ocwlowerid{pos}~$\ocwkw{then}~\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{select}~$\ocwkw{then}~$\ocwupperid{False}~$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~$\ocwlowerid{check\_rec}~\ocwlowerid{index}~\ocwlowerid{sol}~\ocwlowerid{more}~$\ocwbc{} checkpoint missed \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{sol}~$\ocwkw{with}~\ocweol
\ocwindent{5.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{True}~$\ocwbc{} checkpoint relevant for later chunks \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~[~(\ocwlowerid{phase},\ocwlowerid{word},\ocwlowerid{sandhi})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{7.00em}
\ocwkw{let}~$\ocwlowerid{next\_index}~=~\ocwlowerid{index}~+~\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{word}~+~\ocwlowerid{offset}~\ocwlowerid{sandhi}~$\ocwkw{in}\ocweol
\ocwindent{7.00em}
\ocwkw{if}~$\ocwlowerid{index}~<~\ocwlowerid{pos}~$\ocwkw{then}~$\ocwlowerid{check\_rec}~\ocwlowerid{next\_index}~\ocwlowerid{rest}~\ocwlowerid{checks}~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~\ocwkw{let}~$(\ocwlowerid{nxt\_ind},\ocwlowerid{ind\_sols},\ocwlowerid{next\_sols})~=~\ocwlowerid{all\_sol\_seg\_ind}~[\,]~\ocwlowerid{sol}$\ocweol
\ocwindent{8.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{all\_sol\_seg\_ind}~\ocwlowerid{stack}~=~$\ocwkw{fun}\ocweol
\ocwindent{8.50em}
$[~[\,]~\rightarrow{}~(\ocwlowerid{next\_index},\ocwlowerid{stack},[\,])$\ocweol
\ocwindent{8.50em}
$\mid{}~[~((\ocwlowerid{phase2},\ocwlowerid{word2},\ocwlowerid{sandhi2})~$\ocwkw{as}~$\ocwlowerid{seg2})~::~\ocwlowerid{rest2}~]~\rightarrow{}~$\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{next\_index}~=~\ocwlowerid{pos}~+~\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{word2}~+~\ocwlowerid{offset}~\ocwlowerid{sandhi2}~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
\ocwkw{if}~$\ocwlowerid{next\_index}=\ocwlowerid{pos}~$\ocwkw{then}~$\ocwlowerid{all\_sol\_seg\_ind}~[~\ocwlowerid{seg2}~::~\ocwlowerid{stack}~]~\ocwlowerid{rest2}$\ocweol
\ocwindent{9.50em}
\ocwkw{else}~$(\ocwlowerid{next\_index},[\ocwlowerid{seg2}~::~\ocwlowerid{stack}],\ocwlowerid{rest2})$\ocweol
\ocwindent{8.50em}
$]$\ocweol
\ocwindent{7.00em}
\ocwkw{and}~$(\ocwlowerid{ind\_check},\ocwlowerid{next\_check})~=~\ocwlowerid{all\_check\_ind}~[\,]~\ocwlowerid{checks}$\ocweol
\ocwindent{7.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{all\_check\_ind}~\ocwlowerid{stack}~=~$\ocwkw{fun}\ocweol
\ocwindent{8.00em}
$[~[\,]~\rightarrow{}~(\ocwlowerid{stack},[\,])$\ocweol
\ocwindent{8.00em}
$\mid{}~([~(\ocwlowerid{pos2},\ocwlowerid{phase\_word2},\ocwlowerid{select2})~::~\ocwlowerid{more2}~]~$\ocwkw{as}~$\ocwlowerid{orig})~\rightarrow{}$\ocweol
\ocwindent{9.50em}
\ocwkw{if}~$\ocwlowerid{pos2}=\ocwlowerid{pos}~$\ocwkw{then}~\ocweol
\ocwindent{11.00em}
$\ocwlowerid{all\_check\_ind}~[~(\ocwlowerid{pos2},\ocwlowerid{phase\_word2},\ocwlowerid{select2})~::~\ocwlowerid{stack}~]~\ocwlowerid{more2}$\ocweol
\ocwindent{9.50em}
\ocwkw{else}~$(\ocwlowerid{stack},\ocwlowerid{orig})$\ocweol
\ocwindent{8.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{7.00em}
$\ocwlowerid{check\_sols}~\ocwlowerid{ind\_sols}~\ocwlowerid{ind\_check}$\ocweol
\ocwindent{7.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{check\_sols}~\ocwlowerid{solspt}~=~$\ocwkw{fun}\ocweol
\ocwindent{8.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{check\_rec}~\ocwlowerid{nxt\_ind}~\ocwlowerid{next\_sols}~\ocwlowerid{next\_check}~$\ocweol
\ocwindent{8.00em}
$\mid{}~[~(\ocwlowerid{pos2},\ocwlowerid{phase\_word2},\ocwlowerid{select2})~::~\ocwlowerid{more2}~]~\rightarrow{}~$\ocweol
\ocwindent{10.00em}
$(\ocwlowerid{select2}=\ocwlowerid{contains}~\ocwlowerid{phase\_word2}~\ocwlowerid{solspt})$\ocweol
\ocwindent{10.00em}
\ocwbc{} Boolean select2 should be consistent with the solutions \ocwec{}\ocweol
\ocwindent{10.00em}
$\land{}~\ocwlowerid{check\_sols}~\ocwlowerid{solspt}~\ocwlowerid{more2}$\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{3.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Checking for legitimate Id sandhi 
\ocweol
\ocwindent{0.00em}
Uses \ocwbegindcode{}$\ocwlowerid{sandhis\_id}$\ocwenddcode{} computed by \ocwbegindcode{}$\ocwupperid{Compile\_sandhi}$\ocwenddcode{} 
\ocweol
\ocwindent{0.00em}
This is used to check legitimate Id sandhi. 
\ocweol
\label{segmenter.ml:6373}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{allowed\_trans}~=$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwupperid{Web.}\ocwlowerid{public\_sandhis\_id\_file}~:~\ocwupperid{Deco.}\ocwlowerid{deco}~\ocwupperid{Word.}\ocwlowerid{word})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{check\_id\_sandhi}~\ocwlowerid{revl}~\ocwlowerid{first}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{match\_right}~\ocwlowerid{allowed}~=~\lnot{}~(\ocwupperid{List.}\ocwlowerid{mem}~[~\ocwlowerid{first}~]~\ocwlowerid{allowed})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{try}~\ocwkw{match}~$\ocwlowerid{revl}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~\ocwlowerid{last}~::~\ocwlowerid{before}~]~\rightarrow{}~$\ocweol
\ocwindent{5.00em}
$(\ocwupperid{Phonetics.}\ocwlowerid{n\_or\_f}~\ocwlowerid{last}~\land{}~\ocwupperid{Phonetics.}\ocwlowerid{vowel}~\ocwlowerid{first})~\lor{}$\ocweol
\ocwindent{5.00em}
\ocwbc{} we allow an-s transition with s vowel-initial, ignoring nn rules \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwbc{} this is necessary not to block transitions from the An phase \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{let}~$\ocwlowerid{allowed1}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~[~\ocwlowerid{last}~]~\ocwlowerid{allowed\_trans}~$\ocwkw{in}\ocweol
\ocwindent{5.00em}
\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{match\_right}~\ocwlowerid{allowed1}~$\ocweol
\ocwindent{6.50em}
$\mid{}~[~\ocwlowerid{penu}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocweol
\ocwindent{7.50em}
\ocwkw{let}~$\ocwlowerid{allowed2}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~[~\ocwlowerid{last}~::~[~\ocwlowerid{penu}~]~]~\ocwlowerid{allowed\_trans}~$\ocwkw{in}\ocweol
\ocwindent{7.50em}
$\ocwlowerid{match\_right}~\ocwlowerid{allowed2}~\land{}~\ocwlowerid{match\_right}~\ocwlowerid{allowed1}~$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwupperid{Not\_found}~\rightarrow{}~\ocwupperid{True}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Examples: 
   \ocwbegindcode{}\ocwkw{let}~$\ocwlowerid{st1}~=~\ocwupperid{Encode}.\ocwlowerid{code\_revstring}~$\ocwstring{"raamas"}
~\ocwkw{and}~$\ocwlowerid{st2}~=~\ocwupperid{Encode}.\ocwlowerid{code\_string}~$\ocwstring{"asti"}~\ocwkw{in}
~$\ocwlowerid{check\_id\_sandhi}~\ocwlowerid{st1}~\ocwlowerid{st2}~=~\ocwupperid{False}
~\land{}~$\ocwkw{let}~$\ocwlowerid{st1}~=~\ocwupperid{Encode}.\ocwlowerid{code\_revstring}~$\ocwstring{"raamaa"}~
~\ocwkw{and}~$\ocwlowerid{st2}~=~\ocwupperid{Encode}.\ocwlowerid{code\_string}~$\ocwstring{"arati"}~\ocwkw{in}
~$\ocwlowerid{check\_id\_sandhi}~\ocwlowerid{st1}~\ocwlowerid{st2}~=~\ocwupperid{False}
~\land{}~$\ocwkw{let}~$\ocwlowerid{st1}~=~\ocwupperid{Encode}.\ocwlowerid{code\_revstring}~$\ocwstring{"phalam"}~
~\ocwkw{and}~$\ocwlowerid{st2}~=~\ocwupperid{Encode}.\ocwlowerid{code\_string}~$\ocwstring{"icchaami"}~\ocwkw{in}
~$\ocwlowerid{check\_id\_sandhi}~\ocwlowerid{st1}~\ocwlowerid{st2}~=~\ocwupperid{True}$\ocwenddcode{}
\ocwec{}\medskip

\label{segmenter.ml:7610}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sandhi\_aa}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~48;~1~]~\rightarrow{}~[~1;~2~]~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{a}.\ocwlowerid{h}~\mid{}~\ocwlowerid{aa}~\rightarrow{}~\ocwlowerid{a\_aa}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~[~43;~1~]~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{code\_string}~$\ocwstring{"araa"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{ar}~\mid{}~\ocwlowerid{aa}~\rightarrow{}~\ocwlowerid{araa}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~1~\mid{}~2~\rightarrow{}~[~2~]$\ocweol
\ocwindent{6.50em}
$\mid{}~3~\mid{}~4~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{code\_string}~$\ocwstring{"yaa"}\ocweol
\ocwindent{6.50em}
$\mid{}~5~\mid{}~6~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{code\_string}~$\ocwstring{"vaa"}\ocweol
\ocwindent{6.50em}
$\mid{}~7~\mid{}~8~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{code\_string}~$\ocwstring{"raa"}\ocweol
\ocwindent{6.50em}
$\mid{}~9~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{code\_string}~$\ocwstring{"laa"}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwupperid{Phonetics.}\ocwlowerid{voiced}~\ocwlowerid{c};~2~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"sandhi\_aa"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Expands phantom-initial or lopa-initial segments \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} NB phase \ocwbegindcode{}$(\ocwlowerid{aa\_phase}~\ocwlowerid{ph})$\ocwenddcode{} of \ocwstring{"aa"} is Pv for verbal ph, Pvkv for nominal ones \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{accrue}~((\ocwlowerid{ph},\ocwlowerid{revword},\ocwlowerid{rule})~$\ocwkw{as}~$\ocwlowerid{segment})~\ocwlowerid{previous\_segments}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{revword}~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~$\ocwbc{} First Lopa \ocwec{}\ocweol
\ocwindent{2.00em}
$[~-2~$\ocwbc{} \ocwbegindcode{}-\ocwenddcode{} \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{previous\_segments}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[~(\ocwlowerid{phase},\ocwlowerid{pv},\ocwupperid{Euphony}~([\,],\ocwlowerid{u},[-2]))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwbc{} phase=Pv,Pvkv,Pvkc \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{let}~$\ocwlowerid{v}~=~$\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}~$[~[~10~$\ocwbc{} e \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~[~10~]~$\ocweol
\ocwindent{15.50em}
$\mid{}~[~12~$\ocwbc{} o \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~[~12~]$\ocweol
\ocwindent{15.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}~\ocweol
\ocwindent{15.50em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{5.00em}
\ocwbc{} u is \ocwbegindcode{}~$\ocwlowerid{a}~$\ocwenddcode{} or \ocwbegindcode{}~$\ocwlowerid{aa}~$\ocwenddcode{}, v is \ocwbegindcode{}~$\ocwlowerid{e}~$\ocwenddcode{} or \ocwbegindcode{}~$\ocwlowerid{o}~$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{5.00em}
$[~\ocwlowerid{un\_lopa\_segment}~::~[~(\ocwlowerid{phase},\ocwlowerid{pv},\ocwupperid{Euphony}~(\ocwlowerid{v},\ocwlowerid{u},\ocwlowerid{v}~))~::~\ocwlowerid{rest}~]~]$\ocweol
\ocwindent{6.00em}
$\ocwlowerid{where}~\ocwlowerid{un\_lopa\_segment}~=~(\ocwlowerid{un\_lopa}~\ocwlowerid{ph},\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{r},\ocwlowerid{rule})~$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.50em}
\ocwbc{} Then phantom phonemes \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~[~-3~$\ocwbc{} *a \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{previous\_segments}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{\_},\ocwlowerid{u},[-3]))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{w}~=\ocwlowerid{sandhi\_aa}~\ocwlowerid{u}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$[~\ocwlowerid{new\_segment}~::~[~(\ocwlowerid{aa\_phase}~\ocwlowerid{ph},[~2~],\ocwupperid{Euphony}~([~2~],[~2~],[~1~]~))~$\ocweol
\ocwindent{11.50em}
::~$[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},[~2~]))~::~\ocwlowerid{rest}~]~]~]$\ocweol
\ocwindent{5.50em}
$\ocwlowerid{where}~\ocwlowerid{new\_segment}~=~(\ocwlowerid{ph},\ocwupperid{Word.}\ocwlowerid{mirror}~[~1~::~\ocwlowerid{r}~],\ocwlowerid{rule})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~-9~$\ocwbc{} *A \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{previous\_segments}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{\_},\ocwlowerid{u},[-9]))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{w}~=\ocwlowerid{sandhi\_aa}~\ocwlowerid{u}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$[~\ocwlowerid{new\_segment}~::~[~(\ocwlowerid{aa\_phase}~\ocwlowerid{ph},[~2~],\ocwupperid{Euphony}~([~2~],[~2~],[~2~]~))~$\ocweol
\ocwindent{11.50em}
::~$[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},[~2~]))~::~\ocwlowerid{rest}~]~]~]$\ocweol
\ocwindent{5.50em}
$\ocwlowerid{where}~\ocwlowerid{new\_segment}~=~(\ocwlowerid{ph},\ocwupperid{Word.}\ocwlowerid{mirror}~[~2~::~\ocwlowerid{r}~],\ocwlowerid{rule})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~-4~$\ocwbc{} *i \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{previous\_segments}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{\_},\ocwlowerid{u},[~-4~]))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{w}~=\ocwlowerid{sandhi\_aa}~\ocwlowerid{u}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$[~\ocwlowerid{new\_segment}~::~[~(\ocwlowerid{aa\_phase}~\ocwlowerid{ph},[~2~],\ocwupperid{Euphony}~([~10~],[~2~],[~3~]~))~$\ocweol
\ocwindent{11.50em}
::~$[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},[~2~]))~::~\ocwlowerid{rest}~]~]~]$\ocweol
\ocwindent{5.50em}
$\ocwlowerid{where}~\ocwlowerid{new\_segment}~=~(\ocwlowerid{ph},\ocwupperid{Word.}\ocwlowerid{mirror}~[~3~::~\ocwlowerid{r}~],\ocwlowerid{rule})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~-7~$\ocwbc{} *I \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{previous\_segments}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{\_},\ocwlowerid{u},[~-7~]))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{w}~=\ocwlowerid{sandhi\_aa}~\ocwlowerid{u}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$[~\ocwlowerid{new\_segment}~::~[~(\ocwlowerid{aa\_phase}~\ocwlowerid{ph},[~2~],\ocwupperid{Euphony}~([~10~],[~2~],[~4~]~))~$\ocweol
\ocwindent{11.50em}
::~$[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},[~2~]))~::~\ocwlowerid{rest}~]~]~]$\ocweol
\ocwindent{5.50em}
$\ocwlowerid{where}~\ocwlowerid{new\_segment}~=~(\ocwlowerid{ph},\ocwupperid{Word.}\ocwlowerid{mirror}~[~4~::~\ocwlowerid{r}~],\ocwlowerid{rule})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~-5~$\ocwbc{} *u \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{previous\_segments}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{\_},\ocwlowerid{u},[~-5~]))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{w}~=\ocwlowerid{sandhi\_aa}~\ocwlowerid{u}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$[~\ocwlowerid{new\_segment}~::~[~(\ocwlowerid{aa\_phase}~\ocwlowerid{ph},[~2~],\ocwupperid{Euphony}~([~12~],[~2~],[~5~]~))~$\ocweol
\ocwindent{11.50em}
::~$[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},[~2~]))~::~\ocwlowerid{rest}~]~]~]$\ocweol
\ocwindent{5.50em}
$\ocwlowerid{where}~\ocwlowerid{new\_segment}~=~(\ocwlowerid{ph},\ocwupperid{Word.}\ocwlowerid{mirror}~[~5~::~\ocwlowerid{r}~],\ocwlowerid{rule})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~-8~$\ocwbc{} *U \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{previous\_segments}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{\_},\ocwlowerid{u},[~-8~]))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{w}~=\ocwlowerid{sandhi\_aa}~\ocwlowerid{u}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$[~\ocwlowerid{new\_segment}~::~[~(\ocwlowerid{aa\_phase}~\ocwlowerid{ph},[~2~],\ocwupperid{Euphony}~([~12~],[~2~],[~6~]~))~$\ocweol
\ocwindent{11.50em}
::~$[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},[~2~]))~::~\ocwlowerid{rest}~]~]~]$\ocweol
\ocwindent{5.50em}
$\ocwlowerid{where}~\ocwlowerid{new\_segment}~=~(\ocwlowerid{ph},\ocwupperid{Word.}\ocwlowerid{mirror}~[~6~::~\ocwlowerid{r}~],\ocwlowerid{rule})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~-6~$\ocwbc{} *r \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{previous\_segments}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{\_},\ocwlowerid{u},[~-6~]))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{w}~=\ocwlowerid{sandhi\_aa}~\ocwlowerid{u}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$[~\ocwlowerid{new\_segment}~::~[~(\ocwlowerid{aa\_phase}~\ocwlowerid{ph},[~2~],\ocwupperid{Euphony}~([~2;~43~],[~2~],[~7~]~))~$\ocweol
\ocwindent{11.50em}
::~$[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},[~2~]))~::~\ocwlowerid{rest}~]~]~]$\ocweol
\ocwindent{5.50em}
$\ocwlowerid{where}~\ocwlowerid{new\_segment}~=~(\ocwlowerid{ph},\ocwupperid{Word.}\ocwlowerid{mirror}~[~7~::~\ocwlowerid{r}~],\ocwlowerid{rule})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~\ocwlowerid{segment}~::~\ocwlowerid{previous\_segments}~]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Now for the segmenter proper 
\ocweol
\label{segmenter.ml:11995}%
\medskip
\ocwbegincode{}\ocwindent{0.50em}
\ocwkw{type}~$\ocwlowerid{backtrack}~=$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Choose}~$\ocwkw{of}~$\ocwlowerid{phase}~$\ocwkw{and}~$\ocwlowerid{input}~$\ocwkw{and}~$\ocwlowerid{output}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~$\ocwupperid{Auto.}\ocwlowerid{choices}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Advance}~$\ocwkw{of}~$\ocwlowerid{phase}~$\ocwkw{and}~$\ocwlowerid{input}~$\ocwkw{and}~$\ocwlowerid{output}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{resumption}~=~$\ocwbt{list}~$\ocwlowerid{backtrack}~$\ocwbc{} coroutine resumptions \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{finished}~=~([\,]:\ocwlowerid{resumption})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Service routines \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
\ocwbegindcode{}$\ocwlowerid{access}~:~\ocwlowerid{phase}~\rightarrow{}~\ocwlowerid{word}~\rightarrow{}~$\ocwbt{option}~$(\ocwlowerid{auto}~\times{}~\ocwlowerid{word})$\ocwenddcode{} 
\ocweol
\label{segmenter.ml:12322}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{access}~\ocwlowerid{phase}~=~\ocwlowerid{acc}~(\ocwlowerid{transducer}~\ocwlowerid{phase})~[\,]$\ocweol
\ocwindent{1.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{acc}~\ocwlowerid{state}~\ocwlowerid{w}~=~$\ocwkw{fun}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{Some}~(\ocwlowerid{state},\ocwlowerid{w})~$\ocwbc{} w is reverse of access input word \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{state}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~\ocwupperid{Auto.State}~(\ocwlowerid{\_},\ocwlowerid{deter},\ocwlowerid{\_})~\rightarrow{}~$\ocwkw{match}~$\ocwupperid{List2.}\ocwlowerid{ass}~\ocwlowerid{c}~\ocwlowerid{deter}~$\ocwkw{with}~\ocweol
\ocwindent{8.00em}
$[~\ocwupperid{Some}~\ocwlowerid{next\_state}~\rightarrow{}~\ocwlowerid{acc}~\ocwlowerid{next\_state}~[~\ocwlowerid{c}~::~\ocwlowerid{w}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~\ocwupperid{None}~$\ocweol
\ocwindent{8.00em}
$]~$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} The scheduler gets its phase transitions from dispatcher \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{schedule}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{w}~\ocwlowerid{cont}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{add}~\ocwlowerid{phase}~\ocwlowerid{cont}~=~[~\ocwupperid{Advance}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{w}~::~\ocwlowerid{cont}~]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{transitions}~=~$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{accepting}~\ocwlowerid{phase}~\land{}~\lnot{}~\ocwlowerid{star.}\ocwlowerid{val}~$\ocwkw{then}~$[\,]~$\ocwbc{} Word = Sanskrit padas \ocwec{}~\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$\ocwlowerid{dispatch}~\ocwlowerid{full.}\ocwlowerid{val}~\ocwlowerid{w}~\ocwlowerid{phase}~$\ocwbc{} iterate Word+ \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{fold\_right}~\ocwlowerid{add}~\ocwlowerid{transitions}~\ocwlowerid{cont}~$\ocweol
\ocwindent{1.00em}
\ocwbc{} respects dispatch order within a fair top-down search \ocwec{}\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwbc{} The tagging transducer interpreter as a non deterministic reactive engine:
   \ocwbegindcode{}$\ocwlowerid{phase}$\ocwenddcode{} is the parsing phase
   \ocwbegindcode{}$\ocwlowerid{input}$\ocwenddcode{} is the input tape represented as a \ocwbegindcode{}$\ocwlowerid{word}$\ocwenddcode{}
   \ocwbegindcode{}$\ocwlowerid{output}$\ocwenddcode{} is the current result of type \ocwbegindcode{}$\ocwlowerid{output}$\ocwenddcode{}
   \ocwbegindcode{}$\ocwlowerid{back}$\ocwenddcode{} is the backtrack stack of type \ocwbegindcode{}$\ocwlowerid{resumption}$\ocwenddcode{}
   \ocwbegindcode{}$\ocwlowerid{occ}$\ocwenddcode{} is the current reverse access path in the deterministic part
   the last argument is the current state of type \ocwbegindcode{}$\ocwlowerid{auto}$\ocwenddcode{}. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{react}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{back}~\ocwlowerid{occ}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Auto.State}~(\ocwlowerid{accept},\ocwlowerid{det},\ocwlowerid{choices})~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwbc{} we try the deterministic space before the non deterministic one \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{deter}~\ocwlowerid{cont}~=~$\ocwkw{match}~$\ocwlowerid{input}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{continue}~\ocwlowerid{cont}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~\ocwlowerid{letter}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwupperid{List2.}\ocwlowerid{ass}~\ocwlowerid{letter}~\ocwlowerid{det}~$\ocwkw{with}~\ocweol
\ocwindent{5.50em}
$[~\ocwupperid{Some}~\ocwlowerid{state}~\rightarrow{}$\ocweol
\ocwindent{6.50em}
$\ocwlowerid{react}~\ocwlowerid{phase}~\ocwlowerid{rest}~\ocwlowerid{output}~\ocwlowerid{cont}~[~\ocwlowerid{letter}~::~\ocwlowerid{occ}~]~\ocwlowerid{state}~$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{continue}~\ocwlowerid{cont}$\ocweol
\ocwindent{5.50em}
$]~$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{cont}~=~$\ocwkw{if}~$\ocwlowerid{choices}=[\,]~$\ocwkw{then}~$\ocwlowerid{back}$\ocweol
\ocwindent{7.50em}
\ocwkw{else}~$[~\ocwupperid{Choose}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{occ}~\ocwlowerid{choices}~::~\ocwlowerid{back}~]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwbc{} now we look for - or + pragma \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$(\ocwlowerid{keep},\ocwlowerid{cut},\ocwlowerid{input'})~=~$\ocwkw{match}~$\ocwlowerid{input}~$\ocwkw{with}~\ocweol
\ocwindent{3.50em}
$[~[~0~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwbc{} explicit \ocwstring{"\symbol{45}"} compound break hint \ocwec{}~\ocweol
\ocwindent{7.00em}
$(\ocwlowerid{ii\_phase}~\ocwlowerid{phase},\ocwupperid{True},\ocwlowerid{rest})~$\ocweol
\ocwindent{3.50em}
$\mid{}~[~-10~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwbc{} mandatory segmentation + \ocwec{}\ocweol
\ocwindent{7.00em}
$(\ocwupperid{True},\ocwupperid{True},\ocwlowerid{rest})~$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~(\ocwupperid{True},\ocwupperid{False},\ocwlowerid{input})$\ocweol
\ocwindent{3.50em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{accept}~\land{}~\ocwlowerid{keep}~$\ocwkw{then}~\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{segment}~=~(\ocwlowerid{phase},\ocwlowerid{occ},\ocwupperid{Id})~$\ocwkw{in}~\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{out}~=~\ocwlowerid{accrue}~\ocwlowerid{segment}~\ocwlowerid{output}~$\ocwkw{in}~\ocweol
\ocwindent{3.50em}
\ocwkw{match}~$\ocwlowerid{validate}~\ocwlowerid{out}~$\ocwkw{with}~\ocweol
\ocwindent{3.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{deter}~\ocwlowerid{cont}$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{contracted}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{input'}~$\ocwkw{with}\ocweol
\ocwindent{7.00em}
$[~[\,]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{accepting}~\ocwlowerid{phase}~$\ocwkw{then}~\ocweol
\ocwindent{11.00em}
\ocwkw{if}~$\ocwlowerid{check\_chunk}~\ocwlowerid{contracted}$\ocweol
\ocwindent{12.50em}
\ocwkw{then}~$\ocwupperid{Some}~(\ocwlowerid{contracted},\ocwlowerid{cont})~$\ocwbc{} solution found \ocwec{}~\ocweol
\ocwindent{12.50em}
\ocwkw{else}~$\ocwlowerid{continue}~\ocwlowerid{cont}~$\ocweol
\ocwindent{11.00em}
\ocwkw{else}~$\ocwlowerid{continue}~\ocwlowerid{cont}~$\ocweol
\ocwindent{7.00em}
$\mid{}~[~\ocwlowerid{first}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwbc{} we first try the longest matching word \ocwec{}\ocweol
\ocwindent{11.00em}
\ocwkw{let}~$\ocwlowerid{cont'}~=~\ocwlowerid{schedule}~\ocwlowerid{phase}~\ocwlowerid{input'}~\ocwlowerid{contracted}~[\,]~\ocwlowerid{cont}~$\ocwkw{in}\ocweol
\ocwindent{11.00em}
\ocwkw{if}~$\ocwlowerid{cut}~$\ocwkw{then}~$\ocwlowerid{continue}~\ocwlowerid{cont'}~$\ocwkw{else}\ocweol
\ocwindent{11.00em}
\ocwkw{if}~$\ocwlowerid{check\_id\_sandhi}~\ocwlowerid{occ}~\ocwlowerid{first}~$\ocwkw{then}~\ocwbc{} legitimate Id \ocwec{}\ocweol
\ocwindent{12.50em}
$\ocwlowerid{deter}~\ocwlowerid{cont'}~$\ocwkw{else}~$\ocwlowerid{deter}~\ocwlowerid{cont}~$\ocweol
\ocwindent{7.00em}
$]$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{cut}~$\ocwkw{then}~$\ocwlowerid{continue}~\ocwlowerid{cont}~$\ocwkw{else}~$\ocwlowerid{deter}~\ocwlowerid{cont}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{choose}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{back}~\ocwlowerid{occ}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{continue}~\ocwlowerid{back}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~((\ocwlowerid{w},\ocwlowerid{u},\ocwlowerid{v})~$\ocwkw{as}~$\ocwlowerid{rule})~::~\ocwlowerid{others}~]~\rightarrow{}~$\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{cont}~=~$\ocwkw{if}~$\ocwlowerid{others}=[\,]~$\ocwkw{then}~$\ocwlowerid{back}$\ocweol
\ocwindent{9.00em}
\ocwkw{else}~$[~\ocwupperid{Choose}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{occ}~\ocwlowerid{others}~::~\ocwlowerid{back}~]~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{match}~$\ocwupperid{List2.}\ocwlowerid{subtract}~\ocwlowerid{input}~\ocwlowerid{w}~$\ocwkw{with}~\ocwbc{} try to read \ocwbegindcode{}$\ocwlowerid{w}$\ocwenddcode{} on \ocwbegindcode{}$\ocwlowerid{input}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{4.50em}
$[~\ocwupperid{Some}~\ocwlowerid{rest}~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{segment}~=~(\ocwlowerid{phase},\ocwlowerid{u}~@~\ocwlowerid{occ},\ocwupperid{Euphony}~\ocwlowerid{rule})~$\ocwkw{in}~\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{out}~=~\ocwlowerid{accrue}~\ocwlowerid{segment}~\ocwlowerid{output}~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
\ocwkw{match}~$\ocwlowerid{validate}~\ocwlowerid{out}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{continue}~\ocwlowerid{cont}~$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{contracted}~\rightarrow{}$\ocweol
\ocwindent{7.00em}
\ocwkw{if}~$\ocwlowerid{v}=[\,]~$\ocwbc{} final sandhi \ocwec{}~\ocwkw{then}\ocweol
\ocwindent{8.50em}
\ocwkw{if}~$\ocwlowerid{rest}=[\,]~\land{}~\ocwlowerid{accepting}~\ocwlowerid{phase}~$\ocwbc{} potential solution found \ocwec{}\ocweol
\ocwindent{10.00em}
\ocwkw{then}~\ocwkw{if}~$\ocwlowerid{check\_chunk}~\ocwlowerid{contracted}$\ocweol
\ocwindent{14.00em}
\ocwkw{then}~$\ocwupperid{Some}~(\ocwlowerid{contracted},\ocwlowerid{cont})~$\ocwbc{} solution found \ocwec{}~\ocweol
\ocwindent{12.50em}
\ocwkw{else}~$\ocwlowerid{continue}~\ocwlowerid{cont}$\ocweol
\ocwindent{8.50em}
\ocwkw{else}~$\ocwlowerid{continue}~\ocwlowerid{cont}$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{continue}~(\ocwlowerid{schedule}~\ocwlowerid{phase}~\ocwlowerid{rest}~\ocwlowerid{contracted}~\ocwlowerid{v}~\ocwlowerid{cont})$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{continue}~\ocwlowerid{cont}$\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{continue}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{None}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{resume}~::~\ocwlowerid{back}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{resume}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Choose}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{occ}~\ocwlowerid{choices}~\rightarrow{}~$\ocweol
\ocwindent{5.00em}
$\ocwlowerid{choose}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{back}~\ocwlowerid{occ}~\ocwlowerid{choices}~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Advance}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{occ}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{access}~\ocwlowerid{phase}~\ocwlowerid{occ}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{continue}~\ocwlowerid{back}~$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Some}~(\ocwlowerid{next\_state},\ocwlowerid{v})~\rightarrow{}~\ocwlowerid{react}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{back}~\ocwlowerid{v}~\ocwlowerid{next\_state}$\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{3.00em}
$]~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{init\_segment\_initial}~\ocwlowerid{initial\_phases}~\ocwlowerid{sentence}~=~$\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{map}~($\ocwkw{fun}~$\ocwlowerid{phase}~\rightarrow{}~\ocwupperid{Advance}~\ocwlowerid{phase}~\ocwlowerid{sentence}~[\,]~[\,])~\ocwlowerid{initial\_phases}$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{segment1\_initial}~\ocwlowerid{initial\_phases}~\ocwlowerid{sentence}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{continue}~(\ocwlowerid{init\_segment\_initial}~\ocwlowerid{initial\_phases}~\ocwlowerid{sentence})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Switch according to Complete/Simplify mode, governed by global ref \ocwbegindcode{}$\ocwlowerid{full}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{init\_segment}~\ocwlowerid{seg}~=~$\ocwbc{} do not eta reduce! \ocwec{}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{init\_segment\_initial}~(\ocwlowerid{initial}~\ocwlowerid{full.}\ocwlowerid{val})~\ocwlowerid{seg}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{segment1}~\ocwlowerid{seg}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{segment1\_initial}~(\ocwlowerid{initial}~\ocwlowerid{full.}\ocwlowerid{val})~\ocwlowerid{seg}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end};~\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Load_morphs.ml}
\ocwmodule{Load\_morphs}
\label{load_morphs.ml:0}%
\ocwbegindcode{}$\ocwupperid{Load\_morphs}$\ocwenddcode{} 
\ocweol
\ocwindent{0.00em}
Used for loading the (huge) morphology databanks. 
\ocweol
\label{load_morphs.ml:696}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocwbc{} lemmas \ocwec{}\medskip

\label{load_morphs.ml:727}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Morphs}~$\ocwbc{} takes its prelude and control arguments as parameters \ocwec{}~\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Prel}:~$\ocwkw{sig}~$\ocwlowerid{value}~\ocwlowerid{prelude}~:~$\ocwbt{unit}~$\rightarrow{}~$\ocwbt{unit};~\ocwkw{end}$)~$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Phases}:~$\ocwkw{sig}~\ocwkw{type}~$\ocwlowerid{phase}~=~$\ocwbc{} Phases.phase \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Noun}~\mid{}~\ocwupperid{Noun2}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pron}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Root}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inde}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Absv}~\mid{}~\ocwupperid{Absc}~\mid{}~\ocwupperid{Abso}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Voca}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inv}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iic}~\mid{}~\ocwupperid{Iic2}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiif}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiv}~\mid{}~\ocwupperid{Iivv}~\mid{}~\ocwupperid{Iivc}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Auxi}~\mid{}~\ocwupperid{Auxik}~\mid{}~\ocwupperid{Auxiick}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ifc}~\mid{}~\ocwupperid{Ifc2}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Peri}~$\ocwbc{} periphrastic perfect \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Lopa}~$\ocwbc{} e/o conjugated root forms with lopa \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Lopak}~$\ocwbc{} e/o kridantas forms with lopa \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pv}~$\ocwbc{} Preverb optional before Root or Lopa or mandatory before Abso \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pvk}~\mid{}~\ocwupperid{Pvkc}~\mid{}~\ocwupperid{Pvkv}~$\ocwbc{} Preverb optional before Krid or Iik or Lopak \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{A}~\mid{}~\ocwupperid{An}~\mid{}~\ocwupperid{Ai}~\mid{}~\ocwupperid{Ani}~\mid{}~\ocwupperid{Iicv}~\mid{}~\ocwupperid{Iicc}~\mid{}~\ocwupperid{Nouv}~\mid{}~\ocwupperid{Nouc}~$\ocwbc{} privative nan-compounds \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Krid}~$\ocwbc{} K.ridaantaas - used to be called Parts \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Vok}~$\ocwbc{} K.ridaanta vocatives \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iik}~$\ocwbc{} K.ridaantaas as left component - used to be called Piic \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iikv}~\mid{}~\ocwupperid{Iikc}~\mid{}~\ocwupperid{Kriv}~\mid{}~\ocwupperid{Kric}~\mid{}~\ocwupperid{Vocv}~\mid{}~\ocwupperid{Vocc}~\mid{}~\ocwupperid{Vokv}~\mid{}~\ocwupperid{Vokc}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiy}~\mid{}~\ocwupperid{Avy}~\mid{}~\ocwupperid{Inftu}~\mid{}~\ocwupperid{Kama}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Sfx}~\mid{}~\ocwupperid{Isfx}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Cache}~$\ocwbc{} Cached lexicon acquisitions \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Unknown}~$\ocwbc{} Unrecognized chunk \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Comp}~$\ocwkw{of}~$(\ocwlowerid{phase}~\times{}~\ocwlowerid{phase})~$\ocwkw{and}~\ocwbc{} pv \ocwec{}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~\ocwbc{} root form \ocwec{}~$\ocwupperid{Word.}\ocwlowerid{word}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Tad}~$\ocwkw{of}~$(\ocwlowerid{phase}~\times{}~\ocwlowerid{phase})~$\ocwkw{and}~\ocwbc{} nominal \ocwec{}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~\ocwbc{} sfx \ocwec{}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocweol
\ocwindent{1.00em}
$];~$\ocwkw{end}$)$\ocweol
\ocwindent{0.50em}
=~\ocwkw{struct}\medskip

\label{load_morphs.ml:1971}%
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phases}~$\ocwbc{} phase \ocwec{}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Somewhat weird classification of segments accoding to their construction
by Dispatcher. Preverbed segments may be finite verb forms or kridantas. 
\ocweol
\label{load_morphs.ml:2150}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{tag\_sort}~=$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Atomic}~$\ocwkw{of}~$\ocwlowerid{lemmas}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Preverbed}~$\ocwkw{of}~$(\ocwlowerid{phase}~\times{}~\ocwlowerid{phase})~$\ocwkw{and}~\ocwbc{} pv \ocwec{}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~$\ocwlowerid{lemmas}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Taddhita}~$\ocwkw{of}~$(\ocwlowerid{phase}~\times{}~\ocwupperid{Word.}\ocwlowerid{word})~$\ocwkw{and}~\ocwbc{} sfx \ocwec{}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~$\ocwlowerid{phase}~$\ocwkw{and}~$\ocwlowerid{lemmas}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Fake tags of nan prefixes \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{nan\_prefix}~=~\ocwupperid{Bare\_stem}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{a\_tag}~=~[~((0,[\,]),[~\ocwlowerid{nan\_prefix}~])~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{an\_tag}~=~[~((0,[~51~]),[~\ocwlowerid{nan\_prefix}~])~]~$\ocwbc{} since lexicalized as an\#1 \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{an\_tag}$\ocwenddcode{} has delta = (0,\ocwbegindcode{}51\ocwenddcode{}) since an\#1 is the relevant entry. Such values
will have to be parameters of the specific lexicon used. \ocwec{};\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ai\_tag}~=~\ocwlowerid{a\_tag}~$\ocwbc{} special for privative abs-tvaa eg akritvaa \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{ani\_tag}~=~\ocwlowerid{an\_tag}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{unknown\_tag}~=~[~((0,[\,]),[~\ocwupperid{Unanalysed}~])~]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{give\_up}~\ocwlowerid{cat}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{mess}~=~$\ocwstring{"Missing\ocwvspace{}"}~\^{}~$\ocwlowerid{cat}~$\^{}~\ocwstring{"\ocwvspace{}morphology\ocwvspace{}bank"}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwupperid{Web.}\ocwlowerid{abort}~\ocwupperid{Html.}\ocwlowerid{default\_language}$\ocweol
\ocwindent{11.00em}
\ocwstring{"System\ocwvspace{}error\ocwvspace{}\symbol{45}\ocwvspace{}please\ocwvspace{}report\ocwvspace{}\symbol{45}\ocwvspace{}"}~$\ocwlowerid{mess}$\ocweol
\ocwindent{0.00em}
\ocwbc{}  ; exit 0 \ocwbc{} installation problem -- executing process fails \ocwec{} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwupperid{Deco.}\ocwlowerid{empty}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{load\_morpho}~\ocwlowerid{file}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwlowerid{file}~:~\ocwlowerid{inflected\_map})~$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwupperid{Prel.}\ocwlowerid{prelude}~();~\ocwlowerid{give\_up}~\ocwlowerid{file}~\}~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{load\_morpho\_cache}~\ocwlowerid{file}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwlowerid{file}~:~\ocwlowerid{inflected\_map})~$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Deco.}\ocwlowerid{empty}~]~$\ocwbc{} dummy empty morpho lexmap \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Loads all morphological databases; Used in Reader, Parser. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} NB both Noun and Noun2 are loaded whether full or not - TODO improve \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{load\_morphs}~()~=~$\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{nouns}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_nouns\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{nouns2}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_nouns2\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{prons}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_pronouns\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{roots}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_roots\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{krids}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_parts\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{voks}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_partvocs\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{peris}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_peris\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{lopas}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_lopas\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{lopaks}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_lopaks\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{indes}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_inde\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{absya}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_absya\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{abstvaa}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_abstvaa\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iics}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_iics\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iics2}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_iics2\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iifs}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_iifcs\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iiks}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_piics\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iivs}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_iivs\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{iiys}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_avyayais\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{avys}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_avyayafs\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{auxis}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_auxis\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{auxiks}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_auxiks\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{auxiicks}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_auxiicks\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{vocas}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_vocas\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{invs}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_invs\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ifcs}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_ifcs\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ifcs2}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_ifcs2\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{inftu}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_inftu\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{kama}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_kama\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{sfxs}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_sfxs\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{isfxs}~=~\ocwlowerid{load\_morpho}~\ocwupperid{Web.}\ocwlowerid{public\_isfxs\_file}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{caches}~=~\ocwlowerid{load\_morpho\_cache}~\ocwupperid{Web.}\ocwlowerid{public\_cache\_file}$\ocweol
\ocwindent{1.00em}
\}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{morpho}~=~\ocwlowerid{load\_morphs}~()~$\ocwbc{} costly \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{morpho\_tags}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Noun}~\mid{}~\ocwupperid{Nouv}~\mid{}~\ocwupperid{Nouc}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{nouns}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Pron}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{prons}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Root}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{roots}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Peri}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{peris}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Lopa}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{lopas}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Lopak}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{lopaks}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Inde}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{indes}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Absv}~\mid{}~\ocwupperid{Absc}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{abstvaa}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Abso}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{absya}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Auxi}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{auxis}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Auxik}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{auxiks}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Auxiick}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{auxiicks}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Voca}~\mid{}~\ocwupperid{Vocv}~\mid{}~\ocwupperid{Vocc}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{vocas}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Inv}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{invs}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Ifc}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{ifcs}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Iic}~\mid{}~\ocwupperid{Iicv}~\mid{}~\ocwupperid{Iicc}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{iics}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Iiv}~\mid{}~\ocwupperid{Iivv}~\mid{}~\ocwupperid{Iivc}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{iivs}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Iiif}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{iifs}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Iiy}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{iiys}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Avy}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{avys}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Krid}~\mid{}~\ocwupperid{Kriv}~\mid{}~\ocwupperid{Kric}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{krids}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Vok}~\mid{}~\ocwupperid{Vokv}~\mid{}~\ocwupperid{Vokc}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{voks}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Iik}~\mid{}~\ocwupperid{Iikv}~\mid{}~\ocwupperid{Iikc}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{iiks}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Noun2}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{nouns2}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Iic2}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{iics2}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Ifc2}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{ifcs2}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Inftu}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{inftu}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Kama}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{kama}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Sfx}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{sfxs}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Isfx}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{isfxs}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Cache}~\rightarrow{}~\ocwlowerid{morpho.}\ocwlowerid{caches}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"morpho\_tags"}$)~$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Used in Lexer, Reader, Parser, Interface \ocwec{}~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{tags\_of}~\ocwlowerid{phase}~\ocwlowerid{word}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{phase}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Pv}~\mid{}~\ocwupperid{Pvk}~\mid{}~\ocwupperid{Pvkc}~\mid{}~\ocwupperid{Pvkv}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Preverb\ocwvspace{}in\ocwvspace{}tags\_of"}~\ocweol
\ocwindent{2.00em}
\ocwbc{} all preverbs ought to have been captured by \ocwbegindcode{}$\ocwupperid{Dispatcher}.\ocwlowerid{validate}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{A}~\mid{}~\ocwupperid{Ai}~\rightarrow{}~\ocwupperid{Atomic}~\ocwlowerid{a\_tag}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{An}~\mid{}~\ocwupperid{Ani}~\rightarrow{}~\ocwupperid{Atomic}~\ocwlowerid{an\_tag}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Unknown}~\rightarrow{}~\ocwupperid{Atomic}~\ocwlowerid{unknown\_tag}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Comp}~((\ocwlowerid{\_},\ocwlowerid{ph})~$\ocwkw{as}~$\ocwlowerid{sort})~\ocwlowerid{pv}~\ocwlowerid{form}~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{tag}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{form}~(\ocwlowerid{morpho\_tags}~\ocwlowerid{ph})~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwupperid{Preverbed}~\ocwlowerid{sort}~\ocwlowerid{pv}~\ocwlowerid{form}~\ocwlowerid{tag}$\ocweol
\ocwindent{0.00em}
\ocwbc{} NB \ocwbegindcode{}$\ocwupperid{Preverbed}$\ocwenddcode{} comprises tin verbal forms of verbs with preverbs as well 
   as sup kridanta forms with preverbs. The preverbs are packed in pv. \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Tad}~(\ocwlowerid{ph},\ocwlowerid{sfx\_ph})~\ocwlowerid{form}~\ocwlowerid{sfx}~\rightarrow{}~$\ocwbc{} tag inherited from fake suffix entry \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{sfx\_tag}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{sfx}~(\ocwlowerid{morpho\_tags}~\ocwlowerid{sfx\_ph})~$\ocwkw{in}\ocweol
\ocwindent{0.00em}
\ocwbc{}   \ocwbegindcode{}\ocwkw{let}~$\ocwlowerid{stem\_tag}~=~\ocwupperid{Deco}.\ocwlowerid{assoc}~\ocwlowerid{sfx}~(\ocwlowerid{morpho\_tags}~\ocwlowerid{ph})~$\ocwkw{in}\ocwenddcode{} - possible extension \ocwec{}\ocweol
\ocwindent{3.00em}
$\ocwupperid{Taddhita}~(\ocwlowerid{ph},\ocwlowerid{form})~[~0~::~\ocwlowerid{sfx}~]~\ocwlowerid{sfx\_ph}~\ocwlowerid{sfx\_tag}~$\ocwbc{} 0 = \ocwstring{"\symbol{45}"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Atomic}~(\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{word}~(\ocwlowerid{morpho\_tags}~\ocwlowerid{phase}))~$\ocweol
\ocwindent{2.00em}
\ocwbc{} NB Atomic comprises tin verbal forms of roots as well as sup atomic forms
       and all the pure stems collections Iic Iiv etc. \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\label{load_morphs.ml:7469}%
\ocwindent{0.00em}
\ocwkw{end};\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Lexer.mli}
\ocwinterface{Lexer}
\label{lexer.mli:0}%
Sanskrit Phrase Lexer 
\ocweol
\label{lexer.mli:648}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{inflexions}~\ocwlowerid{lemma}~\ocwlowerid{morphology}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phases};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Dispatcher};~$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Load\_transducers};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{transducer\_vect}~\ocwlowerid{morpho}$\ocwenddcode{} \ocwec{}\medskip

\label{lexer.mli:787}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Lexer}~:~$\ocwkw{functor}~\ocwbc{} takes its prelude and iterator control as parameters \ocwec{}\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Prel}:~$\ocwkw{sig}~$\ocwlowerid{value}~\ocwlowerid{prelude}~:~$\ocwbt{unit}~$\rightarrow{}~$\ocwbt{unit};~\ocwkw{end}$)~\rightarrow{}~$\ocwkw{functor}\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Control}:~$\ocwkw{sig}~$\ocwlowerid{value}~\ocwlowerid{star}~:~$\ocwbt{ref}~\ocwbt{bool};~\ocwbc{} chunk= if start then word+ else word \ocwec{}\ocweol
\ocwindent{8.00em}
$\ocwlowerid{value}~\ocwlowerid{full}~:~$\ocwbt{ref}~\ocwbt{bool};~\ocwbc{} all kridantas and nan cpds if full \ocwec{}\ocweol
\ocwindent{8.00em}
$\ocwlowerid{value}~\ocwlowerid{out\_chan}~:~$\ocwbt{ref}~$\ocwlowerid{out\_channel};$\ocweol
\ocwindent{6.00em}
\ocwkw{end}$)~\rightarrow{}~$\ocwkw{sig}\medskip

\label{lexer.mli:1167}%
\ocwindent{1.00em}
\ocwkw{module}~$\ocwupperid{Transducers}~:~$\ocwkw{sig}~$\ocwlowerid{value}~\ocwlowerid{transducers}~:~\ocwlowerid{transducer\_vect};~$\ocwkw{end};\medskip

\label{lexer.mli:1237}%
\ocwindent{1.00em}
\ocwkw{module}~$\ocwupperid{Disp}~:~$\ocwkw{sig}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{value}~\ocwlowerid{accepting}~:~\ocwupperid{Phases.}\ocwlowerid{phase}~\rightarrow{}~$\ocwbt{bool};\ocweol
\ocwindent{3.00em}
\ocwkw{type}~$\ocwlowerid{input}~=~\ocwupperid{Word.}\ocwlowerid{word}$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{transition}$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{segment}~=~(\ocwupperid{Phases.}\ocwlowerid{phase}~\times{}~\ocwupperid{Word.}\ocwlowerid{word}~\times{}~\ocwlowerid{transition})$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{output}~=~$\ocwbt{list}~$\ocwlowerid{segment};$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{value}~\ocwlowerid{color\_of\_phase}~:~\ocwupperid{Phases.}\ocwlowerid{phase}~\rightarrow{}~\ocwupperid{Html.}\ocwlowerid{color};$\ocweol
\ocwindent{3.00em}
\ocwkw{end};\medskip

\label{lexer.mli:1516}%
\ocwindent{1.00em}
\ocwkw{module}~$\ocwupperid{Viccheda}~:~$\ocwkw{sig}~\ocweol
\ocwindent{3.00em}
\ocwkw{type}~$\ocwlowerid{resumption};$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{value}~\ocwlowerid{continue}~:~\ocwlowerid{resumption}~\rightarrow{}~$\ocwbt{option}~$(\ocwupperid{Disp.}\ocwlowerid{output}~\times{}~\ocwlowerid{resumption});$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{value}~\ocwlowerid{init\_segment}~:~\ocwupperid{Disp.}\ocwlowerid{input}~\rightarrow{}~\ocwlowerid{resumption};$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{value}~\ocwlowerid{finished}~:~\ocwlowerid{resumption};$\ocweol
\ocwindent{3.00em}
\ocwkw{type}~$\ocwlowerid{check}~=~($\ocwbt{int}~$\times{}~(\ocwupperid{Phases.}\ocwlowerid{phase}~\times{}~\ocwupperid{Word.}\ocwlowerid{word})~\times{}~$\ocwbt{bool}$);$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{value}~\ocwlowerid{all\_checks}~:~$\ocwbt{ref}~$($\ocwbt{list}~$\ocwlowerid{check});$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{value}~\ocwlowerid{set\_offset}~:~($\ocwbt{int}~$\times{}~$\ocwbt{list}~$\ocwlowerid{check})~\rightarrow{}~$\ocwbt{unit};\ocweol
\ocwindent{3.00em}
\ocwkw{end};\medskip

\label{lexer.mli:1894}%
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{extract\_lemma}~:~\ocwupperid{Phases.}\ocwlowerid{phase}~\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~$\ocwbt{list}~$\ocwlowerid{lemma};$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_segment}~:~$\ocwbt{int}~$\rightarrow{}~\ocwupperid{Disp.}\ocwlowerid{segment}~\rightarrow{}~$\ocwbt{int};\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_segment\_roles}~:~(\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~\ocwlowerid{inflexions}~\rightarrow{}~$\ocwbt{unit}$)~$\ocweol
\ocwindent{2.50em}
$\rightarrow{}~$\ocwbt{int}~$\rightarrow{}~\ocwupperid{Disp.}\ocwlowerid{segment}~\rightarrow{}~$\ocwbt{unit};\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_proj}~:~\ocwupperid{Phases.}\ocwlowerid{phase}~\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~$\ocweol
\ocwindent{10.50em}
\ocwbt{list}~$($\ocwbt{int}~$\times{}~$\ocwbt{int}$)~\rightarrow{}~$\ocwbt{list}~$($\ocwbt{int}~$\times{}~$\ocwbt{int}$);$\medskip

\label{lexer.mli:2225}%
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{all\_checks}~:~$\ocwbt{ref}~$($\ocwbt{list}~$\ocwupperid{Viccheda.}\ocwlowerid{check});~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{un\_analyzable}~:~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~($\ocwbt{list}~$\ocwupperid{Disp.}\ocwlowerid{segment}~\times{}~\ocwupperid{Viccheda.}\ocwlowerid{resumption});~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{set\_offset}~:~($\ocwbt{int}~$\times{}~$\ocwbt{list}~$\ocwupperid{Viccheda.}\ocwlowerid{check})~\rightarrow{}~$\ocwbt{unit};\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_scl\_segment}~:~$\ocwbt{int}~$\rightarrow{}~(\ocwupperid{Phases.}\ocwlowerid{phase}~\times{}~\ocwupperid{Word.}\ocwlowerid{word})~\rightarrow{}~$\ocwbt{int};\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_tagging}~:~$\ocwbt{bool}~$\rightarrow{}~$\ocwbt{bool}~$\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{int}~$\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwbt{list}~$(\ocwupperid{Phases.}\ocwlowerid{phase}~\times{}~\ocwupperid{Word.}\ocwlowerid{word}~\times{}~\alpha{})~\rightarrow{}~$\ocwbt{list}~$($\ocwbt{int}~$\times{}~$\ocwbt{int}$)~\rightarrow{}~$\ocwbt{unit};\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{return\_tagging}~:~$\ocweol
\ocwindent{2.00em}
\ocwbt{list}~$(\ocwupperid{Phases.}\ocwlowerid{phase}~\times{}~\ocwupperid{Word.}\ocwlowerid{word}~\times{}~\alpha{})~\rightarrow{}~$\ocwbt{list}~$($\ocwbt{int}~$\times{}~$\ocwbt{int}$)~\rightarrow{}~$\ocwbt{string};\ocweol
\ocwindent{0.00em}
\ocwkw{end};\ocweol
\ocwendcode{}\typeout{OcamlWeb file Lexer.ml}
\ocwmodule{Lexer}
\label{lexer.ml:0}%
Sanskrit Phrase Lexer in 40 phases version. 
\ocweol
\ocwindent{0.00em}
Used by Parser, Reader and Regression. 
   Uses Phases from Dispatcher to define phase.
   Loads the transducers, calls Dispatch to create Disp. 
   Calls Segment to build Viccheda, the Sanskrit lexer that undoes sandhi 
   in order to produce a padapatha.
   Exports various print functions for the various modes. 
\ocweol
\label{lexer.ml:991}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Transduction};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Canon};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{inflected}~\ocwlowerid{inflected\_map}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Auto.Auto};~$\ocwbc{} auto State \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Segmenter};~$\ocwbc{} Segment \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Dispatcher};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{generative}~\ocwupperid{Dispatch}~\ocwlowerid{transition}~\ocwlowerid{phase\_of\_sort}~\ocwlowerid{trim\_tags}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Word};~$\ocwbc{} word length mirror patch \ocwec{}\medskip

\label{lexer.ml:1274}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Lexer}~$\ocwbc{} takes its prelude and control arguments as module parameters \ocwec{}\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Prel}:~$\ocwkw{sig}~$\ocwlowerid{value}~\ocwlowerid{prelude}~:~$\ocwbt{unit}~$\rightarrow{}~$\ocwbt{unit};~\ocwkw{end}$)~$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Control}:~$\ocwkw{sig}~$\ocwlowerid{value}~\ocwlowerid{star}~:~$\ocwbt{ref}~\ocwbt{bool};~\ocwbc{} chunk = if star then word+ else word \ocwec{}\ocweol
\ocwindent{8.00em}
$\ocwlowerid{value}~\ocwlowerid{full}~:~$\ocwbt{ref}~\ocwbt{bool};~\ocwbc{} all kridantas and nan cpds if full \ocwec{}\ocweol
\ocwindent{8.00em}
$\ocwlowerid{value}~\ocwlowerid{out\_chan}~:~$\ocwbt{ref}~$\ocwlowerid{out\_channel};~$\ocwbc{} output channel \ocwec{}\ocweol
\ocwindent{6.00em}
\ocwkw{end}$)~=~$\ocwkw{struct}\medskip

\label{lexer.ml:1664}%
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps pl abort etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Cgi};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phases};~$\ocwbc{} Phases \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phases};~$\ocwbc{} phase \ocwec{}\medskip

\label{lexer.ml:1772}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Lemmas}~=~\ocwupperid{Load\_morphs.Morphs}~\ocwupperid{Prel}~\ocwupperid{Phases}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Lemmas}~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{morpho}~\ocwlowerid{tags\_of}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Load\_transducers};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{transducer\_vect}~\ocwupperid{Trans}$\ocwenddcode{} \ocwec{}\medskip

\label{lexer.ml:1912}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Transducers}~=~\ocwupperid{Trans}~\ocwupperid{Prel};$\medskip

\label{lexer.ml:1946}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Disp}~=~\ocwupperid{Dispatch}~\ocwupperid{Transducers}~\ocwupperid{Lemmas};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Disp}~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{transducer}~\ocwlowerid{initial}~\ocwlowerid{accepting}~\ocwlowerid{dispatch}~\ocwlowerid{input}~\ocwlowerid{color\_of\_phase}~
~\ocwlowerid{transition}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Viccheda}~=~\ocwupperid{Segment}~\ocwupperid{Phases}~\ocwupperid{Disp}~\ocwupperid{Control}~$\ocweol
\ocwindent{9.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{init\_segment}~\ocwlowerid{continue}~\ocwlowerid{set\_offset}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{all\_checks}~=~\ocwupperid{Viccheda.}\ocwlowerid{all\_checks}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{set\_offset}~=~\ocwupperid{Viccheda.}\ocwlowerid{set\_offset}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{un\_analyzable}~(\ocwlowerid{chunk}~:~\ocwlowerid{word})~=~$\ocweol
\ocwindent{1.00em}
$([~(\ocwupperid{Unknown},\ocwlowerid{mirror}~\ocwlowerid{chunk},\ocwupperid{Disp.Id})~],\ocwupperid{Viccheda.}\ocwlowerid{finished})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{color\_of\_role}~=~$\ocwkw{fun}~\ocwbc{} Semantic role of lexical category \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Pv}~\mid{}~\ocwupperid{Pvk}~\mid{}~\ocwupperid{Pvkc}~\mid{}~\ocwupperid{Pvkv}~\mid{}~\ocwupperid{Iic}~\mid{}~\ocwupperid{Iic2}~\mid{}~\ocwupperid{Iik}~\mid{}~\ocwupperid{Voca}~\mid{}~\ocwupperid{Inv}~\mid{}~\ocwupperid{Iicv}~\mid{}~\ocwupperid{Iicc}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iikv}~\mid{}~\ocwupperid{Iikc}~\mid{}~\ocwupperid{Iiif}~\mid{}~\ocwupperid{A}~\mid{}~\ocwupperid{An}~\mid{}~\ocwupperid{Vok}~\mid{}~\ocwupperid{Vokv}~\mid{}~\ocwupperid{Vokc}~\mid{}~\ocwupperid{Vocv}~\mid{}~\ocwupperid{Vocc}~\mid{}~\ocwupperid{Iiy}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiv}~\mid{}~\ocwupperid{Iivv}~\mid{}~\ocwupperid{Iivc}~\mid{}~\ocwupperid{Peri}~\mid{}~\ocwupperid{Auxiick}~\rightarrow{}~\ocwupperid{Grey}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Noun}~\mid{}~\ocwupperid{Noun2}~\mid{}~\ocwupperid{Nouv}~\mid{}~\ocwupperid{Nouc}~\mid{}~\ocwupperid{Krid}~\mid{}~\ocwupperid{Kriv}~\mid{}~\ocwupperid{Kric}~\mid{}~\ocwupperid{Pron}~\mid{}~\ocwupperid{Ifc}~\mid{}~\ocwupperid{Ifc2}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Kama}~\mid{}~\ocwupperid{Lopak}~\mid{}~\ocwupperid{Auxik}~\rightarrow{}~\ocwupperid{Cyan}~$\ocwbc{} Actor or Predicate \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Root}~\mid{}~\ocwupperid{Lopa}~\mid{}~\ocwupperid{Auxi}~\rightarrow{}~\ocwupperid{Pink}~$\ocwbc{} abs-tvaa in Inde \ocwec{}~\ocwbc{} Process \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Abso}~\mid{}~\ocwupperid{Absv}~\mid{}~\ocwupperid{Absc}~\mid{}~\ocwupperid{Inde}~\mid{}~\ocwupperid{Avy}~\mid{}~\ocwupperid{Ai}~\mid{}~\ocwupperid{Ani}~\mid{}~\ocwupperid{Inftu}~\rightarrow{}~\ocwupperid{Lavender}~$\ocwbc{} Circumstance \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Unknown}~\mid{}~\ocwupperid{Cache}~\rightarrow{}~\ocwupperid{Grey}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Comp}~(\ocwlowerid{\_},\ocwlowerid{ph})~\ocwlowerid{\_}~\ocwlowerid{\_}~\mid{}~\ocwupperid{Tad}~(\ocwlowerid{\_},\ocwlowerid{ph})~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{color\_of\_role}~\ocwlowerid{ph}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Sfx}~\rightarrow{}~\ocwupperid{Cyan}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Isfx}~\rightarrow{}~\ocwupperid{Grey}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{table\_morph\_of}~\ocwlowerid{phase}~=~\ocwlowerid{table\_begin}~(\ocwlowerid{background}~(\ocwlowerid{color\_of\_phase}~\ocwlowerid{phase}))~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{table\_role\_of}~\ocwlowerid{phase}~=~\ocwlowerid{table\_begin}~(\ocwlowerid{background}~(\ocwlowerid{color\_of\_role}~\ocwlowerid{phase}))~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{table\_labels}~=~\ocwlowerid{table\_begin}~(\ocwlowerid{background}~\ocwupperid{Pink})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_morph}~\ocwlowerid{pvs}~\ocwlowerid{cached}~\ocwlowerid{seg\_num}~\ocwlowerid{gen}~\ocwlowerid{form}~\ocwlowerid{n}~\ocwlowerid{tag}~=~$\ocwkw{do}\ocweol
\ocwindent{0.00em}
\ocwbc{} n is the index in the list of tags of an ambiguous form \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{span\_begin}~\ocwupperid{Latin12})~$\ocweol
\ocwindent{1.00em}
;~$\ocwupperid{Morpho\_html.}\ocwlowerid{print\_inflected\_link}~\ocwlowerid{pvs}~\ocwlowerid{cached}~\ocwlowerid{form}~(\ocwlowerid{seg\_num},\ocwlowerid{n})~\ocwlowerid{gen}~\ocwlowerid{tag}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{span\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{n}+1$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} generalisation of \ocwbegindcode{}$\ocwlowerid{print\_morph}$\ocwenddcode{} to taddhitas \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_morph\_tad}~\ocwlowerid{pvs}~\ocwlowerid{cached}~\ocwlowerid{seg\_num}~\ocwlowerid{gen}~\ocwlowerid{stem}~\ocwlowerid{sfx}~\ocwlowerid{n}~\ocwlowerid{tag}~=~$\ocwkw{do}\ocweol
\ocwindent{0.00em}
\ocwbc{} n is the index in the list of tags of an ambiguous form \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{span\_begin}~\ocwupperid{Latin12})~$\ocweol
\ocwindent{1.00em}
;~$\ocwupperid{Morpho\_html.}\ocwlowerid{print\_inflected\_link\_tad}~\ocwlowerid{pvs}~\ocwlowerid{cached}~\ocwlowerid{stem}~\ocwlowerid{sfx}~(\ocwlowerid{seg\_num},\ocwlowerid{n})~\ocwlowerid{gen}~\ocwlowerid{tag}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{span\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{n}+1$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_tags}~\ocwlowerid{pvs}~\ocwlowerid{seg\_num}~\ocwlowerid{phase}~\ocwlowerid{form}~\ocwlowerid{tags}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{ptag}~=~\ocwlowerid{print\_morph}~\ocwlowerid{pvs}~(\ocwlowerid{is\_cache}~\ocwlowerid{phase})~\ocwlowerid{seg\_num}~(\ocwlowerid{generative}~\ocwlowerid{phase})~\ocwlowerid{form}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{\_}~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{ptag}~1~\ocwlowerid{tags}~$\ocwkw{in}~$()$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{scl\_phase}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Pv}~\mid{}~\ocwupperid{Pvk}~\mid{}~\ocwupperid{Pvkc}~\mid{}~\ocwupperid{Pvkv}~\rightarrow{}~$\ocwstring{"pv"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Noun}~\mid{}~\ocwupperid{Noun2}~\mid{}~\ocwupperid{Nouc}~\mid{}~\ocwupperid{Nouv}~\mid{}~\ocwupperid{Krid}~\mid{}~\ocwupperid{Kriv}~\mid{}~\ocwupperid{Kric}~\mid{}~\ocwupperid{Lopak}~\mid{}~\ocwupperid{Pron}~\mid{}~\ocwupperid{Auxik}~$\ocweol
\ocwindent{2.00em}
$\rightarrow{}~$\ocwstring{"noun"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Root}~\mid{}~\ocwupperid{Lopa}~\mid{}~\ocwupperid{Auxi}~\rightarrow{}~$\ocwstring{"root"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inde}~\mid{}~\ocwupperid{Abso}~\mid{}~\ocwupperid{Absv}~\mid{}~\ocwupperid{Absc}~\mid{}~\ocwupperid{Avy}~\rightarrow{}~$\ocwstring{"inde"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iic}~\mid{}~\ocwupperid{Iic2}~\mid{}~\ocwupperid{A}~\mid{}~\ocwupperid{An}~\mid{}~\ocwupperid{Iicv}~\mid{}~\ocwupperid{Iicc}~\mid{}~\ocwupperid{Iik}~\mid{}~\ocwupperid{Iikv}~\mid{}~\ocwupperid{Iikc}~\mid{}~\ocwupperid{Iiif}~\mid{}~\ocwupperid{Auxiick}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ai}~\mid{}~\ocwupperid{Ani}~\rightarrow{}~$\ocwstring{"iic"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Sfx}~\rightarrow{}~$\ocwstring{"suffix"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Isfx}~\rightarrow{}~$\ocwstring{"iicsuffix"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiv}~\mid{}~\ocwupperid{Iivv}~\mid{}~\ocwupperid{Iivc}~\rightarrow{}~$\ocwstring{"iiv"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Iiy}~\rightarrow{}~$\ocwstring{"iiy"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Peri}~\rightarrow{}~$\ocwstring{"peri"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Inftu}~\rightarrow{}~$\ocwstring{"inftu"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Kama}~\rightarrow{}~$\ocwstring{"kama"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Voca}~\mid{}~\ocwupperid{Vocv}~\mid{}~\ocwupperid{Vocc}~\mid{}~\ocwupperid{Inv}~\mid{}~\ocwupperid{Vok}~\mid{}~\ocwupperid{Vokv}~\mid{}~\ocwupperid{Vokc}~\rightarrow{}~$\ocwstring{"voca"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ifc}~\mid{}~\ocwupperid{Ifc2}~\rightarrow{}~$\ocwstring{"ifc"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Unknown}~\rightarrow{}~$\ocwstring{"unknown"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Cache}~\rightarrow{}~$\ocwstring{"Cache"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Comp}~(\ocwlowerid{\_},\ocwlowerid{ph})~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"preverbed\ocwvspace{}"}~\^{}~$\ocwlowerid{scl\_phase}~\ocwlowerid{ph}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Tad}~(\ocwlowerid{ph},\ocwlowerid{\_})~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"taddhita\ocwvspace{}"}~\^{}~$\ocwlowerid{scl\_phase}~\ocwlowerid{ph}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_scl\_morph}~\ocwlowerid{pvs}~\ocwlowerid{gen}~\ocwlowerid{form}~\ocwlowerid{tag}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{xml\_begin}~$\ocwstring{"tag"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwupperid{Morpho\_scl.}\ocwlowerid{print\_scl\_inflected}~\ocwlowerid{pvs}~\ocwlowerid{form}~\ocwlowerid{gen}~\ocwlowerid{tag}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{xml\_end}~$\ocwstring{"tag"}$)$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_scl\_tags}~\ocwlowerid{pvs}~\ocwlowerid{phase}~\ocwlowerid{form}~\ocwlowerid{tags}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{table}~\ocwlowerid{phase}~=~$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"tags"}~$[~($\ocwstring{"phase"},$\ocwlowerid{scl\_phase}~\ocwlowerid{phase})~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{table}~\ocwlowerid{phase})~$\ocweol
\ocwindent{1.00em}
;~$\ocwupperid{List.}\ocwlowerid{iter}~(\ocwlowerid{print\_scl\_morph}~\ocwlowerid{pvs}~(\ocwlowerid{generative}~\ocwlowerid{phase})~\ocwlowerid{form})~\ocwlowerid{tags}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{xml\_end}~$\ocwstring{"tags"}$)$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Used in Parser 
\ocweol
\label{lexer.ml:5287}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{extract\_lemma}~\ocwlowerid{phase}~\ocwlowerid{word}~=~$\ocweol
\ocwindent{0.50em}
\ocwkw{match}~$\ocwlowerid{tags\_of}~\ocwlowerid{phase}~\ocwlowerid{word}~$\ocwkw{with}~\ocweol
\ocwindent{0.50em}
$[~\ocwupperid{Atomic}~\ocwlowerid{tags}~\rightarrow{}~\ocwlowerid{tags}~$\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwupperid{Preverbed}~(\ocwlowerid{\_},\ocwlowerid{phase})~\ocwlowerid{pvs}~\ocwlowerid{form}~\ocwlowerid{tags}~\rightarrow{}~$\ocwbc{} tags to be trimmed to \ocwbegindcode{}$\ocwlowerid{ok\_tags}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{if}~$\ocwlowerid{pvs}~=~[\,]~$\ocwkw{then}~$\ocwlowerid{tags}~$\ocweol
\ocwindent{2.50em}
\ocwkw{else}~$\ocwlowerid{trim\_tags}~(\ocwlowerid{generative}~\ocwlowerid{phase})~\ocwlowerid{form}~(\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{pvs})~\ocwlowerid{tags}~$\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwupperid{Taddhita}~\ocwlowerid{\_}~\ocwlowerid{\_}~\ocwlowerid{\_}~\ocwlowerid{tags}~\rightarrow{}~\ocwlowerid{tags}$\ocweol
\ocwindent{0.50em}
$]$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwbc{} Returns the offset correction (used by SL interface) \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{process\_transition}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},\ocwlowerid{v})~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{off}~=~$\ocwkw{if}~$\ocwlowerid{w}=[\,]~$\ocwkw{then}~1~\ocwbc{} amui/lopa from Lopa/Lopak \ocwec{}\ocweol
\ocwindent{11.00em}
\ocwkw{else}~$\ocwlowerid{length}~\ocwlowerid{w}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{off}~-~(\ocwlowerid{length}~\ocwlowerid{u}~+~\ocwlowerid{length}~\ocwlowerid{v})~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Id}~\rightarrow{}~0$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_transition}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},\ocwlowerid{v})~\rightarrow{}~\ocwupperid{Morpho\_html.}\ocwlowerid{print\_sandhi}~\ocwlowerid{u}~\ocwlowerid{v}~\ocwlowerid{w}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Id}~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_sfx\_tags}~\ocwlowerid{sfx}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{tag}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{\_}~=~\ocwlowerid{print\_morph}~[\,]~\ocwupperid{False}~0~\ocwupperid{False}~\ocwlowerid{sfx}~1~\ocwlowerid{tag}~$\ocwkw{in}~$()$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Multiple\ocwvspace{}sfx\ocwvspace{}tag"}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{process\_kridanta}~\ocwlowerid{pvs}~\ocwlowerid{seg\_num}~\ocwlowerid{phase}~\ocwlowerid{form}~\ocwlowerid{tags}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{table\_morph\_of}~\ocwlowerid{phase})~$\ocwbc{} table begin \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{ok\_tags}~=~$\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{pvs}~=~[\,]~$\ocwkw{then}~$\ocwlowerid{tags}~$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$\ocwlowerid{trim\_tags}~(\ocwlowerid{generative}~\ocwlowerid{phase})~\ocwlowerid{form}~(\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{pvs})~\ocwlowerid{tags}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\ocwbc{} NB Existence of the segment guarantees that \ocwbegindcode{}$\ocwlowerid{ok\_tags}$\ocwenddcode{} is not empty \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{print\_tags}~\ocwlowerid{pvs}~\ocwlowerid{seg\_num}~\ocwlowerid{phase}~\ocwlowerid{form}~\ocwlowerid{ok\_tags}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{table\_end}~$\ocwbc{} table end \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}~$\ocweol
\ocwindent{1.00em}
;~$(\ocwlowerid{phase},\ocwlowerid{form},\ocwlowerid{ok\_tags})$\ocweol
\ocwindent{1.00em}
\}\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{process\_taddhita}~\ocwlowerid{pvs}~\ocwlowerid{seg\_num}~\ocwlowerid{phase}~\ocwlowerid{stem}~\ocwlowerid{sfx\_phase}~\ocwlowerid{sfx}~\ocwlowerid{sfx\_tags}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gen}~=~\ocwlowerid{generative}~\ocwlowerid{phase}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{cached}~=~\ocwupperid{False}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{ptag}~=~\ocwlowerid{print\_morph\_tad}~\ocwlowerid{pvs}~\ocwlowerid{cached}~\ocwlowerid{seg\_num}~\ocwlowerid{gen}~\ocwlowerid{stem}~\ocwlowerid{sfx}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{table\_morph\_of}~\ocwlowerid{sfx\_phase})~$\ocwbc{} table begin \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{\_}~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{ptag}~1~\ocwlowerid{sfx\_tags}~$\ocwkw{in}~$()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{table\_end}~$\ocwbc{} table end \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}~$\ocweol
\ocwindent{1.00em}
;~$(\ocwlowerid{sfx\_phase},\ocwlowerid{sfx},\ocwlowerid{sfx\_tags})$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Same structure as \ocwbegindcode{}$\ocwupperid{Interface}.\ocwlowerid{print\_morpho}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_morpho}~\ocwlowerid{phase}~\ocwlowerid{word}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{table\_morph\_of}~\ocwlowerid{phase})~$\ocwbc{} table begin \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{span\_begin}~\ocwupperid{Latin12})~$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{\_}~=$\ocweol
\ocwindent{3.50em}
\ocwkw{match}~$\ocwlowerid{tags\_of}~\ocwlowerid{phase}~\ocwlowerid{word}~$\ocwkw{with}~\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Atomic}~\ocwlowerid{tags}~\rightarrow{}~$\ocweol
\ocwindent{5.00em}
$\ocwlowerid{process\_kridanta}~[\,]~0~\ocwlowerid{phase}~\ocwlowerid{word}~\ocwlowerid{tags}$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Preverbed}~(\ocwlowerid{\_},\ocwlowerid{phase})~\ocwlowerid{pvs}~\ocwlowerid{form}~\ocwlowerid{tags}~\rightarrow{}~$\ocweol
\ocwindent{5.00em}
$\ocwlowerid{process\_kridanta}~\ocwlowerid{pvs}~0~\ocwlowerid{phase}~\ocwlowerid{form}~\ocwlowerid{tags}$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Taddhita}~(\ocwlowerid{ph},\ocwlowerid{form})~\ocwlowerid{sfx}~\ocwlowerid{sfx\_phase}~\ocwlowerid{sfx\_tags}~\rightarrow{}~$\ocweol
\ocwindent{6.00em}
\ocwkw{match}~$\ocwlowerid{tags\_of}~\ocwlowerid{ph}~\ocwlowerid{form}~$\ocwkw{with}~\ocweol
\ocwindent{6.00em}
$[~\ocwupperid{Atomic}~\ocwlowerid{\_}~\rightarrow{}~$\ocwbc{} stem, tagged as iic \ocwec{}\ocweol
\ocwindent{7.00em}
$\ocwlowerid{process\_taddhita}~[\,]~0~\ocwlowerid{ph}~\ocwlowerid{form}~\ocwlowerid{sfx\_phase}~\ocwlowerid{sfx}~\ocwlowerid{sfx\_tags}~$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Preverbed}~\ocwlowerid{\_}~\ocwlowerid{pvs}~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~$\ocwbc{} stem, tagged as iic \ocwec{}\ocweol
\ocwindent{7.00em}
$\ocwlowerid{process\_taddhita}~\ocwlowerid{pvs}~0~\ocwlowerid{ph}~\ocwlowerid{form}~\ocwlowerid{sfx\_phase}~\ocwlowerid{sfx}~\ocwlowerid{sfx\_tags}~$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Anomaly:\ocwvspace{}taddhita\ocwvspace{}recursion"}\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.50em}
$]~$\ocwkw{in}~$()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{span\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{table\_end}~$\ocwbc{} table end \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Segment printing with phonetics without semantics for Reader \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_segment}~\ocwlowerid{offset}~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwlowerid{transition})~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~$\ocwstring{"[\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
;~$\ocwupperid{Morpho\_html.}\ocwlowerid{print\_signifiant\_off}~\ocwlowerid{rword}~\ocwlowerid{offset}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_morpho}~\ocwlowerid{phase}~(\ocwlowerid{mirror}~\ocwlowerid{rword})$\ocweol
\ocwindent{1.00em}
\ocwbc{} Now we print the sandhi transition \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\&lang;"}~\ocwbc{} < \ocwec{}~\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{correction}~=~\ocwlowerid{process\_transition}~\ocwlowerid{transition}~$\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{print\_transition}~\ocwlowerid{transition}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{pl}~$\ocwstring{"\&rang;]"}~\ocwbc{} >] \ocwec{}\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{offset}+\ocwlowerid{correction}+\ocwlowerid{length}~\ocwlowerid{rword}$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwbc{} Similarly for \ocwbegindcode{}$\ocwlowerid{scl\_plugin}$\ocwenddcode{} mode (without offset and transitions) \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Called from \ocwbegindcode{}$\ocwupperid{Scl\_parser}.\ocwlowerid{print\_scl\_output}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_scl\_segment}~\ocwlowerid{counter}~(\ocwlowerid{phase},\ocwlowerid{rword})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{word}~=~\ocwupperid{Morpho\_html.}\ocwlowerid{visargify}~\ocwlowerid{rword}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~\ocwkw{let}~$\ocwlowerid{solid}~=~\ocwlowerid{background}~(\ocwupperid{Disp.}\ocwlowerid{color\_of\_phase}~\ocwlowerid{phase})~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{pl}~(\ocwlowerid{td\_begin\_class}~\ocwlowerid{solid})$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{ic}~=~\ocwlowerid{string\_of\_int}~\ocwlowerid{counter}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{ps}~($\ocwstring{"\ensuremath{<}input\ocwvspace{}type=\symbol{92}"hidden\symbol{92}"\ocwvspace{}name=\symbol{92}"field"}~\^{}~$\ocwlowerid{ic}~$\^{}~\ocwstring{"\symbol{92}"\ocwvspace{}value='\ensuremath{<}form\ocwvspace{}wx=\symbol{92}""}\ocweol
\ocwindent{4.00em}
\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode\_WX}~\ocwlowerid{word}~$\^{}~\ocwstring{"\symbol{92}"/\ensuremath{>}"}$)$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{tags\_of}~\ocwlowerid{phase}~(\ocwlowerid{mirror}~\ocwlowerid{rword})~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Atomic}~\ocwlowerid{tags}~\rightarrow{}$\ocweol
\ocwindent{5.00em}
$\ocwlowerid{print\_scl\_tags}~[\,]~\ocwlowerid{phase}~\ocwlowerid{word}~\ocwlowerid{tags}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Preverbed}~(\ocwlowerid{\_},\ocwlowerid{phase})~\ocwlowerid{pvs}~\ocwlowerid{form}~\ocwlowerid{tags}~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{ok\_tags}~=~$\ocweol
\ocwindent{5.50em}
\ocwkw{if}~$\ocwlowerid{pvs}~=~[\,]~$\ocwkw{then}~$\ocwlowerid{tags}~$\ocweol
\ocwindent{5.50em}
\ocwkw{else}~$\ocwlowerid{trim\_tags}~(\ocwlowerid{generative}~\ocwlowerid{phase})~\ocwlowerid{form}~(\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{pvs})~\ocwlowerid{tags}~$\ocwkw{in}\ocweol
\ocwindent{5.00em}
$\ocwlowerid{print\_scl\_tags}~\ocwlowerid{pvs}~\ocwlowerid{phase}~\ocwlowerid{form}~\ocwlowerid{ok\_tags}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Taddhita}~(\ocwlowerid{\_},\ocwlowerid{form})~\ocwlowerid{sfx}~\ocwlowerid{sfx\_phase}~\ocwlowerid{sfx\_tags}~\rightarrow{}$\ocweol
\ocwindent{6.00em}
\ocwkw{let}~$\ocwlowerid{taddhitanta\_phase}~=~$\ocwkw{match}~$\ocwlowerid{sfx\_phase}~$\ocwkw{with}~\ocweol
\ocwindent{8.00em}
$[~\ocwupperid{Sfx}~\rightarrow{}~\ocwupperid{Noun}$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{Isfx}~\rightarrow{}~\ocwupperid{Iic}$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Wrong\ocwvspace{}taddhita\ocwvspace{}structure"}\ocweol
\ocwindent{8.00em}
$]~$\ocweol
\ocwindent{6.00em}
\ocwkw{and}~$\ocwlowerid{taddhitanta\_stem}~=~\ocwlowerid{form}~@~\ocwlowerid{sfx}~$\ocwbc{} very experimental \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{6.00em}
$\ocwlowerid{print\_scl\_tags}~[\,]~\ocwlowerid{taddhitanta\_phase}~\ocwlowerid{taddhitanta\_stem}~\ocwlowerid{sfx\_tags}~$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"'\ensuremath{>}"}~\ocwbc{} closes <input \ocwec{}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwupperid{Canon.}\ocwlowerid{unidevcode}~\ocwlowerid{word})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{td\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\symbol{92}n"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{counter}+1$\ocweol
\ocwindent{1.00em}
\}~\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_labels}~\ocwlowerid{tags}~\ocwlowerid{seg\_num}~=~$\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}~$\ocwbc{} begin labels \ocwec{}~\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{table\_labels}$\ocweol
\ocwindent{2.00em}
;~\ocwkw{let}~$\ocwlowerid{print\_label}~\ocwlowerid{n}~\ocwlowerid{\_}~=~$\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{cell}~(\ocwlowerid{html\_red}~(\ocwlowerid{string\_of\_int}~\ocwlowerid{seg\_num}~$\^{}~\ocwstring{"."}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{n})))$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{n}+1$\ocweol
\ocwindent{4.00em}
\}~\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{\_}~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{print\_label}~1~\ocwlowerid{tags}~$\ocwkw{in}~$()~$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{table\_end}~$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}~$\ocwbc{} end labels \ocwec{}\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} syntactico/semantical roles analysis, function of declension \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_roles}~\ocwlowerid{pr\_sem}~\ocwlowerid{phase}~\ocwlowerid{tags}~\ocwlowerid{form}~=~$\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}~$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{table\_role\_of}~\ocwlowerid{phase})$\ocweol
\ocwindent{2.00em}
;~\ocwkw{let}~$\ocwlowerid{pr\_roles}~(\ocwlowerid{delta},\ocwlowerid{sems})~=~$\ocwkw{do}~\ocweol
\ocwindent{3.50em}
\{~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}~$\ocweol
\ocwindent{3.50em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}~$\ocweol
\ocwindent{3.50em}
;~\ocwkw{let}~$\ocwlowerid{word}~=~\ocwlowerid{patch}~\ocwlowerid{delta}~\ocwlowerid{form}~$\ocwkw{in}~\ocweol
\ocwindent{4.50em}
$\ocwlowerid{pr\_sem}~\ocwlowerid{word}~\ocwlowerid{sems}~$\ocweol
\ocwindent{3.50em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}$\ocweol
\ocwindent{3.50em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}~$\ocweol
\ocwindent{3.50em}
\}~\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{pr\_roles}~\ocwlowerid{tags}~$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{table\_end}~$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}~$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Segment printing without phonetics with semantics for Parser \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_segment\_roles}~\ocwlowerid{print\_sems}~\ocwlowerid{seg\_num}~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwlowerid{\_})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{word}~=~\ocwlowerid{mirror}~\ocwlowerid{rword}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwupperid{Morpho\_html.}\ocwlowerid{print\_signifiant\_yellow}~\ocwlowerid{rword}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$(\ocwlowerid{decl\_phase},\ocwlowerid{form},\ocwlowerid{decl\_tags})~=~$\ocwkw{match}~$\ocwlowerid{tags\_of}~\ocwlowerid{phase}~\ocwlowerid{word}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Atomic}~\ocwlowerid{tags}~\rightarrow{}~$\ocweol
\ocwindent{5.00em}
$\ocwlowerid{process\_kridanta}~[\,]~\ocwlowerid{seg\_num}~\ocwlowerid{phase}~\ocwlowerid{word}~\ocwlowerid{tags}$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Preverbed}~(\ocwlowerid{\_},\ocwlowerid{phase})~\ocwlowerid{pvs}~\ocwlowerid{form}~\ocwlowerid{tags}~\rightarrow{}~$\ocweol
\ocwindent{5.00em}
$\ocwlowerid{process\_kridanta}~\ocwlowerid{pvs}~\ocwlowerid{seg\_num}~\ocwlowerid{phase}~\ocwlowerid{form}~\ocwlowerid{tags}$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{Taddhita}~(\ocwlowerid{ph},\ocwlowerid{form})~\ocwlowerid{sfx}~\ocwlowerid{sfx\_phase}~\ocwlowerid{sfx\_tags}~\rightarrow{}~$\ocweol
\ocwindent{6.00em}
\ocwkw{match}~$\ocwlowerid{tags\_of}~\ocwlowerid{ph}~\ocwlowerid{form}~$\ocwkw{with}~\ocweol
\ocwindent{6.00em}
$[~\ocwupperid{Atomic}~\ocwlowerid{\_}~\rightarrow{}~$\ocwbc{} stem, tagged as iic \ocwec{}\ocweol
\ocwindent{7.00em}
$\ocwlowerid{process\_taddhita}~[\,]~\ocwlowerid{seg\_num}~\ocwlowerid{ph}~\ocwlowerid{form}~\ocwlowerid{sfx\_phase}~\ocwlowerid{sfx}~\ocwlowerid{sfx\_tags}~$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Preverbed}~\ocwlowerid{\_}~\ocwlowerid{pvs}~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~$\ocwbc{} stem, tagged as iic \ocwec{}\ocweol
\ocwindent{7.00em}
$\ocwlowerid{process\_taddhita}~\ocwlowerid{pvs}~\ocwlowerid{seg\_num}~\ocwlowerid{ph}~\ocwlowerid{form}~\ocwlowerid{sfx\_phase}~\ocwlowerid{sfx}~\ocwlowerid{sfx\_tags}~$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"taddhita\ocwvspace{}recursion\ocwvspace{}unavailable"}\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.50em}
$]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{print\_labels}~\ocwlowerid{decl\_tags}~\ocwlowerid{seg\_num}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{print\_roles}~\ocwlowerid{print\_sems}~\ocwlowerid{decl\_phase}~\ocwlowerid{decl\_tags}~\ocwlowerid{form}$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
\}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{project}~\ocwlowerid{n}~$\ocwbt{list}~=~$\ocwupperid{List.}\ocwlowerid{nth}~$\ocwbt{list}~$(\ocwlowerid{n}-1)~$\ocwbc{} Ocaml's nth starts at 0 \ocwec{}\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_unitag}~\ocwlowerid{pvs}~\ocwlowerid{phase}~\ocwlowerid{word}~\ocwlowerid{multitags}~(\ocwlowerid{n},\ocwlowerid{m})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{delta},\ocwlowerid{polytag})~=~\ocwlowerid{project}~\ocwlowerid{n}~\ocwlowerid{multitags}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{unitag}~=~[~\ocwlowerid{project}~\ocwlowerid{m}~\ocwlowerid{polytag}~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{pl}~(\ocwlowerid{table\_morph\_of}~\ocwlowerid{phase})~$\ocwbc{} table of color of phase begins \ocwec{}\ocweol
\ocwindent{2.50em}
;~\ocwkw{let}~$\ocwlowerid{\_}~=~$\ocwbc{} print unique tagging \ocwec{}\ocweol
\ocwindent{3.50em}
$\ocwlowerid{print\_morph}~\ocwlowerid{pvs}~\ocwupperid{False}~0~(\ocwlowerid{generative}~\ocwlowerid{phase})~\ocwlowerid{word}~0~(\ocwlowerid{delta},\ocwlowerid{unitag})~$\ocwkw{in}~$()$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{ps}~\ocwlowerid{table\_end}~$\ocwbc{} table of color of phase ends \ocwec{}\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}$\ocweol
\ocwindent{2.50em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_uni\_taddhita}~\ocwlowerid{pvs}~\ocwlowerid{m}~\ocwlowerid{phase}~\ocwlowerid{stem}~\ocwlowerid{sfx}~\ocwlowerid{sfx\_phase}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~(\ocwlowerid{delta},\ocwlowerid{polytag})~]~\rightarrow{}~$\ocwbc{} we assume n=1 taddhita form unambiguous \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{unitag}~=~[~\ocwlowerid{project}~\ocwlowerid{m}~\ocwlowerid{polytag}~]~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{gen}~=~\ocwlowerid{generative}~\ocwlowerid{phase}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{cached}~=~\ocwupperid{False}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}~$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{table\_morph\_of}~\ocwlowerid{sfx\_phase})~$\ocwbc{} table begin \ocwec{}\ocweol
\ocwindent{2.00em}
;~\ocwkw{let}~$\ocwlowerid{\_}~=~\ocwlowerid{print\_morph\_tad}~\ocwlowerid{pvs}~\ocwlowerid{cached}~0~\ocwlowerid{gen}~\ocwlowerid{stem}~\ocwlowerid{sfx}~0~(\ocwlowerid{delta},\ocwlowerid{unitag})~$\ocwkw{in}~$()$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{table\_end}~$\ocwbc{} table end \ocwec{}~\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Multiple\ocwvspace{}sfx\ocwvspace{}tag"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_projection}~\ocwlowerid{phase}~\ocwlowerid{rword}~((\ocwlowerid{\_},\ocwlowerid{m})~$\ocwkw{as}~$\ocwlowerid{index})~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}~$\ocwbc{} tr begins \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwupperid{Morpho\_html.}\ocwlowerid{print\_signifiant\_yellow}~\ocwlowerid{rword}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{word}~=~\ocwlowerid{mirror}~\ocwlowerid{rword}~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwlowerid{tags\_of}~\ocwlowerid{phase}~\ocwlowerid{word}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Atomic}~\ocwlowerid{tags}~\rightarrow{}~\ocwlowerid{print\_unitag}~[\,]~\ocwlowerid{phase}~\ocwlowerid{word}~\ocwlowerid{tags}~\ocwlowerid{index}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Preverbed}~(\ocwlowerid{\_},\ocwlowerid{phase})~\ocwlowerid{pvs}~\ocwlowerid{form}~\ocwlowerid{tags}~\rightarrow{}~\ocwlowerid{print\_unitag}~\ocwlowerid{pvs}~\ocwlowerid{phase}~\ocwlowerid{word}~\ocwlowerid{tags}~\ocwlowerid{index}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Taddhita}~(\ocwlowerid{ph},\ocwlowerid{form})~\ocwlowerid{sfx}~\ocwlowerid{sfx\_phase}~\ocwlowerid{sfx\_tags}~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{match}~$\ocwlowerid{tags\_of}~\ocwlowerid{ph}~\ocwlowerid{form}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Atomic}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{print\_uni\_taddhita}~[\,]~\ocwlowerid{m}~\ocwlowerid{phase}~\ocwlowerid{form}~\ocwlowerid{sfx}~\ocwlowerid{sfx\_phase}~\ocwlowerid{sfx\_tags}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Preverbed}~\ocwlowerid{\_}~\ocwlowerid{pvs}~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~$\ocweol
\ocwindent{11.00em}
$\ocwlowerid{print\_uni\_taddhita}~\ocwlowerid{pvs}~\ocwlowerid{m}~\ocwlowerid{phase}~\ocwlowerid{form}~\ocwlowerid{sfx}~\ocwlowerid{sfx\_phase}~\ocwlowerid{sfx\_tags}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"taddhita\ocwvspace{}recursion\ocwvspace{}unavailable"}~\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{2.00em}
$]~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}~$\ocwbc{} tr ends \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_proj}~\ocwlowerid{phase}~\ocwlowerid{rword}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Projection\ocwvspace{}missing"}\ocweol
\ocwindent{1.50em}
$\mid{}~[~\ocwlowerid{n\_m}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.50em}
\{~$\ocwlowerid{print\_projection}~\ocwlowerid{phase}~\ocwlowerid{rword}~\ocwlowerid{n\_m}~$\ocweol
\ocwindent{3.50em}
;~$\ocwlowerid{rest}~$\ocwbc{} returns the rest of projections stream \ocwec{}\ocweol
\ocwindent{3.50em}
\}\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\label{lexer.ml:13624}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Report\_chan}~=~$\ocwkw{struct}~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{chan}~=~\ocwupperid{Control.}\ocwlowerid{out\_chan};~$\ocwbc{} where to report \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{end};\medskip

\label{lexer.ml:13712}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Morpho\_out}~=~\ocwupperid{Morpho.Morpho\_out}~\ocwupperid{Report\_chan};$\medskip

\ocwendcode{}\ocwindent{0.00em}
Recording of selected solution - used only in Regression 
\ocweol
\label{lexer.ml:13827}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{record\_tagging}~\ocwlowerid{unsandhied}~\ocwlowerid{mode\_sent}~\ocwlowerid{mode\_trans}~\ocwlowerid{all}~\ocwlowerid{sentence}~\ocwlowerid{output}~\ocwlowerid{proj}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{report}~=~\ocwlowerid{output\_string}~\ocwupperid{Control.out\_chan.}\ocwlowerid{val}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{print\_proj1}~\ocwlowerid{phase}~\ocwlowerid{rword}~\ocwlowerid{proj}~\ocwlowerid{prevs}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\ocwbc{} adapted from \ocwbegindcode{}$\ocwlowerid{print\_proj}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{report}~$\ocwstring{"\$\{"}\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{form}~=~\ocwlowerid{mirror}~\ocwlowerid{rword}~$\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{report}~(\ocwlowerid{decode}~\ocwlowerid{form})$\ocweol
\ocwindent{2.00em}
;~\ocwkw{let}~$\ocwlowerid{res}~=~$\ocwkw{match}~$\ocwlowerid{proj}~$\ocwkw{with}~\ocweol
\ocwindent{5.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Projection\ocwvspace{}missing"}\ocweol
\ocwindent{5.50em}
$\mid{}~[~(\ocwlowerid{n},\ocwlowerid{m})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{7.00em}
\ocwkw{let}~$\ocwlowerid{gen}~=~\ocwlowerid{generative}~\ocwlowerid{phase}~$\ocwkw{in}\ocweol
\ocwindent{7.00em}
\ocwkw{let}~$\ocwlowerid{polytag}~=~\ocwlowerid{extract\_lemma}~\ocwlowerid{phase}~\ocwlowerid{form}~$\ocwkw{in}\ocweol
\ocwindent{7.00em}
\ocwkw{let}~$(\ocwlowerid{delta},\ocwlowerid{tags})~=~\ocwlowerid{project}~\ocwlowerid{n}~\ocwlowerid{polytag}~$\ocwkw{in}~\ocweol
\ocwindent{7.00em}
\ocwkw{let}~$\ocwlowerid{tagging}~=~[~\ocwlowerid{project}~\ocwlowerid{m}~\ocwlowerid{tags}~]~$\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{8.00em}
\{~$\ocwlowerid{report}~$\ocwstring{":"}\ocweol
\ocwindent{8.00em}
;~$\ocwlowerid{report}~(\ocwlowerid{string\_of\_phase}~\ocwlowerid{phase}~$\^{}~\ocwstring{""}$)$\ocweol
\ocwindent{8.00em}
;~$\ocwupperid{Morpho\_out.}\ocwlowerid{report\_morph}~\ocwlowerid{gen}~\ocwlowerid{form}~(\ocwlowerid{delta},\ocwlowerid{tagging})~$\ocweol
\ocwindent{8.00em}
;~$(\ocwlowerid{rest},[\,])~$\ocwbc{} returns the rest of projections stream \ocwec{}\ocweol
\ocwindent{8.00em}
\}\ocweol
\ocwindent{5.50em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{do}~\{~$\ocwlowerid{report}~$\ocwstring{"\}\$\&"};~$\ocwlowerid{res}~\}$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
\}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{report}~($\ocwkw{if}~$\ocwupperid{Control.full.}\ocwlowerid{val}~$\ocwkw{then}~\ocwstring{"[\{C\}]\ocwvspace{}"}~\ocwkw{else}~\ocwstring{"[\{S\}]\ocwvspace{}"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{report}~($\ocwkw{if}~$\ocwlowerid{unsandhied}~$\ocwkw{then}~\ocwstring{"\ensuremath{<}\{F\}\ensuremath{>}\ocwvspace{}"}~\ocwkw{else}~\ocwstring{"\ensuremath{<}\{T\}\ensuremath{>}\ocwvspace{}"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{report}~($\ocwkw{if}~$\ocwlowerid{mode\_sent}~$\ocwkw{then}~\ocwstring{"|\{Sent\}|\ocwvspace{}"}~\ocwkw{else}~\ocwstring{"|\{Word\}|\ocwvspace{}"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{report}~($\ocwstring{"\#\{"}~\^{}~$\ocwlowerid{mode\_trans}~$\^{}~\ocwstring{"\}\#\ocwvspace{}"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{report}~($\ocwstring{"(\{"}~\^{}~$\ocwlowerid{sentence}~$\^{}~\ocwstring{"\})"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{report}~($\ocwstring{"\ocwvspace{}["}~\^{}~$(\ocwlowerid{string\_of\_int}~\ocwlowerid{all})~$\^{}~\ocwstring{"]\ocwvspace{}"}$)$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{pp}~(\ocwlowerid{proj},\ocwlowerid{prevs})~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{proj}~$\ocwkw{with}~\ocweol
\ocwindent{6.00em}
$[~[\,]~\rightarrow{}~()~$\ocwbc{} finished, projections exhausted \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Too\ocwvspace{}many\ocwvspace{}projections"}\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{2.00em}
$\mid{}~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwlowerid{\_})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwbc{} sandhi ignored \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{proj\_prevs}~=~\ocwlowerid{print\_proj1}~\ocwlowerid{phase}~\ocwlowerid{rword}~\ocwlowerid{proj}~\ocwlowerid{prevs}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{pp}~\ocwlowerid{proj\_prevs}~\ocwlowerid{rest}~$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~$\ocwlowerid{pp}~(\ocwlowerid{proj},[\,])~\ocwlowerid{output}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{report}~$\ocwstring{"\symbol{92}n"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{close\_out}~\ocwupperid{Report\_chan.chan.}\ocwlowerid{val}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Structured entries with generative morphology \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{gen\_morph}~=$\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Gen\_krid}~$\ocwkw{of}~$(($\ocwbt{string}~$\times{}~\ocwlowerid{word})~\times{}~(\ocwlowerid{verbal}~\times{}~\ocwlowerid{word}))$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwupperid{Lexical}~$\ocwkw{of}~$\ocwlowerid{word}$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwupperid{Preverbs\_list}~$\ocwkw{of}~\ocwbt{list}~$\ocwlowerid{word}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{morph\_list}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{a}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwupperid{Morpho\_string.}\ocwlowerid{string\_morph}~\ocwlowerid{a}~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}~$\ocwlowerid{morph\_list}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{decode\_list}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{a}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwupperid{Canon.}\ocwlowerid{decode\_ref}~\ocwlowerid{a}~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}~$\ocwlowerid{decode\_list}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{string\_of\_tag}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~(\ocwlowerid{x},\ocwlowerid{y},\ocwlowerid{a},\ocwlowerid{b})~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{y}~=~\ocwupperid{Pv}~$\ocwkw{then}~\ocwstring{"\$\{"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode\_ref}~\ocwlowerid{x}~$\^{}~\ocwstring{"\}\$\&"}\ocweol
\ocwindent{8.50em}
\ocwkw{else}~\ocwstring{"\$\{"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode\_ref}~\ocwlowerid{x}~$\^{}~\ocwstring{":"}~\^{}~$\ocwlowerid{string\_of\_phase}~\ocwlowerid{y}$\ocweol
\ocwindent{11.00em}
\^{}~\ocwstring{"\{\ocwvspace{}"}~\^{}~$\ocwlowerid{morph\_list}~\ocwlowerid{b}~$\^{}~\ocwstring{"\}"}~\^{}~\ocwstring{"["}~\ocweol
\ocwindent{11.00em}
\^{}~\ocwkw{match}~$\ocwlowerid{a}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~\ocwupperid{Gen\_krid}~((\ocwlowerid{z},~\ocwlowerid{c}),(\ocwlowerid{d},~\ocwlowerid{e}))~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
$\ocwlowerid{z}~$\^{}~\ocwstring{":"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode\_ref}~\ocwlowerid{c}~$\^{}~\ocwstring{"\ocwvspace{}\{\ocwvspace{}"}~\^{}~$\ocwupperid{Morpho\_string.}\ocwlowerid{string\_verbal}~\ocwlowerid{d}$\ocweol
\ocwindent{4.00em}
\^{}~\ocwstring{"\ocwvspace{}\}["}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode\_ref}~\ocwlowerid{e}~$\^{}~\ocwstring{"]"}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Lexical}~\ocwlowerid{c}~\rightarrow{}~\ocwupperid{Canon.}\ocwlowerid{decode\_ref}~\ocwlowerid{c}$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Preverbs\_list}~\ocwlowerid{c}~\rightarrow{}~\ocwlowerid{decode\_list}~\ocwlowerid{c}$\ocweol
\ocwindent{2.50em}
$]~$\^{}~\ocwstring{"]\}\$\&"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{return\_morph}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{a}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{string\_of\_tag}~\ocwlowerid{a}~$\^{}~$\ocwlowerid{return\_morph}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{generative\_stem}~\ocwlowerid{gen}~\ocwlowerid{stem}~=~$\ocweol
\ocwindent{1.50em}
\ocwkw{if}~$\ocwlowerid{gen}~$\ocwkw{then}~\ocwbc{} interpret stem as unique name \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$(\ocwlowerid{homo},\ocwlowerid{bare\_stem})~=~\ocwupperid{Naming.}\ocwlowerid{homo\_undo}~\ocwlowerid{stem}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{krid\_infos}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{bare\_stem}~\ocwupperid{Naming.}\ocwlowerid{unique\_kridantas}~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$(\ocwlowerid{vb},\ocwlowerid{root})~=~\ocwupperid{Naming.}\ocwlowerid{look\_up\_homo}~\ocwlowerid{homo}~\ocwlowerid{krid\_infos}~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{look\_up\_stem}~=$\ocweol
\ocwindent{6.00em}
\ocwkw{match}~$\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{stem}~\ocwupperid{Naming.}\ocwlowerid{lexical\_kridantas}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[\,]~$\ocwbc{} not in lexicon \ocwec{}~$\rightarrow{}~($\ocwstring{"G"},$\ocwlowerid{bare\_stem})$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~$\ocwbc{} stem is lexical entry \ocwec{}~$\rightarrow{}~($\ocwstring{"L"},$\ocwlowerid{stem})$\ocweol
\ocwindent{6.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwupperid{Gen\_krid}~(\ocwlowerid{look\_up\_stem},(\ocwlowerid{vb},\ocwlowerid{root}))$\ocweol
\ocwindent{1.50em}
\ocwkw{else}~$\ocwupperid{Lexical}~\ocwlowerid{stem}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Applicative version of \ocwbegindcode{}$\ocwupperid{Morpho}.\ocwlowerid{report\_morph}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{lex\_cat}~\ocwlowerid{phase}~=~\ocwlowerid{phase}~;$\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{get\_morph}~\ocwlowerid{gen}~\ocwlowerid{phase}~\ocwlowerid{form}~(\ocwlowerid{delta},\ocwlowerid{morphs})~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwlowerid{patch}~\ocwlowerid{delta}~\ocwlowerid{form}~$\ocwkw{in}~\ocwbc{} stem may have homo index \ocwec{}\ocweol
\ocwindent{1.00em}
$(\ocwlowerid{form},~\ocwlowerid{lex\_cat}~\ocwlowerid{phase},~\ocwlowerid{generative\_stem}~\ocwlowerid{gen}~\ocwlowerid{stem},~\ocwlowerid{morphs})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{return\_tagging}~\ocwlowerid{output}~\ocwlowerid{projs}~=~$\ocwbc{} Used only in Regression \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{get\_tags}~\ocwlowerid{phase}~\ocwlowerid{rword}~\ocwlowerid{projs}~=~$\ocwbc{} adapted from \ocwbegindcode{}$\ocwlowerid{print\_proj}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{form}~=~\ocwlowerid{mirror}~\ocwlowerid{rword}~$\ocwkw{in}~\ocweol
\ocwindent{2.50em}
\ocwkw{match}~$\ocwlowerid{tags\_of}~\ocwlowerid{phase}~\ocwlowerid{form}~$\ocwkw{with}\ocweol
\ocwindent{2.50em}
$[~\ocwupperid{Atomic}~\ocwlowerid{polytag}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{projs}~$\ocwkw{with}~\ocweol
\ocwindent{5.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Projection\ocwvspace{}missing"}\ocweol
\ocwindent{5.50em}
$\mid{}~[~(\ocwlowerid{n},\ocwlowerid{m})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{7.00em}
\ocwkw{let}~$\ocwlowerid{gen}~=~\ocwlowerid{generative}~\ocwlowerid{phase}~$\ocwkw{in}\ocweol
\ocwindent{7.00em}
\ocwkw{let}~$(\ocwlowerid{delta},\ocwlowerid{tags})~=~\ocwlowerid{project}~\ocwlowerid{n}~\ocwlowerid{polytag}~$\ocwkw{in}\ocweol
\ocwindent{7.00em}
\ocwkw{let}~$\ocwlowerid{tagging}~=~[~\ocwlowerid{project}~\ocwlowerid{m}~\ocwlowerid{tags}~]~$\ocwkw{in}~\ocweol
\ocwindent{7.00em}
\ocwkw{let}~$\ocwlowerid{entry}~=~\ocwlowerid{get\_morph}~\ocwlowerid{gen}~\ocwlowerid{phase}~\ocwlowerid{form}~(\ocwlowerid{delta},\ocwlowerid{tagging})~$\ocwkw{in}\ocweol
\ocwindent{7.00em}
$(\ocwlowerid{rest},~\ocwlowerid{lex\_cat}~\ocwlowerid{phase},~\ocwlowerid{entry})$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Not\ocwvspace{}implemented\ocwvspace{}yet"}~$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{taggings}~\ocwlowerid{accu}~\ocwlowerid{projs}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.50em}
$[~[\,]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{projs}~$\ocwkw{with}~\ocweol
\ocwindent{6.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{accu}$\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Too\ocwvspace{}many\ocwvspace{}projections"}\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwlowerid{\_})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwbc{} sandhi ignored \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{let}~$(\ocwlowerid{new\_projs},\ocwlowerid{phase},\ocwlowerid{tags})~=~\ocwlowerid{get\_tags}~\ocwlowerid{phase}~\ocwlowerid{rword}~\ocwlowerid{projs}~$\ocwkw{in}\ocweol
\ocwindent{5.00em}
$\ocwlowerid{taggings}~[~\ocwlowerid{tags}~::~\ocwlowerid{accu}~]~\ocwlowerid{new\_projs}~\ocwlowerid{rest}~$\ocweol
\ocwindent{2.50em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{return\_morph}~(\ocwupperid{List.}\ocwlowerid{rev}~(\ocwlowerid{taggings}~[\,]~\ocwlowerid{projs}~\ocwlowerid{output}))$\ocweol
\ocwindent{0.00em}
;\medskip

\label{lexer.ml:18531}%
\ocwindent{0.00em}
\ocwkw{end};\ocweol
\ocwendcode{}\typeout{OcamlWeb file Rank.ml}
\ocwmodule{Rank}
\label{rank.ml:0}%
This library is used by Reader and Regression. It constructs a lexer Lex, 
   indexed on parameters \ocwbegindcode{}$\ocwlowerid{iterate}$\ocwenddcode{} and \ocwbegindcode{}$\ocwlowerid{complete}$\ocwenddcode{}. Using the module 
   \ocwbegindcode{}$\ocwupperid{Constraints}$\ocwenddcode{} for ranking, it computes a penalty for each solution, 
   and returns all solutions with minimal penalties, with a further preference 
   for the solutions having a minimum number of segments.
   It manages buckets of solutions ranked by penalties and lengths. 
\ocweol
\label{rank.ml:1078}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Constraints};~$\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{roles\_of}~\ocwlowerid{extract}~\ocwlowerid{sort\_flatten}~\ocwlowerid{truncate\_groups}~\ocwlowerid{eval\_penalty}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{tag\_sort}$\ocwenddcode{} \ocwec{}\medskip

\label{rank.ml:1200}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Prel}~=~$\ocwkw{struct}~\ocweol
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{prelude}~()~=~\ocwupperid{Web.}\ocwlowerid{reader\_prelude}~\ocwupperid{Web.}\ocwlowerid{reader\_title};$\ocweol
\ocwindent{0.50em}
\ocwkw{end}~\ocwbc{} Prel \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Global parameters of the lexer \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{iterate}~=~$\ocwbt{ref}~$\ocwupperid{True}~$\ocwbc{} by default a chunk is a list of words \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{complete}~=~$\ocwbt{ref}~$\ocwupperid{True}~$\ocwbc{} by default we call the fuller segmenter \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{output\_channel}~=~$\ocwbt{ref}~$\ocwlowerid{stdout}~$\ocwbc{} by default cgi output on standard output \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Lexer\_control}~=~$\ocwkw{struct}\ocweol
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{star}~=~\ocwlowerid{iterate};$\ocweol
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{full}~=~\ocwlowerid{complete};$\ocweol
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{out\_chan}~=~\ocwlowerid{output\_channel}$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwkw{end}~\ocwbc{} \ocwbegindcode{}$\ocwupperid{Lexer\_control}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Multi-phase lexer \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Lex}~=~\ocwupperid{Lexer.Lexer}~\ocwupperid{Prel}~\ocwupperid{Lexer\_control}~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{un\_analyzable}~\ocwupperid{Disp}~\ocwupperid{Viccheda}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Builds the penalty stack, grouping together equi-penalty items. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Beware, \ocwbegindcode{}$\ocwlowerid{make\_groups}$\ocwenddcode{} reverses the list of tags. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{make\_groups}~\ocwlowerid{tagger}~=~\ocwlowerid{comp\_rec}~1~[\,]~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{comp\_rec}~\ocwlowerid{seg}~\ocwlowerid{stack}~=~$\ocwkw{fun}~\ocwbc{} going forward in time \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{stack}~$\ocwbc{} result goes backward in time \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwlowerid{\_})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwbc{} we ignore euphony transition \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{word}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rword}~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{lemma}~=~\ocwlowerid{tagger}~\ocwlowerid{phase}~\ocwlowerid{word}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{keep}~=~[~\ocwlowerid{roles\_of}~\ocwlowerid{seg}~\ocwlowerid{word}~\ocwlowerid{lemma}~::~\ocwlowerid{stack}~]~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{comp\_rec}~(\ocwlowerid{seg}+1)~\ocwlowerid{keep}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Compute minimum penalty in Parse mode \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{minimum\_penalty}~\ocwlowerid{output}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{tagger}~=~\ocwupperid{Lex.}\ocwlowerid{extract\_lemma}$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{out}~=~\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{output}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{groups}~=~\ocwlowerid{make\_groups}~\ocwlowerid{tagger}~\ocwlowerid{out}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{groups}=[\,]~$\ocwkw{then}~$\ocwlowerid{failwith}~$\ocwstring{"Empty\ocwvspace{}penalty\ocwvspace{}stack\ocwvspace{}!!"}~\ocwkw{else}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{sort\_groups}~=~\ocwlowerid{sort\_flatten}~\ocwlowerid{groups}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{min\_pen}~=~$\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwlowerid{sort\_groups}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Empty\ocwvspace{}penalty\ocwvspace{}stack"}~\ocweol
\ocwindent{2.00em}
$\mid{}~[~(\ocwlowerid{pen},\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{pen}$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{eval\_penalty}~\ocwlowerid{min\_pen}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Compound minimum path penalty with solution length \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{process\_output}~\ocwlowerid{filter\_mode}~((\ocwlowerid{\_},\ocwlowerid{output})~$\ocwkw{as}~$\ocwlowerid{sol})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{length\_penalty}~=~$\ocwkw{if}~$\ocwlowerid{filter\_mode}~$\ocwkw{then}~$\ocwupperid{List.}\ocwlowerid{length}~\ocwlowerid{output}~$\ocwkw{else}~0~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$(\ocwlowerid{pen},\ocwlowerid{sol})~\ocwlowerid{where}~\ocwlowerid{pen}~=~$\ocweol
\ocwindent{6.00em}
\ocwkw{let}~$\ocwlowerid{min}~=~$\ocwkw{if}~$\ocwlowerid{filter\_mode}~\land{}~\ocwlowerid{iterate.}\ocwlowerid{val}~$\ocwkw{then}~$\ocwlowerid{minimum\_penalty}~\ocwlowerid{output}~$\ocweol
\ocwindent{11.00em}
\ocwkw{else}~0~\ocwbc{} keep all \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{6.00em}
$(\ocwlowerid{min}+\ocwlowerid{length\_penalty},\ocwlowerid{min})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{tagging}~=~(\ocwupperid{Phases.Phases.}\ocwlowerid{phase}~\times{}~\ocwupperid{Word.}\ocwlowerid{word}~\times{}~\ocwupperid{Lex.Disp.}\ocwlowerid{transition})~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{solution}~=~$\ocwbt{list}~$\ocwlowerid{tagging}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{ranked\_solution}~=~($\ocwbt{int}~\ocwbc{} rank \ocwec{}~$\times{}~\ocwlowerid{solution})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{bucket}~=~($\ocwbt{int}~\ocwbc{} length \ocwec{}~$\times{}~$\ocwbt{list}~$\ocwlowerid{ranked\_solution})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{1.00em}
\ocwbc{} \ocwbegindcode{}$\ocwupperid{Solutions}~\ocwupperid{None}~\ocwlowerid{sols}~\ocwlowerid{saved}$\ocwenddcode{} gives solutions sols within truncation limit;
     \ocwbegindcode{}$\ocwupperid{Solutions}~(\ocwupperid{Some}~\ocwlowerid{n})~\ocwlowerid{sols}~\ocwlowerid{saved}$\ocwenddcode{} returns solutions sols within total n,
     saved is the list of solutions of penalty 0 and worse length penalty. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Solutions}~$\ocwkw{of}~\ocwbt{option}~\ocwbt{int}~\ocwkw{and}~\ocwbt{list}~$\ocwlowerid{ranked\_solution}~$\ocwkw{and}~\ocwbt{list}~$\ocwlowerid{bucket}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} What follows is absurd combinatorial code linearizing the set of solutions
   to chunk segmentation, exponential in the length of the chunk.
   This deprecated code is legacy from the naive parser. 
   It is usable only in demos on small sentences.  \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Constructs a triple (p, sols, saved) where sols is the list of all (m,sol) 
   such that ranked sol has minimal length penalty p and absolute penalty m 
   and saved is the list of all ranked sols of length penalty > p and 
   absolute penalty 0, arranged in buckets by increasing length penalty 
\ocweol
\label{rank.ml:4224}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{insert}~((\ocwlowerid{pen},\ocwlowerid{min}),\ocwlowerid{sol})~((\ocwlowerid{min\_pen},\ocwlowerid{sols},\ocwlowerid{saved})~$\ocwkw{as}~$\ocwlowerid{current})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{sols}~=~[\,]~$\ocwkw{then}~$(\ocwlowerid{pen},[~(\ocwlowerid{min},\ocwlowerid{sol})~],[\,])$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{pen}>\ocwlowerid{min\_pen}~$\ocwkw{then}~\ocwkw{if}~$\ocwlowerid{min}>0~$\ocwkw{then}~$\ocwlowerid{current}~$\ocwbc{} sol is thrown away \ocwec{}\ocweol
\ocwindent{13.50em}
\ocwkw{else}~$(\ocwlowerid{min\_pen},\ocwlowerid{sols},\ocwupperid{List2.}\ocwlowerid{in\_bucket}~\ocwlowerid{pen}~\ocwlowerid{sol}~\ocwlowerid{saved})$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{pen}=\ocwlowerid{min\_pen}~$\ocwkw{then}~$(\ocwlowerid{min\_pen},[~(\ocwlowerid{min},\ocwlowerid{sol})~::~\ocwlowerid{sols}~],\ocwlowerid{saved})$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~$(\ocwlowerid{pen},[~(\ocwlowerid{min},\ocwlowerid{sol})~],\ocwlowerid{resc})~\ocwlowerid{where}~\ocwlowerid{resc}~=$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{save}~(\ocwlowerid{min},\ocwlowerid{sol})~\ocwlowerid{rescued}~=~$\ocwkw{if}~$\ocwlowerid{min}=0~$\ocwkw{then}~$[~\ocwlowerid{sol}~::~\ocwlowerid{rescued}~]~$\ocweol
\ocwindent{19.00em}
\ocwkw{else}~$\ocwlowerid{rescued}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{rescue}~=~\ocwupperid{List.}\ocwlowerid{fold\_right}~\ocwlowerid{save}~\ocwlowerid{sols}~[\,]~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwkw{if}~$\ocwlowerid{rescue}=[\,]~$\ocwkw{then}~$\ocwlowerid{saved}~$\ocwkw{else}~$[~(\ocwlowerid{min\_pen},\ocwlowerid{rescue})~::~\ocwlowerid{saved}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Forget absolute penalties of solutions with minimal length penalty \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} also used to erase constraints - thus do not eta-reduce !!! \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{trim}~\ocwlowerid{x}~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwlowerid{snd}~\ocwlowerid{x}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} overflow is None or (Some n) when n solutions with n<Web.truncation \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{emit}~\ocwlowerid{overflow}~(\ocwlowerid{\_},\ocwlowerid{sols},\ocwlowerid{saved})~=~$\ocwbc{} really weird control structure \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{raise}~(\ocwupperid{Solutions}~\ocwlowerid{overflow}~(\ocwlowerid{trim}~\ocwlowerid{sols})~\ocwlowerid{saved})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Depth-first search in a stack of type \ocwbegindcode{}\ocwbt{list}~$(\ocwlowerid{output}~\times{}~\ocwlowerid{resumption})$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{dove\_tail}~\ocwlowerid{filter\_mode}~\ocwlowerid{init}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{init\_stack}~=~\ocwlowerid{trim}~\ocwlowerid{init}~$\ocwbc{} erasing constraints \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{dtrec}~1~(0,[\,],[\,])~\ocwlowerid{init\_stack}~$\ocwbc{} exits raising exception Solutions \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{dtrec}~\ocwlowerid{n}~\ocwlowerid{kept}~\ocwlowerid{stack}~=~$\ocwbc{} invariant: |stack|=|init|=number of chunks \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{n}~>~\ocwupperid{Web.}\ocwlowerid{truncation}~$\ocwkw{then}~$\ocwlowerid{emit}~\ocwupperid{None}~\ocwlowerid{kept}~$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwkw{let}~$\ocwlowerid{full\_output}~=~\ocwupperid{List.}\ocwlowerid{fold\_right}~\ocwlowerid{conc}~\ocwlowerid{stack}~[\,]$\ocweol
\ocwindent{12.50em}
$\ocwlowerid{where}~\ocwlowerid{conc}~(\ocwlowerid{o},\ocwlowerid{\_})~\ocwlowerid{oo}~=~\ocwlowerid{o}~@~\ocwlowerid{oo}~$\ocwkw{in}~\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{pen\_sol}~=~\ocwlowerid{process\_output}~\ocwlowerid{filter\_mode}~(\ocwlowerid{n},\ocwlowerid{full\_output})~$\ocwkw{in}~\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{kept\_sols}~=~\ocwlowerid{insert}~\ocwlowerid{pen\_sol}~\ocwlowerid{kept}~$\ocwkw{in}~\ocweol
\ocwindent{3.50em}
$\ocwlowerid{dtrec}~(\ocwlowerid{n}+1)~\ocwlowerid{kept\_sols}~(\ocwlowerid{crank}~[\,]~\ocwlowerid{init}~\ocwlowerid{stack})$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{crank}~\ocwlowerid{acc}~\ocwlowerid{ini}~=~$\ocwkw{fun}\ocweol
\ocwindent{4.50em}
$[~[~(\ocwlowerid{\_},\ocwlowerid{c})~::~\ocwlowerid{cc}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{ini}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~(\ocwlowerid{constraints},\ocwlowerid{i})~::~\ocwlowerid{ii}~]~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{7.00em}
\{~$\ocwupperid{Lex.Viccheda.}\ocwlowerid{set\_offset}~\ocwlowerid{constraints}$\ocweol
\ocwindent{7.00em}
;~\ocwkw{match}~$\ocwupperid{Lex.Viccheda.}\ocwlowerid{continue}~\ocwlowerid{c}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~\ocwupperid{Some}~\ocwlowerid{next}~\rightarrow{}~\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{acc}~[~\ocwlowerid{next}~::~\ocwlowerid{cc}~]$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{crank}~[~\ocwlowerid{i}~::~\ocwlowerid{acc}~]~\ocwlowerid{ii}~\ocwlowerid{cc}$\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{7.00em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Failure}~$\ocwstring{"dove\_tail"}$)~$\ocwbc{} does not occur by invariant \ocwec{}\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{4.50em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{emit}~(\ocwupperid{Some}~\ocwlowerid{n})~\ocwlowerid{kept\_sols}~$\ocwbc{} dove-tailing finished \ocwec{}\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} From Interface: splitting checkpoints into current and future ones \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{split\_check}~\ocwlowerid{limit}~=~\ocwlowerid{split\_rec}~[\,]$\ocweol
\ocwindent{1.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{split\_rec}~\ocwlowerid{acc}~\ocwlowerid{checkpts}~=~$\ocwkw{match}~$\ocwlowerid{checkpts}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~(\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{acc},[\,])$\ocweol
\ocwindent{3.00em}
$\mid{}~[~((\ocwlowerid{index},\ocwlowerid{\_},\ocwlowerid{\_})~$\ocwkw{as}~$\ocwlowerid{check})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{index}~>~\ocwlowerid{limit}~$\ocwkw{then}~$(\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{acc},\ocwlowerid{checkpts})$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{split\_rec}~[~\ocwlowerid{check}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}~$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{segment\_chunks\_filter}~\ocwlowerid{filter\_mode}~\ocwlowerid{chunks}~\ocwlowerid{cpts}~=~$\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$(\ocwlowerid{\_},\ocwlowerid{constrained\_segs})~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{init}~((0,\ocwlowerid{cpts}),[\,])~\ocwlowerid{chunks}$\ocweol
\ocwindent{1.50em}
$\ocwlowerid{where}~\ocwlowerid{init}~((\ocwlowerid{offset},\ocwlowerid{checkpoints}),\ocwlowerid{stack})~\ocwlowerid{chunk}~=~$\ocwkw{do}\ocweol
\ocwindent{1.50em}
\{~\ocwkw{let}~$\ocwlowerid{ini\_cont}~=~\ocwupperid{Lex.Viccheda.}\ocwlowerid{init\_segment}~\ocwlowerid{chunk}~$\ocwkw{in}~\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{chunk\_length}~=~\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{chunk}~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{extremity}~=~\ocwlowerid{offset}+\ocwlowerid{chunk\_length}~$\ocwkw{in}~\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$(\ocwlowerid{local},\ocwlowerid{future})~=~\ocwlowerid{split\_check}~\ocwlowerid{extremity}~\ocwlowerid{checkpoints}~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{chunk\_constraints}~=~(\ocwlowerid{offset},\ocwlowerid{local})~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
$((\ocwlowerid{succ}~\ocwlowerid{extremity},\ocwlowerid{future}),~$\ocwkw{do}~\ocweol
\ocwindent{4.00em}
\{~$\ocwupperid{Lex.Viccheda.}\ocwlowerid{set\_offset}~\ocwlowerid{chunk\_constraints}~$\ocwbc{} Sets local constraints \ocwec{}\ocweol
\ocwindent{4.00em}
;~\ocwkw{let}~$\ocwlowerid{res}~=~$\ocwkw{match}~$\ocwupperid{Lex.Viccheda.}\ocwlowerid{continue}~\ocwlowerid{ini\_cont}~$\ocwkw{with}\ocweol
\ocwindent{7.00em}
$[~\ocwupperid{Some}~\ocwlowerid{c}~\rightarrow{}~\ocwlowerid{c}~$\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~\ocwupperid{Lex.}\ocwlowerid{un\_analyzable}~\ocwlowerid{chunk}$\ocweol
\ocwindent{7.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{5.00em}
$[~(\ocwlowerid{chunk\_constraints},\ocwlowerid{res})~::~\ocwlowerid{stack}~]$\ocweol
\ocwindent{4.00em}
\}$)~$\ocweol
\ocwindent{1.50em}
\}~\ocwkw{in}\ocweol
\ocwindent{1.50em}
$\ocwlowerid{dove\_tail}~\ocwlowerid{filter\_mode}~\ocwlowerid{constrained\_segs}~$\ocweol
\ocwindent{0.00em}
;\medskip

\label{rank.ml:7607}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{segment\_all}~\ocwlowerid{filter\_mode}~\ocwlowerid{chunks}~\ocwlowerid{cpts}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{segment\_chunks\_filter}~\ocwlowerid{filter\_mode}~\ocwlowerid{chunks}~\ocwlowerid{cpts}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Scl_parser.ml}
\ocwmodule{Scl\_parser}
\label{scl_parser.ml:0}%
Module \ocwbegindcode{}$\ocwupperid{Scl\_parser}$\ocwenddcode{} used as interface with UoH dependency parser 
\ocweol
\label{scl_parser.ml:691}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};~$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps pl etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocwbc{} inflected lemma morphology \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phases};~$\ocwbc{} Phases \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Dispatcher};~$\ocwbc{} Dispatch \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{SCLpaths};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{scl\_url}~\ocwlowerid{scl\_cgi}~\ocwlowerid{default\_output\_font}$\ocwenddcode{} \ocwec{}\medskip

\label{scl_parser.ml:900}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Prel}~=~$\ocwkw{struct}~\ocweol
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{prelude}~()~=~\ocwupperid{Web.}\ocwlowerid{reader\_prelude}~\ocwupperid{Web.}\ocwlowerid{reader\_title};$\ocweol
\ocwindent{0.50em}
\ocwkw{end}~\ocwbc{} Prel \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Global parameters of the lexer \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{iterate}~=~$\ocwbt{ref}~$\ocwupperid{True}~$\ocwbc{} by default a chunk is a list of words \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{complete}~=~$\ocwbt{ref}~$\ocwupperid{True}~$\ocwbc{} by default we call the fuller segmenter \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{output\_channel}~=~$\ocwbt{ref}~$\ocwlowerid{stdout}~$\ocwbc{} by default cgi output on standard output \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Lexer\_control}~=~$\ocwkw{struct}\ocweol
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{star}~=~\ocwlowerid{iterate};$\ocweol
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{full}~=~\ocwlowerid{complete};$\ocweol
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{out\_chan}~=~\ocwlowerid{output\_channel}$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwkw{end}~\ocwbc{} \ocwbegindcode{}$\ocwupperid{Lexer\_control}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Multi-phase lexer \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Lex}~=~\ocwupperid{Lexer.Lexer}~\ocwupperid{Prel}~\ocwupperid{Lexer\_control}~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{print\_scl\_segment}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_scl\_output}~\ocwlowerid{output}~=~$\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwupperid{Lex.}\ocwlowerid{print\_scl\_segment}~1~(\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{output})~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_scl\_solutions}~\ocwlowerid{s}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{\_}~=~\ocwlowerid{print\_scl\_output}~\ocwlowerid{s}~$\ocwkw{in}~$()$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Invocation of UoH's CSL parser for dependency graph display \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_scl1}~(\ocwlowerid{solutions}~:~$\ocwbt{list}~$(\ocwupperid{Phases.}\ocwlowerid{phase}~\times{}~\ocwupperid{Word.}\ocwlowerid{word}))~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{svg\_interface\_url}~=~\ocwlowerid{scl\_cgi}~$\^{}~\ocwstring{"SHMT/"}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~($\ocwstring{"\ensuremath{<}script\ocwvspace{}type=\symbol{92}"text/javascript\symbol{92}"\ocwvspace{}src=\symbol{92}""}~\^{}~$\ocwlowerid{scl\_url}~$\^{}~\ocwstring{"js\_files/dragtable.js\symbol{92}"\ensuremath{>}\ensuremath{<}/script\ensuremath{>}"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~($\ocwstring{"\ensuremath{<}form\ocwvspace{}name=\symbol{92}"word\symbol{45}order\symbol{92}"\ocwvspace{}method=\symbol{92}"POST\symbol{92}"\ocwvspace{}action\ocwvspace{}=\ocwvspace{}\symbol{92}""}\ocweol
\ocwindent{3.50em}
\^{}~$\ocwlowerid{svg\_interface\_url}~$\^{}~\ocwstring{"prog/Word\_order/call\_heritage2anu.cgi\symbol{92}"\ensuremath{>}\symbol{92}n"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~($\ocwstring{"\ensuremath{<}table\ocwvspace{}class=\symbol{92}"draggable\symbol{92}"\ensuremath{>}"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_scl\_solutions}~\ocwlowerid{solutions}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~($\ocwstring{"\ensuremath{<}td\ensuremath{>}\ensuremath{<}input\ocwvspace{}type=\symbol{92}"hidden\symbol{92}"\ocwvspace{}name=\symbol{92}"DISPLAY\symbol{92}"\ocwvspace{}value=\symbol{92}""}~\^{}~$\ocwlowerid{default\_output\_font}~$\^{}\ocwstring{"\symbol{92}"/\ensuremath{>}\ensuremath{<}/td\ensuremath{>}"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{table\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{submit\_input}~$\ocwstring{"Submit"}$)$\ocweol
\ocwindent{1.00em}
\}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We restrict to the first solution - TEMPORARY \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_scl}~\ocwlowerid{sols}~=~$\ocwkw{match}~$\ocwlowerid{sols}~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"No\ocwvspace{}sol"}\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{s}~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{print\_scl1}~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} end; \ocwec{}\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Reader.ml}
\ocwmodule{Reader}
\label{reader.ml:0}%
CGI-bin sktreader alias Reader for segmentation, tagging and parsing. 
   Reads its input in shell variable \ocwbegindcode{}$\ocwupperid{QUERY\_STRING}$\ocwenddcode{} URI-encoded. 
   This CGI is triggered by page \ocwbegindcode{}$\ocwlowerid{reader\_page}$\ocwenddcode{} created by \ocwbegindcode{}$\ocwlowerid{sktreader}$\ocwenddcode{}. 
   It prints an HTML document giving segmentation/tagging of input on stdout. 

   It invokes Rank to construct the lexer Lex, compute penalties of its various 
   solutions, and return all solutions with minimal penalties. 
\ocweol
\ocwindent{0.00em}
This is mostly legacy code, being superseded by sharing Interface module 
\ocweol
\label{reader.ml:1435}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Encode};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{switch\_code}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Canon};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};~$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps pl abort etc. \ocwbegindcode{}$\ocwlowerid{remote\_server\_host}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Cgi};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{get}~\ocwlowerid{decode\_url}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phases};~$\ocwbc{} \ocwbegindcode{}$\ocwupperid{Phases}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Rank};~$\ocwbc{} \ocwbegindcode{}$\ocwupperid{Prel}~\ocwupperid{Lex}~\ocwlowerid{segment\_all}~\ocwlowerid{iterate}$\ocwenddcode{} \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Reader interface 
\ocweol
\ocwindent{0.00em}
Mode parameter of the reader. Controled by service Reader for respectively
   tagging, shallow parsing, or dependency analysis with the UoH parser.  
\ocweol
\ocwindent{0.00em}
Note that Summary/Interface is not a Reader/Parser mode. 
\ocweol
\label{reader.ml:1898}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{mode}~=~[~\ocwupperid{Tag}~\mid{}~\ocwupperid{Parse}~\mid{}~\ocwupperid{Analyse}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rpc}~=~\ocwlowerid{remote\_server\_host}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{remote}~=~$\ocwbt{ref}~$\ocwupperid{False}~$\ocwbc{} local invocation of cgi by default \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{call\_parser}~\ocwlowerid{text}~\ocwlowerid{sol}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{cgi}~=~\ocwlowerid{parser\_cgi}~$\^{}~\ocwstring{"?"}~\^{}~$\ocwlowerid{text}~$\^{}~\ocwstring{"p;n="}~\^{}~$\ocwlowerid{sol}~$\ocwkw{in}\ocweol
\ocwindent{6.00em}
\ocwbc{} same remark as below: this assumes mode is last parameter \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{invocation}~=~$\ocwkw{if}~$\ocwlowerid{remote.}\ocwlowerid{val}~$\ocwkw{then}~$\ocwlowerid{rpc}~$\^{}~$\ocwlowerid{cgi}~$\ocwkw{else}~$\ocwlowerid{cgi}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{anchor}~\ocwupperid{Green\_}~\ocwlowerid{invocation}~\ocwlowerid{check\_sign}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{call\_graph}~\ocwlowerid{text}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{cgi}~=~\ocwlowerid{graph\_cgi}~$\^{}~\ocwstring{"?"}~\^{}~$\ocwlowerid{text}~$\^{}~\ocwstring{"g"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{invocation}~=~$\ocwkw{if}~$\ocwlowerid{remote.}\ocwlowerid{val}~$\ocwkw{then}~$\ocwlowerid{rpc}~$\^{}~$\ocwlowerid{cgi}~$\ocwkw{else}~$\ocwlowerid{cgi}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{anchor}~\ocwupperid{Green\_}~\ocwlowerid{invocation}~\ocwlowerid{check\_sign}$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Prints n-th solution 
\ocweol
\ocwindent{0.00em}
ind is relative index within kept, n is absolute index within max 
\ocweol
\label{reader.ml:2570}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_solution}~\ocwlowerid{text}~\ocwlowerid{ind}~(\ocwlowerid{n},\ocwlowerid{output})~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{hr}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{span\_begin}~\ocwupperid{Blue\_})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"Solution\ocwvspace{}"};~$\ocwlowerid{print\_int}~\ocwlowerid{n};~\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}:\ocwvspace{}"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{call\_parser}~\ocwlowerid{text}~(\ocwlowerid{string\_of\_int}~\ocwlowerid{n}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{span\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{\_}~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwupperid{Lex.}\ocwlowerid{print\_segment}~0~(\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{output})~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{ind}+1$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
General display of solutions, in the various modes     
\ocweol
\label{reader.ml:3072}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_sols}~\ocwlowerid{text}~\ocwlowerid{revsols}~=~$\ocwbc{} stats = (kept,max) \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{process\_sol}~=~\ocwlowerid{print\_solution}~\ocwlowerid{text}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{\_}~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{process\_sol}~1~\ocwlowerid{revsols}~$\ocwkw{in}~$()$\ocweol
\ocwindent{0.00em}
;\medskip

\label{reader.ml:3228}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display}~\ocwlowerid{limit}~\ocwlowerid{mode}~\ocwlowerid{text}~\ocwlowerid{saved}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{saved}$\ocwenddcode{} is the list of all solutions of penalty 0 when 
     \ocwbegindcode{}$\ocwlowerid{filter\_mode}$\ocwenddcode{} of \ocwbegindcode{}$\ocwlowerid{process\_input}$\ocwenddcode{} is True,
     otherwise it lists all the solutions. \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{pl}~(\ocwlowerid{html\_blue}~$\ocwstring{"No\ocwvspace{}solution\ocwvspace{}found"}$);~\ocwlowerid{pl}~\ocwlowerid{html\_break}~\}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{best\_sols}~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{kept}~=~\ocwupperid{List.}\ocwlowerid{length}~\ocwlowerid{best\_sols}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{max}~=~$\ocwkw{match}~$\ocwlowerid{limit}~$\ocwkw{with}~\ocweol
\ocwindent{7.00em}
$[~\ocwupperid{Some}~\ocwlowerid{n}~\rightarrow{}~\ocwlowerid{n}~\mid{}~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{truncation}~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~\ocwkw{if}~$\ocwlowerid{mode}~=~\ocwupperid{Analyse}~$\ocwkw{then}~$()~$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{4.50em}
\{~$\ocwlowerid{print\_sols}~\ocwlowerid{text}~$\ocwbc{}kept,max\ocwec{}~$\ocwlowerid{best\_sols}$\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{pl}~\ocwlowerid{hr}~$\ocweol
\ocwindent{4.50em}
;~\ocwkw{if}~$\ocwlowerid{limit}~=~\ocwupperid{None}~$\ocwkw{then}~\ocwkw{do}\ocweol
\ocwindent{7.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{html\_blue}~$\ocwstring{"Output\ocwvspace{}truncated\ocwvspace{}at\ocwvspace{}"}$)~$\ocweol
\ocwindent{7.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{span\_begin}~\ocwupperid{Red\_})$\ocweol
\ocwindent{7.00em}
;~$\ocwlowerid{print\_int}~\ocwlowerid{truncation}$\ocweol
\ocwindent{7.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{span\_end}$\ocweol
\ocwindent{7.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{html\_blue}~$\ocwstring{"\ocwvspace{}solutions"}$)~$\ocweol
\ocwindent{7.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{7.00em}
\}~\ocwkw{else}~$()$\ocweol
\ocwindent{4.50em}
\}\ocweol
\ocwindent{2.00em}
;~\ocwkw{match}~$\ocwlowerid{mode}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Parse}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{4.50em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{html\_magenta}~(\ocwlowerid{string\_of\_int}~\ocwlowerid{kept}))$\ocweol
\ocwindent{4.50em}
;~\ocwkw{let}~$\ocwlowerid{mess}~=~$\ocwstring{"\ocwvspace{}solution"}~\^{}~$($\ocwkw{if}~$\ocwlowerid{kept}=1~$\ocwkw{then}~\ocwstring{""}~\ocwkw{else}~\ocwstring{"s"}$)$\ocweol
\ocwindent{17.00em}
\^{}~\ocwstring{"\ocwvspace{}kept\ocwvspace{}among\ocwvspace{}"}~\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{ps}~(\ocwlowerid{html\_blue}~\ocwlowerid{mess})$\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{ps}~(\ocwlowerid{html\_magenta}~(\ocwlowerid{string\_of\_int}~\ocwlowerid{max}))$\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{4.50em}
;~\ocwkw{if}~$\ocwlowerid{kept}<\ocwlowerid{max}~$\ocwkw{then}~\ocwkw{do}\ocweol
\ocwindent{7.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{html\_blue}~$\ocwstring{"Filtering\ocwvspace{}efficiency:\ocwvspace{}"}$)~$\ocweol
\ocwindent{7.00em}
;~\ocwkw{let}~$\ocwlowerid{eff}~=~(\ocwlowerid{max}-\ocwlowerid{kept})\times{}100/(\ocwlowerid{max}-1)~$\ocwkw{in}~\ocweol
\ocwindent{8.00em}
$\ocwlowerid{pl}~(\ocwlowerid{html\_magenta}~(\ocwlowerid{string\_of\_int}~\ocwlowerid{eff}~$\^{}~\ocwstring{"\%"}$))$\ocweol
\ocwindent{7.00em}
\}~\ocwkw{else}~$()$\ocweol
\ocwindent{4.50em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{4.50em}
;~\ocwkw{match}~$\ocwlowerid{saved}~$\ocwkw{with}~\ocweol
\ocwindent{5.50em}
$[~[\,]~\rightarrow{}~()$\ocweol
\ocwindent{5.50em}
$\mid{}~[~(\ocwlowerid{\_},\ocwlowerid{min\_buck})~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{7.50em}
\ocwbc{} we print only the upper layer of saved \ocwec{}\ocweol
\ocwindent{6.50em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{6.50em}
;~$\ocwlowerid{ps}~(\ocwlowerid{html\_red}~$\ocwstring{"Additional\ocwvspace{}candidate\ocwvspace{}solutions"}$)$\ocweol
\ocwindent{6.50em}
;~\ocwkw{let}~$\ocwlowerid{min\_sols}~=~\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{min\_buck}~$\ocwkw{in}~\ocweol
\ocwindent{7.50em}
$\ocwlowerid{print\_sols}~\ocwlowerid{text}~$\ocwbc{}kept,max\ocwec{}~$\ocwlowerid{min\_sols}~$\ocweol
\ocwindent{6.50em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{6.50em}
\}\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{4.50em}
\}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Analyse}~\rightarrow{}~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{best\_sols}:~$\ocwbt{list}~$($\ocwbt{int}~$\times{}~$\ocwbt{list}~$\ocwupperid{Rank}.\ocwupperid{Lex}.\ocwupperid{Disp}.\ocwlowerid{segment})$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{solutions}~=~$\ocwkw{match}~$\ocwlowerid{saved}~$\ocwkw{with}~\ocweol
\ocwindent{6.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{best\_sols}$\ocweol
\ocwindent{6.50em}
$\mid{}~[~(\ocwlowerid{\_},\ocwlowerid{min\_buck})~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{append}~\ocwlowerid{best\_sols}~(\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{min\_buck})$\ocweol
\ocwindent{6.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{forget\_transitions}~(\ocwlowerid{phase},\ocwlowerid{word},\ocwlowerid{\_})~=~(\ocwlowerid{phase},\ocwlowerid{word})~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{forget\_index}~(\ocwlowerid{\_},\ocwlowerid{segments})~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwlowerid{forget\_transitions}~\ocwlowerid{segments}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{segmentations}~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwlowerid{forget\_index}~\ocwlowerid{solutions}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$\ocwupperid{Scl\_parser.}\ocwlowerid{print\_scl}~\ocwlowerid{segmentations}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
NB This reader is parameterized by an encoding function, that parses the
   input as a list of words, according to various transliteration schemes.
   However, the use of "decode" below to compute the romanisation and devanagari
   renderings does a conversion through VH transliteration which may not be
   faithful to encodings which represent eg the sequence of phonemes t and h. 
\ocweol
\label{reader.ml:5994}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{process\_input}~\ocwlowerid{text}~\ocwlowerid{us}~\ocwlowerid{mode}~\ocwlowerid{topic}~(\ocwlowerid{input}:$\ocwbt{string}$)~\ocwlowerid{encode}~\ocwlowerid{cpts}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pieces}~=~\ocwupperid{Sanskrit.}\ocwlowerid{read\_raw\_sanskrit}~\ocwlowerid{encode}~\ocwlowerid{input}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{romapieces}~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwupperid{Canon.}\ocwlowerid{uniromcode}~\ocwlowerid{pieces}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{romainput}~=~\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{"\ocwvspace{}"}~$\ocwlowerid{romapieces}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{chunker}~=~$\ocwkw{if}~$\ocwlowerid{us}~$\ocwbc{} sandhi undone \ocwec{}~\ocwkw{then}~$\ocwupperid{Sanskrit.}\ocwlowerid{read\_raw\_sanskrit}~$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~\ocwbc{} blanks non-significant \ocwec{}~$\ocwupperid{Sanskrit.}\ocwlowerid{read\_sanskrit}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{chunks}~=~\ocwlowerid{chunker}~\ocwlowerid{encode}~\ocwlowerid{input}~$\ocwbc{} normalisation here \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{devachunks}~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwupperid{Canon.}\ocwlowerid{unidevcode}~\ocwlowerid{chunks}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{devainput}~=~\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{"\ocwvspace{}"}~$\ocwlowerid{devachunks}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"p"}~$[~($\ocwstring{"align"},\ocwstring{"center"}$)~])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{div\_begin}~\ocwupperid{Latin16})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{call\_graph}~\ocwlowerid{text}~$\^{}~\ocwstring{"\ocwvspace{}Show\ocwvspace{}Summary\ocwvspace{}of\ocwvspace{}Solutions"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{xml\_end}~$\ocwstring{"p"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~$\ocwstring{"Input:"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{roma16\_red\_sl}~\ocwlowerid{romainput})~$\ocwbc{} romanisation \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{hr}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~$\ocwstring{"Sentence:\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{deva16\_blue}~\ocwlowerid{devainput})~$\ocwbc{} devanagari \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwlowerid{mode}~=~\ocwupperid{Analyse}~$\ocwkw{then}~$()~$\ocwkw{else}~$\ocwlowerid{ps}~$\ocwstring{"may\ocwvspace{}be\ocwvspace{}analysed\ocwvspace{}as:"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{div\_end}~$\ocwbc{} Latin16 \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{all\_chunks}~=~$\ocwkw{match}~$\ocwlowerid{topic}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Some}~\ocwlowerid{topic}~\rightarrow{}~\ocwlowerid{chunks}~@~[~\ocwlowerid{code\_string}~\ocwlowerid{topic}~]$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{chunks}$\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{filter\_mode}~=~\ocwlowerid{mode}=\ocwupperid{Parse}~\lor{}~\ocwlowerid{mode}=\ocwupperid{Analyse}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{try}~$\ocwlowerid{segment\_all}~\ocwlowerid{filter\_mode}~\ocwlowerid{all\_chunks}~\ocwlowerid{cpts}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Solutions}~\ocwlowerid{limit}~\ocwlowerid{revsols}~\ocwlowerid{saved}~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{sols}~=~\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{revsols}~$\ocwkw{in}~\ocweol
\ocwindent{5.50em}
$\ocwlowerid{display}~\ocwlowerid{limit}~\ocwlowerid{mode}~\ocwlowerid{text}~\ocwlowerid{saved}~\ocwlowerid{sols}~$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{1.00em}
\}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sort\_check}~\ocwlowerid{cpts}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{compare\_index}~(\ocwlowerid{a},\ocwlowerid{\_},\ocwlowerid{\_})~(\ocwlowerid{b},\ocwlowerid{\_},\ocwlowerid{\_})~=~\ocwlowerid{compare}~\ocwlowerid{a}~\ocwlowerid{b}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{sort}~\ocwlowerid{compare\_index}~\ocwlowerid{cpts}$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Standard format of cgi arguments 
\ocweol
\label{reader.ml:7520}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{arguments}~\ocwlowerid{translit}~\ocwlowerid{lex}~\ocwlowerid{cache}~\ocwlowerid{st}~\ocwlowerid{us}~\ocwlowerid{cp}~\ocwlowerid{input}~\ocwlowerid{topic}~\ocwlowerid{abs}~\ocwlowerid{cpts}~=$\ocweol
\ocwindent{2.50em}
\ocwstring{"t="}~\^{}~$\ocwlowerid{translit}$\ocweol
\ocwindent{1.00em}
\^{}~\ocwstring{";lex="}~\^{}~$\ocwlowerid{lex}~$\ocweol
\ocwindent{1.00em}
\^{}~\ocwstring{";cache="}~\^{}~$\ocwlowerid{cache}~$\ocweol
\ocwindent{1.00em}
\^{}~\ocwstring{";st="}~\^{}~$\ocwlowerid{st}~$\ocweol
\ocwindent{1.00em}
\^{}~\ocwstring{";us="}~\^{}~$\ocwlowerid{us}~$\ocweol
\ocwindent{1.00em}
\^{}~\ocwstring{";cp="}~\^{}~$\ocwlowerid{cp}~$\ocweol
\ocwindent{1.00em}
\^{}~\ocwstring{";text="}~\^{}~$\ocwlowerid{input}~$\ocweol
\ocwindent{1.00em}
\^{}~\ocwstring{";topic="}~\^{}~$\ocwlowerid{topic}~$\ocweol
\ocwindent{1.00em}
\^{}~\ocwstring{";abs="}~\^{}~$\ocwlowerid{abs}~$\ocweol
\ocwindent{1.00em}
\^{}~\ocwstring{";cpts="}~\^{}~$\ocwupperid{Checkpoints.}\ocwlowerid{string\_points}~\ocwlowerid{cpts}~$\ocweol
\ocwindent{1.00em}
\^{}~\ocwstring{";mode="}~\ocwbc{} mode to be filled later \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Faster if only segmenting: no loading of \ocwbegindcode{}$\ocwlowerid{nouns\_file}$\ocwenddcode{}, \ocwbegindcode{}$\ocwlowerid{roots\_file}$\ocwenddcode{}, ... \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{reader\_engine}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwupperid{Prel.}\ocwlowerid{prelude}~()~$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{query}~=~$\ocwkw{try}~$\ocwupperid{Sys.}\ocwlowerid{getenv}~$\ocwstring{"QUERY\_STRING"}~\ocwkw{with}~\ocweol
\ocwindent{8.00em}
$[~\ocwupperid{Not\_found}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Environment\ocwvspace{}required"}~$]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{env}~=~\ocwlowerid{create\_env}~\ocwlowerid{query}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{url\_encoded\_input}~=~\ocwlowerid{get}~$\ocwstring{"text"}~$\ocwlowerid{env}~$\ocwstring{""}~\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_mode}~=~\ocwlowerid{get}~$\ocwstring{"mode"}~$\ocwlowerid{env}~$\ocwstring{"p"}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_topic}~=~\ocwlowerid{get}~$\ocwstring{"topic"}~$\ocwlowerid{env}~$\ocwstring{""}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{st}~=~\ocwlowerid{get}~$\ocwstring{"st"}~$\ocwlowerid{env}~$\ocwstring{"t"}~\ocwbc{} default vaakya rather than isolated pada \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{cp}~=~\ocwlowerid{get}~$\ocwstring{"cp"}~$\ocwlowerid{env}~$\ocwstring{"t"}~\ocwbc{} default Complete mode \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{us}~=~\ocwlowerid{get}~$\ocwstring{"us"}~$\ocwlowerid{env}~$\ocwstring{"f"}~\ocwbc{} default input sandhied \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{translit}~=~\ocwlowerid{get}~$\ocwstring{"t"}~$\ocwlowerid{env}~\ocwupperid{Paths.}\ocwlowerid{default\_transliteration}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{lex}~=~\ocwlowerid{get}~$\ocwstring{"lex"}~$\ocwlowerid{env}~\ocwupperid{Paths.}\ocwlowerid{default\_lexicon}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{cache}~=~\ocwlowerid{get}~$\ocwstring{"cache"}~$\ocwlowerid{env}~$\ocwstring{"f"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$()~=~\ocwlowerid{cache\_active.}\ocwlowerid{val}~:=~\ocwlowerid{cache}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{abs}~=~\ocwlowerid{get}~$\ocwstring{"abs"}~$\ocwlowerid{env}~$\ocwstring{"f"}~\ocwbc{} default local paths \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{lang}~=~\ocwupperid{Html.}\ocwlowerid{language\_of}~\ocwlowerid{lex}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{input}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_input}~$\ocwbc{} unnormalized string \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{uns}~=~\ocwlowerid{us}=$\ocwstring{"t"}~\ocwbc{} unsandhied vs sandhied corpus \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{encode}~=~\ocwlowerid{switch\_code}~\ocwlowerid{translit}~$\ocwbc{} encoding as a normalized word \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$()~=~\ocwupperid{Html.}\ocwlowerid{toggle\_lexicon}~\ocwlowerid{lex}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$()~=~$\ocwkw{if}~$\ocwlowerid{abs}=$\ocwstring{"t"}~\ocwkw{then}~$\ocwlowerid{remote.}\ocwlowerid{val}:=\ocwupperid{True}~$\ocwkw{else}~$()~$\ocwbc{} Web service mode \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$()~=~$\ocwkw{if}~$\ocwlowerid{st}=$\ocwstring{"f"}~\ocwkw{then}~$\ocwlowerid{iterate.}\ocwlowerid{val}:=\ocwupperid{False}~$\ocwkw{else}~$()~$\ocwbc{} word stemmer \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$()~=~$\ocwkw{if}~$\ocwlowerid{cp}=$\ocwstring{"f"}~\ocwkw{then}~$\ocwlowerid{complete.}\ocwlowerid{val}:=\ocwupperid{False}~$\ocwkw{else}~$()~$\ocwbc{} simplified reader \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{mode}~=~$\ocwkw{match}~$\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_mode}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"t"}~$\rightarrow{}~\ocwupperid{Tag}$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"p"}~$\rightarrow{}~\ocwupperid{Parse}$\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"o"}~$\rightarrow{}~\ocwupperid{Analyse}~$\ocwbc{} Analyse mode of UoH parser \ocwec{}~\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Failure}~($\ocwstring{"Unknown\ocwvspace{}mode\ocwvspace{}"}~\^{}~$\ocwlowerid{s}))~$\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{2.00em}
\ocwbc{} Contextual information from past discourse \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{topic\_mark}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_topic}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{topic}~=~$\ocwkw{match}~$\ocwlowerid{topic\_mark}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"m"}~$\rightarrow{}~\ocwupperid{Some}~$\ocwstring{"sa.h"}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"f"}~$\rightarrow{}~\ocwupperid{Some}~$\ocwstring{"saa"}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"n"}~$\rightarrow{}~\ocwupperid{Some}~$\ocwstring{"tat"}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{None}$\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{abortl}~=~\ocwlowerid{abort}~\ocwlowerid{lang}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{checkpoints}~=~$\ocwbc{} checkpoints for graph \ocwec{}~\ocweol
\ocwindent{3.50em}
\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{url\_encoded\_cpts}~=~\ocwupperid{List.}\ocwlowerid{assoc}~$\ocwstring{"cpts"}~$\ocwlowerid{env}~$\ocwkw{in}~\ocwbc{} do not use get \ocwec{}\ocweol
\ocwindent{5.50em}
$\ocwupperid{Checkpoints.}\ocwlowerid{parse\_cpts}~(\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_cpts})$\ocweol
\ocwindent{3.50em}
\ocwkw{with}~$[~\ocwupperid{Not\_found}~\rightarrow{}~[\,]~]~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{cpts}~=~\ocwlowerid{sort\_check}~\ocwlowerid{checkpoints}~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{text}~=~\ocwlowerid{arguments}~\ocwlowerid{translit}~\ocwlowerid{lex}~\ocwlowerid{cache}~\ocwlowerid{st}~\ocwlowerid{us}~\ocwlowerid{cp}~\ocwlowerid{url\_encoded\_input}$\ocweol
\ocwindent{14.50em}
$\ocwlowerid{url\_encoded\_topic}~\ocwlowerid{abs}~\ocwlowerid{checkpoints}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~\ocwbc{} Now we call the lexer \ocwec{}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{process\_input}~\ocwlowerid{text}~\ocwlowerid{uns}~\ocwlowerid{mode}~\ocwlowerid{topic}~\ocwlowerid{input}~\ocwlowerid{encode}~\ocwlowerid{cpts}~$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{hr}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{close\_page\_with\_margin}~()~$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{page\_end}~\ocwlowerid{lang}~\ocwupperid{True}$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{2.00em}
\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Sys\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abortl}~\ocwupperid{Control.}\ocwlowerid{sys\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Stream.Error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abortl}~\ocwupperid{Control.}\ocwlowerid{stream\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Encode.In\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abortl}~$\ocwstring{"Wrong\ocwvspace{}input\ocwvspace{}"}~$\ocwlowerid{s}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Exit}~$\ocwbc{} Sanskrit \ocwec{}~$\rightarrow{}~\ocwlowerid{abortl}~$\ocwstring{"Wrong\ocwvspace{}character\ocwvspace{}in\ocwvspace{}input"}~\ocwstring{""}~\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Invalid\_argument}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abortl}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} sub \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Failure}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abortl}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{End\_of\_file}~\rightarrow{}~\ocwlowerid{abortl}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"EOF"}~\ocwbc{} EOF \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Not\_found}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{s}~=~$\ocwstring{"You\ocwvspace{}must\ocwvspace{}choose\ocwvspace{}a\ocwvspace{}parsing\ocwvspace{}option"}~\ocwkw{in}\ocweol
\ocwindent{14.50em}
$\ocwlowerid{abortl}~$\ocwstring{"Unset\ocwvspace{}button\ocwvspace{}in\ocwvspace{}form\ocwvspace{}\symbol{45}\ocwvspace{}"}~$\ocwlowerid{s}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Control.Fatal}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abortl}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} fatal \ocwec{}~\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Control.Anomaly}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abortl}~\ocwupperid{Control.}\ocwlowerid{anomaly\_err\_mess}~($\ocwstring{"Anomaly:\ocwvspace{}"}~\^{}~$\ocwlowerid{s})~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abortl}~\ocwupperid{Control.}\ocwlowerid{anomaly\_err\_mess}~$\ocwstring{"Unexpected\ocwvspace{}anomaly"}~\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{safe\_engine}~\ocwlowerid{lang}~=~$\ocweol
\ocwindent{0.00em}
\ocwbc{} In case of error, we lose the current language of the session \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{try}~$\ocwlowerid{reader\_engine}~()~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Failure}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{anomaly\_err\_mess}~$\ocwstring{"Unexpected\ocwvspace{}anomaly"}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Should always produce a compliant xhtml page \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{safe\_engine}~\ocwupperid{Html.}\ocwlowerid{default\_language}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Parser.ml}
\ocwmodule{Parser}
\label{parser.ml:0}%
CGI-bin callback for shallow syntax analysis 
\ocweol
\ocwindent{0.00em}
Parser is similar to Reader, but it is invoked from the green hearts
in the output of the reader, in order to give the semantic analysis of
a specific solution. It basically replays reading until this specific solution 
\ocweol
\label{parser.ml:929}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Encode};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Canon};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps pl abort truncation etc. \ocwbegindcode{}$\ocwlowerid{remote\_server\_host}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Cgi};~$\ocwbc{} get \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Checkpoints};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Scl\_parser};~$\ocwbc{} Interface with UoH dependency parser \ocwec{}\medskip

\label{parser.ml:1129}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Prel}~=~$\ocwkw{struct}~\ocwbc{} Parser's lexer prelude \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
prelude is executed by Lexer when initialisation of transducers fails 
\ocweol
\label{parser.ml:1256}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{prelude}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{http\_header}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_begin}~\ocwlowerid{parser\_meta\_title}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{body\_begin}~\ocwupperid{Chamois\_back})$\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwlowerid{scl\_toggle}~$\ocwkw{then}~\ocwbc{} external call SCL (experimental) \ocwec{}\ocweol
\ocwindent{3.50em}
$\ocwlowerid{pl}~(\ocwlowerid{javascript}~(\ocwupperid{SCLpaths.}\ocwlowerid{scl\_url}~$\^{}~$\ocwlowerid{javascript\_tooltip}))$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{parser\_title}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{open\_page\_with\_margin}~15$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}~\ocwbc{} Prel \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{iterate}~=~$\ocwbt{ref}~$\ocwupperid{True}~$\ocwbc{} by default we read a sentence (list of words) \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{complete}~=~$\ocwbt{ref}~$\ocwupperid{True}~$\ocwbc{} by default we call the fuller segmenter \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{output\_channel}~=~$\ocwbt{ref}~$\ocwlowerid{stdout}~$\ocwbc{} by default cgi output \ocwec{}\ocweol
\ocwindent{0.00em}
;\medskip

\label{parser.ml:1784}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Lexer\_control}~=~$\ocwkw{struct}\ocweol
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{star}~=~\ocwlowerid{iterate};$\ocweol
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{full}~=~\ocwlowerid{complete};$\ocweol
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{out\_chan}~=~\ocwlowerid{output\_channel};$\ocweol
\ocwindent{0.00em}
\ocwkw{end}~\ocwbc{} \ocwbegindcode{}$\ocwupperid{Lexer\_control}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Lex}~=~\ocwupperid{Lexer.Lexer}~\ocwupperid{Prel}~\ocwupperid{Lexer\_control}~$\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{print\_proj}~\ocwlowerid{print\_segment\_roles}~\ocwlowerid{print\_ext\_segment}~\ocwlowerid{extract\_lemma}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rpc}~=~\ocwlowerid{remote\_server\_host}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{remote}~=~$\ocwbt{ref}~$\ocwupperid{False}~$\ocwbc{} local invocation of cgi by default \ocwec{}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Inflected};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Constraints};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{roles\_of}~\ocwlowerid{sort\_flatten}~\ocwlowerid{extract}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Paraphrase};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{display\_penalties}~\ocwlowerid{print\_sem}~\ocwlowerid{print\_role}$\ocwenddcode{} \ocwec{}\medskip

\label{parser.ml:2293}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{query}~=~$\ocwbt{ref}~\ocwstring{""}~\ocwbc{} ugly - stores the query string \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{set\_query}~\ocwlowerid{q}~=~\ocwlowerid{query.}\ocwlowerid{val}~:=~\ocwlowerid{q}~$\ocwbc{} \ocwbegindcode{}$\ocwupperid{Parser}.\ocwlowerid{parser\_engine}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Duplicated from Rank \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{make\_groups}~\ocwlowerid{tagger}~=~\ocwlowerid{comp\_rec}~1~[\,]~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{comp\_rec}~\ocwlowerid{seg}~\ocwlowerid{stack}~=~$\ocwkw{fun}~\ocwbc{} going forward in time \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{stack}~$\ocwbc{} result goes backward in time \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwlowerid{\_})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwbc{} we ignore euphony transition \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{word}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rword}~$\ocwbc{} segment is mirror word \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{keep}~=~$\ocwkw{let}~$\ocwlowerid{tags}~=~\ocwlowerid{tagger}~\ocwlowerid{phase}~\ocwlowerid{word}~$\ocwkw{in}~\ocweol
\ocwindent{8.50em}
$[~\ocwlowerid{roles\_of}~\ocwlowerid{seg}~\ocwlowerid{word}~\ocwlowerid{tags}~::~\ocwlowerid{stack}~]~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{comp\_rec}~(\ocwlowerid{seg}+1)~\ocwlowerid{keep}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_sols}~\ocwlowerid{sol}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{xmlify\_call}~\ocwlowerid{sol}~=~$\ocwbc{} sol in reverse order \ocwec{}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{projections}~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{extract}~$\ocwstring{""}~$\ocwlowerid{sol}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{invoke}~=~\ocwlowerid{parser\_cgi}~$\^{}~\ocwstring{"?"}~\^{}~$\ocwlowerid{query.}\ocwlowerid{val}~$\^{}~\ocwstring{";p="}~\^{}~$\ocwlowerid{projections}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{anchor}~\ocwupperid{Green\_}~\ocwlowerid{invoke}~\ocwlowerid{heart\_sign}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{print\_role}~(\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{sol})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{xmlify\_call}~\ocwlowerid{sol})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{monitoring}~=~\ocwupperid{True}~$\ocwbc{} We show explicitly the penalty vector by default \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{display\_penalty}~\ocwlowerid{p}~=~$\ocwstring{"Penalty\ocwvspace{}"}~\^{}~\ocweol
\ocwindent{1.50em}
\ocwkw{if}~$\ocwlowerid{monitoring}~$\ocwkw{then}~$\ocwupperid{Constraints.}\ocwlowerid{show\_penalty}~\ocwlowerid{p}$\ocweol
\ocwindent{1.50em}
\ocwkw{else}~$\ocwlowerid{string\_of\_int}~(\ocwupperid{Constraints.}\ocwlowerid{eval\_penalty}~\ocwlowerid{p})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_bucket}~(\ocwlowerid{p},\ocwlowerid{b\_p})~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{html\_green}~(\ocwlowerid{display\_penalty}~\ocwlowerid{p}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{print\_sols}~\ocwlowerid{b\_p}$\ocweol
\ocwindent{1.00em}
\}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{analyse}~\ocwlowerid{query}~\ocwlowerid{output}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{tagger}~=~\ocwupperid{Lex.}\ocwlowerid{extract\_lemma}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{groups}~=~\ocwlowerid{make\_groups}~\ocwlowerid{tagger}~\ocwlowerid{output}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{sorted\_groups}~=~\ocwlowerid{sort\_flatten}~\ocwlowerid{groups}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{top\_groups},~\ocwlowerid{threshold})~=~\ocwlowerid{truncate\_groups}~\ocwlowerid{sorted\_groups}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{xml\_empty}~$\ocwstring{"p"}$)$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{find\_len}~=~$\ocwkw{fun}\ocweol
\ocwindent{3.00em}
$[~[~(\ocwlowerid{\_},[~\ocwlowerid{a}~::~\ocwlowerid{\_}~])~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{length}~\ocwlowerid{a}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~0$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{pl}~(\ocwlowerid{xml\_empty\_with\_att}~$\ocwstring{"input"}~\ocweol
\ocwindent{5.50em}
$[~($\ocwstring{"type"},\ocwstring{"submit"}$);~($\ocwstring{"value"},\ocwstring{"Submit"}$);~$\ocweol
\ocwindent{6.50em}
$($\ocwstring{"onclick"},\ocwstring{"unique('"}~\^{}~$\ocwlowerid{parser\_cgi}~$\^{}~\ocwstring{"?"}~\^{}~$\ocwlowerid{query}~$\ocweol
\ocwindent{6.50em}
\^{}~\ocwstring{";p=','"}~\^{}~$\ocwlowerid{string\_of\_int}~(\ocwlowerid{find\_len}~\ocwlowerid{top\_groups})~$\^{}~\ocwstring{"')"}~$)$\ocweol
\ocwindent{5.50em}
$]~$\^{}~$\ocwlowerid{html\_break})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{xml\_empty}~$\ocwstring{"p"}$)~$\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwlowerid{scl\_toggle}~$\ocwkw{then}~\ocwbc{} Call SCL parser \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{segments}~=~\ocwupperid{List.}\ocwlowerid{map}~($\ocwkw{fun}~$(\ocwlowerid{ph},\ocwlowerid{w},\ocwlowerid{\_})~\rightarrow{}~(\ocwlowerid{ph},\ocwlowerid{w}))~\ocwlowerid{output}~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
$\ocwupperid{Scl\_parser.}\ocwlowerid{print\_scl}~[~\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{segments}~]~$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~$()~$\ocweol
\ocwindent{2.00em}
;~$\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{print\_bucket}~\ocwlowerid{top\_groups}~$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{threshold}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{None}~\rightarrow{}~()$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Some}~\ocwlowerid{p}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.50em}
\{~$\ocwlowerid{ps}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{3.50em}
;~$\ocwlowerid{ps}~(\ocwlowerid{html\_red}~($\ocwstring{"Truncated\ocwvspace{}penalty\ocwvspace{}"}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{p}~$\^{}~\ocwstring{"\ocwvspace{}or\ocwvspace{}more"}$))~$\ocweol
\ocwindent{3.50em}
;~$\ocwlowerid{ps}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{3.50em}
\}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_sems}~\ocwlowerid{word}~\ocwlowerid{morphs}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{span\_begin}~\ocwupperid{Latin12})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\{\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{bar}~()~=~\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{sem}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{word}~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
$\ocwupperid{List2.}\ocwlowerid{process\_list\_sep}~(\ocwlowerid{print\_sem}~\ocwlowerid{sem})~\ocwlowerid{bar}~\ocwlowerid{morphs}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}\}"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{span\_end}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_out}~\ocwlowerid{seg\_num}~\ocwlowerid{segment}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\ocwbc{} Contrarily to Reader, we discard phonetic information. \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwupperid{Lex.}\ocwlowerid{print\_segment\_roles}~\ocwlowerid{print\_sems}~\ocwlowerid{seg\_num}~\ocwlowerid{segment}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{seg\_num}+1$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{print\_project}~\ocwlowerid{proj}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{proj}~$\ocwkw{with}~\ocweol
\ocwindent{6.00em}
$[~[\,]~\rightarrow{}~()~$\ocwbc{} finished, projections exhausted \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Too\ocwvspace{}many\ocwvspace{}projections"}\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{2.00em}
$\mid{}~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwlowerid{\_})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwbc{} sandhi ignored \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{new\_proj}~=~\ocwupperid{Lex.}\ocwlowerid{print\_proj}~\ocwlowerid{phase}~\ocwlowerid{rword}~\ocwlowerid{proj}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{print\_project}~\ocwlowerid{new\_proj}~\ocwlowerid{rest}~$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Truncation}~$\ocwbc{} raised if more solutions than \ocwbegindcode{}$\ocwupperid{Web}.\ocwlowerid{truncation}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Replay reader until solution index - quick and dirty way to recreate it. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Follows the infamous exponential \ocwbegindcode{}$\ocwupperid{Rank}.\ocwlowerid{dove\_tail}$\ocwenddcode{}. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{dove\_tail\_until}~\ocwlowerid{sol\_index}~\ocwlowerid{init}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{init\_stack}~=~\ocwupperid{List.}\ocwlowerid{map}~($\ocwkw{fun}~$(\ocwlowerid{\_},\ocwlowerid{s})~\rightarrow{}~\ocwlowerid{s})~\ocwlowerid{init}~$\ocwbc{} erasing constraints \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{dtrec}~1~(0,[\,],[\,])~\ocwlowerid{init\_stack}$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{dtrec}~\ocwlowerid{n}~\ocwlowerid{kept}~\ocwlowerid{stack}~=~$\ocwbc{} invariant: |stack|=|init|=number of chunks \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{n}~=~\ocwupperid{Web.}\ocwlowerid{truncation}~$\ocwkw{then}~$\ocwlowerid{raise}~\ocwupperid{Truncation}$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{n}~=~\ocwlowerid{sol\_index}~$\ocwkw{then}~\ocwbc{} return total output \ocwec{}\ocweol
\ocwindent{5.00em}
$\ocwupperid{List.}\ocwlowerid{fold\_right}~\ocwlowerid{conc}~\ocwlowerid{stack}~[\,]~$\ocweol
\ocwindent{5.00em}
$\ocwlowerid{where}~\ocwlowerid{conc}~(\ocwlowerid{o},\ocwlowerid{\_})~\ocwlowerid{oo}~=~\ocwlowerid{o}~@~\ocwlowerid{oo}~$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~$\ocwlowerid{dtrec}~(\ocwlowerid{n}+1)~\ocwlowerid{kept}~(\ocwlowerid{crank}~[\,]~\ocwlowerid{init}~\ocwlowerid{stack})$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{crank}~\ocwlowerid{acc}~\ocwlowerid{ini}~=~$\ocwkw{fun}\ocweol
\ocwindent{4.50em}
$[~[~(\ocwlowerid{\_},\ocwlowerid{c})~::~\ocwlowerid{cc}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{ini}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~[~(\ocwlowerid{constraints},\ocwlowerid{i})~::~\ocwlowerid{ii}~]~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{7.00em}
\{~$\ocwupperid{Lex.Viccheda.}\ocwlowerid{set\_offset}~\ocwlowerid{constraints}$\ocweol
\ocwindent{7.00em}
;~\ocwkw{match}~$\ocwupperid{Lex.Viccheda.}\ocwlowerid{continue}~\ocwlowerid{c}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~\ocwupperid{Some}~\ocwlowerid{next}~\rightarrow{}~\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{acc}~[~\ocwlowerid{next}~::~\ocwlowerid{cc}~]$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{crank}~[~\ocwlowerid{i}~::~\ocwlowerid{acc}~]~\ocwlowerid{ii}~\ocwlowerid{cc}$\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{7.00em}
\}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"dove\_tail\_until"}$)$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{4.50em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Truncation}$\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} From Interface: splitting checkpoints into current and future ones \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{split\_check}~\ocwlowerid{limit}~=~\ocwlowerid{split\_rec}~[\,]$\ocweol
\ocwindent{1.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{split\_rec}~\ocwlowerid{acc}~\ocwlowerid{checkpts}~=~$\ocwkw{match}~$\ocwlowerid{checkpts}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~(\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{acc},[\,])$\ocweol
\ocwindent{3.00em}
$\mid{}~[~((\ocwlowerid{index},\ocwlowerid{\_},\ocwlowerid{\_})~$\ocwkw{as}~$\ocwlowerid{check})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{index}~>~\ocwlowerid{limit}~$\ocwkw{then}~$(\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{acc},\ocwlowerid{checkpts})$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{split\_rec}~[~\ocwlowerid{check}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}~$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{segment\_until}~\ocwlowerid{sol\_index}~\ocwlowerid{chunks}~\ocwlowerid{cpts}~=~$\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$(\ocwlowerid{\_},\ocwlowerid{constrained\_segs})~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{init}~((0,\ocwlowerid{cpts}),[\,])~\ocwlowerid{chunks}$\ocweol
\ocwindent{1.50em}
$\ocwlowerid{where}~\ocwlowerid{init}~((\ocwlowerid{offset},\ocwlowerid{checkpoints}),\ocwlowerid{stack})~\ocwlowerid{chunk}~=~$\ocwkw{do}\ocweol
\ocwindent{1.50em}
\{~\ocwkw{let}~$\ocwlowerid{ini\_cont}~=~\ocwupperid{Lex.Viccheda.}\ocwlowerid{init\_segment}~\ocwlowerid{chunk}~$\ocwkw{in}~\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{chunk\_length}~=~\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{chunk}~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{extremity}~=~\ocwlowerid{offset}+\ocwlowerid{chunk\_length}~$\ocwkw{in}~\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$(\ocwlowerid{local},\ocwlowerid{future})~=~\ocwlowerid{split\_check}~\ocwlowerid{extremity}~\ocwlowerid{checkpoints}~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{chunk\_constraints}~=~(\ocwlowerid{offset},\ocwlowerid{local})~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
$((\ocwlowerid{succ}~\ocwlowerid{extremity},\ocwlowerid{future}),~$\ocwkw{do}~\ocweol
\ocwindent{4.00em}
\{~$\ocwupperid{Lex.Viccheda.}\ocwlowerid{set\_offset}~\ocwlowerid{chunk\_constraints}~$\ocwbc{} Sets local constraints \ocwec{}\ocweol
\ocwindent{4.00em}
;~\ocwkw{let}~$\ocwlowerid{res}~=~$\ocwkw{match}~$\ocwupperid{Lex.Viccheda.}\ocwlowerid{continue}~\ocwlowerid{ini\_cont}~$\ocwkw{with}\ocweol
\ocwindent{7.00em}
$[~\ocwupperid{Some}~\ocwlowerid{c}~\rightarrow{}~\ocwlowerid{c}~$\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~\ocwupperid{Lex.}\ocwlowerid{un\_analyzable}~\ocwlowerid{chunk}$\ocweol
\ocwindent{7.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{5.00em}
$[~(\ocwlowerid{chunk\_constraints},\ocwlowerid{res})~::~\ocwlowerid{stack}~]$\ocweol
\ocwindent{4.00em}
\}$)~$\ocweol
\ocwindent{1.50em}
\}~\ocwkw{in}\ocweol
\ocwindent{1.50em}
$\ocwlowerid{dove\_tail\_until}~\ocwlowerid{sol\_index}~\ocwlowerid{constrained\_segs}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{stamp}~=~$\ocweol
\ocwindent{1.00em}
\ocwstring{"Heritage"}~\^{}~\ocwstring{"\ocwvspace{}"}~\^{}~$\ocwupperid{Date.}\ocwlowerid{version}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_validate\_button}~\ocwlowerid{query}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{cgi}~=~\ocwlowerid{parser\_cgi}~$\^{}~\ocwstring{"?"}~\^{}~$\ocwlowerid{query}~$\^{}~\ocwstring{";validate=t"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{invocation}~=~$\ocwkw{if}~$\ocwlowerid{remote.}\ocwlowerid{val}~$\ocwkw{then}~$\ocwlowerid{rpc}~$\^{}~$\ocwlowerid{cgi}~$\ocwkw{else}~$\ocwlowerid{cgi}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{anchor}~\ocwupperid{Green\_}~\ocwlowerid{invocation}~\ocwlowerid{check\_sign}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Follows \ocwbegindcode{}$\ocwupperid{Reader}.\ocwlowerid{process\_input}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{process\_until}~\ocwlowerid{sol\_index}~\ocwlowerid{query}~\ocwlowerid{topic}~\ocwlowerid{mode\_sent}~\ocwlowerid{translit}~\ocwlowerid{sentence}~$\ocweol
\ocwindent{10.00em}
$\ocwlowerid{cpts}~\ocwlowerid{us}~\ocwlowerid{encode}~\ocwlowerid{proj}~\ocwlowerid{sol\_num}~\ocwlowerid{query}~\ocwlowerid{do\_validate}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pieces}~=~\ocwupperid{Sanskrit.}\ocwlowerid{read\_raw\_sanskrit}~\ocwlowerid{encode}~\ocwlowerid{sentence}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{romapieces}~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwupperid{Canon.}\ocwlowerid{uniromcode}~\ocwlowerid{pieces}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{romasentence}~=~\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{"\ocwvspace{}"}~$\ocwlowerid{romapieces}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{chunker}~=~$\ocwkw{if}~$\ocwlowerid{us}~$\ocwkw{then}~$\ocwupperid{Sanskrit.}\ocwlowerid{read\_raw\_sanskrit}~$\ocweol
\ocwindent{11.00em}
\ocwkw{else}~$\ocwupperid{Sanskrit.}\ocwlowerid{read\_sanskrit}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{chunks}~=~\ocwlowerid{chunker}~\ocwlowerid{encode}~\ocwlowerid{sentence}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{devachunks}~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwupperid{Canon.}\ocwlowerid{unidevcode}~\ocwlowerid{chunks}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{devasentence}~=~\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{"\ocwvspace{}"}~$\ocwlowerid{devachunks}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{lex\_stamp}~=~$\ocwstring{"Lexicon:\ocwvspace{}"}~\^{}~$\ocwlowerid{stamp}~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
$\ocwlowerid{ps}~(\ocwlowerid{html\_green}~\ocwlowerid{lex\_stamp})~$\ocwbc{} in order to keep relation corpus/lexicon \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{hr}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{roma16\_red\_sl}~\ocwlowerid{romasentence})~$\ocwbc{} romanisation \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{deva16\_blue}~\ocwlowerid{devasentence})~$\ocwbc{} devanagari \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{all\_chunks}~=~$\ocwkw{match}~$\ocwlowerid{topic}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Some}~\ocwlowerid{topic}~\rightarrow{}~\ocwlowerid{chunks}~@~[~\ocwlowerid{code\_string}~\ocwlowerid{topic}~]$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{chunks}$\ocweol
\ocwindent{3.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{output}~=~\ocwlowerid{segment\_until}~\ocwlowerid{sol\_index}~\ocwlowerid{all\_chunks}~\ocwlowerid{cpts}~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{solution}~=~\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{output}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"table"}~$[~\ocwlowerid{noborder};~\ocwlowerid{padding10};~\ocwlowerid{spacing5}~])$\ocweol
\ocwindent{4.00em}
;~\ocwkw{match}~$\ocwlowerid{proj}~$\ocwkw{with}~\ocweol
\ocwindent{5.00em}
$[~\ocwupperid{None}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{\_}~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{print\_out}~1~\ocwlowerid{solution}~$\ocwkw{in}~$()$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Some}~\ocwlowerid{triples}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{6.00em}
\{~$\ocwlowerid{print\_project}~\ocwlowerid{triples}~\ocwlowerid{solution}$\ocweol
\ocwindent{6.50em}
\}\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{table\_end}~$\ocweol
\ocwindent{4.00em}
;~\ocwkw{match}~$\ocwlowerid{proj}~$\ocwkw{with}~\ocweol
\ocwindent{5.00em}
$[~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{analyse}~\ocwlowerid{query}~\ocwlowerid{solution}~$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Some}~\ocwlowerid{p}~\rightarrow{}~()$\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{2.00em}
\ocwkw{with}~$[~\ocwupperid{Truncation}~\rightarrow{}~\ocwlowerid{pl}~(\ocwlowerid{html\_red}~$\ocwstring{"Solution\ocwvspace{}not\ocwvspace{}found"}~\^{}~$\ocwlowerid{html\_break})~]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\label{parser.ml:10361}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sort\_check}~\ocwlowerid{cpts}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{compare\_index}~(\ocwlowerid{a},\ocwlowerid{\_},\ocwlowerid{\_})~(\ocwlowerid{b},\ocwlowerid{\_},\ocwlowerid{\_})~=~\ocwlowerid{compare}~\ocwlowerid{a}~\ocwlowerid{b}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{sort}~\ocwlowerid{compare\_index}~\ocwlowerid{cpts}$\ocweol
\ocwindent{0.00em}
;\medskip

\label{parser.ml:10474}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{parser\_engine}~()~=~$\ocwkw{do}\ocweol
\ocwindent{0.00em}
\ocwbc{} Replays Reader until given solution - dumb but reliable \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwupperid{Prel.}\ocwlowerid{prelude}~()$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{query}~=~\ocwupperid{Sys.}\ocwlowerid{getenv}~$\ocwstring{"QUERY\_STRING"}~\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{alist}~=~\ocwlowerid{create\_env}~\ocwlowerid{query}~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{url\_encoded\_input}~=~\ocwlowerid{get}~$\ocwstring{"text"}~$\ocwlowerid{alist}~$\ocwstring{""}~\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_sol\_index}~=~\ocwlowerid{get}~$\ocwstring{"n"}~$\ocwlowerid{alist}~$\ocwstring{"1"}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_topic}~=~\ocwlowerid{get}~$\ocwstring{"topic"}~$\ocwlowerid{alist}~$\ocwstring{""}~\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{st}~=~\ocwlowerid{get}~$\ocwstring{"st"}~$\ocwlowerid{alist}~$\ocwstring{"t"}~\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{cp}~=~\ocwlowerid{get}~$\ocwstring{"cp"}~$\ocwlowerid{alist}~$\ocwstring{"t"}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{us}~=~\ocwlowerid{get}~$\ocwstring{"us"}~$\ocwlowerid{alist}~$\ocwstring{"f"}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{translit}~=~\ocwlowerid{get}~$\ocwstring{"t"}~$\ocwlowerid{alist}~\ocwupperid{Paths.}\ocwlowerid{default\_transliteration}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{lex}~=~\ocwlowerid{get}~$\ocwstring{"lex"}~$\ocwlowerid{alist}~\ocwupperid{Paths.}\ocwlowerid{default\_lexicon}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{abs}~=~\ocwlowerid{get}~$\ocwstring{"abs"}~$\ocwlowerid{alist}~$\ocwstring{"f"}~\ocwbc{} default local paths \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{lang}~=~\ocwlowerid{language\_of}~\ocwlowerid{lex}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{input}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_input}~$\ocwbc{} unnormalized string \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{uns}~=~\ocwlowerid{us}=$\ocwstring{"t"}~\ocwbc{} unsandhied vs sandhied corpus \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{mode\_sent}~=~\ocwlowerid{st}=$\ocwstring{"t"}~\ocwbc{} default sentence mode \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{encode}~=~\ocwupperid{Encode.}\ocwlowerid{switch\_code}~\ocwlowerid{translit}~$\ocwbc{} encoding as a normalized word \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$()~=~\ocwlowerid{toggle\_lexicon}~\ocwlowerid{lex}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$()~=~$\ocwkw{if}~$\ocwlowerid{abs}=$\ocwstring{"t"}~\ocwkw{then}~$\ocwlowerid{remote.}\ocwlowerid{val}:=\ocwupperid{True}~$\ocwkw{else}~$()~$\ocwbc{} Web service mode \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$()~=~$\ocwkw{if}~$\ocwlowerid{st}=$\ocwstring{"f"}~\ocwkw{then}~$\ocwlowerid{iterate.}\ocwlowerid{val}:=\ocwupperid{False}~$\ocwkw{else}~$()~$\ocwbc{} word stemmer \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$()~=~$\ocwkw{if}~$\ocwlowerid{cp}=$\ocwstring{"f"}~\ocwkw{then}~$\ocwlowerid{complete.}\ocwlowerid{val}:=\ocwupperid{False}~$\ocwkw{else}~$()~$\ocwbc{} simplified reader \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{sol\_index}~=~\ocwlowerid{int\_of\_string}~(\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_sol\_index})~$\ocweol
\ocwindent{2.00em}
\ocwbc{} For Validate mode, register number of solutions \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{sol\_num}~=~\ocwlowerid{int\_of\_string}~(\ocwlowerid{get}~$\ocwstring{"allSol"}~$\ocwlowerid{alist}~$\ocwstring{"0"}$)$\ocweol
\ocwindent{2.00em}
\ocwbc{} Only register this solution if validate is true \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{do\_validate}~=~\ocwlowerid{get}~$\ocwstring{"validate"}~$\ocwlowerid{alist}~$\ocwstring{"f"}~\ocweol
\ocwindent{2.00em}
\ocwbc{} Contextual information from past discourse \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{topic\_mark}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_topic}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{topic}~=~$\ocwkw{match}~$\ocwlowerid{topic\_mark}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~$\ocwstring{"m"}~$\rightarrow{}~\ocwupperid{Some}~$\ocwstring{"sa.h"}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"f"}~$\rightarrow{}~\ocwupperid{Some}~$\ocwstring{"saa"}\ocweol
\ocwindent{4.00em}
$\mid{}~$\ocwstring{"n"}~$\rightarrow{}~\ocwupperid{Some}~$\ocwstring{"tat"}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{None}$\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{0.50em}
\ocwbc{} Corpus interaction disabled 
   \ocwbc{} File where to store locally the taggings - only for \ocwbegindcode{}$\ocwupperid{Station}$\ocwenddcode{} platform \ocwec{}
   \ocwbegindcode{}\ocwkw{let}~$\ocwlowerid{corpus\_file}~=~(\times{}~\ocwlowerid{optionally}~\ocwlowerid{transmitted}~\ocwlowerid{by}~\ocwlowerid{argument}~$\ocwstring{"out\_file"}~$\times{})
~$\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{file\_name}~=~\ocwupperid{List}.\ocwlowerid{assoc}~$\ocwstring{"out\_file"}~$\ocwlowerid{alist}~(\times{}~$\ocwkw{do}~$\lnot{}~\ocwlowerid{use}~\ocwlowerid{get}~\times{})~$\ocwkw{in}~
~$\ocwupperid{Some}~\ocwlowerid{file\_name}~
~$\ocwkw{with}~[~$\ocwupperid{Not\_found}~\rightarrow{}~\ocwupperid{Some}~\ocwlowerid{regression\_file\_name}~]~$\ocwkw{in}\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Regression disabled
   \ocwbegindcode{}\ocwkw{let}~$()~=~$\ocwkw{if}~$\ocwupperid{Paths}.\ocwlowerid{platform}~=~$\ocwstring{"Station"}~\ocwkw{then}~\ocwkw{match}~$\ocwlowerid{corpus\_file}~$\ocwkw{with}~
~[~$\ocwupperid{Some}~\ocwlowerid{file\_name}~\rightarrow{}~
~$\ocwkw{let}~$\ocwlowerid{regression\_file}~=~\ocwlowerid{var\_dir}~$\^{}~$\ocwlowerid{file\_name}~$\^{}~\ocwstring{".txt"}~\ocwkw{in}~
~$\ocwlowerid{output\_channel}.$\ocwkw{val}~:=~$\ocwlowerid{open\_out\_gen}~
~[~\ocwupperid{Open\_wronly};~\ocwupperid{Open\_append};~\ocwupperid{Open\_creat};~\ocwupperid{Open\_text}~]~
~\ocwoctconst{777}~\ocwlowerid{regression\_file}
~\mid{}~\ocwupperid{None}~\rightarrow{}~()
~]
~$\ocwkw{else}~$()~$\ocwkw{in}\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{proj}~=~$\ocwbc{} checks for parsing mode \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{url\_encoded\_proj}~=~\ocwupperid{List.}\ocwlowerid{assoc}~$\ocwstring{"p"}~$\ocwlowerid{alist}~$\ocwkw{in}~\ocwbc{} do not use get \ocwec{}~\ocweol
\ocwindent{6.00em}
$\ocwupperid{Some}~(\ocwlowerid{parse\_proj}~(\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_proj}))$\ocweol
\ocwindent{4.00em}
\ocwkw{with}~$[~\ocwupperid{Not\_found}~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{8.50em}
\{~$\ocwlowerid{set\_query}~\ocwlowerid{query}~$\ocwbc{} query regurgitated - horror \ocwec{}\ocweol
\ocwindent{8.50em}
;~$\ocwupperid{None}$\ocweol
\ocwindent{8.50em}
\}~\ocweol
\ocwindent{6.50em}
$]~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{checkpoints}~=~$\ocwbc{} checkpoints for graph \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{url\_encoded\_cpts}~=~\ocwupperid{List.}\ocwlowerid{assoc}~$\ocwstring{"cpts"}~$\ocwlowerid{alist}~$\ocwkw{in}~\ocwbc{} do not use get \ocwec{}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{parse\_cpts}~(\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_cpts})$\ocweol
\ocwindent{3.50em}
\ocwkw{with}~$[~\ocwupperid{Not\_found}~\rightarrow{}~[\,]~]~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{cpts}~=~\ocwlowerid{sort\_check}~\ocwlowerid{checkpoints}~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{try}~\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{process\_until}~\ocwlowerid{sol\_index}~\ocwlowerid{query}~\ocwlowerid{topic}~\ocwlowerid{mode\_sent}~\ocwlowerid{translit}~\ocwlowerid{input}~$\ocweol
\ocwindent{11.00em}
$\ocwlowerid{cpts}~\ocwlowerid{uns}~\ocwlowerid{encode}~\ocwlowerid{proj}~\ocwlowerid{sol\_num}~\ocwlowerid{query}~\ocwlowerid{do\_validate}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{close\_page\_with\_margin}~()$\ocweol
\ocwindent{3.00em}
;~\ocwkw{let}~$\ocwlowerid{bandeau}~=~\lnot{}~(\ocwupperid{Gen.}\ocwlowerid{active}~\ocwlowerid{proj})~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{page\_end}~\ocwlowerid{lang}~\ocwlowerid{bandeau}$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
\ocwkw{with}~$[~\ocwupperid{Stream.Error}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~$\ocwstring{"Illegal\ocwvspace{}transliteration\ocwvspace{}"}~$\ocwlowerid{input}~]$\ocweol
\ocwindent{0.50em}
\}\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{safe\_engine}~()~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{abor}~=~\ocwlowerid{abort}~\ocwlowerid{default\_language}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwlowerid{parser\_engine}~()~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Sys\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{sys\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Stream.Error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{stream\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Encode.In\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Wrong\ocwvspace{}input\ocwvspace{}"}~$\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Exit}~$\ocwbc{} Sanskrit \ocwec{}~$\rightarrow{}~\ocwlowerid{abor}~$\ocwstring{"Wrong\ocwvspace{}character\ocwvspace{}in\ocwvspace{}input\ocwvspace{}\symbol{45}\ocwvspace{}"}~\ocwstring{"use\ocwvspace{}ASCII"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Invalid\_argument}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} sub \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Failure}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{End\_of\_file}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"EOF"}~\ocwbc{} EOF \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Not\_found}~$\ocwbc{} assoc \ocwec{}~$\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{s}~=~$\ocwstring{"You\ocwvspace{}must\ocwvspace{}choose\ocwvspace{}a\ocwvspace{}parsing\ocwvspace{}option"}~\ocwkw{in}\ocweol
\ocwindent{14.50em}
$\ocwlowerid{abor}~$\ocwstring{"Unset\ocwvspace{}button\ocwvspace{}in\ocwvspace{}form\ocwvspace{}\symbol{45}\ocwvspace{}"}~$\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Control.Fatal}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Control.Anomaly}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~($\ocwstring{"Anomaly:\ocwvspace{}"}~\^{}~$\ocwlowerid{s})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"Unexpected\ocwvspace{}anomaly"}~\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{safe\_engine}~()~$\ocwbc{} Should always produce a valid HTML page \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Constraints.mli}
\ocwinterface{Constraints}
\label{constraints.mli:0}%
Constraints machinery 
\ocweol
\label{constraints.mli:648}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{inflexions}$\ocwenddcode{} \ocwec{}\medskip

\label{constraints.mli:701}%
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{noun\_role}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Subject}~$\ocwkw{of}~$\ocwlowerid{person}~$\ocwkw{and}~$\ocwlowerid{number}~$\ocwbc{} agent of active or patient of passive \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Object}~$\ocwbc{} patient or goal of active or adverb of manner \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Instrument}~$\ocwbc{} agent of passive or instrument of active or adverb of manner \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Destination}~$\ocwbc{} receiver or goal \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Origin}~$\ocwbc{} origin of action or adverb of manner \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Possessor}~$\ocwbc{} dual role as verb complement or noun attribution \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Circumstance}~$\ocwbc{} adverb of time or location \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{demand}~=~$\ocwbt{list}~$\ocwlowerid{noun\_role}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{mood}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Indicative}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Imper}~$\ocwkw{of}~\ocwbt{bool}~\ocwbc{} True: Imperative False: Injunctive \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Part of speech \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{pos}~=$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Process}~$\ocwkw{of}~$\ocwlowerid{demand}~$\ocwkw{and}~$\ocwlowerid{mood}~$\ocwbc{} roles governed by a verb form \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Subprocess}~$\ocwkw{of}~$\ocwlowerid{demand}~$\ocwbc{} verbal subphrase \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Actor}~$\ocwkw{of}~$\ocwlowerid{noun\_role}~$\ocwkw{and}~$\ocwlowerid{gender}~$\ocwkw{and}~$\ocwlowerid{number}~$\ocwbc{} noun form with morphology \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Addressee}~$\ocwbc{} vocative \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Tool}~$\ocwkw{of}~$\ocwlowerid{tool}~$\ocwbc{} grammatical word \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Compound}~$\ocwbc{} iic \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Number}~$\ocwkw{of}~$\ocwlowerid{gender}~$\ocwkw{and}~$\ocwlowerid{case}~$\ocwkw{and}~$\ocwlowerid{number}~$\ocwbc{} number (gender for eka) \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ignored}~$\ocwbc{} indeclinable not known as tool \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwbc{} Combinatorial tools \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{tool}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Coordination}~$\ocwbc{} ca \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Post\_instrument}~$\ocwbc{} sahaa1 vinaa prep \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Not\_Post\_instrument}~$\ocwbc{} sahaa1 adv \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Prohibition}~$\ocwbc{} maa \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Post\_genitive}~$\ocwbc{} varam \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Todo}~$\ocwbc{} to avoid warning \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{aspect}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Imperfectif}~$\ocwbc{} active or middle indicative \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Impersonal}~$\ocwbc{} intransitive passive \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Perfectif}~$\ocwbc{} transitive passive \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Statif}~$\ocwbc{} factitive \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{regime}~=$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Transitive}~$\ocwbc{} transitive verbs in active and middle \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Intransitive}~$\ocwbc{} intransitive verbs in active and middle \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Factitive}~$\ocwbc{} impersonal - no subject \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Quotative}~$\ocwbc{} aahur - it is said \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwbc{}| Bitransitive - use of transitive with 2 accusatives \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}| Regime of (list case * list case) - specific regime - unused so far \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{root\_regime}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{regime}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} compute aspect, demand and mood of a verbal finite form \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{regime}~:~$\ocwbt{string}~$\rightarrow{}~(\ocwlowerid{conjugation}~\times{}~\ocwlowerid{paradigm})~\rightarrow{}~(\ocwlowerid{aspect}~\times{}~\ocwlowerid{demand}~\times{}~\ocwlowerid{mood})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{label}~=~($\ocwbt{int}~$\times{}~$\ocwbt{int}~$\times{}~$\ocwbt{int}$)~$\ocwbc{} (segment number, homonym index, tag index)     \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{roles}~=~$\ocwbt{list}~$(\ocwlowerid{label}~\times{}~\ocwlowerid{pos})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{roles\_of}~:~$\ocwbt{int}~$\rightarrow{}~$\ocwbt{list}~\ocwbt{int}~$\rightarrow{}~$\ocwbt{list}~$(($\ocwbt{int}~$\times{}~$\ocwbt{list}~\ocwbt{int}$)~\times{}~\ocwlowerid{inflexions})~\rightarrow{}~\ocwlowerid{roles}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{penalty}~=$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Sentence}~$\ocwkw{of}~$($\ocwbt{int}~$\times{}~$\ocwbt{int}~$\times{}~$\ocwbt{int}~$\times{}~$\ocwbt{int}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Copula}~$\ocwkw{of}~$($\ocwbt{int}~$\times{}~$\ocwbt{int}~$\times{}~$\ocwbt{int}~$\times{}~$\ocwbt{int}~$\times{}~$\ocwbt{int}$)~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{NP}~$\ocwkw{of}~$\ocwlowerid{penalty}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{eval\_penalty}~:~\ocwlowerid{penalty}~\rightarrow{}~$\ocwbt{int}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{show\_penalty}~:~\ocwlowerid{penalty}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{flattening}~=~$\ocwbt{list}~$(\ocwlowerid{penalty}~\times{}~$\ocwbt{list}~$\ocwlowerid{roles})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sort\_flatten}~:~$\ocwbt{list}~$\ocwlowerid{roles}~\rightarrow{}~\ocwlowerid{flattening}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{truncate\_groups}~:~\ocwlowerid{flattening}~\rightarrow{}~(\ocwlowerid{flattening}~\times{}~$\ocwbt{option}~\ocwbt{int}$)$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{extract}~:~$\ocwbt{string}~$\rightarrow{}~(\ocwlowerid{label}~\times{}~\ocwlowerid{pos})~\rightarrow{}~$\ocwbt{string}\medskip

\label{constraints.mli:3410}%
\ocwindent{0.00em}
;~\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Constraints.ml}
\ocwmodule{Constraints}
\label{constraints.ml:0}%
Syntactico/semantic analysis and penalty computations. 
\ocweol
\ocwindent{0.00em}
This is the 2005 design of a constraint machinery working on some kind
   of linear logic graph matching of semantic roles. Verbs are assigned arities 
   of needed complements, seen as roles with a negative polarity. It does not 
   really use the karaka theory, the role of a nominative is mediated through 
   the voice. This is very primitive, and works only for toy examples. 
   It merely gives a proof of feasability. 
   A more serious machinery should work on discourse, deal with ellipses, and
   possibly use optimality theory with matrix computations. 
\ocweol
\ocwindent{0.00em}
We need to enrich this parser with kridantas which have their own
aaka.mk.saa , eg participles. Then we must recognize that certain passive
constructs, such ppp, may be use in the active sense to indicate past
e.g. with verbs of mouvement 
\ocweol
\label{constraints.ml:1534}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{inflexion\_tag}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\medskip

\ocwendcode{}\ocwindent{0.00em}
Constraints analysis 
\ocweol
\ocwindent{0.00em}
Nouns 
\ocweol
\label{constraints.ml:1641}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{noun\_role}~=~$\ocwbc{} not karaka \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Subject}~$\ocwkw{of}~$\ocwlowerid{person}~$\ocwkw{and}~$\ocwlowerid{number}~$\ocwbc{} agent of active or patient of passive \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Object}~$\ocwbc{} patient or goal of active or adverb of manner \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Instrument}~$\ocwbc{} agent of passive or instrument of active or adverb of manner \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Destination}~$\ocwbc{} receiver or goal \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Origin}~$\ocwbc{} origin of action or adverb of manner \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Possessor}~$\ocwbc{} dual role as verb complement or noun attribution \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Circumstance}~$\ocwbc{} adverb of time or location \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{demand}~=~$\ocwbt{list}~$\ocwlowerid{noun\_role}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{person\_of\_subst}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"aham"}~$\rightarrow{}~\ocwupperid{First}~\mid{}~$\ocwstring{"tvad"}~$\rightarrow{}~\ocwupperid{Second}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Third}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{gram\_role}~\ocwlowerid{num}~\ocwlowerid{entry}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Nom}~\rightarrow{}~\ocwupperid{Subject}~(\ocwlowerid{person\_of\_subst}~\ocwlowerid{entry})~\ocwlowerid{num}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Acc}~\rightarrow{}~\ocwupperid{Object}~$\ocwbc{} Patient or adverb of manner \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ins}~\rightarrow{}~\ocwupperid{Instrument}~$\ocwbc{} Agent or adverb of instrument \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Dat}~\rightarrow{}~\ocwupperid{Destination}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Abl}~\rightarrow{}~\ocwupperid{Origin}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Gen}~\rightarrow{}~\ocwupperid{Possessor}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Loc}~\rightarrow{}~\ocwupperid{Circumstance}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Voc}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unexpected\ocwvspace{}vocative\ocwvspace{}(gram\_role)"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{case\_of}~=~$\ocwkw{fun}~\ocwbc{} inverse of \ocwbegindcode{}$\ocwlowerid{gram\_role}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Subject}~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Nom}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Object}~\rightarrow{}~\ocwupperid{Acc}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Instrument}~\rightarrow{}~\ocwupperid{Ins}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Destination}~\rightarrow{}~\ocwupperid{Dat}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Origin}~\rightarrow{}~\ocwupperid{Abl}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Possessor}~\rightarrow{}~\ocwupperid{Gen}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Circumstance}~\rightarrow{}~\ocwupperid{Loc}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{mood}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Indicative}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Imper}~$\ocwkw{of}~\ocwbt{bool}~\ocwbc{} True: Imperative False: Injunctive \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} mood processing - pertains to maa management \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ini\_mood}~=~(0,0)$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{add\_mood}~\ocwlowerid{m}~\ocwlowerid{moods}~=~$\ocwkw{match}~$\ocwlowerid{m}~$\ocwkw{with}\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Imper}~\ocwlowerid{b}~\rightarrow{}~$\ocwkw{let}~$(\ocwlowerid{imp},\ocwlowerid{inj})=\ocwlowerid{moods}~$\ocwkw{in}~\ocwkw{if}~$\ocwlowerid{b}~$\ocwkw{then}~$(\ocwlowerid{imp}+1,\ocwlowerid{inj})~$\ocwkw{else}~$(\ocwlowerid{imp},\ocwlowerid{inj}+1)$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{moods}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Part of speech 
\ocweol
\label{constraints.ml:3096}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{pos}~=$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Process}~$\ocwkw{of}~$\ocwlowerid{demand}~$\ocwkw{and}~$\ocwlowerid{mood}~$\ocwbc{} roles governed by a verb form \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Subprocess}~$\ocwkw{of}~$\ocwlowerid{demand}~$\ocwbc{} verbal subphrase \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Actor}~$\ocwkw{of}~$\ocwlowerid{noun\_role}~$\ocwkw{and}~$\ocwlowerid{gender}~$\ocwkw{and}~$\ocwlowerid{number}~$\ocwbc{} noun form with morphology \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Addressee}~$\ocwbc{} vocative \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Tool}~$\ocwkw{of}~$\ocwlowerid{tool}~$\ocwbc{} grammatical word \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Compound}~$\ocwbc{} iic \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Number}~$\ocwkw{of}~$\ocwlowerid{gender}~$\ocwkw{and}~$\ocwlowerid{case}~$\ocwkw{and}~$\ocwlowerid{number}~$\ocwbc{} number (gender for eka) \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ignored}~$\ocwbc{} indeclinable not known as tool \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwbc{} Combinatorial tools \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{tool}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Coordination}~$\ocwbc{} ca \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Post\_instrument}~$\ocwbc{} saha vinaa prep \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Not\_Post\_instrument}~$\ocwbc{} saha adv \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Prohibition}~$\ocwbc{} maa \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Post\_genitive}~$\ocwbc{} varam TODO \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Todo}~$\ocwbc{} to avoid warning \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Verb valencies - Very experimental. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} The serious version will have to make computations with preverbs \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} and will accommodate several sememes with different valencies for a
   given lexeme - e.g. \ocwstring{"dhaav\#1.1"} intransitive, \ocwstring{"dhaav\#1.2"} transitive.
   The paraphrase will be associated with sememes and not just lexemes. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{regime}~=$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Transitive}~$\ocwbc{} transitive verbs in active and middle \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Intransitive}~$\ocwbc{} intransitive verbs in active and middle \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Factitive}~$\ocwbc{} impersonal - no subject \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Quotative}~$\ocwbc{} aahur - it is said \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwbc{}| Bitransitive - use of transitive with 2 accusatives \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}| Regime of (list case * list case) - specific regime - unused so far \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
We simplify by assuming equal valency of atmanepade and parasmaipade. 
\ocweol
\ocwindent{0.00em}
Also we assume (to be revised) that valency is independent of preverb. 
\ocweol
\label{constraints.ml:4706}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{root\_regime}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~$\ocwbc{} akarmaka roots, checked by Pawan Goyal \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwbc{} more exactly, these are the roots that may be used akarmaka \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwstring{"an\#2"}~$\mid{}~$\ocwstring{"as\#1"}~$\mid{}~$\ocwstring{"as\#2"}~$\mid{}~$\ocwstring{"aas\#2"}~$\mid{}~$\ocwstring{"iih"}~$\mid{}~$\ocwstring{"uc"}~$\mid{}~$\ocwstring{"uurj\#1"}~$\mid{}~$\ocwstring{".rdh"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"edh"}~$\mid{}~$\ocwstring{"kamp"}~$\mid{}~$\ocwstring{"kaaz"}~$\mid{}~$\ocwstring{"kuc"}~$\mid{}~$\ocwstring{"ku.t"}~$\mid{}~$\ocwstring{"kup"}~$\mid{}~$\ocwstring{"kul"}~$\mid{}~$\ocwstring{"kuuj"}~$\mid{}~$\ocwstring{"k.lp"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"krii.d"}~$\mid{}~$\ocwstring{"krudh\#1"}~$\mid{}~$\ocwstring{"klid"}~$\mid{}~$\ocwstring{"kvath"}~$\mid{}~$\ocwstring{"k.sar"}~$\mid{}~$\ocwstring{"k.si"}~$\mid{}~$\ocwstring{"k.su"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"k.sudh\#1"}~$\mid{}~$\ocwstring{"k.subh"}~$\mid{}~$\ocwstring{"khel"}~$\mid{}~$\ocwstring{"gaj"}~$\mid{}~$\ocwstring{"garj"}~$\mid{}~$\ocwstring{"gard"}~$\mid{}~$\ocwstring{"galbh"}~$\mid{}~$\ocwstring{"gu\~{}nj"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"gur"}~$\mid{}~$\ocwstring{"g.rr\#2"}~$\mid{}~$\ocwstring{"glai"}~$\mid{}~$\ocwstring{"gha.t"}~$\mid{}~$\ocwstring{"gha.t.t"}~$\mid{}~$\ocwstring{"ghuur.n"}~$\mid{}~$\ocwstring{"cakaas"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"ca\~{}nc"}~$\mid{}~$\ocwstring{"cal"}~$\mid{}~$\ocwstring{"cit\#1"}~$\mid{}~$\ocwstring{"ce.s.t"}~$\mid{}~$\ocwstring{"jan"}~$\mid{}~$\ocwstring{"jaag.r"}~$\mid{}~$\ocwstring{"jiiv"}~$\mid{}~$\ocwstring{"j.rmbh"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"j.rr"}~$\mid{}~$\ocwstring{"jyaa\#1"}~$\mid{}~$\ocwstring{"jvar"}~$\mid{}~$\ocwstring{"jval"}~$\mid{}~$\ocwstring{".dii"}~$\mid{}~$\ocwstring{"tan\#2"}~$\mid{}~$\ocwstring{"tam"}~$\mid{}~$\ocwstring{"tu.s"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"t.r.s\#1"}~$\mid{}~$\ocwstring{"trap"}~$\mid{}~$\ocwstring{"tras"}~$\mid{}~$\ocwstring{"tvar"}~$\mid{}~$\ocwstring{"tsar"}~$\mid{}~$\ocwstring{"dak.s"}~$\mid{}~$\ocwstring{"dal"}~$\mid{}~$\ocwstring{"das"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"dah\#1"}~$\mid{}~$\ocwstring{"dih"}~$\mid{}~$\ocwstring{"diik.s"}~$\mid{}~$\ocwstring{"diip"}~$\mid{}~$\ocwstring{"du.s"}~$\mid{}~$\ocwstring{"d.rh"}~$\mid{}~$\ocwstring{"dev\#1"}~$\mid{}~$\ocwstring{"dyut\#1"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"draa\#1"}~$\mid{}~$\ocwstring{"draa\#2"}~$\mid{}~$\ocwstring{"dhaav\#1"}~$\mid{}~$\ocwstring{"dhru"}~$\mid{}~$\ocwstring{"dhvan"}~$\mid{}~$\ocwstring{"dhv.r"}~$\mid{}~$\ocwstring{"na.t"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"nand"}~$\mid{}~$\ocwstring{"nard"}~$\mid{}~$\ocwstring{"naz\#1"}~$\mid{}~$\ocwstring{"nah"}~$\mid{}~$\ocwstring{"nii\#1"}~$\mid{}~$\ocwstring{"n.rt"}~$\mid{}~$\ocwstring{"pat\#1"}~$\mid{}~$\ocwstring{"pi\#2"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"puuy"}~$\mid{}~$\ocwstring{"p.r\#2"}~$\mid{}~$\ocwstring{"pyaa"}~$\mid{}~$\ocwstring{"prath"}~$\mid{}~$\ocwstring{"phal"}~$\mid{}~$\ocwstring{"ba.mh"}~$\mid{}~$\ocwstring{"bal"}~$\mid{}~$\ocwstring{"bha.n.d"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"bhand"}~$\mid{}~$\ocwstring{"bha.s"}~$\mid{}~$\ocwstring{"bhaa\#1"}~$\mid{}~$\ocwstring{"bhaas\#1"}~$\mid{}~$\ocwstring{"bhii\#1"}~$\mid{}~$\ocwstring{"bhuj\#1"}~$\mid{}~$\ocwstring{"bhuu\#1"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"bhra.mz"}~$\mid{}~$\ocwstring{"bhram"}~$\mid{}~$\ocwstring{"bhraaj"}~$\mid{}~$\ocwstring{"ma.mh"}~$\mid{}~$\ocwstring{"majj"}~$\mid{}~$\ocwstring{"mad\#1"}~$\mid{}~$\ocwstring{"mud\#1"}~$\mid{}~$\ocwstring{"muh"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"muurch"}~$\mid{}~$\ocwstring{"m.r"}~$\mid{}~$\ocwstring{"m.rdh"}~$\mid{}~$\ocwstring{"mre.d"}~$\mid{}~$\ocwstring{"mlaa"}~$\mid{}~$\ocwstring{"yabh"}~$\mid{}~$\ocwstring{"yas"}~$\mid{}~$\ocwstring{"yu\#2"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"yudh\#1"}~$\mid{}~$\ocwstring{"ra\~{}nj"}~$\mid{}~$\ocwstring{"ra.n"}~$\mid{}~$\ocwstring{"ram"}~$\mid{}~$\ocwstring{"raaj\#1"}~$\mid{}~$\ocwstring{"ru"}~$\mid{}~$\ocwstring{"ruc\#1"}~$\mid{}~$\ocwstring{"rud\#1"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"ru.s\#1"}~$\mid{}~$\ocwstring{"ruh\#1"}~$\mid{}~$\ocwstring{"lag"}~$\mid{}~$\ocwstring{"lamb"}~$\mid{}~$\ocwstring{"lal"}~$\mid{}~$\ocwstring{"las"}~$\mid{}~$\ocwstring{"vak.s"}~$\mid{}~$\ocwstring{"vas\#1"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"vah\#1"}~\ocwbc{} nadii vahati \ocwec{}~$\mid{}~$\ocwstring{"vaa\#2"}~$\mid{}~$\ocwstring{"vaaz"}~$\mid{}~$\ocwstring{"vij"}~$\mid{}~$\ocwstring{"vip"}~$\mid{}~$\ocwstring{"viz\#1"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"v.rt\#1"}~$\mid{}~$\ocwstring{"v.rdh\#1"}~$\mid{}~$\ocwstring{"vyath"}~$\mid{}~$\ocwstring{"zak"}~$\mid{}~$\ocwstring{"zad"}~$\mid{}~$\ocwstring{"zam\#1"}~$\mid{}~$\ocwstring{"zii\#1"}~$\mid{}~$\ocwstring{"ziil"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"zuc\#1"}~$\mid{}~$\ocwstring{"zudh"}~$\mid{}~$\ocwstring{"zubh\#1"}~$\mid{}~$\ocwstring{"zu.s"}~$\mid{}~$\ocwstring{"zuu"}~$\mid{}~$\ocwstring{"zram"}~$\mid{}~$\ocwstring{"zrambh"}~$\mid{}~$\ocwstring{"zvas\#1"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"zvit"}~$\mid{}~$\ocwstring{"sap\#1"}~$\mid{}~$\ocwstring{"saa\#1"}~$\mid{}~$\ocwstring{"sidh\#1"}~$\mid{}~$\ocwstring{"sur"}~$\mid{}~$\ocwstring{"skhal"}~$\mid{}~$\ocwstring{"stan"}~$\mid{}~$\ocwstring{"stu"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"stubh"}~$\mid{}~$\ocwstring{"sthaa\#1"}~$\mid{}~$\ocwstring{"snih\#1"}~$\mid{}~$\ocwstring{"snu"}~$\mid{}~$\ocwstring{"spand"}~$\mid{}~$\ocwstring{"spardh"}~$\mid{}~$\ocwstring{"sphaa"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"sphu.t"}~$\mid{}~$\ocwstring{"sphur"}~$\mid{}~$\ocwstring{"smi"}~$\mid{}~$\ocwstring{"syand"}~$\mid{}~$\ocwstring{"sra.ms"}~$\mid{}~$\ocwstring{"svap"}~$\mid{}~$\ocwstring{"svar\#1"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"svar\#2"}~$\mid{}~$\ocwstring{"had"}~$\mid{}~$\ocwstring{"has"}~$\mid{}~$\ocwstring{"hikk"}~$\mid{}~$\ocwstring{"h.r.s"}~$\mid{}~$\ocwstring{"hras"}~$\mid{}~$\ocwstring{"hraad"}~$\mid{}~$\ocwstring{"hrii\#1"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"hlaad"}~$\mid{}~$\ocwstring{"hval"}~$\rightarrow{}~\ocwupperid{Intransitive}~$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"baa.sp"}~$\mid{}~$\ocwstring{"zyaam"}~\ocwbc{} nominal verbs \ocwec{}~$\rightarrow{}~\ocwupperid{Intransitive}~$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"v.r.s"}~$\rightarrow{}~\ocwupperid{Factitive}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"ah"}~$\rightarrow{}~\ocwupperid{Quotative}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwbc{} sakarmaka in all usages \ocwec{}~$\ocwupperid{Transitive}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} But valency may depend on gana for the present system \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{root\_regime\_gana}~\ocwlowerid{k}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"i"}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{k}~$\ocwkw{with}~$[~2~\mid{}~4~\rightarrow{}~\ocwupperid{Intransitive}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Transitive}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"daa\#1"}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{k}~$\ocwkw{with}~$[~3~\rightarrow{}~\ocwupperid{Intransitive}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Transitive}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"b.rh\#1"}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{k}~$\ocwkw{with}~$[~1~\rightarrow{}~\ocwupperid{Intransitive}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Transitive}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"maa\#1"}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{k}~$\ocwkw{with}~$[~2~\rightarrow{}~\ocwupperid{Intransitive}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Transitive}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"tap"}~$\mid{}~$\ocwstring{"pac"}~$\mid{}~$\ocwstring{"raadh"}~$\mid{}~$\ocwstring{"svid\#2"}~$\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{k}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~4~\rightarrow{}~\ocwupperid{Intransitive}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Transitive}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{root}~\rightarrow{}~\ocwlowerid{root\_regime}~\ocwlowerid{root}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Certain roots marked as Transitive are in fact Intransitive for some of
their meanings:
\ocwbegindcode{}~\ocwstring{"kruz"}~$\mid{}~$\ocwstring{"gh.r"}~$\mid{}~$\ocwstring{"jak.s"}~$\mid{}~$\ocwstring{"ji"}~$\mid{}~$\ocwstring{"t.rp\#1"}~$\mid{}~$\ocwstring{"d.rp"}~$\mid{}~$\ocwstring{"dhva.ms"}~$\mid{}~$\ocwstring{"pi\~{}nj"}~
$\mid{}~$\ocwstring{"bhas"}~$\mid{}~$\ocwstring{"mand\#1"}~$\mid{}~$\ocwstring{"radh"}~$\mid{}~$\ocwstring{"lafgh"}~$\mid{}~$\ocwstring{"lu.n.th"}~$\mid{}~$\ocwstring{"vii\#1"}~$\mid{}~$\ocwstring{"zumbh"}~
$\mid{}~$\ocwstring{"sad\#1"}~$\mid{}~$\ocwstring{"su\#2"}~$\mid{}~$\ocwstring{"svan"}~$\mid{}~$\ocwstring{"ha.th"}~$\mid{}~$\ocwstring{"hi\#2"}~$\mid{}~$\ocwstring{"hu.n.d"}~$\mid{}~$\ocwstring{"huu"}~\ocwenddcode{}
When used intransitively, the parser will look for a missing object and may
penalize correct sentences. For roots marked as Intransitive, but nonetheless
used transitively in a sentence, the parser will consider their accusative
object, in the active voice, as an adverb, but no penalty will incur.
NB. dvikarmaka roots are just treated as Transitive in this version. 
\ocwec{}\medskip

\label{constraints.ml:8105}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{agent\_of\_passive}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"vid\#2"}~$\rightarrow{}~[\,]~$\ocwbc{} ellipsed impersonal agent \ocwstring{"it\ocwvspace{}is\ocwvspace{}known\ocwvspace{}that"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~\ocwupperid{Instrument}~]~$\ocwbc{} Agent at instrumental in passive voice \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} The following type actually combines aspect, voice and mood \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{aspect}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Imperfectif}~$\ocwbc{} active or middle indicative \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Impersonal}~$\ocwbc{} intransitive passive \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Perfectif}~$\ocwbc{} transitive passive \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Statif}~$\ocwbc{} factitive \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Computes aspect valency and mood of a verbal finite form as a triple \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{regime}~\ocwlowerid{entry}~(\ocwlowerid{cj},\ocwlowerid{t})~=~$\ocweol
\ocwindent{1.00em}
\ocwbc{} conjugation cj and possible preverb sequence ignored in first version \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{regime}~=~\ocwlowerid{root\_regime}~\ocwlowerid{entry}~$\ocwkw{in}~\ocwbc{} TODO dependency on k \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{t}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~\ocwupperid{Conjug}~\ocwlowerid{\_}~\ocwupperid{Passive}~\mid{}~\ocwupperid{Presentp}~\ocwlowerid{\_}~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{aspect}~=~$\ocwkw{match}~$\ocwlowerid{regime}~$\ocwkw{with}\ocweol
\ocwindent{10.50em}
$[~\ocwupperid{Intransitive}~\rightarrow{}~\ocwupperid{Impersonal}$\ocweol
\ocwindent{10.50em}
$\mid{}~\ocwupperid{Factitive}~\rightarrow{}~\ocwupperid{Statif}$\ocweol
\ocwindent{10.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Perfectif}$\ocweol
\ocwindent{10.50em}
$]~$\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{valency}~=~\ocwlowerid{agent\_of\_passive}~\ocwlowerid{entry}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$(\ocwlowerid{aspect},\ocwlowerid{valency},\ocwupperid{Indicative})$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Conjug}~\ocwlowerid{t}~\ocwlowerid{\_}~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{aspect}~=~$\ocwkw{if}~$\ocwlowerid{regime}=\ocwupperid{Factitive}~\lor{}~\ocwlowerid{regime}=\ocwupperid{Quotative}~$\ocwkw{then}~$\ocwupperid{Statif}~$\ocweol
\ocwindent{10.50em}
\ocwkw{else}~$\ocwupperid{Imperfectif}$\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{valency}~=~$\ocwkw{match}~$\ocwlowerid{regime}~$\ocwkw{with}~\ocweol
\ocwindent{11.00em}
$[~\ocwupperid{Transitive}~\rightarrow{}~[~\ocwupperid{Object}~]~\mid{}~\ocwlowerid{\_}~\rightarrow{}~[\,]~]~$\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{mood}~=~$\ocwkw{match}~$\ocwlowerid{t}~$\ocwkw{with}~$[~\ocwupperid{Injunctive}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Imper}~\ocwupperid{False}$\ocweol
\ocwindent{16.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Indicative}$\ocweol
\ocwindent{16.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$(\ocwlowerid{aspect},\ocwlowerid{valency},\ocwlowerid{mood})~$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Presenta}~\ocwlowerid{k}~\ocwlowerid{m}~\mid{}~\ocwupperid{Presentm}~\ocwlowerid{k}~\ocwlowerid{m}~\rightarrow{}~$\ocwbc{} on affine le regime gana et mode \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{regime}~=~\ocwlowerid{root\_regime\_gana}~\ocwlowerid{k}~\ocwlowerid{entry}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{aspect}~=~$\ocwkw{if}~$\ocwlowerid{regime}=\ocwupperid{Factitive}~\lor{}~\ocwlowerid{regime}=\ocwupperid{Quotative}~$\ocwkw{then}~$\ocwupperid{Statif}~$\ocweol
\ocwindent{10.50em}
\ocwkw{else}~\ocwbc{} if m=Optative then Statif \ocwbc{} NEW bruyaat \ocwec{}
                     else \ocwec{}~$\ocwupperid{Imperfectif}$\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{valency}~=~$\ocwkw{match}~$\ocwlowerid{regime}~$\ocwkw{with}~\ocweol
\ocwindent{11.00em}
$[~\ocwupperid{Transitive}~\rightarrow{}~[~\ocwupperid{Object}~]~\mid{}~\ocwlowerid{\_}~\rightarrow{}~[\,]~]~$\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{mood}~=~$\ocwkw{match}~$\ocwlowerid{m}~$\ocwkw{with}~\ocweol
\ocwindent{9.50em}
$[~\ocwupperid{Imperative}~\rightarrow{}~\ocwupperid{Imper}~\ocwupperid{True}$\ocweol
\ocwindent{9.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Indicative}~$\ocwbc{} now, only Imperative for Present \ocwec{}~\ocweol
\ocwindent{9.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$(\ocwlowerid{aspect},\ocwlowerid{valency},\ocwlowerid{mood})~$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Perfut}~\ocwlowerid{\_}~\rightarrow{}~($\ocwkw{if}~$\ocwlowerid{regime}=\ocwupperid{Factitive}~$\ocwkw{then}~$\ocwupperid{Statif}~$\ocwkw{else}~$\ocwupperid{Imperfectif},~$\ocweol
\ocwindent{10.00em}
\ocwkw{match}~$\ocwlowerid{regime}~$\ocwkw{with}~$[~\ocwupperid{Transitive}~\rightarrow{}~[~\ocwupperid{Object}~]~\mid{}~\ocwlowerid{\_}~\rightarrow{}~[\,]~],$\ocweol
\ocwindent{10.00em}
$\ocwupperid{Indicative})$\ocweol
\ocwindent{2.50em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{get\_fin\_roles}~\ocwlowerid{entry}~\ocwlowerid{f}~\ocwlowerid{n}~\ocwlowerid{p}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{aspect},\ocwlowerid{valency},\ocwlowerid{mood})~=~\ocwlowerid{regime}~\ocwlowerid{entry}~\ocwlowerid{f}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{demand}~=~$\ocwkw{match}~$\ocwlowerid{aspect}~$\ocwkw{with}~\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Statif}~\mid{}~\ocwupperid{Impersonal}~\rightarrow{}~\ocwlowerid{valency}$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~\ocwupperid{Subject}~\ocwlowerid{p}~\ocwlowerid{n}~::~\ocwlowerid{valency}~]~$\ocwbc{} anaphoric subject reference \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwbc{} | Imperfectif -> \ocwbegindcode{}~$\ocwupperid{Subject}~\ocwlowerid{p}~\ocwlowerid{n}~::~\ocwlowerid{valency}~$\ocwenddcode{} \ocwbc{} subject is agent \ocwec{}
       | Perfectif -> \ocwbegindcode{}~$\ocwupperid{Subject}~\ocwlowerid{p}~\ocwlowerid{n}~::~\ocwlowerid{valency}~$\ocwenddcode{} \ocwbc{} subject is goal/patient \ocwec{} \ocwec{}\ocweol
\ocwindent{3.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{Process}~\ocwlowerid{demand}~\ocwlowerid{mood}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{get\_abs\_roles}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{demand}~=~$\ocwkw{match}~$\ocwlowerid{root\_regime}~\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Intransitive}~\mid{}~\ocwupperid{Factitive}~\rightarrow{}~[\,]$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~\ocwupperid{Object}~]~$\ocweol
\ocwindent{3.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{Subprocess}~\ocwlowerid{demand}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Present participle active defines an auxiliary clause, like Absolutive \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} It denotes simultaneity rather than sequentiality/causality \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{is\_ppra}~(\ocwlowerid{\_},\ocwlowerid{v})~=~$\ocwkw{match}~$\ocwlowerid{v}~$\ocwkw{with}~\ocwbc{} TEMP \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Ppra}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{True}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{get\_roles}$\ocwenddcode{} assigns roles to morphological items. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Some tool words are processed here and numbers are recognized. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{get\_roles}~\ocwlowerid{entry}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Part\_form}~\ocwlowerid{v}~\ocwlowerid{g}~\ocwlowerid{n}~\ocwlowerid{c}~$\ocweol
\ocwindent{6.50em}
$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}~=~\ocwupperid{Voc}~$\ocwkw{then}~$\ocwupperid{Addressee}~$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{is\_ppra}~\ocwlowerid{v}~$\ocwkw{then}~$\ocwupperid{Subprocess}~[\,]~$\ocwbc{} should lookup root \ocwec{}\ocweol
\ocwindent{8.00em}
\ocwkw{else}~$\ocwupperid{Actor}~(\ocwlowerid{gram\_role}~\ocwlowerid{n}~\ocwlowerid{entry}~\ocwlowerid{c})~\ocwlowerid{g}~\ocwlowerid{n}~$\ocwbc{} beware n duplication \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Noun\_form}~\ocwlowerid{g}~\ocwlowerid{n}~\ocwlowerid{c}~$\ocweol
\ocwindent{6.50em}
$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}~=~\ocwupperid{Voc}~$\ocwkw{then}~$\ocwupperid{Addressee}~$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{g}=\ocwupperid{Deictic}~\ocwupperid{Numeral}~\lor{}~\ocwlowerid{entry}=$\ocwstring{"eka"}~\ocwkw{then}~$\ocwupperid{Number}~\ocwlowerid{g}~\ocwlowerid{c}~\ocwlowerid{n}$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~$\ocwupperid{Actor}~(\ocwlowerid{gram\_role}~\ocwlowerid{n}~\ocwlowerid{entry}~\ocwlowerid{c})~\ocwlowerid{g}~\ocwlowerid{n}~$\ocwbc{} beware n duplication \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Verb\_form}~\ocwlowerid{f}~\ocwlowerid{n}~\ocwlowerid{p}~\rightarrow{}~\ocwlowerid{get\_fin\_roles}~\ocwlowerid{entry}~\ocwlowerid{f}~\ocwlowerid{n}~\ocwlowerid{p}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Abs\_root}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{get\_abs\_roles}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind\_form}~\ocwupperid{Conj}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{10.50em}
$[~$\ocwstring{"ca"}~$\rightarrow{}~\ocwupperid{Tool}~\ocwupperid{Coordination}$\ocweol
\ocwindent{10.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Ignored}~$\ocwbc{} TODO vaa etc \ocwec{}\ocweol
\ocwindent{10.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind\_form}~\ocwupperid{Prep}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"saha"}~$\lor{}~\ocwlowerid{entry}~=~$\ocwstring{"vinaa"}~$\lor{}~\ocwlowerid{entry}~=~$\ocwstring{"satraa"}~\ocweol
\ocwindent{12.00em}
\ocwkw{then}~$\ocwupperid{Tool}~\ocwupperid{Post\_instrument}$\ocweol
\ocwindent{10.50em}
\ocwkw{else}~$\ocwupperid{Ignored}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind\_form}~\ocwupperid{Adv}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{entry}~=~$\ocwstring{"saha"}~\ocwkw{then}~$\ocwupperid{Tool}~\ocwupperid{Not\_Post\_instrument}$\ocweol
\ocwindent{10.00em}
\ocwkw{else}~$\ocwupperid{Ignored}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind\_form}~\ocwupperid{Abs}~\rightarrow{}~\ocwlowerid{get\_abs\_roles}~\ocwlowerid{entry}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind\_form}~\ocwupperid{Part}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{entry}~$\ocwkw{with}\ocweol
\ocwindent{10.50em}
$[~$\ocwstring{"maa\#2"}~$\rightarrow{}~\ocwupperid{Tool}~\ocwupperid{Prohibition}$\ocweol
\ocwindent{10.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Ignored}$\ocweol
\ocwindent{10.50em}
$]~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Bare\_stem}~\rightarrow{}~\ocwupperid{Compound}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Ignored}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Used in Parser, Reader \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{roles\_of}~\ocwlowerid{seg}~\ocwlowerid{word}~\ocwlowerid{tags}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{distrib}~(\ocwlowerid{sub},\ocwlowerid{res})~(\ocwlowerid{delta},\ocwlowerid{morphs})~=~$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{entry}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~(\ocwupperid{Word.}\ocwlowerid{patch}~\ocwlowerid{delta}~\ocwlowerid{word})~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{roles}~=~\ocwupperid{List.}\ocwlowerid{map}~(\ocwlowerid{get\_roles}~\ocwlowerid{entry})~\ocwlowerid{morphs}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$(\ocwlowerid{\_},\ocwlowerid{r})~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{label}~(1,\ocwlowerid{res})~\ocwlowerid{roles}$\ocweol
\ocwindent{6.00em}
$\ocwlowerid{where}~\ocwlowerid{label}~(\ocwlowerid{i},\ocwlowerid{l})~\ocwlowerid{role}~=~(\ocwlowerid{i}+1,[~((\ocwlowerid{seg},\ocwlowerid{sub},\ocwlowerid{i}),\ocwlowerid{role})~::~\ocwlowerid{l}~])~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$(\ocwlowerid{sub}+1,\ocwlowerid{r})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{\_},\ocwlowerid{rls})~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{distrib}~(1,[\,])~\ocwlowerid{tags}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{rls}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocweol
\ocwindent{0.00em}
\ocwbc{} We flatten the role matrix into a list of sequences. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} This is potentially exponential, since we multiply choices. \ocwec{}\medskip

\label{constraints.ml:14133}%
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{label}~=~($\ocwbt{int}~$\times{}~$\ocwbt{int}~$\times{}~$\ocwbt{int}$)~$\ocwbc{} (segment number, homonymy index, tag index) \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{roles}~=~$\ocwbt{list}~$(\ocwlowerid{label}~\times{}~\ocwlowerid{pos})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Combinator \ocwbegindcode{}$\ocwlowerid{flatten\_add}$\ocwenddcode{} is for the brave. Do not attempt to understand 
   this code if you have not already mastered flatten and flatteni above. \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{flatten\_add}~:~$\ocwbt{list}~$\ocwlowerid{roles}~\rightarrow{}~$\ocwbt{list}~$\ocwlowerid{roles}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{flatten\_add}~=~$\ocwkw{fun}~\ocwbc{} arg goes backward in time \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~[~[\,]~]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{l}~::~\ocwlowerid{r}~]~\rightarrow{}~$\ocwbc{} l: roles \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{flatr}~=~\ocwlowerid{flatten\_add}~\ocwlowerid{r}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{distr}~\ocwlowerid{res}~\ocwlowerid{f}~=~$\ocwbc{} f: roles \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{prefix}~\ocwlowerid{acc}~\ocwlowerid{x}~=~[~[~\ocwlowerid{x}~::~\ocwlowerid{f}~]~::~\ocwlowerid{acc}~]~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{result}~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{prefix}~[\,]~\ocwlowerid{l}~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
$\ocwlowerid{result}~@~\ocwlowerid{res}~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
$\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{distr}~[\,]~\ocwlowerid{flatr}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwbc{} Tool words as semantic combinators - reverse role stream transducers \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Coordination tool 
\ocweol
\label{constraints.ml:14964}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{No\_coord}~$\ocwbc{} Coordination failure \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} future deictic gender context, here assumed all male \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{context}~\ocwlowerid{d}~=~\ocwupperid{Mas}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} abstract interpretation of coordination \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{merge}~=~$\ocwkw{fun}~\ocwbc{} persons priorities \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{First}~\rightarrow{}~$\ocwkw{fun}~$\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{First}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Second}~\rightarrow{}~$\ocwkw{fun}~$[~\ocwupperid{First}~\rightarrow{}~\ocwupperid{First}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Second}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Third}~\rightarrow{}~$\ocwkw{fun}~$[~\ocwupperid{First}~\rightarrow{}~\ocwupperid{First}~\mid{}~\ocwupperid{Second}~\rightarrow{}~\ocwupperid{Second}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Third}~]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{add}~=~$\ocwkw{fun}~\ocwbc{} numbers additions \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Plural}~\mid{}~\ocwupperid{Dual}~\rightarrow{}~$\ocwkw{fun}~$\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Plural}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Singular}~\rightarrow{}~$\ocwkw{fun}~$[~\ocwupperid{Plural}~\mid{}~\ocwupperid{Dual}~\rightarrow{}~\ocwupperid{Plural}~\mid{}~\ocwupperid{Singular}~\rightarrow{}~\ocwupperid{Dual}~]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{dom}~=~$\ocwkw{fun}~\ocwbc{} male dominance \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Mas}~\rightarrow{}~$\ocwkw{fun}~$\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Mas}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwkw{fun}~$[~\ocwupperid{Mas}~\rightarrow{}~\ocwupperid{Mas}~\mid{}~\ocwupperid{Deictic}~\ocwlowerid{d}~\rightarrow{}~\ocwlowerid{dom}~\ocwupperid{Fem}~(\ocwlowerid{context}~\ocwlowerid{d})~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Fem}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwkw{fun}~$[~\ocwupperid{Deictic}~\ocwlowerid{d}~\rightarrow{}~\ocwlowerid{context}~\ocwlowerid{d}~\mid{}~\ocwlowerid{g}~\rightarrow{}~\ocwlowerid{g}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Deictic}~\ocwlowerid{d}~\rightarrow{}~\ocwlowerid{dom}~(\ocwlowerid{context}~\ocwlowerid{d})$\ocweol
\ocwindent{0.00em}
\ocwbc{} Unsatisfactory - numbers ought to be treated as Neu. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} The gender is used only for possible adjective agreement, 
   not for verb government \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Coordination recognizes noun phrases (N = IIc*.Noun@nom)
   N1 N2 ca ... Np ca
   N1 ca N2 ca ... Np ca
   with N = C* S  C = iic, S = Subst
 NB negation not yet accounted for (naca etc);
    also is missing N1 N2 ... Np ca avec Ni homogène en nb - adjectival cascade.
 We synthesize a multiple homogeneous substantive in the output stream \ocwec{}\medskip

\label{constraints.ml:16213}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{coord\_penalty}~=~1$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} removing possible compound prefixes \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{end\_coord}~\ocwlowerid{kar}~\ocwlowerid{acc}~\ocwlowerid{p}~\ocwlowerid{g}~\ocwlowerid{n}~=~\ocwlowerid{rem\_iic}~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{rem\_iic}~\ocwlowerid{cur}~=~$\ocwkw{match}~$\ocwlowerid{cur}~$\ocwkw{with}~\ocweol
\ocwindent{1.50em}
$[~[~\ocwupperid{Compound}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{rem\_iic}~\ocwlowerid{rest}~$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{kar}~$\ocwkw{with}~\ocwbc{} Synthesis of compound kar \ocwec{}\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Subject}~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~([~\ocwupperid{Actor}~(\ocwupperid{Subject}~\ocwlowerid{p}~\ocwlowerid{n})~\ocwlowerid{g}~\ocwlowerid{n}~::~\ocwlowerid{acc}~],\ocwlowerid{cur})~$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{kar}~\rightarrow{}~([~\ocwupperid{Actor}~\ocwlowerid{kar}~\ocwlowerid{g}~\ocwlowerid{n}~::~\ocwlowerid{acc}~],\ocwlowerid{cur})~$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{agree\_deictic}~\ocwlowerid{g}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.50em}
$[~\ocwupperid{Deictic}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwlowerid{g1}~\rightarrow{}~\ocwlowerid{g}=\ocwlowerid{g1}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Remove compound formation and possible adjectival number word. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skim}~\ocwlowerid{c}~\ocwlowerid{g}~\ocwlowerid{n}~\ocwlowerid{context}~=~\ocwlowerid{skim\_rec}~\ocwlowerid{context}~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{skim\_rec}~\ocwlowerid{con}~=~$\ocwkw{match}~$\ocwlowerid{con}~$\ocwkw{with}\ocweol
\ocwindent{1.50em}
$[~[~\ocwupperid{Compound}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{skim\_rec}~\ocwlowerid{rest}~$\ocwbc{} skip possible iic - compounding \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~[~\ocwupperid{Number}~\ocwlowerid{g1}~\ocwlowerid{c1}~\ocwlowerid{n1}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{3.50em}
\ocwkw{if}~$\ocwlowerid{agree\_deictic}~\ocwlowerid{g}~\ocwlowerid{g1}~\land{}~\ocwlowerid{c}=\ocwlowerid{c1}~\land{}~\ocwlowerid{n}=\ocwlowerid{n1}~$\ocwbc{} agreement of Number \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{then}~$\ocwlowerid{rest}$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{raise}~\ocwupperid{No\_coord}$\ocweol
\ocwindent{1.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{con}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{coord1}~\ocwlowerid{kar}~\ocwlowerid{acc}~\ocwlowerid{p}~\ocwlowerid{g}~\ocwlowerid{n}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
\ocwbc{} searching for closest noun phrase \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{No\_coord}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{np}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{np}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~\ocwupperid{Actor}~(\ocwupperid{Subject}~\ocwlowerid{p1}~\ocwlowerid{\_})~\ocwlowerid{g1}~\ocwlowerid{n1}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{kar}~$\ocwkw{with}~\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Subject}~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{coord2}~\ocwlowerid{kar}~\ocwlowerid{acc}~(\ocwlowerid{merge}~\ocwlowerid{p}~\ocwlowerid{p1})~(\ocwlowerid{dom}~\ocwlowerid{g}~\ocwlowerid{g1})~(\ocwlowerid{add}~\ocwlowerid{n}~\ocwlowerid{n1})~\ocwlowerid{rest}$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{No\_coord}$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Actor}~\ocwlowerid{k}~\ocwlowerid{g1}~\ocwlowerid{n1}~$\ocwkw{when}~$\ocwlowerid{k}~=~\ocwlowerid{kar}~\rightarrow{}$\ocweol
\ocwindent{3.50em}
$\ocwlowerid{coord2}~\ocwlowerid{kar}~\ocwlowerid{acc}~\ocwupperid{Third}~(\ocwlowerid{dom}~\ocwlowerid{g}~\ocwlowerid{g1})~(\ocwlowerid{add}~\ocwlowerid{n}~\ocwlowerid{n1})~\ocwlowerid{rest}$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{No\_coord}$\ocweol
\ocwindent{2.50em}
$]$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{coord2}~\ocwlowerid{kar}~\ocwlowerid{acc}~\ocwlowerid{p}~\ocwlowerid{g}~\ocwlowerid{n}~\ocwlowerid{cur}~=~$\ocwkw{match}~$\ocwlowerid{cur}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
\ocwbc{} searching for previous noun phrases \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{No\_coord}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{np}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{np}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~\ocwupperid{Actor}~(\ocwupperid{Subject}~\ocwlowerid{p1}~\ocwlowerid{\_})~\ocwlowerid{g1}~\ocwlowerid{n1}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{kar}~$\ocwkw{with}~\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Subject}~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{before}~=~\ocwlowerid{skim}~\ocwupperid{Nom}~\ocwlowerid{g1}~\ocwlowerid{n1}~\ocwlowerid{rest}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$\ocwlowerid{end\_coord}~\ocwlowerid{kar}~\ocwlowerid{acc}~(\ocwlowerid{merge}~\ocwlowerid{p}~\ocwlowerid{p1})~(\ocwlowerid{dom}~\ocwlowerid{g}~\ocwlowerid{g1})~(\ocwlowerid{add}~\ocwlowerid{n}~\ocwlowerid{n1})~\ocwlowerid{before}$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{No\_coord}$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Actor}~\ocwlowerid{k}~\ocwlowerid{g1}~\ocwlowerid{n1}~\rightarrow{}~$\ocweol
\ocwindent{3.50em}
\ocwkw{if}~$\ocwlowerid{k}~=~\ocwlowerid{kar}~$\ocwkw{then}~\ocwkw{let}~$\ocwlowerid{before}~=~\ocwlowerid{skim}~(\ocwlowerid{case\_of}~\ocwlowerid{k})~\ocwlowerid{g1}~\ocwlowerid{n1}~\ocwlowerid{rest}~$\ocwkw{in}\ocweol
\ocwindent{11.50em}
\ocwbc{} additive interpretation of ca \ocwec{}\ocweol
\ocwindent{11.50em}
$\ocwlowerid{end\_coord}~\ocwlowerid{kar}~\ocwlowerid{acc}~\ocwupperid{Third}~(\ocwlowerid{dom}~\ocwlowerid{g}~\ocwlowerid{g1})~(\ocwlowerid{add}~\ocwlowerid{n}~\ocwlowerid{n1})~\ocwlowerid{before}$\ocweol
\ocwindent{9.00em}
\ocwkw{else}~$\ocwlowerid{raise}~\ocwupperid{No\_coord}$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Tool}~\ocwupperid{Coordination}~\rightarrow{}~\ocwlowerid{coord1}~\ocwlowerid{kar}~\ocwlowerid{acc}~\ocwlowerid{p}~\ocwlowerid{g}~\ocwlowerid{n}~\ocwlowerid{rest}~$\ocwbc{} iterate the tool \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{No\_coord}$\ocweol
\ocwindent{2.50em}
$]$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Coordination: the ca tool constructs a composite tag from its predecessors \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{coordinate}~\ocwlowerid{acc}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
\ocwbc{} searching for first noun phrase \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{No\_coord}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{np}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{np}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Actor}~(\ocwupperid{Subject}~\ocwlowerid{p1}~\ocwlowerid{\_}~$\ocwkw{as}~$\ocwlowerid{kar})~\ocwlowerid{g1}~\ocwlowerid{n1}~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{before}~=~\ocwlowerid{skim}~\ocwupperid{Nom}~\ocwlowerid{g1}~\ocwlowerid{n1}~\ocwlowerid{rest}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$\ocwlowerid{coord2}~\ocwlowerid{kar}~\ocwlowerid{acc}~\ocwlowerid{p1}~\ocwlowerid{g1}~\ocwlowerid{n1}~\ocwlowerid{before}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Actor}~\ocwlowerid{kar}~\ocwlowerid{g1}~\ocwlowerid{n1}~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{before}~=~\ocwlowerid{skim}~\ocwupperid{Nom}~\ocwlowerid{g1}~\ocwlowerid{n1}~\ocwlowerid{rest}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$\ocwlowerid{coord2}~\ocwlowerid{kar}~\ocwlowerid{acc}~\ocwupperid{Third}~\ocwlowerid{g1}~\ocwlowerid{n1}~\ocwlowerid{before}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{No\_coord}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Bumping the current penalty by a given malus \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{penalize}~\ocwlowerid{malus}~(\ocwlowerid{roles},\ocwlowerid{pen})~=~(\ocwlowerid{roles},\ocwlowerid{pen}+\ocwlowerid{malus})$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Ugly experimental management of "maa" negative particle - temporary 
\ocweol
\label{constraints.ml:18979}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{maa\_counter}~=~$\ocwbt{ref}~0~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{reset\_maa}~()~=~\ocwlowerid{maa\_counter.}\ocwlowerid{val}~:=~0$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} apply tools on the list of roles, read from right to left \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} tools are piped as role streams transducers - res is accumulated output 
   of the form (list role,penalty). \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{use\_tools}~\ocwlowerid{res}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{res}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{r}~::~\ocwlowerid{iroles}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~\ocwupperid{Tool}~\ocwupperid{Coordination}~\rightarrow{}~$\ocwbc{} ca \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwkw{try}~\ocwkw{let}~$(\ocwlowerid{oroles},\ocwlowerid{penalty})~=~\ocwlowerid{res}~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$(\ocwlowerid{result},\ocwlowerid{left})~=~\ocwlowerid{coordinate}~\ocwlowerid{oroles}~\ocwlowerid{iroles}~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{use\_tools}~(\ocwlowerid{result},\ocwlowerid{penalty})~\ocwlowerid{left}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{No\_coord}~\rightarrow{}~\ocwlowerid{use\_tools}~(\ocwlowerid{penalize}~\ocwlowerid{coord\_penalty}~\ocwlowerid{res})~\ocwlowerid{iroles}~]~$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Tool}~\ocwupperid{Post\_instrument}~\rightarrow{}~$\ocwbc{} saha vinaa prep \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwkw{match}~$\ocwlowerid{iroles}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{penalize}~1~\ocwlowerid{res}$\ocweol
\ocwindent{3.50em}
$\mid{}~[~\ocwlowerid{r}~::~\ocwlowerid{previous}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}~\ocweol
\ocwindent{6.00em}
$[~\ocwupperid{Actor}~\ocwupperid{Instrument}~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{use\_tools}~\ocwlowerid{res}~\ocwlowerid{previous}~$\ocwbc{} <i.-saha> \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{use\_tools}~(\ocwlowerid{penalize}~1~\ocwlowerid{res})~\ocwlowerid{iroles}~$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Tool}~\ocwupperid{Not\_Post\_instrument}~\rightarrow{}~$\ocwbc{} saha adv \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwkw{match}~$\ocwlowerid{iroles}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{res}$\ocweol
\ocwindent{3.50em}
$\mid{}~[~\ocwlowerid{r}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}~\ocweol
\ocwindent{6.00em}
$[~\ocwupperid{Actor}~\ocwupperid{Instrument}~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{use\_tools}~(\ocwlowerid{penalize}~1~\ocwlowerid{res})~\ocwlowerid{iroles}$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{use\_tools}~\ocwlowerid{res}~\ocwlowerid{iroles}~$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Tool}~\ocwupperid{Prohibition}~\rightarrow{}~$\ocwbc{} maa \ocwec{}~\ocwkw{do}\ocweol
\ocwindent{3.50em}
\{~$\ocwlowerid{maa\_counter.}\ocwlowerid{val}~:=~\ocwlowerid{maa\_counter.}\ocwlowerid{val}~+~1$\ocweol
\ocwindent{3.50em}
;~$\ocwlowerid{res}$\ocweol
\ocwindent{3.50em}
\}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Tool}~\ocwlowerid{\_}~$\ocwbc{} not yet implemented \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Ignored}~$\ocwbc{} noop \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Compound}~\rightarrow{}~\ocwlowerid{use\_tools}~\ocwlowerid{res}~\ocwlowerid{iroles}~$\ocwbc{} compounds are skipped \ocwec{}\ocweol
\ocwindent{3.50em}
\ocwbc{} ordinary roles are processed as Identity tools \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{let}~$(\ocwlowerid{oroles},\ocwlowerid{p})~=~\ocwlowerid{res}~$\ocwkw{in}~\ocwbc{} otherwise we take role as is \ocwec{}\ocweol
\ocwindent{6.00em}
$\ocwlowerid{use\_tools}~([~\ocwlowerid{r}~::~\ocwlowerid{oroles}~],\ocwlowerid{p})~\ocwlowerid{iroles}~$\ocweol
\ocwindent{2.50em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
We construct a list \ocwbegindcode{}$\ocwlowerid{neg}$\ocwenddcode{} of expected \ocwbegindcode{}$\ocwlowerid{noun\_roles}$\ocwenddcode{}, a list \ocwbegindcode{}$\ocwlowerid{pos}$\ocwenddcode{} of 
   available ones, a counter \ocwbegindcode{}$\ocwlowerid{pro}$\ocwenddcode{} of processes, a boolean \ocwbegindcode{}$\ocwlowerid{subpro}$\ocwenddcode{} indicating
   the need of a finite verb form, a mood integrator \ocwbegindcode{}$\ocwlowerid{moo}$\ocwenddcode{} 
\ocweol
\label{constraints.ml:20794}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{process\_role}~(\ocwlowerid{neg},\ocwlowerid{pos},\ocwlowerid{pro},\ocwlowerid{subpro},\ocwlowerid{moo})~\ocwlowerid{role}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{role}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Process}~\ocwlowerid{noun\_roles}~\ocwlowerid{m}~\rightarrow{}~(\ocwlowerid{noun\_roles}~@~\ocwlowerid{neg},\ocwlowerid{pos},\ocwlowerid{pro}+1,\ocwlowerid{subpro},\ocwlowerid{add\_mood}~\ocwlowerid{m}~\ocwlowerid{moo})$\ocweol
\ocwindent{3.00em}
\ocwbc{} pro+1 is problematic, it does not account for relative clauses \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Subprocess}~\ocwlowerid{noun\_roles}~\rightarrow{}~(\ocwlowerid{noun\_roles}~@~\ocwlowerid{neg},\ocwlowerid{pos},\ocwlowerid{pro},\ocwupperid{True},\ocwlowerid{moo})$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Actor}~\ocwlowerid{noun\_role}~\ocwlowerid{gender}~\ocwlowerid{number}~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
$(\ocwlowerid{neg},[~(\ocwlowerid{noun\_role},~\ocwlowerid{number},~\ocwlowerid{gender})~::~\ocwlowerid{pos}~],\ocwlowerid{pro},\ocwlowerid{subpro},\ocwlowerid{moo})$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~(\ocwlowerid{neg},\ocwlowerid{pos},\ocwlowerid{pro},\ocwlowerid{subpro},\ocwlowerid{moo})$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Missing}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{triple}~=~(\ocwlowerid{noun\_role}~\times{}~\ocwlowerid{number}~\times{}~\ocwlowerid{gender})~$\ocweol
\ocwindent{2.50em}
\ocwbc{} NB there is redundancy in the case (Subject p n,n',g) since n'=n \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{subject\_agreement}~(\ocwlowerid{noun\_role},\ocwlowerid{\_},\ocwlowerid{\_})~\ocwlowerid{p}~\ocwlowerid{n}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{noun\_role}~=~\ocwupperid{Subject}~\ocwlowerid{p}~\ocwlowerid{n}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Tries to find a matching agent: looks into the list of leftover given roles 
   for an expected agent with person p and number n, returns it paired with 
   the rest of given roles if found, raises exception Missing otherwise \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{remove\_subj}~\ocwlowerid{p}~\ocwlowerid{n}~=~\ocwlowerid{remrec}~[\,]~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{remrec}~\ocwlowerid{acc}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Missing}$\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{triple}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{subject\_agreement}~\ocwlowerid{triple}~\ocwlowerid{p}~\ocwlowerid{n}~$\ocwkw{then}~$(\ocwlowerid{triple},\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{acc}~\ocwlowerid{rest})$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~$\ocwlowerid{remrec}~[~\ocwlowerid{triple}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Tries to find a matching role for a non-agent \ocwbegindcode{}$\ocwlowerid{noun\_role}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{remove\_matching}~\ocwlowerid{kar}~=~\ocwlowerid{remrec}~[\,]~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{remrec}~\ocwlowerid{acc}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Missing}$\ocweol
\ocwindent{2.00em}
$\mid{}~[~((\ocwlowerid{k},\ocwlowerid{\_},\ocwlowerid{\_})~$\ocwkw{as}~$\ocwlowerid{triple})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{k}~=~\ocwlowerid{kar}~$\ocwkw{then}~\ocweol
\ocwindent{4.50em}
$(\ocwlowerid{triple},\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{acc}~\ocwlowerid{rest})~$\ocwbc{} we choose latest matching \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwkw{else}~$\ocwlowerid{remrec}~[~\ocwlowerid{triple}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{missing}$\ocwenddcode{} is the list of missing expectancies \ocwbegindcode{}$\ocwlowerid{noun\_roles}$\ocwenddcode{}
   \ocwbegindcode{}$\ocwlowerid{taken}$\ocwenddcode{} is the list of found expectancies \ocwbegindcode{}$\ocwlowerid{noun\_roles}$\ocwenddcode{}
   \ocwbegindcode{}$\ocwlowerid{left}$\ocwenddcode{} is the list of found unexpected \ocwbegindcode{}$\ocwlowerid{noun\_roles}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{process\_exp}~(\ocwlowerid{missing},\ocwlowerid{taken},\ocwlowerid{left})~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
\ocwbc{} for each expected \ocwbegindcode{}$\ocwlowerid{noun\_role}$\ocwenddcode{} we look for a matching given one \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Subject}~\ocwlowerid{p}~\ocwlowerid{n}~\rightarrow{}~$\ocwbc{} verb subject has p and n \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{try}~\ocwkw{let}~$(\ocwlowerid{found},\ocwlowerid{remain})~=~\ocwlowerid{remove\_subj}~\ocwlowerid{p}~\ocwlowerid{n}~\ocwlowerid{left}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$(\ocwlowerid{missing},[~\ocwlowerid{found}~::~\ocwlowerid{taken}~],\ocwlowerid{remain})$\ocweol
\ocwindent{2.00em}
\ocwkw{with}~$[~\ocwupperid{Missing}~\rightarrow{}~(\ocwlowerid{missing},\ocwlowerid{taken},\ocwlowerid{left})~]~$\ocwbc{} subject is optional \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{kar}~\rightarrow{}~$\ocwkw{try}~\ocwkw{let}~$(\ocwlowerid{found},\ocwlowerid{remain})~=~\ocwlowerid{remove\_matching}~\ocwlowerid{kar}~\ocwlowerid{left}~$\ocwkw{in}\ocweol
\ocwindent{7.50em}
$(\ocwlowerid{missing},[~\ocwlowerid{found}~::~\ocwlowerid{taken}~],\ocwlowerid{remain})$\ocweol
\ocwindent{5.50em}
\ocwkw{with}~$[~\ocwupperid{Missing}~\rightarrow{}~([~\ocwlowerid{kar}~::~\ocwlowerid{missing}~],\ocwlowerid{taken},\ocwlowerid{left})~]~$\ocwbc{} mandatory \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Contraction corresponding to agreement between phrase-forming chunks. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Items agreeing with an already taken item are removed from leftovers. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{contract}~\ocwlowerid{taken}~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{filter}~[\,]~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~\ocwlowerid{filter}~\ocwlowerid{left}~\ocwlowerid{triple}~=~$\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{mem}~\ocwlowerid{triple}~\ocwlowerid{taken}~$\ocwkw{then}~$\ocwlowerid{left}$\ocweol
\ocwindent{14.50em}
\ocwkw{else}~$[~\ocwlowerid{triple}~::~\ocwlowerid{left}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Penalty parameters in need of tuning by training \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{missing\_role\_penalty}~\ocwlowerid{\_}~=~1$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{excess\_subject\_penalty}~=~1$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{np\_penalty}~=~2$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{absol\_penalty}~=~2~$\ocwbc{} absolutive without finite verb \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} remaining extra nominatives give penalty \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{count\_excess}~\ocwlowerid{pen}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~(\ocwupperid{Subject}~\ocwlowerid{p}~\ocwlowerid{n},\ocwlowerid{\_},\ocwlowerid{\_})~\rightarrow{}~\ocwlowerid{pen}+\ocwlowerid{excess\_subject\_penalty}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{triple}~\rightarrow{}~\ocwlowerid{pen}~$\ocwbc{} taken as adverbs or genitive noun phrases \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We count all persons with same person and number \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{count\_subj}~\ocwlowerid{persons}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Subject}~\ocwlowerid{p}~\ocwlowerid{n}~\rightarrow{}~\ocwupperid{List2.}\ocwlowerid{union1}~(\ocwlowerid{p},\ocwlowerid{n})~\ocwlowerid{persons}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{persons}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{count\_missing}~\ocwlowerid{pen}~\ocwlowerid{k}~=~\ocwlowerid{pen}+\ocwlowerid{missing\_role\_penalty}~\ocwlowerid{k}~$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{missing\_penalty}~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{count\_missing}~0$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{excess\_penalty}~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{count\_excess}~0~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{penalty}~=$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Sentence}~$\ocwkw{of}~$($\ocwbt{int}~$\times{}~$\ocwbt{int}~$\times{}~$\ocwbt{int}~$\times{}~$\ocwbt{int}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Copula}~$\ocwkw{of}~$($\ocwbt{int}~$\times{}~$\ocwbt{int}~$\times{}~$\ocwbt{int}~$\times{}~$\ocwbt{int}~$\times{}~$\ocwbt{int}$)~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{NP}~$\ocwkw{of}~$\ocwlowerid{penalty}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{show\_penalty}~=~$\ocwkw{fun}~\ocwbc{} explicit vector for debug \ocwec{}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Sentence}~(\ocwlowerid{p1},\ocwlowerid{p2},\ocwlowerid{p3},\ocwlowerid{p4})~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
\ocwstring{"S("}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{p1}~$\^{}~\ocwstring{","}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{p2}~$\^{}~\ocwstring{","}~\ocweol
\ocwindent{5.00em}
\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{p3}~$\^{}~\ocwstring{","}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{p4}~$\^{}~\ocwstring{")"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Copula}~(\ocwlowerid{p1},\ocwlowerid{p2},\ocwlowerid{p3},\ocwlowerid{p4},\ocwlowerid{p5})~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
\ocwstring{"C("}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{p1}~$\^{}~\ocwstring{","}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{p2}~$\^{}~\ocwstring{","}~\ocweol
\ocwindent{5.00em}
\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{p3}~$\^{}~\ocwstring{","}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{p4}~$\^{}~\ocwstring{","}\ocweol
\ocwindent{5.00em}
\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{p5}~$\^{}~\ocwstring{")"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{NP}~\ocwlowerid{p}~\rightarrow{}~\ocwlowerid{string\_of\_int}~\ocwlowerid{np\_penalty}~$\^{}~\ocwstring{"+"}~\^{}~$\ocwlowerid{show\_penalty}~\ocwlowerid{p}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Ad-hoc linear penalty function - to be optimized by corpus training \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{eval\_penalty}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Sentence}~(\ocwlowerid{pen1},\ocwlowerid{pen2},\ocwlowerid{pen3},\ocwlowerid{pen4})~\rightarrow{}~\ocwlowerid{pen1}+\ocwlowerid{pen2}+\ocwlowerid{pen3}+\ocwlowerid{pen4}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Copula}~(\ocwlowerid{pen1},\ocwlowerid{pen2},\ocwlowerid{pen3},\ocwlowerid{pen4},\ocwlowerid{pen5})~\rightarrow{}~\ocwlowerid{pen1}+\ocwlowerid{pen2}+\ocwlowerid{pen3}+\ocwlowerid{pen4}+\ocwlowerid{pen5}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{NP}~\ocwlowerid{pen}~\rightarrow{}~\ocwlowerid{np\_penalty}~+~\ocwlowerid{eval\_penalty}~\ocwlowerid{pen}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{balance\_process}~\ocwlowerid{pro}~\ocwlowerid{subpro}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{pro}>1~$\ocwkw{then}~$\ocwlowerid{pro}-1~$\ocwbc{} TEMP, to be adjusted with relative clauses \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{pro}=0~$\ocwkw{then}~\ocwkw{if}~$\ocwlowerid{subpro}~$\ocwkw{then}~$\ocwlowerid{absol\_penalty}~$\ocwkw{else}~0\ocweol
\ocwindent{1.00em}
\ocwkw{else}~0\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Delay dealing with nominatives in order to favor Acc over Nom for neuters \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sort\_kar}~=~\ocwlowerid{sort\_rec}~[\,]~[\,]~0$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{sort\_rec}~\ocwlowerid{nomins}~\ocwlowerid{others}~\ocwlowerid{n}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~(\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{others}~\ocwlowerid{nomins},\ocwlowerid{n})$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwupperid{Subject}~\ocwlowerid{\_}~\ocwlowerid{\_}~$\ocwkw{as}~$\ocwlowerid{kar})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{sort\_rec}~[~\ocwlowerid{kar}~::~\ocwlowerid{nomins}~]~\ocwlowerid{others}~(\ocwlowerid{n}+1)~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{kar}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{sort\_rec}~\ocwlowerid{nomins}~[~\ocwlowerid{kar}~::~\ocwlowerid{others}~]~\ocwlowerid{n}~\ocwlowerid{rest}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{check\_sentence}~\ocwlowerid{pen1}~\ocwlowerid{neg}~\ocwlowerid{pos}~\ocwlowerid{pro}~\ocwlowerid{subpro}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{missing},\ocwlowerid{taken},\ocwlowerid{left})~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{process\_exp}~([\,],[\,],\ocwlowerid{pos})~\ocwlowerid{neg}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{contracted}~=~\ocwlowerid{contract}~\ocwlowerid{taken}~\ocwlowerid{left}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pen2}~=~\ocwlowerid{missing\_penalty}~\ocwlowerid{missing}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{pen3}~=~\ocwlowerid{excess\_penalty}~\ocwlowerid{contracted}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{pen4}~=~\ocwlowerid{balance\_process}~\ocwlowerid{pro}~\ocwlowerid{subpro}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwupperid{Sentence}~(\ocwlowerid{pen1},\ocwlowerid{pen2},\ocwlowerid{pen3},\ocwlowerid{pen4})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Given a list of remaining roles, tries to find a matching Subject; 
   returns (missing,taken,rest) where either taken is the singleton found, 
   rest is the list of remaining roles, and missing is empty, or else taken 
   is empty, missing is the singleton not found, and rest is all roles \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{process\_exp\_g}~\ocwlowerid{p}~\ocwlowerid{n}~\ocwlowerid{roles}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{remove\_matching}~=~\ocwlowerid{remrec}~[\,]~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{remrec}~\ocwlowerid{acc}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Missing}$\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{triple}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{triple}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~(\ocwupperid{Subject}~\ocwlowerid{p}~\ocwlowerid{n'},\ocwlowerid{\_},\ocwlowerid{\_})~$\ocwkw{when}~$\ocwlowerid{n'}=\ocwlowerid{n}~\rightarrow{}~(\ocwlowerid{triple},\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{acc}~\ocwlowerid{rest})$\ocweol
\ocwindent{14.50em}
\ocwbc{} NB there is no mandatory concord of genders \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{remrec}~[~\ocwlowerid{triple}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{0.00em}
\ocwbc{} we look for a matching nominative \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{try}~\ocwkw{let}~$(\ocwlowerid{found},\ocwlowerid{remain})~=~\ocwlowerid{remove\_matching}~\ocwlowerid{roles}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$([\,],[~\ocwlowerid{found}~],\ocwlowerid{remain})$\ocweol
\ocwindent{2.00em}
\ocwkw{with}~$[~\ocwupperid{Missing}~\rightarrow{}~$\ocwbc{} First and Second persons Subjects are optional \ocwec{}\ocweol
\ocwindent{5.50em}
\ocwkw{if}~$\ocwlowerid{p}~=~\ocwupperid{First}~\lor{}~\ocwlowerid{p}~=~\ocwupperid{Second}~$\ocwkw{then}~$([\,],[\,],\ocwlowerid{roles})$\ocweol
\ocwindent{5.50em}
\ocwkw{else}~$([~\ocwupperid{Subject}~\ocwlowerid{p}~\ocwlowerid{n}~],[\,],\ocwlowerid{roles})~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{check\_copula\_sentence}~\ocwlowerid{pen1}~\ocwlowerid{p}~\ocwlowerid{n}~\ocwlowerid{pos}~\ocwlowerid{subpro}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{missing},\ocwlowerid{taken},\ocwlowerid{left})~=~\ocwlowerid{process\_exp\_g}~\ocwlowerid{p}~\ocwlowerid{n}~\ocwlowerid{pos}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{contracted}~=~\ocwlowerid{contract}~\ocwlowerid{taken}~\ocwlowerid{left}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pen2}~=~\ocwlowerid{missing\_penalty}~\ocwlowerid{missing}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{pen3}~=~\ocwlowerid{excess\_penalty}~\ocwlowerid{contracted}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{pen4}~=~$\ocwkw{if}~$\ocwlowerid{subpro}~$\ocwkw{then}~$\ocwlowerid{absol\_penalty}~$\ocwkw{else}~0~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{Copula}~(\ocwlowerid{pen1},\ocwlowerid{pen2},\ocwlowerid{pen3},\ocwlowerid{pen4},0)$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{get\_predicate}$\ocwenddcode{} returns the first available Subject (backward from the end)
   if there is one, else raises Missing \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{get\_predicate}~=~\ocwlowerid{search\_subject}~[\,]~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{search\_subject}~\ocwlowerid{acc}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Missing}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~((\ocwlowerid{kar},\ocwlowerid{\_},\ocwlowerid{\_})~$\ocwkw{as}~$\ocwlowerid{triple})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{kar}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Subject}~\ocwlowerid{p}~\ocwlowerid{n}~\rightarrow{}~(\ocwlowerid{p},~\ocwlowerid{n},~\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{acc}~\ocwlowerid{rest})$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{search\_subject}~[~\ocwlowerid{triple}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwbc{} NB adding a topic amounts to replacing \ocwbegindcode{}$\ocwlowerid{get\_predicate}~\ocwlowerid{pos}$\ocwenddcode{} 
   by (Third,Singular,pos) below \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We enforce that maa must correspond to an injunctive or an imperative
   and that injunctives occur only with maa. TODO: allow also optative,
   subjunctive and augmentless imperfect with maa. UGLY \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{mood\_correction}~(\ocwlowerid{imp},\ocwlowerid{inj})~\ocwlowerid{pen}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{maa\_tokens}~=~\ocwlowerid{maa\_counter.}\ocwlowerid{val}~$\ocwkw{in}~\ocwbc{} counted by Prohibition tool \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{maa\_pen}~=~$\ocwkw{if}~$\ocwlowerid{maa\_tokens}>\ocwlowerid{imp}+\ocwlowerid{inj}~$\ocwkw{then}~$\ocwlowerid{maa\_tokens}-(\ocwlowerid{imp}+\ocwlowerid{inj})$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{inj}>\ocwlowerid{maa\_tokens}~$\ocwkw{then}~$\ocwlowerid{inj}-\ocwlowerid{maa\_tokens}~$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~0~\ocwkw{in}~\ocwkw{match}~$\ocwlowerid{pen}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Sentence}~(\ocwlowerid{p1},\ocwlowerid{p2},\ocwlowerid{p3},\ocwlowerid{p4})~\rightarrow{}~\ocwupperid{Sentence}~(\ocwlowerid{p1},\ocwlowerid{p2},\ocwlowerid{p3},\ocwlowerid{p4}+\ocwlowerid{maa\_pen})~$\ocwbc{} p4=0 \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Copula}~(\ocwlowerid{p1},\ocwlowerid{p2},\ocwlowerid{p3},\ocwlowerid{p4},\ocwlowerid{p5})~\rightarrow{}~\ocwupperid{Copula}~(\ocwlowerid{p1},\ocwlowerid{p2},\ocwlowerid{p3},\ocwlowerid{p4},\ocwlowerid{p5}+\ocwlowerid{maa\_pen})~$\ocwbc{} p5=0 \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{NP}~\ocwlowerid{pen}~\rightarrow{}~\ocwlowerid{mood\_correction}~(\ocwlowerid{imp},\ocwlowerid{inj})~\ocwlowerid{pen}~$\ocwbc{} weird \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{inspect}~\ocwlowerid{pen}~(\ocwlowerid{neg},\ocwlowerid{pos},\ocwlowerid{pro},\ocwlowerid{subpro},\ocwlowerid{md})~=~\ocwlowerid{mood\_correction}~\ocwlowerid{md}~\ocwlowerid{pens}~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~\ocwlowerid{pens}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{neg}=[\,]~$\ocwbc{} no overt verb, we conjecture copula (pro=0) \ocwec{}~\ocwkw{then}\ocweol
\ocwindent{2.50em}
\ocwkw{try}~\ocwkw{let}~$(\ocwlowerid{p},\ocwlowerid{n},\ocwlowerid{rest})~=~\ocwlowerid{get\_predicate}~\ocwlowerid{pos}~$\ocwkw{in}~\ocweol
\ocwindent{4.50em}
$\ocwlowerid{check\_copula\_sentence}~\ocwlowerid{pen}~\ocwlowerid{p}~\ocwlowerid{n}~\ocwlowerid{rest}~\ocwlowerid{subpro}$\ocweol
\ocwindent{2.50em}
\ocwkw{with}~$[~\ocwupperid{Missing}~\rightarrow{}~$\ocwbc{} maybe noun phrase \ocwec{}\ocweol
\ocwindent{7.00em}
$\ocwupperid{NP}~(\ocwlowerid{check\_sentence}~\ocwlowerid{pen}~[\,]~\ocwlowerid{pos}~\ocwlowerid{pro}~\ocwlowerid{subpro})~]~$\ocwbc{} 2+ \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{else}~$\ocwlowerid{check\_sentence}~\ocwlowerid{pen}~\ocwlowerid{neg}~\ocwlowerid{pos}~\ocwlowerid{pro}~\ocwlowerid{subpro}~$\ocwbc{} verbal predicate exists \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We compute a path penalty by applying \ocwbegindcode{}$\ocwlowerid{use\_tools}$\ocwenddcode{} from right to left 
   to the given path, then iterating \ocwbegindcode{}$\ocwlowerid{process\_role}$\ocwenddcode{} on the resulting roles,
   then inspecting and weighting the resulting constraints \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{penalty}~\ocwlowerid{rev\_path}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{right\_left\_roles}~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwlowerid{snd}~\ocwlowerid{rev\_path}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{reset\_maa}~()~$\ocwbc{} horreur \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$(\ocwlowerid{roles},\ocwlowerid{pen\_tools})~=~\ocwlowerid{use\_tools}~([\,],0)~\ocwlowerid{right\_left\_roles}~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{constraints}~=~$\ocweol
\ocwindent{4.00em}
$\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{process\_role}~([\,],[\,],0,\ocwupperid{False},\ocwlowerid{ini\_mood})~\ocwlowerid{roles}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{inspect}~\ocwlowerid{pen\_tools}~\ocwlowerid{constraints}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{flattening}~=~$\ocwbt{list}~$(\ocwlowerid{penalty}~\times{}~$\ocwbt{list}~$\ocwlowerid{roles})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We flatten all choices in the chunked solution \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{sort\_flatten}:~$\ocwbt{list}~$\ocwlowerid{roles}~\rightarrow{}~\ocwlowerid{flattening}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sort\_flatten}~\ocwlowerid{groups}~=~$\ocwbc{} groups goes backward in time \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{parses}~=~\ocwlowerid{flatten\_add}~\ocwlowerid{groups}~$\ocwkw{in}~\ocwbc{} each parse goes backward in time \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{insert\_in}~\ocwlowerid{sorted\_buckets}~\ocwlowerid{rev\_path}~=~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{p}~=~\ocwlowerid{penalty}~\ocwlowerid{rev\_path}~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{ep}~=~\ocwlowerid{eval\_penalty}~\ocwlowerid{p}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{ins\_rec}~[\,]~\ocwlowerid{sorted\_buckets}$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{ins\_rec}~\ocwlowerid{acc}~=~$\ocwkw{fun}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{acc}~[~(\ocwlowerid{p},[~\ocwlowerid{rev\_path}~])~]$\ocweol
\ocwindent{3.00em}
$\mid{}~([~((\ocwlowerid{pk},\ocwlowerid{b\_k})~$\ocwkw{as}~$\ocwlowerid{b})~::~\ocwlowerid{r}~]~$\ocwkw{as}~$\ocwlowerid{buckets})~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{ek}~=~\ocwlowerid{eval\_penalty}~\ocwlowerid{pk}~$\ocwkw{in}~\ocwbc{} recomputation to avoid \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{ek}=\ocwlowerid{ep}~$\ocwkw{then}~$\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{acc}~[~(\ocwlowerid{p},[~\ocwlowerid{rev\_path}~::~\ocwlowerid{b\_k}~])~::~\ocwlowerid{r}~]$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{ek}<\ocwlowerid{ep}~$\ocwkw{then}~$\ocwlowerid{ins\_rec}~[~\ocwlowerid{b}~::~\ocwlowerid{acc}~]~\ocwlowerid{r}$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$\ocwupperid{List2.}\ocwlowerid{unstack}~\ocwlowerid{acc}~[~(\ocwlowerid{p},[~\ocwlowerid{rev\_path}~])~::~\ocwlowerid{buckets}~]$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{sort\_penalty}~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{insert\_in}~[\,]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{sort\_penalty}~\ocwlowerid{parses}$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Output truncated to avoid choking on immense web page.
   Returns penalty threshold if truncation. Used in Reader and Parser 
\ocweol
\label{constraints.ml:30261}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{truncate\_groups}~\ocwlowerid{buckets}~=~$\ocwkw{match}~$\ocwlowerid{buckets}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{best}~::~[~\ocwlowerid{next}~::~\ocwlowerid{rest}~]~]~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{top}~=~[~\ocwlowerid{best};~\ocwlowerid{next}~]~$\ocwkw{in}~\ocwbc{} top 2 buckets \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{threshold}~=~$\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwlowerid{rest}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{None}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~(\ocwlowerid{p},\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwupperid{Some}~(\ocwlowerid{eval\_penalty}~\ocwlowerid{p})$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
$(\ocwlowerid{top},~\ocwlowerid{threshold})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~(\ocwlowerid{buckets},~\ocwupperid{None})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\label{constraints.ml:30579}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{extract}~\ocwlowerid{str}~((\ocwlowerid{seg},\ocwlowerid{sub},\ocwlowerid{ind}),\ocwlowerid{\_})~=~$\ocwbc{} construct tag projections \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{m}~=~\ocwlowerid{string\_of\_int}~\ocwlowerid{sub}~$\ocwbc{} segment number \ocwbegindcode{}$\ocwlowerid{seg}$\ocwenddcode{} is redundant \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{n}~=~\ocwlowerid{string\_of\_int}~\ocwlowerid{ind}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{proj}~=~\ocwlowerid{m}~$\^{}~\ocwstring{","}~\^{}~$\ocwlowerid{n}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{str}=$\ocwstring{""}~\ocwkw{then}~$\ocwlowerid{proj}~$\ocwkw{else}~$\ocwlowerid{proj}~$\^{}~\ocwstring{"|"}~\^{}~$\ocwlowerid{str}$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
end; 
\ocweol
\typeout{OcamlWeb file Multilingual.ml}
\ocwmodule{Multilingual}
\label{multilingual.ml:0}%
This module gives headers of grammar engines Declension and Conjugation
   both in roman font (English at present) and devanagarii font (Sanskrit) 
\ocweol
\label{multilingual.ml:811}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\medskip

\label{multilingual.ml:839}%
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{font}~=~[~\ocwupperid{Deva}~\mid{}~\ocwupperid{Roma}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{font\_of\_string}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"deva"}~$\rightarrow{}~\ocwupperid{Deva}$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"roma"}~$\rightarrow{}~\ocwupperid{Roma}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{f}~\rightarrow{}~\ocwlowerid{failwith}~($\ocwstring{"Unknown\ocwvspace{}font\ocwvspace{}"}~\^{}~$\ocwlowerid{f})$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{string\_of\_font}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~$\ocwstring{"deva"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~$\ocwstring{"roma"}\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{gender\_caption}~\ocwlowerid{gender}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Roma}~\rightarrow{}~\ocwlowerid{span3\_center}~($\ocwkw{match}~$\ocwlowerid{gender}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Mas}~\rightarrow{}~$\ocwstring{"Masculine"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"Feminine"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"Neuter"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Deictic}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"All"}\ocweol
\ocwindent{3.00em}
$])$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Deva}~\rightarrow{}~\ocwlowerid{deva12\_blue\_center}~(\ocwupperid{Encode.}\ocwlowerid{skt\_raw\_to\_deva}~($\ocwkw{match}~$\ocwlowerid{gender}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Mas}~\rightarrow{}~$\ocwstring{"pumaan"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Fem}~\rightarrow{}~$\ocwstring{"strii.h"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~$\ocwstring{"napu.msakam"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Deictic}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"sarvam"}\ocweol
\ocwindent{3.00em}
$]))$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{number\_caption}~\ocwlowerid{number}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Roma}~\rightarrow{}~\ocwlowerid{span3\_center}~($\ocwkw{match}~$\ocwlowerid{number}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Singular}~\rightarrow{}~$\ocwstring{"Singular"}~\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Dual}~\rightarrow{}~$\ocwstring{"Dual"}~\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Plural}~\rightarrow{}~$\ocwstring{"Plural"}~\ocweol
\ocwindent{3.00em}
$])$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Deva}~\rightarrow{}~\ocwlowerid{deva12\_blue\_center}~(\ocwupperid{Encode.}\ocwlowerid{skt\_raw\_to\_deva}~($\ocwkw{match}~$\ocwlowerid{number}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Singular}~\rightarrow{}~$\ocwstring{"eka.h"}~\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Dual}~\rightarrow{}~$\ocwstring{"dvau"}~\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Plural}~\rightarrow{}~$\ocwstring{"bahava.h"}~\ocweol
\ocwindent{3.00em}
$]))$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{case\_caption}~\ocwlowerid{case}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Roma}~\rightarrow{}~\ocwlowerid{span3\_center}~($\ocwkw{match}~$\ocwlowerid{case}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Nom}~\rightarrow{}~$\ocwstring{"Nominative"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Acc}~\rightarrow{}~$\ocwstring{"Accusative"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Ins}~\rightarrow{}~$\ocwstring{"Instrumental"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Dat}~\rightarrow{}~$\ocwstring{"Dative"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Abl}~\rightarrow{}~$\ocwstring{"Ablative"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Gen}~\rightarrow{}~$\ocwstring{"Genitive"}~\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Loc}~\rightarrow{}~$\ocwstring{"Locative"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Voc}~\rightarrow{}~$\ocwstring{"Vocative"}\ocweol
\ocwindent{3.00em}
$])$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Deva}~\rightarrow{}~\ocwlowerid{deva12\_blue\_center}~(\ocwupperid{Encode.}\ocwlowerid{skt\_raw\_to\_deva}~($\ocwkw{match}~$\ocwlowerid{case}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Nom}~\rightarrow{}~$\ocwstring{"prathamaa"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Acc}~\rightarrow{}~$\ocwstring{"dvitiiyaa"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Ins}~\rightarrow{}~$\ocwstring{"t.rtiiyaa"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Dat}~\rightarrow{}~$\ocwstring{"caturthii"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Abl}~\rightarrow{}~$\ocwstring{"pa\~{}ncamii"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Gen}~\rightarrow{}~$\ocwstring{".sa.s.thii"}~\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Loc}~\rightarrow{}~$\ocwstring{"saptamii"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Voc}~\rightarrow{}~$\ocwstring{"sambodhanam"}\ocweol
\ocwindent{3.00em}
$]))$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compound\_name}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Roma}~\rightarrow{}~\ocwlowerid{span3\_center}~$\ocwstring{"Compound"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Deva}~\rightarrow{}~\ocwlowerid{deva12\_blue\_center}~(\ocwupperid{Encode.}\ocwlowerid{skt\_raw\_to\_deva}~$\ocwstring{"samaasa"}$)$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{avyaya\_name}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Roma}~\rightarrow{}~\ocwlowerid{span3\_center}~$\ocwstring{"Adverb"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Deva}~\rightarrow{}~\ocwlowerid{deva12\_blue\_center}~(\ocwupperid{Encode.}\ocwlowerid{skt\_raw\_to\_deva}~$\ocwstring{"avyaya"}$)$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{western\_pr}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Present}~\rightarrow{}~$\ocwstring{"Present"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Imperative}~\rightarrow{}~$\ocwstring{"Imperative"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Optative}~\rightarrow{}~$\ocwstring{"Optative"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Imperfect}~\rightarrow{}~$\ocwstring{"Imperfect"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{indian\_pr}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Present}~\rightarrow{}~$\ocwstring{"la.t"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Imperative}~\rightarrow{}~$\ocwstring{"lo.t"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Optative}~\rightarrow{}~$\ocwstring{"vidhilif"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Imperfect}~\rightarrow{}~$\ocwstring{"laf"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{western\_tense}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Future}~\rightarrow{}~$\ocwstring{"Future"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Perfect}~\rightarrow{}~$\ocwstring{"Perfect"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Aorist}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"Aorist"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Injunctive}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"Injunctive"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Conditional}~\rightarrow{}~$\ocwstring{"Conditional"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Benedictive}~\rightarrow{}~$\ocwstring{"Benedictive"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{indian\_tense}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Future}~\rightarrow{}~$\ocwstring{"l.r.t"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Perfect}~\rightarrow{}~$\ocwstring{"li.t"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Aorist}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"luf"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Injunctive}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"aagamaabhaavayuktaluf"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Conditional}~\rightarrow{}~$\ocwstring{"l.rf"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Benedictive}~\rightarrow{}~$\ocwstring{"aaziirlif"}~\ocweol
\ocwindent{0.00em}
\ocwbc{}| Subjunctive  -> \ocwstring{"le.t"} \ocwec{}\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{gentense}~=$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Present\_tense}~$\ocwkw{of}~$\ocwlowerid{pr\_mode}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Other\_tense}~$\ocwkw{of}~$\ocwlowerid{tense}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{tense\_name}~\ocwlowerid{gentense}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~\ocwlowerid{deva16\_blue\_center}~(\ocwupperid{Encode.}\ocwlowerid{skt\_raw\_to\_deva}~\ocwlowerid{s})~$\ocweol
\ocwindent{6.00em}
$\ocwlowerid{where}~\ocwlowerid{s}~=~$\ocwkw{match}~$\ocwlowerid{gentense}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Present\_tense}~\ocwlowerid{pr}~\rightarrow{}~\ocwlowerid{indian\_pr}~\ocwlowerid{pr}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Other\_tense}~\ocwlowerid{t}~\rightarrow{}~\ocwlowerid{indian\_tense}~\ocwlowerid{t}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~\ocwlowerid{span2\_center}~\ocwlowerid{s}~\ocwlowerid{where}~\ocwlowerid{s}~=~$\ocwkw{match}~$\ocwlowerid{gentense}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Present\_tense}~\ocwlowerid{pr}~\rightarrow{}~\ocwlowerid{western\_pr}~\ocwlowerid{pr}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Other\_tense}~\ocwlowerid{t}~\rightarrow{}~\ocwlowerid{western\_tense}~\ocwlowerid{t}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{perfut\_name}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~\ocwlowerid{deva16\_blue\_center}~(\ocwupperid{Encode.}\ocwlowerid{skt\_raw\_to\_deva}~$\ocwstring{"lu.t"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~\ocwlowerid{span2\_center}~$\ocwstring{"Periphrastic\ocwvspace{}Future"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{person\_name}~\ocwlowerid{person}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{deva\_person}~=~$\ocwkw{match}~$\ocwlowerid{person}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~\ocwupperid{First}~\rightarrow{}~$\ocwstring{"uttama"}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{Second}~\rightarrow{}~$\ocwstring{"madhyama"}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{Third}~\rightarrow{}~$\ocwstring{"prathama"}\ocweol
\ocwindent{8.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{6.00em}
$\ocwlowerid{deva12\_blue\_center}~$\ocweol
\ocwindent{8.00em}
$(\ocwupperid{Encode.}\ocwlowerid{skt\_raw\_to\_deva}~\ocwlowerid{deva\_person})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{roma\_person}~=~$\ocwkw{match}~$\ocwlowerid{person}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~\ocwupperid{First}~\rightarrow{}~$\ocwstring{"First"}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{Second}~\rightarrow{}~$\ocwstring{"Second"}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{Third}~\rightarrow{}~$\ocwstring{"Third"}\ocweol
\ocwindent{8.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{6.00em}
$\ocwlowerid{span3\_center}~\ocwlowerid{roma\_person}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{conjugation\_name}~\ocwlowerid{conj}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{indian\_conj}~=~$\ocwkw{match}~$\ocwlowerid{conj}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~\ocwupperid{Primary}~\rightarrow{}~$\ocwstring{"apratyayaantadhaatu"}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{Causative}~\rightarrow{}~$\ocwstring{".nic"}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{Intensive}~\rightarrow{}~$\ocwstring{"yaf"}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{Desiderative}~\rightarrow{}~$\ocwstring{"san"}\ocweol
\ocwindent{8.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{6.00em}
$\ocwlowerid{deva16\_blue\_center}~(\ocwupperid{Encode.}\ocwlowerid{skt\_raw\_to\_deva}~\ocwlowerid{indian\_conj})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{western\_conj}~=~$\ocwkw{match}~$\ocwlowerid{conj}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~\ocwupperid{Primary}~\rightarrow{}~$\ocwstring{"Primary"}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{Causative}~\rightarrow{}~$\ocwstring{"Causative"}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{Intensive}~\rightarrow{}~$\ocwstring{"Intensive"}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{Desiderative}~\rightarrow{}~$\ocwstring{"Desiderative"}\ocweol
\ocwindent{8.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{6.00em}
$\ocwlowerid{span2\_center}~(\ocwlowerid{western\_conj}~$\^{}~\ocwstring{"\ocwvspace{}Conjugation"}$)$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{conjugation\_title}~\ocwlowerid{narrow}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{skt\_to\_deva}~$\ocwstring{"dhaatuvibhakti"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{narrow}~$\ocwkw{then}~\ocwstring{"Conjugation"}\ocweol
\ocwindent{6.00em}
\ocwkw{else}~\ocwstring{"The\ocwvspace{}Sanskrit\ocwvspace{}Grammarian:\ocwvspace{}Conjugation"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{declension\_title}~\ocwlowerid{narrow}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{skt\_to\_deva}~$\ocwstring{"praatipadikavibhakti"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{narrow}~$\ocwkw{then}~\ocwstring{"Declension"}\ocweol
\ocwindent{6.00em}
\ocwkw{else}~\ocwstring{"The\ocwvspace{}Sanskrit\ocwvspace{}Grammarian:\ocwvspace{}Declension"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{conjugation\_caption}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{skt\_to\_deva}~$\ocwstring{"tifantaavalii"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~$\ocwstring{"Conjugation\ocwvspace{}tables\ocwvspace{}of"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{declension\_caption}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{skt\_to\_deva}~$\ocwstring{"subantaavalii"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~$\ocwstring{"Declension\ocwvspace{}table\ocwvspace{}of"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{participles\_caption}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~\ocwlowerid{deva16\_blue\_center}~(\ocwupperid{Encode.}\ocwlowerid{skt\_raw\_to\_deva}~$\ocwstring{"k.rdanta"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~\ocwlowerid{span2\_center}~$\ocwstring{"Participles"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{indeclinables\_caption}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~\ocwlowerid{deva16\_blue\_center}~(\ocwupperid{Encode.}\ocwlowerid{skt\_raw\_to\_deva}~$\ocwstring{"avyaya"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~\ocwlowerid{span2\_center}~$\ocwstring{"Indeclinable\ocwvspace{}forms"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{infinitive\_caption}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{skt\_to\_deva}~$\ocwstring{"tumun"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~$\ocwstring{"Infinitive"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{absolutive\_caption}~\ocwlowerid{is\_root}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{skt\_to\_deva}~($\ocwkw{if}~$\ocwlowerid{is\_root}~$\ocwkw{then}~\ocwstring{"ktvaa"}~\ocwkw{else}~\ocwstring{"lyap"}$)$\ocweol
\ocwindent{0.00em}
\ocwbc{} PB: absolutives in -aam should rather be labeled \ocwstring{".namul"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~$\ocwstring{"Absolutive"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{peripft\_caption}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{skt\_to\_deva}~$\ocwstring{"li.t"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~$\ocwstring{"Periphrastic\ocwvspace{}Perfect"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{voice\_mark}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Active}~\rightarrow{}~$\ocwstring{"para"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Middle}~\rightarrow{}~$\ocwstring{"aatma"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Passive}~\rightarrow{}~$\ocwstring{"karma.ni"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{participle\_name}~\ocwlowerid{part}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{indian\_part}~=~$\ocwkw{match}~$\ocwlowerid{part}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Ppp}~\rightarrow{}~[~$\ocwstring{"kta"}~$]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Pppa}~\rightarrow{}~[~$\ocwstring{"ktavat"}~$]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Ppra}~\ocwlowerid{\_}~\rightarrow{}~[~$\ocwstring{"zat.r"}~$]~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Pprm}~\ocwlowerid{\_}~\rightarrow{}~[~$\ocwstring{"zaanac"}~$]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Pprp}~\rightarrow{}~[~$\ocwstring{"zaanac"};~\ocwstring{"karma.ni"}~$]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Ppfta}~\rightarrow{}~[~$\ocwstring{"li.daadeza"};~$\ocwlowerid{voice\_mark}~\ocwupperid{Active}~]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Ppftm}~\rightarrow{}~[~$\ocwstring{"li.daadeza"};~$\ocwlowerid{voice\_mark}~\ocwupperid{Middle}~]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Pfuta}~\rightarrow{}~[~$\ocwstring{"lu.taadeza"};~$\ocwlowerid{voice\_mark}~\ocwupperid{Active}~]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Pfutm}~\rightarrow{}~[~$\ocwstring{"lu.taadeza"};~$\ocwlowerid{voice\_mark}~\ocwupperid{Middle}~]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Pfutp}~\ocwlowerid{k}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{k}~$\ocwkw{with}~\ocweol
\ocwindent{9.50em}
$[~1~\rightarrow{}~[~$\ocwstring{"yat"}~$]$\ocweol
\ocwindent{9.50em}
$\mid{}~2~\rightarrow{}~[~$\ocwstring{"aniiyar"}~$]$\ocweol
\ocwindent{9.50em}
$\mid{}~3~\rightarrow{}~[~$\ocwstring{"tavya"}~$]$\ocweol
\ocwindent{9.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[\,]$\ocweol
\ocwindent{9.50em}
$]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Action\_noun}~\rightarrow{}~[~$\ocwstring{"krit"}~$]~$\ocwbc{} \ocwstring{"gha\~{}n"} for -a \ocwstring{"lyu.t"} for -ana \ocwec{}\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{cat}~\ocwlowerid{s}~\ocwlowerid{x}~=~\ocwlowerid{s}~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}~$(\ocwupperid{Encode.}\ocwlowerid{skt\_raw\_to\_deva}~\ocwlowerid{x})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{cat}~$\ocwstring{""}~$\ocwlowerid{indian\_part}~$\ocwbc{} no skt punctuation so far \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{western\_part}~=~$\ocwkw{match}~$\ocwlowerid{part}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Ppp}~\rightarrow{}~$\ocwstring{"Past\ocwvspace{}Passive\ocwvspace{}Participle"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Pppa}~\rightarrow{}~$\ocwstring{"Past\ocwvspace{}Active\ocwvspace{}Participle"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Ppra}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"Present\ocwvspace{}Active\ocwvspace{}Participle"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Pprm}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"Present\ocwvspace{}Middle\ocwvspace{}Participle"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Pprp}~\rightarrow{}~$\ocwstring{"Present\ocwvspace{}Passive\ocwvspace{}Participle"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Ppfta}~\rightarrow{}~$\ocwstring{"Perfect\ocwvspace{}Active\ocwvspace{}Participle"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Ppftm}~\rightarrow{}~$\ocwstring{"Perfect\ocwvspace{}Middle\ocwvspace{}Participle"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Pfuta}~\rightarrow{}~$\ocwstring{"Future\ocwvspace{}Active\ocwvspace{}Participle"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Pfutm}~\rightarrow{}~$\ocwstring{"Future\ocwvspace{}Middle\ocwvspace{}Participle"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Pfutp}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"Future\ocwvspace{}Passive\ocwvspace{}Participle"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Action\_noun}~\rightarrow{}~$\ocwstring{"Action\ocwvspace{}Noun"}\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}~$\ocwlowerid{western\_part}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{voice\_name}~\ocwlowerid{voice}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{ivoice}~=~$\ocwkw{match}~$\ocwlowerid{voice}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~\ocwupperid{Active}~\rightarrow{}~$\ocwstring{"parasmaipade"}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{Middle}~\rightarrow{}~$\ocwstring{"aatmanepade"}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{Passive}~\rightarrow{}~$\ocwstring{"karma.ni"}\ocweol
\ocwindent{8.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{6.00em}
$\ocwlowerid{deva12\_blue\_center}~(\ocwupperid{Encode.}\ocwlowerid{skt\_raw\_to\_deva}~\ocwlowerid{ivoice})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{wvoice}~=~$\ocwkw{match}~$\ocwlowerid{voice}~$\ocwkw{with}\ocweol
\ocwindent{8.00em}
$[~\ocwupperid{Active}~\rightarrow{}~$\ocwstring{"Active"}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{Middle}~\rightarrow{}~$\ocwstring{"Middle"}\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{Passive}~\rightarrow{}~$\ocwstring{"Passive"}\ocweol
\ocwindent{8.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{6.00em}
$\ocwlowerid{span3\_center}~\ocwlowerid{wvoice}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Paraphrase.mli}
\ocwinterface{Paraphrase}
\label{paraphrase.mli:0}%
English paraphrase of semantic analysis 
\ocweol
\label{paraphrase.mli:699}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_sem}~:~$\ocwbt{string}~$\rightarrow{}~\ocwupperid{Morphology.}\ocwlowerid{inflexion\_tag}~\rightarrow{}~$\ocwbt{unit};\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_role}~:~(($\ocwbt{int}~$\times{}~$\ocwbt{int}~$\times{}~$\ocwbt{int}$)~\times{}~\ocwupperid{Constraints.}\ocwlowerid{pos})~\rightarrow{}~$\ocwbt{unit};\ocweol
\ocwendcode{}\typeout{OcamlWeb file Paraphrase.ml}
\ocwmodule{Paraphrase}
\label{paraphrase.ml:0}%
English paraphrase of semantic analysis 
\ocweol
\ocwindent{0.00em}
Deprecated 
\ocweol
\label{paraphrase.ml:719}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Constraints};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{val\_of\_voice}~\ocwlowerid{regime}~\ocwlowerid{root\_regime}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};~$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps pl etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{inflexions}$\ocwenddcode{} \ocwec{}\medskip

\label{paraphrase.ml:869}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{imperative\_paraphrase}~\ocwlowerid{pers}~\ocwlowerid{num}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{pers}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{First}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{num}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Singular}~\rightarrow{}~$\ocwstring{"Let\ocwvspace{}me\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Dual}~\rightarrow{}~$\ocwstring{"Let\ocwvspace{}us\ocwvspace{}two\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Plural}~\rightarrow{}~$\ocwstring{"Let\ocwvspace{}us\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Second}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{num}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Singular}~\rightarrow{}~$\ocwstring{"Thou\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Dual}~\rightarrow{}~$\ocwstring{"You\ocwvspace{}two\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Plural}~\rightarrow{}~$\ocwstring{"You\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Third}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{num}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Singular}~\rightarrow{}~$\ocwstring{"Let\ocwvspace{}it\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Dual}~\rightarrow{}~$\ocwstring{"Let\ocwvspace{}them\ocwvspace{}two\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Plural}~\rightarrow{}~$\ocwstring{"Let\ocwvspace{}them\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{subject\_paraphrase}~\ocwlowerid{pers}~\ocwlowerid{num}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{pers}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{First}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{num}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Singular}~\rightarrow{}~$\ocwstring{"I\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Dual}~\rightarrow{}~$\ocwstring{"Both\ocwvspace{}of\ocwvspace{}us\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Plural}~\rightarrow{}~$\ocwstring{"We\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Second}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{num}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Singular}~\rightarrow{}~$\ocwstring{"Thou\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Dual}~\rightarrow{}~$\ocwstring{"Both\ocwvspace{}of\ocwvspace{}you\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Plural}~\rightarrow{}~$\ocwstring{"You\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Third}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{num}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Singular}~\rightarrow{}~$\ocwstring{"It\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Dual}~\rightarrow{}~$\ocwstring{"Both\ocwvspace{}of\ocwvspace{}them\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Plural}~\rightarrow{}~$\ocwstring{"All\ocwvspace{}of\ocwvspace{}them\ocwvspace{}"}\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Unknown}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{reg\_stem}~=~$\ocwkw{fun}~\ocwbc{} regular english verbs paraphrase \ocwec{}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"k.lp"}~$\rightarrow{}~$\ocwstring{"effect"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"krii.d"}~$\rightarrow{}~$\ocwstring{"play"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"tan\#1"}~$\rightarrow{}~$\ocwstring{"stretch"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"tap"}~$\rightarrow{}~$\ocwstring{"suffer"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"tyaj"}~$\rightarrow{}~$\ocwstring{"abandon"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"dhaav\#2"}~$\rightarrow{}~$\ocwstring{"clean"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"nind"}~$\rightarrow{}~$\ocwstring{"blame"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"pac"}~$\rightarrow{}~$\ocwstring{"cook"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"pa.th"}~$\rightarrow{}~$\ocwstring{"learn"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"paa\#2"}~$\rightarrow{}~$\ocwstring{"protect"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"pi\#2"}~$\rightarrow{}~$\ocwstring{"increase"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"praz"}~$\rightarrow{}~$\ocwstring{"ask"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"tarj"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"bharts"}~$\rightarrow{}~$\ocwstring{"threaten"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"bruu"}~$\rightarrow{}~$\ocwstring{"say"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"bhii\#1"}~$\rightarrow{}~$\ocwstring{"fear"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"ruc\#1"}~$\rightarrow{}~$\ocwstring{"please"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"labh"}~$\rightarrow{}~$\ocwstring{"obtain"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"lal"}~$\rightarrow{}~$\ocwstring{"fondle"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"v.rt\#1"}~$\rightarrow{}~$\ocwstring{"exist"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"v.r.s"}~$\rightarrow{}~$\ocwstring{"rain"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"sp.rz\#1"}~$\rightarrow{}~$\ocwstring{"touch"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"svid\#2"}~$\rightarrow{}~$\ocwstring{"sweat"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~\ocwupperid{Unknown}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{paraphrase}~=~$\ocwkw{fun}~\ocwbc{} returns pair (present stem, past participle) \ocwec{}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"at"}~$\mid{}~$\ocwstring{"i"}~$\mid{}~$\ocwstring{"gam"}~$\mid{}~$\ocwstring{"gaa\#1"}~$\mid{}~$\ocwstring{"car"}~$\rightarrow{}~($\ocwstring{"go"},\ocwstring{"gone"}$)~$\ocwbc{} irregular verbs \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"as\#1"}~$\rightarrow{}~($\ocwstring{"i"},\ocwstring{""}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"aas\#2"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"viz\#1"}~$\rightarrow{}~($\ocwstring{"sit"},\ocwstring{"seated"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"kath"}~$\rightarrow{}~($\ocwstring{"tell"},\ocwstring{"told"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"j\~{}naa\#1"}~$\rightarrow{}~($\ocwstring{"know"},\ocwstring{"known"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"ta.d"}~$\rightarrow{}~($\ocwstring{"beat"},\ocwstring{"beaten"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"daa\#1"}~$\rightarrow{}~($\ocwstring{"give"},\ocwstring{"given"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"dhaav\#1"}~$\rightarrow{}~($\ocwstring{"run"},\ocwstring{"chased"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"dh.r"}~$\rightarrow{}~($\ocwstring{"hold"},\ocwstring{"held"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"nii\#1"}~$\rightarrow{}~($\ocwstring{"lead"},\ocwstring{"led"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"paz"}~$\rightarrow{}~($\ocwstring{"see"},\ocwstring{"seen"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"paa\#1"}~$\rightarrow{}~($\ocwstring{"drink"},\ocwstring{"drunk"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"bhuj\#2"}~$\rightarrow{}~($\ocwstring{"eat"},\ocwstring{"eaten"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"bhuu\#1"}~$\rightarrow{}~($\ocwstring{"become"},\ocwstring{"become"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"m.r"}~$\rightarrow{}~($\ocwstring{"die"},\ocwstring{"dead"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"likh"}~$\rightarrow{}~($\ocwstring{"write"},\ocwstring{"written"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"vac"}~$\rightarrow{}~($\ocwstring{"speak"},\ocwstring{"spoken"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"vah\#1"}~$\rightarrow{}~($\ocwstring{"carry"},\ocwstring{"carried"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"vid\#1"}~$\rightarrow{}~($\ocwstring{"know"},\ocwstring{"known"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"vid\#2"}~$\rightarrow{}~($\ocwstring{"find"},\ocwstring{"found"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"v.rdh\#1"}~$\rightarrow{}~($\ocwstring{"grow"},\ocwstring{"grown"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"vyadh"}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"han"}~$\rightarrow{}~($\ocwstring{"hit"},\ocwstring{"hurt"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"zru"}~$\rightarrow{}~($\ocwstring{"hear"},\ocwstring{"heard"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"suu\#1"}~$\rightarrow{}~($\ocwstring{"impel"},\ocwstring{"impelled"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"sthaa\#1"}~$\rightarrow{}~($\ocwstring{"stand"},\ocwstring{"stood"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"svap"}~$\rightarrow{}~($\ocwstring{"sleep"},\ocwstring{"asleep"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{e}~\rightarrow{}~$\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{regular}~=~\ocwlowerid{reg\_stem}~\ocwlowerid{e}~$\ocwkw{in}\ocweol
\ocwindent{6.50em}
$(\ocwlowerid{regular},~\ocwlowerid{regular}~$\^{}~\ocwstring{"ed"}$)$\ocweol
\ocwindent{4.50em}
\ocwkw{with}~$[~\ocwupperid{Unknown}~\rightarrow{}~($\ocwstring{"do"},\ocwstring{"done"}$)~$\ocwbc{} default \ocwec{}~$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_gender}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Mas}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"[M]"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"[N]"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Fem}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"[F]"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Deictic}~\ocwlowerid{d}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{d}~$\ocwkw{with}\ocweol
\ocwindent{2.50em}
$[~\ocwupperid{Speaker}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"[Speaker]"}~\ocwbc{} First person \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Listener}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"[Listener]"}~\ocwbc{} Second person \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Self}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"[Self]"}~\ocwbc{} reflexive subject \ocwec{}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Numeral}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"[Num]"}~\ocwbc{} number \ocwec{}\ocweol
\ocwindent{2.50em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_number}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Singular}~\rightarrow{}~()~\mid{}~\ocwupperid{Dual}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"(2)"}~$\mid{}~\ocwupperid{Plural}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"s"}~$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_case}~=~$\ocwkw{fun}~\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Nom}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"Subject"}~\ocwbc{} Actor/Agent \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Acc}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"Object"}~\ocwbc{} Goal \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Voc}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"O"}~\ocwbc{} Invocation \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Ins}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"by"}~\ocwbc{} Agent/Instrument \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Dat}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"to"}~\ocwbc{} Destination \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Abl}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"from"}~\ocwbc{} Origin \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Gen}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"of"}~\ocwbc{} Possessor \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Loc}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"in"}~\ocwbc{} Circumstance \ocwec{}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_person}~=~$\ocwkw{fun}~\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{First}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"I"}~\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Second}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"You"}~\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Third}~\rightarrow{}~()$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{genitive}~=~$\ocwkw{fun}~\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Singular}~\rightarrow{}~$\ocwstring{"'s"}~\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Dual}~\rightarrow{}~$\ocwstring{"\ocwvspace{}pair's"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Plural}~\rightarrow{}~$\ocwstring{"s'"}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_noun}~\ocwlowerid{c}~\ocwlowerid{n}~\ocwlowerid{g}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Nom}~\mid{}~\ocwupperid{Acc}~\mid{}~\ocwupperid{Voc}~\rightarrow{}~$\ocwkw{do}~\ocwbc{} direct \ocwec{}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{print\_case}~\ocwlowerid{c}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{print\_number}~\ocwlowerid{n}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{sp}~()$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{print\_gender}~\ocwlowerid{g}$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Gen}~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{print\_gender}~\ocwlowerid{g}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{genitive}~\ocwlowerid{n})~$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{do}~\ocwbc{} oblique \ocwec{}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{print\_case}~\ocwlowerid{c}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{sp}~()$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{print\_gender}~\ocwlowerid{g}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{print\_number}~\ocwlowerid{n}$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{5.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{third\_sg}~\ocwlowerid{act}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{act}~=~$\ocwstring{"do"}~$\lor{}~\ocwlowerid{act}~=~$\ocwstring{"go"}~\ocwkw{then}~\ocwstring{"es"}~\ocwkw{else}~\ocwstring{"s"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_role}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Subject}~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"Subject"}~\ocwbc{} Actor/Agent \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Object}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"Object"}~\ocwbc{} Goal/Patient \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Instrument}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"Agent"}~\ocwbc{} Agent/Instrument \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{copula}~\ocwlowerid{n}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{First}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{n}=\ocwupperid{Singular}~$\ocwkw{then}~\ocwstring{"am"}~\ocwkw{else}~\ocwstring{"are"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Second}~\rightarrow{}~$\ocwstring{"are"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Third}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{n}=\ocwupperid{Singular}~$\ocwkw{then}~\ocwstring{"is"}~\ocwkw{else}~\ocwstring{"are"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_verb}~\ocwlowerid{w}~\ocwlowerid{f}~\ocwlowerid{n}~\ocwlowerid{p}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{aspect},\ocwlowerid{demand},\ocwlowerid{\_})~=~\ocwlowerid{regime}~\ocwlowerid{w}~\ocwlowerid{f}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$(\ocwlowerid{act},\ocwlowerid{pas})~=~\ocwlowerid{paraphrase}~\ocwlowerid{w}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{aspect}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Imperfectif}~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{subject\_paraphrase}~\ocwlowerid{p}~\ocwlowerid{n})$\ocweol
\ocwindent{2.50em}
;~\ocwkw{if}~$\ocwlowerid{w}~=~$\ocwstring{"as\#1"}~\ocwkw{then}~$\ocwlowerid{ps}~(\ocwlowerid{copula}~\ocwlowerid{n}~\ocwlowerid{p})$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~\ocwkw{do}~\ocweol
\ocwindent{5.00em}
\{~\ocwkw{if}~$\ocwlowerid{act}~=~$\ocwstring{"carry"}~\ocwkw{then}~$\ocwlowerid{ps}~$\ocwstring{"carrie"}~\ocwkw{else}~$\ocwlowerid{ps}~\ocwlowerid{act}$\ocweol
\ocwindent{5.00em}
;~\ocwkw{match}~$\ocwlowerid{p}~$\ocwkw{with}\ocweol
\ocwindent{6.00em}
$[~\ocwupperid{First}~\mid{}~\ocwupperid{Second}~\rightarrow{}~()$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Third}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{n}=\ocwupperid{Singular}~$\ocwkw{then}~$\ocwlowerid{ps}~(\ocwlowerid{third\_sg}~\ocwlowerid{act})~$\ocwkw{else}~$()$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{5.00em}
\}\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}"}\ocweol
\ocwindent{2.50em}
;~$\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{print\_role}~\ocwlowerid{demand}$\ocweol
\ocwindent{2.50em}
\}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Perfectif}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{subject\_paraphrase}~\ocwlowerid{p}~\ocwlowerid{n})$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{ps}~(\ocwlowerid{copula}~\ocwlowerid{n}~\ocwlowerid{p})$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}"}\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{ps}~\ocwlowerid{pas}$\ocweol
\ocwindent{2.50em}
\}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Impersonal}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{ps}~\ocwlowerid{act}$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{ps}~(\ocwlowerid{third\_sg}~\ocwlowerid{act})$\ocweol
\ocwindent{2.50em}
\}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Statif}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{ps}~$\ocwstring{"It\ocwvspace{}"}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{act}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{third\_sg}~\ocwlowerid{act})$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_abs}~\ocwlowerid{entry}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{root\_regime}~\ocwlowerid{entry}~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Intransitive}~\mid{}~\ocwupperid{Factitive}~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"Object"}\ocweol
\ocwindent{1.00em}
$]~$\ocwbc{} conjugation \ocwbegindcode{}$\ocwlowerid{c}$\ocwenddcode{} ignored at this stage \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Translation Sanskrit -> English of tool words \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{translate\_tool}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"ca"}~$\rightarrow{}~$\ocwstring{"and"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"vaa"}~$\rightarrow{}~$\ocwstring{"or"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"saha"}~$\rightarrow{}~$\ocwstring{"with"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"iva"}~$\rightarrow{}~$\ocwstring{"indeed"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"iti"}~$\rightarrow{}~$\ocwstring{"even"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"eva"}~$\rightarrow{}~$\ocwstring{"so"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"naaman"}~$\rightarrow{}~$\ocwstring{"by\ocwvspace{}name"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"yathaa"}~$\rightarrow{}~$\ocwstring{"if"}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"tathaa"}~$\rightarrow{}~$\ocwstring{"then"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{x}~\rightarrow{}~\ocwlowerid{x}~$\ocwbc{} keep stem \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_verbal}~\ocwlowerid{\_}~=~\ocwlowerid{ps}~$\ocwstring{"(Participial)\ocwvspace{}"}~\ocwbc{} TODO \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Adapted from \ocwbegindcode{}$\ocwupperid{Morpho}.\ocwlowerid{print\_morph}$\ocwenddcode{} with extra string argument \ocwbegindcode{}$\ocwlowerid{w}$\ocwenddcode{} for lexeme.
   Called from \ocwbegindcode{}$\ocwupperid{Parser}.\ocwlowerid{print\_roles}$\ocwenddcode{}. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_sem}~\ocwlowerid{w}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Noun\_form}~\ocwlowerid{g}~\ocwlowerid{n}~\ocwlowerid{c}~\rightarrow{}~\ocwlowerid{print\_noun}~\ocwlowerid{c}~\ocwlowerid{n}~\ocwlowerid{g}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Part\_form}~\ocwlowerid{v}~\ocwlowerid{g}~\ocwlowerid{n}~\ocwlowerid{c}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{print\_verbal}~\ocwlowerid{v};~\ocwlowerid{print\_noun}~\ocwlowerid{c}~\ocwlowerid{n}~\ocwlowerid{g}~\}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Verb\_form}~\ocwlowerid{f}~\ocwlowerid{n}~\ocwlowerid{p}~\rightarrow{}~\ocwlowerid{print\_verb}~\ocwlowerid{w}~\ocwlowerid{f}~\ocwlowerid{n}~\ocwlowerid{p}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Abs\_root}~\ocwlowerid{\_}~\mid{}~\ocwupperid{Ind\_form}~\ocwupperid{Abs}~\rightarrow{}~\ocwlowerid{print\_abs}~\ocwlowerid{w}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind\_form}~\ocwupperid{Adv}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"Adverb"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind\_form}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{ps}~(\ocwlowerid{translate\_tool}~\ocwlowerid{w})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Bare\_stem}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"Compound"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Auxi\_form}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"Composed"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{subj\_of}~\ocwlowerid{p}~\ocwlowerid{n}~=~$\ocwkw{match}~$\ocwlowerid{p}~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{First}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{n}~$\ocwkw{with}~\ocweol
\ocwindent{7.00em}
$[~\ocwupperid{Singular}~\rightarrow{}~$\ocwstring{"I"}~$\mid{}~\ocwupperid{Dual}~\rightarrow{}~$\ocwstring{"Us\ocwvspace{}two"}~$\mid{}~\ocwupperid{Plural}~\rightarrow{}~$\ocwstring{"Us"}~$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Second}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{n}~$\ocwkw{with}~\ocweol
\ocwindent{7.00em}
$[~\ocwupperid{Singular}~\rightarrow{}~$\ocwstring{"Thou"}~$\mid{}~\ocwupperid{Dual}~\rightarrow{}~$\ocwstring{"You\ocwvspace{}two"}~$\mid{}~\ocwupperid{Plural}~\rightarrow{}~$\ocwstring{"You"}~$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Third}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{n}~$\ocwkw{with}~\ocweol
\ocwindent{7.00em}
$[~\ocwupperid{Singular}~\rightarrow{}~$\ocwstring{"It"}~$\mid{}~\ocwupperid{Dual}~\rightarrow{}~$\ocwstring{"Both"}~$\mid{}~\ocwupperid{Plural}~\rightarrow{}~$\ocwstring{"They"}~$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_noun\_role}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Subject}~\ocwlowerid{p}~\ocwlowerid{n}~\rightarrow{}~\ocwlowerid{ps}~(\ocwlowerid{subj\_of}~\ocwlowerid{p}~\ocwlowerid{n})$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Object}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"Obj"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Instrument}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"Agt"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Destination}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"Dst"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Origin}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"Org"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Possessor}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"Pos"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Circumstance}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"Cir"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_neg\_noun\_role}~\ocwlowerid{k}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~$\ocwstring{"\symbol{45}"};~$\ocwlowerid{print\_noun\_role}~\ocwlowerid{k};~\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}"}~\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_role}~((\ocwlowerid{seg},\ocwlowerid{sub},\ocwlowerid{ind}),\ocwlowerid{role})~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{html\_red}~(\ocwlowerid{string\_of\_int}~\ocwlowerid{seg}~$\^{}~\ocwstring{"."}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{sub}$\ocweol
\ocwindent{9.00em}
\^{}~\ocwstring{"."}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{ind}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{html\_green}~$\ocwstring{"\ocwvspace{}["}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{span\_begin}~\ocwupperid{Latin12})~$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{role}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Process}~\ocwlowerid{noun\_roles}~\ocwlowerid{\_}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Subprocess}~\ocwlowerid{noun\_roles}~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{print\_neg\_noun\_role}~\ocwlowerid{noun\_roles}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Actor}~\ocwlowerid{noun\_role}~\ocwlowerid{gender}~\ocwlowerid{number}~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{print\_noun\_role}~\ocwlowerid{noun\_role}$\ocweol
\ocwindent{4.00em}
;~\ocwkw{match}~$\ocwlowerid{noun\_role}~$\ocwkw{with}~$[~\ocwupperid{Subject}~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~()~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{print\_number}~\ocwlowerid{number}~]$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{print\_gender}~\ocwlowerid{gender}$\ocweol
\ocwindent{4.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Tool}~\ocwupperid{Coordination}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}\&\ocwvspace{}"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Tool}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}T\ocwvspace{}"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Number}~\ocwlowerid{\_}~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}N\ocwvspace{}"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Addressee}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}V\ocwvspace{}"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Compound}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}C\ocwvspace{}"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Ignored}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}\_\ocwvspace{}"}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{span\_end}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{html\_green}~$\ocwstring{"]\ocwvspace{}"}$)$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Bank_lexer.ml}
\ocwmodule{Bank\_lexer}
\label{bank_lexer.ml:0}%
A simple lexer recognizing idents formed from ASCII letters and integers 
   and skipping spaces and comments between % and eol. 
   Used by \ocwbegindcode{}$\ocwupperid{Parse\_tree}$\ocwenddcode{} and \ocwbegindcode{}$\ocwupperid{Reader}$\ocwenddcode{}. 
\ocweol
\label{bank_lexer.ml:794}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Bank\_lexer}~=~$\ocwkw{struct}\medskip

\label{bank_lexer.ml:822}%
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Camlp4.PreCast};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Format};$\medskip

\label{bank_lexer.ml:857}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Loc}~=~\ocwupperid{Loc}~$\ocwbc{} Using the PreCast Loc \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Error}~=~$\ocwkw{struct}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}~=~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwkw{exception}~$\ocwupperid{E}~$\ocwkw{of}~$\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{to\_string}~\ocwlowerid{x}~=~\ocwlowerid{x}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{print}~=~\ocwupperid{Format.}\ocwlowerid{pp\_print\_string}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Token}~=~$\ocwkw{struct}\ocweol
\ocwindent{1.00em}
\ocwkw{module}~$\ocwupperid{Loc}~=~\ocwupperid{Loc}$\ocweol
\ocwindent{1.00em}
;~\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}~=$\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{KEYWORD}~$\ocwkw{of}~\ocwbt{string}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{IDENT}~$\ocwkw{of}~\ocwbt{string}~\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{TEXT}~$\ocwkw{of}~\ocwbt{string}~\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{INT}~$\ocwkw{of}~\ocwbt{int}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{INTS}~$\ocwkw{of}~\ocwbt{int}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{EOI}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwkw{module}~$\ocwupperid{Error}~=~\ocwupperid{Error}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwkw{module}~$\ocwupperid{Filter}~=~$\ocwkw{struct}\ocweol
\ocwindent{2.00em}
\ocwkw{type}~$\ocwlowerid{token\_filter}~=~\ocwupperid{Camlp4.Sig.}\ocwlowerid{stream\_filter}~\ocwlowerid{t}~\ocwupperid{Loc.}\ocwlowerid{t}$\ocweol
\ocwindent{2.00em}
;\ocweol
\ocwindent{2.00em}
\ocwkw{type}~$\ocwlowerid{t}~=~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{bool}\ocweol
\ocwindent{2.00em}
;\ocweol
\ocwindent{2.00em}
$\ocwlowerid{value}~\ocwlowerid{mk}~\ocwlowerid{is\_kwd}~=~\ocwlowerid{is\_kwd}$\ocweol
\ocwindent{2.00em}
;\ocweol
\ocwindent{2.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{filter}~\ocwlowerid{is\_kwd}~=~$\ocwkw{parser}\ocweol
\ocwindent{4.00em}
$[~[:~`((\ocwupperid{KEYWORD}~\ocwlowerid{s},~\ocwlowerid{loc})~$\ocwkw{as}~$\ocwlowerid{p});~\ocwlowerid{strm}~:]~\rightarrow{}~[:~`\ocwlowerid{p};~\ocwlowerid{filter}~\ocwlowerid{is\_kwd}~\ocwlowerid{strm}~:]$\ocweol
\ocwindent{0.00em}
\ocwbc{} PB        \ocwbegindcode{}\ocwkw{if}~$\ocwlowerid{is\_kwd}~\ocwlowerid{s}~$\ocwkw{then}~[:~`$\ocwlowerid{p};~\ocwlowerid{filter}~\ocwlowerid{is\_kwd}~\ocwlowerid{strm}~:]
~$\ocwkw{else}~$\ocwlowerid{failwith}~($\ocwstring{"Undefined\ocwvspace{}token:\ocwvspace{}"}~\^{}~$\ocwlowerid{s})$\ocwenddcode{}      \ocwec{}\ocweol
\ocwindent{4.00em}
$\mid{}~[:~`\ocwlowerid{x};~\ocwlowerid{s}~:]~\rightarrow{}~[:~`\ocwlowerid{x};~\ocwlowerid{filter}~\ocwlowerid{is\_kwd}~\ocwlowerid{s}~:]$\ocweol
\ocwindent{4.00em}
$\mid{}~[:~:]~\rightarrow{}~[:~:]~$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{2.00em}
;\ocweol
\ocwindent{2.00em}
$\ocwlowerid{value}~\ocwlowerid{define\_filter}~\ocwlowerid{\_}~\ocwlowerid{\_}~=~()$\ocweol
\ocwindent{2.00em}
;\ocweol
\ocwindent{2.00em}
$\ocwlowerid{value}~\ocwlowerid{keyword\_added}~\ocwlowerid{\_}~\ocwlowerid{\_}~\ocwlowerid{\_}~=~()$\ocweol
\ocwindent{2.00em}
;\ocweol
\ocwindent{2.00em}
$\ocwlowerid{value}~\ocwlowerid{keyword\_removed}~\ocwlowerid{\_}~\ocwlowerid{\_}~=~()$\ocweol
\ocwindent{2.00em}
;\ocweol
\ocwindent{2.00em}
\ocwkw{end}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{to\_string}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{KEYWORD}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{sprintf}~$\ocwstring{"KEYWORD\ocwvspace{}\%S"}~$\ocwlowerid{s}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{IDENT}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{sprintf}~$\ocwstring{"IDENT\ocwvspace{}\%S"}~$\ocwlowerid{s}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{TEXT}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{sprintf}~$\ocwstring{"TEXT\ocwvspace{}\%S"}~$\ocwlowerid{s}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{INT}~\ocwlowerid{i}~\rightarrow{}~\ocwlowerid{sprintf}~$\ocwstring{"INT\ocwvspace{}\%d"}~$\ocwlowerid{i}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{INTS}~\ocwlowerid{i}~\rightarrow{}~\ocwlowerid{sprintf}~$\ocwstring{"INTS\ocwvspace{}\%d"}~$\ocwlowerid{i}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{EOI}~\rightarrow{}~$\ocwstring{"EOI"}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{print}~\ocwlowerid{ppf}~\ocwlowerid{x}~=~\ocwlowerid{pp\_print\_string}~\ocwlowerid{ppf}~(\ocwlowerid{to\_string}~\ocwlowerid{x})$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{match\_keyword}~\ocwlowerid{kwd}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{KEYWORD}~\ocwlowerid{kwd'}~\rightarrow{}~\ocwlowerid{kwd'}~=~\ocwlowerid{kwd}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{extract\_string}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{INT}~\ocwlowerid{i}~\rightarrow{}~\ocwlowerid{string\_of\_int}~\ocwlowerid{i}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{INTS}~\ocwlowerid{i}~\rightarrow{}~\ocwlowerid{string\_of\_int}~\ocwlowerid{i}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{IDENT}~\ocwlowerid{s}~\mid{}~\ocwupperid{KEYWORD}~\ocwlowerid{s}~\mid{}~\ocwupperid{TEXT}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{s}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{EOI}~\rightarrow{}~$\ocwstring{""}~\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\medskip

\label{bank_lexer.ml:2437}%
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Token}$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
The string buffering machinery - ddr + np 
\ocweol
\label{bank_lexer.ml:2499}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{store}~\ocwlowerid{buf}~\ocwlowerid{c}~=~$\ocwkw{do}~\{~$\ocwupperid{Buffer.}\ocwlowerid{add\_char}~\ocwlowerid{buf}~\ocwlowerid{c};~\ocwlowerid{buf}~\}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{base\_number}~\ocwlowerid{len}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{parser}\ocweol
\ocwindent{1.00em}
$[~[:~\ocwlowerid{a}~=~\ocwlowerid{number}~\ocwlowerid{len}~:]~\rightarrow{}~\ocwlowerid{a}~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{number}~\ocwlowerid{buf}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{parser}\ocweol
\ocwindent{1.00em}
$[~[:~`(\verb!'0'!..\verb!'9'!~$\ocwkw{as}~$\ocwlowerid{c});~\ocwlowerid{s}~:]~\rightarrow{}~\ocwlowerid{number}~(\ocwlowerid{store}~\ocwlowerid{buf}~\ocwlowerid{c})~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~[:~:]~\rightarrow{}~\ocwupperid{Buffer.}\ocwlowerid{contents}~\ocwlowerid{buf}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{skip\_to\_eol}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{parser}\ocweol
\ocwindent{1.00em}
$[~[:~`\verb!'\n'!~\mid{}~\verb!'\026'!~\mid{}~\verb!'\012'!;~\ocwlowerid{s}~:]~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$\mid{}~[:~`\ocwlowerid{c}~;~\ocwlowerid{s}~:]~\rightarrow{}~\ocwlowerid{skip\_to\_eol}~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ident\_char}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{parser}\ocweol
\ocwindent{1.00em}
$[~[:~`(\verb!'a'!..\verb!'z'!~\mid{}~\verb!'A'!..\verb!'Z'!~\mid{}~\verb!'.'!~\mid{}~\verb!':'!~\mid{}~\verb!'"'!~\mid{}~\verb!'~'!~\mid{}~\verb!'\''!~$\ocwkw{as}~$\ocwlowerid{c})~:]~$\ocweol
\ocwindent{2.50em}
$\rightarrow{}~\ocwlowerid{c}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{ident2}~\ocwlowerid{buff}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{parser}\ocweol
\ocwindent{1.00em}
$[~[:~\ocwlowerid{c}~=~\ocwlowerid{ident\_char};~\ocwlowerid{s}~:]~\rightarrow{}~\ocwlowerid{ident2}~(\ocwlowerid{store}~\ocwlowerid{buff}~\ocwlowerid{c})~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~[:~`(\verb!'0'!..\verb!'9'!~$\ocwkw{as}~$\ocwlowerid{c});~\ocwlowerid{s}~:]~\rightarrow{}~\ocwlowerid{ident2}~(\ocwlowerid{store}~\ocwlowerid{buff}~\ocwlowerid{c})~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~[:~:]~\rightarrow{}~\ocwupperid{Buffer.}\ocwlowerid{contents}~\ocwlowerid{buff}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{text}~\ocwlowerid{buff}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{parser}\ocweol
\ocwindent{1.00em}
$[~[:~`\verb!'}'!~:]~\rightarrow{}~\ocwupperid{Buffer.}\ocwlowerid{contents}~\ocwlowerid{buff}$\ocweol
\ocwindent{1.00em}
$\mid{}~[:~`\verb!'{'!;~\ocwlowerid{buff}~=~\ocwlowerid{text\_buff}~(\ocwlowerid{store}~\ocwlowerid{buff}~\verb!'{'!);~\ocwlowerid{s}~:]~\rightarrow{}~$\ocweol
\ocwindent{9.50em}
$\ocwlowerid{text}~(\ocwlowerid{store}~\ocwlowerid{buff}~\verb!'}'!)~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~[:~`\ocwlowerid{c};~\ocwlowerid{s}~:]~\rightarrow{}~\ocwlowerid{text}~(\ocwlowerid{store}~\ocwlowerid{buff}~\ocwlowerid{c})~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{text\_buff}~\ocwlowerid{buff}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{parser}\ocweol
\ocwindent{1.00em}
$[~[:~`\verb!'}'!~:]~\rightarrow{}~\ocwlowerid{buff}$\ocweol
\ocwindent{1.00em}
$\mid{}~[:~`\verb!'{'!;~\ocwlowerid{buff}~=~\ocwlowerid{text\_buff}~(\ocwlowerid{store}~\ocwlowerid{buff}~\verb!'{'!);~\ocwlowerid{s}~:]~\rightarrow{}~$\ocweol
\ocwindent{9.50em}
$\ocwlowerid{text\_buff}~(\ocwlowerid{store}~\ocwlowerid{buff}~\verb!'}'!)~\ocwlowerid{s}$\ocweol
\ocwindent{1.00em}
$\mid{}~[:~`\ocwlowerid{c};~\ocwlowerid{s}~:]~\rightarrow{}~\ocwlowerid{text\_buff}~(\ocwlowerid{store}~\ocwlowerid{buff}~\ocwlowerid{c})~\ocwlowerid{s}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{next\_token\_fun}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{next\_token}~\ocwlowerid{buff}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{parser}~$\ocwlowerid{\_bp}$\ocweol
\ocwindent{2.00em}
$[~[:~`\verb!'{'!;~\ocwlowerid{t}~=~\ocwlowerid{text}~\ocwlowerid{buff}~:]~\rightarrow{}~\ocwupperid{TEXT}~\ocwlowerid{t}$\ocweol
\ocwindent{2.00em}
$\mid{}~[:~`(\verb!'1'!..\verb!'9'!~$\ocwkw{as}~$\ocwlowerid{c});~\ocwlowerid{s}~=~\ocwlowerid{number}~(\ocwlowerid{store}~\ocwlowerid{buff}~\ocwlowerid{c})~:]~\rightarrow{}~\ocwupperid{INT}~(\ocwlowerid{int\_of\_string}~\ocwlowerid{s})$\ocweol
\ocwindent{2.00em}
$\mid{}~[:~`\verb!'0'!;~\ocwlowerid{s}~=~\ocwlowerid{base\_number}~(\ocwlowerid{store}~\ocwlowerid{buff}~\verb!'0'!)~:]~\rightarrow{}~\ocwupperid{INT}~(\ocwlowerid{int\_of\_string}~\ocwlowerid{s})$\ocweol
\ocwindent{2.00em}
$\mid{}~[:~\ocwlowerid{c}~=~\ocwlowerid{ident\_char};~\ocwlowerid{s}~=~\ocwlowerid{ident2}~(\ocwlowerid{store}~\ocwlowerid{buff}~\ocwlowerid{c})~:]~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{s}~=~$\ocwstring{"Comment"}~\ocwkw{then}~$\ocwupperid{KEYWORD}~$\ocwstring{"Comment"}~\ocwkw{else}~\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{s}~=~$\ocwstring{"Example"}~\ocwkw{then}~$\ocwupperid{KEYWORD}~$\ocwstring{"Example"}~\ocwkw{else}\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{s}~=~$\ocwstring{"Continue"}~\ocwkw{then}~$\ocwupperid{KEYWORD}~$\ocwstring{"Continue"}~\ocwkw{else}\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{s}~=~$\ocwstring{"Source"}~\ocwkw{then}~$\ocwupperid{KEYWORD}~$\ocwstring{"Source"}~\ocwkw{else}~\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{s}~=~$\ocwstring{"Parse"}~\ocwkw{then}~$\ocwupperid{KEYWORD}~$\ocwstring{"Parse"}~\ocwkw{else}~\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{s}~=~$\ocwstring{"Gloss"}~\ocwkw{then}~$\ocwupperid{KEYWORD}~$\ocwstring{"Gloss"}~\ocwkw{else}~$\ocwupperid{IDENT}~\ocwlowerid{s}$\ocweol
\ocwindent{2.00em}
$\mid{}~[:~`\ocwlowerid{c}~:]~\ocwlowerid{\_ep}~\rightarrow{}~\ocwupperid{KEYWORD}~(\ocwupperid{String.}\ocwlowerid{make}~1~\ocwlowerid{c})$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{next\_token\_loc}~=$\ocweol
\ocwindent{3.00em}
\ocwkw{parser}~$\ocwlowerid{bp}$\ocweol
\ocwindent{3.00em}
$[~[:~`\verb!'%'!~;~\ocwlowerid{\_}~=~\ocwlowerid{skip\_to\_eol};~\ocwlowerid{s}~:]~\rightarrow{}~\ocwlowerid{next\_token\_loc}~\ocwlowerid{s}$\ocweol
\ocwindent{3.00em}
$\mid{}~[:~`\verb!' '!~\mid{}~\verb!'\n'!~\mid{}~\verb!'\r'!~\mid{}~\verb!'\t'!~\mid{}~\verb!'\026'!~\mid{}~\verb!'\012'!;~\ocwlowerid{s}~:]~\rightarrow{}~\ocwlowerid{next\_token\_loc}~\ocwlowerid{s}$\ocweol
\ocwindent{3.00em}
$\mid{}~[:~`\verb!'^'!~;~\ocwlowerid{s}~:]~\rightarrow{}~$\ocwkw{let}~$(\ocwlowerid{tok},\ocwlowerid{loc})~=~\ocwlowerid{next\_token\_loc}~\ocwlowerid{s}~$\ocwkw{in}\ocweol
\ocwindent{13.00em}
\ocwkw{match}~$\ocwlowerid{tok}~$\ocwkw{with}~$[~\ocwupperid{INT}~\ocwlowerid{n}~\rightarrow{}~(\ocwupperid{INTS}~\ocwlowerid{n},\ocwlowerid{loc})$\ocweol
\ocwindent{20.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Token.Error.E}~$\ocwstring{"+n"}$)$\ocweol
\ocwindent{20.50em}
$]~$\ocwbc{} for Gillon's dislocated phrases \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[:~`\verb|'!'|~;~\ocwlowerid{s}~:]~\rightarrow{}~$\ocwkw{let}~$(\ocwlowerid{tok},\ocwlowerid{loc})~=~\ocwlowerid{next\_token\_loc}~\ocwlowerid{s}~$\ocwkw{in}\ocweol
\ocwindent{13.00em}
\ocwkw{match}~$\ocwlowerid{tok}~$\ocwkw{with}~$[~\ocwupperid{INT}~\ocwlowerid{n}~\rightarrow{}~(\ocwupperid{INTS}~(-\ocwlowerid{n}),\ocwlowerid{loc})$\ocweol
\ocwindent{20.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Token.Error.E}~$\ocwstring{"\symbol{45}n"}$)$\ocweol
\ocwindent{20.50em}
$]~$\ocwbc{} for Gillon's dislocation context \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[:~\ocwlowerid{tok}~=~\ocwlowerid{next\_token}~(\ocwupperid{Buffer.}\ocwlowerid{create}~80)~:]~\ocwlowerid{ep}~\rightarrow{}~(\ocwlowerid{tok},~(\ocwlowerid{bp},~\ocwlowerid{ep}))$\ocweol
\ocwindent{3.00em}
$\mid{}~[:~\ocwlowerid{\_}~=~\ocwupperid{Stream.}\ocwlowerid{empty}~:]~\rightarrow{}~(\ocwupperid{EOI},~(\ocwlowerid{bp},~\ocwlowerid{succ}~\ocwlowerid{bp}))~$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{next\_token\_loc}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{mk}~()~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{err}~\ocwlowerid{loc}~\ocwlowerid{msg}~=~\ocwupperid{Loc.}\ocwlowerid{raise}~\ocwlowerid{loc}~(\ocwupperid{Token.Error.E}~\ocwlowerid{msg})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{fun}~$\ocwlowerid{init\_loc}~\ocwlowerid{cstrm}~\rightarrow{}~\ocwupperid{Stream.}\ocwlowerid{from}~\ocwlowerid{lexer}$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~\ocwlowerid{lexer}~\ocwlowerid{\_}~=~$\ocweol
\ocwindent{2.00em}
\ocwkw{try}~\ocwkw{let}~$(\ocwlowerid{tok},~(\ocwlowerid{bp},~\ocwlowerid{ep}))~=~\ocwlowerid{next\_token\_fun}~\ocwlowerid{cstrm}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{loc}~=~\ocwupperid{Loc.}\ocwlowerid{move}~`\ocwlowerid{start}~\ocwlowerid{bp}~(\ocwupperid{Loc.}\ocwlowerid{move}~`\ocwlowerid{stop}~\ocwlowerid{ep}~\ocwlowerid{init\_loc})~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwupperid{Some}~(\ocwlowerid{tok},~\ocwlowerid{loc})$\ocweol
\ocwindent{2.00em}
\ocwkw{with}~$[~\ocwupperid{Stream.Error}~\ocwlowerid{str}~\rightarrow{}$\ocweol
\ocwindent{6.00em}
\ocwkw{let}~$\ocwlowerid{bp}~=~\ocwupperid{Stream.}\ocwlowerid{count}~\ocwlowerid{cstrm}~$\ocwkw{in}\ocweol
\ocwindent{6.00em}
\ocwkw{let}~$\ocwlowerid{loc}~=~\ocwupperid{Loc.}\ocwlowerid{move}~`\ocwlowerid{start}~\ocwlowerid{bp}~(\ocwupperid{Loc.}\ocwlowerid{move}~`\ocwlowerid{stop}~(\ocwlowerid{bp}+1)~\ocwlowerid{init\_loc})~$\ocwkw{in}~\ocweol
\ocwindent{6.00em}
$\ocwlowerid{err}~\ocwlowerid{loc}~\ocwlowerid{str}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end};\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Regression.ml}
\ocwmodule{Regression}
\label{regression.ml:0}%
Regression analysis 
\ocweol
\ocwindent{0.00em}
Reads from stdin a previous regression file.
   For every line, reads in parsing parameters,
   parses with the current reader, prints a new trace file. 
\ocweol
\label{regression.ml:842}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Encode};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{code\_string}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Constraints};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{extract}~\ocwlowerid{truncate\_groups}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Rank};~$\ocwbc{} Lex \ocwbegindcode{}$\ocwlowerid{morpho}~\ocwlowerid{parse\_solution}~\ocwlowerid{parse\_metadata}~\ocwlowerid{complete}$\ocwenddcode{} \ocwec{}\medskip

\label{regression.ml:995}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Prel}~=~$\ocwkw{struct}\ocweol
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{prelude}~()~=~()$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.50em}
\ocwkw{end}~\ocwbc{} Prel \ocwec{}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
TODO : Validate mode ought to store these parameters in metadata line 
\ocweol
\label{regression.ml:1136}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{topic}~=~\ocwupperid{None}$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Adapted from Parser 
\ocweol
\ocwindent{0.00em}
Parsing projections stream in tagging mode 
\ocweol
\label{regression.ml:1233}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Bank\_lexer};~$\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Gram}~=~\ocwupperid{Camlp4.PreCast.MakeGram}~\ocwupperid{Bank\_lexer}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Bank\_lexer.Token}$\ocweol
\ocwindent{0.00em}
;\medskip

\label{regression.ml:1328}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{projs}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"projs"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{lproj}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"lproj"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{proj}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"proj"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{solution}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"solution"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{modec}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"modec"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{modes}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"modes"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{mode\_sent}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"mode\_sent"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{mode\_trans}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"mode\_trans"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{quad}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"quad"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{max\_sol}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"max\_sol"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sentence}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"sentence"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{out\_phases}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"out\_phases"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{out\_phase}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"out\_phase"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{reg\_metadata}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"reg\_metadata"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} A stream of projections is encoded under the form \ocwbegindcode{}1,2$\mid{}2,3|...$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Extends the Parser grammar in specifying the validation format. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwupperid{EXTEND}~\ocwupperid{Gram}$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{projs}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{l}~=~\ocwlowerid{lproj};~`\ocwupperid{EOI}~\rightarrow{}~\ocwlowerid{l}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{lproj}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Wrong\ocwvspace{}projections\ocwvspace{}parsing\symbol{92}n"}\ocweol
\ocwindent{2.00em}
$]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{lproj}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{l}~=~\ocwupperid{LIST0}~\ocwlowerid{proj}~\ocwupperid{SEP}~$\ocwstring{"|"}~$\rightarrow{}~\ocwlowerid{l}~]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{proj}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{n}~=~\ocwupperid{INT};~$\ocwstring{","};~$\ocwlowerid{m}~=~\ocwupperid{INT}~\rightarrow{}~(\ocwlowerid{int\_of\_string}~\ocwlowerid{n},\ocwlowerid{int\_of\_string}~\ocwlowerid{m})~]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{solution}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{mc}~=~\ocwlowerid{modec};~\ocwlowerid{ms}~=~\ocwlowerid{modes};~\ocwlowerid{mst}~=~\ocwlowerid{mode\_sent};~\ocwlowerid{mt}~=~\ocwlowerid{mode\_trans};~\ocwlowerid{s}~=~\ocwlowerid{sentence};~\ocwlowerid{sol}~=~\ocwlowerid{max\_sol};~\ocwlowerid{o}~=~\ocwlowerid{out\_phases}~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
$(\ocwlowerid{mc},\ocwlowerid{ms},\ocwlowerid{mst},\ocwlowerid{mt},\ocwlowerid{s},\ocwlowerid{sol},\ocwlowerid{o})~]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{reg\_metadata}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{v}~=~\ocwlowerid{modec};~\ocwlowerid{f}~=~\ocwlowerid{modes};~\ocwlowerid{n}~=~\ocwlowerid{sentence}~\rightarrow{}~(\ocwlowerid{v},\ocwlowerid{f},\ocwlowerid{n})~]~]~;$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{modec}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"["};~$\ocwlowerid{t}~=~\ocwupperid{TEXT};~$\ocwstring{"]"}~$\rightarrow{}~\ocwlowerid{t}~]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{modes}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"\ensuremath{<}"};~$\ocwlowerid{t}~=~\ocwupperid{TEXT};~$\ocwstring{"\ensuremath{>}"}~$\rightarrow{}~\ocwlowerid{t}~]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{mode\_sent}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"|"};~$\ocwlowerid{t}~=~\ocwupperid{TEXT};~$\ocwstring{"|"}~$\rightarrow{}~\ocwlowerid{t}~]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{mode\_trans}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"\#"};~$\ocwlowerid{t}=\ocwupperid{TEXT};~$\ocwstring{"\#"}~$\rightarrow{}~\ocwlowerid{t}~]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{sentence}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"("};~$\ocwlowerid{t}~=~\ocwupperid{TEXT};~$\ocwstring{")"}~$\rightarrow{}~\ocwlowerid{t}~]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{quad}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"["};~$\ocwlowerid{k}~=~\ocwupperid{INT};~$\ocwstring{","};~$\ocwlowerid{l}~=~\ocwupperid{INT};~$\ocwstring{","};~$\ocwlowerid{m}~=~\ocwupperid{INT};~$\ocwstring{","}~;~$\ocwlowerid{n}~=~\ocwupperid{INT};~$\ocwstring{"]"}~$\rightarrow{}~$\ocweol
\ocwindent{4.00em}
$(\ocwlowerid{int\_of\_string}~\ocwlowerid{k},\ocwlowerid{int\_of\_string}~\ocwlowerid{l},\ocwlowerid{int\_of\_string}~\ocwlowerid{m},\ocwlowerid{int\_of\_string}~\ocwlowerid{n})~]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{max\_sol}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"["};~$\ocwlowerid{k}~=~\ocwupperid{INT};~$\ocwstring{"]"}~$\rightarrow{}~(\ocwlowerid{int\_of\_string}~\ocwlowerid{k})~]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{out\_phases}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{c}~=~\ocwupperid{LIST0}~\ocwlowerid{out\_phase}~\ocwupperid{SEP}~$\ocwstring{"\&"}~$\rightarrow{}~\ocwlowerid{c}~]~];$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{out\_phase}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"\$"};~$\ocwlowerid{t}~=~\ocwupperid{TEXT};~$\ocwstring{"\$"}~$\rightarrow{}~\ocwlowerid{t}~]~];$\ocweol
\ocwindent{0.00em}
$\ocwupperid{END}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{parse\_fail}~\ocwlowerid{s}~\ocwlowerid{loc}~\ocwlowerid{e}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwupperid{Format.}\ocwlowerid{eprintf}~$\ocwstring{"Wrong\ocwvspace{}input:\ocwvspace{}\%s\symbol{92}n,\ocwvspace{}at\ocwvspace{}location\ocwvspace{}\%a:@."}~$\ocwlowerid{s}~\ocwupperid{Loc.}\ocwlowerid{print}~\ocwlowerid{loc}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{raise}~\ocwlowerid{e}$\ocweol
\ocwindent{1.00em}
\}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{parse\_phase}~\ocwlowerid{s}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gram.}\ocwlowerid{parse\_string}~\ocwlowerid{out\_phases}~\ocwupperid{Loc.}\ocwlowerid{ghost}~\ocwlowerid{s}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~\ocwlowerid{e}~\rightarrow{}~\ocwlowerid{parse\_fail}~\ocwlowerid{s}~\ocwlowerid{loc}~\ocwlowerid{e}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{parse\_metadata}~\ocwlowerid{s}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gram.}\ocwlowerid{parse\_string}~\ocwlowerid{reg\_metadata}~\ocwupperid{Loc.}\ocwlowerid{ghost}~\ocwlowerid{s}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~\ocwlowerid{e}~\rightarrow{}~\ocwlowerid{parse\_fail}~\ocwlowerid{s}~\ocwlowerid{loc}~\ocwlowerid{e}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{parse\_proj}~\ocwlowerid{s}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gram.}\ocwlowerid{parse\_string}~\ocwlowerid{projs}~\ocwupperid{Loc.}\ocwlowerid{ghost}~\ocwlowerid{s}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~\ocwlowerid{e}~\rightarrow{}~\ocwlowerid{parse\_fail}~\ocwlowerid{s}~\ocwlowerid{loc}~\ocwlowerid{e}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{parse\_solution}~\ocwlowerid{s}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gram.}\ocwlowerid{parse\_string}~\ocwlowerid{solution}~\ocwupperid{Loc.}\ocwlowerid{ghost}~(\ocwupperid{String.}\ocwlowerid{sub}~\ocwlowerid{s}~0~((\ocwupperid{String.}\ocwlowerid{length}~\ocwlowerid{s})-1))$\ocweol
\ocwindent{1.00em}
\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Loc.Exc\_located}~\ocwlowerid{loc}~\ocwlowerid{e}~\rightarrow{}~\ocwlowerid{parse\_fail}~\ocwlowerid{s}~\ocwlowerid{loc}~\ocwlowerid{e}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{check\_tags}~\ocwlowerid{current\_sol\_string}~\ocwlowerid{tagging}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pos}~=~(\ocwupperid{String.}\ocwlowerid{length}~\ocwlowerid{current\_sol\_string})-1~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{oc}~=~\ocwlowerid{parse\_phase}~(\ocwupperid{String.}\ocwlowerid{sub}~\ocwlowerid{current\_sol\_string}~0~\ocwlowerid{pos})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{oc}~=~\ocwlowerid{tagging}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{look\_up\_tags}~\ocwlowerid{solution}~\ocwlowerid{output}~\ocwlowerid{tagging}~\ocwlowerid{sol}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{proj}~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{extract}~$\ocwstring{""}~$\ocwlowerid{sol}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{p}~=~\ocwlowerid{parse\_proj}~\ocwlowerid{proj}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{current\_sol\_string}~=~$\ocweol
\ocwindent{2.50em}
$\ocwupperid{Lex.}\ocwlowerid{return\_tagging}~(\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{output})~(\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{p})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{check\_tags}~\ocwlowerid{current\_sol\_string}~\ocwlowerid{tagging}~$\ocwkw{then}~$\ocwupperid{Some}~\ocwlowerid{solution}~$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~$\ocwupperid{None}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{search\_bucket}~\ocwlowerid{solution}~\ocwlowerid{output}~\ocwlowerid{tagging}~(\ocwlowerid{p},\ocwlowerid{b\_p})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{watch\_verify}~\ocwlowerid{max}~=~\ocwlowerid{watch\_rec}~0$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{watch\_rec}~\ocwlowerid{n}~=$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{n}=\ocwlowerid{max}~$\ocwkw{then}~$\ocwupperid{None}~$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~\ocwkw{match}~$(\ocwlowerid{look\_up\_tags}~\ocwlowerid{solution}~\ocwlowerid{output}~\ocwlowerid{tagging}~(\ocwupperid{List.}\ocwlowerid{nth}~\ocwlowerid{b\_p}~\ocwlowerid{n}))$\ocweol
\ocwindent{5.50em}
\ocwkw{with}~$[~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{watch\_rec}~(\ocwlowerid{n}+1)$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{s}$\ocweol
\ocwindent{8.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{watch\_verify}~(\ocwupperid{List.}\ocwlowerid{length}~\ocwlowerid{b\_p})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{find\_proj}~\ocwlowerid{solution}~\ocwlowerid{output}~\ocwlowerid{tagging}~\ocwlowerid{sorted\_groups}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{top\_groups},~\ocwlowerid{\_})~=~\ocwlowerid{truncate\_groups}~\ocwlowerid{sorted\_groups}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{watch\_verify}~\ocwlowerid{max}~=~\ocwlowerid{watch\_rec}~0$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{watch\_rec}~\ocwlowerid{n}~=$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{n}=\ocwlowerid{max}~$\ocwkw{then}~$\ocwupperid{None}$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~\ocwkw{let}~$\ocwlowerid{gr}~=~\ocwupperid{List.}\ocwlowerid{nth}~\ocwlowerid{top\_groups}~\ocwlowerid{n}~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
\ocwkw{match}~$\ocwlowerid{search\_bucket}~\ocwlowerid{solution}~\ocwlowerid{output}~\ocwlowerid{tagging}~\ocwlowerid{gr}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{watch\_rec}~(\ocwlowerid{n}+1)$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{s}~$\ocweol
\ocwindent{5.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{watch\_verify}~(\ocwupperid{List.}\ocwlowerid{length}~\ocwlowerid{top\_groups})$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{analyse}~\ocwlowerid{tagging}~(\ocwlowerid{solution},\ocwlowerid{output})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{tagger}~=~\ocwupperid{Lex.}\ocwlowerid{extract\_lemma}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{groups}~=~\ocwlowerid{make\_groups}~\ocwlowerid{tagger}~\ocwlowerid{output}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{sorted\_groups}~=~\ocwlowerid{sort\_flatten}~\ocwlowerid{groups}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{find\_proj}~\ocwlowerid{solution}~\ocwlowerid{output}~\ocwlowerid{tagging}~\ocwlowerid{sorted\_groups}~$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
\ocwbegindcode{}$\ocwlowerid{analyse\_results}$\ocwenddcode{} will look for a solution consistent with taggings;
   If so will return Some(n,ind,kept,max) as given to \ocwbegindcode{}$\ocwlowerid{print\_output}$\ocwenddcode{} 
   in mode Validate, otherwise returns None. 
\ocweol
\label{regression.ml:5442}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{analyse\_results}~\ocwlowerid{limit}~\ocwlowerid{taggings}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{None}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{best\_sols}~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{kept}~=~\ocwupperid{List.}\ocwlowerid{length}~\ocwlowerid{best\_sols}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{max}~=~$\ocwkw{match}~$\ocwlowerid{limit}~$\ocwkw{with}\ocweol
\ocwindent{7.00em}
$[~\ocwupperid{Some}~\ocwlowerid{m}~\rightarrow{}~\ocwlowerid{m}$\ocweol
\ocwindent{7.00em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{truncation}$\ocweol
\ocwindent{7.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{watch\_verify}~\ocwlowerid{maxim}~=~\ocwlowerid{watch\_rec}~0$\ocweol
\ocwindent{4.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{watch\_rec}~\ocwlowerid{n}~=~$\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{n}~=~\ocwlowerid{maxim}~$\ocwkw{then}~$\ocwupperid{None}$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{match}~$(\ocwlowerid{analyse}~\ocwlowerid{taggings}~(\ocwupperid{List.}\ocwlowerid{nth}~\ocwlowerid{best\_sols}~\ocwlowerid{n}))~$\ocwkw{with}\ocweol
\ocwindent{7.50em}
$[~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{watch\_rec}~(\ocwlowerid{n}+1)$\ocweol
\ocwindent{7.50em}
$\mid{}~\ocwupperid{Some}~\ocwlowerid{sol\_number}~\rightarrow{}~\ocwupperid{Some}~\ocwlowerid{max}$\ocweol
\ocwindent{7.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{watch\_verify}~\ocwlowerid{kept}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{verify\_sentence}~\ocwlowerid{filter\_mode}~\ocwlowerid{us}~\ocwlowerid{topic}~\ocwlowerid{sentence}~\ocwlowerid{encode}~\ocwlowerid{taggings}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{chunker}~=~$\ocwkw{if}~$\ocwlowerid{us}~$\ocwbc{} sandhi undone \ocwec{}~\ocwkw{then}~$\ocwupperid{Sanskrit.}\ocwlowerid{read\_raw\_sanskrit}~$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~\ocwbc{} blanks non-significant \ocwec{}~$\ocwupperid{Sanskrit.}\ocwlowerid{read\_sanskrit}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{chunks}~=~\ocwlowerid{chunker}~\ocwlowerid{encode}~\ocwlowerid{sentence}~$\ocwbc{} normalisation here \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{all\_chunks}~=~$\ocwkw{match}~$\ocwlowerid{topic}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~\ocwupperid{Some}~\ocwlowerid{topic}~\rightarrow{}~\ocwlowerid{chunks}~@~[~\ocwlowerid{code\_string}~\ocwlowerid{topic}~]$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{chunks}$\ocweol
\ocwindent{3.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.50em}
\ocwkw{try}~$\ocwlowerid{segment\_all}~\ocwlowerid{filter\_mode}~\ocwlowerid{all\_chunks}~[\,]~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Solutions}~\ocwlowerid{limit}~\ocwlowerid{revsols}~\ocwlowerid{saved}~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{sols}~=~\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{revsols}~$\ocwkw{in}~\ocweol
\ocwindent{4.50em}
$\ocwlowerid{analyse\_results}~\ocwlowerid{limit}~\ocwlowerid{taggings}~\ocwlowerid{sols}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pdiff}~\ocwlowerid{sol}~\ocwlowerid{modec}~\ocwlowerid{modes}~\ocwlowerid{mode\_sent}~\ocwlowerid{mode\_trans}~\ocwlowerid{sentence}~\ocwlowerid{psol}~\ocwlowerid{tagging}~\ocwlowerid{cho}~\ocwlowerid{chd}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{report}~=~\ocwlowerid{output\_string}~\ocwlowerid{cho}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{prdiff}~=~\ocwlowerid{output\_string}~\ocwlowerid{chd}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{modes\_report}~=~$\ocwstring{"[\{"}~\^{}~$\ocwlowerid{modec}~$\^{}~\ocwstring{"\}]\ocwvspace{}\ensuremath{<}\{"}~\^{}~$\ocwlowerid{modes}~$\^{}~\ocwstring{"\}\ensuremath{>}\ocwvspace{}|\{"}~\ocweol
\ocwindent{10.50em}
\^{}~$\ocwlowerid{mode\_sent}~$\^{}~\ocwstring{"\}|\ocwvspace{}\#\{"}~\^{}~$\ocwlowerid{mode\_trans}~$\^{}~\ocwstring{"\}\#\ocwvspace{}"}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{report}~(\ocwlowerid{modes\_report}~$\^{}~\ocwstring{"(\{"}~\^{}~$\ocwlowerid{sentence}~$\^{}~\ocwstring{"\})\ocwvspace{}"}$)$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{sol}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Some}~\ocwlowerid{max}~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{3.50em}
\{~$\ocwlowerid{report}~($\ocwstring{"["}~\^{}~$(\ocwlowerid{string\_of\_int}~\ocwlowerid{max})~$\^{}~\ocwstring{"]"}$)$\ocweol
\ocwindent{3.50em}
;~\ocwkw{match}~$\ocwlowerid{psol}~$\ocwkw{with}\ocweol
\ocwindent{4.50em}
$[~0~\rightarrow{}~$\ocweol
\ocwindent{6.50em}
$\ocwlowerid{prdiff}~(\ocwlowerid{sentence}~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}~$\ocwlowerid{modec}~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}~$\ocwlowerid{modes}~$\^{}~\ocwstring{"\ocwvspace{}[parses\ocwvspace{}now]\symbol{92}n"}$)$\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{max1}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{diff}~=~(\ocwlowerid{max1}-\ocwlowerid{max})~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
\ocwkw{match}~$\ocwlowerid{diff}~$\ocwkw{with}\ocweol
\ocwindent{9.50em}
$[~0~\rightarrow{}~()$\ocweol
\ocwindent{9.50em}
$\mid{}~\ocwlowerid{d}~\rightarrow{}~\ocwlowerid{prdiff}~(\ocwlowerid{sentence}~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}~$\ocwlowerid{modec}~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}~$\ocwlowerid{modes}~$\^{}~\ocweol
\ocwindent{17.00em}
\ocwstring{"\ocwvspace{}changes\ocwvspace{}["}~\^{}~$(\ocwlowerid{string\_of\_int}~\ocwlowerid{d})~$\^{}~\ocwstring{"]\symbol{92}n"}$)$\ocweol
\ocwindent{9.50em}
$]$\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{3.50em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.50em}
\{~$\ocwlowerid{report}~($\ocwstring{"[0]"}$)$\ocweol
\ocwindent{3.50em}
;~\ocwkw{match}~$\ocwlowerid{psol}~$\ocwkw{with}\ocweol
\ocwindent{4.50em}
$[~0~\rightarrow{}~()~$\ocwbc{} It didn't parse before, so no need to report \ocwec{}\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
$\ocwlowerid{prdiff}~(\ocwlowerid{sentence}~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}~$\ocwlowerid{modec}~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}~$\ocwlowerid{modes}~$\^{}~\ocwstring{"\ocwvspace{}[does\ocwvspace{}not\ocwvspace{}parse]\symbol{92}n"}$)$\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{3.50em}
\}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{report}~($\ocwstring{"\ocwvspace{}"}~\^{}~$\ocwlowerid{print\_tag}~\ocwlowerid{tagging}~$\^{}~\ocwstring{"\symbol{92}n"}$)$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{print\_tag}~=~$\ocwkw{fun}\ocweol
\ocwindent{3.00em}
$[~[~\ocwlowerid{a}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwstring{"\$\{"}~\^{}~$\ocwlowerid{a}~$\^{}~\ocwstring{"\}\$\&"}~\^{}~$(\ocwlowerid{print\_tag}~\ocwlowerid{rest})$\ocweol
\ocwindent{3.00em}
$\mid{}~[\,]~\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{regression}~\ocwlowerid{s}~\ocwlowerid{cho}~\ocwlowerid{chd}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{mc},\ocwlowerid{ms},\ocwlowerid{mst},\ocwlowerid{mt},\ocwlowerid{sc},\ocwlowerid{solc},\ocwlowerid{oc})~=~\ocwlowerid{parse\_solution}~\ocwlowerid{s}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{\_}~=~\ocwlowerid{complete.}\ocwlowerid{val}:=~(\ocwlowerid{mc}~=~$\ocwstring{"C"}$)~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{\_}~=~\ocwlowerid{iterate.}\ocwlowerid{val}:=~(\ocwlowerid{mst}~=~$\ocwstring{"Sent"}$)$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{us}~=~(\ocwlowerid{ms}~=~$\ocwstring{"F"}$)~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{solr}~=~\ocwlowerid{verify\_sentence}~\ocwupperid{True}~\ocwlowerid{us}~\ocwlowerid{topic}~\ocwlowerid{sc}~(\ocwlowerid{switch\_code}~\ocwlowerid{mt})~\ocwlowerid{oc}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{pdiff}~\ocwlowerid{solr}~\ocwlowerid{mc}~\ocwlowerid{ms}~\ocwlowerid{mst}~\ocwlowerid{mt}~\ocwlowerid{sc}~\ocwlowerid{solc}~\ocwlowerid{oc}~\ocwlowerid{cho}~\ocwlowerid{chd}$\ocweol
\ocwindent{0.00em}
;\medskip

\label{regression.ml:8087}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{get\_metadata}~\ocwlowerid{input\_info}~=~$\ocweol
\ocwindent{0.50em}
\ocwkw{let}~$(\ocwlowerid{\_},~\ocwlowerid{filename},~\ocwlowerid{\_})~=~\ocwlowerid{parse\_metadata}~\ocwlowerid{input\_info}~$\ocweol
\ocwindent{0.50em}
\ocwkw{and}~$\ocwlowerid{version}~=~\ocwupperid{Date.}\ocwlowerid{version\_id}~$\ocwkw{in}\ocweol
\ocwindent{0.50em}
\ocwstring{"[\{"}~\^{}~$\ocwlowerid{version}~$\^{}~\ocwstring{"\}]\ocwvspace{}\ensuremath{<}\{"}~\^{}~$\ocwlowerid{filename}~$\^{}~\ocwstring{"\}\ensuremath{>}\ocwvspace{}(\{"}~\^{}~$\ocwupperid{Version.}\ocwlowerid{version\_date}~$\^{}~\ocwstring{"\})"}\ocweol
\ocwindent{0.00em}
;\medskip

\label{regression.ml:8285}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{main\_loop}~\ocwlowerid{ic}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{use\_metadata}~=~\ocwlowerid{input\_line}~\ocwlowerid{ic}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{input\_info}~=~\ocwlowerid{input\_line}~\ocwlowerid{ic}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{version}~=~\ocwupperid{Date.}\ocwlowerid{version\_id}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{date}~=~\ocwupperid{Date.}\ocwlowerid{date\_iso}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{old\_version},\ocwlowerid{filename},\ocwlowerid{old\_date})~=~\ocwlowerid{parse\_metadata}~\ocwlowerid{input\_info}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{cho}~=~\ocwlowerid{open\_out\_gen}~[~\ocwupperid{Open\_wronly};~\ocwupperid{Open\_trunc};~\ocwupperid{Open\_creat};~\ocwupperid{Open\_text}~]~$\ocweol
\ocwindent{6.00em}
\ocwoctconst{777}~$(\ocwupperid{Web.}\ocwlowerid{var\_dir}~$\^{}~\ocwstring{"/"}~\^{}~$\ocwlowerid{filename}~$\^{}~\ocwstring{"\symbol{45}"}~\^{}~\ocweol
\ocwindent{6.00em}
$\ocwlowerid{version}~$\^{}~\ocwstring{"\symbol{45}"}~\^{}~$\ocwlowerid{date}~$\^{}~\ocwstring{".txt"}$)~$\ocweol
\ocwindent{4.00em}
\ocwkw{and}~$\ocwlowerid{chd}~=~\ocwlowerid{open\_out\_gen}~[~\ocwupperid{Open\_wronly};~\ocwupperid{Open\_trunc};~\ocwupperid{Open\_creat};~\ocwupperid{Open\_text}~]$\ocweol
\ocwindent{6.00em}
\ocwoctconst{777}~$(\ocwupperid{Web.}\ocwlowerid{var\_dir}~$\^{}~\ocwstring{"/diff\symbol{45}"}~\^{}~$\ocwlowerid{filename}~$\^{}~\ocwstring{".txt"}$)~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{report\_meta}~=~\ocwlowerid{output\_string}~\ocwlowerid{cho}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{report\_version}~=~\ocwlowerid{output\_string}~\ocwlowerid{chd}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{report\_meta}~(\ocwlowerid{use\_metadata}~$\^{}~\ocwstring{"\symbol{92}n"}~\^{}~$(\ocwlowerid{get\_metadata}~\ocwlowerid{input\_info})~$\^{}~\ocwstring{"\symbol{92}n"}$)$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{diff\_meta}~=~$\ocwstring{"diff:\ocwvspace{}file\ocwvspace{}=\ocwvspace{}"}~\^{}~$\ocwlowerid{filename}~$\^{}~\ocwstring{"\ocwvspace{}from\ocwvspace{}Version\ocwvspace{}"}~\^{}~$\ocwlowerid{old\_version}~$\ocweol
\ocwindent{4.00em}
\^{}~\ocwstring{"."}~\^{}~$\ocwlowerid{old\_date}~$\^{}~\ocwstring{"\ocwvspace{}to\ocwvspace{}"}~\^{}~$\ocwlowerid{version}~$\^{}~\ocwstring{"."}~\^{}~$\ocwlowerid{date}~$\^{}~\ocwstring{"\symbol{92}n"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{report\_version}~\ocwlowerid{diff\_meta}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{try}~$\ocwlowerid{read\_from\_ic}~\ocwlowerid{ic}$\ocweol
\ocwindent{4.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{read\_from\_ic}~\ocwlowerid{ic}~=~$\ocweol
\ocwindent{5.00em}
\ocwkw{let}~$\ocwlowerid{s}~=~\ocwlowerid{input\_line}~\ocwlowerid{ic}~$\ocwkw{in}~\ocweol
\ocwindent{5.00em}
\ocwkw{do}~\{~$\ocwlowerid{regression}~\ocwlowerid{s}~\ocwlowerid{cho}~\ocwlowerid{chd};~\ocwlowerid{read\_from\_ic}~\ocwlowerid{ic}~\}$\ocweol
\ocwindent{2.00em}
\ocwkw{with}~$[~\ocwupperid{End\_of\_file}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{close\_out}~\ocwlowerid{cho};~\ocwlowerid{close\_out}~\ocwlowerid{chd}~\}~]~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Now regression reads on stdin - no need of unsafe file opening 
\ocweol
\label{regression.ml:9458}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{try}~$\ocwlowerid{main\_loop}~\ocwlowerid{stdin}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Sys\_error}~\ocwlowerid{m}~\rightarrow{}~\ocwlowerid{print\_string}~($\ocwstring{"Sys\_error\ocwvspace{}"}~\^{}~$\ocwlowerid{m})~]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Regression reads from stdin, first two metadata lines,
then for each line extracts parameters: mode (S or C),  sandhied or not (T or F),
sentence or word (Sent or Word), then the transliteration code (VH etc),
then the sentence as entered, then the quadruple (n,ind,kept,max), then the 
taggings previously computed in mode Validate.

It then calls: \ocwbegindcode{}$\ocwlowerid{verify\_sentence}$\ocwenddcode{} with appropriate parameters, 
which will either fail (returning None), or succeed with Some(n',ind',kept',max')
Finally it writes a new version of the input in local directory in file 
   \ocwbegindcode{}$\ocwlowerid{filename}-\ocwupperid{Version}.\ocwlowerid{version}-\ocwupperid{Version}.\ocwlowerid{version\_date}.\ocwlowerid{txt}$\ocwenddcode{}
where filename is a parameter read in the metadata second line.
It also prints a diff message in file \ocwbegindcode{}$\ocwupperid{Web}.\ocwlowerid{var\_dir}/\ocwlowerid{diff}-\ocwlowerid{filename}.\ocwlowerid{txt}$\ocwenddcode{}.

\ocweol
\ocwindent{0.00em}
Format of metada information:
1st line gives metadata about the corpus (unalysed)
2nd line gives global parameters \ocwbegindcode{}$\ocwlowerid{version},~\ocwlowerid{filename},~\ocwlowerid{version\_date}$\ocwenddcode{}.

Example of current input format:
\ocwbegindcode{}
\%\%\%~$\ocwupperid{Corpus}~\ocwlowerid{from}~\ocwlowerid{regression}.\ocwlowerid{txt}~\%\%\%~
[\{263\}]~<\{\ocwlowerid{regression}\}>~(\{2012-04-04\})
[\{\ocwupperid{S}\}]~<\{\ocwupperid{T}\}>~\mid{}\{\ocwupperid{Sent}\}\mid{}~\#\{\ocwupperid{VH}\}\#~(\{\ocwlowerid{devaa}$\~{}$\ocwlowerid{nch}.\ocwlowerid{r}.\ocwlowerid{noti}\})~[1]~\$\{\ocwlowerid{devaan}:\ocwupperid{Noun2}\{~\ocwlowerid{acc}.~\ocwlowerid{pl}.~\ocwlowerid{m}.~\}[\ocwlowerid{deva}]\}\$\&\$\{\ocwlowerid{z}.\ocwlowerid{r}.\ocwlowerid{noti}:\ocwupperid{Root}\{~\ocwlowerid{pr}.~[5]~\ocwlowerid{ac}.~\ocwlowerid{sg}.~3~\}[\ocwlowerid{zru}]\}\$\&
[\{\ocwupperid{C}\}]~<\{\ocwupperid{T}\}>~\mid{}\{\ocwupperid{Sent}\}\mid{}~\#\{\ocwupperid{VH}\}\#~(\{\ocwlowerid{devaa}$\~{}$\ocwlowerid{nch}.\ocwlowerid{r}.\ocwlowerid{noti}\})~[1]~\$\{\ocwlowerid{devaan}:\ocwupperid{Noun}\{~\ocwlowerid{acc}.~\ocwlowerid{pl}.~\ocwlowerid{m}.~\}[\ocwlowerid{deva}]\}\$\&\$\{\ocwlowerid{z}.\ocwlowerid{r}.\ocwlowerid{noti}:\ocwupperid{Root}\{~\ocwlowerid{pr}.~[5]~\ocwlowerid{ac}.~\ocwlowerid{sg}.~3~\}[\ocwlowerid{zru}]\}\$\&
$\ocwenddcode{} 
\ocweol
\typeout{OcamlWeb file Checkpoints.ml}
\ocwmodule{Checkpoints}
\label{checkpoints.ml:0}%
Checkpoints management 
\ocweol
\label{checkpoints.ml:648}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phases.Phases};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{string\_of\_phase}~\ocwlowerid{phase\_of\_string}$\ocwenddcode{} \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
string encoding of a phase, used to transmit checkpoints in URLs 
\ocweol
\label{checkpoints.ml:780}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{phase\_encode}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Comp}~(\ocwlowerid{ph},\ocwlowerid{ph'})~\ocwlowerid{prev}~\ocwlowerid{form}~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwstring{"\ensuremath{<}\{"}~\^{}~$\ocwlowerid{string\_of\_phase}~\ocwlowerid{ph}~$\^{}~\ocwstring{"\}\{"}~\^{}\ocweol
\ocwindent{7.50em}
$\ocwlowerid{string\_of\_phase}~\ocwlowerid{ph'}~$\^{}~\ocwstring{"\}\{"}~\^{}\ocweol
\ocwindent{7.50em}
$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{prev}~$\^{}~\ocwstring{"\}\{"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{form}~$\^{}~\ocwstring{"\}\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Tad}~(\ocwlowerid{ph},\ocwlowerid{ph'})~\ocwlowerid{form}~\ocwlowerid{sfx}~\rightarrow{}~$\ocweol
\ocwindent{4.00em}
\ocwstring{"("}~\^{}~$\ocwlowerid{phase\_encode}~\ocwlowerid{ph}~$\^{}~\ocwstring{"\{"}~\^{}\ocweol
\ocwindent{7.50em}
$\ocwlowerid{string\_of\_phase}~\ocwlowerid{ph'}~$\^{}~\ocwstring{"\}\{"}~\^{}\ocweol
\ocwindent{7.50em}
$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{form}~$\^{}~\ocwstring{"\}\{"}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{sfx}~$\^{}~\ocwstring{"\})"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{phase}~\rightarrow{}~$\ocwstring{"\{"}~\^{}~$\ocwlowerid{string\_of\_phase}~\ocwlowerid{phase}~$\^{}~\ocwstring{"\}"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{bool\_encode}~\ocwlowerid{b}~=~$\ocwkw{if}~$\ocwlowerid{b}~$\ocwkw{then}~\ocwstring{"t"}~\ocwkw{else}~\ocwstring{"f"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{string\_point}~(\ocwlowerid{k},(\ocwlowerid{phase},\ocwlowerid{rword}),\ocwlowerid{select})~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{segment}~=~\ocwupperid{Canon.}\ocwlowerid{rdecode}~\ocwlowerid{rword}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{string\_of\_int}~\ocwlowerid{k}~$\^{}~\ocwstring{","}~\^{}~$\ocwlowerid{phase\_encode}~\ocwlowerid{phase}~$\^{}~\ocwstring{",\{"}~\^{}~$\ocwlowerid{segment}~$\^{}~\ocweol
\ocwindent{9.00em}
\ocwstring{"\},\{"}~\^{}~$\ocwlowerid{bool\_encode}~\ocwlowerid{select}~$\^{}~\ocwstring{"\}"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{string\_points}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{last}~]~\rightarrow{}~\ocwlowerid{string\_point}~\ocwlowerid{last}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{first}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{string\_point}~\ocwlowerid{first}~$\^{}~\ocwstring{"|"}~\^{}~$\ocwlowerid{string\_points}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\label{checkpoints.ml:1627}%
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Bank\_lexer};~$\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Gram}~=~\ocwupperid{Camlp4.PreCast.MakeGram}~\ocwupperid{Bank\_lexer}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Bank\_lexer.Token}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{cpts}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"cpts"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{lcpt}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"lcpt"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{phase\_rword}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"phase\_rword"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cpt}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"cpt"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{phase}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"phase"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{guess\_morph}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"guess\_morph"}~\ocwbc{} for interface \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwupperid{EXTEND}~\ocwupperid{Gram}~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{cpts}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{l}~=~\ocwlowerid{lcpt};~`\ocwupperid{EOI}~\rightarrow{}~\ocwlowerid{l}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{lcpt}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Wrong\ocwvspace{}checkpoints\ocwvspace{}parsing\symbol{92}n"}\ocweol
\ocwindent{2.00em}
$]~]~;$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{lcpt}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{l}~=~\ocwupperid{LIST0}~\ocwlowerid{cpt}~\ocwupperid{SEP}~$\ocwstring{"|"}~$\rightarrow{}~\ocwlowerid{l}~]~]~;$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{phase}:$\ocweol
\ocwindent{2.00em}
$[~[~$\ocwstring{"\ensuremath{<}"};~$\ocwlowerid{p}~=~\ocwupperid{TEXT};~\ocwlowerid{p'}~=~\ocwupperid{TEXT}~$\ocwbc{} Preverbed \ocwec{}\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{pre}~=~\ocwupperid{TEXT};~\ocwlowerid{form}~=~\ocwupperid{TEXT}~;~$\ocwstring{"\ensuremath{>}"}~$\rightarrow{}$\ocweol
\ocwindent{3.50em}
$\ocwupperid{Comp}~(\ocwlowerid{phase\_of\_string}~\ocwlowerid{p},~\ocwlowerid{phase\_of\_string}~\ocwlowerid{p'})~$\ocweol
\ocwindent{9.50em}
$(\ocwupperid{Encode.}\ocwlowerid{code\_string}~\ocwlowerid{pre})~(\ocwupperid{Encode.}\ocwlowerid{code\_string}~\ocwlowerid{form})$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"("};~$\ocwlowerid{p}~=~\ocwlowerid{phase};~\ocwlowerid{p'}~=~\ocwupperid{TEXT}~$\ocwbc{} Taddhita \ocwec{}\ocweol
\ocwindent{5.50em}
;~$\ocwlowerid{form}~=~\ocwupperid{TEXT};~\ocwlowerid{sfx}~=~\ocwupperid{TEXT};~$\ocwstring{")"}~$\rightarrow{}$\ocweol
\ocwindent{3.50em}
$\ocwupperid{Tad}~(\ocwlowerid{p},~\ocwlowerid{phase\_of\_string}~\ocwlowerid{p'})~$\ocweol
\ocwindent{9.00em}
$(\ocwupperid{Encode.}\ocwlowerid{code\_string}~\ocwlowerid{form})~(\ocwupperid{Encode.}\ocwlowerid{code\_string}~\ocwlowerid{sfx})~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{p}~=~\ocwupperid{TEXT}~\rightarrow{}~\ocwlowerid{phase\_of\_string}~\ocwlowerid{p}$\ocweol
\ocwindent{2.00em}
$]~]~;$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{phase\_rword}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{s}~=~\ocwlowerid{phase};~$\ocwstring{","};~$\ocwlowerid{o}~=~\ocwupperid{TEXT}~\rightarrow{}~(\ocwlowerid{s},~\ocwupperid{Encode.}\ocwlowerid{rev\_code\_string}~\ocwlowerid{o})~]~]~;$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{cpt}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{m}~=~\ocwupperid{INT};~$\ocwstring{","};~$\ocwlowerid{p}~=~\ocwlowerid{phase\_rword};~$\ocwstring{","};~$\ocwlowerid{s}~=~\ocwupperid{TEXT}~\rightarrow{}~$\ocweol
\ocwindent{3.50em}
$(\ocwlowerid{int\_of\_string}~\ocwlowerid{m},~\ocwlowerid{p},~\ocwlowerid{s}~=$\ocwstring{"t"}$)~]~]~;$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{guess\_morph}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{n}~=~\ocwupperid{TEXT};~$\ocwstring{","};~$\ocwlowerid{o}~=~\ocwupperid{TEXT};~`\ocwupperid{EOI}~\rightarrow{}~(\ocwlowerid{n},\ocwlowerid{o})~]~]~;$\ocweol
\ocwindent{0.00em}
$\ocwupperid{END}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{parse\_cpts}~\ocwlowerid{s}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gram.}\ocwlowerid{parse\_string}~\ocwlowerid{cpts}~\ocwupperid{Loc.}\ocwlowerid{ghost}~\ocwlowerid{s}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"parse\_cpts"}$)~]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{parse\_guess}~\ocwlowerid{s}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gram.}\ocwlowerid{parse\_string}~\ocwlowerid{guess\_morph}~\ocwupperid{Loc.}\ocwlowerid{ghost}~\ocwlowerid{s}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"parse\_guess"}$)~]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Parsing projections stream (Parser, Regression) 
\ocweol
\label{checkpoints.ml:3198}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{projs}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"projs"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{lproj}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"lproj"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{proj}~=~\ocwupperid{Gram.Entry.}\ocwlowerid{mk}~$\ocwstring{"proj"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} A stream of projections is encoded under the form \ocwbegindcode{}1,2$\mid{}2,3|...$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwupperid{EXTEND}~\ocwupperid{Gram}$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{projs}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{l}~=~\ocwlowerid{lproj};~`\ocwupperid{EOI}~\rightarrow{}~\ocwlowerid{l}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{lproj}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Wrong\ocwvspace{}projections\ocwvspace{}parsing\symbol{92}n"}\ocweol
\ocwindent{2.00em}
$]~]~;$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{lproj}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{l}~=~\ocwupperid{LIST0}~\ocwlowerid{proj}~\ocwupperid{SEP}~$\ocwstring{"|"}~$\rightarrow{}~\ocwlowerid{l}~]~]~;$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{proj}:$\ocweol
\ocwindent{2.00em}
$[~[~\ocwlowerid{n}~=~\ocwupperid{INT};~$\ocwstring{","};~$\ocwlowerid{m}~=~\ocwupperid{INT}~\rightarrow{}~(\ocwlowerid{int\_of\_string}~\ocwlowerid{n},\ocwlowerid{int\_of\_string}~\ocwlowerid{m})~]~]~;$\ocweol
\ocwindent{0.00em}
$\ocwupperid{END}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{parse\_proj}~\ocwlowerid{s}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Gram.}\ocwlowerid{parse\_string}~\ocwlowerid{projs}~\ocwupperid{Loc.}\ocwlowerid{ghost}~\ocwlowerid{s}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"parse\_proj"}$)~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Graph_segmenter.ml}
\ocwmodule{Graph\_segmenter}
\label{graph_segmenter.ml:0}%
This segmenter is inspired from old module Segmenter, but uses a graph 
   structure for the sharing of phased segments given with their offset. 
\ocweol
\label{graph_segmenter.ml:771}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{List2};~$\ocwbc{} unstack ass subtract \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Auto.Auto};~$\ocwbc{} auto rule choices State \ocwec{}\medskip

\label{graph_segmenter.ml:857}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Segment}~$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Phases}:~$\ocwkw{sig}~\ocweol
\ocwindent{4.50em}
\ocwkw{type}~$\ocwlowerid{phase}$\ocweol
\ocwindent{4.50em}
\ocwkw{and}~$\ocwlowerid{phases}~=~$\ocwbt{list}~$\ocwlowerid{phase};$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{unknown}~:~\ocwlowerid{phase};$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{aa\_phase}~:~\ocwlowerid{phase}~\rightarrow{}~\ocwlowerid{phase};$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{preverb\_phase}~:~\ocwlowerid{phase}~\rightarrow{}~$\ocwbt{bool};\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{ii\_phase}~:~\ocwlowerid{phase}~\rightarrow{}~$\ocwbt{bool};\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{un\_lopa}~:~\ocwlowerid{phase}~\rightarrow{}~\ocwlowerid{phase};$\ocweol
\ocwindent{4.50em}
\ocwkw{end}$)$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Eilenberg}:~$\ocwkw{sig}~\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{transducer}~:~\ocwupperid{Phases.}\ocwlowerid{phase}~\rightarrow{}~\ocwlowerid{auto};$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{initial}~:~$\ocwbt{bool}~$\rightarrow{}~\ocwupperid{Phases.}\ocwlowerid{phases};$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{dispatch}~:~$\ocwbt{bool}~$\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~\ocwupperid{Phases.}\ocwlowerid{phase}~\rightarrow{}~\ocwupperid{Phases.}\ocwlowerid{phases};$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{accepting}~:~\ocwupperid{Phases.}\ocwlowerid{phase}~\rightarrow{}~$\ocwbt{bool};\ocweol
\ocwindent{4.50em}
\ocwkw{type}~$\ocwlowerid{input}~=~\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} input sentence represented as a word \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwkw{and}~$\ocwlowerid{transition}~=~$\ocwbc{} junction relation \ocwec{}\ocweol
\ocwindent{6.00em}
$[~\ocwupperid{Euphony}~$\ocwkw{of}~$\ocwlowerid{rule}~$\ocwbc{} \ocwbegindcode{}$(\ocwlowerid{w},\ocwlowerid{rev}~\ocwlowerid{u},\ocwlowerid{v})$\ocwenddcode{} such that \ocwbegindcode{}$\ocwlowerid{u}\mid{}\ocwlowerid{v}~\rightarrow{}~\ocwlowerid{w}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Id}~$\ocwbc{} identity or no sandhi \ocwec{}\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{4.50em}
\ocwkw{and}~$\ocwlowerid{segment}~=~(\ocwupperid{Phases.}\ocwlowerid{phase}~\times{}~\ocwupperid{Word.}\ocwlowerid{word}~\times{}~\ocwlowerid{transition})$\ocweol
\ocwindent{4.50em}
\ocwkw{and}~$\ocwlowerid{output}~=~$\ocwbt{list}~$\ocwlowerid{segment};~$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{value}~\ocwlowerid{validate}~:~\ocwlowerid{output}~\rightarrow{}~\ocwlowerid{output};~$\ocwbc{} consistency check / compress \ocwec{}~\ocweol
\ocwindent{4.50em}
\ocwkw{end}$)$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Control}:~$\ocwkw{sig}~$\ocwlowerid{value}~\ocwlowerid{star}~:~$\ocwbt{ref}~\ocwbt{bool};~\ocwbc{} chunk= if star then word+ else word \ocwec{}\ocweol
\ocwindent{8.00em}
$\ocwlowerid{value}~\ocwlowerid{full}~:~$\ocwbt{ref}~\ocwbt{bool};~\ocwbc{} all kridantas and nan cpds if full \ocwec{}\ocweol
\ocwindent{6.00em}
\ocwkw{end}$)~$\ocweol
\ocwindent{1.00em}
=~\ocwkw{struct}\medskip

\label{graph_segmenter.ml:2056}%
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phases};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Eilenberg};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Control};~$\ocwbc{} star full \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
The summarizing structure sharing sub-solutions 
\ocweol
\ocwindent{0.00em}
It represents the union of all solutions 
\ocweol
\ocwindent{0.00em}
859 attested as last sentence in Pancatantra 
\ocweol
\label{graph_segmenter.ml:2269}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{max\_input\_length}~=~1000$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{max\_seg\_rows}~=~1000~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Overflow}~$\ocwbc{} length of sentence exceeding array size \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} segments of a given phase \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{phased\_segment}~=~(\ocwlowerid{phase}~\times{}~$\ocwbt{list}~$(\ocwupperid{Word.}\ocwlowerid{word}~\times{}~$\ocwbt{list}~$\ocwupperid{Word.}\ocwlowerid{word}))~$\ocweol
\ocwindent{16.50em}
\ocwbc{} (segment, mandatory prefixes of following segment) \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{segments}~=~$\ocwbt{list}~$\ocwlowerid{phased\_segment}~$\ocwbc{} partially forgetting sandhi \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{null}~=~([\,]~:~\ocwlowerid{segments})~$\ocwbc{} initialisation of graph entry \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{null\_visual}~=~([\,]:~$\ocwbt{list}~$(\ocwupperid{Word.}\ocwlowerid{word}~\times{}~$\ocwbt{list}~$\ocwupperid{Word.}\ocwlowerid{word}~\times{}~\ocwlowerid{phase}~\times{}~$\ocwbt{int}$))$\ocweol
\ocwindent{11.50em}
\ocwbc{} \ocwbegindcode{}~$(\ocwlowerid{word},~\ocwlowerid{v's}~$\ocwkw{of}~$\ocwlowerid{next}~\ocwlowerid{segment},~\ocwlowerid{phase},~\ocwlowerid{offset})~$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{null\_visual\_conf}~=~([\,]:~$\ocwbt{list}~$(\ocwupperid{Word.}\ocwlowerid{word}~\times{}~\ocwlowerid{phase}~\times{}~$\ocwbt{int}~$\times{}~$\ocwbt{bool}$))$\ocweol
\ocwindent{14.50em}
\ocwbc{} \ocwbegindcode{}~$(\ocwlowerid{word},~\ocwlowerid{phase},~\ocwlowerid{offset},~\ocwlowerid{is\_conflicting})~$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} This is the graph on padas of the union of all solutions \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} We guarantee that every arc of the graph belongs to at least one bona fide
   segmentation. But every path in this graph is not a valid segmentation. 
   A path must pass global sandhi verification to qualify as valid. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} NB. Valid segmentations may contain unrecognized segments. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{graph}~=~\ocwupperid{Array.}\ocwlowerid{make}~\ocwlowerid{max\_input\_length}~\ocwlowerid{null}~$\ocwbc{} global over chunks \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{visual}~=~\ocwupperid{Array.}\ocwlowerid{make}~\ocwlowerid{max\_seg\_rows}~\ocwlowerid{null\_visual}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{visual\_conf}~=~\ocwupperid{Array.}\ocwlowerid{make}~\ocwlowerid{max\_seg\_rows}~\ocwlowerid{null\_visual\_conf}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{visual\_width}~=~\ocwupperid{Array.}\ocwlowerid{make}~\ocwlowerid{max\_seg\_rows}~0~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Checkpoints structure (sparse subgraph with mandatory positioned padas) \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{phased\_pada}~=~(\ocwlowerid{phase}~\times{}~\ocwupperid{Word.}\ocwlowerid{word})~$\ocwbc{} for checkpoints \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{check}~=~($\ocwbt{int}~$\times{}~\ocwlowerid{phased\_pada}~\times{}~$\ocwbt{bool}$)~$\ocwbc{} checkpoint validation \ocwec{}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{checks}~=~$\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{all\_checks}~:~$\ocwkw{mutable}~$($\ocwbt{list}~$\ocwlowerid{check})~$\ocwbc{} checkpoints in valid solution \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{segment\_checks}~:~$\ocwkw{mutable}~$($\ocwbt{list}~$\ocwlowerid{check})~$\ocwbc{} checkpoints in local segment  \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{chkpts}~=~\{~\ocwlowerid{all\_checks}~=~[\,];~\ocwlowerid{segment\_checks}~=~[\,]\}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Accessing graph entry with phase \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{split}~\ocwlowerid{phase}~=~\ocwlowerid{split\_rec}~[\,]~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{split\_rec}~\ocwlowerid{acc}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~([~((\ocwlowerid{ph},\ocwlowerid{\_})~$\ocwkw{as}~$\ocwlowerid{fst})~::~\ocwlowerid{rst}~]~$\ocwkw{as}~$\ocwlowerid{l})~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{ph}=\ocwlowerid{phase}~$\ocwkw{then}~$(\ocwlowerid{acc},\ocwlowerid{l})~$\ocwkw{else}~$\ocwlowerid{split\_rec}~[~\ocwlowerid{fst}~::~\ocwlowerid{acc}~]~\ocwlowerid{rst}$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~(\ocwlowerid{acc},[\,])$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{insert\_right}~\ocwlowerid{right}~\ocwlowerid{pada}~=~\ocwlowerid{ins\_rec}$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{ins\_rec}~\ocwlowerid{acc}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"insert\_right"}\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwlowerid{p},\ocwlowerid{tr})~::~\ocwlowerid{rst}~]~\rightarrow{}~$\ocweol
\ocwindent{3.50em}
\ocwkw{if}~$\ocwlowerid{p}=\ocwlowerid{pada}~$\ocwkw{then}~\ocwkw{let}~$\ocwlowerid{tr'}~=~[~\ocwlowerid{right}~::~\ocwlowerid{tr}~]~$\ocwkw{in}\ocweol
\ocwindent{11.00em}
$\ocwlowerid{unstack}~[~(\ocwlowerid{p},\ocwlowerid{tr'})~::~\ocwlowerid{acc}~]~\ocwlowerid{rst}$\ocweol
\ocwindent{3.50em}
\ocwkw{else}~$\ocwlowerid{ins\_rec}~[~(\ocwlowerid{p},\ocwlowerid{tr})~::~\ocwlowerid{acc}~]~\ocwlowerid{rst}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{get\_pada}~\ocwlowerid{pada}~=~\ocwlowerid{getrec}~\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{getrec}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{None}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwlowerid{p},\ocwlowerid{tr})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{p}=\ocwlowerid{pada}~$\ocwkw{then}~$(\ocwupperid{Some}~\ocwlowerid{tr})~$\ocwkw{else}~$\ocwlowerid{getrec}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{register}~\ocwlowerid{index}~(\ocwlowerid{phase},\ocwlowerid{pada},\ocwlowerid{sandhi})~=~$\ocweol
\ocwindent{1.00em}
\ocwbc{} We search for bucket of given phase in graph \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{al},\ocwlowerid{ar})~=~\ocwlowerid{split}~\ocwlowerid{phase}~\ocwlowerid{graph}.(\ocwlowerid{index})~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{allowed\_right}~=~$\ocwkw{match}~$\ocwlowerid{sandhi}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Id}~\rightarrow{}~[\,]$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{\_},\ocwlowerid{v})~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{w}=\ocwlowerid{v}~$\ocwkw{then}~$[\,]~$\ocwkw{else}~$\ocwlowerid{v}$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pada\_right}~=~(\ocwlowerid{pada},[~\ocwlowerid{allowed\_right}~])~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{update\_graph}~\ocwlowerid{ar'}~=~\ocwlowerid{graph}.(\ocwlowerid{index})~:=~\ocwlowerid{unstack}~\ocwlowerid{al}~\ocwlowerid{ar'}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{ar}~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~[~(\ocwlowerid{\_},\ocwlowerid{padas})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwbc{} bucket found \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwlowerid{get\_pada}~\ocwlowerid{pada}~\ocwlowerid{padas}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Some}~\ocwlowerid{tr}~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{mem}~\ocwlowerid{allowed\_right}~\ocwlowerid{tr}~$\ocwkw{then}~$()~$\ocwbc{} already registered \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwkw{else}~\ocwkw{let}~$\ocwlowerid{updated\_sandhi}~=~\ocwlowerid{insert\_right}~\ocwlowerid{allowed\_right}~\ocwlowerid{pada}~[\,]~\ocwlowerid{padas}~$\ocwkw{in}\ocweol
\ocwindent{7.00em}
$\ocwlowerid{update\_graph}~[~(\ocwlowerid{phase},\ocwlowerid{updated\_sandhi})~::~\ocwlowerid{rest}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{update\_graph}~[~(\ocwlowerid{phase},[~\ocwlowerid{pada\_right}~::~\ocwlowerid{padas}~])~::~\ocwlowerid{rest}~]$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~\ocwlowerid{update\_graph}~[~(\ocwlowerid{phase},[~\ocwlowerid{pada\_right}~])~]~$\ocwbc{} new bucket \ocwec{}\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{chunk\_params}~=~\{~\ocwlowerid{offset}~:~$\ocwkw{mutable}~\ocwbt{int};~$\ocwlowerid{segmentable}~:~$\ocwkw{mutable}~\ocwbt{bool}~\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{cur\_chunk}~=~\{~\ocwlowerid{offset}~=~0;~\ocwlowerid{segmentable}~=~\ocwupperid{False}~\}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{set\_cur\_offset}~\ocwlowerid{n}~=~\ocwlowerid{cur\_chunk.}\ocwlowerid{offset}~:=~\ocwlowerid{n}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{set\_segmentable}~\ocwlowerid{b}~=~\ocwlowerid{cur\_chunk.}\ocwlowerid{segmentable}~:=~\ocwlowerid{b}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{set\_offset}~(\ocwlowerid{offset},\ocwlowerid{checkpoints})~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{set\_cur\_offset}~\ocwlowerid{offset}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{chkpts.}\ocwlowerid{all\_checks}~:=~\ocwlowerid{checkpoints}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{reset\_graph}~()~=~$\ocwkw{for}~$\ocwlowerid{i}~=~0~$\ocwkw{to}~$\ocwlowerid{max\_input\_length}-1~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{graph}.(\ocwlowerid{i})~:=~\ocwlowerid{null}~\}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{reset\_visual}~()~=~$\ocwkw{for}~$\ocwlowerid{i}~=~0~$\ocwkw{to}~$\ocwlowerid{max\_seg\_rows}-1~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{visual}.(\ocwlowerid{i})~:=~\ocwlowerid{null\_visual}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{visual\_conf}.(\ocwlowerid{i})~:=~\ocwlowerid{null\_visual\_conf}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{visual\_width}.(\ocwlowerid{i})~:=~0$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} The offset permits to align each segment with the input string \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{offset}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},\ocwlowerid{v})~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{off}~=~$\ocwkw{if}~$\ocwlowerid{w}=[\,]~$\ocwkw{then}~1~\ocwbc{} amui/lopa from Lopa/Lopak \ocwec{}\ocweol
\ocwindent{11.00em}
\ocwkw{else}~$\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{w}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{off}~-~(\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{u}~+~\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{v})~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Id}~\rightarrow{}~0$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{contains}~\ocwlowerid{phase\_w}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwlowerid{phase},\ocwlowerid{word},\ocwlowerid{\_})~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{phase\_w}=(\ocwlowerid{phase},\ocwlowerid{word})~\lor{}~\ocwlowerid{contains}~\ocwlowerid{phase\_w}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{check\_chunk}~\ocwlowerid{position}~\ocwlowerid{solution}~\ocwlowerid{checkpoints}~=~$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{check\_rec}~\ocwlowerid{position}~\ocwlowerid{solution}~\ocwlowerid{checkpoints}$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{check\_rec}~\ocwlowerid{index}~\ocwlowerid{sol}~\ocwlowerid{checks}~=~$\ocwkw{match}~$\ocwlowerid{checks}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{True}~$\ocwbc{} all checkpoints verified \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~(\ocwlowerid{pos},\ocwlowerid{phase\_word},\ocwlowerid{select})~::~\ocwlowerid{more}~]~\rightarrow{}~$\ocweol
\ocwindent{5.00em}
\ocwbc{} select=True for check \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{index}~>~\ocwlowerid{pos}~$\ocwkw{then}~\ocweol
\ocwindent{6.00em}
\ocwkw{if}~$\ocwlowerid{select}~$\ocwkw{then}~$\ocwupperid{False}~$\ocweol
\ocwindent{6.00em}
\ocwkw{else}~$\ocwlowerid{check\_rec}~\ocwlowerid{index}~\ocwlowerid{sol}~\ocwlowerid{more}~$\ocwbc{} checkpoint missed \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{else}~\ocwkw{match}~$\ocwlowerid{sol}~$\ocwkw{with}~\ocweol
\ocwindent{5.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{True}~$\ocwbc{} checkpoint relevant for later chunks \ocwec{}\ocweol
\ocwindent{5.00em}
$\mid{}~[~(\ocwlowerid{phase},\ocwlowerid{word},\ocwlowerid{sandhi})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{7.00em}
\ocwkw{let}~$\ocwlowerid{next\_index}~=~\ocwlowerid{index}~+~\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{word}~+~\ocwlowerid{offset}~\ocwlowerid{sandhi}~$\ocwkw{in}\ocweol
\ocwindent{7.00em}
\ocwkw{if}~$\ocwlowerid{index}~<~\ocwlowerid{pos}~$\ocwkw{then}~$\ocwlowerid{check\_rec}~\ocwlowerid{next\_index}~\ocwlowerid{rest}~\ocwlowerid{checks}~$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~\ocwkw{let}~$(\ocwlowerid{nxt\_ind},\ocwlowerid{ind\_sols},\ocwlowerid{next\_sols})~=~\ocwlowerid{all\_sol\_seg\_ind}~[\,]~\ocwlowerid{sol}$\ocweol
\ocwindent{8.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{all\_sol\_seg\_ind}~\ocwlowerid{stack}~=~$\ocwkw{fun}\ocweol
\ocwindent{8.50em}
$[~[\,]~\rightarrow{}~(\ocwlowerid{next\_index},\ocwlowerid{stack},[\,])$\ocweol
\ocwindent{8.50em}
$\mid{}~[~((\ocwlowerid{phase2},\ocwlowerid{word2},\ocwlowerid{sandhi2})~$\ocwkw{as}~$\ocwlowerid{seg2})~::~\ocwlowerid{rest2}~]~\rightarrow{}~$\ocweol
\ocwindent{9.50em}
\ocwkw{let}~$\ocwlowerid{next\_index}~=~\ocwlowerid{pos}~+~\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{word2}~+~\ocwlowerid{offset}~\ocwlowerid{sandhi2}~$\ocwkw{in}\ocweol
\ocwindent{9.50em}
\ocwkw{if}~$\ocwlowerid{next\_index}=\ocwlowerid{pos}~$\ocwkw{then}~$\ocwlowerid{all\_sol\_seg\_ind}~[~\ocwlowerid{seg2}~::~\ocwlowerid{stack}~]~\ocwlowerid{rest2}$\ocweol
\ocwindent{9.50em}
\ocwkw{else}~$(\ocwlowerid{next\_index},[\ocwlowerid{seg2}~::~\ocwlowerid{stack}],\ocwlowerid{rest2})$\ocweol
\ocwindent{8.50em}
$]$\ocweol
\ocwindent{7.00em}
\ocwkw{and}~$(\ocwlowerid{ind\_check},\ocwlowerid{next\_check})~=~\ocwlowerid{all\_check\_ind}~[\,]~\ocwlowerid{checks}$\ocweol
\ocwindent{7.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{all\_check\_ind}~\ocwlowerid{stack}~=~$\ocwkw{fun}\ocweol
\ocwindent{8.00em}
$[~[\,]~\rightarrow{}~(\ocwlowerid{stack},[\,])$\ocweol
\ocwindent{8.00em}
$\mid{}~([~(\ocwlowerid{pos2},\ocwlowerid{phase\_word2},\ocwlowerid{select2})~::~\ocwlowerid{more2}~]~$\ocwkw{as}~$\ocwlowerid{orig})~\rightarrow{}$\ocweol
\ocwindent{9.50em}
\ocwkw{if}~$\ocwlowerid{pos2}=\ocwlowerid{pos}~$\ocwkw{then}~\ocweol
\ocwindent{11.00em}
$\ocwlowerid{all\_check\_ind}~[~(\ocwlowerid{pos2},\ocwlowerid{phase\_word2},\ocwlowerid{select2})~::~\ocwlowerid{stack}~]~\ocwlowerid{more2}$\ocweol
\ocwindent{9.50em}
\ocwkw{else}~$(\ocwlowerid{stack},\ocwlowerid{orig})$\ocweol
\ocwindent{8.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{7.00em}
$\ocwlowerid{check\_sols}~\ocwlowerid{ind\_sols}~\ocwlowerid{ind\_check}$\ocweol
\ocwindent{7.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{check\_sols}~\ocwlowerid{solspt}~=~$\ocwkw{fun}\ocweol
\ocwindent{8.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{check\_rec}~\ocwlowerid{nxt\_ind}~\ocwlowerid{next\_sols}~\ocwlowerid{next\_check}~$\ocweol
\ocwindent{8.00em}
$\mid{}~[~(\ocwlowerid{pos2},\ocwlowerid{phase\_word2},\ocwlowerid{select2})~::~\ocwlowerid{more2}~]~\rightarrow{}~$\ocweol
\ocwindent{10.00em}
$(\ocwlowerid{select2}=\ocwlowerid{contains}~\ocwlowerid{phase\_word2}~\ocwlowerid{solspt})$\ocweol
\ocwindent{10.00em}
\ocwbc{} Boolean select2 should be consistent with the solutions \ocwec{}\ocweol
\ocwindent{10.00em}
$\land{}~\ocwlowerid{check\_sols}~\ocwlowerid{solspt}~\ocwlowerid{more2}$\ocweol
\ocwindent{8.00em}
$]$\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{3.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} counts the number of segmentation solutions of a chunk \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{solutions\_counter}~=~$\ocwbt{ref}~0\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{bump\_counter}~()~=~\ocwlowerid{solutions\_counter.}\ocwlowerid{val}~:=~\ocwlowerid{solutions\_counter.}\ocwlowerid{val}~+~1$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{get\_counter}~()~=~\ocwlowerid{solutions\_counter.}\ocwlowerid{val}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{reset\_counter}~()~=~\ocwlowerid{solutions\_counter.}\ocwlowerid{val}~:=~0$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{log\_chunk}~\ocwlowerid{revsol}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{solution}~=~\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{revsol}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{position}~=~\ocwlowerid{cur\_chunk.}\ocwlowerid{offset}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{position}~\ge{}~\ocwlowerid{max\_input\_length}~$\ocwkw{then}~$\ocwlowerid{raise}~\ocwupperid{Overflow}~$\ocwkw{else}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{check}~=~\ocwlowerid{check\_chunk}~\ocwlowerid{position}~\ocwlowerid{solution}~\ocwlowerid{chkpts.}\ocwlowerid{segment\_checks}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{check}~$\ocwkw{then}~\ocwbc{} log solution consistent with checkpoints \ocwec{}~\ocwkw{do}~\ocweol
\ocwindent{3.50em}
\{~$\ocwlowerid{log\_rec}~\ocwlowerid{position}~\ocwlowerid{solution}~$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{log\_rec}~\ocwlowerid{index}~=~$\ocwkw{fun}~\ocweol
\ocwindent{4.50em}
$[~[\,]~\rightarrow{}~()$\ocweol
\ocwindent{4.50em}
$\mid{}~[~((\ocwlowerid{phase},\ocwlowerid{word},\ocwlowerid{sandhi})~$\ocwkw{as}~$\ocwlowerid{triple})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{6.50em}
\{~$\ocwlowerid{register}~\ocwlowerid{index}~\ocwlowerid{triple}$\ocweol
\ocwindent{6.50em}
;~$\ocwlowerid{log\_rec}~(\ocwlowerid{index}~+~\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{word}~+~\ocwlowerid{offset}~\ocwlowerid{sandhi})~\ocwlowerid{rest}$\ocweol
\ocwindent{6.50em}
\}\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{3.50em}
;~$\ocwlowerid{set\_segmentable}~\ocwupperid{True}$\ocweol
\ocwindent{3.50em}
;~$\ocwlowerid{bump\_counter}~()$\ocweol
\ocwindent{3.50em}
\}\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$()$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Rest duplicated from Segmenter 
\ocweol
\ocwindent{0.00em}
Checking for legitimate Id sandhi 
\ocweol
\ocwindent{0.00em}
Uses \ocwbegindcode{}$\ocwlowerid{sandhis\_id}$\ocwenddcode{} computed by \ocwbegindcode{}$\ocwupperid{Compile\_sandhi}$\ocwenddcode{} 
\ocweol
\label{graph_segmenter.ml:9794}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{allowed\_trans}~=$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwupperid{Web.}\ocwlowerid{public\_sandhis\_id\_file}:\ocwupperid{Deco.}\ocwlowerid{deco}~\ocwupperid{Word.}\ocwlowerid{word})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{check\_id\_sandhi}~\ocwlowerid{revl}~\ocwlowerid{first}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{match\_right}~\ocwlowerid{allowed}~=~\lnot{}~(\ocwupperid{List.}\ocwlowerid{mem}~[~\ocwlowerid{first}~]~\ocwlowerid{allowed})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{try}~\ocwkw{match}~$\ocwlowerid{revl}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~\ocwlowerid{last}~::~\ocwlowerid{before}~]~\rightarrow{}~$\ocweol
\ocwindent{5.00em}
$(\ocwupperid{Phonetics.}\ocwlowerid{n\_or\_f}~\ocwlowerid{last}~\land{}~\ocwupperid{Phonetics.}\ocwlowerid{vowel}~\ocwlowerid{first})~\lor{}$\ocweol
\ocwindent{5.00em}
\ocwbc{} we allow an-s transition with s vowel-initial, ignoring nn rules \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwbc{} this is necessary not to block transitions from the An phase \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{let}~$\ocwlowerid{allowed1}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~[~\ocwlowerid{last}~]~\ocwlowerid{allowed\_trans}~$\ocwkw{in}\ocweol
\ocwindent{5.00em}
\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{match\_right}~\ocwlowerid{allowed1}~$\ocweol
\ocwindent{6.50em}
$\mid{}~[~\ocwlowerid{penu}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocweol
\ocwindent{7.50em}
\ocwkw{let}~$\ocwlowerid{allowed2}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~[~\ocwlowerid{last}~::~[~\ocwlowerid{penu}~]~]~\ocwlowerid{allowed\_trans}~$\ocwkw{in}\ocweol
\ocwindent{7.50em}
$\ocwlowerid{match\_right}~\ocwlowerid{allowed2}~\land{}~\ocwlowerid{match\_right}~\ocwlowerid{allowed1}~$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{with}~$[~\ocwupperid{Not\_found}~\rightarrow{}~\ocwupperid{True}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sandhi\_aa}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~48;~1~]~\rightarrow{}~[~1;~2~]~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{a}.\ocwlowerid{h}~\mid{}~\ocwlowerid{aa}~\rightarrow{}~\ocwlowerid{a\_aa}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~43;~1~]~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{code\_string}~$\ocwstring{"araa"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{ar}~\mid{}~\ocwlowerid{aa}~\rightarrow{}~\ocwlowerid{araa}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{c}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~1~\mid{}~2~\rightarrow{}~[~2~]$\ocweol
\ocwindent{6.50em}
$\mid{}~3~\mid{}~4~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{code\_string}~$\ocwstring{"yaa"}\ocweol
\ocwindent{6.50em}
$\mid{}~5~\mid{}~6~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{code\_string}~$\ocwstring{"vaa"}\ocweol
\ocwindent{6.50em}
$\mid{}~7~\mid{}~8~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{code\_string}~$\ocwstring{"raa"}\ocweol
\ocwindent{6.50em}
$\mid{}~9~\rightarrow{}~\ocwupperid{Encode.}\ocwlowerid{code\_string}~$\ocwstring{"laa"}\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~[~\ocwupperid{Phonetics.}\ocwlowerid{voiced}~\ocwlowerid{c};~2~]$\ocweol
\ocwindent{6.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"sandhi\_aa"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{merge\_aa}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{c}~::~\ocwlowerid{r}~]~\rightarrow{}~\ocwlowerid{unstack}~(\ocwupperid{Word.}\ocwlowerid{mirror}~(\ocwlowerid{sandhi\_aa}~[~\ocwlowerid{c}~]))~\ocwlowerid{r}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"merge\_aa"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Expands phantom-initial or lopa-initial segments \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} NB phase \ocwbegindcode{}$(\ocwlowerid{aa\_phase}~\ocwlowerid{ph})$\ocwenddcode{} of \ocwstring{"aa"} is Pv for verbal ph, Pvkv for nominal ones \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{accrue}~((\ocwlowerid{ph},\ocwlowerid{revword},\ocwlowerid{rule})~$\ocwkw{as}~$\ocwlowerid{segment})~\ocwlowerid{previous\_segments}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{revword}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~[~-2~$\ocwbc{} \ocwbegindcode{}-\ocwenddcode{} \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{previous\_segments}~$\ocwkw{with}~\ocwbc{} First Lopa \ocwec{}~\ocweol
\ocwindent{3.00em}
$[~[~(\ocwlowerid{phase},\ocwlowerid{pv},\ocwupperid{Euphony}~([\,],\ocwlowerid{u},[-2]))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwbc{} phase=Pv,Pvkv,Pvkc \ocwec{}\ocweol
\ocwindent{5.00em}
\ocwkw{let}~$\ocwlowerid{v}~=~$\ocwkw{match}~$\ocwlowerid{r}~$\ocwkw{with}~$[~[~10~$\ocwbc{} e \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~[~10~]~$\ocweol
\ocwindent{15.50em}
$\mid{}~[~12~$\ocwbc{} o \ocwec{}~::~$\ocwlowerid{\_}~]~\rightarrow{}~[~12~]$\ocweol
\ocwindent{15.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}~\ocweol
\ocwindent{15.50em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{5.00em}
\ocwbc{} u is \ocwbegindcode{}~$\ocwlowerid{a}~$\ocwenddcode{} or \ocwbegindcode{}~$\ocwlowerid{aa}~$\ocwenddcode{}, v is \ocwbegindcode{}~$\ocwlowerid{e}~$\ocwenddcode{} or \ocwbegindcode{}~$\ocwlowerid{o}~$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{5.00em}
$[~\ocwlowerid{un\_lopa\_segment}~::~[~(\ocwlowerid{phase},\ocwlowerid{pv},\ocwupperid{Euphony}~(\ocwlowerid{v},\ocwlowerid{u},\ocwlowerid{v}))~::~\ocwlowerid{rest}~]~]$\ocweol
\ocwindent{6.00em}
$\ocwlowerid{where}~\ocwlowerid{un\_lopa\_segment}~=~(\ocwlowerid{un\_lopa}~\ocwlowerid{ph},\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{r},\ocwlowerid{rule})~$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{4.00em}
\ocwbc{} Then phantom phonemes \ocwec{}\ocweol
\ocwindent{1.50em}
$\mid{}~[~-3~$\ocwbc{} *a \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{previous\_segments}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{\_},\ocwlowerid{u},[-3]))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{w}~=~\ocwlowerid{sandhi\_aa}~\ocwlowerid{u}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$[~\ocwlowerid{new\_segment}~::~[~(\ocwlowerid{aa\_phase}~\ocwlowerid{ph},[~2~],\ocwupperid{Euphony}~([~2~],[~2~],~[~1~]))~$\ocweol
\ocwindent{11.50em}
::~$[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},[~2~]))~::~\ocwlowerid{rest}~]~]~]$\ocweol
\ocwindent{5.50em}
$\ocwlowerid{where}~\ocwlowerid{new\_segment}~=~(\ocwlowerid{ph},\ocwupperid{Word.}\ocwlowerid{mirror}~[~1~::~\ocwlowerid{r}~],\ocwlowerid{rule})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~-9~$\ocwbc{} *A \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{previous\_segments}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{\_},\ocwlowerid{u},[-9]))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{w}~=~\ocwlowerid{sandhi\_aa}~\ocwlowerid{u}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$[~\ocwlowerid{new\_segment}~::~[~(\ocwlowerid{aa\_phase}~\ocwlowerid{ph},[~2~],\ocwupperid{Euphony}~([~2~],[~2~],~[~2~]))~$\ocweol
\ocwindent{11.50em}
::~$[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},[~2~]))~::~\ocwlowerid{rest}~]~]~]$\ocweol
\ocwindent{5.50em}
$\ocwlowerid{where}~\ocwlowerid{new\_segment}~=~(\ocwlowerid{ph},\ocwupperid{Word.}\ocwlowerid{mirror}~[~2~::~\ocwlowerid{r}~],\ocwlowerid{rule})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~-4~$\ocwbc{} *i \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{previous\_segments}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{\_},\ocwlowerid{u},[-4]))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{w}~=~\ocwlowerid{sandhi\_aa}~\ocwlowerid{u}~$\ocwkw{in}~\ocweol
\ocwindent{4.50em}
$[~\ocwlowerid{new\_segment}~::~[~(\ocwlowerid{aa\_phase}~\ocwlowerid{ph},[~2~],\ocwupperid{Euphony}~([~10~],[~2~],~[~3~]))~$\ocweol
\ocwindent{11.50em}
::~$[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},[~2~]))~::~\ocwlowerid{rest}~]~]~]~$\ocweol
\ocwindent{5.50em}
$\ocwlowerid{where}~\ocwlowerid{new\_segment}~=~(\ocwlowerid{ph},\ocwupperid{Word.}\ocwlowerid{mirror}~[~3~::~\ocwlowerid{r}~],\ocwlowerid{rule})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~-7~$\ocwbc{} *I \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{previous\_segments}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{\_},\ocwlowerid{u},[-7]))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{w}~=~\ocwlowerid{sandhi\_aa}~\ocwlowerid{u}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$[~\ocwlowerid{new\_segment}~::~[~(\ocwlowerid{aa\_phase}~\ocwlowerid{ph},[~2~],\ocwupperid{Euphony}~([~10~],[~2~],~[~4~]))~$\ocweol
\ocwindent{11.50em}
::~$[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},[~2~]))~::~\ocwlowerid{rest}~]~]~]$\ocweol
\ocwindent{5.50em}
$\ocwlowerid{where}~\ocwlowerid{new\_segment}~=~(\ocwlowerid{ph},\ocwupperid{Word.}\ocwlowerid{mirror}~[~4~::~\ocwlowerid{r}~],\ocwlowerid{rule})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~-5~$\ocwbc{} *u \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{previous\_segments}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{\_},\ocwlowerid{u},[-5]))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{w}~=~\ocwlowerid{sandhi\_aa}~\ocwlowerid{u}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$[~\ocwlowerid{new\_segment}~::~[~(\ocwlowerid{aa\_phase}~\ocwlowerid{ph},[~2~],\ocwupperid{Euphony}~([~12~],[~2~],~[~5~]))~$\ocweol
\ocwindent{11.50em}
::~$[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},[~2~]))~::~\ocwlowerid{rest}~]~]~]$\ocweol
\ocwindent{5.50em}
$\ocwlowerid{where}~\ocwlowerid{new\_segment}~=~(\ocwlowerid{ph},\ocwupperid{Word.}\ocwlowerid{mirror}~[~5~::~\ocwlowerid{r}~],\ocwlowerid{rule})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~-8~$\ocwbc{} *U \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{previous\_segments}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{\_},\ocwlowerid{u},[-8]))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{w}~=~\ocwlowerid{sandhi\_aa}~\ocwlowerid{u}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$[~\ocwlowerid{new\_segment}~::~[~(\ocwlowerid{aa\_phase}~\ocwlowerid{ph},[~2~],\ocwupperid{Euphony}~([~12~],[~2~],~[~6~]))~$\ocweol
\ocwindent{11.50em}
::~$[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},[~2~]))~::~\ocwlowerid{rest}~]~]~]$\ocweol
\ocwindent{5.50em}
$\ocwlowerid{where}~\ocwlowerid{new\_segment}~=~(\ocwlowerid{ph},\ocwupperid{Word.}\ocwlowerid{mirror}~[~6~::~\ocwlowerid{r}~],\ocwlowerid{rule})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~-6~$\ocwbc{} *r \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{previous\_segments}~$\ocwkw{with}\ocweol
\ocwindent{3.50em}
$[~[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{\_},\ocwlowerid{u},[-6]))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{w}~=~\ocwlowerid{sandhi\_aa}~\ocwlowerid{u}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$[~\ocwlowerid{new\_segment}~::~[~(\ocwlowerid{aa\_phase}~\ocwlowerid{ph},[~2~],\ocwupperid{Euphony}~([~2;~43~],[~2~],~[~7~]))~$\ocweol
\ocwindent{11.50em}
::~$[~(\ocwlowerid{phase},\ocwlowerid{rword},\ocwupperid{Euphony}~(\ocwlowerid{w},\ocwlowerid{u},[~2~]))~::~\ocwlowerid{rest}~]~]~]$\ocweol
\ocwindent{5.50em}
$\ocwlowerid{where}~\ocwlowerid{new\_segment}~=~(\ocwlowerid{ph},\ocwupperid{Word.}\ocwlowerid{mirror}~[~7~::~\ocwlowerid{r}~],\ocwlowerid{rule})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"accrue\ocwvspace{}anomaly"}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~\ocwlowerid{segment}~::~\ocwlowerid{previous\_segments}~]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\label{graph_segmenter.ml:15105}%
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{backtrack}~=$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Choose}~$\ocwkw{of}~$\ocwlowerid{phase}~$\ocwkw{and}~$\ocwlowerid{input}~$\ocwkw{and}~$\ocwlowerid{output}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwkw{and}~$\ocwlowerid{choices}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Advance}~$\ocwkw{of}~$\ocwlowerid{phase}~$\ocwkw{and}~$\ocwlowerid{input}~$\ocwkw{and}~$\ocwlowerid{output}~$\ocwkw{and}~$\ocwupperid{Word.}\ocwlowerid{word}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{resumption}~=~$\ocwbt{list}~$\ocwlowerid{backtrack}~$\ocwbc{} coroutine resumptions \ocwec{}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Service routines of the segmenter 
\ocweol
\ocwindent{0.00em}
\ocwbegindcode{}$\ocwlowerid{access}~:~\ocwlowerid{phase}~\rightarrow{}~\ocwlowerid{word}~\rightarrow{}~$\ocwbt{option}~$(\ocwlowerid{auto}~\times{}~\ocwlowerid{word})$\ocwenddcode{} 
\ocweol
\label{graph_segmenter.ml:15408}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{access}~\ocwlowerid{phase}~=~\ocwlowerid{acc}~(\ocwlowerid{transducer}~\ocwlowerid{phase})~[\,]$\ocweol
\ocwindent{1.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{acc}~\ocwlowerid{state}~\ocwlowerid{w}~=~$\ocwkw{fun}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{Some}~(\ocwlowerid{state},\ocwlowerid{w})~$\ocwbc{} w is reverse of access input word \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{state}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~\ocwupperid{State}~(\ocwlowerid{\_},\ocwlowerid{deter},\ocwlowerid{\_})~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{ass}~\ocwlowerid{c}~\ocwlowerid{deter}~$\ocwkw{with}~\ocweol
\ocwindent{8.00em}
$[~\ocwupperid{Some}~\ocwlowerid{next\_state}~\rightarrow{}~\ocwlowerid{acc}~\ocwlowerid{next\_state}~[~\ocwlowerid{c}~::~\ocwlowerid{w}~]~\ocwlowerid{rest}$\ocweol
\ocwindent{8.00em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~\ocwupperid{None}~$\ocweol
\ocwindent{8.00em}
$]~$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} The scheduler gets its phase transitions from dispatcher \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{schedule}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{w}~\ocwlowerid{cont}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{add}~\ocwlowerid{phase}~\ocwlowerid{cont}~=~[~\ocwupperid{Advance}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{w}~::~\ocwlowerid{cont}~]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{transitions}~=~$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{accepting}~\ocwlowerid{phase}~\land{}~\lnot{}~\ocwlowerid{star.}\ocwlowerid{val}~$\ocwkw{then}~$[\,]~$\ocwbc{} Word = Sanskrit padas \ocwec{}~\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$\ocwlowerid{dispatch}~\ocwlowerid{full.}\ocwlowerid{val}~\ocwlowerid{w}~\ocwlowerid{phase}~$\ocwbc{} iterate Word+ \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{fold\_right}~\ocwlowerid{add}~\ocwlowerid{transitions}~\ocwlowerid{cont}~$\ocweol
\ocwindent{1.00em}
\ocwbc{} respects dispatch order within a fair top-down search \ocwec{}\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwbc{} The graph segmenter as a non deterministic reactive engine:
   \ocwbegindcode{}$\ocwlowerid{phase}$\ocwenddcode{} is the parsing phase
   \ocwbegindcode{}$\ocwlowerid{input}$\ocwenddcode{} is the input tape represented as a \ocwbegindcode{}$\ocwlowerid{word}$\ocwenddcode{}
   \ocwbegindcode{}$\ocwlowerid{output}$\ocwenddcode{} is the current result of type \ocwbegindcode{}$\ocwlowerid{output}$\ocwenddcode{}
   \ocwbegindcode{}$\ocwlowerid{back}$\ocwenddcode{} is the backtrack stack of type \ocwbegindcode{}$\ocwlowerid{resumption}$\ocwenddcode{}
   \ocwbegindcode{}$\ocwlowerid{occ}$\ocwenddcode{} is the current reverse access path in the deterministic part
   the last argument is the current state of type \ocwbegindcode{}$\ocwlowerid{auto}$\ocwenddcode{}. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Instead of functioning in coroutine with the Reader, one solution at a time,
   it computes all solutions, populating the graph structure for later display \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{react}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{back}~\ocwlowerid{occ}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{State}~(\ocwlowerid{accept},\ocwlowerid{det},\ocwlowerid{choices})~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwbc{} we try the deterministic space before the non deterministic one \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{deter}~\ocwlowerid{cont}~=~$\ocwkw{match}~$\ocwlowerid{input}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{continue}~\ocwlowerid{cont}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~\ocwlowerid{letter}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{ass}~\ocwlowerid{letter}~\ocwlowerid{det}~$\ocwkw{with}~\ocweol
\ocwindent{5.50em}
$[~\ocwupperid{Some}~\ocwlowerid{state}~\rightarrow{}$\ocweol
\ocwindent{6.50em}
$\ocwlowerid{react}~\ocwlowerid{phase}~\ocwlowerid{rest}~\ocwlowerid{output}~\ocwlowerid{cont}~[~\ocwlowerid{letter}~::~\ocwlowerid{occ}~]~\ocwlowerid{state}~$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{continue}~\ocwlowerid{cont}$\ocweol
\ocwindent{5.50em}
$]~$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{cont}~=~$\ocwkw{if}~$\ocwlowerid{choices}=[\,]~$\ocwkw{then}~$\ocwlowerid{back}~$\ocwbc{} non deterministic continuation \ocwec{}\ocweol
\ocwindent{7.50em}
\ocwkw{else}~$[~\ocwupperid{Choose}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{occ}~\ocwlowerid{choices}~::~\ocwlowerid{back}~]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwbc{} now we look for - or + segmentation pragma \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$(\ocwlowerid{keep},\ocwlowerid{cut},\ocwlowerid{input'})~=~$\ocwkw{match}~$\ocwlowerid{input}~$\ocwkw{with}~\ocweol
\ocwindent{3.50em}
$[~[~0~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwbc{} explicit \ocwstring{"\symbol{45}"} compound break hint \ocwec{}~\ocweol
\ocwindent{7.00em}
$(\ocwlowerid{ii\_phase}~\ocwlowerid{phase},\ocwupperid{True},\ocwlowerid{rest})~$\ocweol
\ocwindent{3.50em}
$\mid{}~[~-10~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwbc{} mandatory segmentation indicated by \ocwstring{"+"} \ocwec{}\ocweol
\ocwindent{7.00em}
$(\ocwupperid{True},\ocwupperid{True},\ocwlowerid{rest})$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~(\ocwupperid{True},\ocwupperid{False},\ocwlowerid{input})~$\ocwbc{} no hint in input \ocwec{}\ocweol
\ocwindent{3.50em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{accept}~\land{}~\ocwlowerid{keep}~$\ocwkw{then}~\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{segment}~=~(\ocwlowerid{phase},\ocwlowerid{occ},\ocwupperid{Id})~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{out}~=~\ocwlowerid{accrue}~\ocwlowerid{segment}~\ocwlowerid{output}~$\ocwkw{in}~\ocwkw{match}~$\ocwlowerid{validate}~\ocwlowerid{out}~$\ocwkw{with}~\ocweol
\ocwindent{3.50em}
$[~[\,]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{cut}~$\ocwkw{then}~$\ocwlowerid{continue}~\ocwlowerid{cont}~$\ocwkw{else}~$\ocwlowerid{deter}~\ocwlowerid{cont}$\ocweol
\ocwindent{3.50em}
$\mid{}~\ocwlowerid{contracted}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{input'}~$\ocwkw{with}\ocweol
\ocwindent{7.00em}
$[~[\,]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{accepting}~\ocwlowerid{phase}~$\ocwkw{then}~\ocwbc{} solution found \ocwec{}\ocweol
\ocwindent{12.50em}
\ocwkw{do}~\{~$\ocwlowerid{log\_chunk}~\ocwlowerid{contracted};~\ocwlowerid{continue}~\ocwlowerid{cont}~\}~$\ocweol
\ocwindent{11.00em}
\ocwkw{else}~$\ocwlowerid{continue}~\ocwlowerid{cont}~$\ocweol
\ocwindent{7.00em}
$\mid{}~[~\ocwlowerid{first}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwbc{} we first try the longest matching word \ocwec{}\ocweol
\ocwindent{11.00em}
\ocwkw{let}~$\ocwlowerid{cont'}~=~\ocwlowerid{schedule}~\ocwlowerid{phase}~\ocwlowerid{input'}~\ocwlowerid{contracted}~[\,]~\ocwlowerid{cont}~$\ocwkw{in}\ocweol
\ocwindent{11.00em}
\ocwkw{if}~$\ocwlowerid{cut}~$\ocwkw{then}~$\ocwlowerid{continue}~\ocwlowerid{cont'}~$\ocwkw{else}\ocweol
\ocwindent{11.00em}
\ocwkw{if}~$\ocwlowerid{check\_id\_sandhi}~\ocwlowerid{occ}~\ocwlowerid{first}~$\ocwkw{then}~\ocwbc{} legitimate Id \ocwec{}\ocweol
\ocwindent{12.50em}
$\ocwlowerid{deter}~\ocwlowerid{cont'}~$\ocwkw{else}~$\ocwlowerid{deter}~\ocwlowerid{cont}~$\ocweol
\ocwindent{7.00em}
$]$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{cut}~$\ocwkw{then}~$\ocwlowerid{continue}~\ocwlowerid{cont}~$\ocwkw{else}~$\ocwlowerid{deter}~\ocwlowerid{cont}~$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{choose}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{back}~\ocwlowerid{occ}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{continue}~\ocwlowerid{back}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~((\ocwlowerid{w},\ocwlowerid{u},\ocwlowerid{v})~$\ocwkw{as}~$\ocwlowerid{rule})~::~\ocwlowerid{others}~]~\rightarrow{}~$\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{cont}~=~$\ocwkw{if}~$\ocwlowerid{others}=[\,]~$\ocwkw{then}~$\ocwlowerid{back}$\ocweol
\ocwindent{9.00em}
\ocwkw{else}~$[~\ocwupperid{Choose}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{occ}~\ocwlowerid{others}~::~\ocwlowerid{back}~]~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{match}~$\ocwlowerid{subtract}~\ocwlowerid{input}~\ocwlowerid{w}~$\ocwkw{with}~\ocwbc{} try to read \ocwbegindcode{}$\ocwlowerid{w}$\ocwenddcode{} on \ocwbegindcode{}$\ocwlowerid{input}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{4.50em}
$[~\ocwupperid{Some}~\ocwlowerid{rest}~\rightarrow{}~$\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{segment}~=~(\ocwlowerid{phase},\ocwlowerid{u}~@~\ocwlowerid{occ},\ocwupperid{Euphony}~\ocwlowerid{rule})~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
\ocwkw{let}~$\ocwlowerid{out}~=~\ocwlowerid{accrue}~\ocwlowerid{segment}~\ocwlowerid{output}~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
\ocwkw{match}~$\ocwlowerid{validate}~\ocwlowerid{out}~$\ocwkw{with}\ocweol
\ocwindent{5.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{continue}~\ocwlowerid{cont}~$\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{contracted}~\rightarrow{}$\ocweol
\ocwindent{7.00em}
\ocwkw{if}~$\ocwlowerid{v}=[\,]~$\ocwbc{} final sandhi \ocwec{}~\ocwkw{then}\ocweol
\ocwindent{8.50em}
\ocwkw{if}~$\ocwlowerid{rest}=[\,]~\land{}~\ocwlowerid{accepting}~\ocwlowerid{phase}~$\ocwbc{} solution found \ocwec{}\ocweol
\ocwindent{10.00em}
\ocwkw{then}~\ocwkw{do}~\{~$\ocwlowerid{log\_chunk}~\ocwlowerid{contracted};~\ocwlowerid{continue}~\ocwlowerid{cont}~\}$\ocweol
\ocwindent{8.50em}
\ocwkw{else}~$\ocwlowerid{continue}~\ocwlowerid{cont}$\ocweol
\ocwindent{7.00em}
\ocwkw{else}~$\ocwlowerid{continue}~(\ocwlowerid{schedule}~\ocwlowerid{phase}~\ocwlowerid{rest}~\ocwlowerid{contracted}~\ocwlowerid{v}~\ocwlowerid{cont})$\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{continue}~\ocwlowerid{cont}$\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{continue}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~()~$\ocwbc{} Exploration finished \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{resume}~::~\ocwlowerid{back}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{resume}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Choose}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{occ}~\ocwlowerid{choices}~\rightarrow{}~$\ocweol
\ocwindent{5.00em}
$\ocwlowerid{choose}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{back}~\ocwlowerid{occ}~\ocwlowerid{choices}~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Advance}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{occ}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{access}~\ocwlowerid{phase}~\ocwlowerid{occ}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{continue}~\ocwlowerid{back}~$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Some}~(\ocwlowerid{state},\ocwlowerid{v})~\rightarrow{}~\ocwlowerid{react}~\ocwlowerid{phase}~\ocwlowerid{input}~\ocwlowerid{output}~\ocwlowerid{back}~\ocwlowerid{v}~\ocwlowerid{state}$\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{3.00em}
$]~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwbc{} CAUTION - This \ocwbegindcode{}$\ocwlowerid{continue}$\ocwenddcode{} is completely different from the old \ocwbegindcode{}$\ocwlowerid{continue}$\ocwenddcode{}
from Segmenter. It does not return one solution at a time in coroutine manner, 
but sweeps the whole solution space. In particular, it returns () rather than 
an optional solution. \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{init\_segment\_initial}~\ocwlowerid{entries}~\ocwlowerid{sentence}~=~$\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{map}~($\ocwkw{fun}~$\ocwlowerid{phase}~\rightarrow{}~\ocwupperid{Advance}~\ocwlowerid{phase}~\ocwlowerid{sentence}~[\,]~[\,])~\ocwlowerid{entries}$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwbc{} Works for Complete as well as Simplified mode \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{segment1}~\ocwlowerid{chunk}~=~\ocwlowerid{continue}~(\ocwlowerid{init\_segment\_initial}~(\ocwlowerid{initial}~\ocwlowerid{full.}\ocwlowerid{val})~\ocwlowerid{chunk})~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{segment}~\ocwlowerid{chunk}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{segment1}~\ocwlowerid{chunk}~$\ocwbc{} does not assume Complete mode \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{cur\_chunk.}\ocwlowerid{segmentable}~\lor{}~$\ocwkw{do}~\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{graph}.(\ocwlowerid{cur\_chunk.}\ocwlowerid{offset})~:=~[~(\ocwlowerid{unknown},[~(\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{chunk},[\,])~])~]$\ocweol
\ocwindent{2.00em}
;~$\ocwupperid{False}~$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Splitting checkpoints into current and future ones \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{split\_check}~\ocwlowerid{limit}~=~\ocwlowerid{split\_rec}~[\,]$\ocweol
\ocwindent{1.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{split\_rec}~\ocwlowerid{acc}~\ocwlowerid{checkpts}~=~$\ocwkw{match}~$\ocwlowerid{checkpts}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~(\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{acc},[\,])$\ocweol
\ocwindent{3.00em}
$\mid{}~[~((\ocwlowerid{index},\ocwlowerid{\_},\ocwlowerid{\_})~$\ocwkw{as}~$\ocwlowerid{check})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{index}~>~\ocwlowerid{limit}~$\ocwkw{then}~$(\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{acc},\ocwlowerid{checkpts})$\ocweol
\ocwindent{5.00em}
\ocwkw{else}~$\ocwlowerid{split\_rec}~[~\ocwlowerid{check}~::~\ocwlowerid{acc}~]~\ocwlowerid{rest}~$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We do not need to \ocwbegindcode{}$\ocwlowerid{dove\_tail}$\ocwenddcode{} like in Rank, since chunks are independent. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Returns a pair (b,n) where b is True if all chunks are segmentable so far,
   and n is the number of potential solutions \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{segment\_all}~=~\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{segment\_chunk}~(\ocwupperid{True},\ocwupperid{Num.Int}~1)$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~\ocwlowerid{segment\_chunk}~(\ocwlowerid{flag},\ocwlowerid{count})~\ocwlowerid{chunk}~=~$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{extremity}~=~\ocwlowerid{cur\_chunk.}\ocwlowerid{offset}+\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{chunk}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$(\ocwlowerid{local},\ocwlowerid{future})~=~\ocwlowerid{split\_check}~\ocwlowerid{extremity}~\ocwlowerid{chkpts.}\ocwlowerid{all\_checks}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{chkpts.}\ocwlowerid{segment\_checks}~:=~\ocwlowerid{local}$\ocweol
\ocwindent{2.00em}
;~\ocwkw{let}~$\ocwlowerid{segmentable}~=~\ocwlowerid{segment}~\ocwlowerid{chunk}~$\ocweol
\ocwindent{3.00em}
\ocwkw{and}~$\ocwlowerid{local\_count}~=~\ocwlowerid{get\_counter}~()~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{set\_segmentable}~\ocwupperid{False}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{set\_offset}~(\ocwlowerid{succ}~\ocwlowerid{extremity},\ocwlowerid{future})$\ocweol
\ocwindent{3.00em}
;~\ocwkw{if}~$\ocwlowerid{segmentable}~$\ocwkw{then}~\ocwkw{do}\ocweol
\ocwindent{5.50em}
\{~$\ocwlowerid{reset\_counter}~()$\ocweol
\ocwindent{5.50em}
;~$(\ocwlowerid{flag},\ocwupperid{Num.}\ocwlowerid{mult\_num}~\ocwlowerid{count}~(\ocwupperid{Num.Int}~\ocwlowerid{local\_count}))$\ocweol
\ocwindent{6.50em}
\ocwbc{} we have \ocwbegindcode{}$\ocwlowerid{local\_count}$\ocwenddcode{} segmentations of the local \ocwbegindcode{}$\ocwlowerid{chunk}$\ocwenddcode{}, and,
              chunks being independent, the total number of solutions multiply \ocwec{}\ocweol
\ocwindent{5.50em}
\}\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$(\ocwupperid{False},\ocwlowerid{count})~$\ocwbc{} unsegmentable chunk \ocwec{}~\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\label{graph_segmenter.ml:21987}%
\ocwindent{0.00em}
\ocwkw{end};~\ocwbc{} Segment \ocwec{}\ocweol
\ocwendcode{}\typeout{OcamlWeb file Automaton.ml}
\ocwmodule{Automaton}
\label{automaton.ml:0}%
\label{automaton.ml:654}%
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Canon};~$\ocwbc{} decode rdecode \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phonetics};~$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Auto.Auto};~$\ocwbc{} rule auto stack \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Deco};$\medskip

\ocwendcode{}\ocwindent{0.00em}
Generalises the structure of trie, seen as a representation of
   deterministic automaton (recognizer for prefix-shared set of strings),
   into the graph of a non-deterministic automaton, chaining external 
   sandhi with recognition of inflected forms from the inflected lexicon. 
\ocweol
\ocwindent{0.00em}
Algorithm. For every inflected form \ocwbegindcode{}$\ocwlowerid{f}$\ocwenddcode{}, and for every external sandhi rule 
   \ocwbegindcode{}$\ocwlowerid{r}:~\ocwlowerid{u}\mid{}\ocwlowerid{v}~\rightarrow{}~\ocwlowerid{w}$\ocwenddcode{} such that \ocwbegindcode{}$\ocwlowerid{f}=\ocwlowerid{x}.\ocwlowerid{u}$\ocwenddcode{}, construct a choice point from state \ocwbegindcode{}$\ocwupperid{S}~\ocwlowerid{x}$\ocwenddcode{}
   to an iterating block B(r). \ocwbegindcode{}$\ocwupperid{S}~\ocwlowerid{x}$\ocwenddcode{} is the state reachable from the initial 
   state (top of the trie) by input \ocwbegindcode{}$\ocwlowerid{x}$\ocwenddcode{}, going on the deterministic subgraph, 
   copy of the trie. The set of iterating blocks pertaining to a node are 
   grouped in a list of non-deterministic choice points. 
\ocweol
\ocwindent{0.00em}
Parser operation. The parser traverses the state tree while scanning the
   input. Assume it is at state \ocwbegindcode{}$\ocwupperid{S}~\ocwlowerid{x}$\ocwenddcode{} looking at input \ocwbegindcode{}$\ocwlowerid{z}$\ocwenddcode{}. It has the choice
   of either staying in the deterministic part (word lookup) by going to the
   deterministic transition corresponding to the first symbol in \ocwbegindcode{}$\ocwlowerid{z}$\ocwenddcode{}, with no
   output, or else choosing in the non-deterministic part a choice block B(r)
   as an epsilon move (no scanning of \ocwbegindcode{}$\ocwlowerid{z}$\ocwenddcode{}), and then, with \ocwbegindcode{}$\ocwlowerid{r}:~\ocwlowerid{u}\mid{}\ocwlowerid{v}~\rightarrow{}~\ocwlowerid{w}$\ocwenddcode{}, 
   recognize that \ocwbegindcode{}$\ocwlowerid{w}$\ocwenddcode{} is a prefix of \ocwbegindcode{}$\ocwlowerid{z}$\ocwenddcode{} (scan it or else backtrack), emit the
   parse trace \ocwbegindcode{}$<\ocwlowerid{f}\ensuremath{>}-\ocwlowerid{r}-$\ocwenddcode{} where \ocwbegindcode{}$\ocwlowerid{f}=\ocwlowerid{inflected}(\ocwlowerid{x}.\ocwlowerid{u})$\ocwenddcode{}, and iterate by jumping to 
   state \ocwbegindcode{}$\ocwupperid{S}~\ocwlowerid{v}$\ocwenddcode{} (we assume that sandhi rules are stripped so that \ocwbegindcode{}$\ocwupperid{S}~\ocwlowerid{v}$\ocwenddcode{} always 
   exists).
   A stack of \ocwbegindcode{}$(\ocwlowerid{choices},\ocwlowerid{input\_index})$\ocwenddcode{} permits to backtrack on input failure.
   The final sandhi rules \ocwbegindcode{}$\ocwlowerid{u}\mid{}\#~\rightarrow{}~\ocwlowerid{y}$\ocwenddcode{} are treated similarly, with \# matching
   end of input, but instead of jumping we accept and propose the parse trace
   as a legal tagging of the sentence (with possible continuation into 
   backtracking for additional solutions). On backtracking a stack of failed
   attempts may be kept, in order to restart gracefully when a word is 
   missing from the lexicon. This robustification will be essential to turn
   the parser into a bootstrapping lexicon acquisition device. 
\ocweol
\ocwindent{0.00em}
{\bf Construction of the automaton.} 
\ocweol
\ocwindent{0.00em}
Remark that it is linear in one bottom-up traversal of the inflected trie. 
\ocweol
\label{automaton.ml:2924}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{rules}~=~$\ocwbt{array}~$\ocwlowerid{stack}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} A sandhi entry is a list \ocwbegindcode{}[$\ocwlowerid{l1};~\ocwlowerid{l2};~...~\ocwlowerid{ln}]~$\ocwkw{with}~$\ocwlowerid{li}=[\ocwlowerid{si1};~\ocwlowerid{si2};~...~\ocwlowerid{sini}]$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} with \ocwbegindcode{}$\ocwlowerid{sij}=(\ocwlowerid{c1},\ocwlowerid{c2},\ocwlowerid{c3})~\ocwlowerid{where}~\ocwlowerid{c1}=\ocwlowerid{code}~\ocwlowerid{w},~\ocwlowerid{c2}=\ocwlowerid{rev}~(\ocwlowerid{code}~\ocwlowerid{u}),~\ocwlowerid{c3}=\ocwlowerid{code}~\ocwlowerid{v}~$\ocwenddcode{}       \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} such that \ocwbegindcode{}$\ocwlowerid{u}\mid{}\ocwlowerid{v}~\rightarrow{}~\ocwlowerid{w}$\ocwenddcode{} by external sandhi, with \ocwbegindcode{}$\ocwlowerid{i}=|\ocwlowerid{u}|]~\times{})
(\times{}~[\ocwlowerid{sandhis}]~\ocwlowerid{concerns}~\ocwlowerid{u}~\ocwlowerid{ended}~\ocwlowerid{by}~\ocwlowerid{s}~\lor{}~.\ocwlowerid{h},~$\ocwkw{and}~$\ocwlowerid{i}~=~1~\lor{}~2~\times{})
(\times{}~[\ocwlowerid{sandhir}]~\ocwlowerid{concerns}~\ocwlowerid{u}~\ocwlowerid{ended}~\ocwlowerid{by}~\ocwlowerid{r},~$\ocwkw{and}~$\ocwlowerid{i}~=~1~\lor{}~2~\times{})
(\times{}~[\ocwlowerid{sandhin}]~\ocwlowerid{concerns}~\ocwlowerid{u}~\ocwlowerid{ended}~\ocwlowerid{by}~\ocwlowerid{n},~$\ocwkw{and}~$\ocwlowerid{i}~=~1~\lor{}~2~\times{})
(\times{}~[\ocwlowerid{sandhif}]~\ocwlowerid{concerns}~\ocwlowerid{u}~\ocwlowerid{ended}~\ocwlowerid{by}~\ocwlowerid{f},~$\ocwkw{and}~$\ocwlowerid{i}~=~1~\lor{}~2~\times{})
(\times{}~[\ocwlowerid{sandhio}]~\ocwlowerid{concerns}~\ocwlowerid{u}~\ocwlowerid{ended}~\ocwlowerid{by}~\ocwlowerid{other}~\ocwlowerid{letters},~$\ocwkw{and}~$\ocwlowerid{i}~=~1~\times{})$\ocwenddcode{}\medskip

\ocwendcode{}\ocwindent{0.00em}
We read sandhi rules compiled by \ocwbegindcode{}$\ocwlowerid{compile\_sandhi}$\ocwenddcode{} 
\ocweol
\label{automaton.ml:3640}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~(\ocwlowerid{sandhis},~\ocwlowerid{sandhir},~\ocwlowerid{sandhin},~\ocwlowerid{sandhif},~\ocwlowerid{sandhio})~=~$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwupperid{Web.}\ocwlowerid{sandhis\_file}~:~(\ocwlowerid{rules}~\times{}~\ocwlowerid{rules}~\times{}~\ocwlowerid{rules}~\times{}~\ocwlowerid{rules}~\times{}~\ocwlowerid{rules}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{get\_sandhi}~=~$\ocwkw{fun}~\ocwbc{} argument is \ocwbegindcode{}$\ocwlowerid{mirror}~(\ocwlowerid{code}~\ocwlowerid{u})$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"get\_sandhi\ocwvspace{}0"}\ocweol
\ocwindent{1.00em}
$\mid{}~[~43~$\ocwbc{} r \ocwec{}~::~$\ocwlowerid{before}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"get\_sandhi\ocwvspace{}1"}\ocweol
\ocwindent{4.00em}
$\mid{}~[~\ocwlowerid{penu}~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{sandhir}.(\ocwlowerid{penu})$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~[~48~$\ocwbc{} s \ocwec{}~::~$\ocwlowerid{before}~]~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~16~$\ocwbc{} .h \ocwec{}~::~$\ocwlowerid{before}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"get\_sandhi\ocwvspace{}2"}\ocweol
\ocwindent{4.00em}
$\mid{}~[~\ocwlowerid{penu}~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{sandhis}.(\ocwlowerid{penu})$\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~36~$\ocwbc{} n \ocwec{}~::~$\ocwlowerid{before}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"get\_sandhi\ocwvspace{}3"}\ocweol
\ocwindent{4.00em}
$\mid{}~[~\ocwlowerid{penu}~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{sandhin}.(\ocwlowerid{penu})$\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~21~$\ocwbc{} f \ocwec{}~::~$\ocwlowerid{before}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{before}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"get\_sandhi\ocwvspace{}4"}~\ocweol
\ocwindent{4.00em}
$\mid{}~[~\ocwlowerid{penu}~::~\ocwlowerid{\_}~]~\rightarrow{}~\ocwlowerid{sandhif}.(\ocwlowerid{penu})~$\ocweol
\ocwindent{4.00em}
$]~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{\_}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{c}~<~0~$\ocwkw{then}~$\ocwlowerid{failwith}~$\ocwstring{"get\_sandhi\ocwvspace{}5"}\ocweol
\ocwindent{9.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{c}~>~49~$\ocwkw{then}~$\ocwlowerid{failwith}~$\ocwstring{"get\_sandhi\ocwvspace{}6"}\ocweol
\ocwindent{9.00em}
\ocwkw{else}~$\ocwlowerid{sandhio}.(\ocwlowerid{c})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Same as \ocwbegindcode{}$\ocwupperid{Compile\_sandhi}.\ocwlowerid{merge}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{merge}~\ocwlowerid{st1}~\ocwlowerid{st2}~=~$\ocwkw{match}~$\ocwlowerid{st1}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{st2}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{l1}~::~\ocwlowerid{r1}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{st2}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{st1}$\ocweol
\ocwindent{3.00em}
$\mid{}~[~\ocwlowerid{l2}~::~\ocwlowerid{r2}~]~\rightarrow{}~[~(\ocwupperid{List2.}\ocwlowerid{union}~\ocwlowerid{l1}~\ocwlowerid{l2})~::~(\ocwlowerid{merge}~\ocwlowerid{r1}~\ocwlowerid{r2})~]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We add to the stack arrays a deco rewrite set \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
A rewrite deco maps revu to a list of rules (w,revu,v) 
\ocweol
\label{automaton.ml:4967}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{rewrite\_set}~=~\ocwupperid{Deco.}\ocwlowerid{deco}~\ocwlowerid{rule}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{project}~\ocwlowerid{n}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deco}~(\ocwlowerid{\_},\ocwlowerid{arcs})~\rightarrow{}~$\ocwkw{try}~$\ocwupperid{List.}\ocwlowerid{assoc}~\ocwlowerid{n}~\ocwlowerid{arcs}~$\ocweol
\ocwindent{10.50em}
\ocwkw{with}~$[~\ocwupperid{Not\_found}~\rightarrow{}~\ocwlowerid{empty}~]~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{get\_rules}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Deco}~(\ocwlowerid{rules},\ocwlowerid{\_})~\rightarrow{}~\ocwlowerid{rules}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Union of two decos \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{merger}~\ocwlowerid{d1}~\ocwlowerid{d2}~=~$\ocwkw{match}~$\ocwlowerid{d1}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Deco}~(\ocwlowerid{i1},\ocwlowerid{l1})~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{d2}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Deco}~(\ocwlowerid{i2},\ocwlowerid{l2})~\rightarrow{}~\ocwupperid{Deco}~(\ocwlowerid{i1}~@~\ocwlowerid{i2},~\ocwlowerid{mrec}~\ocwlowerid{l1}~\ocwlowerid{l2})$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{mrec}~\ocwlowerid{l1}~\ocwlowerid{l2}~=~$\ocwkw{match}~$\ocwlowerid{l1}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{l2}~$\ocweol
\ocwindent{2.00em}
$\mid{}~[~(\ocwlowerid{n},\ocwlowerid{d})~::~\ocwlowerid{l}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{l2}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{l1}$\ocweol
\ocwindent{2.00em}
$\mid{}~[~(\ocwlowerid{n'},\ocwlowerid{d'})~::~\ocwlowerid{l'}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{n}<\ocwlowerid{n'}~$\ocwkw{then}~$[~(\ocwlowerid{n},\ocwlowerid{d})~::~\ocwlowerid{mrec}~\ocwlowerid{l}~\ocwlowerid{l2}~]~$\ocweol
\ocwindent{13.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{n'}<\ocwlowerid{n}~$\ocwkw{then}~$[~(\ocwlowerid{n'},\ocwlowerid{d'})~::~\ocwlowerid{mrec}~\ocwlowerid{l1}~\ocwlowerid{l'}~]$\ocweol
\ocwindent{16.00em}
\ocwkw{else}~$[~(\ocwlowerid{n},~\ocwlowerid{merger}~\ocwlowerid{d}~\ocwlowerid{d'})~::~\ocwlowerid{mrec}~\ocwlowerid{l}~\ocwlowerid{l'}~]$\ocweol
\ocwindent{2.00em}
$]~]~]~]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
{\bf Automaton construction with state minimization.} 
\ocweol
\label{automaton.ml:5710}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{hash\_max}~=~9689~$\ocwbc{} Mersenne 21 \ocwec{}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{exception}~$\ocwupperid{Overlap}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Auto}~=~\ocwupperid{Share.Share}~($\ocwkw{struct}~\ocwkw{type}~$\ocwlowerid{domain}=\ocwlowerid{auto};~\ocwlowerid{value}~\ocwlowerid{size}=\ocwlowerid{hash\_max};~$\ocwkw{end}$)$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Remark - it would be incorrect to share states \ocwbegindcode{}$\ocwupperid{State}~(\ocwlowerid{b},\ocwlowerid{d},\ocwlowerid{nd})$\ocwenddcode{} having the 
   same \ocwbegindcode{}$\ocwlowerid{b}$\ocwenddcode{} and \ocwbegindcode{}$\ocwlowerid{d}$\ocwenddcode{}, since \ocwbegindcode{}$\ocwlowerid{nd}$\ocwenddcode{} may depend on upper nodes because of 
   contextual rules. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{hash0}~=~1$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{hash1}~\ocwlowerid{letter}~\ocwlowerid{key}~\ocwlowerid{sum}~=~\ocwlowerid{sum}~+~\ocwlowerid{letter}\times{}\ocwlowerid{key}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{hash}~\ocwlowerid{b}~\ocwlowerid{arcs}~\ocwlowerid{rules}~=~$\ocwbc{} NB. \ocwbegindcode{}$\ocwlowerid{abs}$\ocwenddcode{} needed because possible integer overflow \ocwec{}\ocweol
\ocwindent{2.00em}
$(\ocwlowerid{abs}~(\ocwlowerid{arcs}~+~\ocwupperid{Gen.}\ocwlowerid{dirac}~\ocwlowerid{b}~+~\ocwupperid{List.}\ocwlowerid{length}~\ocwlowerid{rules}))~$\ocwkw{mod}~$\ocwlowerid{hash\_max}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_auto}~(\ocwlowerid{rewrite}~:~\ocwlowerid{rewrite\_set})~=~\ocwlowerid{traverse}$\ocweol
\ocwindent{1.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{traverse}:~\ocwlowerid{word}~\rightarrow{}~\ocwlowerid{lexicon}~\rightarrow{}~(\ocwlowerid{auto}~\times{}~\ocwlowerid{stack}~\times{}~\ocwlowerid{rewrite\_set}~\times{}~$\ocwbt{int}$)$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} The occurrence list \ocwbegindcode{}$\ocwlowerid{occ}$\ocwenddcode{} is the reverse of the access word. \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{traverse}~\ocwlowerid{occ}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Trie.Trie}~(\ocwlowerid{b},\ocwlowerid{arcs})~\rightarrow{}~$\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{local\_stack}~=~$\ocwkw{if}~$\ocwlowerid{b}~$\ocwkw{then}~$\ocwlowerid{get\_sandhi}~\ocwlowerid{occ}~$\ocwkw{else}~$[\,]~$\ocweol
\ocwindent{2.50em}
\ocwkw{and}~$\ocwlowerid{local\_rewrite}~=~$\ocwkw{if}~$\ocwlowerid{b}~$\ocwkw{then}~$\ocwlowerid{rewrite}~$\ocwkw{else}~$\ocwlowerid{empty}~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{f}~(\ocwlowerid{deter},~\ocwlowerid{stack},~\ocwlowerid{rewrite},~\ocwlowerid{span})~(\ocwlowerid{n},\ocwlowerid{t})~=~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{current}~=~[~\ocwlowerid{n}~::~\ocwlowerid{occ}~]~$\ocwkw{in}~\ocwbc{} current occurrence \ocwec{}\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$(\ocwlowerid{auto},~\ocwlowerid{st},~\ocwlowerid{rew},~\ocwlowerid{k})~=~\ocwlowerid{traverse}~\ocwlowerid{current}~\ocwlowerid{t}~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$([~(\ocwlowerid{n},~\ocwlowerid{auto})~::~\ocwlowerid{deter}~],~\ocwlowerid{merge}~\ocwlowerid{st}~\ocwlowerid{stack},~$\ocweol
\ocwindent{5.00em}
$\ocwlowerid{merger}~(\ocwlowerid{project}~\ocwlowerid{n}~\ocwlowerid{rew})~\ocwlowerid{rewrite},~\ocwlowerid{hash1}~\ocwlowerid{n}~\ocwlowerid{k}~\ocwlowerid{span})~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$(\ocwlowerid{deter},~\ocwlowerid{stack},~\ocwlowerid{rewrite},~\ocwlowerid{span})~=~$\ocweol
\ocwindent{4.50em}
$\ocwupperid{List.}\ocwlowerid{fold\_left}~\ocwlowerid{f}~([\,],[\,],\ocwlowerid{local\_rewrite},\ocwlowerid{hash0})~\ocwlowerid{arcs}~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$(\ocwlowerid{h},\ocwlowerid{l})~=~$\ocwkw{match}~$\ocwlowerid{stack}~$\ocwkw{with}\ocweol
\ocwindent{4.50em}
$[~[\,]~\rightarrow{}~([\,],[\,])~\mid{}~[~\ocwlowerid{h}~::~\ocwlowerid{l}~]~\rightarrow{}~(\ocwlowerid{h},\ocwlowerid{l})~]~$\ocwkw{in}\ocweol
\ocwindent{5.50em}
\ocwbc{} the tail \ocwbegindcode{}$\ocwlowerid{l}$\ocwenddcode{} of \ocwbegindcode{}$\ocwlowerid{stack}$\ocwenddcode{} initialises the stack for upper nodes,
              its head \ocwbegindcode{}$\ocwlowerid{h}$\ocwenddcode{} contains the list of current choice points     \ocwec{}~\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{key}~=~\ocwlowerid{hash}~\ocwlowerid{b}~\ocwlowerid{span}~\ocwlowerid{h}~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
\ocwkw{let}~$\ocwlowerid{s}~=~\ocwupperid{Auto.}\ocwlowerid{share}~(\ocwupperid{State}~(\ocwlowerid{b},\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{deter},\ocwlowerid{get\_rules}~\ocwlowerid{rewrite}~@~\ocwlowerid{h}))~\ocwlowerid{key}~$\ocwkw{in}\ocweol
\ocwindent{2.50em}
$(\ocwlowerid{s},~\ocwlowerid{merge}~\ocwlowerid{local\_stack}~\ocwlowerid{l},~\ocwlowerid{rewrite},~\ocwlowerid{key})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{}  *** IMPORTANT ***
The arcs in deter are in decreasing order, because of \ocwbegindcode{}$\ocwlowerid{fold\_left}$\ocwenddcode{}.
We put them back in increasing order by \ocwbegindcode{}$\ocwupperid{List}.\ocwlowerid{rev}~\ocwlowerid{deter}$\ocwenddcode{}. This is not strictly
needed, and order of siblings is not important since access is done with \ocwbegindcode{}$\ocwlowerid{assoc}$\ocwenddcode{}.
However, it is crucial to maintain proper order for operations such as \ocwbegindcode{}$\ocwlowerid{split}$\ocwenddcode{},
which splits an automaton into vowel-initial and consonant-initial subparts. 
Thus reversal was enforced when split was introduced in V2.43. \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Compile builds a tagging transducer from a lexicon index. 
\ocweol
\ocwindent{0.00em}
\ocwbegindcode{}$\ocwlowerid{compile}~:~$\ocwbt{bool}~$\rightarrow{}~\ocwlowerid{rewrites}~\rightarrow{}~\ocwupperid{Trie}.\ocwlowerid{trie}~\rightarrow{}~\ocwupperid{Auto}.\ocwlowerid{auto}$\ocwenddcode{} 
\ocweol
\label{automaton.ml:7990}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{compile}~\ocwlowerid{rewrite}~\ocwlowerid{lexicon}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{transducer},~\ocwlowerid{stack},~\ocwlowerid{\_},~\ocwlowerid{\_})~=~\ocwlowerid{build\_auto}~\ocwlowerid{rewrite}~[\,]~\ocwlowerid{lexicon}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{stack}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{transducer}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwbc{} Error: some sandhi rule has action beyond one word in the lexicon \ocwec{}\ocweol
\ocwindent{4.50em}
$\ocwlowerid{raise}~\ocwupperid{Overlap}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Interface.mli}
\ocwinterface{Interface}
\label{interface.mli:0}%
Sanskrit Reader Summarizing interface. 
\ocweol
\ocwindent{0.00em}
Similar design to Segmenter and Lexer, but records recognized segments
  represented in a shared graph with their offset with respect to the input 
  sentence. 
\ocweol
\label{interface.mli:831}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Interface}~:~$\ocwkw{sig}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{safe\_engine}~:~$\ocwbt{unit}~$\rightarrow{}~$\ocwbt{unit};\ocweol
\ocwindent{0.00em}
\ocwkw{end};\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Interface.ml}
\ocwmodule{Interface}
\label{interface.ml:0}%
Sanskrit Reader Summarizing interface. 
\ocweol
\ocwindent{0.00em}
We construct a CGI Interface displaying the segmentation graph in which the 
   user may indicate segments as mandatory checkpoints. At any point he may
   call the standard displaying of all, or of preferred solutions consistent 
   with the current checkpoints. An undo button allows backtracking. 
\ocweol
\label{interface.ml:972}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Interface}~=~$\ocwkw{struct}\medskip

\label{interface.ml:999}%
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Graph\_segmenter};~$\ocwbc{} \ocwbegindcode{}$\ocwupperid{Segment}~\ocwlowerid{cur\_chunk}~\ocwlowerid{set\_cur\_offset}~\ocwlowerid{graph}~\ocwlowerid{visual}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phases};~$\ocwbc{} \ocwbegindcode{}$\ocwupperid{Phases}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phases};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{phase}~\ocwlowerid{is\_cache}~\ocwlowerid{generative}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Dispatcher};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{transducer\_vect}~\ocwlowerid{phase}~\ocwupperid{Dispatch}~\ocwlowerid{transition}~\ocwlowerid{trim\_tags}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};~$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{ps}~\ocwlowerid{pl}~\ocwlowerid{abort}~\ocwlowerid{reader\_cgi}~\ocwlowerid{scl\_toggle}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Cgi};$\medskip

\label{interface.ml:1311}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Prel}~=~$\ocwkw{struct}~\ocwbc{} Interface's lexer prelude \ocwec{}\medskip

\label{interface.ml:1365}%
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{prelude}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{http\_header}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_begin}~\ocwlowerid{graph\_meta\_title}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{body\_begin}~\ocwupperid{Chamois\_back})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{interface\_title}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{h3\_begin}~\ocwupperid{C3}~$\^{}~\ocwstring{"Click\ocwvspace{}on\ocwvspace{}"}~\^{}~$\ocwlowerid{html\_green}~\ocwlowerid{check\_sign}~$\ocweol
\ocwindent{10.00em}
\^{}~\ocwstring{"\ocwvspace{}to\ocwvspace{}select\ocwvspace{}segment,\ocwvspace{}click\ocwvspace{}on\ocwvspace{}"}~\^{}~$\ocwlowerid{html\_red}~\ocwlowerid{x\_sign}~$\ocweol
\ocwindent{10.00em}
\^{}~\ocwstring{"\ocwvspace{}to\ocwvspace{}rule\ocwvspace{}out\ocwvspace{}segment"}~\^{}~$\ocwlowerid{h3\_end})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{h3\_begin}~\ocwupperid{C3}~$\^{}~$\ocwlowerid{mouse\_action\_help}~$\ocweol
\ocwindent{10.00em}
\^{}~\ocwstring{"\ocwvspace{}on\ocwvspace{}segment\ocwvspace{}to\ocwvspace{}get\ocwvspace{}its\ocwvspace{}lemma"}~\^{}~$\ocwlowerid{h3\_end})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{open\_page\_with\_margin}~15$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.50em}
\ocwkw{end}~\ocwbc{} Prel \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Service routines for morphological query, loading the morphology banks \ocwec{}\medskip

\label{interface.ml:1918}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Lemmas}~=~\ocwupperid{Load\_morphs.Morphs}~\ocwupperid{Prel}~\ocwupperid{Phases}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Lemmas}~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{tags\_of}~\ocwlowerid{morpho}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Load\_transducers}~$\ocwbc{} \ocwbegindcode{}$\ocwupperid{Trans}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Transducers}~=~\ocwupperid{Trans}~\ocwupperid{Prel}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Machine}~=~\ocwupperid{Dispatch}~\ocwupperid{Transducers}~\ocwupperid{Lemmas}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Machine}~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{cache\_phase}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} At this point we have a Finite Eilenberg machine ready to instantiate \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} the Eilenberg component of the Segment module.                        \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Viccheda sandhi splitting 
\ocweol
\ocwindent{0.00em}
Global parameters of the lexer 
\ocweol
\label{interface.ml:2383}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{iterate}~=~$\ocwbt{ref}~$\ocwupperid{True}~$\ocwbc{} by default a chunk is a list of words \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{complete}~=~$\ocwbt{ref}~$\ocwupperid{True}~$\ocwbc{} by default we call the complete segmenter \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{output\_channel}~=~$\ocwbt{ref}~$\ocwlowerid{stdout}~$\ocwbc{} by default cgi output on standard output \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Segment\_control}~=~$\ocwkw{struct}\ocweol
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{star}~=~\ocwlowerid{iterate};~$\ocwbc{} vaakya vs pada \ocwec{}\ocweol
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{full}~=~\ocwlowerid{complete};~$\ocwbc{} complete vs simplified \ocwec{}\ocweol
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{out\_chan}~=~\ocwlowerid{output\_channel}$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwkw{end}~\ocwbc{} \ocwbegindcode{}$\ocwupperid{Segment\_control}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Viccheda}~=~\ocwupperid{Segment}~\ocwupperid{Phases}~\ocwupperid{Machine}~\ocwupperid{Segment\_control}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Viccheda}~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{segment\_all}~\ocwlowerid{visual\_width}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} At this point we have the sandhi inverser segmenting engine \ocwec{}\medskip

\ocwendcode{}\ocwindent{0.00em}
Separates tags of homophonous segments vertically 
\ocweol
\label{interface.ml:3038}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fold\_vert}~\ocwlowerid{f}~=~\ocwlowerid{fold}~1~\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{fold}~\ocwlowerid{n}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~()~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{x}~]~\rightarrow{}~\ocwlowerid{f}~\ocwlowerid{n}~\ocwlowerid{x}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{x}~::~\ocwlowerid{l}~]~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{f}~\ocwlowerid{n}~\ocwlowerid{x};~\ocwlowerid{ps}~\ocwlowerid{html\_break};~\ocwlowerid{fold}~(\ocwlowerid{n}+1)~\ocwlowerid{l}~\}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_morph}~\ocwlowerid{pvs}~\ocwlowerid{seg\_num}~\ocwlowerid{cached}~\ocwlowerid{gen}~\ocwlowerid{form}~\ocwlowerid{n}~\ocwlowerid{tag}~=~$\ocweol
\ocwindent{1.00em}
$\ocwupperid{Morpho\_html.}\ocwlowerid{print\_graph\_link}~\ocwlowerid{pvs}~\ocwlowerid{cached}~\ocwlowerid{form}~(\ocwlowerid{seg\_num},\ocwlowerid{n})~\ocwlowerid{gen}~\ocwlowerid{tag}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} tags : Morphology.multitag is the multi-tag of the form of a given phase \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_tags}~\ocwlowerid{pvs}~\ocwlowerid{seg\_num}~\ocwlowerid{phase}~\ocwlowerid{form}~\ocwlowerid{tags}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{gen}~=~\ocwlowerid{generative}~\ocwlowerid{phase}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{cached}~=~\ocwlowerid{is\_cache}~\ocwlowerid{phase}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{ok\_tags}~=~$\ocwkw{if}~$\ocwlowerid{pvs}~=~[\,]~$\ocwkw{then}~$\ocwlowerid{tags}~$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~$\ocwlowerid{trim\_tags}~(\ocwlowerid{generative}~\ocwlowerid{phase})~\ocwlowerid{form}~(\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{pvs})~\ocwlowerid{tags}$\ocweol
\ocwindent{1.00em}
\ocwbc{} NB Existence of the segment warrants that \ocwbegindcode{}$\ocwlowerid{ok\_tags}$\ocwenddcode{} is not empty \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{ptag}~=~\ocwlowerid{print\_morph}~\ocwlowerid{pvs}~\ocwlowerid{seg\_num}~\ocwlowerid{cached}~\ocwlowerid{gen}~\ocwlowerid{form}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{fold\_vert}~\ocwlowerid{ptag}~\ocwlowerid{ok\_tags}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_morph\_tad}~\ocwlowerid{pvs}~\ocwlowerid{seg\_num}~\ocwlowerid{cache}~\ocwlowerid{gen}~\ocwlowerid{stem}~\ocwlowerid{sfx}~\ocwlowerid{n}~\ocwlowerid{tag}~=~$\ocweol
\ocwindent{1.00em}
$\ocwupperid{Morpho\_html.}\ocwlowerid{print\_graph\_link\_tad}~\ocwlowerid{pvs}~\ocwlowerid{cache}~\ocwlowerid{stem}~\ocwlowerid{sfx}~(\ocwlowerid{seg\_num},\ocwlowerid{n})~\ocwlowerid{gen}~\ocwlowerid{tag}~$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_tags\_tad}~\ocwlowerid{pvs}~\ocwlowerid{seg\_num}~\ocwlowerid{phase}~\ocwlowerid{stem}~\ocwlowerid{sfx}~\ocwlowerid{sfx\_tags}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{ptag}~=~\ocwlowerid{print\_morph\_tad}~\ocwlowerid{pvs}~\ocwlowerid{seg\_num}~\ocwupperid{False}~(\ocwlowerid{generative}~\ocwlowerid{phase})~\ocwlowerid{stem}~\ocwlowerid{sfx}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{fold\_vert}~\ocwlowerid{ptag}~\ocwlowerid{sfx\_tags}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} This is called \ocwstring{"printing\ocwvspace{}morphology\ocwvspace{}interface\ocwvspace{}style"}. Taddhitaanta forms
   are printed as fake compounds of iic the stem and ifc the taddhita form. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_morpho}~\ocwlowerid{phase}~\ocwlowerid{word}~=~$\ocweol
\ocwindent{2.50em}
\ocwkw{match}~$\ocwlowerid{tags\_of}~\ocwlowerid{phase}~\ocwlowerid{word}~$\ocwkw{with}~\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Atomic}~\ocwlowerid{tags}~\rightarrow{}~\ocwlowerid{print\_tags}~[\,]~0~\ocwlowerid{phase}~\ocwlowerid{word}~\ocwlowerid{tags}~$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Preverbed}~(\ocwlowerid{\_},\ocwlowerid{phase})~\ocwlowerid{pvs}~\ocwlowerid{form}~\ocwlowerid{tags}~\rightarrow{}~\ocwlowerid{print\_tags}~\ocwlowerid{pvs}~0~\ocwlowerid{phase}~\ocwlowerid{form}~\ocwlowerid{tags}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Taddhita}~(\ocwlowerid{ph},\ocwlowerid{form})~\ocwlowerid{sfx}~\ocwlowerid{\_}~\ocwlowerid{sfx\_tags}~\rightarrow{}~$\ocweol
\ocwindent{6.00em}
\ocwkw{match}~$\ocwlowerid{tags\_of}~\ocwlowerid{ph}~\ocwlowerid{form}~$\ocwkw{with}~\ocweol
\ocwindent{6.00em}
$[~\ocwupperid{Atomic}~\ocwlowerid{\_}~\rightarrow{}~$\ocwbc{} stem, tagged as iic \ocwec{}\ocweol
\ocwindent{7.00em}
$\ocwlowerid{print\_tags\_tad}~[\,]~0~\ocwlowerid{ph}~\ocwlowerid{form}~\ocwlowerid{sfx}~\ocwlowerid{sfx\_tags}~$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwupperid{Preverbed}~\ocwlowerid{\_}~\ocwlowerid{pvs}~\ocwlowerid{\_}~\ocwlowerid{\_}~\rightarrow{}~$\ocwbc{} stem, tagged as iic \ocwec{}\ocweol
\ocwindent{7.00em}
$\ocwlowerid{print\_tags\_tad}~\ocwlowerid{pvs}~0~\ocwlowerid{ph}~\ocwlowerid{form}~\ocwlowerid{sfx}~\ocwlowerid{sfx\_tags}~$\ocweol
\ocwindent{6.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Control.Anomaly}~$\ocwstring{"taddhita\ocwvspace{}recursion"}$)$\ocweol
\ocwindent{6.00em}
$]$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{2.00em}
\ocwbc{} PB: if form has homonymy, we get t1 t2 t for \ocwbegindcode{}$\ocwlowerid{t1}~\mid{}~\ocwlowerid{t2}$\ocwenddcode{}.t - confusion \ocwec{}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Parsing mandatory checkpoints 
\ocweol
\label{interface.ml:5018}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Checkpoints};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{string\_points}$\ocwenddcode{} \ocwec{}\medskip

\label{interface.ml:5060}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rpc}~=~\ocwupperid{Paths.}\ocwlowerid{remote\_server\_host}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{remote}~=~$\ocwbt{ref}~$\ocwupperid{False}~$\ocwbc{} local invocation of cgi by default 
                          (switched on to \ocwbegindcode{}$\ocwupperid{True}$\ocwenddcode{} by \ocwstring{"abs"} cgi parameter) \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{invoke}~\ocwlowerid{cgi}~=~$\ocwkw{if}~$\ocwlowerid{remote.}\ocwlowerid{val}~$\ocwkw{then}~$\ocwlowerid{rpc}~$\^{}~$\ocwlowerid{cgi}~$\ocwkw{else}~$\ocwlowerid{cgi}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{mem\_cpts}~\ocwlowerid{ind}~\ocwlowerid{phase\_pada}~=~\ocwlowerid{memrec}~\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{memrec}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwlowerid{k},\ocwlowerid{pw},\ocwlowerid{\_})~::~\ocwlowerid{rest}~]~\rightarrow{}~(\ocwlowerid{k}=\ocwlowerid{ind}~\land{}~\ocwlowerid{pw}~=~\ocwlowerid{phase\_pada})~\lor{}~\ocwlowerid{memrec}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{unanalysed}~(\ocwlowerid{phase},\ocwlowerid{\_})~=~(\ocwlowerid{phase}=\ocwupperid{Phases.}\ocwlowerid{unknown})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{already\_checked}~=~\ocwlowerid{html\_blue}~\ocwlowerid{check\_sign}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{call\_back}~\ocwlowerid{text}~\ocwlowerid{cpts}~(\ocwlowerid{k},\ocwlowerid{seg})~\ocwlowerid{conflict}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{mem\_cpts}~\ocwlowerid{k}~\ocwlowerid{seg}~\ocwlowerid{cpts}~$\ocwkw{then}~$\ocwlowerid{already\_checked}~$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwkw{if}~$\lnot{}~\ocwlowerid{conflict}~\land{}~\lnot{}~(\ocwlowerid{unanalysed}~\ocwlowerid{seg})~$\ocwkw{then}~$\ocwlowerid{already\_checked}$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwkw{let}~$\ocwlowerid{choices}~\ocwlowerid{b}~=~\ocwlowerid{string\_points}~[~(\ocwlowerid{k},\ocwlowerid{seg},\ocwlowerid{b})~::~\ocwlowerid{cpts}~]~$\ocweol
\ocwindent{3.50em}
\ocwkw{and}~$(\ocwlowerid{out\_cgi},\ocwlowerid{sign},\ocwlowerid{color})~=~$\ocweol
\ocwindent{5.50em}
\ocwkw{if}~$\ocwlowerid{unanalysed}~\ocwlowerid{seg}~$\ocwkw{then}~$(\ocwlowerid{user\_aid\_cgi},\ocwlowerid{spade\_sign},\ocwupperid{Red\_})~$\ocweol
\ocwindent{14.50em}
\ocwkw{else}~$(\ocwlowerid{graph\_cgi},~\ocwlowerid{check\_sign},\ocwupperid{Green\_})~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{cgi\_select}~=~\ocwlowerid{out\_cgi}~$\^{}~\ocwstring{"?"}~\^{}~$\ocwlowerid{text}~$\^{}~\ocwstring{";cpts="}~\^{}~$(\ocwlowerid{choices}~\ocwupperid{True})$\ocweol
\ocwindent{3.50em}
\ocwkw{and}~$\ocwlowerid{cgi\_reject}~=~\ocwlowerid{out\_cgi}~$\^{}~\ocwstring{"?"}~\^{}~$\ocwlowerid{text}~$\^{}~\ocwstring{";cpts="}~\^{}~$(\ocwlowerid{choices}~\ocwupperid{False})~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
$\ocwlowerid{anchor}~\ocwlowerid{color}~(\ocwlowerid{invoke}~\ocwlowerid{cgi\_select})~\ocwlowerid{sign}~$\^{}~\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{unanalysed}~\ocwlowerid{seg}~$\ocwkw{then}~\ocwstring{""}~\ocwkw{else}~$\ocwlowerid{anchor}~\ocwupperid{Red\_}~(\ocwlowerid{invoke}~\ocwlowerid{cgi\_reject})~\ocwlowerid{x\_sign}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{call\_reader}~\ocwlowerid{text}~\ocwlowerid{cpts}~\ocwlowerid{mode}~=~$\ocwbc{} mode = \ocwstring{"o"}, \ocwstring{"p"}, \ocwstring{"n"} or \ocwstring{"t"} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{cgi}~=~\ocwlowerid{reader\_cgi}~$\^{}~\ocwstring{"?"}~\^{}~$\ocwlowerid{text}~$\^{}~\ocwstring{";mode="}~\^{}~$\ocwlowerid{mode}~$\^{}~\ocweol
\ocwindent{6.00em}
\ocwstring{";cpts="}~\^{}~$\ocwlowerid{string\_points}~\ocwlowerid{cpts}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{anchor}~\ocwupperid{Green\_}~(\ocwlowerid{invoke}~\ocwlowerid{cgi})~\ocwlowerid{check\_sign}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{call\_parser}~\ocwlowerid{text}~\ocwlowerid{cpts}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{cgi}~=~\ocwlowerid{parser\_cgi}~$\^{}~\ocwstring{"?"}~\^{}~$\ocwlowerid{text}~$\^{}~\ocwstring{";mode=p"}~\^{}~\ocweol
\ocwindent{6.00em}
\ocwstring{";cpts="}~\^{}~$\ocwlowerid{string\_points}~\ocwlowerid{cpts}~$\^{}~\ocwstring{";n=1"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{anchor}~\ocwupperid{Green\_}~(\ocwlowerid{invoke}~\ocwlowerid{cgi})~\ocwlowerid{check\_sign}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{call\_SL}~\ocwlowerid{text}~\ocwlowerid{cpts}~\ocwlowerid{mode}~\ocwlowerid{corpus}~\ocwlowerid{solutions}~\ocwlowerid{sent\_id}~\ocwlowerid{link\_num}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{cgi}~=~\ocwlowerid{tomcat}~$\^{}~$\ocwlowerid{corpus}~$\^{}~\ocwstring{"/SaveTagging?slp1Sentence="}~\ocweol
\ocwindent{6.00em}
\^{}~$\ocwlowerid{text}~$\^{}~\ocwstring{"\&numSolutions="}~\^{}~$(\ocwlowerid{string\_of\_int}~\ocwlowerid{solutions})~$\ocweol
\ocwindent{6.00em}
\^{}~\ocwstring{"\&submit=submit\&command=resend\&sentenceNumber="}~\^{}~$\ocwlowerid{sent\_id}~$\ocweol
\ocwindent{6.00em}
\^{}~\ocwstring{"\&linkNumber="}~\^{}~$\ocwlowerid{link\_num}~$\^{}~\ocwstring{"\&displayEncoding=roman\&"}\ocweol
\ocwindent{6.00em}
\^{}~\ocwstring{"inflectionFormat=SL\&inputEncoding=slp1\&OS=MacOS\&cpts="}~\ocweol
\ocwindent{6.00em}
\^{}~$\ocwlowerid{string\_points}~\ocwlowerid{cpts}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{anchor}~\ocwupperid{Green\_}~(\ocwlowerid{invoke}~\ocwlowerid{cgi})~\ocwlowerid{check\_sign}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sort\_check}~\ocwlowerid{cpts}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{compare\_index}~(\ocwlowerid{a},\ocwlowerid{\_},\ocwlowerid{\_})~(\ocwlowerid{b},\ocwlowerid{\_},\ocwlowerid{\_})~=~\ocwlowerid{compare}~\ocwlowerid{a}~\ocwlowerid{b}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{sort}~\ocwlowerid{compare\_index}~\ocwlowerid{cpts}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{seg\_length}~=~$\ocwkw{fun}\ocweol
\ocwindent{0.50em}
$[~[~-2~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{rest}~$\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwlowerid{w}~\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{w}$\ocweol
\ocwindent{0.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{merge\_rec}~\ocwlowerid{lpw}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{lpw}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwlowerid{p},~\ocwlowerid{lw})~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{merge\_rec}~(\ocwlowerid{fill}~\ocwlowerid{p}~\ocwlowerid{lpw}~\ocwlowerid{lw})~\ocwlowerid{rest}$\ocweol
\ocwindent{3.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{fill}~\ocwlowerid{p}~\ocwlowerid{lpw}~=~$\ocwkw{fun}\ocweol
\ocwindent{4.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{lpw}$\ocweol
\ocwindent{4.50em}
$\mid{}~[~\ocwlowerid{wh}~::~\ocwlowerid{rest1}~]~\rightarrow{}~\ocwlowerid{fill}~\ocwlowerid{p}~[~(\ocwlowerid{p},\ocwlowerid{wh})~::~\ocwlowerid{lpw}~]~\ocwlowerid{rest1}$\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{build\_visual}~\ocwlowerid{k}~\ocwlowerid{segments}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{segments}~=~[\,]~$\ocwkw{then}~$()~$\ocwkw{else}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{phw}~=~\ocwlowerid{merge\_rec}~[\,]~\ocwlowerid{segments}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{comp\_length}~(\ocwlowerid{\_},(\ocwlowerid{a},\ocwlowerid{\_}))~(\ocwlowerid{\_},(\ocwlowerid{b},\ocwlowerid{\_}))~=~\ocwlowerid{compare}~(\ocwlowerid{seg\_length}~\ocwlowerid{a})~(\ocwlowerid{seg\_length}~\ocwlowerid{b})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{sorted\_seg}~=~\ocwupperid{List.}\ocwlowerid{rev}~(\ocwupperid{List.}\ocwlowerid{sort}~\ocwlowerid{comp\_length}~\ocwlowerid{phw})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{ass\_rec}~\ocwlowerid{sorted\_seg}$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{ass\_rec}~\ocwlowerid{seg}~=$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{start\_ind}~=~\ocwlowerid{find\_ind\_rec}~0$\ocweol
\ocwindent{5.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{find\_ind\_rec}~\ocwlowerid{n}~=~$\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{k}~<~\ocwlowerid{visual\_width}.(\ocwlowerid{n})~$\ocwkw{then}~$\ocwlowerid{find\_ind\_rec}~(\ocwlowerid{n}+1)~$\ocwkw{else}~$\ocwlowerid{n}~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwlowerid{seg}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~()$\ocweol
\ocwindent{3.00em}
$\mid{}~[~(\ocwlowerid{phase},(\ocwlowerid{w1},\ocwlowerid{tr}))~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{phase}~$\ocwkw{with}~\ocweol
\ocwindent{5.50em}
$[~\ocwupperid{Phases.Pv}~\mid{}~\ocwupperid{Phases.Pvk}~\mid{}~\ocwupperid{Phases.Pvkc}~\mid{}~\ocwupperid{Phases.Pvkv}~\rightarrow{}~$\ocweol
\ocwindent{6.50em}
$\ocwlowerid{failwith}~$\ocwstring{"Preverb\ocwvspace{}in\ocwvspace{}build\_visual"}\ocweol
\ocwindent{5.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{6.50em}
\{~$\ocwlowerid{visual}.(\ocwlowerid{start\_ind})~:=~\ocwlowerid{visual}.(\ocwlowerid{start\_ind})~@~[~(\ocwlowerid{w1},\ocwlowerid{tr},\ocwlowerid{phase},\ocwlowerid{k})~]$\ocweol
\ocwindent{6.50em}
;~$\ocwlowerid{visual\_width}.(\ocwlowerid{start\_ind})~:=~(\ocwlowerid{seg\_length}~\ocwlowerid{w1})~+~\ocwlowerid{k}$\ocweol
\ocwindent{6.50em}
;~$\ocwlowerid{ass\_rec}~\ocwlowerid{rest}$\ocweol
\ocwindent{6.50em}
\}\ocweol
\ocwindent{5.50em}
$]$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We check whether the current segment \ocwbegindcode{}$(\ocwlowerid{w},\ocwlowerid{tr},\ocwlowerid{phase},\ocwlowerid{k})$\ocwenddcode{} is conflicting with 
   others at previous offset \ocwbegindcode{}$\ocwlowerid{l}$\ocwenddcode{}; if not it is mandatory and marked blue. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Warning: hairy code, do not change without understanding the theory.  \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{is\_conflicting}~(\ocwlowerid{w},\ocwlowerid{tr},\ocwlowerid{phase},\ocwlowerid{k})~=~$\ocweol
\ocwindent{0.50em}
\ocwkw{let}~$\ocwlowerid{l\_w}~=~\ocwlowerid{seg\_length}~\ocwlowerid{w}~$\ocwkw{in}~$\ocwlowerid{is\_conflicting\_rec}~0$\ocweol
\ocwindent{0.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{is\_conflicting\_rec}~\ocwlowerid{l}~=~$\ocwkw{match}~$\ocwlowerid{visual}.(\ocwlowerid{l})~$\ocwkw{with}~\ocweol
\ocwindent{0.50em}
$[~[\,]~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwlowerid{segs}~\rightarrow{}~\ocwlowerid{does\_conflict}~\ocwlowerid{segs}$\ocweol
\ocwindent{2.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{does\_conflict}~=~$\ocwkw{fun}\ocweol
\ocwindent{3.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{is\_conflicting\_rec}~(\ocwlowerid{l}+1)~$\ocweol
\ocwindent{3.50em}
$\mid{}~[~(\ocwlowerid{w1},\ocwlowerid{tr1},\ocwlowerid{phase1},\ocwlowerid{k1})~::~\ocwlowerid{rest}~]~\rightarrow{}$\ocweol
\ocwindent{5.50em}
\ocwkw{if}~$(\ocwlowerid{w1},\ocwlowerid{tr1},\ocwlowerid{phase1},\ocwlowerid{k1})=(\ocwlowerid{w},\ocwlowerid{tr},\ocwlowerid{phase},\ocwlowerid{k})~$\ocweol
\ocwindent{5.50em}
\ocwkw{then}~\ocwbc{} skip itself \ocwec{}~$\ocwlowerid{does\_conflict}~\ocwlowerid{rest}$\ocweol
\ocwindent{5.50em}
\ocwkw{else}~\ocwkw{let}~$\ocwlowerid{l\_w1}~=~\ocwlowerid{seg\_length}~\ocwlowerid{w1}~$\ocwkw{in}\ocweol
\ocwindent{8.00em}
\ocwkw{if}~$(\ocwlowerid{k1}\le{}\ocwlowerid{k}~\land{}~\ocwlowerid{k1}+\ocwlowerid{l\_w1}-1>\ocwlowerid{k})~$\ocweol
\ocwindent{8.00em}
$\lor{}~(\ocwlowerid{k1}\le{}\ocwlowerid{k}~\land{}~\ocwlowerid{k1}+\ocwlowerid{l\_w1}-1\ge{}\ocwlowerid{k}~\land{}~\ocwlowerid{l\_w}=1)$\ocweol
\ocwindent{3.00em}
\ocwbc{} This condition is necessary for the overlapping case \ocwec{}\ocweol
\ocwindent{8.00em}
$\lor{}~(\ocwlowerid{k}\le{}\ocwlowerid{k1}~\land{}~\ocwlowerid{k}+\ocwlowerid{l\_w}-1>\ocwlowerid{k1}~\land{}~\ocwlowerid{l\_w1}>1)~$\ocwkw{then}~\ocweol
\ocwindent{3.00em}
\ocwbc{} This condition refines \ocwbegindcode{}$(\ocwlowerid{k}\le{}\ocwlowerid{k1}~\land{}~\ocwlowerid{k}+\ocwlowerid{l\_w}-1>\ocwlowerid{k1})$\ocwenddcode{} but is modified
         here to take care of cases such as elayati. We do not say that elayati 
         (at k) conflicts with a segment aa (at the same offset). If it were 
         conflicting, there would have existed another segment, which would be 
         sufficient to prove the conflict. It also points to the fact that 
         conflicting is not a symmetric relation. We might have to include 
         a test as we did below \ocwec{}~\ocweol
\ocwindent{9.50em}
\ocwkw{if}~$\ocwlowerid{k}+\ocwlowerid{l\_w}-1=\ocwlowerid{k1}~$\ocwkw{then}~$\ocwlowerid{match\_tr}~\ocwlowerid{tr}$\ocweol
\ocwindent{3.00em}
\ocwbc{} This is to check for the overlapping case, occurs when \ocwbegindcode{}$\ocwlowerid{k}=\ocwlowerid{k1},~\ocwlowerid{l\_w}=1$\ocwenddcode{}. 
         We need to check the sandhi conditions to decide whether this is a case 
         of overlap or conflict. \ocwec{}\ocweol
\ocwindent{11.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{match\_tr}~=~$\ocwkw{fun}\ocweol
\ocwindent{12.50em}
$[~[\,]~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{12.50em}
$\mid{}~[~\ocwlowerid{v}~::~\ocwlowerid{rst}~]~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{v}~$\ocwkw{with}\ocweol
\ocwindent{14.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{match\_tr}~\ocwlowerid{rst}$\ocweol
\ocwindent{14.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{if}~$\ocwupperid{Word.}\ocwlowerid{prefix}~\ocwlowerid{v}~(\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{w1})~$\ocweol
\ocwindent{20.00em}
\ocwkw{then}~$\ocwlowerid{does\_conflict}~\ocwlowerid{rest}$\ocweol
\ocwindent{18.50em}
\ocwkw{else}~$\ocwlowerid{match\_tr}~\ocwlowerid{rst}$\ocweol
\ocwindent{14.50em}
$]$\ocweol
\ocwindent{12.50em}
$]$\ocweol
\ocwindent{9.50em}
\ocwkw{else}~\ocwkw{if}~$(\ocwlowerid{k1}\le{}\ocwlowerid{k}~\land{}~\ocwlowerid{k1}+\ocwlowerid{l\_w1}-1\ge{}\ocwlowerid{k}~\land{}~\ocwlowerid{l\_w}=1)~$\ocwkw{then}~$\ocwlowerid{match\_tr1}~\ocwlowerid{tr1}$\ocweol
\ocwindent{3.00em}
\ocwbc{} For the case with \ocwbegindcode{}$\ocwlowerid{l\_w}=1$\ocwenddcode{}, this is to check whether w is the only 
         possible v for w1, then it is an overlap returning a blue sign. 
         If w1 has any other possible v's, there is a conflict. \ocwec{}\ocweol
\ocwindent{13.50em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{match\_tr1}~=~$\ocwkw{fun}\ocweol
\ocwindent{14.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{does\_conflict}~\ocwlowerid{rest}$\ocweol
\ocwindent{14.50em}
$\mid{}~[~\ocwlowerid{v}~::~\ocwlowerid{rst}~]~\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{prefix}~\ocwlowerid{v}~\ocwlowerid{w}~\lor{}~\ocwlowerid{match\_tr1}~\ocwlowerid{rst}$\ocweol
\ocwindent{14.50em}
$]$\ocweol
\ocwindent{12.00em}
\ocwkw{else}~$\ocwupperid{True}$\ocweol
\ocwindent{9.50em}
\ocwkw{else}~$\ocwlowerid{does\_conflict}~\ocwlowerid{rest}$\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{0.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{find\_conflict\_seg}~\ocwlowerid{acc}~\ocwlowerid{l}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{acc}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwlowerid{w1},\ocwlowerid{tr},\ocwlowerid{phase},\ocwlowerid{k})~::~\ocwlowerid{rest}~]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{conflict}~=~\ocwlowerid{is\_conflicting}~(\ocwlowerid{w1},\ocwlowerid{tr},\ocwlowerid{phase},\ocwlowerid{k})~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{seg\_here}~=~(\ocwlowerid{w1},\ocwlowerid{phase},\ocwlowerid{k},\ocwlowerid{conflict})~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
$\ocwlowerid{find\_conflict\_seg}~[~\ocwlowerid{seg\_here}~::~\ocwlowerid{acc}~]~\ocwlowerid{l}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{find\_conflict}~\ocwlowerid{l}~=~$\ocwkw{match}~$\ocwlowerid{visual}.(\ocwlowerid{l})~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{segs}~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{visual\_conf}.(\ocwlowerid{l})~:=~\ocwlowerid{find\_conflict\_seg}~[\,]~\ocwlowerid{l}~\ocwlowerid{segs}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{find\_conflict}~(\ocwlowerid{succ}~\ocwlowerid{l})~$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{make\_visual}~\ocwlowerid{n}~=~\ocwlowerid{vrec}~0~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{vrec}~\ocwlowerid{k}~=~$\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{build\_visual}~\ocwlowerid{k}~\ocwlowerid{graph}.(\ocwlowerid{k})$\ocweol
\ocwindent{2.00em}
;~\ocwkw{if}~$\ocwlowerid{k}~=~\ocwlowerid{n}-1~$\ocwkw{then}~$()~$\ocwkw{else}~$\ocwlowerid{vrec}~(\ocwlowerid{succ}~\ocwlowerid{k})$\ocweol
\ocwindent{2.00em}
\}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{print\_extra}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~0~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{l}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{ps}~(\ocwlowerid{td\_wrap}~$\ocwstring{""}$);~\ocwlowerid{print\_extra}~(\ocwlowerid{l}-1)~\}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fixed\_space}~=~\ocwlowerid{td\_wrap}~$\ocwstring{"\&nbsp;"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{print\_first\_server}~\ocwlowerid{chunk}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{chunk}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~0~\rightarrow{}~\ocwlowerid{ps}~\ocwlowerid{fixed\_space}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{l}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{chunk}~$\ocwkw{with}~\ocweol
\ocwindent{4.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{ps}~\ocwlowerid{fixed\_space}$\ocweol
\ocwindent{4.50em}
$\mid{}~[~\ocwlowerid{st}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{to\_print}~=~\ocwupperid{Canon.}\ocwlowerid{uniromcode}~[~\ocwlowerid{st}~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{6.50em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{td\_wrap}~\ocwlowerid{to\_print})$\ocweol
\ocwindent{6.50em}
;~$\ocwlowerid{print\_first\_server}~\ocwlowerid{rest}$\ocweol
\ocwindent{6.50em}
\}\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{call\_back\_pseudo}~\ocwlowerid{text}~\ocwlowerid{cpts}~\ocwlowerid{ph}~\ocwlowerid{newpt}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{mem}~\ocwlowerid{newpt}~\ocwlowerid{cpts}~$\ocwkw{then}~$\ocwlowerid{already\_checked}~$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwkw{let}~$\ocwlowerid{list\_points}~=~[~\ocwlowerid{newpt}~::~\ocwlowerid{cpts}~]~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{out\_cgi}~=~\ocwlowerid{user\_aid\_cgi}~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{cgi}~=~\ocwlowerid{out\_cgi}~$\^{}~\ocwstring{"?"}~\^{}~$\ocwlowerid{text}~$\^{}~\ocwstring{";cpts="}~\^{}~$(\ocwlowerid{string\_points}~\ocwlowerid{list\_points})~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
$\ocwlowerid{anchor\_pseudo}~(\ocwlowerid{invoke}~\ocwlowerid{cgi})~\ocwlowerid{ph}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{un\_analyzable}~(\ocwlowerid{chunk}:\ocwupperid{Word.}\ocwlowerid{word})~=~(\ocwupperid{Phases.Unknown},\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{chunk})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{print\_first}~\ocwlowerid{text}~\ocwlowerid{cpts}~\ocwlowerid{chunk\_orig}~\ocwlowerid{chunk}~\ocwlowerid{chunk\_ind}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{chunk}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~0~\rightarrow{}~\ocwlowerid{ps}~\ocwlowerid{fixed\_space}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{l}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{chunk}~$\ocwkw{with}~\ocweol
\ocwindent{4.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{ps}~\ocwlowerid{fixed\_space}$\ocweol
\ocwindent{4.50em}
$\mid{}~[~\ocwlowerid{st}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{to\_print}~=~\ocwupperid{Canon.}\ocwlowerid{uniromcode}~[~\ocwlowerid{st}~]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{6.50em}
\{~\ocwkw{let}~$\ocwlowerid{unknown\_chunk}~=~(\ocwlowerid{chunk\_ind},\ocwlowerid{un\_analyzable}~\ocwlowerid{chunk\_orig},\ocwupperid{True})~$\ocwkw{in}\ocweol
\ocwindent{7.50em}
$\ocwlowerid{ps}~(\ocwlowerid{td\_wrap}~(\ocwlowerid{call\_back\_pseudo}~\ocwlowerid{text}~\ocwlowerid{cpts}~\ocwlowerid{to\_print}~\ocwlowerid{unknown\_chunk}))$\ocweol
\ocwindent{6.50em}
;~$\ocwlowerid{print\_first}~\ocwlowerid{text}~\ocwlowerid{cpts}~\ocwlowerid{chunk\_orig}~\ocwlowerid{rest}~\ocwlowerid{chunk\_ind}$\ocweol
\ocwindent{6.50em}
\}\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.50em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Making use of the index for printing the chunk callback \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{print\_all}~\ocwlowerid{text}~\ocwlowerid{cpts}~\ocwlowerid{chunks}~\ocwlowerid{index}~=~$\ocwkw{match}~$\ocwlowerid{chunks}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{chunk}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{print\_first}~\ocwlowerid{text}~\ocwlowerid{cpts}~\ocwlowerid{chunk}~\ocwlowerid{chunk}~\ocwlowerid{index}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{print\_all}~\ocwlowerid{text}~\ocwlowerid{cpts}~\ocwlowerid{rest}~(\ocwlowerid{succ}~(\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{chunk}))$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_word}~\ocwlowerid{last\_ind}~\ocwlowerid{text}~\ocwlowerid{cpts}~(\ocwlowerid{rword},\ocwlowerid{phase},\ocwlowerid{k},\ocwlowerid{conflict})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{word}~=~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rword}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~\ocwkw{let}~$\ocwlowerid{extra\_space}~=~\ocwlowerid{k}-\ocwlowerid{last\_ind}~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{extra\_space}~>~0~$\ocwkw{then}~$\ocwlowerid{print\_extra}~\ocwlowerid{extra\_space}~$\ocwkw{else}~$()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{td\_begin\_att}~[~($\ocwstring{"colspan"},$\ocwlowerid{string\_of\_int}~(\ocwlowerid{seg\_length}~\ocwlowerid{word}))$\ocweol
\ocwindent{10.50em}
;~$($\ocwstring{"align"},\ocwstring{"left"}$)~$\ocweol
\ocwindent{10.50em}
$])$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{back}~=~\ocwlowerid{background}~(\ocwlowerid{color\_of\_phase}~\ocwlowerid{phase})~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
$\ocwlowerid{pl}~(\ocwlowerid{table\_begin}~\ocwlowerid{back})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~($\ocwstring{"\ensuremath{<}td\ocwvspace{}"}~\^{}~$\ocwlowerid{display\_morph\_action}~$\^{}~\ocwstring{"=\symbol{92}"showBox('"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_morpho}~\ocwlowerid{phase}~\ocwlowerid{word}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{close\_box}~=~$\ocweol
\ocwindent{4.00em}
\ocwstring{"\ensuremath{<}a\ocwvspace{}href=\&quot;javascript:hideBox()\&quot;\ensuremath{>}\ocwvspace{}"}~\^{}~$\ocwlowerid{x\_sign}~$\^{}~\ocwstring{"\ensuremath{<}/a\ensuremath{>}',\ocwvspace{}'"}~\ocwkw{in}~\ocweol
\ocwindent{2.00em}
$\ocwlowerid{ps}~(\ocwlowerid{close\_box}~$\^{}~$\ocwlowerid{rgb}~(\ocwlowerid{color\_of\_phase}~\ocwlowerid{phase})~$\^{}~\ocwstring{"',\ocwvspace{}this,\ocwvspace{}event)\symbol{92}"\ensuremath{>}"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwupperid{Morpho\_html.}\ocwlowerid{print\_final}~\ocwlowerid{rword}~$\ocwbc{} visarga correction \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{td\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{tr\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{table\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{call\_back}~\ocwlowerid{text}~\ocwlowerid{cpts}~(\ocwlowerid{k},(\ocwlowerid{phase},\ocwlowerid{rword}))~\ocwlowerid{conflict})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{td\_end}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{max\_col}~=~$\ocwbt{ref}~0\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_row}~\ocwlowerid{text}~\ocwlowerid{cpts}~=~\ocwlowerid{print\_this}~\ocwlowerid{text}~\ocwlowerid{cpts}~0~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{print\_this}~\ocwlowerid{text}~\ocwlowerid{cpts}~\ocwlowerid{last\_ind}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{adjust}~=~\ocwlowerid{max\_col.}\ocwlowerid{val}~-~\ocwlowerid{last\_ind}~$\ocwkw{in}\ocweol
\ocwindent{5.00em}
\ocwkw{if}~$\ocwlowerid{adjust}~>~0~$\ocwkw{then}~$\ocwlowerid{print\_extra}~\ocwlowerid{adjust}~$\ocwkw{else}~$()$\ocweol
\ocwindent{1.00em}
$\mid{}~[~(\ocwlowerid{word},\ocwlowerid{phase},\ocwlowerid{k},\ocwlowerid{conflict})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{print\_word}~\ocwlowerid{last\_ind}~\ocwlowerid{text}~\ocwlowerid{cpts}~(\ocwlowerid{word},\ocwlowerid{phase},\ocwlowerid{k},\ocwlowerid{conflict})$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{print\_this}~\ocwlowerid{text}~\ocwlowerid{cpts}~(\ocwlowerid{k}~+~\ocwlowerid{seg\_length}~\ocwlowerid{word})~\ocwlowerid{rest}$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_interf}~\ocwlowerid{text}~\ocwlowerid{cpts}~()~=~\ocwlowerid{vgrec}~0~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{vgrec}~\ocwlowerid{k}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{visual\_width}.(\ocwlowerid{k})~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~0~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{print\_row}~\ocwlowerid{text}~\ocwlowerid{cpts}~\ocwlowerid{visual\_conf}.(\ocwlowerid{k})$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{tr\_end}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{vgrec}~(\ocwlowerid{succ}~\ocwlowerid{k})$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{update\_col\_length}~\ocwlowerid{chunk}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{max\_col.}\ocwlowerid{val}~:=~\ocwlowerid{succ}~(\ocwlowerid{max\_col.}\ocwlowerid{val}~+~\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{chunk})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{invoke\_SL}~\ocwlowerid{text}~\ocwlowerid{cpts}~\ocwlowerid{corpus\_id}~\ocwlowerid{count}~\ocwlowerid{sent\_id}~\ocwlowerid{link\_num}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{ps}~(\ocwlowerid{td\_wrap}~(\ocwlowerid{call\_SL}~\ocwlowerid{text}~\ocwlowerid{cpts}~$\ocwstring{"t"}~$\ocwlowerid{corpus\_id}~\ocwlowerid{count}~\ocwlowerid{sent\_id}~\ocwlowerid{link\_num}~$\ocweol
\ocwindent{7.50em}
\^{}~\ocwstring{"Sanskrit\ocwvspace{}Library\ocwvspace{}Interface"}$))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{update\_text\_with\_sol}~\ocwlowerid{text}~\ocwlowerid{count}~=~\ocwlowerid{text}~$\^{}~\ocwstring{";allSol="}~\^{}~\ocwkw{match}~$\ocwlowerid{count}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Num.Int}~\ocwlowerid{n}~\rightarrow{}~\ocwlowerid{string\_of\_int}~\ocwlowerid{n}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"2147483648"}~\ocwbc{} \ocwbegindcode{}2\^{}31\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{call\_undo}~\ocwlowerid{text}~\ocwlowerid{cpts}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{string\_pts}~=~$\ocwkw{match}~$\ocwlowerid{cpts}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~$\ocwstring{""}~\ocwbc{} Could raise warning \ocwstring{"undo\ocwvspace{}stack\ocwvspace{}empty"} \ocwec{}\ocweol
\ocwindent{3.00em}
$\mid{}~[~\ocwlowerid{\_}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{string\_points}~\ocwlowerid{rest}$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{cgi}~=~\ocwlowerid{graph\_cgi}~$\^{}~\ocwstring{"?"}~\^{}~$\ocwlowerid{text}~$\^{}~\ocwstring{";cpts="}~\^{}~$\ocwlowerid{string\_pts}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{anchor}~\ocwupperid{Green\_}~(\ocwlowerid{invoke}~\ocwlowerid{cgi})~\ocwlowerid{check\_sign}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} The main procedure for computing the graph segmentation structure \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{check\_sentence}~\ocwlowerid{translit}~\ocwlowerid{us}~\ocwlowerid{text\_orig}~\ocwlowerid{checkpoints}~\ocwlowerid{sentence}~$\ocweol
\ocwindent{6.50em}
\ocwbc{} finally SL corpus links: \ocwec{}~$\ocwlowerid{sol\_num}~\ocwlowerid{corpus}~\ocwlowerid{sent\_id}~\ocwlowerid{link\_num}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{encode}~=~\ocwupperid{Encode.}\ocwlowerid{switch\_code}~\ocwlowerid{translit}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{chunker}~=~$\ocwkw{if}~$\ocwlowerid{us}~$\ocwbc{} sandhi undone \ocwec{}~\ocwkw{then}~$\ocwupperid{Sanskrit.}\ocwlowerid{read\_raw\_sanskrit}~$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~\ocwbc{} blanks non-significant \ocwec{}~$\ocwupperid{Sanskrit.}\ocwlowerid{read\_sanskrit}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{chunks}~=~\ocwlowerid{chunker}~\ocwlowerid{encode}~\ocwlowerid{sentence}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{devachunks}~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwupperid{Canon.}\ocwlowerid{unidevcode}~\ocwlowerid{chunks}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{devainput}~=~\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{"\ocwvspace{}"}~$\ocwlowerid{devachunks}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{cpts}~=~\ocwlowerid{sort\_check}~\ocwlowerid{checkpoints}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{\_}~=~\ocwlowerid{chkpts.}\ocwlowerid{all\_checks}~:=~\ocwlowerid{cpts}$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$(\ocwlowerid{flag},\ocwlowerid{count})~=~\ocwlowerid{segment\_all}~\ocwlowerid{chunks}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{text}~=~$\ocwkw{match}~$\ocwlowerid{sol\_num}~$\ocwkw{with}\ocweol
\ocwindent{6.50em}
$[~$\ocwstring{"0"}~$\rightarrow{}~\ocwlowerid{update\_text\_with\_sol}~\ocwlowerid{text\_orig}~\ocwlowerid{count}$\ocweol
\ocwindent{6.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{text\_orig}$\ocweol
\ocwindent{6.50em}
$]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{make\_visual}~\ocwlowerid{cur\_chunk.}\ocwlowerid{offset}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{find\_conflict}~0$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_break}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_latin16}~$\ocwstring{"Sentence:\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{deva16\_blue}~\ocwlowerid{devainput}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocwbc{} devanagari \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_break}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{div\_begin}~\ocwupperid{Latin16}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_begin}~\ocwupperid{Spacing20}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_begin}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{td\_wrap}~(\ocwlowerid{call\_undo}~\ocwlowerid{text}~\ocwlowerid{checkpoints}~$\^{}~\ocwstring{"Undo"}$)~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{call\_scl\_parser}~\ocwlowerid{n}~=~$\ocwbc{} invocation of scl parser \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{scl\_toggle}~$\ocwkw{then}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{ps}~(\ocwlowerid{td\_wrap}~(\ocwlowerid{call\_reader}~\ocwlowerid{text}~\ocwlowerid{cpts}~$\ocwstring{"o"}~\^{}~\ocwstring{"UoH\ocwvspace{}Analysis\ocwvspace{}Mode"}$))$\ocweol
\ocwindent{4.00em}
\ocwkw{else}~$()~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{scl\_parser}$\ocwenddcode{} is not visible unless toggle is set \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwlowerid{count}~$\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Num.Int}~\ocwlowerid{n}~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{n}~>~\ocwlowerid{max\_count}~$\ocwkw{then}~\ocweol
\ocwindent{11.00em}
\ocwbc{} too many solutions would choke the parsers \ocwec{}~\ocweol
\ocwindent{11.00em}
$\ocwlowerid{td\_wrap}~($\ocwstring{"("}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{n}~$\^{}~\ocwstring{"\ocwvspace{}Solutions)"}$)~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{9.50em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{n}=1~$\ocwbc{} Unique remaining solution \ocwec{}~\ocwkw{then}~\ocwkw{do}\ocweol
\ocwindent{11.00em}
\{~$\ocwlowerid{td\_wrap}~(\ocwlowerid{call\_parser}~\ocwlowerid{text}~\ocwlowerid{cpts}~$\^{}~\ocwstring{"Unique\ocwvspace{}Solution"}$)~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{11.00em}
;~$\ocwlowerid{call\_scl\_parser}~1$\ocweol
\ocwindent{11.00em}
\}\ocweol
\ocwindent{9.50em}
\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{3.50em}
\{~$\ocwlowerid{td\_wrap}~(\ocwlowerid{call\_reader}~\ocwlowerid{text}~\ocwlowerid{cpts}~$\ocwstring{"p"}~\^{}~\ocwstring{"Filtered\ocwvspace{}Solutions"}$)~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{3.50em}
;~\ocwkw{let}~$\ocwlowerid{info}~=~\ocwlowerid{string\_of\_int}~\ocwlowerid{n}~$\^{}~\ocwkw{if}~$\ocwlowerid{flag}~$\ocwkw{then}~\ocwstring{""}~\ocwkw{else}~\ocwstring{"\ocwvspace{}Partial"}~\ocwkw{in}~\ocweol
\ocwindent{4.50em}
$\ocwlowerid{td\_wrap}~(\ocwlowerid{call\_reader}~\ocwlowerid{text}~\ocwlowerid{cpts}~$\ocwstring{"t"}~\^{}~\ocwstring{"All\ocwvspace{}"}~\^{}~$\ocwlowerid{info}~$\^{}~\ocwstring{"\ocwvspace{}Solutions"}$)~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{3.50em}
;~$\ocwlowerid{call\_scl\_parser}~\ocwlowerid{n}$\ocweol
\ocwindent{3.50em}
\}~\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{td\_wrap}~$\ocwstring{"(More\ocwvspace{}than\ocwvspace{}2\^{}32\ocwvspace{}Solutions!)"}~|\ensuremath{>}~$\ocwlowerid{ps}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{div\_end}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocwbc{} Latin16 \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_break}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{div\_begin}~\ocwupperid{Latin12}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_begin}~\ocwupperid{Tcenter}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_begin}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{update\_col\_length}~\ocwlowerid{chunks}~$\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwupperid{Paths.}\ocwlowerid{platform}=$\ocwstring{"Station"}~\ocwkw{then}~$\ocwlowerid{print\_all}~\ocwlowerid{text}~\ocwlowerid{checkpoints}~\ocwlowerid{chunks}~0$\ocweol
\ocwindent{16.00em}
\ocwkw{else}~$\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{print\_first\_server}~\ocwlowerid{chunks}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_interf}~\ocwlowerid{text}~\ocwlowerid{checkpoints}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{div\_end}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocwbc{} Latin12 \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_break}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{reset\_graph}~()~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{reset\_visual}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{set\_cur\_offset}~0$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{chkpts.}\ocwlowerid{segment\_checks}~:=~[\,]$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{max\_col.}\ocwlowerid{val}~:=~0$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{arguments}~\ocwlowerid{trans}~\ocwlowerid{lex}~\ocwlowerid{cache}~\ocwlowerid{st}~\ocwlowerid{us}~\ocwlowerid{cp}~\ocwlowerid{input}~\ocwlowerid{topic}~\ocwlowerid{abs}~\ocwlowerid{sol\_num}~\ocwlowerid{corpus}~\ocwlowerid{id}~\ocwlowerid{ln}$\ocweol
\ocwindent{8.00em}
$\ocwlowerid{corpus\_permission}~\ocwlowerid{corpus\_dir}~\ocwlowerid{sentence\_no}~=$\ocweol
\ocwindent{1.00em}
\ocwstring{"t="}~\^{}~$\ocwlowerid{trans}~$\^{}~\ocwstring{";lex="}~\^{}~$\ocwlowerid{lex}~$\^{}~\ocwstring{";cache="}~\^{}~$\ocwlowerid{cache}~$\^{}~\ocwstring{";st="}~\^{}~$\ocwlowerid{st}~$\^{}~\ocwstring{";us="}~\^{}~$\ocwlowerid{us}~$\^{}\ocweol
\ocwindent{1.00em}
\ocwstring{";cp="}~\^{}~$\ocwlowerid{cp}~$\^{}~\ocwstring{";text="}~\^{}~$\ocwlowerid{input}~$\^{}~\ocwstring{";topic="}~\^{}~$\ocwlowerid{topic}~$\^{}~\ocwstring{";abs="}~\^{}~$\ocwlowerid{abs}~$\^{}~\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{sol\_num}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"0"}~$\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{n}~\rightarrow{}~$\ocwstring{";allSol="}~\^{}~$\ocwlowerid{n}$\ocweol
\ocwindent{2.00em}
$]~$\^{}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{corpus}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{""}~$\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~$\ocwstring{";corpus="}~\^{}~$\ocwlowerid{c}~$\^{}~\ocwstring{";sentenceNumber="}~\^{}~$\ocwlowerid{id}~$\^{}~\ocwstring{";linkNumber="}~\^{}~$\ocwlowerid{ln}$\ocweol
\ocwindent{2.00em}
$]~$\^{}\ocweol
\ocwindent{1.00em}
\ocwstring{";"}~\^{}~$\ocwupperid{Params.}\ocwlowerid{corpus\_permission}~$\^{}~\ocwstring{"="}~\^{}~$\ocwlowerid{corpus\_permission}~$\^{}\ocweol
\ocwindent{1.00em}
\ocwstring{";"}~\^{}~$\ocwupperid{Params.}\ocwlowerid{corpus\_dir}~$\^{}~\ocwstring{"="}~\^{}~$\ocwlowerid{corpus\_dir}~$\^{}\ocweol
\ocwindent{1.00em}
\ocwstring{";"}~\^{}~$\ocwupperid{Params.}\ocwlowerid{sentence\_no}~$\^{}~\ocwstring{"="}~\^{}~$\ocwlowerid{sentence\_no}$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Cache management 
\ocweol
\label{interface.ml:19067}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{make\_cache\_transducer}~(\ocwlowerid{cache}~:~\ocwupperid{Morphology.}\ocwlowerid{inflected\_map})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{deco\_cache}~=~\ocwupperid{Mini.}\ocwlowerid{minimize}~(\ocwupperid{Deco.}\ocwlowerid{forget\_deco}~\ocwlowerid{cache})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{auto\_cache}~=~\ocwupperid{Automaton.}\ocwlowerid{compile}~\ocwupperid{Deco.}\ocwlowerid{empty}~\ocwlowerid{deco\_cache}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwupperid{Gen.}\ocwlowerid{dump}~\ocwlowerid{cache}~\ocwlowerid{public\_cache\_file}~$\ocwbc{} for \ocwbegindcode{}$\ocwupperid{Load\_morphs}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwupperid{Gen.}\ocwlowerid{dump}~\ocwlowerid{auto\_cache}~\ocwlowerid{public\_transca\_file}~$\ocwbc{} for \ocwbegindcode{}$\ocwupperid{Load\_transducers}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We fill gendered entries incrementally in a \ocwbegindcode{}$\ocwlowerid{public\_cache\_txt\_file}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{append\_cache}~\ocwlowerid{entry}~\ocwlowerid{gender}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{cho}~=~\ocwlowerid{open\_out\_gen}~[~\ocwupperid{Open\_wronly};~\ocwupperid{Open\_append};~\ocwupperid{Open\_text}~]~\ocwoctconst{777}~$\ocweol
\ocwindent{12.50em}
$\ocwlowerid{public\_cache\_txt\_file}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{output\_string}~\ocwlowerid{cho}~($\ocwstring{"[\{"}~\^{}~$\ocwlowerid{entry}~$\^{}~\ocwstring{"\}]\ocwvspace{}(\{"}~\^{}~$\ocwlowerid{gender}~$\^{}~\ocwstring{"\})\symbol{92}n"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{close\_out}~\ocwlowerid{cho}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{save\_button}~\ocwlowerid{query}~\ocwlowerid{nb\_sols}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{center\_begin}~$\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{cgi\_begin}~\ocwlowerid{save\_corpus\_cgi}~$\ocwstring{""}~\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{hidden\_input}~\ocwupperid{Save\_corpus\_params.}\ocwlowerid{state}~(\ocwlowerid{escape}~\ocwlowerid{query})~$\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{hidden\_input}~\ocwupperid{Save\_corpus\_params.}\ocwlowerid{nb\_sols}~(\ocwlowerid{nb\_sols}~|\ensuremath{>}~\ocwupperid{Num.}\ocwlowerid{string\_of\_num}~|\ensuremath{>}~\ocwlowerid{escape})~$\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{submit\_input}~$\ocwstring{"Save"}~\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{cgi\_end}~$\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{center\_end}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{quit\_button}~\ocwlowerid{corpmode}~\ocwlowerid{corpdir}~\ocwlowerid{sentno}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{submit\_button\_label}~=~\ocwupperid{Web\_corpus}.($\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwlowerid{corpmode}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Annotator}~\rightarrow{}~$\ocwstring{"Abort"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Reader}~\mid{}~\ocwupperid{Manager}~\rightarrow{}~$\ocwstring{"Continue\ocwvspace{}reading"}\ocweol
\ocwindent{2.00em}
$])$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{permission}~=~\ocwupperid{Web\_corpus.}\ocwlowerid{string\_of\_permission}~\ocwlowerid{corpmode}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{center\_begin}~$\^{}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{cgi\_begin}~(\ocwupperid{Cgi.}\ocwlowerid{url}~\ocwlowerid{corpus\_manager\_cgi}~$\~{}$\ocwlowerid{fragment}:\ocwlowerid{sentno})~$\ocwstring{""}~\^{}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{hidden\_input}~\ocwupperid{Params.}\ocwlowerid{corpus\_dir}~\ocwlowerid{corpdir}~$\^{}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{hidden\_input}~\ocwupperid{Params.}\ocwlowerid{corpus\_permission}~\ocwlowerid{permission}~$\^{}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{submit\_input}~\ocwlowerid{submit\_button\_label}~$\^{}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{cgi\_end}~$\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{center\_end}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Main body of graph segmenter cgi \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{graph\_engine}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwupperid{Prel.}\ocwlowerid{prelude}~()~$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{query}~=~\ocwupperid{Sys.}\ocwlowerid{getenv}~$\ocwstring{"QUERY\_STRING"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{env}~=~\ocwlowerid{create\_env}~\ocwlowerid{query}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{url\_encoded\_input}~=~\ocwlowerid{get}~$\ocwstring{"text"}~$\ocwlowerid{env}~$\ocwstring{""}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_topic}~=~\ocwlowerid{get}~$\ocwstring{"topic"}~$\ocwlowerid{env}~$\ocwstring{""}~\ocwbc{} topic carry-over \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{st}~=~\ocwlowerid{get}~$\ocwstring{"st"}~$\ocwlowerid{env}~$\ocwstring{"t"}~\ocwbc{} sentence parse default \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{cp}~=~\ocwlowerid{get}~$\ocwstring{"cp"}~$\ocwlowerid{env}~$\ocwstring{"t"}~\ocwbc{} complete mode default \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{us}~=~\ocwlowerid{get}~$\ocwstring{"us"}~$\ocwlowerid{env}~$\ocwstring{"f"}~\ocwbc{} sandhied text default \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{translit}~=~\ocwlowerid{get}~$\ocwstring{"t"}~$\ocwlowerid{env}~\ocwupperid{Paths.}\ocwlowerid{default\_transliteration}~$\ocwbc{} translit input \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{lex}~=~\ocwlowerid{get}~$\ocwstring{"lex"}~$\ocwlowerid{env}~\ocwupperid{Paths.}\ocwlowerid{default\_lexicon}~$\ocwbc{} lexicon choice \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{cache}~=~\ocwlowerid{get}~$\ocwstring{"cache"}~$\ocwlowerid{env}~$\ocwstring{"f"}~\ocwbc{} no cache default \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$()~=~\ocwlowerid{cache\_active.}\ocwlowerid{val}~:=~\ocwlowerid{cache}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{abs}~=~\ocwlowerid{get}~$\ocwstring{"abs"}~$\ocwlowerid{env}~$\ocwstring{"f"}~\ocwbc{} default local paths \ocwec{}~\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{lang}~=~\ocwlowerid{language\_of}~\ocwlowerid{lex}~$\ocwbc{} language default \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{input}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_input}~$\ocwbc{} unnormalized string \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{uns}~=~\ocwlowerid{us}=$\ocwstring{"t"}~\ocwbc{} unsandhied vs sandhied corpus \ocwec{}~\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$()~=~$\ocwkw{if}~$\ocwlowerid{st}=$\ocwstring{"f"}~\ocwkw{then}~$\ocwlowerid{iterate.}\ocwlowerid{val}:=\ocwupperid{False}~$\ocwkw{else}~$()~$\ocwbc{} word stemmer? \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$()~=~$\ocwkw{if}~$\ocwlowerid{cp}=$\ocwstring{"f"}~\ocwkw{then}~$\ocwlowerid{complete.}\ocwlowerid{val}:=\ocwupperid{False}~$\ocwkw{else}~$()~$\ocwbc{} simplified reader? \ocwec{}~\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$()~=~\ocwlowerid{toggle\_lexicon}~\ocwlowerid{lex}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{corpus}~=~\ocwlowerid{get}~$\ocwstring{"corpus"}~$\ocwlowerid{env}~$\ocwstring{""}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{sent\_id}~=~\ocwlowerid{get}~$\ocwstring{"sentenceNumber"}~$\ocwlowerid{env}~$\ocwstring{"0"}~\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{link\_num}~=~\ocwlowerid{get}~$\ocwstring{"linkNumber"}~$\ocwlowerid{env}~$\ocwstring{"0"}~\ocwbc{} is there a better default? \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{sol\_num}~=~\ocwlowerid{get}~$\ocwstring{"allSol"}~$\ocwlowerid{env}~$\ocwstring{"0"}~\ocwkw{in}~\ocwbc{} Needed for Validate mode \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{url\_enc\_corpus\_permission}~=$\ocweol
\ocwindent{3.00em}
$\ocwupperid{Cgi.}\ocwlowerid{get}~\ocwupperid{Params.}\ocwlowerid{corpus\_permission}~\ocwlowerid{env}~(\ocwlowerid{string\_of\_bool}~\ocwupperid{True})$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{corpus\_permission}~=$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{url\_enc\_corpus\_permission}$\ocweol
\ocwindent{3.00em}
|\ensuremath{>}~$\ocwupperid{Cgi.}\ocwlowerid{decode\_url}$\ocweol
\ocwindent{3.00em}
|\ensuremath{>}~$\ocwupperid{Web\_corpus.}\ocwlowerid{permission\_of\_string}$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{corpus\_dir}~=~\ocwupperid{Cgi.}\ocwlowerid{get}~\ocwupperid{Params.}\ocwlowerid{corpus\_dir}~\ocwlowerid{env}~$\ocwstring{""}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{sentence\_no}~=~\ocwupperid{Cgi.}\ocwlowerid{get}~\ocwupperid{Params.}\ocwlowerid{sentence\_no}~\ocwlowerid{env}~$\ocwstring{""}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{text}~=~\ocwlowerid{arguments}~\ocwlowerid{translit}~\ocwlowerid{lex}~\ocwlowerid{cache}~\ocwlowerid{st}~\ocwlowerid{us}~\ocwlowerid{cp}~\ocwlowerid{url\_encoded\_input}$\ocweol
\ocwindent{12.50em}
$\ocwlowerid{url\_encoded\_topic}~\ocwlowerid{abs}~\ocwlowerid{sol\_num}~\ocwlowerid{corpus}~\ocwlowerid{sent\_id}~\ocwlowerid{link\_num}$\ocweol
\ocwindent{12.50em}
$\ocwlowerid{url\_enc\_corpus\_permission}~\ocwlowerid{corpus\_dir}~\ocwlowerid{sentence\_no}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{checkpoints}~=~$\ocweol
\ocwindent{3.00em}
\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{url\_encoded\_cpts}~=~\ocwupperid{List.}\ocwlowerid{assoc}~$\ocwstring{"cpts"}~$\ocwlowerid{env}~$\ocwkw{in}~\ocwbc{} do not use get \ocwec{}\ocweol
\ocwindent{5.00em}
$\ocwlowerid{parse\_cpts}~(\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_cpts})$\ocweol
\ocwindent{3.00em}
\ocwkw{with}~$[~\ocwupperid{Not\_found}~\rightarrow{}~[\,]~]$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{guess\_morph}~=~\ocwlowerid{decode\_url}~(\ocwlowerid{get}~$\ocwstring{"guess"}~$\ocwlowerid{env}~$\ocwstring{""}$)~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{pseudo\_gender}~=~\ocwlowerid{decode\_url}~(\ocwlowerid{get}~$\ocwstring{"gender"}~$\ocwlowerid{env}~$\ocwstring{""}$)~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{\_}~=~$\ocwkw{if}~$\ocwupperid{String.}\ocwlowerid{length}~\ocwlowerid{guess\_morph}~>~0~\land{}~\ocwupperid{Paths.}\ocwlowerid{platform}=$\ocwstring{"Station"}~\ocwkw{then}\ocweol
\ocwindent{7.50em}
\ocwkw{let}~$(\ocwlowerid{entry},\ocwlowerid{gender})~=~$\ocwkw{match}~$\ocwlowerid{pseudo\_gender}~$\ocwkw{with}~\ocweol
\ocwindent{18.00em}
$[~$\ocwstring{""}~$\rightarrow{}~\ocwlowerid{parse\_guess}~\ocwlowerid{guess\_morph}~$\ocweol
\ocwindent{18.00em}
$\mid{}~\ocwlowerid{g}~\rightarrow{}~(\ocwlowerid{guess\_morph},\ocwlowerid{g})~$\ocweol
\ocwindent{18.00em}
$]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{7.50em}
\{~$\ocwlowerid{append\_cache}~\ocwlowerid{entry}~\ocwlowerid{gender}$\ocweol
\ocwindent{7.50em}
;~\ocwkw{let}~$\ocwlowerid{cache\_txt\_file}~=~\ocwlowerid{public\_cache\_txt\_file}~$\ocwkw{in}\ocweol
\ocwindent{8.50em}
\ocwkw{let}~$\ocwlowerid{cache}~=~\ocwupperid{Nouns.}\ocwlowerid{extract\_current\_cache}~\ocwlowerid{cache\_txt\_file}~$\ocwkw{in}\ocweol
\ocwindent{9.00em}
$\ocwlowerid{make\_cache\_transducer}~\ocwlowerid{cache}$\ocweol
\ocwindent{7.50em}
\}\ocweol
\ocwindent{6.00em}
\ocwkw{else}~$()~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{revised}~=~\ocwlowerid{decode\_url}~(\ocwlowerid{get}~$\ocwstring{"revised"}~$\ocwlowerid{env}~$\ocwstring{""}$)$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{rev\_off}~=~\ocwlowerid{int\_of\_string}~(\ocwlowerid{get}~$\ocwstring{"rev\_off"}~$\ocwlowerid{env}~$\ocwstring{"\symbol{45}1"}$)$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{rev\_ind}~=~\ocwlowerid{int\_of\_string}~(\ocwlowerid{get}~$\ocwstring{"rev\_ind"}~$\ocwlowerid{env}~$\ocwstring{"\symbol{45}1"}$)~$\ocwkw{in}\ocweol
\ocwindent{1.50em}
\ocwkw{try}~\ocwkw{do}\ocweol
\ocwindent{1.50em}
\{~\ocwkw{match}~$(\ocwlowerid{revised},\ocwlowerid{rev\_off},\ocwlowerid{rev\_ind})~$\ocwkw{with}\ocweol
\ocwindent{2.50em}
$[~($\ocwstring{""},-1,-1$)~\rightarrow{}~\ocwlowerid{check\_sentence}~\ocwlowerid{translit}~\ocwlowerid{uns}~\ocwlowerid{text}~\ocwlowerid{checkpoints}~$\ocweol
\ocwindent{18.00em}
$\ocwlowerid{input}~\ocwlowerid{sol\_num}~\ocwlowerid{corpus}~\ocwlowerid{sent\_id}~\ocwlowerid{link\_num}$\ocweol
\ocwindent{2.50em}
$\mid{}~(\ocwlowerid{new\_word},\ocwlowerid{word\_off},\ocwlowerid{chunk\_ind})~\rightarrow{}~$\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{chunks}~=~\ocwupperid{Sanskrit.}\ocwlowerid{read\_sanskrit}~(\ocwupperid{Encode.}\ocwlowerid{switch\_code}~\ocwlowerid{translit})~\ocwlowerid{input}~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{decoded}~\ocwlowerid{init}~\ocwlowerid{ind}~=~$\ocwkw{fun}\ocweol
\ocwindent{5.50em}
$[~[\,]~\rightarrow{}~\ocwupperid{String.}\ocwlowerid{sub}~\ocwlowerid{init}~0~((\ocwupperid{String.}\ocwlowerid{length}~\ocwlowerid{init})-1)$\ocweol
\ocwindent{5.50em}
$\mid{}~[~\ocwlowerid{a}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{7.50em}
\ocwkw{let}~$\ocwlowerid{ind'}~=~\ocwlowerid{ind}+1~$\ocweol
\ocwindent{7.50em}
\ocwkw{and}~$\ocwlowerid{init'}~=~$\ocwkw{if}~$\ocwlowerid{ind}~=~\ocwlowerid{chunk\_ind}~$\ocwkw{then}~$\ocwlowerid{init}~$\^{}~$\ocwlowerid{new\_word}~$\^{}~\ocwstring{"+"}\ocweol
\ocwindent{13.50em}
\ocwkw{else}~$\ocwlowerid{init}~$\^{}~$\ocwupperid{Canon.}\ocwlowerid{switch\_decode}~\ocwlowerid{translit}~\ocwlowerid{a}~$\^{}~\ocwstring{"+"}~\ocwkw{in}\ocweol
\ocwindent{7.50em}
$\ocwlowerid{decoded}~\ocwlowerid{init'}~\ocwlowerid{ind'}~\ocwlowerid{rest}$\ocweol
\ocwindent{5.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{updated\_input}~=~\ocwlowerid{decoded}~$\ocwstring{""}~1~$\ocwlowerid{chunks}~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{find\_word\_len}~\ocwlowerid{cur\_ind}~=~$\ocwkw{fun}~\ocweol
\ocwindent{5.50em}
$[~[\,]~\rightarrow{}~0$\ocweol
\ocwindent{5.50em}
$\mid{}~[~\ocwlowerid{a}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{cur\_ind}~=~\ocwlowerid{chunk\_ind}~$\ocwkw{then}~$\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{a}$\ocweol
\ocwindent{15.00em}
\ocwkw{else}~$\ocwlowerid{find\_word\_len}~(\ocwlowerid{cur\_ind}+1)~\ocwlowerid{rest}$\ocweol
\ocwindent{5.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{word\_len}~=~\ocwlowerid{find\_word\_len}~1~\ocwlowerid{chunks}~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{new\_chunk\_len}~=~\ocwupperid{Word.}\ocwlowerid{length}~(\ocwupperid{Encode.}\ocwlowerid{switch\_code}~\ocwlowerid{translit}~\ocwlowerid{revised})~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{diff}~=~\ocwlowerid{new\_chunk\_len}-\ocwlowerid{word\_len}~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{revised\_check}~=~$\ocweol
\ocwindent{4.50em}
\ocwkw{let}~$\ocwlowerid{revise}~(\ocwlowerid{k},\ocwlowerid{sec},\ocwlowerid{sel})~=~$\ocweol
\ocwindent{6.50em}
$($\ocwkw{if}~$\ocwlowerid{k}<\ocwlowerid{word\_off}~$\ocwkw{then}~$\ocwlowerid{k}~$\ocwkw{else}~$\ocwlowerid{k}+\ocwlowerid{diff},\ocwlowerid{sec},\ocwlowerid{sel})~$\ocwkw{in}\ocweol
\ocwindent{4.50em}
$\ocwupperid{List.}\ocwlowerid{map}~\ocwlowerid{revise}~\ocwlowerid{checkpoints}$\ocweol
\ocwindent{3.50em}
\ocwkw{and}~$\ocwlowerid{updated\_text}~=~\ocwlowerid{arguments}~\ocwlowerid{translit}~\ocwlowerid{lex}~\ocwlowerid{cache}~\ocwlowerid{st}~\ocwlowerid{us}~\ocwlowerid{cp}~\ocwlowerid{updated\_input}$\ocweol
\ocwindent{14.00em}
$\ocwlowerid{url\_encoded\_topic}~\ocwlowerid{abs}~\ocwlowerid{sol\_num}~\ocwlowerid{corpus}~\ocwlowerid{sent\_id}~\ocwlowerid{link\_num}$\ocweol
\ocwindent{14.00em}
$\ocwlowerid{url\_enc\_corpus\_permission}~\ocwlowerid{corpus\_dir}~\ocwlowerid{sentence\_no}$\ocweol
\ocwindent{3.50em}
\ocwkw{and}~$\ocwlowerid{new\_input}~=~\ocwlowerid{decode\_url}~\ocwlowerid{updated\_input}~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
$\ocwlowerid{check\_sentence}~\ocwlowerid{translit}~\ocwlowerid{uns}~\ocwlowerid{updated\_text}~\ocwlowerid{revised\_check}~$\ocweol
\ocwindent{17.00em}
$\ocwlowerid{new\_input}~\ocwlowerid{sol\_num}~\ocwlowerid{corpus}~\ocwlowerid{sent\_id}~\ocwlowerid{link\_num}$\ocweol
\ocwindent{2.50em}
$]$\ocweol
\ocwindent{2.50em}
\ocwbc{} automatically refreshing the page only if guess parameter \ocwec{}\ocweol
\ocwindent{1.50em}
;~\ocwkw{if}~$\ocwupperid{String.}\ocwlowerid{length}~\ocwlowerid{guess\_morph}~>~0~$\ocwkw{then}~\ocweol
\ocwindent{4.00em}
$\ocwlowerid{ps}~($\ocwstring{"\ensuremath{<}script\ensuremath{>}\symbol{92}nwindow.onload\ocwvspace{}=\ocwvspace{}function\ocwvspace{}()\ocwvspace{}\{window.location=\symbol{92}""}~\^{}\ocweol
\ocwindent{6.00em}
$\ocwlowerid{graph\_cgi}~$\^{}~\ocwstring{"?"}~\^{}~$\ocwlowerid{text}~$\^{}~\ocweol
\ocwindent{6.00em}
\ocwstring{";cpts="}~\^{}~$(\ocwlowerid{string\_points}~\ocwlowerid{checkpoints})~$\^{}~\ocwstring{"\symbol{92}";\}\symbol{92}n\ensuremath{<}/script\ensuremath{>}"}$)$\ocweol
\ocwindent{2.50em}
\ocwkw{else}~$()$\ocweol
\ocwindent{2.50em}
\ocwbc{} Save sentence button \ocwec{}\ocweol
\ocwindent{1.50em}
;~\ocwkw{if}~$\ocwlowerid{corpus\_permission}~=~\ocwupperid{Web\_corpus.Annotator}~$\ocwkw{then}\ocweol
\ocwindent{2.50em}
\ocwbc{} TODO: use \ocwbegindcode{}$\ocwlowerid{segment\_all}$\ocwenddcode{} to compute the nb of sols instead of
        passing 0 to \ocwbegindcode{}$\ocwlowerid{nb\_sols}$\ocwenddcode{}.  \ocwec{}\ocweol
\ocwindent{3.50em}
$\ocwlowerid{save\_button}~\ocwlowerid{query}~(\ocwupperid{Num.}\ocwlowerid{num\_of\_int}~0)~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{2.50em}
\ocwkw{else}~$()$\ocweol
\ocwindent{1.50em}
;~$\ocwlowerid{html\_break}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{2.50em}
\ocwbc{} Quit button: continue reading (reader mode) or quit without
        saving (annotator mode).  \ocwec{}\ocweol
\ocwindent{1.50em}
;~\ocwkw{if}~$\ocwlowerid{sentence\_no}~\not=~$\ocwstring{""}~\ocwkw{then}\ocweol
\ocwindent{3.50em}
$\ocwlowerid{quit\_button}~\ocwlowerid{corpus\_permission}$\ocweol
\ocwindent{4.50em}
$(\ocwupperid{Cgi.}\ocwlowerid{decode\_url}~\ocwlowerid{corpus\_dir})~(\ocwupperid{Cgi.}\ocwlowerid{decode\_url}~\ocwlowerid{sentence\_no})~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{2.50em}
\ocwkw{else}~$()$\ocweol
\ocwindent{1.50em}
;~$\ocwlowerid{close\_page\_with\_margin}~()$\ocweol
\ocwindent{1.50em}
;~$\ocwlowerid{page\_end}~\ocwlowerid{lang}~\ocwupperid{True}$\ocweol
\ocwindent{1.50em}
\}\ocweol
\ocwindent{1.50em}
\ocwkw{with}~\ocweol
\ocwindent{0.50em}
$[~\ocwupperid{Sys\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{sys\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwupperid{Stream.Error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{stream\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwupperid{Encode.In\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~$\ocwstring{"Wrong\ocwvspace{}input\ocwvspace{}"}~$\ocwlowerid{s}$\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwupperid{Exit}~$\ocwbc{} Sanskrit \ocwec{}~$\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~$\ocwstring{"Wrong\ocwvspace{}character\ocwvspace{}in\ocwvspace{}input"}~\ocwstring{""}~\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwupperid{Overflow}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~$\ocwstring{"Maximum\ocwvspace{}input\ocwvspace{}size\ocwvspace{}exceeded"}~\ocwstring{""}\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwupperid{Invalid\_argument}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} sub \ocwec{}\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwupperid{Failure}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwupperid{End\_of\_file}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"EOF"}~\ocwbc{} EOF \ocwec{}\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwupperid{Not\_found}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{s}~=~$\ocwstring{"You\ocwvspace{}must\ocwvspace{}choose\ocwvspace{}a\ocwvspace{}parsing\ocwvspace{}option"}~\ocwkw{in}\ocweol
\ocwindent{13.00em}
$\ocwlowerid{abort}~\ocwlowerid{lang}~$\ocwstring{"Unset\ocwvspace{}button\ocwvspace{}in\ocwvspace{}form\ocwvspace{}\symbol{45}\ocwvspace{}"}~$\ocwlowerid{s}$\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwupperid{Control.Fatal}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwupperid{Control.Anomaly}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{anomaly\_err\_mess}~\ocwlowerid{s}$\ocweol
\ocwindent{0.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"Unexpected\ocwvspace{}anomaly"}~\ocweol
\ocwindent{0.50em}
$]$\ocweol
\ocwindent{0.50em}
\}\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{safe\_engine}~()~=$\ocweol
\ocwindent{1.00em}
\ocwbc{} Problem: in case of error, we lose the current language of the session \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{abor}~=~\ocwlowerid{abort}~\ocwlowerid{default\_language}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwlowerid{graph\_engine}~()~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Failure}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{parse\_cpts}~\ocwlowerid{phase\_string}$\ocwenddcode{} ? \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"Unexpected\ocwvspace{}anomaly\ocwvspace{}\symbol{45}\ocwvspace{}broken\ocwvspace{}session"}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}~\ocwbc{} Interface \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwupperid{Interface.}\ocwlowerid{safe\_engine}~()~$\ocwbc{} Should always produce a compliant xhtml page \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file User_aid.ml}
\ocwmodule{User\_aid}
\label{user_aid.ml:0}%
Sanskrit Reader summarizing interface. User aid with unrecognized segs. 
\ocweol
\label{user_aid.ml:698}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps pl abort etc. \ocwbegindcode{}$\ocwlowerid{remote\_server\_host}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Cgi};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Phases};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Checkpoints};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{phase\_encode}$\ocwenddcode{} \ocwec{}\medskip

\label{user_aid.ml:827}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Prel}~=~$\ocwkw{struct}~\ocwbc{} Interface's lexer prelude \ocwec{}\ocweol
\ocwindent{0.50em}
$\ocwlowerid{value}~\ocwlowerid{prelude\_user}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{http\_header}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_begin}~\ocwlowerid{user\_aid\_meta\_title}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{body\_begin}~\ocwupperid{Chamois\_back})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{user\_aid\_title}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{open\_page\_with\_margin}~15$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.50em}
;\ocweol
\ocwindent{0.50em}
\ocwkw{end}~\ocwbc{} Prel \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rpc}~=~\ocwlowerid{remote\_server\_host}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{remote}~=~$\ocwbt{ref}~$\ocwupperid{False}~$\ocwbc{} local invocation of cgi by default \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{string\_point}~(\ocwlowerid{offset},\ocwlowerid{len\_chunk})~(\ocwlowerid{k},(\ocwlowerid{phase},\ocwlowerid{rword}),\ocwlowerid{select})~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pada}~=~\ocwupperid{Canon.}\ocwlowerid{rdecode}~\ocwlowerid{rword}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{updated\_k}~=~$\ocwkw{if}~$\ocwlowerid{k}~<~\ocwlowerid{offset}~$\ocwkw{then}~$\ocwlowerid{k}~$\ocwkw{else}~$(\ocwlowerid{k}-\ocwlowerid{len\_chunk}-1)~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{string\_of\_int}~\ocwlowerid{updated\_k}~$\^{}~\ocwstring{","}~\^{}~$\ocwlowerid{phase\_encode}~\ocwlowerid{phase}~$\^{}~\ocwstring{",\{"}~\^{}~$\ocwlowerid{pada}~$\^{}~\ocwstring{"\},\{"}~\ocweol
\ocwindent{13.00em}
\^{}~$\ocwlowerid{bool\_encode}~\ocwlowerid{select}~$\^{}~\ocwstring{"\}"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{string\_points}~\ocwlowerid{off}~=~$\ocwkw{fun}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{off}~=~(\ocwlowerid{offset},\ocwlowerid{len\_chunk})$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{last}~]~\rightarrow{}~\ocwlowerid{string\_point}~\ocwlowerid{off}~\ocwlowerid{last}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{first}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{string\_point}~\ocwlowerid{off}~\ocwlowerid{first}~$\^{}~\ocwstring{"|"}~\^{}~$\ocwlowerid{string\_points}~\ocwlowerid{off}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{call\_partial}~\ocwlowerid{text}~(\ocwlowerid{offset},\ocwlowerid{len\_chunk})~\ocwlowerid{cpts}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{list\_points}~=~$\ocwkw{match}~$\ocwlowerid{cpts}~$\ocwkw{with}~\ocweol
\ocwindent{3.50em}
$[~[\,]~\rightarrow{}~[\,]$\ocweol
\ocwindent{3.50em}
$\mid{}~[~\ocwlowerid{\_}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{rest}$\ocweol
\ocwindent{3.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{cgi}~=~\ocwlowerid{graph\_cgi}~$\^{}~\ocwstring{"?"}~\^{}~$\ocwlowerid{text}~$\^{}~\ocwstring{";cpts="}~\^{}~\ocweol
\ocwindent{6.00em}
$(\ocwlowerid{string\_points}~(\ocwlowerid{offset},\ocwlowerid{len\_chunk})~\ocwlowerid{list\_points})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{invocation}~=~$\ocwkw{if}~$\ocwlowerid{remote.}\ocwlowerid{val}~$\ocwkw{then}~$\ocwlowerid{rpc}~$\^{}~$\ocwlowerid{cgi}~$\ocwkw{else}~$\ocwlowerid{cgi}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{anchor}~\ocwupperid{Green\_}~\ocwlowerid{invocation}~\ocwlowerid{check\_sign}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{string\_point\_orig}~(\ocwlowerid{k},(\ocwlowerid{phase},\ocwlowerid{rword}),\ocwlowerid{select})~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pada}~=~\ocwupperid{Canon.}\ocwlowerid{rdecode}~\ocwlowerid{rword}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{string\_of\_int}~\ocwlowerid{k}~$\^{}~\ocwstring{","}~\^{}~$\ocwlowerid{phase\_encode}~\ocwlowerid{phase}~$\^{}~\ocwstring{",\{"}~\^{}~$\ocwlowerid{pada}~$\^{}~\ocwstring{"\},\{"}\ocweol
\ocwindent{10.00em}
\^{}~$\ocwlowerid{bool\_encode}~\ocwlowerid{select}~$\^{}~\ocwstring{"\}"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{string\_points\_orig}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{last}~]~\rightarrow{}~\ocwlowerid{string\_point\_orig}~\ocwlowerid{last}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{first}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{string\_point\_orig}~\ocwlowerid{first}~$\^{}~\ocwstring{"|"}~\^{}~$\ocwlowerid{string\_points\_orig}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{cpt\_partial}~\ocwlowerid{cpts}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{list\_points}~=~$\ocwkw{match}~$\ocwlowerid{cpts}~$\ocwkw{with}~\ocweol
\ocwindent{3.00em}
$[~[\,]~\rightarrow{}~[\,]$\ocweol
\ocwindent{3.00em}
$\mid{}~[~\ocwlowerid{\_}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{rest}$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{string\_points\_orig}~\ocwlowerid{list\_points}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Parsing mandatory checkpoints \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Checkpoints};$\medskip

\label{user_aid.ml:2623}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sort\_check}~\ocwlowerid{cpts}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{compare\_index}~(\ocwlowerid{a},\ocwlowerid{\_},\ocwlowerid{\_})~(\ocwlowerid{b},\ocwlowerid{\_},\ocwlowerid{\_})~=~\ocwlowerid{compare}~\ocwlowerid{a}~\ocwlowerid{b}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{sort}~\ocwlowerid{compare\_index}~\ocwlowerid{cpts}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{find\_chunk}~\ocwlowerid{chunks}~\ocwlowerid{ind}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~0~\rightarrow{}~\ocwlowerid{ind}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{l}~\rightarrow{}~$\ocwkw{match}~$\ocwlowerid{chunks}~$\ocwkw{with}\ocweol
\ocwindent{4.50em}
$[~[~\ocwlowerid{a}~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{find\_chunk}~\ocwlowerid{rest}~(\ocwlowerid{ind}+1)~(\ocwlowerid{l}-((\ocwupperid{List.}\ocwlowerid{length}~\ocwlowerid{a})+1))~$\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~-1$\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{user\_cgi\_begin}~\ocwlowerid{cgi}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"form"}~\ocweol
\ocwindent{2.00em}
$[~($\ocwstring{"action"},$\ocwlowerid{cgi});~($\ocwstring{"method"},\ocwstring{"get"}$)~]~$\ocwbc{} input conversion script \ocwec{}\ocweol
\ocwindent{1.00em}
\^{}~$\ocwlowerid{xml\_begin}~$\ocwstring{"div"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{arguments}~\ocwlowerid{trs}~\ocwlowerid{lex}~\ocwlowerid{cache}~\ocwlowerid{st}~\ocwlowerid{us}~\ocwlowerid{cp}~\ocwlowerid{input}~\ocwlowerid{topic}~\ocwlowerid{abs}~\ocwlowerid{corpus}~\ocwlowerid{sent\_id}~\ocwlowerid{link\_num}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{corpus\_link}~=~$\ocwkw{match}~$\ocwlowerid{corpus}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~$\ocwstring{""}~$\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{";corpus="}~\^{}~$\ocwlowerid{corpus}~$\^{}~\ocwstring{";sentenceNumber="}~\^{}~$\ocwlowerid{sent\_id}~$\^{}~\ocweol
\ocwindent{6.50em}
\ocwstring{";linkNumber="}~\^{}~$\ocwlowerid{link\_num}$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwstring{"t="}~\^{}~$\ocwlowerid{trs}~$\^{}~\ocwstring{";lex="}~\^{}~$\ocwlowerid{lex}~$\^{}~\ocwstring{";cache="}~\^{}~$\ocwlowerid{cache}~$\^{}~\ocwstring{";st="}~\^{}~$\ocwlowerid{st}~$\^{}~\ocweol
\ocwindent{1.00em}
\ocwstring{";us="}~\^{}~$\ocwlowerid{us}~$\^{}~\ocwstring{";cp="}~\^{}~$\ocwlowerid{cp}~$\^{}~\ocwstring{";text="}~\^{}~$\ocwlowerid{input}~$\^{}~\ocwstring{";topic="}~\^{}~$\ocwlowerid{topic}~$\^{}~\ocweol
\ocwindent{1.00em}
\ocwstring{";abs="}~\^{}~$\ocwlowerid{abs}~$\^{}~$\ocwlowerid{corpus\_link}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_hidden}~\ocwlowerid{topic}~\ocwlowerid{st}~\ocwlowerid{cp}~\ocwlowerid{us}~\ocwlowerid{lex}~\ocwlowerid{cache}~\ocwlowerid{abs}~\ocwlowerid{translit}~\ocwlowerid{corpus}~\ocwlowerid{sent\_id}~$\ocweol
\ocwindent{9.50em}
$\ocwlowerid{link\_num}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"topic"}~$\ocwlowerid{topic})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"st"}~$\ocwlowerid{st})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"cp"}~$\ocwlowerid{cp})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"us"}~$\ocwlowerid{us})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"t"}~$\ocwlowerid{translit})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"lex"}~$\ocwlowerid{lex})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"cache"}~$\ocwlowerid{cache})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"abs"}~$\ocwlowerid{abs})$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{corpus}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{""}~$\rightarrow{}~()$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{corpus\_val}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"corpus"}~$\ocwlowerid{corpus\_val})$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"sentenceNumber"}~$\ocwlowerid{sent\_id})$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"linkNumber"}~$\ocwlowerid{link\_num})$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{read\_guess\_index}~()~=~$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwlowerid{public\_guess\_auto}~:~\ocwupperid{Deco.}\ocwlowerid{deco}~($\ocwbt{string}~$\times{}~$\ocwbt{string}$))~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{read\_mw\_index}~()~=~$\ocweol
\ocwindent{1.00em}
$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwlowerid{public\_mw\_index\_file}:~\ocwupperid{Deco.}\ocwlowerid{deco}~($\ocwbt{string}~$\times{}~$\ocwbt{string}~$\times{}~$\ocwbt{string}$))$\ocweol
\ocwindent{0.00em}
;\medskip

\label{user_aid.ml:4278}%
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{mw\_sol}~\ocwlowerid{cur\_sol}~\ocwlowerid{word}~=~$\ocwkw{fun}\ocweol
\ocwindent{0.50em}
$[~[\,]~\rightarrow{}~\ocwlowerid{cur\_sol}$\ocweol
\ocwindent{0.50em}
$\mid{}~[~(\ocwlowerid{entry},\ocwlowerid{lex},\ocwlowerid{page})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{updated\_sol}~=~$\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwlowerid{lex}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"Noun"}~$\mid{}~$\ocwstring{"Ind."}~$\rightarrow{}~\ocwlowerid{cur\_sol}~$\^{}~$\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_anchor\_M}~\ocwlowerid{word}~\ocwlowerid{entry}~\ocwlowerid{page}~\ocwupperid{False}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{cur\_sol}$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~$\ocwlowerid{mw\_sol}~\ocwlowerid{updated\_sol}~\ocwlowerid{word}~\ocwlowerid{rest}$\ocweol
\ocwindent{0.50em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
function to find only the gender 
\ocweol
\label{user_aid.ml:4588}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{find\_gen}~\ocwlowerid{morph}~=~\ocwupperid{String.}\ocwlowerid{sub}~\ocwlowerid{morph}~(\ocwupperid{String.}\ocwlowerid{length}~\ocwlowerid{morph}~-2)~2~$\ocweol
\ocwindent{0.00em}
;\medskip

\label{user_aid.ml:4659}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_word}~\ocwlowerid{word}~(\ocwlowerid{entry},\ocwlowerid{morph})~=~$\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$\ocwlowerid{final\_ent}~=~\ocwlowerid{word}~$\^{}~$\ocwlowerid{entry}~$\ocwkw{in}\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$\ocwlowerid{mw\_index}~=~\ocwlowerid{read\_mw\_index}~()~$\ocwkw{in}~\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$\ocwlowerid{words}~=~\ocwupperid{List.}\ocwlowerid{rev}~(\ocwupperid{Deco.}\ocwlowerid{assoc}~(\ocwupperid{Encode.}\ocwlowerid{code\_string}~\ocwlowerid{final\_ent})~\ocwlowerid{mw\_index})~$\ocwkw{in}~\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$\ocwlowerid{header}~=~\ocwlowerid{td\_begin}~$\^{}~$(\ocwlowerid{table\_begin}~\ocwupperid{Deep\_sky\_back})~$\^{}~\ocweol
\ocwindent{8.00em}
$\ocwlowerid{tr\_begin}~$\^{}~$\ocwlowerid{th\_begin}$\ocweol
\ocwindent{1.50em}
\ocwkw{and}~$(\ocwlowerid{sol},~\ocwlowerid{is\_checked})~=~$\ocwkw{match}~$\ocwlowerid{words}~$\ocwkw{with}\ocweol
\ocwindent{4.50em}
$[~[\,]~\rightarrow{}~($\ocwstring{"\ocwvspace{}["}~\^{}~$\ocwupperid{Html.}\ocwlowerid{anchor\_begin}~$\^{}~$\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_roma}~\ocwlowerid{final\_ent}~$\^{}~\ocweol
\ocwindent{12.50em}
$\ocwlowerid{xml\_end}~$\ocwstring{"a"}~\^{}~\ocwstring{"]"},~$\ocwupperid{False})$\ocweol
\ocwindent{4.50em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{mw\_solution}~=~\ocwlowerid{mw\_sol}~$\ocwstring{""}~$\ocwlowerid{final\_ent}~\ocwlowerid{words}~$\ocwkw{in}\ocweol
\ocwindent{9.00em}
\ocwkw{if}~$(\ocwupperid{String.}\ocwlowerid{length}~\ocwlowerid{mw\_solution})~>~0~$\ocwkw{then}~\ocweol
\ocwindent{11.50em}
$($\ocwstring{"\ocwvspace{}["}~\^{}~$\ocwlowerid{mw\_solution}~$\^{}~\ocwstring{"]"},~$\ocwupperid{True})$\ocweol
\ocwindent{9.00em}
\ocwkw{else}~$($\ocwstring{"\ocwvspace{}["}~\^{}~$\ocwupperid{Html.}\ocwlowerid{anchor\_begin}~$\^{}~$\ocwupperid{Morpho\_html.}\ocwlowerid{skt\_roma}~\ocwlowerid{final\_ent}$\ocweol
\ocwindent{14.50em}
\^{}~$\ocwlowerid{xml\_end}~$\ocwstring{"a"}~\^{}~\ocwstring{"]"},~$\ocwupperid{False})$\ocweol
\ocwindent{4.50em}
$]$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{footer}~=~\ocwlowerid{th\_end}~$\^{}~$\ocwlowerid{tr\_end}~$\^{}~$\ocwlowerid{table\_end}~$\^{}~$\ocwlowerid{td\_end}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{radio}~=~(\ocwupperid{Html.}\ocwlowerid{radio\_input\_dft}~$\ocwstring{"guess"}~$($\ocwstring{"\{"}~\^{}~$\ocwlowerid{final\_ent}~$\^{}~\ocwstring{"\},\{"}~\^{}~\ocweol
\ocwindent{10.50em}
$\ocwlowerid{find\_gen}~\ocwlowerid{morph}~$\^{}~\ocwstring{"\}"}$)~$\ocwstring{""}~$\ocwlowerid{is\_checked})~$\^{}~$\ocwlowerid{morph}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{header}~$\^{}~$\ocwlowerid{radio}~$\^{}~$\ocwlowerid{sol}~$\^{}~$\ocwlowerid{footer}$\ocweol
\ocwindent{0.00em}
;\medskip

\label{user_aid.ml:5687}%
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{string\_word}~\ocwlowerid{sol\_st}~\ocwlowerid{word}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{sol\_st}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{a}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{new\_sol}~=~\ocwlowerid{sol\_st}~$\^{}~$(\ocwlowerid{print\_word}~\ocwlowerid{word}~\ocwlowerid{a})~$\ocwkw{in}\ocweol
\ocwindent{10.50em}
$\ocwlowerid{string\_word}~\ocwlowerid{new\_sol}~\ocwlowerid{word}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
We should replace the following function by a more standard primitive 
\ocweol
\label{user_aid.ml:5945}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{normalize\_end}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{a}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{normalized\_a}~=~$\ocwkw{match}~$\ocwlowerid{a}~$\ocwkw{with}\ocweol
\ocwindent{11.50em}
$[~16~\rightarrow{}~48~$\ocwbc{} .h -> s \ocwec{}\ocweol
\ocwindent{11.50em}
$\mid{}~14~\rightarrow{}~41~$\ocwbc{} .m -> m \ocwec{}\ocweol
\ocwindent{11.50em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~\ocwlowerid{c}$\ocweol
\ocwindent{11.50em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
$[~\ocwlowerid{normalized\_a}~::~\ocwlowerid{rest}~]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{other}~\rightarrow{}~\ocwlowerid{other}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\label{user_aid.ml:6241}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{aid\_using}~\ocwlowerid{translit}~\ocwlowerid{checkpts}~\ocwlowerid{sentence}~\ocwlowerid{topic}~\ocwlowerid{st}~\ocwlowerid{cp}~\ocwlowerid{us}~\ocwlowerid{lex}~\ocwlowerid{cache}~\ocwlowerid{abs}~$\ocweol
\ocwindent{8.00em}
$\ocwlowerid{corpus}~\ocwlowerid{sent\_id}~\ocwlowerid{link\_num}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{encode}~=~\ocwupperid{Encode.}\ocwlowerid{switch\_code}~\ocwlowerid{translit}~$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{decode}~=~\ocwupperid{Canon.}\ocwlowerid{switch\_decode}~\ocwlowerid{translit}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{chunks}~=~\ocwupperid{Sanskrit.}\ocwlowerid{read\_sanskrit}~\ocwlowerid{encode}~\ocwlowerid{sentence}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{devachunks}~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwupperid{Canon.}\ocwlowerid{unidevcode}~\ocwlowerid{chunks}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{devainput}~=~\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{"\ocwvspace{}"}~$\ocwlowerid{devachunks}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{html\_latin16}~$\ocwstring{"Sentence:\ocwvspace{}"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{deva16\_blue}~\ocwlowerid{devainput})~$\ocwbc{} devanagari \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{user\_cgi\_begin}~\ocwlowerid{graph\_cgi})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_hidden}~\ocwlowerid{topic}~\ocwlowerid{st}~\ocwlowerid{cp}~\ocwlowerid{us}~\ocwlowerid{lex}~\ocwlowerid{cache}~\ocwlowerid{abs}~\ocwlowerid{translit}~\ocwlowerid{corpus}~\ocwlowerid{sent\_id}~\ocwlowerid{link\_num}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"textarea"}~\ocweol
\ocwindent{3.00em}
$[~($\ocwstring{"name"},\ocwstring{"text"}$);~($\ocwstring{"rows"},\ocwstring{"1"}$);~($\ocwstring{"cols"},\ocwstring{"100"}$)~]~$\^{}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{sentence}~$\^{}~$\ocwlowerid{xml\_end}~$\ocwstring{"textarea"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{submit\_input}~$\ocwstring{"Submit\ocwvspace{}Revised\ocwvspace{}Sentence"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{cgi\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{user\_cgi\_begin}~\ocwlowerid{graph\_cgi})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_hidden}~\ocwlowerid{topic}~\ocwlowerid{st}~\ocwlowerid{cp}~\ocwlowerid{us}~\ocwlowerid{lex}~\ocwlowerid{cache}~\ocwlowerid{abs}~\ocwlowerid{translit}~\ocwlowerid{corpus}~\ocwlowerid{sent\_id}~\ocwlowerid{link\_num}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"text"}~$\ocwlowerid{sentence})$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$(\ocwlowerid{offset},~\ocwlowerid{chunk\_rev})~=~$\ocwkw{match}~$\ocwlowerid{checkpts}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~[~(\ocwlowerid{k},(\ocwlowerid{\_},\ocwlowerid{word}),\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~\rightarrow{}~(\ocwlowerid{k},~\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{word})$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~(0,[\,])$\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{len\_chunk}~=~\ocwupperid{Word.}\ocwlowerid{length}~\ocwlowerid{chunk\_rev}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{chunk\_ind}~=~\ocwlowerid{find\_chunk}~\ocwlowerid{chunks}~1~\ocwlowerid{offset}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"textarea"}~\ocweol
\ocwindent{4.50em}
$[~($\ocwstring{"name"},\ocwstring{"revised"}$);~($\ocwstring{"rows"},\ocwstring{"1"}$);~($\ocwstring{"cols"},\ocwstring{"30"}$)~]~$\^{}\ocweol
\ocwindent{4.50em}
$(\ocwlowerid{decode}~\ocwlowerid{chunk\_rev})~$\^{}~$\ocwlowerid{xml\_end}~$\ocwstring{"textarea"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"rev\_off"}~$(\ocwlowerid{string\_of\_int}~\ocwlowerid{offset}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"rev\_ind"}~$(\ocwlowerid{string\_of\_int}~\ocwlowerid{chunk\_ind}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"cpts"}~$(\ocwlowerid{cpt\_partial}~\ocwlowerid{checkpts}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{submit\_input}~$\ocwstring{"Submit\ocwvspace{}Revised\ocwvspace{}Chunk"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{cgi\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwupperid{List.}\ocwlowerid{length}~\ocwlowerid{chunks}~>~1~$\ocwkw{then}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{div\_begin}~\ocwupperid{Latin12})$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{pl}~(\ocwlowerid{table\_begin}~\ocwupperid{Spacing20})$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{pl}~\ocwlowerid{tr\_begin}$\ocweol
\ocwindent{2.50em}
;~\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{decoded}~\ocwlowerid{init}~\ocwlowerid{cur\_ind}~=~$\ocwkw{fun}\ocweol
\ocwindent{5.50em}
$[~[\,]~\rightarrow{}~\ocwupperid{String.}\ocwlowerid{sub}~\ocwlowerid{init}~0~((\ocwupperid{String.}\ocwlowerid{length}~\ocwlowerid{init})-1)$\ocweol
\ocwindent{5.50em}
$\mid{}~[~\ocwlowerid{a}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{7.50em}
\ocwkw{if}~$\ocwlowerid{cur\_ind}~=~\ocwlowerid{chunk\_ind}~$\ocwkw{then}~$\ocwlowerid{decoded}~\ocwlowerid{init}~(\ocwlowerid{cur\_ind}+1)~\ocwlowerid{rest}$\ocweol
\ocwindent{7.50em}
\ocwkw{else}~$\ocwlowerid{decoded}~(\ocwlowerid{init}~$\^{}~$(\ocwlowerid{decode}~\ocwlowerid{a})~$\^{}~\ocwstring{"+"}$)~(\ocwlowerid{cur\_ind}+1)~\ocwlowerid{rest}$\ocweol
\ocwindent{5.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{updated\_text}~=~\ocwlowerid{decoded}~$\ocwstring{""}~1~$\ocwlowerid{chunks}~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
\ocwkw{let}~$\ocwlowerid{arg\_string}~=~\ocwlowerid{arguments}~\ocwlowerid{translit}~\ocwlowerid{lex}~\ocwlowerid{cache}~\ocwlowerid{st}~\ocwlowerid{us}~\ocwlowerid{cp}~\ocwlowerid{updated\_text}~\ocwlowerid{topic}$\ocweol
\ocwindent{17.00em}
$\ocwlowerid{abs}~\ocwlowerid{corpus}~\ocwlowerid{sent\_id}~\ocwlowerid{link\_num}~$\ocwkw{in}\ocweol
\ocwindent{3.50em}
$\ocwlowerid{ps}~(\ocwlowerid{td\_wrap}~(\ocwlowerid{call\_partial}~\ocwlowerid{arg\_string}~(\ocwlowerid{offset},\ocwlowerid{len\_chunk})~\ocwlowerid{checkpts}$\ocweol
\ocwindent{10.00em}
\^{}~\ocwstring{"Show\ocwvspace{}partial\ocwvspace{}solution\ocwvspace{}without\ocwvspace{}this\ocwvspace{}chunk"}$))$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{pl}~\ocwlowerid{tr\_end}$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{pl}~\ocwlowerid{table\_end}$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{ps}~\ocwlowerid{div\_end}~$\ocwbc{} Latin12 \ocwec{}\ocweol
\ocwindent{2.50em}
\}\ocweol
\ocwindent{1.50em}
\ocwkw{else}~$()$\ocweol
\ocwindent{1.00em}
\ocwbc{} adding new module to show the possibilities \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwupperid{Paths.}\ocwlowerid{platform}~=~$\ocwstring{"Station"}~\ocwkw{then}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{html\_paragraph}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{div\_begin}~\ocwupperid{Latin16})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"Possible\ocwvspace{}lemmatizations\ocwvspace{}for\ocwvspace{}the\ocwvspace{}chunk:"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{div\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{par\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{div\_begin}~\ocwupperid{Latin12})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{user\_cgi\_begin}~\ocwlowerid{graph\_cgi})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_hidden}~\ocwlowerid{topic}~\ocwlowerid{st}~\ocwlowerid{cp}~\ocwlowerid{us}~\ocwlowerid{lex}~\ocwlowerid{cache}~\ocwlowerid{abs}~\ocwlowerid{translit}~\ocwlowerid{corpus}~\ocwlowerid{sent\_id}~\ocwlowerid{link\_num}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"cpts"}~$(\ocwlowerid{cpt\_partial}~\ocwlowerid{checkpts}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"text"}~$\ocwlowerid{sentence})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{guess\_auto}~=~\ocwlowerid{read\_guess\_index}~()~$\ocwkw{in}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{match\_decl}~\ocwlowerid{sol\_string}~\ocwlowerid{init}~=~$\ocwbc{} init is the last \ocwec{}~\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{sol\_string}$\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{a}~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{updated\_init}~=~[~\ocwlowerid{a}~::~\ocwlowerid{init}~]~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{words}~=~\ocwupperid{List.}\ocwlowerid{rev}~(\ocwupperid{Deco.}\ocwlowerid{assoc}~(\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{updated\_init})~\ocwlowerid{guess\_auto})~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{new\_sol}~=~$\ocwkw{match}~$\ocwlowerid{words}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{sol\_string}$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{str\_rest}~=~\ocwupperid{Canon.}\ocwlowerid{decode}~(\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{rest})~$\ocwkw{in}\ocweol
\ocwindent{8.50em}
\ocwkw{let}~$\ocwlowerid{lemma}~=~\ocwlowerid{string\_word}~$\ocwstring{""}~$\ocwlowerid{str\_rest}~\ocwlowerid{words}~$\ocwkw{in}\ocweol
\ocwindent{8.50em}
\ocwkw{let}~$\ocwlowerid{this\_string}~=~\ocwlowerid{tr\_begin}~$\^{}~$\ocwlowerid{lemma}~$\^{}~$\ocwlowerid{tr\_end}~$\ocwkw{in}\ocweol
\ocwindent{8.50em}
$[~\ocwlowerid{this\_string}~::~\ocwlowerid{sol\_string}~]$\ocweol
\ocwindent{5.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{match\_decl}~\ocwlowerid{new\_sol}~\ocwlowerid{updated\_init}~\ocwlowerid{rest}$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{table\_begin\_style}~\ocwupperid{Blue\_}~[~\ocwlowerid{noborder};~($\ocwstring{"align"},\ocwstring{"center"}$);~\ocwlowerid{spacing20}~])~$\ocweol
\ocwindent{1.00em}
;~$\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{pl}~(\ocwlowerid{match\_decl}~[\,]~[\,]~(\ocwlowerid{normalize\_end}~(\ocwupperid{List.}\ocwlowerid{rev}~\ocwlowerid{chunk\_rev})))~$\ocweol
\ocwindent{2.00em}
\ocwbc{} \ocwbegindcode{}$[\,]=\ocwlowerid{sol\_string},~[\,]=\ocwlowerid{last}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{table\_end}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{submit\_input}~$\ocwstring{"Submit\ocwvspace{}Morphology"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{cgi\_end}~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{graph\_cgi}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{div\_end}~$\ocwbc{} Latin12 \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{par\_begin}~\ocwupperid{Latin16})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"Enter\ocwvspace{}your\ocwvspace{}own\ocwvspace{}lemmatization:"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{par\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{user\_cgi\_begin}~\ocwlowerid{graph\_cgi})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_hidden}~\ocwlowerid{topic}~\ocwlowerid{st}~\ocwlowerid{cp}~\ocwlowerid{us}~\ocwlowerid{lex}~\ocwlowerid{cache}~\ocwlowerid{abs}~\ocwlowerid{translit}~\ocwlowerid{corpus}~\ocwlowerid{sent\_id}~\ocwlowerid{link\_num}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"cpts"}~$(\ocwlowerid{cpt\_partial}~\ocwlowerid{checkpts}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"text"}~$\ocwlowerid{sentence})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{text\_area}~$\ocwstring{"guess"}~1~20~\ocwstring{""}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{option\_select}~[~($\ocwstring{"nom."},\ocwstring{"Nominative"}$);~($\ocwstring{"acc."},\ocwstring{"Accusative"}$);~$\ocweol
\ocwindent{12.00em}
$($\ocwstring{"ins."},\ocwstring{"Instrumental"}$);~($\ocwstring{"dat."},\ocwstring{"Dative"}$);$\ocweol
\ocwindent{12.00em}
$($\ocwstring{"abl."},\ocwstring{"Ablative"}$);~($\ocwstring{"gen."},\ocwstring{"Genitive"}$);~$\ocweol
\ocwindent{12.00em}
$($\ocwstring{"loc."},\ocwstring{"Locative"}$);~($\ocwstring{"voc."},\ocwstring{"Vocative"}$)~])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{option\_select\_label}~$\ocwstring{"gender"}~\ocweol
\ocwindent{5.00em}
$[~($\ocwstring{"m."},\ocwstring{"Masculine"}$);~($\ocwstring{"f."},\ocwstring{"Feminine"}$);~($\ocwstring{"n."},\ocwstring{"Neuter"}$)~])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{option\_select}~[~($\ocwstring{"sg."},\ocwstring{"Singular"}$);~($\ocwstring{"du."},\ocwstring{"Dual"}$);~($\ocwstring{"pl."},\ocwstring{"Plural"}$)~])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{submit\_input}~$\ocwstring{"Submit\ocwvspace{}Choices"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{cgi\_end}$\ocweol
\ocwindent{1.00em}
\}~\ocwbc{} Paths.platform = \ocwstring{"Station"} \ocwec{}~\ocwkw{else}~$()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{user\_aid\_engine}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwupperid{Prel.}\ocwlowerid{prelude\_user}~()$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{query}~=~\ocwupperid{Sys.}\ocwlowerid{getenv}~$\ocwstring{"QUERY\_STRING"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{env}~=~\ocwlowerid{create\_env}~\ocwlowerid{query}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{url\_encoded\_input}~=~\ocwlowerid{get}~$\ocwstring{"text"}~$\ocwlowerid{env}~$\ocwstring{""}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_topic}~=~\ocwlowerid{get}~$\ocwstring{"topic"}~$\ocwlowerid{env}~$\ocwstring{""}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{st}~=~\ocwlowerid{get}~$\ocwstring{"st"}~$\ocwlowerid{env}~$\ocwstring{"t"}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{cp}~=~\ocwlowerid{get}~$\ocwstring{"cp"}~$\ocwlowerid{env}~$\ocwstring{"t"}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{us}~=~\ocwlowerid{get}~$\ocwstring{"us"}~$\ocwlowerid{env}~$\ocwstring{"f"}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{translit}~=~\ocwlowerid{get}~$\ocwstring{"t"}~$\ocwlowerid{env}~$\ocwstring{"SL"}~\ocwbc{} default SLP1 \ocwec{}~\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{lex}~=~\ocwlowerid{get}~$\ocwstring{"lex"}~$\ocwlowerid{env}~$\ocwstring{"SH"}~\ocwbc{} default Heritage \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{cache}~=~\ocwlowerid{get}~$\ocwstring{"cache"}~$\ocwlowerid{env}~$\ocwstring{"f"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$()~=~\ocwlowerid{cache\_active.}\ocwlowerid{val}~:=~\ocwlowerid{cache}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{corpus}~=~\ocwlowerid{get}~$\ocwstring{"corpus"}~$\ocwlowerid{env}~$\ocwstring{""}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{sent\_id}~=~\ocwlowerid{get}~$\ocwstring{"sentenceNumber"}~$\ocwlowerid{env}~$\ocwstring{"0"}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{link\_num}~=~\ocwlowerid{get}~$\ocwstring{"linkNumber"}~$\ocwlowerid{env}~$\ocwstring{"0"}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{abs}~=~\ocwlowerid{get}~$\ocwstring{"abs"}~$\ocwlowerid{env}~$\ocwstring{"f"}~\ocwbc{} default local paths \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{lang}~=~\ocwlowerid{language\_of}~\ocwlowerid{lex}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{input}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_input}~$\ocwbc{} unnormalized string \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{checkpts}~=~$\ocweol
\ocwindent{3.50em}
\ocwkw{try}~\ocwkw{let}~$\ocwlowerid{url\_encoded\_cpts}~=~\ocwupperid{List.}\ocwlowerid{assoc}~$\ocwstring{"cpts"}~$\ocwlowerid{env}~$\ocwkw{in}~\ocwbc{} do not use get \ocwec{}\ocweol
\ocwindent{5.50em}
$\ocwlowerid{parse\_cpts}~(\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_cpts})$\ocweol
\ocwindent{3.50em}
\ocwkw{with}~$[~\ocwupperid{Not\_found}~\rightarrow{}~[\,]~]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{try}~\ocwkw{do}\ocweol
\ocwindent{2.50em}
\{~$\ocwlowerid{aid\_using}~\ocwlowerid{translit}~\ocwlowerid{checkpts}~\ocwlowerid{input}~\ocwlowerid{url\_encoded\_topic}~\ocwlowerid{st}~\ocwlowerid{cp}~\ocwlowerid{us}~\ocwlowerid{lex}~\ocwlowerid{cache}$\ocweol
\ocwindent{8.50em}
$\ocwlowerid{abs}~\ocwlowerid{corpus}~\ocwlowerid{sent\_id}~\ocwlowerid{link\_num}$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{close\_page\_with\_margin}~()$\ocweol
\ocwindent{2.50em}
;~$\ocwlowerid{page\_end}~\ocwlowerid{lang}~\ocwupperid{True}$\ocweol
\ocwindent{2.50em}
\}\ocweol
\ocwindent{2.00em}
\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Sys\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{sys\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Stream.Error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{stream\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Encode.In\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~$\ocwstring{"Wrong\ocwvspace{}input\ocwvspace{}"}~$\ocwlowerid{s}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Exit}~$\ocwbc{} Sanskrit \ocwec{}~$\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~$\ocwstring{"Wrong\ocwvspace{}character\ocwvspace{}in\ocwvspace{}input"}~\ocwstring{""}~\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Invalid\_argument}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} sub \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Failure}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{End\_of\_file}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"EOF"}~\ocwbc{} EOF \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Not\_found}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{s}~=~$\ocwstring{"You\ocwvspace{}must\ocwvspace{}choose\ocwvspace{}a\ocwvspace{}parsing\ocwvspace{}option"}~\ocwkw{in}\ocweol
\ocwindent{14.50em}
$\ocwlowerid{abort}~\ocwlowerid{lang}~$\ocwstring{"Unset\ocwvspace{}button\ocwvspace{}in\ocwvspace{}form\ocwvspace{}\symbol{45}\ocwvspace{}"}~$\ocwlowerid{s}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Control.Fatal}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Control.Anomaly}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~($\ocwstring{"Anomaly:\ocwvspace{}"}~\^{}~$\ocwlowerid{s})$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"Unknown\ocwvspace{}anomaly"}~\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.50em}
\}\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{safe\_engine}~()~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{abor}~=~\ocwlowerid{abort}~\ocwlowerid{default\_language}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwlowerid{user\_aid\_engine}~()~$\ocwkw{with}~\ocweol
\ocwindent{1.00em}
$[~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abor}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"Unexpected\ocwvspace{}anomaly\ocwvspace{}\symbol{45}\ocwvspace{}broken\ocwvspace{}session"}~$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{safe\_engine}~()~$\ocwbc{} Should always produce a valid xhtml page \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Reset_caches.ml}
\ocwmodule{Reset\_caches}
\label{reset_caches.ml:0}%
\ocwbegindcode{}$\ocwupperid{Reset\_caches}$\ocwenddcode{} 
\ocweol
\ocwindent{0.00em}
Used for initializing or resetting the cache databases 
\ocweol
\ocwindent{0.00em}
Caution. Execution of this program erases the contents of the caches 
\ocweol
\label{reset_caches.ml:777}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Auto};$\medskip

\label{reset_caches.ml:806}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{empty\_inflected\_map}~=~(\ocwupperid{Deco.}\ocwlowerid{empty}~:~\ocwlowerid{inflected\_map})~$\ocwbc{} dummy morpho bank \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{empty\_trans}~=~\ocwupperid{Auto.State}(\ocwupperid{False},[\,],[\,])~$\ocwbc{} dummy empty transducer \ocwec{}\ocweol
\ocwindent{0.00em}
;\medskip

\label{reset_caches.ml:961}%
\ocwindent{0.00em}
$\ocwupperid{Gen.}\ocwlowerid{dump}~\ocwlowerid{empty\_inflected\_map}~\ocwupperid{Web.}\ocwlowerid{public\_cache\_file}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwupperid{Gen.}\ocwlowerid{dump}~\ocwlowerid{empty\_trans}~\ocwupperid{Web.}\ocwlowerid{public\_transca\_file}$\ocweol
\ocwindent{0.00em}
;\medskip

\label{reset_caches.ml:1062}%
\ocwindent{0.00em}
$\ocwupperid{Unix.}\ocwlowerid{system}~($\ocwstring{":\ensuremath{>}"}~\^{}~$\ocwupperid{Web.}\ocwlowerid{public\_cache\_txt\_file})~$\ocwbc{} resets the master text cache \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Params.mli}
\ocwinterface{Params}
\label{params.mli:0}%
Common parameters of different CGIs related to the reader 
\ocweol
\ocwindent{0.00em}
Parameter for specifying the corpus subdirectory when the corpus mode
   is enabled.  
\ocweol
\label{params.mli:775}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{corpus\_dir}~:~$\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Parameter for specifying the sentence number when the corpus mode is
   enabled.  \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sentence\_no}~:~$\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Parameter for specifying the permission of the corpus user: 
   \ocwbegindcode{}\ocwstring{"reader"}\ocwenddcode{}, \ocwbegindcode{}\ocwstring{"annotator"}\ocwenddcode{} or \ocwbegindcode{}\ocwstring{"manager"}\ocwenddcode{}.  \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{corpus\_permission}~:~$\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Params.ml}
\ocwmodule{Params}
\label{params.ml:0}%
\label{params.ml:619}%
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{corpus\_dir}~=~$\ocwstring{"corpdir"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sentence\_no}~=~$\ocwstring{"sentno"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{corpus\_permission}~=~$\ocwstring{"corpmode"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Html.ml}
\ocwmodule{Html}
\label{html.ml:0}%
Pidgin ML comme langage de script du pauvre pour HTML et XML 
\ocweol
\ocwindent{0.00em}
Generic HTML scripting 
\ocweol
\ocwindent{0.00em}
All values are pure, not side-effect, no printing. 
\ocweol
\ocwindent{0.00em}
Attributes given as association lists \ocwbegindcode{}$(\ocwlowerid{label},\ocwlowerid{value}):~($\ocwbt{string}~$\times{}~$\ocwbt{string}$)$\ocwenddcode{} 
\ocweol
\label{html.ml:941}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{assoc\_quote}~(\ocwlowerid{label},\ocwlowerid{valu})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{sp\_label}~=~$\ocwstring{"\ocwvspace{}"}~\^{}~$\ocwlowerid{label}~$\ocwkw{in}~$\ocwlowerid{sp\_label}~$\^{}~\ocwstring{"=\symbol{92}""}~\^{}~$\ocwlowerid{valu}~$\^{}~\ocwstring{"\symbol{92}""}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{quote\_alist}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{assoc\_list}~]~\rightarrow{}~\ocwlowerid{assoc\_quote}~\ocwlowerid{assoc\_list}$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{assoc\_list}~::~\ocwlowerid{rest}~]~\rightarrow{}~(\ocwlowerid{assoc\_quote}~\ocwlowerid{assoc\_list}~$\^{}~$\ocwlowerid{quote\_alist}~\ocwlowerid{rest})$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Elementary XML constructors \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{xml\_begin}~\ocwlowerid{xml\_op}~=~$\ocwstring{"\ensuremath{<}"}~\^{}~$\ocwlowerid{xml\_op}~$\^{}~\ocwstring{"\ensuremath{>}"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{xml\_begin\_with\_att}~\ocwlowerid{xml\_op}~\ocwlowerid{atts}~=~$\ocwstring{"\ensuremath{<}"}~\^{}~$\ocwlowerid{xml\_op}~$\^{}~$(\ocwlowerid{quote\_alist}~\ocwlowerid{atts})~$\^{}~\ocwstring{"\ensuremath{>}"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{xml\_end}~\ocwlowerid{xml\_op}~=~$\ocwstring{"\ensuremath{<}/"}~\^{}~$\ocwlowerid{xml\_op}~$\^{}~\ocwstring{"\ensuremath{>}"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{xml\_empty}~\ocwlowerid{xml\_op}~=~$\ocwstring{"\ensuremath{<}"}~\^{}~$\ocwlowerid{xml\_op}~$\^{}~\ocwstring{"\ensuremath{>}"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{xml\_empty\_with\_att}~\ocwlowerid{xml\_op}~\ocwlowerid{atts}~=~$\ocwstring{"\ensuremath{<}"}~\^{}~$\ocwlowerid{xml\_op}~$\^{}~$(\ocwlowerid{quote\_alist}~\ocwlowerid{atts})~$\^{}~\ocwstring{"\ensuremath{>}"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{xml\_next}~\ocwlowerid{op}~=~\ocwlowerid{xml\_end}~\ocwlowerid{op}~$\^{}~$\ocwlowerid{xml\_begin}~\ocwlowerid{op}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{html\_break}~=~\ocwlowerid{xml\_empty}~$\ocwstring{"br"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{html\_paragraph}~=~\ocwlowerid{xml\_begin}~$\ocwstring{"p"}~\^{}~$\ocwlowerid{xml\_end}~$\ocwstring{"p"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} array operations \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{tr\_begin}~=~\ocwlowerid{xml\_begin}~$\ocwstring{"tr"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{tr\_end}~=~\ocwlowerid{xml\_end}~$\ocwstring{"tr"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{th\_begin}~=~\ocwlowerid{xml\_begin}~$\ocwstring{"th"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{th\_end}~=~\ocwlowerid{xml\_end}~$\ocwstring{"th"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{td\_begin}~=~\ocwlowerid{xml\_begin}~$\ocwstring{"td"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{td\_end}~=~\ocwlowerid{xml\_end}~$\ocwstring{"td"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{td}~=~\ocwlowerid{xml\_empty\_with\_att}~$\ocwstring{"td"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{td\_wrap}~\ocwlowerid{text}~=~\ocwlowerid{td\_begin}~$\^{}~$\ocwlowerid{text}~$\^{}~$\ocwlowerid{td\_end}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cell}~\ocwlowerid{item}~=~\ocwlowerid{tr\_begin}~$\^{}~$\ocwlowerid{th\_begin}~$\^{}~$\ocwlowerid{item}~$\^{}~$\ocwlowerid{th\_end}~$\^{}~$\ocwlowerid{tr\_end}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Dynamic colors depending on mouse position \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{tr\_mouse\_begin}~\ocwlowerid{color\_over}~\ocwlowerid{color\_out}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"tr"}~\ocweol
\ocwindent{5.00em}
\ocwbc{} beware case of attributes below; colors must be quoted \ocwec{}\ocweol
\ocwindent{5.00em}
$[~($\ocwstring{"onMouseover"},\ocwstring{"this.bgColor="}~\^{}~$\ocwlowerid{color\_over})$\ocweol
\ocwindent{5.00em}
;~$($\ocwstring{"onMouseout"}~,\ocwstring{"this.bgColor="}~\^{}~$\ocwlowerid{color\_out})~$\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{input\_id}~=~$\ocwstring{"focus"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{focus\_script}~=~$\ocwbc{} selection of input window \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwstring{"(function()\{var\ocwvspace{}src\ocwvspace{}=\ocwvspace{}document.getElementById('focus');src.select();\})();"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{text\_area}~\ocwlowerid{control}~\ocwlowerid{width}~\ocwlowerid{length}~\ocwlowerid{sentence}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{w}~=~\ocwlowerid{string\_of\_int}~\ocwlowerid{width}$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{l}~=~\ocwlowerid{string\_of\_int}~\ocwlowerid{length}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"textarea"}~\ocweol
\ocwindent{3.00em}
$[~($\ocwstring{"id"},$\ocwlowerid{input\_id});~($\ocwstring{"name"},$\ocwlowerid{control});~($\ocwstring{"rows"},$\ocwlowerid{w});~($\ocwstring{"cols"},$\ocwlowerid{l})~]~$\^{}~$\ocwlowerid{sentence}~$\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_end}~$\ocwstring{"textarea"}~\ocwbc{} Caution - necessary to separate begin and end \ocwec{}~\^{}~\ocwstring{"\symbol{92}n"}~\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"script"}~$[~($\ocwstring{"type"},\ocwstring{"text/javascript"}$)~]~$\^{}~$\ocwlowerid{focus\_script}~$\^{}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_end}~$\ocwstring{"script"}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} printing options for the user to choose lemma \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{option\_print}~\ocwlowerid{id}~\ocwlowerid{control}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"option"}~$[~($\ocwstring{"value"},$\ocwlowerid{id})~]~$\^{}~$\ocwlowerid{control}~$\^{}~$\ocwlowerid{xml\_end}~$\ocwstring{"option"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{option\_print\_default}~\ocwlowerid{id}~\ocwlowerid{control}~\ocwlowerid{b}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{value\_param}~=~($\ocwstring{"value"},$\ocwlowerid{id})~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{params}~=~$\ocwkw{if}~$\ocwlowerid{b}~$\ocwkw{then}~$[~\ocwlowerid{value\_param};~($\ocwstring{"selected"},\ocwstring{"selected"}$)~]$\ocweol
\ocwindent{10.00em}
\ocwkw{else}~$[~\ocwlowerid{value\_param}~]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{menu}~=~\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"option"}~$\ocwlowerid{params}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{menu}~$\^{}~$\ocwlowerid{control}~$\^{}~$\ocwlowerid{xml\_end}~$\ocwstring{"option"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{print\_options}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.50em}
$[~[\,]~\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{1.50em}
$\mid{}~[~(\ocwlowerid{id},\ocwlowerid{control})~::~\ocwlowerid{rest}~]~\rightarrow{}~\ocwlowerid{option\_print}~\ocwlowerid{id}~\ocwlowerid{control}~$\^{}~$\ocwlowerid{print\_options}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{print\_options\_default}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.50em}
$[~[\,]~\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{1.50em}
$\mid{}~[~(\ocwlowerid{control},\ocwlowerid{id},\ocwlowerid{b})~::~\ocwlowerid{rest}~]~\rightarrow{}~$\ocweol
\ocwindent{3.50em}
$\ocwlowerid{option\_print\_default}~\ocwlowerid{id}~\ocwlowerid{control}~\ocwlowerid{b}~$\^{}~$\ocwlowerid{print\_options\_default}~\ocwlowerid{rest}$\ocweol
\ocwindent{1.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{option\_select}~\ocwlowerid{list\_options}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_begin}~$\ocwstring{"select"}~\^{}~$\ocwlowerid{print\_options}~\ocwlowerid{list\_options}~$\^{}~$\ocwlowerid{xml\_end}~$\ocwstring{"select"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{option\_select\_label}~\ocwlowerid{label}~\ocwlowerid{list\_options}~=~\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"select"}~\ocweol
\ocwindent{1.00em}
$[~($\ocwstring{"name"},$\ocwlowerid{label})~]~$\^{}~$\ocwlowerid{print\_options}~\ocwlowerid{list\_options}~$\^{}~$\ocwlowerid{xml\_end}~$\ocwstring{"select"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{option\_select\_default}~\ocwlowerid{label}~\ocwlowerid{list\_options}~=~\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"select"}~\ocweol
\ocwindent{1.00em}
$[~($\ocwstring{"name"},$\ocwlowerid{label})~]~$\^{}~$\ocwlowerid{print\_options\_default}~\ocwlowerid{list\_options}~$\^{}~$\ocwlowerid{xml\_end}~$\ocwstring{"select"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{option\_select\_default\_id}~\ocwlowerid{id}~\ocwlowerid{label}~\ocwlowerid{list\_options}~=~$\ocweol
\ocwindent{1.00em}
$(\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"select"}~$[~($\ocwstring{"id"},$\ocwlowerid{id});~($\ocwstring{"name"},$\ocwlowerid{label})~])~$\^{}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{print\_options\_default}~\ocwlowerid{list\_options}~$\^{}~$\ocwlowerid{xml\_end}~$\ocwstring{"select"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{text\_input}~\ocwlowerid{id}~\ocwlowerid{control}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_empty\_with\_att}~$\ocwstring{"input"}~$[~($\ocwstring{"id"},$\ocwlowerid{id});~($\ocwstring{"type"},\ocwstring{"text"}$);~($\ocwstring{"name"},$\ocwlowerid{control})~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_opt\_attrs}~\ocwlowerid{opt\_attrs}~\ocwlowerid{attrs}~=$\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{fold\_left}~($\ocwkw{fun}~$\ocwlowerid{acc}~(\ocwlowerid{label},~\ocwlowerid{v})~\rightarrow{}$\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwlowerid{v}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{acc}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Some}~\ocwlowerid{v}~\rightarrow{}~[~(\ocwlowerid{label},~\ocwlowerid{v})~::~\ocwlowerid{acc}~]$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
$)~\ocwlowerid{attrs}~\ocwlowerid{opt\_attrs}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{int\_input}~?\ocwlowerid{id}~?$\ocwkw{val}~?$(\ocwlowerid{step}~=~1)~?(\ocwlowerid{min}~=~\ocwlowerid{min\_int})~?(\ocwlowerid{max}~=~\ocwlowerid{max\_int})~\ocwlowerid{name}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{attrs}~=$\ocweol
\ocwindent{2.00em}
$[~($\ocwstring{"type"},~\ocwstring{"number"}$)$\ocweol
\ocwindent{2.00em}
;~$($\ocwstring{"name"},~$\ocwlowerid{name})$\ocweol
\ocwindent{2.00em}
;~$($\ocwstring{"step"},~$\ocwlowerid{string\_of\_int}~\ocwlowerid{step})$\ocweol
\ocwindent{2.00em}
;~$($\ocwstring{"min"},~$\ocwlowerid{string\_of\_int}~\ocwlowerid{min})$\ocweol
\ocwindent{2.00em}
;~$($\ocwstring{"max"},~$\ocwlowerid{string\_of\_int}~\ocwlowerid{max})$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{opt\_attrs}~=$\ocweol
\ocwindent{2.00em}
$[~($\ocwstring{"id"},~$\ocwlowerid{id})$\ocweol
\ocwindent{2.00em}
;~$($\ocwstring{"value"},~$\ocwupperid{Gen.}\ocwlowerid{opt\_app}~\ocwlowerid{string\_of\_int}~$\ocwkw{val}$)$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{attrs}~=~\ocwlowerid{add\_opt\_attrs}~\ocwlowerid{opt\_attrs}~\ocwlowerid{attrs}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_empty\_with\_att}~$\ocwstring{"input"}~$\ocwlowerid{attrs}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{radio\_input}~\ocwlowerid{control}~\ocwlowerid{v}~\ocwlowerid{label}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{attrs}~=~[~($\ocwstring{"type"},\ocwstring{"radio"}$);~($\ocwstring{"name"},$\ocwlowerid{control});~($\ocwstring{"value"},$\ocwlowerid{v})~]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$(\ocwlowerid{xml\_empty\_with\_att}~$\ocwstring{"input"}~$\ocwlowerid{attrs})~$\^{}~$\ocwlowerid{label}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{select}~\ocwlowerid{control}~=~$\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{map}~($\ocwkw{fun}~$(\ocwlowerid{label},\ocwlowerid{v})~\rightarrow{}~\ocwlowerid{radio\_input}~\ocwlowerid{control}~\ocwlowerid{v}~\ocwlowerid{label})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{radio\_input\_dft}~\ocwlowerid{control}~\ocwlowerid{v}~\ocwlowerid{label}~\ocwlowerid{checked}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{attrs}~=~[~($\ocwstring{"type"},\ocwstring{"radio"}$);~($\ocwstring{"name"},$\ocwlowerid{control});~($\ocwstring{"value"},$\ocwlowerid{v})~]$\ocweol
\ocwindent{7.00em}
@~$($\ocwkw{if}~$\ocwlowerid{checked}~$\ocwkw{then}~$[~($\ocwstring{"checked"},\ocwstring{"checked"}$)~]~$\ocwkw{else}~$[\,])~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$(\ocwlowerid{xml\_empty\_with\_att}~$\ocwstring{"input"}~$\ocwlowerid{attrs})~$\^{}~$\ocwlowerid{label}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{select\_default}~\ocwlowerid{name}~=~$\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{map}~($\ocwkw{fun}~$(\ocwlowerid{label},\ocwlowerid{v},\ocwlowerid{checked})~\rightarrow{}~\ocwlowerid{radio\_input\_dft}~\ocwlowerid{name}~\ocwlowerid{v}~\ocwlowerid{label}~\ocwlowerid{checked})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{submit\_input}~\ocwlowerid{label}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_empty\_with\_att}~$\ocwstring{"input"}~$[~($\ocwstring{"type"},\ocwstring{"submit"}$);~($\ocwstring{"value"},$\ocwlowerid{label})~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{reset\_input}~\ocwlowerid{label}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_empty\_with\_att}~$\ocwstring{"input"}~$[~($\ocwstring{"type"},\ocwstring{"reset"}$);~($\ocwstring{"value"},$\ocwlowerid{label})~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{hidden\_input}~\ocwlowerid{name}~\ocwlowerid{label}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_empty\_with\_att}~$\ocwstring{"input"}~$[~($\ocwstring{"type"},\ocwstring{"hidden"}$);~($\ocwstring{"name"},$\ocwlowerid{name});~($\ocwstring{"value"},$\ocwlowerid{label})~]$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Lists 
\ocweol
\ocwindent{0.00em}
List item 
\ocweol
\label{html.ml:5893}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{li}~?\ocwlowerid{id}~\ocwlowerid{item}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{li}~=~$\ocwstring{"li"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{attrs}~=~\ocwlowerid{add\_opt\_attrs}~[~($\ocwstring{"id"},~$\ocwlowerid{id})~]~[\,]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_begin\_with\_att}~\ocwlowerid{li}~\ocwlowerid{attrs}~$\^{}~$\ocwlowerid{item}~$\^{}~$\ocwlowerid{xml\_end}~\ocwlowerid{li}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Ordered list \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ol}~?\ocwlowerid{id}~?\ocwlowerid{li\_id\_prefix}~?(\ocwlowerid{start}~=~1)~\ocwlowerid{items}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{ol}~=~$\ocwstring{"ol"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{items}~=$\ocweol
\ocwindent{2.00em}
$\ocwupperid{List.}\ocwlowerid{mapi}~($\ocwkw{fun}~$\ocwlowerid{i}~\ocwlowerid{item}~\rightarrow{}$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{id}~=$\ocweol
\ocwindent{5.00em}
\ocwkw{let}~$\ocwlowerid{genid}~\ocwlowerid{prefix}~=~\ocwlowerid{prefix}~$\^{}~$\ocwlowerid{string\_of\_int}~(\ocwlowerid{start}~+~\ocwlowerid{i})~$\ocwkw{in}\ocweol
\ocwindent{5.00em}
$\ocwupperid{Gen.}\ocwlowerid{opt\_app}~\ocwlowerid{genid}~\ocwlowerid{li\_id\_prefix}$\ocweol
\ocwindent{4.00em}
\ocwkw{in}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{li}~?\ocwlowerid{id}~\ocwlowerid{item}$\ocweol
\ocwindent{3.00em}
$)~\ocwlowerid{items}$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~\ocwbt{list}~=~$\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{"\symbol{92}n"}~$\ocwlowerid{items}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{attrs}~=$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{add\_opt\_attrs}~[~($\ocwstring{"id"},~$\ocwlowerid{id})~]~[~($\ocwstring{"start"},~$\ocwlowerid{string\_of\_int}~\ocwlowerid{start})~]$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_begin\_with\_att}~\ocwlowerid{ol}~\ocwlowerid{attrs}~$\^{}~\ocwstring{"\symbol{92}n"}~\^{}\ocweol
\ocwindent{1.00em}
\ocwbt{list}~\^{}~\ocwstring{"\symbol{92}n"}~\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_end}~\ocwlowerid{ol}$\ocweol
\ocwindent{0.00em}
;\medskip

\label{html.ml:6536}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{fieldn}~\ocwlowerid{name}~\ocwlowerid{content}~=~[~($\ocwstring{"name"},$\ocwlowerid{name});~($\ocwstring{"content"},$\ocwlowerid{content})~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fieldp}~\ocwlowerid{name}~\ocwlowerid{content}~=~[~($\ocwstring{"property"},$\ocwlowerid{name});~($\ocwstring{"content"},$\ocwlowerid{content})~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{position}~=~[~\ocwupperid{Left}~\mid{}~\ocwupperid{Center}~\mid{}~\ocwupperid{Right}~]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{font\_family}~=~$\ocwbt{list}~\ocwbt{string}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{font\_style}~=~[~\ocwupperid{Normal}~\mid{}~\ocwupperid{Italic}~\mid{}~\ocwupperid{Slanted}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{color}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Black}~\mid{}~\ocwupperid{White}~\mid{}~\ocwupperid{Red}~\mid{}~\ocwupperid{Blue}~\mid{}~\ocwupperid{Green}~\mid{}~\ocwupperid{Yellow}~\mid{}~\ocwupperid{Orange}~\mid{}~\ocwupperid{Deep\_sky}~\mid{}~\ocwupperid{Purple}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Grey}~\mid{}~\ocwupperid{Navy}~\mid{}~\ocwupperid{Cyan}~\mid{}~\ocwupperid{Brown}~\mid{}~\ocwupperid{Carmin}~\mid{}~\ocwupperid{Chamois}~\mid{}~\ocwupperid{Broon}~\mid{}~\ocwupperid{Maroon}~\mid{}~\ocwupperid{Aquamarine}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Gold}~\mid{}~\ocwupperid{Magenta}~\mid{}~\ocwupperid{Mauve}~\mid{}~\ocwupperid{Pink}~\mid{}~\ocwupperid{Salmon}~\mid{}~\ocwupperid{Lime}~\mid{}~\ocwupperid{Light\_blue}~\mid{}~\ocwupperid{Lavender}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Lawngreen}~\mid{}~\ocwupperid{Deep\_pink}~\mid{}~\ocwupperid{Pale\_yellow}~\mid{}~\ocwupperid{Pale\_rose}~\mid{}~\ocwupperid{Beige}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} TO be relocated \ocwbegindcode{}
\ocwkw{type}~$\ocwlowerid{pict}~=~$\ocwbt{string}~$(\times{}~\ocwlowerid{misc}~\ocwlowerid{background}~\ocwlowerid{pictures}~\times{})
~[~\ocwupperid{Om}~\mid{}~\ocwupperid{Om2}~\mid{}~\ocwupperid{Om3}~\mid{}~\ocwupperid{Om4}~\mid{}~\ocwupperid{Gan}~\mid{}~\ocwupperid{Hare}~\mid{}~\ocwupperid{Geo}~]~
;~
(\times{}~\ocwupperid{Deprecated},~$\ocwkw{for}~$\ocwlowerid{use}~$\ocwkw{as}~$\ocwlowerid{background}~\ocwlowerid{pictures}~\ocwlowerid{like}~$\ocwkw{in}~$\ocwlowerid{the}~\ocwlowerid{ancient}~\ocwupperid{Web}...~\times{})
(\times{}~\ocwupperid{Problematic},~\ocwlowerid{since}~\ocwlowerid{pollutes}~$\ocwkw{with}~$\ocwlowerid{installation}-\ocwlowerid{dependent}~\ocwupperid{URLs}~\times{})
\ocwlowerid{value}~\ocwlowerid{pict}~=~$\ocwkw{fun}~
~[~\ocwstring{"Om"}~$\rightarrow{}~\ocwupperid{Install}.\ocwlowerid{om\_jpg}~
~\mid{}~$\ocwstring{"Om2"}~$\rightarrow{}~\ocwupperid{Install}.\ocwlowerid{om2\_jpg}
~\mid{}~$\ocwstring{"Om3"}~$\rightarrow{}~\ocwupperid{Install}.\ocwlowerid{om3\_jpg}~
~\mid{}~$\ocwstring{"Om4"}~$\rightarrow{}~\ocwupperid{Install}.\ocwlowerid{om4\_jpg}
~\mid{}~$\ocwstring{"Gan"}~$\rightarrow{}~\ocwupperid{Install}.\ocwlowerid{ganesh\_gif}~
~\mid{}~$\ocwstring{"Geo"}~$\rightarrow{}~\ocwupperid{Install}.\ocwlowerid{geo\_gif}
~\mid{}~$\ocwstring{"Hare"}~$\rightarrow{}~\ocwupperid{Install}.\ocwlowerid{hare\_jpg}~
~]~
;$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{basic\_style}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Font\_family}~$\ocwkw{of}~$\ocwlowerid{font\_family}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Font\_style}~$\ocwkw{of}~$\ocwlowerid{font\_style}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Font\_size}~$\ocwkw{of}~\ocwbt{int}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Textalign}~$\ocwkw{of}~$\ocwlowerid{position}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Tablecenter}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Color}~$\ocwkw{of}~$\ocwlowerid{color}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Bgcolor}~$\ocwkw{of}~$\ocwlowerid{color}~$\ocweol
\ocwindent{0.00em}
\ocwbc{}| Bgpict of pict \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Position}~$\ocwkw{of}~\ocwbt{string}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Full\_width}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Height}~$\ocwkw{of}~\ocwbt{int}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{No\_margin}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Border}~$\ocwkw{of}~\ocwbt{int}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Padding}~$\ocwkw{of}~\ocwbt{int}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Cellpadding}~$\ocwkw{of}~\ocwbt{int}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{No\_border}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Border\_sep}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Border\_col}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Border\_sp}~$\ocwkw{of}~\ocwbt{int}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Hidden}$\ocweol
\ocwindent{1.00em}
$]~$\ocwbc{} font-weight not supported \ocwec{}\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rgb}~=~$\ocwkw{fun}~\ocwbc{} a few selected HTML colors in rgb data \ocwec{}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Black}~\rightarrow{}~$\ocwstring{"\#000000"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{White}~\rightarrow{}~$\ocwstring{"\#FFFFFF"}~\ocwbc{} Wheat = \ocwstring{"\#F0E0B0"} ou \ocwstring{"\#F5DEB3"} \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Red}~\rightarrow{}~$\ocwstring{"\#FF0000"}~\ocwbc{} Firebrick = \ocwstring{"\#B02020"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Blue}~\rightarrow{}~$\ocwstring{"\#0000FF"}~\ocwbc{} Canard = \ocwstring{"\#0000C0"} ou \ocwstring{"\#0080FF"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Green}~\rightarrow{}~$\ocwstring{"\#008000"}~\ocwbc{} Teal = \ocwstring{"\#008080"} Olive = \ocwstring{"\#808000"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Aquamarine}~\rightarrow{}~$\ocwstring{"\#6FFFC3"}~\ocwbc{} actually Light Aquamarine \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Lawngreen}~\rightarrow{}~$\ocwstring{"\#7CFC00"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Yellow}~\rightarrow{}~$\ocwstring{"\#FFFF00"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Orange}~\rightarrow{}~$\ocwstring{"\#FFA000"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Cyan}~\rightarrow{}~$\ocwstring{"\#00FFFF"}~\ocwbc{} Aqua = Cyan, Turquoise = \ocwstring{"\#40E0D0"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Purple}~\rightarrow{}~$\ocwstring{"\#800080"}~\ocwbc{} Plum = \ocwstring{"\#E0A0E0"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Grey}~\rightarrow{}~$\ocwstring{"\#B8B8B8"}~\ocwbc{} Slategrey = \ocwstring{"\#708090"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Navy}~\rightarrow{}~$\ocwstring{"\#000080"}~\ocwbc{} Midnight blue = \ocwstring{"\#101870"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Deep\_sky}~\rightarrow{}~$\ocwstring{"\#00C0FF"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Brown}~\rightarrow{}~$\ocwstring{"\#A02820"}~\ocwbc{} Chocolate = \ocwstring{"\#D06820"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Maroon}~\rightarrow{}~$\ocwstring{"\#800000"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Carmin}~\rightarrow{}~$\ocwstring{"\#FF1975"}~\ocwbc{} Carmin = \ocwstring{"\#FF0066"} Deep pink= \ocwstring{"\#FF1090"} \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Chamois}~\rightarrow{}~$\ocwstring{"\#F5F5DC"}~\ocwbc{} gris-beige \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Broon}~\rightarrow{}~$\ocwstring{"\#852B1D"}~\ocwbc{} good with gold \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Gold}~\rightarrow{}~$\ocwstring{"\#A58959"}~\ocwbc{} Silver = \ocwstring{"\#C0C0C0"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Magenta}~\rightarrow{}~$\ocwstring{"\#FF00FF"}~\ocwbc{} Violet = \ocwstring{"\#F080F0"} Blueviolet = \ocwstring{"\#8028E0"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Mauve}~\rightarrow{}~$\ocwstring{"\#FF99FF"}~\ocwbc{} Orchid = \ocwstring{"\#D070D0"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pink}~\rightarrow{}~$\ocwstring{"\#FFC0C0"}~\ocwbc{} Hotpink = \ocwstring{"\#FF68B0"} Thisle = \ocwstring{"\#D0C0D0"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Deep\_pink}~\rightarrow{}~$\ocwstring{"\#FF1493"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Salmon}~\rightarrow{}~$\ocwstring{"\#F08070"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Beige}~\rightarrow{}~$\ocwstring{"\#FFCCA0"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Lime}~\rightarrow{}~$\ocwstring{"\#00FF00"}~\ocwbc{} Chartreuse = \ocwstring{"\#80FF00"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pale\_yellow}~\rightarrow{}~$\ocwstring{"\#FFFF66"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pale\_rose}~\rightarrow{}~$\ocwstring{"\#FFDDDD"}~\ocwbc{} Mistyrose = \ocwstring{"\#FFE4E1"} \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Light\_blue}~\rightarrow{}~$\ocwstring{"\#ADD8E6"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Lavender}~\rightarrow{}~$\ocwstring{"\#E6E6FA"}~\ocwbc{} or \ocwstring{"\#E0E8F0"} \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} quoted color needed for arguments of \ocwbegindcode{}$\ocwlowerid{tr\_mouse\_begin}$\ocwenddcode{} exclusively \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{color}~\ocwlowerid{c}~=~$\ocwstring{"'"}~\^{}~$\ocwlowerid{rgb}~\ocwlowerid{c}~$\^{}~\ocwstring{"'"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Special symbols \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{check\_sign}~=~$\ocwstring{"\&\#x2713;"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{spade\_sign}~=~$\ocwstring{"\&\#x2660;"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{heart\_sign}~=~$\ocwstring{"\&\#x2661;"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{x\_sign}~=~$\ocwstring{"\&\#10008;"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Fonts used for the Web site. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwstring{"Times\ocwvspace{}IndUni"} is deprecated, now called \ocwstring{"IndUni\symbol{45}T"} (John Smith's fonts) \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{roman\_fonts}~=~[~$\ocwstring{"IndUni\symbol{45}T"};~\ocwstring{"Arial\ocwvspace{}Unicode\ocwvspace{}MS"}~$]~$\ocwbc{} \ocwstring{"Times\_CSX"} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{greek\_fonts}~=~[~$\ocwstring{"Arial\ocwvspace{}Unicode\ocwvspace{}MS"};~\ocwstring{"Symbol"}~$]~$\ocwbc{} \ocwstring{"Latin\ocwvspace{}Extended\symbol{45}B"} Greek \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{diacr\_fonts}~=~[~$\ocwstring{"IndUni\symbol{45}T"};~\ocwstring{"Arial\ocwvspace{}Unicode\ocwvspace{}MS"}~$]$\ocweol
\ocwindent{1.50em}
\ocwbc{} Sanskrit transliteration in romanised script with diacritics \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{deva\_fonts}~=~[~$\ocwstring{"Devanagari\ocwvspace{}MT"};~\ocwstring{"Arial\ocwvspace{}Unicode\ocwvspace{}MS"}~$]~$\ocwbc{} Devanagari fonts \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{roman\_font}~=~\ocwupperid{Font\_family}~\ocwlowerid{roman\_fonts}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{greek\_font}~=~\ocwupperid{Font\_family}~\ocwlowerid{greek\_fonts}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{trans\_font}~=~\ocwupperid{Font\_family}~\ocwlowerid{diacr\_fonts}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{deva\_font}~=~\ocwupperid{Font\_family}~\ocwlowerid{deva\_fonts}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{points}~\ocwlowerid{n}~=~\ocwlowerid{string\_of\_int}~\ocwlowerid{n}~$\^{}~\ocwstring{"pt"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pixels}~\ocwlowerid{n}~=~\ocwlowerid{string\_of\_int}~\ocwlowerid{n}~$\^{}~\ocwstring{"px"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{percent}~\ocwlowerid{n}~=~\ocwlowerid{string\_of\_int}~\ocwlowerid{n}~$\^{}~\ocwstring{"\%"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{font\_style}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Normal}~\rightarrow{}~$\ocwstring{"normal"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Italic}~\rightarrow{}~$\ocwstring{"italic"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Slanted}~\rightarrow{}~$\ocwstring{"oblique"}~\ocwbc{} Not well-supported by browsers \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{justify}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Left}~\rightarrow{}~$\ocwstring{"left"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Center}~\rightarrow{}~$\ocwstring{"center"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Right}~\rightarrow{}~$\ocwstring{"right"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Style sheet generator \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{style\_sheet}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Font\_family}~\ocwlowerid{fonts}~\rightarrow{}~$\ocwstring{"font\symbol{45}family:\ocwvspace{}"}~\^{}~$\ocwlowerid{family}~$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{where}~\ocwlowerid{family}~=~\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{","}~$\ocwlowerid{fonts}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Font\_style}~\ocwlowerid{fs}~\rightarrow{}~$\ocwstring{"font\symbol{45}style:\ocwvspace{}"}~\^{}~$\ocwlowerid{font\_style}~\ocwlowerid{fs}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Font\_size}~\ocwlowerid{sz}~\rightarrow{}~$\ocwstring{"font\symbol{45}size:"}~\^{}~$\ocwlowerid{points}~\ocwlowerid{sz}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Textalign}~\ocwlowerid{p}~\rightarrow{}~$\ocwstring{"text\symbol{45}align:"}~\^{}~$\ocwlowerid{justify}~\ocwlowerid{p}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Color}~\ocwlowerid{cl}~\rightarrow{}~$\ocwstring{"color:"}~\^{}~$\ocwlowerid{rgb}~\ocwlowerid{cl}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Bgcolor}~\ocwlowerid{cl}~\rightarrow{}~$\ocwstring{"background\symbol{45}color:"}~\^{}~$\ocwlowerid{rgb}~\ocwlowerid{cl}~$\ocweol
\ocwindent{0.00em}
\ocwbc{}\ocwbegindcode{}$\mid{}~\ocwupperid{Bgpict}~\ocwlowerid{p}~\rightarrow{}~$\ocwstring{"background\symbol{45}image:url("}~\^{}~$\ocwlowerid{pict}~\ocwlowerid{p}~$\^{}~\ocwstring{")"}~\ocwenddcode{}\ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Position}~\ocwlowerid{pos}~\rightarrow{}~\ocwlowerid{pos}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Tablecenter}~\rightarrow{}~$\ocwstring{"margin:0\ocwvspace{}auto"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{No\_border}~\rightarrow{}~$\ocwstring{"border:\ocwvspace{}0"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Border}~\ocwlowerid{n}~\rightarrow{}~$\ocwstring{"border:\ocwvspace{}outset\ocwvspace{}"}~\^{}~$\ocwlowerid{points}~\ocwlowerid{n}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Padding}~\ocwlowerid{n}~\rightarrow{}~$\ocwstring{"padding:"}~\^{}~$\ocwlowerid{points}~\ocwlowerid{n}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Cellpadding}~\ocwlowerid{p}~\rightarrow{}~$\ocwstring{"cellpadding:"}~\^{}~$\ocwlowerid{percent}~\ocwlowerid{p}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Full\_width}~\rightarrow{}~$\ocwstring{"width:100\%"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Height}~\ocwlowerid{h}~\rightarrow{}~$\ocwstring{"height:"}~\^{}~$\ocwlowerid{points}~\ocwlowerid{h}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{No\_margin}~\rightarrow{}~$\ocwstring{"margin\symbol{45}left:\ocwvspace{}0pt;\ocwvspace{}margin\symbol{45}right:\ocwvspace{}0pt;\ocwvspace{}margin\symbol{45}top:\ocwvspace{}0pt"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Border\_sep}~\rightarrow{}~$\ocwstring{"border\symbol{45}collapse:separate"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Border\_col}~\rightarrow{}~$\ocwstring{"border\symbol{45}collapse:collapse"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Border\_sp}~\ocwlowerid{n}~\rightarrow{}~$\ocwstring{"border\symbol{45}spacing:"}~\^{}~$\ocwlowerid{points}~\ocwlowerid{n}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Hidden}~\rightarrow{}~$\ocwstring{"display:\ocwvspace{}none"}\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwbc{} Style of enpied bandeau with fixed position at bottom of page - fragile \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{enpied}~=~$\ocwstring{"position:\ocwvspace{}fixed;\ocwvspace{}bottom:\ocwvspace{}0pt;\ocwvspace{}width:\ocwvspace{}100\%"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} All the styles of the various sections - terminology to be streamlined \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} NB: When \ocwbegindcode{}$\ocwlowerid{style\_class}$\ocwenddcode{} is changed, module Css ought to be adapted \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{style\_class}~=~$\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Blue\_}~\mid{}~\ocwupperid{Green\_}~\mid{}~\ocwupperid{Navy\_}~\mid{}~\ocwupperid{Red\_}~\mid{}~\ocwupperid{Magenta\_}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Header\_deva}~\mid{}~\ocwupperid{Header\_tran}~\mid{}~\ocwupperid{Bandeau}~\mid{}~\ocwupperid{Body}~\mid{}~\ocwupperid{Spacing20}~\mid{}~\ocwupperid{Pad60}~\mid{}~\ocwupperid{Border2}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Latin12}~\mid{}~\ocwupperid{Trans12}~\mid{}~\ocwupperid{Deva}~\mid{}~\ocwupperid{Devac}~\mid{}~\ocwupperid{Deva16}~\mid{}~\ocwupperid{Deva16c}~\mid{}~\ocwupperid{Deva20c}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Roma16o}~\mid{}~\ocwupperid{Roma12o}~\mid{}~\ocwupperid{Inflexion}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Alphabet}~\mid{}~\ocwupperid{G2}~\mid{}~\ocwupperid{Title}~\mid{}~\ocwupperid{Latin16}~\mid{}~\ocwupperid{Trans16}~\mid{}~\ocwupperid{Devared\_}~\mid{}~\ocwupperid{Math}~\mid{}~\ocwupperid{Enpied}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{B1}~\mid{}~\ocwupperid{B2}~\mid{}~\ocwupperid{B3}~\mid{}~\ocwupperid{C1}~\mid{}~\ocwupperid{C2}~\mid{}~\ocwupperid{C3}~\mid{}~\ocwupperid{Cell5}~\mid{}~\ocwupperid{Cell10}~\mid{}~\ocwupperid{Center\_}~\mid{}~\ocwupperid{Tcenter}~\mid{}~\ocwupperid{Centered}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Gold\_cent}~\mid{}~\ocwupperid{Mauve\_cent}~\mid{}~\ocwupperid{Yellow\_cent}~\mid{}~\ocwupperid{Cyan\_cent}~\mid{}~\ocwupperid{Deep\_sky\_cent}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Yellow\_back}~\mid{}~\ocwupperid{Blue\_back}~\mid{}~\ocwupperid{Salmon\_back}~\mid{}~\ocwupperid{Light\_blue\_back}~\mid{}~\ocwupperid{Gold\_back}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Pink\_back}~\mid{}~\ocwupperid{Chamois\_back}~\mid{}~\ocwupperid{Cyan\_back}~\mid{}~\ocwupperid{Brown\_back}~\mid{}~\ocwupperid{Lime\_back}~\mid{}~\ocwupperid{Grey\_back}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Deep\_sky\_back}~\mid{}~\ocwupperid{Carmin\_back}~\mid{}~\ocwupperid{Orange\_back}~\mid{}~\ocwupperid{Red\_back}~\mid{}~\ocwupperid{Mauve\_back}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Lavender\_back}~\mid{}~\ocwupperid{Lavender\_cent}~\mid{}~\ocwupperid{Green\_back}~\mid{}~\ocwupperid{Lawngreen\_back}~\mid{}~\ocwupperid{Magenta\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Aquamarine\_back}~\mid{}~\ocwupperid{Hidden\_}$\ocweol
\ocwindent{0.00em}
\ocwbc{}\ocwbegindcode{}~$\mid{}~\ocwupperid{Pict\_om}~\mid{}~\ocwupperid{Pict\_om2}~\mid{}~\ocwupperid{Pict\_om3}~\mid{}~\ocwupperid{Pict\_om4}~\mid{}~\ocwupperid{Pict\_gan}~\mid{}~\ocwupperid{Pict\_hare}~\mid{}~\ocwupperid{Pict\_geo}~$\ocwenddcode{}\ocwec{}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{background}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Mauve}~\rightarrow{}~\ocwupperid{Mauve\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Magenta}~\rightarrow{}~\ocwupperid{Magenta\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Pink}~\rightarrow{}~\ocwupperid{Pink\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Chamois}~\rightarrow{}~\ocwupperid{Chamois\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Yellow}~\rightarrow{}~\ocwupperid{Yellow\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Salmon}~\rightarrow{}~\ocwupperid{Salmon\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Cyan}~\rightarrow{}~\ocwupperid{Cyan\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Gold}~\rightarrow{}~\ocwupperid{Gold\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Brown}~\rightarrow{}~\ocwupperid{Brown\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Lime}~\rightarrow{}~\ocwupperid{Lime\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Blue}~\rightarrow{}~\ocwupperid{Blue\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Light\_blue}~\rightarrow{}~\ocwupperid{Light\_blue\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Deep\_sky}~\rightarrow{}~\ocwupperid{Deep\_sky\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Carmin}~\rightarrow{}~\ocwupperid{Carmin\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Orange}~\rightarrow{}~\ocwupperid{Orange\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Red}~\rightarrow{}~\ocwupperid{Red\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Lavender}~\rightarrow{}~\ocwupperid{Lavender\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Green}~\rightarrow{}~\ocwupperid{Green\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Lawngreen}~\rightarrow{}~\ocwupperid{Lawngreen\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Aquamarine}~\rightarrow{}~\ocwupperid{Aquamarine\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Grey}~\rightarrow{}~\ocwupperid{Grey\_back}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unknown\ocwvspace{}background\ocwvspace{}style"}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{centered}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Mauve}~\rightarrow{}~\ocwupperid{Mauve\_cent}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Yellow}~\rightarrow{}~\ocwupperid{Yellow\_cent}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Gold}~\rightarrow{}~\ocwupperid{Gold\_cent}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Deep\_sky}~\rightarrow{}~\ocwupperid{Deep\_sky\_cent}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Cyan}~\rightarrow{}~\ocwupperid{Cyan\_cent}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Lavender}~\rightarrow{}~\ocwupperid{Lavender\_cent}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unknown\ocwvspace{}centered\ocwvspace{}style"}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Table of styles of each style class \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{styles}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Centered}~\rightarrow{}~[~\ocwupperid{Tablecenter}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Mauve\_cent}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Mauve};~\ocwupperid{Tablecenter};~\ocwupperid{Border}~8;~\ocwupperid{Padding}~10~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Yellow\_cent}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Yellow};~\ocwupperid{Tablecenter};~\ocwupperid{Border}~5;~\ocwupperid{Padding}~10~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Lavender\_cent}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Lavender};~\ocwupperid{Tablecenter};~\ocwupperid{Border}~5;~\ocwupperid{Padding}~10~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Inflexion}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Yellow};~\ocwupperid{Tablecenter};~\ocwupperid{Border}~2;~\ocwupperid{Padding}~5~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Deep\_sky\_cent}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Deep\_sky};~\ocwupperid{Tablecenter};~\ocwupperid{Border}~5;~\ocwupperid{Padding}~10~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Gold\_cent}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Gold};~\ocwupperid{Tablecenter};~\ocwupperid{Border}~0;~\ocwupperid{Padding}~10~]~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Cyan\_cent}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Cyan};~\ocwupperid{Tablecenter};~\ocwupperid{Border}~5;~\ocwupperid{Padding}~10~]~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Mauve\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Mauve}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Magenta\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Magenta}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Aquamarine\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Aquamarine}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Pink\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Pale\_rose};~\ocwupperid{No\_margin}~]~$\ocwbc{} Pink \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Yellow\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Yellow}~]~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Salmon\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Salmon}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Chamois\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Chamois};~\ocwupperid{No\_margin};~\ocwupperid{Full\_width}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Cyan\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Cyan}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Gold\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Gold}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Brown\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Brown};~\ocwupperid{No\_margin};~\ocwupperid{Padding}~10;~\ocwupperid{Full\_width}~]~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Lime\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Lime}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Deep\_sky\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Deep\_sky}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Carmin\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Carmin}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Orange\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Orange}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Red\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Red}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Grey\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Grey}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Blue\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Blue}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Lawngreen\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Lawngreen}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Green\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Green}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Light\_blue\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Light\_blue}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Lavender\_back}~\rightarrow{}~[~\ocwupperid{Bgcolor}~\ocwupperid{Lavender}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Blue\_}~\rightarrow{}~[~\ocwlowerid{trans\_font};~\ocwupperid{Color}~\ocwupperid{Blue}~]~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Green\_}~\rightarrow{}~[~\ocwlowerid{trans\_font};~\ocwupperid{Color}~\ocwupperid{Green}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Navy\_}~\rightarrow{}~[~\ocwlowerid{trans\_font};~\ocwupperid{Color}~\ocwupperid{Navy}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Red\_}~\rightarrow{}~[~\ocwlowerid{trans\_font};~\ocwupperid{Color}~\ocwupperid{Red}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Roma16o}~\rightarrow{}~[~\ocwlowerid{trans\_font};~\ocwupperid{Color}~\ocwupperid{Red};~\ocwupperid{Font\_size}~16;~\ocwupperid{Font\_style}~\ocwupperid{Slanted}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Devared\_}~\rightarrow{}~[~\ocwlowerid{deva\_font};~\ocwupperid{Color}~\ocwupperid{Red}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Magenta\_}~\rightarrow{}~[~\ocwlowerid{trans\_font};~\ocwupperid{Color}~\ocwupperid{Magenta}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Header\_deva}~\rightarrow{}~[~\ocwlowerid{deva\_font};~\ocwupperid{Color}~\ocwupperid{Red};~\ocwupperid{Font\_size}~24;~\ocwupperid{Textalign}~\ocwupperid{Left}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Header\_tran}~\rightarrow{}~[~\ocwlowerid{trans\_font};~\ocwupperid{Color}~\ocwupperid{Red};~\ocwupperid{Font\_size}~24;~\ocwupperid{Textalign}~\ocwupperid{Left}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Deva}~\rightarrow{}~[~\ocwlowerid{deva\_font};~\ocwupperid{Color}~\ocwupperid{Maroon};~\ocwupperid{Font\_size}~12~]~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Devac}~\rightarrow{}~[~\ocwlowerid{deva\_font};~\ocwupperid{Color}~\ocwupperid{Blue};~\ocwupperid{Font\_size}~12;~\ocwupperid{Textalign}~\ocwupperid{Center}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Deva16}~\rightarrow{}~[~\ocwlowerid{deva\_font};~\ocwupperid{Color}~\ocwupperid{Blue};~\ocwupperid{Font\_size}~16~]~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Deva16c}~\rightarrow{}~[~\ocwlowerid{deva\_font};~\ocwupperid{Color}~\ocwupperid{Blue};~\ocwupperid{Font\_size}~16;~\ocwupperid{Textalign}~\ocwupperid{Center}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Deva20c}~\rightarrow{}~[~\ocwlowerid{deva\_font};~\ocwupperid{Color}~\ocwupperid{Blue};~\ocwupperid{Font\_size}~20;~\ocwupperid{Textalign}~\ocwupperid{Center}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Alphabet}~\rightarrow{}~[~\ocwlowerid{trans\_font};~\ocwupperid{Font\_size}~24;~\ocwupperid{Textalign}~\ocwupperid{Center}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Title}~\rightarrow{}~[~\ocwlowerid{roman\_font};~\ocwupperid{Color}~\ocwupperid{Blue};~\ocwupperid{Font\_size}~24;~\ocwupperid{Textalign}~\ocwupperid{Center}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Trans12}~\rightarrow{}~[~\ocwlowerid{trans\_font};~\ocwupperid{Font\_size}~12~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{B1}~\rightarrow{}~[~\ocwlowerid{roman\_font};~\ocwupperid{Color}~\ocwupperid{Blue};~\ocwupperid{Font\_size}~20~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{B2}~\rightarrow{}~[~\ocwlowerid{roman\_font};~\ocwupperid{Color}~\ocwupperid{Blue};~\ocwupperid{Font\_size}~16~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{B3}~\rightarrow{}~[~\ocwlowerid{roman\_font};~\ocwupperid{Color}~\ocwupperid{Blue};~\ocwupperid{Font\_size}~12~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{C1}~\rightarrow{}~[~\ocwlowerid{roman\_font};~\ocwupperid{Color}~\ocwupperid{Blue};~\ocwupperid{Font\_size}~20;~\ocwupperid{Textalign}~\ocwupperid{Center}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{C2}~\rightarrow{}~[~\ocwlowerid{roman\_font};~\ocwupperid{Color}~\ocwupperid{Blue};~\ocwupperid{Font\_size}~16;~\ocwupperid{Textalign}~\ocwupperid{Center}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{C3}~\rightarrow{}~[~\ocwlowerid{roman\_font};~\ocwupperid{Color}~\ocwupperid{Blue};~\ocwupperid{Font\_size}~12;~\ocwupperid{Textalign}~\ocwupperid{Center}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{G2}~\rightarrow{}~[~\ocwlowerid{roman\_font};~\ocwupperid{Color}~\ocwupperid{Green};~\ocwupperid{Font\_size}~16~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Center\_}~\rightarrow{}~[~\ocwupperid{Textalign}~\ocwupperid{Center}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Pad60}~\rightarrow{}~[~\ocwupperid{Textalign}~\ocwupperid{Center};~\ocwupperid{Height}~60;~\ocwupperid{Full\_width}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Tcenter}~\rightarrow{}~[~\ocwupperid{Tablecenter}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Roma12o}~\rightarrow{}~[~\ocwlowerid{trans\_font};~\ocwupperid{Color}~\ocwupperid{Black};~\ocwupperid{Font\_size}~12;~\ocwupperid{Font\_style}~\ocwupperid{Slanted}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Latin12}~\rightarrow{}~[~\ocwlowerid{roman\_font};~\ocwupperid{Color}~\ocwupperid{Black};~\ocwupperid{Font\_size}~12~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Latin16}~\rightarrow{}~[~\ocwlowerid{roman\_font};~\ocwupperid{Color}~\ocwupperid{Black};~\ocwupperid{Font\_size}~16~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Trans16}~\rightarrow{}~[~\ocwlowerid{trans\_font};~\ocwupperid{Color}~\ocwupperid{Black};~\ocwupperid{Font\_size}~16~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Math}~\rightarrow{}~[~\ocwlowerid{greek\_font};~\ocwupperid{Color}~\ocwupperid{Black};~\ocwupperid{Font\_size}~12~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Enpied}~\rightarrow{}~[~\ocwupperid{Position}~\ocwlowerid{enpied}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Bandeau}~\rightarrow{}~[~\ocwlowerid{roman\_font};~\ocwupperid{Bgcolor}~\ocwupperid{Cyan};~\ocwupperid{Border\_sep};~\ocwupperid{Border\_sp}~10~$\ocweol
\ocwindent{11.00em}
;~$\ocwupperid{Full\_width}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Body}~\rightarrow{}~[~\ocwlowerid{roman\_font};~\ocwupperid{Bgcolor}~\ocwupperid{Pale\_rose};~\ocwupperid{Border\_sep};~\ocwupperid{Border\_sp}~10$\ocweol
\ocwindent{11.00em}
;~$\ocwupperid{Full\_width}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Spacing20}~\rightarrow{}~[~\ocwupperid{Border\_sep};~\ocwupperid{Border\_sp}~20~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Cell5}~\rightarrow{}~[~\ocwupperid{Padding}~5~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Cell10}~\rightarrow{}~[~\ocwupperid{Padding}~10~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Border2}~\rightarrow{}~[~\ocwupperid{Border}~2~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Hidden\_}~\rightarrow{}~[~\ocwupperid{Hidden}~]$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Compiles a class into its style for non-css compliant browsers \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Mostly used by Css to compile the css style sheet \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{style}~\ocwlowerid{cla}~=~\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{";\ocwvspace{}"}~$(\ocwupperid{List.}\ocwlowerid{map}~\ocwlowerid{style\_sheet}~(\ocwlowerid{styles}~\ocwlowerid{cla}))~$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{class\_of}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Mauve\_cent}~\rightarrow{}~$\ocwstring{"mauve\_cent"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Yellow\_cent}~\rightarrow{}~$\ocwstring{"yellow\_cent"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Inflexion}~\rightarrow{}~$\ocwstring{"inflexion"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Deep\_sky\_cent}~\rightarrow{}~$\ocwstring{"deep\_sky\_cent"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Centered}~\rightarrow{}~$\ocwstring{"centered"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Cyan\_cent}~\rightarrow{}~$\ocwstring{"cyan\_cent"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Mauve\_back}~\rightarrow{}~$\ocwstring{"mauve\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Magenta\_back}~\rightarrow{}~$\ocwstring{"magenta\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Pink\_back}~\rightarrow{}~$\ocwstring{"pink\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Gold\_cent}~\rightarrow{}~$\ocwstring{"gold\_cent"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Yellow\_back}~\rightarrow{}~$\ocwstring{"yellow\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Blue\_back}~\rightarrow{}~$\ocwstring{"blue\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Light\_blue\_back}~\rightarrow{}~$\ocwstring{"light\_blue\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Salmon\_back}~\rightarrow{}~$\ocwstring{"salmon\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Chamois\_back}~\rightarrow{}~$\ocwstring{"chamois\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Cyan\_back}~\rightarrow{}~$\ocwstring{"cyan\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Gold\_back}~\rightarrow{}~$\ocwstring{"gold\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Lavender\_back}~\rightarrow{}~$\ocwstring{"lavender\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Lavender\_cent}~\rightarrow{}~$\ocwstring{"lavender\_cent"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Brown\_back}~\rightarrow{}~$\ocwstring{"brown\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Lime\_back}~\rightarrow{}~$\ocwstring{"lime\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Deep\_sky\_back}~\rightarrow{}~$\ocwstring{"deep\_sky\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Carmin\_back}~\rightarrow{}~$\ocwstring{"carmin\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Orange\_back}~\rightarrow{}~$\ocwstring{"orange\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Red\_back}~\rightarrow{}~$\ocwstring{"red\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Green\_back}~\rightarrow{}~$\ocwstring{"green\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Lawngreen\_back}~\rightarrow{}~$\ocwstring{"lawngreen\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Aquamarine\_back}~\rightarrow{}~$\ocwstring{"aquamarine\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Grey\_back}~\rightarrow{}~$\ocwstring{"grey\_back"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Blue\_}~\rightarrow{}~$\ocwstring{"blue"}~\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Green\_}~\rightarrow{}~$\ocwstring{"green"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Navy\_}~\rightarrow{}~$\ocwstring{"navy"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Red\_}~\rightarrow{}~$\ocwstring{"red"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Roma16o}~\rightarrow{}~$\ocwstring{"red16"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Roma12o}~\rightarrow{}~$\ocwstring{"roma12o"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Magenta\_}~\rightarrow{}~$\ocwstring{"magenta"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Header\_deva}~\rightarrow{}~$\ocwstring{"header\_deva"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Header\_tran}~\rightarrow{}~$\ocwstring{"header\_tran"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Latin12}~\rightarrow{}~$\ocwstring{"latin12"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Deva}~\rightarrow{}~$\ocwstring{"deva"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Devared\_}~\rightarrow{}~$\ocwstring{"devared"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Devac}~\rightarrow{}~$\ocwstring{"devac"}~\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Deva16}~\rightarrow{}~$\ocwstring{"deva16"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Deva16c}~\rightarrow{}~$\ocwstring{"deva16c"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Deva20c}~\rightarrow{}~$\ocwstring{"deva20c"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Alphabet}~\rightarrow{}~$\ocwstring{"alphabet"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Title}~\rightarrow{}~$\ocwstring{"title"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Trans12}~\rightarrow{}~$\ocwstring{"trans12"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{B1}~\rightarrow{}~$\ocwstring{"b1"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{B2}~\rightarrow{}~$\ocwstring{"b2"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{B3}~\rightarrow{}~$\ocwstring{"b3"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{C1}~\rightarrow{}~$\ocwstring{"c1"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{C2}~\rightarrow{}~$\ocwstring{"c2"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{C3}~\rightarrow{}~$\ocwstring{"c3"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{G2}~\rightarrow{}~$\ocwstring{"g2"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Center\_}~\rightarrow{}~$\ocwstring{"center"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Tcenter}~\rightarrow{}~$\ocwstring{"center"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Spacing20}~\rightarrow{}~$\ocwstring{"spacing20"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Latin16}~\rightarrow{}~$\ocwstring{"latin16"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Trans16}~\rightarrow{}~$\ocwstring{"trans16"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Math}~\rightarrow{}~$\ocwstring{"math"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Enpied}~\rightarrow{}~$\ocwstring{"enpied"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Bandeau}~\rightarrow{}~$\ocwstring{"bandeau"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Pad60}~\rightarrow{}~$\ocwstring{"pad60"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Cell5}~\rightarrow{}~$\ocwstring{"cell5"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Cell10}~\rightarrow{}~$\ocwstring{"cell10"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Border2}~\rightarrow{}~$\ocwstring{"border2"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Body}~\rightarrow{}~$\ocwstring{"body"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Hidden\_}~\rightarrow{}~$\ocwstring{"hidden"}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwbc{} Allows css style compiling even when browser does not support css \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} This support was necessary for Simputer platform \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{elt\_begin\_attrs}~\ocwlowerid{attrs}~\ocwlowerid{elt}~\ocwlowerid{cl}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{style\_attr}~=~$\ocwbc{} if Install.css then \ocwec{}~$($\ocwstring{"class"},$\ocwlowerid{class\_of}~\ocwlowerid{cl})~$\ocweol
\ocwindent{16.50em}
\ocwbc{}  else (\ocwstring{"style"},style cl) \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_begin\_with\_att}~\ocwlowerid{elt}~[~\ocwlowerid{style\_attr}~::~\ocwlowerid{attrs}~]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{elt\_begin}~=~\ocwlowerid{elt\_begin\_attrs}~[\,]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{par\_begin}~=~\ocwlowerid{elt\_begin}~$\ocwstring{"p"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{h1\_begin}~=~\ocwlowerid{elt\_begin}~$\ocwstring{"h1"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{h2\_begin}~=~\ocwlowerid{elt\_begin}~$\ocwstring{"h2"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{h3\_begin}~=~\ocwlowerid{elt\_begin}~$\ocwstring{"h3"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{span\_begin}~=~\ocwlowerid{elt\_begin}~$\ocwstring{"span"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{span\_skt\_begin}~=~\ocwlowerid{elt\_begin\_attrs}~[~($\ocwstring{"lang"},\ocwstring{"sa"}$)~]~$\ocwstring{"span"}~\ocwbc{} EXP \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{div\_begin}~=~\ocwlowerid{elt\_begin}~$\ocwstring{"div"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{body\_begin}~=~\ocwlowerid{elt\_begin}~$\ocwstring{"body"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{body\_begin\_style}~=~\ocwlowerid{elt\_begin\_attrs}~\ocwlowerid{margins}~$\ocwstring{"body"}~\ocwbc{} Body margins are null \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~\ocwlowerid{margins}~=~[~($\ocwstring{"style"},\ocwstring{"margin\symbol{45}left:\ocwvspace{}0;\ocwvspace{}margin\symbol{45}right:\ocwvspace{}0;\ocwvspace{}margin\symbol{45}top:\ocwvspace{}0;"}$)~]$\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{table\_begin\_style}$\ocwenddcode{} not compliant with HTML5 (dynamic style)      \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{table\_begin\_style}~\ocwlowerid{style}~\ocwlowerid{attrs}~=~\ocwlowerid{elt\_begin\_attrs}~\ocwlowerid{attrs}~$\ocwstring{"table"}~$\ocwlowerid{style}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{table\_begin}~=~\ocwlowerid{elt\_begin}~$\ocwstring{"table"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{td\_begin\_class}~=~\ocwlowerid{elt\_begin}~$\ocwstring{"td"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{th\_begin\_class}~=~\ocwlowerid{elt\_begin}~$\ocwstring{"th"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{td\_begin\_att}~=~\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"td"}~\ocwbc{} depr \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{par\_end}~=~\ocwlowerid{xml\_end}~$\ocwstring{"p"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{h1\_end}~=~\ocwlowerid{xml\_end}~$\ocwstring{"h1"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{h2\_end}~=~\ocwlowerid{xml\_end}~$\ocwstring{"h2"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{h3\_end}~=~\ocwlowerid{xml\_end}~$\ocwstring{"h3"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{span\_end}~=~\ocwlowerid{xml\_end}~$\ocwstring{"span"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{div\_end}~=~\ocwlowerid{xml\_end}~$\ocwstring{"div"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{body\_end}~=~\ocwlowerid{xml\_end}~$\ocwstring{"body"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{table\_end}~=~\ocwlowerid{xml\_end}~$\ocwstring{"table"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} table parameters \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{noborder}~=~($\ocwstring{"border"},\ocwstring{"0"}$)$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{nopadding}~=~($\ocwstring{"cellpadding"},\ocwstring{"0\%"}$)$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{padding5}~=~($\ocwstring{"cellpadding"},\ocwstring{"5\%"}$)$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{padding10}~=~($\ocwstring{"cellpadding"},\ocwstring{"10\%"}$)$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{nospacing}~=~($\ocwstring{"cellspacing"},\ocwstring{"0"}$)$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{spacing5}~=~($\ocwstring{"cellspacing"},\ocwstring{"5pt"}$)$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{spacing20}~=~($\ocwstring{"cellspacing"},\ocwstring{"20pt"}$)$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{fullwidth}~=~($\ocwstring{"width"},\ocwstring{"100\%"}$)$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{span}~\ocwlowerid{style}~\ocwlowerid{text}~=~\ocwlowerid{span\_begin}~\ocwlowerid{style}~$\^{}~$\ocwlowerid{text}~$\^{}~$\ocwlowerid{span\_end}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{span\_skt}~\ocwlowerid{style}~\ocwlowerid{text}~=~\ocwlowerid{span\_skt\_begin}~\ocwlowerid{style}~$\^{}~$\ocwlowerid{text}~$\^{}~$\ocwlowerid{span\_end}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{div}~\ocwlowerid{style}~\ocwlowerid{text}~=~\ocwlowerid{div\_begin}~\ocwlowerid{style}~$\^{}~$\ocwlowerid{text}~$\^{}~$\ocwlowerid{div\_end}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{center}~=~\ocwlowerid{div}~\ocwupperid{Center\_}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{center\_begin}~=~\ocwlowerid{div\_begin}~\ocwupperid{Center\_}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{center\_end}~=~\ocwlowerid{div\_end}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{center\_image}~\ocwlowerid{name}~\ocwlowerid{caption}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{center}~(\ocwlowerid{xml\_empty\_with\_att}~$\ocwstring{"img"}~$[~($\ocwstring{"src"},$\ocwlowerid{name});~($\ocwstring{"alt"},$\ocwlowerid{caption})~])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{html\_red}~=~\ocwlowerid{span}~\ocwupperid{Red\_}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{html\_devared}~=~\ocwlowerid{span\_skt}~\ocwupperid{Devared\_}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{html\_magenta}~=~\ocwlowerid{span}~\ocwupperid{Magenta\_}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{html\_blue}~=~\ocwlowerid{span}~\ocwupperid{Blue\_}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{html\_green}~=~\ocwlowerid{span}~\ocwupperid{Green\_}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{html\_math}~=~\ocwlowerid{span}~\ocwupperid{Math}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{html\_trans12}~=~\ocwlowerid{span}~\ocwupperid{Trans12}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{html\_trans16}~=~\ocwlowerid{span}~\ocwupperid{Trans16}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{html\_latin12}~=~\ocwlowerid{span}~\ocwupperid{Latin12}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{html\_latin16}~=~\ocwlowerid{span}~\ocwupperid{Latin16}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{roma16\_red\_sl}~=~\ocwlowerid{span}~\ocwupperid{Roma16o}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{roma12\_sl}~=~\ocwlowerid{span}~\ocwupperid{Roma12o}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{span2\_center}~=~\ocwlowerid{span}~\ocwupperid{B2}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{span3\_center}~=~\ocwlowerid{span}~\ocwupperid{B3}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{deva12\_blue\_center}~=~\ocwlowerid{span\_skt}~\ocwupperid{Devac}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{deva16\_blue}~=~\ocwlowerid{span\_skt}~\ocwupperid{Deva16}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{deva16\_blue\_center}~=~\ocwlowerid{span\_skt}~\ocwupperid{Deva16c}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{deva20\_blue\_center}~=~\ocwlowerid{span\_skt}~\ocwupperid{Deva20c}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{title}~\ocwlowerid{s}~=~\ocwlowerid{xml\_begin}~$\ocwstring{"title"}~\^{}~$\ocwlowerid{s}~$\^{}~$\ocwlowerid{xml\_end}~$\ocwstring{"title"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{h1\_title}~\ocwlowerid{s}~=~\ocwlowerid{h1\_begin}~\ocwupperid{Title}~$\^{}~$\ocwlowerid{s}~$\^{}~$\ocwlowerid{h1\_end}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{h1\_center}~\ocwlowerid{s}~=~\ocwlowerid{h1\_begin}~\ocwupperid{B1}~$\^{}~$\ocwlowerid{s}~$\^{}~$\ocwlowerid{h1\_end}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{italics}~\ocwlowerid{s}~=~\ocwlowerid{xml\_begin}~$\ocwstring{"i"}~\^{}~$\ocwlowerid{s}~$\^{}~$\ocwlowerid{xml\_end}~$\ocwstring{"i"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{emph}~\ocwlowerid{s}~=~\ocwlowerid{xml\_begin}~$\ocwstring{"b"}~\^{}~$\ocwlowerid{s}~$\^{}~$\ocwlowerid{xml\_end}~$\ocwstring{"b"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{hr}~=~\ocwlowerid{xml\_empty}~$\ocwstring{"hr"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{anchor\_ref}~\ocwlowerid{url}~\ocwlowerid{link}~=$\ocweol
\ocwindent{1.00em}
$(\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"a"}~$[~($\ocwstring{"href"},$\ocwlowerid{url})~])~$\^{}~$\ocwlowerid{link}~$\^{}~$(\ocwlowerid{xml\_end}~$\ocwstring{"a"}$)$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{anchor}~\ocwlowerid{cl}~\ocwlowerid{url}~\ocwlowerid{link}~=$\ocweol
\ocwindent{1.00em}
$(\ocwlowerid{elt\_begin\_attrs}~[~($\ocwstring{"href"},$\ocwlowerid{url})~]~$\ocwstring{"a"}~$\ocwlowerid{cl})~$\^{}~$\ocwlowerid{link}~$\^{}~$(\ocwlowerid{xml\_end}~$\ocwstring{"a"}$)$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{anchor\_def}~\ocwlowerid{label}~\ocwlowerid{link}~=$\ocweol
\ocwindent{1.00em}
$(\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"a"}~$[~($\ocwstring{"name"},$\ocwlowerid{label})~])~$\^{}~$\ocwlowerid{link}~$\^{}~$(\ocwlowerid{xml\_end}~$\ocwstring{"a"}$)$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{anchor\_define}~\ocwlowerid{cl}~\ocwlowerid{label}~\ocwlowerid{link}~=$\ocweol
\ocwindent{1.00em}
$(\ocwlowerid{elt\_begin\_attrs}~[~($\ocwstring{"name"},$\ocwlowerid{label})~]~$\ocwstring{"a"}~$\ocwlowerid{cl})~$\^{}~$\ocwlowerid{link}~$\^{}~$(\ocwlowerid{xml\_end}~$\ocwstring{"a"}$)$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{anchor\_graph}~\ocwlowerid{cl}~\ocwlowerid{url}~\ocwlowerid{link}~=$\ocweol
\ocwindent{1.00em}
\ocwstring{"\ensuremath{<}a\ocwvspace{}href=\&quot;"}~\^{}~$\ocwlowerid{url}~$\^{}~\ocwstring{"\&quot;\ensuremath{>}"}~\^{}~$\ocwlowerid{link}~$\^{}~\ocwstring{"\ensuremath{<}/a\ensuremath{>}"}\ocweol
\ocwindent{0.00em}
;~\ocwbc{} NB: use \ocwbegindcode{}$\land{}\ocwlowerid{quot};$\ocwenddcode{} and not quote sign for Javascript \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{anchor\_begin}~=~\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"a"}~$[~($\ocwstring{"class"},~\ocwstring{"navy"}$)~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{anchor\_pseudo}~\ocwlowerid{url}~\ocwlowerid{link}~=$\ocweol
\ocwindent{2.00em}
$(\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"a"}~$[~($\ocwstring{"href"},$\ocwlowerid{url});~($\ocwstring{"style"},\ocwstring{"text\symbol{45}decoration:\ocwvspace{}none"}$)~])$\ocweol
\ocwindent{1.00em}
\^{}~$\ocwlowerid{link}~$\ocweol
\ocwindent{1.00em}
\^{}~$(\ocwlowerid{xml\_end}~$\ocwstring{"a"}$)$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Specific HTML scripting 
\ocweol
\label{html.ml:24895}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{start\_year}~=~$\ocwstring{"\ocwvspace{}1994\symbol{45}"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{current\_year}~=~$\ocwstring{"2018"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{author\_name}~=~$\ocwstring{"G\&\#233;rard\ocwvspace{}Huet"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{copyright}~=~$\ocwstring{"\&\#169;\ocwvspace{}"}~\^{}~$\ocwlowerid{author\_name}~$\^{}~$\ocwlowerid{start\_year}~$\^{}~$\ocwlowerid{current\_year}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{author}~=~\ocwlowerid{fieldn}~$\ocwstring{"author"}~$\ocwlowerid{author\_name}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{date\_copyrighted}~=~\ocwlowerid{fieldp}~$\ocwstring{"dc:datecopyrighted"}~$\ocwlowerid{current\_year}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{rights\_holder}~=~\ocwlowerid{fieldp}~$\ocwstring{"dc:rightsholder"}~$\ocwlowerid{author\_name}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{keywords}~=~\ocwlowerid{fieldn}~$\ocwstring{"keywords"}~\ocweol
\ocwindent{2.00em}
\ocwstring{"dictionary,sanskrit,heritage,dictionnaire,sanscrit,india,inde,indology,linguistics,panini,digital\ocwvspace{}humanities,cultural\ocwvspace{}heritage,computational\ocwvspace{}linguistics,hypertext\ocwvspace{}lexicon"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{heritage\_dictionary\_title}~=~\ocwlowerid{title}~$\ocwstring{"Sanskrit\ocwvspace{}Heritage\ocwvspace{}Dictionary"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} was in Install \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Supported publishing media \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{medium}~=~[~\ocwupperid{Html}~\mid{}~\ocwupperid{Tex}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Supported HTTP platforms \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{platform}~=~[~\ocwupperid{Simputer}~\mid{}~\ocwupperid{Computer}~\mid{}~\ocwupperid{Station}~\mid{}~\ocwupperid{Server}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Current target platform to customize - needs recompiling if changed \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{target}~=~$\ocwkw{match}~$\ocwupperid{Paths.}\ocwlowerid{platform}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"Simputer"}~$\rightarrow{}~\ocwupperid{Simputer}~$\ocwbc{} Historical - small screen \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Smartphone"}~$\rightarrow{}~\ocwupperid{Simputer}~$\ocwbc{} Smartphone version not implemented yet \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Computer"}~$\rightarrow{}~\ocwupperid{Computer}~$\ocwbc{} Standard client installation \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Station"}~$\rightarrow{}~\ocwupperid{Station}~$\ocwbc{} Permits external Analysis mode \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"Server"}~$\rightarrow{}~\ocwupperid{Server}~$\ocwbc{} Http server for Internet web services \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unknown\ocwvspace{}target\ocwvspace{}platform"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Features of target architecture \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~(\ocwlowerid{narrow\_screen},\ocwlowerid{screen\_char\_length},\ocwlowerid{css})~=~$\ocweol
\ocwindent{0.50em}
\ocwkw{match}~$\ocwlowerid{target}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Simputer}~\rightarrow{}~(\ocwupperid{True},40,\ocwupperid{False})~$\ocwbc{} Historical for Simputer platform \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Station}~$\ocwbc{} Privileged client mode \ocwec{}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Computer}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Server}~\rightarrow{}~(\ocwupperid{False},80,\ocwupperid{True})~$\ocwbc{} Server mode \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Internationalisation \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{language}~=~[~\ocwupperid{French}~\mid{}~\ocwupperid{English}~]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Two indexing lexicons are supported, French SH and English MW.\ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{lexicon\_of}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{French}~\rightarrow{}~$\ocwstring{"SH"}~\ocwbc{} Sanskrit Heritage \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{English}~\rightarrow{}~$\ocwstring{"MW"}~\ocwbc{} Monier-Williams \ocwec{}~\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{language\_of}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"SH"}~$\rightarrow{}~\ocwupperid{French}~$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"MW"}~$\rightarrow{}~\ocwupperid{English}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unknown\ocwvspace{}lexicon"}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{default\_language}~=~\ocwlowerid{language\_of}~\ocwupperid{Paths.}\ocwlowerid{default\_lexicon}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{default\_mode}~=~$\ocwbc{} TODO - add as config parameter \ocwec{}\ocweol
\ocwindent{0.50em}
\ocwkw{match}~$\ocwlowerid{target}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Station}~\mid{}~\ocwupperid{Computer}~\mid{}~\ocwupperid{Server}~\rightarrow{}~$\ocwstring{"t"}~\ocwbc{} default Complete mode \ocwec{}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~$\ocwstring{"f"}~\ocwbc{} default Simplified mode \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} linked lexical resource - initialized at configuration  \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{lexicon\_toggle}~=~$\ocwbt{ref}~$\ocwupperid{Paths.}\ocwlowerid{default\_lexicon}~$\ocwbc{} mutable for lexicon access \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{toggle\_lexicon}~\ocwlowerid{lex}~=~\ocwlowerid{lexicon\_toggle.}\ocwlowerid{val}~:=~\ocwlowerid{lex}$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{page\_extension}~\ocwlowerid{lang}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{lang\_sfx}~=~$\ocwkw{fun}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{French}~\rightarrow{}~$\ocwstring{"fr"}~\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{English}~\rightarrow{}~$\ocwstring{"en"}~\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwstring{"."}~\^{}~$\ocwlowerid{lang\_sfx}~\ocwlowerid{lang}~$\^{}~\ocwstring{".html"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{wrap\_ext}~\ocwlowerid{page}~\ocwlowerid{lang}~=~\ocwlowerid{page}~$\^{}~$\ocwlowerid{page\_extension}~\ocwlowerid{lang}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{site\_entry\_page}~=~\ocwlowerid{wrap\_ext}~$\ocwstring{"index"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{dico\_index\_page}~=~\ocwlowerid{wrap\_ext}~$\ocwstring{"index"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{dico\_reader\_page}~=~\ocwlowerid{wrap\_ext}~$\ocwstring{"reader"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{dico\_grammar\_page}~=~\ocwlowerid{wrap\_ext}~$\ocwstring{"grammar"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{dico\_sandhi\_page}~=~\ocwlowerid{wrap\_ext}~$\ocwstring{"sandhi"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{dico\_corpus\_page}~=~\ocwlowerid{wrap\_ext}~$\ocwstring{"corpus"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{faq\_page}~=~\ocwlowerid{wrap\_ext}~$\ocwstring{"faq"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{portal\_page}~=~\ocwlowerid{wrap\_ext}~$\ocwstring{"portal"}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} URLs relative to DICO for static pages \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rel\_dico\_path}~=~$\ocwstring{"../"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{images\_top\_path}~=~$\ocwstring{"IMAGES/"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rel\_sanskrit\_page\_url}~\ocwlowerid{l}~=~\ocwlowerid{rel\_dico\_path}~$\^{}~$(\ocwlowerid{site\_entry\_page}~\ocwlowerid{l})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{rel\_faq\_page\_url}~\ocwlowerid{l}~=~\ocwlowerid{rel\_dico\_path}~$\^{}~$(\ocwlowerid{faq\_page}~\ocwlowerid{l})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{rel\_portal\_page\_url}~\ocwlowerid{l}~=~\ocwlowerid{rel\_dico\_path}~$\^{}~$(\ocwlowerid{portal\_page}~\ocwlowerid{l})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{rel\_web\_images\_url}~=~\ocwlowerid{rel\_dico\_path}~$\^{}~$\ocwlowerid{images\_top\_path}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rel\_image}~\ocwlowerid{name}~=~\ocwlowerid{rel\_web\_images\_url}~$\^{}~$\ocwlowerid{name}$\ocweol
\ocwindent{0.00em}
\ocwbc{} rel image is relative in order to pre-compile DICO in distribution site \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{rel\_ocaml\_logo}~=~\ocwlowerid{rel\_image}~$\ocwstring{"icon\_ocaml.png"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{rel\_inria\_logo}~=~\ocwlowerid{rel\_image}~$\ocwstring{"logo\_inria.png"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{left\_blue\_arr}~=~\ocwlowerid{rel\_image}~$\ocwstring{"arrw01\_16a.gif"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{right\_blue\_arr}~=~\ocwlowerid{rel\_image}~$\ocwstring{"arrw01\_06a.gif"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{rel\_favicon}~=~\ocwlowerid{rel\_image}~$\ocwstring{"favicon.ico"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{meta\_prefix}~=~\ocwlowerid{xml\_empty\_with\_att}~$\ocwstring{"meta"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{contents\_instructions}~=~$\ocweol
\ocwindent{1.00em}
$[~[~($\ocwstring{"charset"},\ocwstring{"utf\symbol{45}8"}$)~]~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{title\_instructions}~=~$\ocweol
\ocwindent{1.00em}
$[~\ocwlowerid{author};~\ocwlowerid{date\_copyrighted};~\ocwlowerid{rights\_holder};~\ocwlowerid{keywords}~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{doctype}~=~$\ocwstring{"\ensuremath{<}!DOCTYPE\ocwvspace{}html\ensuremath{>}"}~\ocwbc{} Assuming HTML5 \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{url}~\ocwlowerid{dns}~=~$\ocwstring{"http://"}~\^{}~$\ocwlowerid{dns};$\medskip

\label{html.ml:28885}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ocaml\_site}~=~\ocwlowerid{url}~$\ocwstring{"ocaml.org"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{inria\_site}~=~\ocwlowerid{url}~$\ocwstring{"www.inria.fr/"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{tomcat}~=~\ocwlowerid{url}~$\ocwstring{"localhost:8080/"}~\ocwbc{} Sanskrit Library runs Tomcat \ocwec{}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Button 
\ocweol
\label{html.ml:29069}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{js\_string\_arg}~\ocwlowerid{s}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{delim}~\ocwlowerid{delim}~\ocwlowerid{s}~=~\ocwlowerid{delim}~$\^{}~$\ocwlowerid{s}~$\^{}~$\ocwlowerid{delim}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{delim}~$\ocwstring{"'"}~$\ocwlowerid{s}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{js\_funcall}~=~\{~\ocwlowerid{js\_funid}~:~$\ocwbt{string};~$\ocwlowerid{js\_funargs}~:~$\ocwbt{list}~\ocwbt{string}~\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{string\_of\_js\_funcall}~\ocwlowerid{f}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{js\_funargs}~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwlowerid{js\_string\_arg}~\ocwlowerid{f.}\ocwlowerid{js\_funargs}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{f.}\ocwlowerid{js\_funid}~$\^{}~\ocwstring{"("}~\^{}~$\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{",\ocwvspace{}"}~$\ocwlowerid{js\_funargs}~$\^{}~\ocwstring{")"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{button}~?\ocwlowerid{id}~?\ocwlowerid{cl}~?\ocwlowerid{onclick}~\ocwlowerid{label}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{button}~=~$\ocwstring{"button"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{attrs}~=$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{add\_opt\_attrs}$\ocweol
\ocwindent{3.00em}
$[~($\ocwstring{"onclick"},~$\ocwupperid{Gen.}\ocwlowerid{opt\_app}~\ocwlowerid{string\_of\_js\_funcall}~\ocwlowerid{onclick})$\ocweol
\ocwindent{3.00em}
;~$($\ocwstring{"id"},~$\ocwlowerid{id})$\ocweol
\ocwindent{3.00em}
;~$($\ocwstring{"class"},~$\ocwupperid{Gen.}\ocwlowerid{opt\_app}~\ocwlowerid{class\_of}~\ocwlowerid{cl})$\ocweol
\ocwindent{3.00em}
$]~[\,]$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{button\_begin}~=~\ocwlowerid{xml\_begin\_with\_att}~\ocwlowerid{button}~\ocwlowerid{attrs}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{button\_end}~=~\ocwlowerid{xml\_end}~\ocwlowerid{button}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{button\_begin}~$\^{}~$\ocwlowerid{label}~$\^{}~$\ocwlowerid{button\_end}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Return a copy of the given string with special HTML characters
   represented by escaped sequences (e.g. \ocwbegindcode{}\verb!'&'!\ocwenddcode{} is replaced with
   \ocwbegindcode{}\ocwstring{"\&amp;"}\ocwenddcode{} ).  \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{escape}~\ocwlowerid{s}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{conversion\_tbl}~=$\ocweol
\ocwindent{2.00em}
$[~($\ocwstring{"\symbol{92}""},~\ocwstring{"quot"}$)$\ocweol
\ocwindent{2.00em}
;~$($\ocwstring{"\&"},~\ocwstring{"amp"}$)$\ocweol
\ocwindent{2.00em}
;~$($\ocwstring{"'"},~\ocwstring{"apos"}$)$\ocweol
\ocwindent{2.00em}
;~$($\ocwstring{"\ensuremath{<}"},~\ocwstring{"lt"}$)$\ocweol
\ocwindent{2.00em}
;~$($\ocwstring{"\ensuremath{>}"},~\ocwstring{"gt"}$)$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{escape}~\ocwlowerid{s}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{try}~\ocwstring{"\&"}~\^{}~$\ocwupperid{List.}\ocwlowerid{assoc}~\ocwlowerid{s}~\ocwlowerid{conversion\_tbl}~$\^{}~\ocwstring{";"}~\ocwkw{with}~$[~\ocwupperid{Not\_found}~\rightarrow{}~\ocwlowerid{s}~]$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{special\_chars}~=$\ocweol
\ocwindent{2.00em}
$\ocwupperid{Str.}\ocwlowerid{regexp}~($\ocweol
\ocwindent{3.00em}
\ocwstring{"["}~\^{}~$\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{""}~$(\ocwlowerid{conversion\_tbl}~|\ensuremath{>}~\ocwupperid{List.}\ocwlowerid{split}~|\ensuremath{>}~\ocwlowerid{fst})~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}~\ocwstring{"]"}\ocweol
\ocwindent{2.00em}
$)$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{subst}~\ocwlowerid{s}~=~\ocwlowerid{s}~|\ensuremath{>}~\ocwupperid{Str.}\ocwlowerid{matched\_string}~|\ensuremath{>}~\ocwlowerid{escape}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{Str.}\ocwlowerid{global\_substitute}~\ocwlowerid{special\_chars}~\ocwlowerid{subst}~\ocwlowerid{s}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Web.ml}
\ocwmodule{Web}
\label{web.ml:0}%
module Web html = struct 
\ocweol
\ocwindent{0.00em}
Module Web reads localisation parameters from paths.ml, 
   created by "make configure" in main directory, called by configure script.
   Describes all installation parameters and resources other than Inastall. 
\ocweol
\ocwindent{0.00em}
Dynamic html rendering, used by cgis 
\ocweol
\label{web.ml:914}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\medskip

\ocwendcode{}\ocwindent{0.00em}
truncation is the maximum number of solutions computed by the lexer.
   Too small a truncation limit will miss solutions, too large a truncation 
   limit will provoke un unrecoverable choking server failure. This is relevant
   only for the parser (deprecated) mode. The graph interface has no limit. 
\ocweol
\label{web.ml:1234}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{truncation}~=~10000~$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
threshold for printing the list of explicit segmentation solutions 
\ocweol
\label{web.ml:1337}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{max\_count}~=~100~$\ocwbc{} do not exceed - use rather the graphical interface \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{cache\_allowed}~=~\ocwlowerid{target}=\ocwupperid{Station}~$\ocwbc{} cache allowed only on Station \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{cache\_active}~=~$\ocwbt{ref}~$($\ocwkw{if}~$\ocwlowerid{cache\_allowed}~$\ocwkw{then}~\ocwstring{"t"}~\ocwkw{else}~\ocwstring{"f"}$)$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} For interface look-and-feel \ocwec{}~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~(\ocwlowerid{display\_morph\_action},\ocwlowerid{mouse\_action\_help})~=~$\ocwkw{match}~$\ocwupperid{Paths.}\ocwlowerid{mouse\_action}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"CLICK"}~$\rightarrow{}~($\ocwstring{"onclick"},\ocwstring{"Click"}$)~$\ocweol
\ocwindent{1.00em}
$\mid{}~$\ocwstring{"OVER"}~$\rightarrow{}~($\ocwstring{"onMouseover"},\ocwstring{"Mouse"}$)$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unknown\ocwvspace{}mouse\ocwvspace{}action,\ocwvspace{}change\ocwvspace{}config\ocwvspace{}file"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{cgi\_bin}~\ocwlowerid{name}~=~\ocwupperid{Paths.}\ocwlowerid{cgi\_dir\_url}~$\^{}~$\ocwlowerid{name}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Call-backs as cgi binaries \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{index\_cgi}~=~\ocwlowerid{cgi\_bin}~\ocwupperid{Paths.}\ocwlowerid{cgi\_index}~$\ocwbc{} index \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{dummy\_cgi}~=~\ocwlowerid{cgi\_bin}~\ocwupperid{Paths.}\ocwlowerid{cgi\_indexd}~$\ocwbc{} index for dummies \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{decls\_cgi}~=~\ocwlowerid{cgi\_bin}~\ocwupperid{Paths.}\ocwlowerid{cgi\_decl}~$\ocwbc{} declensions \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{conjs\_cgi}~=~\ocwlowerid{cgi\_bin}~\ocwupperid{Paths.}\ocwlowerid{cgi\_conj}~$\ocwbc{} conjugations \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{lemmatizer\_cgi}~=~\ocwlowerid{cgi\_bin}~\ocwupperid{Paths.}\ocwlowerid{cgi\_lemmatizer}~$\ocwbc{} lemmatizer \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{reader\_cgi}~=~\ocwlowerid{cgi\_bin}~\ocwupperid{Paths.}\ocwlowerid{cgi\_reader}~$\ocwbc{} reader \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{parser\_cgi}~=~\ocwlowerid{cgi\_bin}~\ocwupperid{Paths.}\ocwlowerid{cgi\_parser}~$\ocwbc{} parser \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{graph\_cgi}~=~\ocwlowerid{cgi\_bin}~\ocwupperid{Paths.}\ocwlowerid{cgi\_graph}~$\ocwbc{} summarizer graphical interface \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{user\_aid\_cgi}~=~\ocwlowerid{cgi\_bin}~\ocwupperid{Paths.}\ocwlowerid{cgi\_user\_aid}~$\ocwbc{} unknown chunks processing \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sandhier\_cgi}~=~\ocwlowerid{cgi\_bin}~\ocwupperid{Paths.}\ocwlowerid{cgi\_sandhier}~$\ocwbc{} sandhier \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{corpus\_manager\_cgi}~=~\ocwlowerid{cgi\_bin}~\ocwupperid{Paths.}\ocwlowerid{cgi\_corpus\_manager}~$\ocwbc{} Corpus manager \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{save\_corpus\_cgi}~=~\ocwlowerid{cgi\_bin}~\ocwupperid{Paths.}\ocwlowerid{cgi\_save\_corpus}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{mkdir\_corpus\_cgi}~=~\ocwlowerid{cgi\_bin}~\ocwupperid{Paths.}\ocwlowerid{cgi\_mkdir\_corpus}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Absolute paths on development site \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{resources}~\ocwlowerid{name}~=~\ocwupperid{Paths.}\ocwlowerid{skt\_resources\_dir}~$\^{}~$\ocwlowerid{name}~$\^{}~\ocwstring{"/"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Read-only resources \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{heritage\_dir}~=~\ocwlowerid{resources}~$\ocwstring{"DICO"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{data\_dir}~=~\ocwlowerid{resources}~$\ocwstring{"DATA"}~\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
\ocwbc{} Local resources \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{top\_dev\_dir}~\ocwlowerid{name}~=~\ocwupperid{Paths.}\ocwlowerid{skt\_install\_dir}~$\^{}~$\ocwlowerid{name}~$\^{}~\ocwstring{"/"}~\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{dico\_dir}~=~\ocwlowerid{top\_dev\_dir}~$\ocwstring{"DICO"}~\ocwbc{} augments local copy of DICO dynamically \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Absolute paths of target server \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{top\_site\_dir}~\ocwlowerid{name}~=~\ocwupperid{Paths.}\ocwlowerid{public\_skt\_dir}~$\^{}~$\ocwlowerid{name}~$\^{}~\ocwstring{"/"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{public\_dico\_dir}~=~\ocwlowerid{top\_site\_dir}~$\ocwstring{"DICO"}~\ocwbc{} hypertext dictionary \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_data\_dir}~=~\ocwlowerid{top\_site\_dir}~$\ocwstring{"DATA"}~\ocwbc{} linguistic data for cgis \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{var\_dir}~=~\ocwlowerid{top\_site\_dir}~$\ocwstring{"VAR"}~\ocwbc{} Parser dynamic regression suites \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{corpus\_dir}~=~\ocwlowerid{top\_site\_dir}~$\ocwstring{"CORPUS"}~\ocwbc{} Corpus tree \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} This file is accessible only from Station clients in \ocwbegindcode{}$\ocwlowerid{var\_dir}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{regression\_file\_name}~=~$\ocwstring{"regression"}~\ocwbc{} regression analysis stuff \ocwec{}\ocweol
\ocwindent{0.00em}
;\medskip

\label{web.ml:3711}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{data}~\ocwlowerid{name}~=~\ocwlowerid{data\_dir}~$\^{}~$\ocwlowerid{name}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{dico\_page}~\ocwlowerid{name}~=~\ocwlowerid{dico\_dir}~$\^{}~$\ocwlowerid{name}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_data}~\ocwlowerid{name}~=~\ocwlowerid{public\_data\_dir}~$\^{}~$\ocwlowerid{name}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_dico\_page}~\ocwlowerid{name}~=~\ocwlowerid{public\_dico\_dir}~$\^{}~$\ocwlowerid{name}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{public\_entries\_file}~=~\ocwlowerid{public\_dico\_page}~$\ocwstring{"entries.rem"}~\ocweol
\ocwindent{0.00em}
\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make}~\ocwlowerid{releasedata}$\ocwenddcode{}, read by \ocwbegindcode{}$\ocwlowerid{indexer}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_dummies\_file}~=~\ocwlowerid{public\_dico\_page}~$\ocwstring{"dummies.rem"}~\ocweol
\ocwindent{0.00em}
\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make}~\ocwlowerid{releasedata}$\ocwenddcode{}, read by \ocwbegindcode{}$\ocwlowerid{indexerd}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sandhis\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"sandhis.rem"}~\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{nouns\_file}~=~\ocwlowerid{data}~$\ocwstring{"nouns.rem"}~\ocweol
\ocwindent{2.00em}
\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_nouns}$\ocwenddcode{}, read by \ocwbegindcode{}$\ocwupperid{Print\_inflected}.\ocwlowerid{read\_nouns}$\ocwenddcode{},
       copied in \ocwbegindcode{}$\ocwlowerid{public\_nouns\_file}$\ocwenddcode{} by make releasecgi for use by cgis \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{nouns2\_file}~=~\ocwlowerid{data}~$\ocwstring{"nouns2.rem"}~\ocwbc{} same in mode non gen \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pronouns\_file}~=~\ocwlowerid{data}~$\ocwstring{"pronouns.rem"}~\ocweol
\ocwindent{2.00em}
\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_nouns}$\ocwenddcode{}, read by \ocwbegindcode{}$\ocwupperid{Print\_inflected}.\ocwlowerid{read\_pronouns}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{roots\_infos\_file}~=~\ocwlowerid{data}~$\ocwstring{"roots\_infos.rem"}~\ocweol
\ocwindent{2.00em}
\ocwbc{} created by \ocwbegindcode{}$\ocwupperid{Print\_dict}.\ocwlowerid{postlude}$\ocwenddcode{}, read by \ocwbegindcode{}$\ocwupperid{Make\_roots}.\ocwlowerid{make\_roots}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{roots\_usage\_file}~=~\ocwlowerid{data}~$\ocwstring{"roots\_usage.rem"}~\ocweol
\ocwindent{2.00em}
\ocwbc{} created by \ocwbegindcode{}$\ocwupperid{Print\_html}.\ocwlowerid{postlude}$\ocwenddcode{}, read by \ocwbegindcode{}$\ocwupperid{Dispatcher}.\ocwlowerid{roots\_usage}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{verblinks\_file}~=~\ocwlowerid{data}~$\ocwstring{"verblinks.rem"}~\ocweol
\ocwindent{2.00em}
\ocwbc{} created by \ocwbegindcode{}$\ocwupperid{Print\_dict}.\ocwlowerid{postlude}$\ocwenddcode{} calling \ocwbegindcode{}$\ocwupperid{Roots}.\ocwlowerid{collect\_preverbs}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwbc{} read by \ocwbegindcode{}$\ocwupperid{Print\_html}$\ocwenddcode{}, \ocwbegindcode{}$\ocwupperid{Make\_preverbs}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwbc{} copied in \ocwbegindcode{}$\ocwlowerid{public\_verblinks\_file}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{lexical\_kridantas\_file}~=~\ocwlowerid{data}~$\ocwstring{"lexical\_kridantas.rem"}~\ocweol
\ocwindent{2.00em}
\ocwbc{} created by \ocwbegindcode{}$\ocwupperid{Print\_dict}.\ocwlowerid{postlude}$\ocwenddcode{}
       read by \ocwbegindcode{}$\ocwupperid{Make\_roots}.\ocwlowerid{roots\_to\_conjugs}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{unique\_kridantas\_file}~=~\ocwlowerid{data}~$\ocwstring{"unique\_kridantas.rem"}~\ocweol
\ocwindent{0.00em}
\ocwbc{} created by \ocwbegindcode{}$\ocwupperid{Make\_roots}.\ocwlowerid{roots\_to\_conjugs}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{roots\_file}~=~\ocwlowerid{data}~$\ocwstring{"roots.rem"}~\ocweol
\ocwindent{2.00em}
\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_roots}$\ocwenddcode{}, read by \ocwbegindcode{}$\ocwlowerid{reader}$\ocwenddcode{}, \ocwbegindcode{}$\ocwlowerid{tagger}$\ocwenddcode{} \& \ocwbegindcode{}$\ocwlowerid{indexer}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{peris\_file}~=~\ocwlowerid{data}~$\ocwstring{"peris.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{lopas\_file}~=~\ocwlowerid{data}~$\ocwstring{"lopas.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{parts\_file}~=~\ocwlowerid{data}~$\ocwstring{"parts.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{partvocs\_file}~=~\ocwlowerid{data}~$\ocwstring{"partvocs.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{lopaks\_file}~=~\ocwlowerid{data}~$\ocwstring{"lopaks.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{preverbs\_file}~=~\ocwlowerid{data}~$\ocwstring{"preverbs.rem"}~\ocweol
\ocwindent{2.00em}
\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_preverbs}$\ocwenddcode{}, read by \ocwbegindcode{}$\ocwlowerid{make\_inflected}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{preverbs\_textfile}~\ocwlowerid{trans}~=~\ocwlowerid{data}~(\ocwlowerid{trans}~$\^{}~\ocwstring{"\_preverbs.txt"}$)$\ocweol
\ocwindent{2.00em}
\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_preverbs}$\ocwenddcode{} for documentation \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{iics\_file}~=~\ocwlowerid{data}~$\ocwstring{"iics.rem"}~\ocweol
\ocwindent{2.00em}
\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_nouns}$\ocwenddcode{}, copied in \ocwbegindcode{}$\ocwlowerid{public\_iics\_file}$\ocwenddcode{} by make install,
       read by \ocwbegindcode{}$\ocwlowerid{make\_automaton}$\ocwenddcode{} invoked from DATA/Makefile \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{iics2\_file}~=~\ocwlowerid{data}~$\ocwstring{"iics2.rem"}~\ocwbc{} same in mode non gen \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{iifcs\_file}~=~\ocwlowerid{data}~$\ocwstring{"iifcs.rem"}~\ocwbc{} iic stems of ifc nouns \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{vocas\_file}~=~\ocwlowerid{data}~$\ocwstring{"voca.rem"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_nouns}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{invs\_file}~=~\ocwlowerid{data}~$\ocwstring{"invs.rem"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_nouns}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{piics\_file}~=~\ocwlowerid{data}~$\ocwstring{"piics.rem"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_roots}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{ifcs\_file}~=~\ocwlowerid{data}~$\ocwstring{"ifcs.rem"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_nouns}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{ifcs2\_file}~=~\ocwlowerid{data}~$\ocwstring{"ifcs2.rem"}~\ocwbc{} same in mode non gen \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{avyayais\_file}~=~\ocwlowerid{data}~$\ocwstring{"avyayais.rem"}~\ocwbc{} iic stems of avyayiibhava cpds \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{avyayafs\_file}~=~\ocwlowerid{data}~$\ocwstring{"avyayafs.rem"}~\ocwbc{} ifc stems of avyayiibhava cpds \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sfxs\_file}~=~\ocwlowerid{data}~$\ocwstring{"sfxs.rem"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_nouns}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{isfxs\_file}~=~\ocwlowerid{data}~$\ocwstring{"isfxs.rem"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_nouns}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{iivs\_file}~=~\ocwlowerid{data}~$\ocwstring{"iivs.rem"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_roots}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{auxis\_file}~=~\ocwlowerid{data}~$\ocwstring{"auxi.rem"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_roots}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{auxiks\_file}~=~\ocwlowerid{data}~$\ocwstring{"auxik.rem"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_roots}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{auxiicks\_file}~=~\ocwlowerid{data}~$\ocwstring{"auxiick.rem"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_roots}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{indecls\_file}~=~\ocwlowerid{data}~$\ocwstring{"indecls.rem"}~\ocwbc{} created by  \ocwbegindcode{}$\ocwlowerid{make\_roots}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{absya\_file}~=~\ocwlowerid{data}~$\ocwstring{"absya.rem"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_roots}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{abstvaa\_file}~=~\ocwlowerid{data}~$\ocwstring{"abstvaa.rem"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_roots}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{inftu\_file}~=~\ocwlowerid{data}~$\ocwstring{"inftu.rem"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_roots}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{kama\_file}~=~\ocwlowerid{data}~$\ocwstring{"kama.rem"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{make\_nouns}$\ocwenddcode{} etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cache\_file}~=~\ocwlowerid{data}~$\ocwstring{"cache.rem"}\medskip

\ocwendcode{}\ocwindent{0.00em}
Then transducers files, made by \ocwbegindcode{}$\ocwlowerid{make\_automaton}$\ocwenddcode{}, invoked by DATA/Makefile 
\ocweol
\ocwindent{0.00em}
NB The \ocwbegindcode{}$\ocwlowerid{transxxx\_file}$\ocwenddcode{} identifiers are just here for documentation,
   but are not used in the ML code, since the corresponding files are
   created by \ocwbegindcode{}$\ocwlowerid{make\_automaton}$\ocwenddcode{} when \ocwbegindcode{}$\ocwlowerid{make}~\ocwlowerid{transducers}$\ocwenddcode{} is called in DATA/Makefile
   and copied as \ocwbegindcode{}$\ocwlowerid{public\_transxxx\_file}$\ocwenddcode{} on the server by \ocwbegindcode{}$\ocwlowerid{make}~\ocwlowerid{releasedata}$\ocwenddcode{}.
   But \ocwbegindcode{}$\ocwlowerid{public\_transxxx\_file}$\ocwenddcode{} is read by \ocwbegindcode{}$\ocwupperid{Load\_transducers}$\ocwenddcode{}. 
   It would be clearer to have a module \ocwbegindcode{}$\ocwupperid{Dump\_transducers}$\ocwenddcode{} using them. 
\ocweol
\label{web.ml:7971}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transn\_file}~=~\ocwlowerid{data}~$\ocwstring{"transn.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{noun\_automaton}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transn2\_file}~=~\ocwlowerid{data}~$\ocwstring{"transn2.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{noun2\_automaton}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transpn\_file}~=~\ocwlowerid{data}~$\ocwstring{"transpn.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{pronoun\_automaton}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transr\_file}~=~\ocwlowerid{data}~$\ocwstring{"transr.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{root\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transperi\_file}~=~\ocwlowerid{data}~$\ocwstring{"transperi.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{peri\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{translopa\_file}~=~\ocwlowerid{data}~$\ocwstring{"translopa.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{eoroot\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transp\_file}~=~\ocwlowerid{data}~$\ocwstring{"transp.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{preverb\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transpa\_file}~=~\ocwlowerid{data}~$\ocwstring{"transpa.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{part\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{translopak\_file}~=~\ocwlowerid{data}~$\ocwstring{"translopak.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{eopart\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transpav\_file}~=~\ocwlowerid{data}~$\ocwstring{"transpav.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{partv\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transic\_file}~=~\ocwlowerid{data}~$\ocwstring{"transic.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{iic\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transic2\_file}~=~\ocwlowerid{data}~$\ocwstring{"transic2.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{iic2\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transpic\_file}~=~\ocwlowerid{data}~$\ocwstring{"transpic.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{piic\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transif\_file}~=~\ocwlowerid{data}~$\ocwstring{"transif.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{iif\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transiiy\_file}~=~\ocwlowerid{data}~$\ocwstring{"transiiy.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{iiy\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transavy\_file}~=~\ocwlowerid{data}~$\ocwstring{"transavy.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{avy\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transif2\_file}~=~\ocwlowerid{data}~$\ocwstring{"transif2.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{iif\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transiif\_file}~=~\ocwlowerid{data}~$\ocwstring{"transiif.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{iiif\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transiv\_file}~=~\ocwlowerid{data}~$\ocwstring{"transiv.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{iiv\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transauxi\_file}~=~\ocwlowerid{data}~$\ocwstring{"transauxi.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{auxi\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transauxik\_file}~=~\ocwlowerid{data}~$\ocwstring{"transauxik.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{auxik\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transauxiick\_file}~=~\ocwlowerid{data}~$\ocwstring{"transauxiick.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{auxiick\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transvoca\_file}~=~\ocwlowerid{data}~$\ocwstring{"transvoca.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{voca\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transinv\_file}~=~\ocwlowerid{data}~$\ocwstring{"transinv.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{inv\_automaton}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transinde\_file}~=~\ocwlowerid{data}~$\ocwstring{"transinde.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{indeclinable\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transabsya\_file}~=~\ocwlowerid{data}~$\ocwstring{"transabsya.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{absolya\_automaton}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transabstvaa\_file}~=~\ocwlowerid{data}~$\ocwstring{"transabstvaa.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{absoltvaa\_automaton}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transinftu\_file}~=~\ocwlowerid{data}~$\ocwstring{"transinftu.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{inftu\_automaton}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transkama\_file}~=~\ocwlowerid{data}~$\ocwstring{"transkama.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{kama\_automaton}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transsfx\_file}~=~\ocwlowerid{data}~$\ocwstring{"transsfx.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{sfx\_automaton}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transisfx\_file}~=~\ocwlowerid{data}~$\ocwstring{"transisfx.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{isfx\_automaton}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transca\_file}~=~\ocwlowerid{data}~$\ocwstring{"transca.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{cache\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{transstems\_file}~=~\ocwlowerid{data}~$\ocwstring{"transstems.rem"}~\ocwbc{} \ocwbegindcode{}$\ocwlowerid{stems\_automaton}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{declstxt\_file}~=~\ocwlowerid{data}~$\ocwstring{"nouns.txt"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{decline}~-\ocwlowerid{ascii}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{declstex\_file}~=~\ocwlowerid{data}~$\ocwstring{"nouns.tex"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{decline}~-\ocwlowerid{tex}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{declsxml\_file}~=~\ocwlowerid{data}~$\ocwstring{"nouns.xml"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{decline}~-\ocwlowerid{xml}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{rootstxt\_file}~=~\ocwlowerid{data}~$\ocwstring{"roots.txt"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{conjug}~-\ocwlowerid{ascii}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{rootstex\_file}~=~\ocwlowerid{data}~$\ocwstring{"roots.tex"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{conjug}~-\ocwlowerid{tex}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{rootsxml\_file}~=~\ocwlowerid{data}~$\ocwstring{"roots.xml"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{conjug}~-\ocwlowerid{xml}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{partstxt\_file}~=~\ocwlowerid{data}~$\ocwstring{"parts.txt"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{declinep}~-\ocwlowerid{ascii}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{partstex\_file}~=~\ocwlowerid{data}~$\ocwstring{"parts.tex"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{declinep}~-\ocwlowerid{tex}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{partsxml\_file}~=~\ocwlowerid{data}~$\ocwstring{"parts.xml"}~\ocwbc{} created by \ocwbegindcode{}$\ocwlowerid{declinep}~-\ocwlowerid{xml}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{mw\_exc\_file}~=~\ocwlowerid{data}~$\ocwstring{"mw\_exceptions.rem"}~\ocwbc{} for MW indexing \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{mw\_index\_file}~=~\ocwlowerid{data}~$\ocwstring{"mw\_index.rem"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{guess\_auto}~=~\ocwlowerid{data}~$\ocwstring{"guess\_index.rem"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Next are the inflected forms banks, read at cgi time by \ocwbegindcode{}$\ocwupperid{Lexer}.\ocwlowerid{load\_morphs}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{public\_nouns\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"nouns.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_nouns2\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"nouns2.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_pronouns\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"pronouns.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_preverbs\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"preverbs.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_roots\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"roots.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_peris\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"peris.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_lopas\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"lopas.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_lopaks\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"lopaks.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_roots\_infos\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"roots\_infos.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_parts\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"parts.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_partvocs\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"partvocs.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_iics\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"iics.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_iics2\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"iics2.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_piics\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"piics.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_ifcs\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"ifcs.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_ifcs2\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"ifcs2.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_sfxs\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"sfxs.rem"}~\ocwbc{} taddhita suffix forms \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_isfxs\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"isfxs.rem"}~\ocwbc{} taddhita suffix stems \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_iivs\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"iivs.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_avyayais\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"avyayais.rem"}~\ocwbc{} iic stems of avyayiibhava cpds \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_avyayafs\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"avyayafs.rem"}~\ocwbc{} ifc stems of avyayiibhava cpds \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_auxis\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"auxi.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_auxiks\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"auxik.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_auxiicks\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"auxiick.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_iifcs\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"iifcs.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_vocas\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"voca.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_invs\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"invs.rem"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_inde\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"indecls.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_absya\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"absya.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_abstvaa\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"abstvaa.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_inftu\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"inftu.rem"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_kama\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"kama.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_stems\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"stems.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_roots\_usage\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"roots\_usage.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_lexical\_kridantas\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"lexical\_kridantas.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_unique\_kridantas\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"unique\_kridantas.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_verblinks\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"verblinks.rem"}\medskip

\label{web.ml:13507}%
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_mw\_exc\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"mw\_exceptions.rem"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_mw\_index\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"mw\_index.rem"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_guess\_auto}~=~\ocwlowerid{public\_data}~$\ocwstring{"guess\_index.rem"}\ocweol
\ocwindent{0.00em}
\ocwbc{} Next segmenting transducers, read at cgi time by \ocwbegindcode{}$\ocwupperid{Lexer}.\ocwlowerid{load\_transducer}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transn\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transn.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transn2\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transn2.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transpn\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transpn.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transr\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transr.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transperi\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transperi.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_translopa\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"translopa.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transp\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transp.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transpa\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transpa.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_translopak\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"translopak.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transpav\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transpav.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transic\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transic.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transic2\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transic2.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transpic\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transpic.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transif\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transif.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transif2\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transif2.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transiiy\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transiiy.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transavy\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transavy.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transiif\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transiif.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transiv\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transiv.rem"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transauxi\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transauxi.rem"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transauxik\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transauxik.rem"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transauxiick\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transauxiick.rem"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transvoca\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transvoca.rem"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transinv\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transinv.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transinde\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transinde.rem"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transabsya\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transabsya.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transabstvaa\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transabstvaa.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transinftu\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transinftu.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transkama\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transkama.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transsfx\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transsfx.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transisfx\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transisfx.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transca\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transca.rem"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_transstems\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"transstems.rem"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_sandhis\_id\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"sandhis\_id.rem"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_cache\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"cache.rem"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{public\_cache\_txt\_file}~=~\ocwlowerid{public\_data}~$\ocwstring{"cache.txt"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_dir\_url}~=~\ocwupperid{Paths.}\ocwlowerid{skt\_dir\_url}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Relative paths of top directory of site and sub directories \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{web\_dico\_url}~=~\ocwlowerid{skt\_dir\_url}~$\^{}~\ocwstring{"DICO/"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{mw\_dico\_url}~=~\ocwlowerid{skt\_dir\_url}~$\^{}~\ocwstring{"MW/"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{web\_images\_url}~=~\ocwlowerid{skt\_dir\_url}~$\^{}~\ocwstring{"IMAGES/"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sanskrit\_page\_url}~\ocwlowerid{l}~=~\ocwlowerid{skt\_dir\_url}~$\^{}~$(\ocwlowerid{site\_entry\_page}~\ocwlowerid{l})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{faq\_page\_url}~\ocwlowerid{l}~=~\ocwlowerid{skt\_dir\_url}~$\^{}~$(\ocwlowerid{faq\_page}~\ocwlowerid{l})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{portal\_page\_url}~\ocwlowerid{l}~=~\ocwlowerid{skt\_dir\_url}~$\^{}~$(\ocwlowerid{portal\_page}~\ocwlowerid{l})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} style sheet built by Css module \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{style\_sheet}~=~$\ocwstring{"style.css"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{css\_file}~=~\ocwlowerid{dico\_page}~\ocwlowerid{style\_sheet}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} javascript to fake dev UTF8 as VH \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{deva\_reader}~=~$\ocwstring{"utf82VH.js"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Absolute URLs for cgis \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{dico\_page\_url}~\ocwlowerid{name}~=~\ocwlowerid{web\_dico\_url}~$\^{}~$\ocwlowerid{name}$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{style\_sheet\_url}~=~\ocwlowerid{dico\_page\_url}~\ocwlowerid{style\_sheet}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{deva\_reader\_url}~=~\ocwlowerid{dico\_page\_url}~\ocwlowerid{deva\_reader}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{indexer\_page\_url}~\ocwlowerid{l}~=~\ocwlowerid{dico\_page\_url}~(\ocwlowerid{dico\_index\_page}~\ocwlowerid{l})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{reader\_page\_url}~\ocwlowerid{l}~=~\ocwlowerid{dico\_page\_url}~(\ocwlowerid{dico\_reader\_page}~\ocwlowerid{l})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{grammar\_page\_url}~\ocwlowerid{l}~=~\ocwlowerid{dico\_page\_url}~(\ocwlowerid{dico\_grammar\_page}~\ocwlowerid{l})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sandhi\_page\_url}~\ocwlowerid{l}~=~\ocwlowerid{dico\_page\_url}~(\ocwlowerid{dico\_sandhi\_page}~\ocwlowerid{l})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{corpus\_page\_url}~\ocwlowerid{l}~=~\ocwlowerid{dico\_page\_url}~(\ocwlowerid{dico\_corpus\_page}~\ocwlowerid{l})$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{image}~\ocwlowerid{name}~=~\ocwlowerid{web\_images\_url}~$\^{}~$\ocwlowerid{name}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ocaml\_logo}~=~\ocwlowerid{image}~$\ocwstring{"icon\_ocaml.png"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{inria\_logo}~=~\ocwlowerid{image}~$\ocwstring{"logo\_inria.png"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{favicon}~=~\ocwlowerid{image}~$\ocwstring{"favicon.ico"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{reader\_meta\_title}~=~\ocwlowerid{title}~$\ocwstring{"Sanskrit\ocwvspace{}Reader\ocwvspace{}Companion"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{parser\_meta\_title}~=~\ocwlowerid{title}~$\ocwstring{"Sanskrit\ocwvspace{}Reader\ocwvspace{}Assistant"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{dico\_title\_fr}~=~\ocwlowerid{h1\_title}~$\ocwstring{"Dictionnaire\ocwvspace{}H\&eacute;ritage\ocwvspace{}du\ocwvspace{}Sanscrit"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{dummy\_title\_fr}~=~\ocwlowerid{h1\_title}~$\ocwstring{"Le\ocwvspace{}sanscrit\ocwvspace{}pour\ocwvspace{}les\ocwvspace{}nuls"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{dico\_title\_en}~=~\ocwlowerid{h1\_title}~($\ocwkw{if}~$\ocwlowerid{narrow\_screen}~$\ocwkw{then}~\ocwstring{"Sanskrit\ocwvspace{}Lexicon"}~\ocweol
\ocwindent{15.00em}
\ocwkw{else}~\ocwstring{"Monier\symbol{45}Williams\ocwvspace{}Dictionary"}$)$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{dummy\_title\_en}~=~\ocwlowerid{h1\_title}~$\ocwstring{"Sanskrit\ocwvspace{}made\ocwvspace{}easy"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{stem\_title\_en}~=~\ocwlowerid{h1\_title}~($\ocwkw{if}~$\ocwlowerid{narrow\_screen}~$\ocwkw{then}~\ocwstring{"Sanskrit\ocwvspace{}Stemmer"}\ocweol
\ocwindent{15.00em}
\ocwkw{else}~\ocwstring{"Search\ocwvspace{}for\ocwvspace{}atomic\ocwvspace{}inflected\ocwvspace{}forms"}$)$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{reader\_title}~=~\ocwlowerid{h1\_title}~($\ocwkw{if}~$\ocwlowerid{narrow\_screen}~$\ocwkw{then}~\ocwstring{"Sanskrit\ocwvspace{}Reader"}\ocweol
\ocwindent{14.50em}
\ocwkw{else}~\ocwstring{"The\ocwvspace{}Sanskrit\ocwvspace{}Reader\ocwvspace{}Companion"}$)$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{parser\_title}~=~\ocwlowerid{h1\_title}~($\ocwkw{if}~$\ocwlowerid{narrow\_screen}~$\ocwkw{then}~\ocwstring{"Sanskrit\ocwvspace{}Parser"}\ocweol
\ocwindent{14.50em}
\ocwkw{else}~\ocwstring{"The\ocwvspace{}Sanskrit\ocwvspace{}Parser\ocwvspace{}Assistant"}$)$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{graph\_meta\_title}~=~\ocwlowerid{title}~$\ocwstring{"Sanskrit\ocwvspace{}Segmenter\ocwvspace{}Summary"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{user\_aid\_meta\_title}~=~\ocwlowerid{title}~$\ocwstring{"User\ocwvspace{}Feedback"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{interface\_title}~=~\ocwlowerid{h1\_title}~($\ocwkw{if}~$\ocwlowerid{narrow\_screen}~$\ocwkw{then}~\ocwstring{"Summarizer"}\ocweol
\ocwindent{16.00em}
\ocwkw{else}~\ocwstring{"Sanskrit\ocwvspace{}Segmenter\ocwvspace{}Summary"}$)$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{user\_aid\_title}~=~\ocwlowerid{h1\_title}~($\ocwkw{if}~$\ocwlowerid{narrow\_screen}~$\ocwkw{then}~\ocwstring{"User\ocwvspace{}Feedback"}\ocweol
\ocwindent{14.00em}
\ocwkw{else}~\ocwstring{"Feedback\ocwvspace{}for\ocwvspace{}Unknown\ocwvspace{}Chunks"}$)$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{dico\_title}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{French}~\rightarrow{}~\ocwlowerid{dico\_title\_fr}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{English}~\rightarrow{}~\ocwlowerid{dico\_title\_en}~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} We set and reset \ocwbegindcode{}$\ocwlowerid{output\_channel}$\ocwenddcode{} to designate either a static html file
   under creation or \ocwbegindcode{}$\ocwlowerid{stdout}$\ocwenddcode{} to produce a cgi output dynamic page.
   This is awful and should be fixed one day.
\ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{output\_channel}~=~$\ocwbt{ref}~$\ocwlowerid{stdout}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ps}~\ocwlowerid{s}~=~\ocwlowerid{output\_string}~\ocwlowerid{output\_channel.}\ocwlowerid{val}~\ocwlowerid{s}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pc}~\ocwlowerid{c}~=~\ocwlowerid{output\_char}~\ocwlowerid{output\_channel.}\ocwlowerid{val}~\ocwlowerid{c}~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pi}~\ocwlowerid{i}~=~\ocwlowerid{output\_string}~\ocwlowerid{output\_channel.}\ocwlowerid{val}~(\ocwlowerid{string\_of\_int}~\ocwlowerid{i})~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{line}~()~=~\ocwlowerid{pc}~\verb!'\n'!~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sp}~()~=~\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}"}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{pl}~\ocwlowerid{s}~=~\ocwlowerid{ps}~(\ocwlowerid{s}~$\^{}~\ocwstring{"\symbol{92}n"}$)$\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{meta\_program}~\ocwlowerid{l}~=~\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{pl}~(\ocwupperid{List.}\ocwlowerid{map}~\ocwlowerid{meta\_prefix}~\ocwlowerid{l})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{javascript}~$\ocwbt{ref}~=\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"script"}~$[~($\ocwstring{"type"},\ocwstring{"text/javascript"}$);~($\ocwstring{"src"},\ocwbt{ref}$)~]$\ocweol
\ocwindent{0.50em}
\ocwbc{} Caution - necessary to separate begin and end \ocwec{}~\ocweol
\ocwindent{0.50em}
\^{}~$\ocwlowerid{xml\_end}~$\ocwstring{"script"}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} dyn=True for dynamic pages created by cgis, False for static pages in DICO \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{deva\_read\_script}~\ocwlowerid{dyn}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~\ocwbt{ref}~=~\ocwkw{if}~$\ocwlowerid{dyn}~$\ocwkw{then}~$\ocwlowerid{deva\_reader\_url}$\ocweol
\ocwindent{9.50em}
\ocwkw{else}~$\ocwlowerid{deva\_reader}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{javascript}~$\ocwbt{ref}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{js\_util\_script}~\ocwlowerid{dyn}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{js\_util\_file}~=~$\ocwstring{"util.js"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{prefix}~=~$\ocwkw{if}~$\ocwlowerid{dyn}~$\ocwkw{then}~$\ocwlowerid{dico\_page\_url}~$\ocwkw{else}~$($\ocwkw{fun}~$\ocwlowerid{x}~\rightarrow{}~\ocwlowerid{x})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{javascript}~(\ocwlowerid{prefix}~\ocwlowerid{js\_util\_file})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{css\_link}~\ocwlowerid{dyn}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~\ocwbt{ref}~=~\ocwkw{if}~$\ocwlowerid{dyn}~$\ocwkw{then}~$\ocwlowerid{style\_sheet\_url}~$\ocwbc{} dynamic page, absolute URL \ocwec{}\ocweol
\ocwindent{6.00em}
\ocwkw{else}~$\ocwlowerid{style\_sheet}~$\ocwbc{} static page in DICO, relative URL \ocwec{}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_empty\_with\_att}~$\ocwstring{"link"}~$[~($\ocwstring{"rel"},\ocwstring{"stylesheet"}$);~($\ocwstring{"type"},\ocwstring{"text/css"}$);~$\ocweol
\ocwindent{15.00em}
$($\ocwstring{"href"},\ocwbt{ref}$);~($\ocwstring{"media"},\ocwstring{"screen,tv"}$)~]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{caml\_inside}~\ocwlowerid{dyn}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{logo}~=~$\ocwkw{if}~$\ocwlowerid{dyn}~$\ocwkw{then}~$\ocwlowerid{ocaml\_logo}~$\ocwkw{else}~$\ocwlowerid{rel\_ocaml\_logo}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{ocaml\_logo}~=~\ocwlowerid{xml\_empty\_with\_att}~$\ocwstring{"img"}~\ocweol
\ocwindent{3.00em}
$[~($\ocwstring{"src"},$\ocwlowerid{logo});~($\ocwstring{"alt"},\ocwstring{"Le\ocwvspace{}chameau\ocwvspace{}Ocaml"}$);~($\ocwstring{"height"},\ocwstring{"50"}$)~]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{anchor\_ref}~\ocwlowerid{ocaml\_site}~\ocwlowerid{ocaml\_logo}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{inria\_inside}~\ocwlowerid{dyn}~=~$\ocwbc{} Inria new logo - clickable \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{logo}~=~$\ocwkw{if}~$\ocwlowerid{dyn}~$\ocwkw{then}~$\ocwlowerid{inria\_logo}~$\ocwkw{else}~$\ocwlowerid{rel\_inria\_logo}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{inria\_logo}~=~\ocwlowerid{xml\_empty\_with\_att}~$\ocwstring{"img"}~\ocweol
\ocwindent{3.00em}
$[~($\ocwstring{"src"},$\ocwlowerid{logo});~($\ocwstring{"alt"},\ocwstring{"Logo\ocwvspace{}Inria"}$);~($\ocwstring{"height"},\ocwstring{"50"}$)~]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{anchor\_ref}~\ocwlowerid{inria\_site}~\ocwlowerid{inria\_logo}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{favicon}~\ocwlowerid{dyn}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{path}~=~$\ocwkw{if}~$\ocwlowerid{dyn}~$\ocwkw{then}~$\ocwlowerid{favicon}~$\ocwkw{else}~$\ocwlowerid{rel\_favicon}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwstring{"\ensuremath{<}link\ocwvspace{}rel=\symbol{92}"shortcut\ocwvspace{}icon\symbol{92}"\ocwvspace{}href=\symbol{92}""}~\^{}~$\ocwlowerid{path}~$\^{}~\ocwstring{"\symbol{92}"\ensuremath{>}"}~\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{page\_begin\_dyn}~\ocwlowerid{dyn}~\ocwlowerid{title}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{doctype}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"html"}~$[\,]~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{xml\_begin}~$\ocwstring{"head"}~|\ensuremath{>}~$\ocwlowerid{pl}~$\ocwbc{} ( \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{meta\_program}~\ocwlowerid{contents\_instructions}~$\ocwbc{} . \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{title}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocwbc{} . \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{meta\_program}~\ocwlowerid{title\_instructions}~$\ocwbc{} . \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{css\_link}~\ocwlowerid{dyn}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocwbc{} . \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{favicon}~\ocwlowerid{dyn}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocwbc{} . \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{deva\_read\_script}~\ocwlowerid{dyn}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocwbc{} devanagari input \ocwec{}\ocwbc{} . \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{js\_util\_script}~\ocwlowerid{dyn}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocwbc{} . \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{xml\_end}~$\ocwstring{"head"}~|\ensuremath{>}~$\ocwlowerid{pl}~$\ocwbc{} ) \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{open\_html\_file}~\ocwlowerid{f}~\ocwlowerid{title}~=~$\ocwkw{do}~\ocwbc{} for building the Web services pages \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{output\_channel.}\ocwlowerid{val}~:=~\ocwlowerid{open\_out}~\ocwlowerid{f};~\ocwlowerid{page\_begin\_dyn}~\ocwupperid{False}~\ocwlowerid{title}~\}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{page\_begin}~=~\ocwlowerid{page\_begin\_dyn}~\ocwupperid{True}~$\ocwbc{} for cgi output page \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{version}~\ocwlowerid{lang}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{lang\_str}~=~$\ocweol
\ocwindent{2.50em}
\ocwkw{match}~$\ocwlowerid{lang}~$\ocwkw{with}~\ocweol
\ocwindent{2.50em}
$[~\ocwupperid{Some}~\ocwupperid{Html.French}~\rightarrow{}~$\ocwstring{"\ocwvspace{}(French)"}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{Some}~\ocwupperid{Html.English}~\rightarrow{}~$\ocwstring{"\ocwvspace{}(English)"}\ocweol
\ocwindent{2.50em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{2.50em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{h3\_begin}~\ocwupperid{B3}~$\^{}~$\ocwupperid{Date.}\ocwlowerid{version}~$\^{}~$\ocwlowerid{lang\_str}~$\^{}~$\ocwlowerid{h3\_end}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_title}~\ocwlowerid{lang}~\ocwlowerid{title}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{table\_begin}~\ocwupperid{Centered}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_begin}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{th\_begin}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{title}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{version}~\ocwlowerid{lang}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{th\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_title\_solid}~\ocwlowerid{color}~\ocwlowerid{lang}~\ocwlowerid{title}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{table\_begin}~(\ocwlowerid{centered}~\ocwlowerid{color})~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_begin}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{th\_begin}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{title}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{version}~\ocwlowerid{lang}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{th\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_transliteration\_help}~\ocwlowerid{lang}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{narrow\_screen}~$\ocwkw{then}~$()~$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~\ocwstring{"Transliteration\ocwvspace{}help\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{rel\_faq\_page\_url}~\ocwlowerid{lang}~$\^{}~\ocwstring{"\#transliteration"}$)~$\ocwstring{"here"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{transliteration\_switch\_default}~\ocwlowerid{dft}~\ocwlowerid{id}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{option\_select\_default\_id}~\ocwlowerid{id}~$\ocwstring{"t"}~\ocweol
\ocwindent{3.50em}
$[~($\ocwstring{"\ocwvspace{}Velthuis\ocwvspace{}"},\ocwstring{"VH"},$\ocwlowerid{dft}=$\ocwstring{"VH"}$)~$\ocwbc{} Default Velthuis \ocwec{}\ocweol
\ocwindent{3.50em}
;~$($\ocwstring{"\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}WX\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}"},\ocwstring{"WX"},$\ocwlowerid{dft}=$\ocwstring{"WX"}$)~$\ocwbc{} Infamous WaX from U. Hyderabad \ocwec{}~\ocweol
\ocwindent{3.50em}
;~$($\ocwstring{"\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}KH\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}"},\ocwstring{"KH"},$\ocwlowerid{dft}=$\ocwstring{"KH"}$)~$\ocwbc{} Kyoto-Harvard \ocwec{}\ocweol
\ocwindent{3.50em}
;~$($\ocwstring{"\ocwvspace{}\ocwvspace{}\ocwvspace{}SLP1\ocwvspace{}\ocwvspace{}\ocwvspace{}"},\ocwstring{"SL"},$\ocwlowerid{dft}=$\ocwstring{"SL"}$)~$\ocwbc{} Sanskrit Library Sloppy 1 \ocwec{}\ocweol
\ocwindent{3.50em}
;~$($\ocwstring{"Devanagari"},\ocwstring{"DN"},$\ocwlowerid{dft}=$\ocwstring{"DN"}$)~$\ocwbc{} Devanagari UTF-8 \ocwec{}\ocweol
\ocwindent{3.50em}
;~$($\ocwstring{"\ocwvspace{}\ocwvspace{}\ocwvspace{}IAST\ocwvspace{}\ocwvspace{}\ocwvspace{}"},\ocwstring{"RN"},$\ocwlowerid{dft}=$\ocwstring{"RN"}$)~$\ocwbc{} Indological romanisation in UTF-8 \ocwec{}\ocweol
\ocwindent{3.50em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_transliteration\_switch}~\ocwlowerid{id}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{transliteration\_switch\_default}~\ocwupperid{Paths.}\ocwlowerid{default\_transliteration}~\ocwlowerid{id}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_lexicon\_select}~\ocwlowerid{lexicon}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~\ocwstring{"Lexicon\ocwvspace{}Access\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{option\_select\_default}~$\ocwstring{"lex"}~\ocweol
\ocwindent{4.50em}
$[~($\ocwstring{"\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}Heritage\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}"},\ocwstring{"SH"},\ocwstring{"SH"}=$\ocwlowerid{lexicon})~$\ocwbc{} Sanskrit Heritage \ocwec{}\ocweol
\ocwindent{4.50em}
;~$($\ocwstring{"\ocwvspace{}Monier\symbol{45}Williams\ocwvspace{}"},\ocwstring{"MW"},\ocwstring{"MW"}=$\ocwlowerid{lexicon})~$\ocwbc{} Monier-Williams \ocwec{}\ocweol
\ocwindent{4.50em}
$]~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_index\_help}~\ocwlowerid{lang}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{narrow\_screen}~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{par\_begin}~\ocwupperid{G2}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_break}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~\ocwstring{"Search\ocwvspace{}for\ocwvspace{}an\ocwvspace{}entry\ocwvspace{}matching\ocwvspace{}an\ocwvspace{}initial\ocwvspace{}pattern:"}~|\ensuremath{>}~$\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_break}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_transliteration\_help}~\ocwlowerid{lang}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{par\_end}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocwbc{} G2 \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_dummy\_help\_en}~()~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{narrow\_screen}~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{par\_begin}~\ocwupperid{G2}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~\ocwstring{"The\ocwvspace{}simplified\ocwvspace{}interface\ocwvspace{}below\ocwvspace{}allows\ocwvspace{}search\ocwvspace{}without\ocwvspace{}diacritics"}~|\ensuremath{>}~$\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_break}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocweol
\ocwindent{1.00em}
;~\ocwstring{"Proper\ocwvspace{}names\ocwvspace{}may\ocwvspace{}be\ocwvspace{}entered\ocwvspace{}with\ocwvspace{}an\ocwvspace{}initial\ocwvspace{}capital"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{par\_end}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocwbc{} G2 \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_stemmer\_help\_en}~()~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{narrow\_screen}~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{par\_begin}~\ocwupperid{G2}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~\ocwstring{"Submit\ocwvspace{}candidate\ocwvspace{}form\ocwvspace{}and\ocwvspace{}category"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_break}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocweol
\ocwindent{1.00em}
;~\ocwstring{"Forms\ocwvspace{}ended\ocwvspace{}in\ocwvspace{}r\ocwvspace{}should\ocwvspace{}not\ocwvspace{}be\ocwvspace{}entered\ocwvspace{}with\ocwvspace{}final\ocwvspace{}visarga"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_break}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocweol
\ocwindent{1.00em}
;~\ocwstring{"Compound\ocwvspace{}words\ocwvspace{}may\ocwvspace{}be\ocwvspace{}recognized\ocwvspace{}with\ocwvspace{}the\ocwvspace{}Reader\ocwvspace{}interface"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_break}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{par\_end}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocwbc{} G2 \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{open\_page\_with\_margin}~\ocwlowerid{width}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{margin}~=~\ocwlowerid{string\_of\_int}~\ocwlowerid{width}~$\^{}~\ocwstring{"pt"}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{attr}~=~[~\ocwlowerid{noborder};~\ocwlowerid{nopadding};~($\ocwstring{"cellspacing"},$\ocwlowerid{margin});~\ocwlowerid{fullwidth}~]~$\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{table\_begin\_style}~(\ocwlowerid{background}~\ocwupperid{Chamois})~\ocwlowerid{attr}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_begin}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocwbc{} closed by \ocwbegindcode{}$\ocwlowerid{close\_page\_with\_margin}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{td\_begin}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{close\_page\_with\_margin}~()~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{html\_break}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{td\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{indexer\_page}~\ocwlowerid{l}~=~\ocwlowerid{dico\_page}~(\ocwlowerid{dico\_index\_page}~\ocwlowerid{l})~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{mk\_index\_page}$\ocwenddcode{}   \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{grammar\_page}~\ocwlowerid{l}~=~\ocwlowerid{dico\_page}~(\ocwlowerid{dico\_grammar\_page}~\ocwlowerid{l})~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{mk\_grammar\_page}$\ocwenddcode{} \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{reader\_page}~\ocwlowerid{l}~=~\ocwlowerid{dico\_page}~(\ocwlowerid{dico\_reader\_page}~\ocwlowerid{l})~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{mk\_reader\_page}$\ocwenddcode{}  \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{sandhi\_page}~\ocwlowerid{l}~=~\ocwlowerid{dico\_page}~(\ocwlowerid{dico\_sandhi\_page}~\ocwlowerid{l})~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{mk\_sandhi\_page}$\ocwenddcode{}  \ocwec{}~\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{corpus\_page}~\ocwlowerid{l}~=~\ocwlowerid{dico\_page}~(\ocwlowerid{dico\_corpus\_page}~\ocwlowerid{l})~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{mk\_corpus\_page}$\ocwenddcode{}  \ocwec{}\ocweol
\ocwindent{0.00em}
;\medskip

\label{web.ml:24706}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_site\_map}~\ocwlowerid{dyn}~\ocwlowerid{lang}~=~$\ocwbc{} the various Web services of the site \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{dyn}~$\ocwkw{then}~\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{sanskrit\_page\_url}~\ocwlowerid{lang})~(\ocwlowerid{emph}~$\ocwstring{"Top"}$)~|\ensuremath{>}~\ocwlowerid{ps};~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{indexer\_page\_url}~\ocwlowerid{lang})~(\ocwlowerid{emph}~$\ocwstring{"Index"}$)~|\ensuremath{>}~\ocwlowerid{ps};~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{indexer\_page\_url}~\ocwlowerid{lang}~$\^{}~\ocwstring{"\#stemmer"}$)~(\ocwlowerid{emph}~$\ocwstring{"Stemmer"}$)~|\ensuremath{>}~\ocwlowerid{ps};~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{grammar\_page\_url}~\ocwlowerid{lang})~(\ocwlowerid{emph}~$\ocwstring{"Grammar"}$)~|\ensuremath{>}~\ocwlowerid{ps};~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{sandhi\_page\_url}~\ocwlowerid{lang})~(\ocwlowerid{emph}~$\ocwstring{"Sandhi"}$)~|\ensuremath{>}~\ocwlowerid{ps};~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{reader\_page\_url}~\ocwlowerid{lang})~(\ocwlowerid{emph}~$\ocwstring{"Reader"}$)~|\ensuremath{>}~\ocwlowerid{ps};~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{corpus\_page\_url}~\ocwlowerid{lang})~(\ocwlowerid{emph}~$\ocwstring{"Corpus"}$)~|\ensuremath{>}~\ocwlowerid{ps};~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{faq\_page\_url}~\ocwlowerid{lang})~(\ocwlowerid{emph}~$\ocwstring{"Help"}$)~|\ensuremath{>}~\ocwlowerid{ps};~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{portal\_page\_url}~\ocwlowerid{lang})~(\ocwlowerid{emph}~$\ocwstring{"Portal"}$)~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.50em}
\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{rel\_sanskrit\_page\_url}~\ocwlowerid{lang})~(\ocwlowerid{emph}~$\ocwstring{"Top"}$)~|\ensuremath{>}~\ocwlowerid{ps};~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{dico\_index\_page}~\ocwlowerid{lang})~(\ocwlowerid{emph}~$\ocwstring{"Index"}$)~|\ensuremath{>}~\ocwlowerid{ps};~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{dico\_index\_page}~\ocwlowerid{lang}~$\^{}~\ocwstring{"\#stemmer"}$)~(\ocwlowerid{emph}~$\ocwstring{"Stemmer"}$)~|\ensuremath{>}~\ocwlowerid{ps};~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{dico\_grammar\_page}~\ocwlowerid{lang})~(\ocwlowerid{emph}~$\ocwstring{"Grammar"}$)~|\ensuremath{>}~\ocwlowerid{ps};~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{dico\_sandhi\_page}~\ocwlowerid{lang})~(\ocwlowerid{emph}~$\ocwstring{"Sandhi"}$)~|\ensuremath{>}~\ocwlowerid{ps};~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{dico\_reader\_page}~\ocwlowerid{lang})~(\ocwlowerid{emph}~$\ocwstring{"Reader"}$)~|\ensuremath{>}~\ocwlowerid{ps};~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{dico\_corpus\_page}~\ocwlowerid{lang})~(\ocwlowerid{emph}~$\ocwstring{"Corpus"}$)~|\ensuremath{>}~\ocwlowerid{ps};~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{rel\_faq\_page\_url}~\ocwlowerid{lang})~(\ocwlowerid{emph}~$\ocwstring{"Help"}$)~|\ensuremath{>}~\ocwlowerid{ps};~$\ocwstring{"\ocwvspace{}|\ocwvspace{}"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{rel\_portal\_page\_url}~\ocwlowerid{lang})~(\ocwlowerid{emph}~$\ocwstring{"Portal"}$)~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pad}~()~=~$\ocwkw{do}~\ocwbc{} ad-hoc vertical padding to make room for the bandeau \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{table\_begin}~\ocwupperid{Pad60}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_begin}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{td\_begin}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{td\_end}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_end}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_bandeau\_enpied\_dyn}~\ocwlowerid{dyn}~\ocwlowerid{lang}~\ocwlowerid{color}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pad}~()~$\ocwbc{} necessary padding to avoid hiding by bandeau \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{elt\_begin}~$\ocwstring{"div"}~$\ocwupperid{Enpied}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_begin}~\ocwupperid{Bandeau}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_begin}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocwbc{} main row begin \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{td\_begin}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{caml\_inside}~\ocwlowerid{dyn}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{td\_end}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{td\_begin}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_begin}~\ocwupperid{Tcenter}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_begin}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{td\_begin}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_site\_map}~\ocwlowerid{dyn}~\ocwlowerid{lang}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{td\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_begin}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{td\_begin}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{copyright}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{td\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_end}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocwbc{} copyright row end \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{td\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{td\_begin}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{inria\_inside}~\ocwlowerid{dyn}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_break}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{td\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_end}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_end}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocwbc{} Bandeau \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{xml\_end}~$\ocwstring{"div"}~|\ensuremath{>}~$\ocwlowerid{pl}~$\ocwbc{} end Enpied \ocwec{}\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Simputer - legacy code - could be reused for smartphones \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_bandeau\_entete}~\ocwlowerid{color}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{margin\_bottom}~\ocwlowerid{height}~=~$\ocwstring{"margin\symbol{45}bottom:"}~\^{}~$\ocwlowerid{points}~\ocwlowerid{height}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{interval}~\ocwlowerid{height}~=~$\ocwkw{do}~\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{tr\_begin}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{td}~[~($\ocwstring{"width"},\ocwstring{"100\%"}$);~($\ocwstring{"style"},$\ocwlowerid{margin\_bottom}~\ocwlowerid{height})~]~|\ensuremath{>}~\ocwlowerid{pl}~$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{tr\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{2.00em}
\}~\ocwkw{in}~\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{table\_begin\_style}~(\ocwlowerid{background}~\ocwlowerid{color})~$\ocweol
\ocwindent{6.00em}
$[~\ocwlowerid{noborder};~\ocwlowerid{nopadding};~($\ocwstring{"cellspacing"},\ocwstring{"5pt"}$);~\ocwlowerid{fullwidth}~]~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{interval}~10$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_begin}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"td"}~$[~\ocwlowerid{fullwidth};~($\ocwstring{"align"},\ocwstring{"center"}$)~]~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_site\_map}~\ocwupperid{True}~\ocwupperid{Html.English}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{td\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{interval}~10$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{page\_end\_dyn}~\ocwlowerid{dyn}~\ocwlowerid{lang}~\ocwlowerid{bandeau}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~\ocwkw{match}~$\ocwupperid{Html.}\ocwlowerid{target}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Html.Simputer}~\rightarrow{}~()$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Html.Computer}~\mid{}~\ocwupperid{Html.Station}~\mid{}~\ocwupperid{Html.Server}$\ocweol
\ocwindent{3.00em}
$\rightarrow{}~$\ocwkw{if}~$\ocwlowerid{bandeau}~$\ocwkw{then}~$\ocwlowerid{print\_bandeau\_enpied\_dyn}~\ocwlowerid{dyn}~\ocwlowerid{lang}~\ocwupperid{Cyan}~$\ocwkw{else}~$()$\ocweol
\ocwindent{2.00em}
$]~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{body\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{xml\_end}~$\ocwstring{"html"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{page\_end}~=~\ocwlowerid{page\_end\_dyn}~\ocwupperid{True}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{close\_html\_file}~\ocwlowerid{lang}~\ocwlowerid{b}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{page\_end\_dyn}~\ocwupperid{False}~\ocwlowerid{lang}~\ocwlowerid{b};~\ocwlowerid{close\_out}~\ocwlowerid{output\_channel.}\ocwlowerid{val}~\}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{close\_html\_dico}~()~=~\ocwlowerid{close\_html\_file}~\ocwupperid{Html.French}~\ocwupperid{True}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{http\_header}~=~$\ocwstring{"Content\symbol{45}Type:\ocwvspace{}text/html\symbol{92}n"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Print the HTTP header only when it is required, i.e. only if it is
   a CGI output.  \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{maybe\_http\_header}~()~=$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{output\_channel.}\ocwlowerid{val}~=~\ocwlowerid{stdout}~$\ocwkw{then}~$\ocwlowerid{http\_header}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocwkw{else}~$()$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{javascript\_tooltip}~=$\ocwstring{"wz\_tooltip.js"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} This could be any absolute server where Platform is installed \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Maybe should be put back in config? but versioning problem... \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{remote\_server\_host}~=~$\ocwstring{"http://sanskrit.inria.fr/"}~\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} This toogle controls accessibility of University of Hyderabad tools.
   It is controled by \ocwbegindcode{}$\ocwupperid{ML}/\ocwupperid{SCLpaths}.\ocwlowerid{ml}$\ocwenddcode{}, which is not part of the git repository,
   and is initialised by default to \ocwbegindcode{}$\ocwupperid{SETUP}/\ocwlowerid{dummy\_SCLpaths}.\ocwlowerid{ml}$\ocwenddcode{} at make time. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{scl\_toggle}~=$\ocweol
\ocwindent{1.00em}
$\lnot{}~(\ocwupperid{SCLpaths.}\ocwlowerid{scl\_url}=$\ocwstring{""}$)~$\ocwbc{} True if SCL tools are installed \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{corpus\_read\_only}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{target}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Station}~\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Computer}~\mid{}~\ocwupperid{Server}~\mid{}~\ocwupperid{Simputer}~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{interaction\_modes\_default}~\ocwlowerid{mode}~=~$\ocweol
\ocwindent{1.00em}
$[~($\ocwstring{"\ocwvspace{}Summary\ocwvspace{}"},\ocwstring{"g"},$\ocwlowerid{mode}=$\ocwstring{"g"}$)~$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"\ocwvspace{}Tagging\ocwvspace{}"},\ocwstring{"t"},$\ocwlowerid{mode}=$\ocwstring{"t"}$)~$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"\ocwvspace{}Parsing\ocwvspace{}"},\ocwstring{"p"},$\ocwlowerid{mode}=$\ocwstring{"p"}$)~$\ocweol
\ocwindent{1.00em}
$]~@~$\ocwkw{if}~$\ocwlowerid{scl\_toggle}~$\ocwkw{then}~\ocwbc{} Needs the SCL tools \ocwec{}\ocweol
\ocwindent{1.00em}
$[~($\ocwstring{"\ocwvspace{}Analysis\ocwvspace{}"},\ocwstring{"o"},$\ocwlowerid{mode}=$\ocwstring{"o"}$)~]~$\ocwkw{else}~$[\,]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{interaction\_modes}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{interaction\_modes\_default}~$\ocwstring{"g"}~\ocwbc{} default summary mode \ocwec{}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
NB Interface and Parser have their own prelude. 
\ocweol
\ocwindent{0.00em}
\ocwbegindcode{}$\ocwlowerid{reader\_prelude}$\ocwenddcode{} is invoked by Parser through Rank and by \ocwbegindcode{}$\ocwupperid{Mk\_reader\_page}$\ocwenddcode{} 
\ocweol
\label{web.ml:29603}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{reader\_prelude}~\ocwlowerid{title}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{http\_header}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_begin}~\ocwlowerid{reader\_meta\_title}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{body\_begin}~\ocwupperid{Chamois\_back}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwlowerid{scl\_toggle}~$\ocwkw{then}~\ocwbc{} external call SCL (experimental) \ocwec{}\ocweol
\ocwindent{3.50em}
$\ocwlowerid{javascript}~(\ocwupperid{SCLpaths.}\ocwlowerid{scl\_url}~$\^{}~$\ocwlowerid{javascript\_tooltip})~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{title}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{open\_page\_with\_margin}~15$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} cgi invocation \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{cgi\_begin}~\ocwlowerid{cgi}~\ocwlowerid{convert}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"form"}~\ocweol
\ocwindent{2.00em}
$[~($\ocwstring{"action"},$\ocwlowerid{cgi});~($\ocwstring{"method"},\ocwstring{"get"}$)$\ocweol
\ocwindent{2.00em}
;~$($\ocwstring{"onsubmit"},\ocwstring{"return\ocwvspace{}"}~\^{}~$\ocwlowerid{convert}~$\^{}~\ocwstring{"()"}$)~]~$\ocwbc{} input conversion script \ocwec{}\ocweol
\ocwindent{1.00em}
\^{}~$\ocwlowerid{elt\_begin}~$\ocwstring{"span"}~$\ocwupperid{Latin12}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_reader\_begin}~\ocwlowerid{cgi}~\ocwlowerid{convert}~=~$\ocwbc{} do not use for pages with multiple cgi \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{xml\_begin\_with\_att}~$\ocwstring{"form"}~\ocweol
\ocwindent{2.00em}
$[~($\ocwstring{"id"},\ocwstring{"this\_form"}$);~($\ocwstring{"action"},$\ocwlowerid{cgi});~($\ocwstring{"method"},\ocwstring{"get"}$)$\ocweol
\ocwindent{2.00em}
;~$($\ocwstring{"onsubmit"},\ocwstring{"return\ocwvspace{}"}~\^{}~$\ocwlowerid{convert}~$\^{}~\ocwstring{"()"}$)~]~$\ocwbc{} input conversion script \ocwec{}\ocweol
\ocwindent{1.00em}
\^{}~$\ocwlowerid{elt\_begin}~$\ocwstring{"span"}~$\ocwupperid{Latin12}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{cgi\_end}~=~\ocwlowerid{xml\_end}~$\ocwstring{"span"}~\^{}~$\ocwlowerid{xml\_end}~$\ocwstring{"form"}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Failsafe aborting of cgi invocation 
\ocweol
\label{web.ml:30508}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwlowerid{s1}~\ocwlowerid{s2}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{table\_begin\_style}~(\ocwlowerid{centered}~\ocwupperid{Yellow})~[~\ocwlowerid{noborder};~($\ocwstring{"cellspacing"},\ocwstring{"20pt"}$)~]~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_begin}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{th\_begin}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_red}~\ocwlowerid{s1}~|\ensuremath{>}~\ocwlowerid{ps}~$\ocwbc{} Report anomaly \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_blue}~\ocwlowerid{s2}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocwbc{} Optional specific message \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{th\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{tr\_end}~|\ensuremath{>}~\ocwlowerid{ps}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{table\_end}~|\ensuremath{>}~\ocwlowerid{pl}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{close\_page\_with\_margin}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_end}~\ocwlowerid{lang}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Build an HTML page to report error.  \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{error\_page}~\ocwlowerid{title\_str}~\ocwlowerid{msg}~\ocwlowerid{submsg}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{maybe\_http\_header}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_begin}~(\ocwlowerid{title}~\ocwlowerid{title\_str})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{body\_begin}~\ocwupperid{Chamois\_back}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{open\_page\_with\_margin}~15$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{h1\_title}~\ocwlowerid{title\_str}~|\ensuremath{>}~\ocwlowerid{print\_title}~(\ocwupperid{Some}~\ocwlowerid{default\_language})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{abort}~\ocwlowerid{default\_language}~\ocwlowerid{msg}~\ocwlowerid{submsg}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{invalid\_corpus\_mode\_page}~\ocwlowerid{expected\_mode}~\ocwlowerid{current\_mode}$\ocwenddcode{} generates an HTML on
   \ocwbegindcode{}$\ocwlowerid{output\_channel}$\ocwenddcode{} to notify the user that the requested operation
   on the corpus is available only in \ocwbegindcode{}$\ocwlowerid{expected\_mode}$\ocwenddcode{} and not in
   \ocwbegindcode{}$\ocwlowerid{current\_mode}$\ocwenddcode{}.  \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{invalid\_corpus\_permission\_page}~\ocwlowerid{expected}~\ocwlowerid{current}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{error\_page}~$\ocwstring{"Corpus\ocwvspace{}Manager"}\ocweol
\ocwindent{2.00em}
\ocwstring{"Invalid\ocwvspace{}permission\ocwvspace{}"}\ocweol
\ocwindent{2.00em}
$($\ocwstring{"Expected\ocwvspace{}permission:\ocwvspace{}"}~\^{}~$\ocwlowerid{expected}~$\^{}~\ocwstring{"\ocwvspace{}|\ocwvspace{}Current\ocwvspace{}permission:\ocwvspace{}"}~\^{}~$\ocwlowerid{current})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Css.ml}
\ocwmodule{Css}
\label{css.ml:0}%
Stand-alone module for generating the css file style.css 
\ocweol
\label{css.ml:712}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{class\_of}$\ocwenddcode{} style \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};$\medskip

\label{css.ml:758}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{cascade}~(\ocwlowerid{elt},\ocwlowerid{cla})~=~$\ocwbc{} cascading style sheets generator \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{elt}~$\^{}~\ocwstring{"."}~\^{}~$(\ocwlowerid{class\_of}~\ocwlowerid{cla})~$\^{}~\ocwstring{"\ocwvspace{}\{"}~\^{}~$(\ocwlowerid{style}~\ocwlowerid{cla})~$\^{}~\ocwstring{"\}"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sheets}~=~$\ocwbc{} cascading style sheets data \ocwec{}\ocweol
\ocwindent{1.00em}
$[~($\ocwstring{"a"},$\ocwupperid{Blue\_});~($\ocwstring{"a"},$\ocwupperid{Green\_});~($\ocwstring{"a"},$\ocwupperid{Navy\_});~($\ocwstring{"a"},$\ocwupperid{Red\_})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"h1"},$\ocwupperid{Title});~($\ocwstring{"h1"},$\ocwupperid{C1});~($\ocwstring{"h2"},$\ocwupperid{C2});~($\ocwstring{"h3"},$\ocwupperid{C3})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"h1"},$\ocwupperid{B1});~($\ocwstring{"h2"},$\ocwupperid{B2});~($\ocwstring{"h3"},$\ocwupperid{B3});~($\ocwstring{"p"},$\ocwupperid{G2})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"div"},$\ocwupperid{Latin12});~($\ocwstring{"div"},$\ocwupperid{Latin16});~($\ocwstring{"div"},$\ocwupperid{Enpied});~($\ocwstring{"div"},$\ocwupperid{Center\_})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"span"},$\ocwupperid{Alphabet});~($\ocwstring{"span"},$\ocwupperid{Deva});~($\ocwstring{"span"},$\ocwupperid{Trans12});~($\ocwstring{"span"},$\ocwupperid{Devared\_})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"span"},$\ocwupperid{Red\_});~($\ocwstring{"span"},$\ocwupperid{Roma16o});~($\ocwstring{"span"},$\ocwupperid{Magenta\_});~($\ocwstring{"span"},$\ocwupperid{Blue\_})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"span"},$\ocwupperid{Green\_});~($\ocwstring{"span"},$\ocwupperid{Latin12});~($\ocwstring{"span"},$\ocwupperid{Latin16});~($\ocwstring{"span"},$\ocwupperid{Trans16})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"span"},$\ocwupperid{Title});~($\ocwstring{"span"},$\ocwupperid{C1});~($\ocwstring{"span"},$\ocwupperid{C2});~($\ocwstring{"span"},$\ocwupperid{C3});~($\ocwstring{"span"},$\ocwupperid{Deva20c})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"span"},$\ocwupperid{B1});~($\ocwstring{"span"},$\ocwupperid{B2});~($\ocwstring{"span"},$\ocwupperid{B3});~($\ocwstring{"span"},$\ocwupperid{Header\_deva});~($\ocwstring{"span"},$\ocwupperid{Math})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"span"},$\ocwupperid{Devac});~($\ocwstring{"span"},$\ocwupperid{Header\_tran});~($\ocwstring{"span"},$\ocwupperid{Deva16});~($\ocwstring{"span"},$\ocwupperid{Deva16c})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"body"},$\ocwupperid{Mauve\_back});~($\ocwstring{"body"},$\ocwupperid{Pink\_back});~($\ocwstring{"body"},$\ocwupperid{Chamois\_back})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"table"},$\ocwupperid{Bandeau});~($\ocwstring{"table"},$\ocwupperid{Center\_});~($\ocwstring{"table"},$\ocwupperid{Body});~($\ocwstring{"table"},$\ocwupperid{Pad60})~$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"table"},$\ocwupperid{Yellow\_back});~($\ocwstring{"table"},$\ocwupperid{Yellow\_cent});~($\ocwstring{"table"},$\ocwupperid{Deep\_sky\_cent})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"table"},$\ocwupperid{Salmon\_back});~($\ocwstring{"table"},$\ocwupperid{Aquamarine\_back})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"table"},$\ocwupperid{Mauve\_back});~($\ocwstring{"table"},$\ocwupperid{Magenta\_back});~($\ocwstring{"table"},$\ocwupperid{Mauve\_cent})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"table"},$\ocwupperid{Cyan\_back});~($\ocwstring{"table"},$\ocwupperid{Cyan\_cent});~($\ocwstring{"table"},$\ocwupperid{Lavender\_cent})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"table"},$\ocwupperid{Gold\_back});~($\ocwstring{"table"},$\ocwupperid{Gold\_cent});~($\ocwstring{"table"},$\ocwupperid{Inflexion})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"table"},$\ocwupperid{Chamois\_back});~($\ocwstring{"table"},$\ocwupperid{Blue\_back})~;~($\ocwstring{"table"},$\ocwupperid{Green\_back})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"table"},$\ocwupperid{Brown\_back});~($\ocwstring{"table"},$\ocwupperid{Lime\_back});~($\ocwstring{"table"},$\ocwupperid{Deep\_sky\_back})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"table"},$\ocwupperid{Carmin\_back});~($\ocwstring{"table"},$\ocwupperid{Orange\_back});~($\ocwstring{"table"},$\ocwupperid{Red\_back})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"table"},$\ocwupperid{Grey\_back});~($\ocwstring{"table"},$\ocwupperid{Pink\_back});~($\ocwstring{"table"},$\ocwupperid{Spacing20})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"table"},$\ocwupperid{Light\_blue\_back});~($\ocwstring{"table"},$\ocwupperid{Lavender\_back});~($\ocwstring{"table"},$\ocwupperid{Lawngreen\_back})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"td"},$\ocwupperid{Yellow\_back});~($\ocwstring{"td"},$\ocwupperid{Yellow\_cent});~($\ocwstring{"td"},$\ocwupperid{Deep\_sky\_cent})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"td"},$\ocwupperid{Salmon\_back});~($\ocwstring{"td"},$\ocwupperid{Aquamarine\_back})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"td"},$\ocwupperid{Mauve\_back});~($\ocwstring{"td"},$\ocwupperid{Magenta\_back});~($\ocwstring{"td"},$\ocwupperid{Mauve\_cent})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"td"},$\ocwupperid{Cyan\_back});~($\ocwstring{"td"},$\ocwupperid{Cyan\_cent});~($\ocwstring{"td"},$\ocwupperid{Lavender\_cent})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"td"},$\ocwupperid{Gold\_back});~($\ocwstring{"td"},$\ocwupperid{Gold\_cent});~($\ocwstring{"td"},$\ocwupperid{Inflexion})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"td"},$\ocwupperid{Chamois\_back});~($\ocwstring{"td"},$\ocwupperid{Blue\_back})~;~($\ocwstring{"td"},$\ocwupperid{Green\_back})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"td"},$\ocwupperid{Brown\_back});~($\ocwstring{"td"},$\ocwupperid{Lime\_back});~($\ocwstring{"td"},$\ocwupperid{Deep\_sky\_back})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"td"},$\ocwupperid{Carmin\_back});~($\ocwstring{"td"},$\ocwupperid{Orange\_back});~($\ocwstring{"td"},$\ocwupperid{Red\_back})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"td"},$\ocwupperid{Grey\_back});~($\ocwstring{"td"},$\ocwupperid{Pink\_back});~($\ocwstring{"td"},$\ocwupperid{Spacing20})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"td"},$\ocwupperid{Light\_blue\_back});~($\ocwstring{"td"},$\ocwupperid{Lavender\_back});~($\ocwstring{"td"},$\ocwupperid{Lawngreen\_back})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"th"},$\ocwupperid{Cell5});~($\ocwstring{"th"},$\ocwupperid{Cell10});~($\ocwstring{"th"},$\ocwupperid{Border2});~($\ocwstring{"td"},$\ocwupperid{Center\_})$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"table"},$\ocwupperid{Centered});~($\ocwstring{"table"},$\ocwupperid{Tcenter})~;~($\ocwstring{""},~$\ocwupperid{Hidden\_})$\ocweol
\ocwindent{1.00em}
$];$\medskip

\label{css.ml:3168}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{css\_decls}~=$\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"a:link\ocwvspace{}\{color:\ocwvspace{}Blue\}"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"a:visited\ocwvspace{}\{color:\ocwvspace{}Purple\}"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"a:active\ocwvspace{}\{color:\ocwvspace{}Fuchsia\}"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"img\ocwvspace{}\{border:\ocwvspace{}0\}"}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"li\ocwvspace{}"}~\^{}~\ocwstring{"\{"}~\^{}~$(\ocwlowerid{style}~\ocwupperid{B3})~$\^{}~\ocwstring{"\}"}~\ocwbc{} patch for line numbers in corpus \ocwec{}\ocweol
\ocwindent{1.00em}
$]~@~\ocwupperid{List.}\ocwlowerid{map}~\ocwlowerid{cascade}~\ocwlowerid{sheets}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pop\_up\_spec}~=$\ocweol
\ocwindent{1.00em}
\ocwstring{"\#popBox\ocwvspace{}\{\ocwvspace{}position:\ocwvspace{}absolute;\ocwvspace{}z\symbol{45}index:\ocwvspace{}2;\ocwvspace{}background:\ocwvspace{}"}~\^{}~$\ocwlowerid{rgb}~\ocwupperid{Mauve}~$\^{}~\ocweol
\ocwindent{5.00em}
\ocwstring{";\ocwvspace{}padding:\ocwvspace{}0.3em;\ocwvspace{}border:\ocwvspace{}none;\ocwvspace{}white\symbol{45}space:\ocwvspace{}nowrap;\ocwvspace{}\}"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_css\_file}~()~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{output\_channel}~=~\ocwlowerid{open\_out}~\ocwlowerid{css\_file}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{ps}~=~\ocwlowerid{output\_string}~\ocwlowerid{output\_channel}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pl}~\ocwlowerid{s}~=~\ocwlowerid{ps}~(\ocwlowerid{s}~$\^{}~\ocwstring{"\symbol{92}n"}$)~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{css\_style}~\ocwlowerid{l}~=~\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{pl}~\ocwlowerid{l}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{css\_style}~\ocwlowerid{css\_decls}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{pop\_up\_spec}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{close\_out}~\ocwlowerid{output\_channel}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{print\_css\_file}~()$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Cgi.ml}
\ocwmodule{Cgi}
\label{cgi.ml:0}%
CGI utilities 
\ocweol
\ocwindent{0.00em}
Decoding utilities, author Daniel de Rauglaudre 
\ocweol
\ocwindent{0.00em}
ddr begin 
\ocweol
\label{cgi.ml:740}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{hexa\_val}~\ocwlowerid{conf}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{conf}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\verb!'0'!..\verb!'9'!~\rightarrow{}~\ocwupperid{Char.}\ocwlowerid{code}~\ocwlowerid{conf}~-~\ocwupperid{Char.}\ocwlowerid{code}~\verb!'0'!$\ocweol
\ocwindent{1.00em}
$\mid{}~\verb!'a'!..\verb!'f'!~\rightarrow{}~\ocwupperid{Char.}\ocwlowerid{code}~\ocwlowerid{conf}~-~\ocwupperid{Char.}\ocwlowerid{code}~\verb!'a'!~+~10$\ocweol
\ocwindent{1.00em}
$\mid{}~\verb!'A'!..\verb!'F'!~\rightarrow{}~\ocwupperid{Char.}\ocwlowerid{code}~\ocwlowerid{conf}~-~\ocwupperid{Char.}\ocwlowerid{code}~\verb!'A'!~+~10$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~0~$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{decode\_url}~\ocwlowerid{s}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{need\_decode}~\ocwlowerid{i}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{i}~<~\ocwupperid{Bytes.}\ocwlowerid{length}~\ocwlowerid{s}~$\ocwkw{then}\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwlowerid{s}.[\ocwlowerid{i}]~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~\verb!'%'!~\mid{}~\verb!'+'!~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{need\_decode}~(\ocwlowerid{succ}~\ocwlowerid{i})$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$\ocwupperid{False}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{compute\_len}~\ocwlowerid{i}~\ocwlowerid{i1}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{i}~<~\ocwupperid{Bytes.}\ocwlowerid{length}~\ocwlowerid{s}~$\ocwkw{then}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{i}~=$\ocweol
\ocwindent{4.00em}
\ocwkw{match}~$\ocwlowerid{s}.[\ocwlowerid{i}]~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~\verb!'%'!~$\ocwkw{when}~$\ocwlowerid{i}~+~2~<~\ocwupperid{Bytes.}\ocwlowerid{length}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{i}~+~3$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{succ}~\ocwlowerid{i}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{3.00em}
\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{compute\_len}~\ocwlowerid{i}~(\ocwlowerid{succ}~\ocwlowerid{i1})$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$\ocwlowerid{i1}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{copy\_decode\_in}~\ocwlowerid{s1}~\ocwlowerid{i}~\ocwlowerid{i1}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{i}~<~\ocwupperid{Bytes.}\ocwlowerid{length}~\ocwlowerid{s}~$\ocwkw{then}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{i}~=$\ocweol
\ocwindent{4.00em}
\ocwkw{match}~$\ocwlowerid{s}.[\ocwlowerid{i}]~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~\verb!'%'!~$\ocwkw{when}~$\ocwlowerid{i}~+~2~<~\ocwupperid{Bytes.}\ocwlowerid{length}~\ocwlowerid{s}~\rightarrow{}$\ocweol
\ocwindent{6.00em}
\ocwkw{let}~$\ocwlowerid{v}~=~\ocwlowerid{hexa\_val}~\ocwlowerid{s}.[\ocwlowerid{i}~+~1]~\times{}~16~+~\ocwlowerid{hexa\_val}~\ocwlowerid{s}.[\ocwlowerid{i}~+~2]~$\ocweol
\ocwindent{6.00em}
\ocwkw{in}~\ocwkw{do}~\{$\ocwupperid{Bytes.}\ocwlowerid{set}~\ocwlowerid{s1}~\ocwlowerid{i1}~(\ocwupperid{Char.}\ocwlowerid{chr}~\ocwlowerid{v});~\ocwlowerid{i}~+~3\}$\ocweol
\ocwindent{4.00em}
$\mid{}~\verb!'+'!~\rightarrow{}~$\ocwkw{do}~\{$\ocwupperid{Bytes.}\ocwlowerid{set}~\ocwlowerid{s1}~\ocwlowerid{i1}~\verb!' '!;~\ocwlowerid{succ}~\ocwlowerid{i}\}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwlowerid{x}~\rightarrow{}~$\ocwkw{do}~\{$\ocwupperid{Bytes.}\ocwlowerid{set}~\ocwlowerid{s1}~\ocwlowerid{i1}~\ocwlowerid{x};~\ocwlowerid{succ}~\ocwlowerid{i}\}~$\ocweol
\ocwindent{4.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{copy\_decode\_in}~\ocwlowerid{s1}~\ocwlowerid{i}~(\ocwlowerid{succ}~\ocwlowerid{i1})$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$\ocwlowerid{s1}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{strip\_heading\_and\_trailing\_spaces}~\ocwlowerid{s}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwupperid{Bytes.}\ocwlowerid{length}~\ocwlowerid{s}~>~0~$\ocwkw{then}\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{s}.[0]~\equiv~\verb!' '!~$\ocwkw{then}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{strip\_heading\_and\_trailing\_spaces}~(\ocwupperid{Bytes.}\ocwlowerid{sub}~\ocwlowerid{s}~1~(\ocwupperid{Bytes.}\ocwlowerid{length}~\ocwlowerid{s}~-~1))$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{s}.[\ocwupperid{Bytes.}\ocwlowerid{length}~\ocwlowerid{s}~-~1]~\equiv~\verb!' '!~$\ocwkw{then}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{strip\_heading\_and\_trailing\_spaces}~(\ocwupperid{Bytes.}\ocwlowerid{sub}~\ocwlowerid{s}~0~(\ocwupperid{Bytes.}\ocwlowerid{length}~\ocwlowerid{s}~-~1))$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~$\ocwlowerid{s}$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$\ocwlowerid{s}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{need\_decode}~0~$\ocwkw{then}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{len}~=~\ocwlowerid{compute\_len}~0~0~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{s1}~=~\ocwupperid{Bytes.}\ocwlowerid{create}~\ocwlowerid{len}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{strip\_heading\_and\_trailing\_spaces}~(\ocwlowerid{copy\_decode\_in}~\ocwlowerid{s1}~0~0)$\ocweol
\ocwindent{1.00em}
\ocwkw{else}~$\ocwlowerid{s};$\medskip

\ocwendcode{}\ocwindent{0.00em}
converts a string coming from the URL into an a-list; the string is 
   a sequence of pairs key=vallue separated by ; or \& 
\ocweol
\label{cgi.ml:2439}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{create\_env}~\ocwlowerid{s}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{get\_assoc}~\ocwlowerid{beg}~\ocwlowerid{i}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{i}~\equiv~\ocwupperid{Bytes.}\ocwlowerid{length}~\ocwlowerid{s}~$\ocwkw{then}\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{i}~\equiv~\ocwlowerid{beg}~$\ocwkw{then}~$[\,]~$\ocwkw{else}~$[~\ocwupperid{Bytes.}\ocwlowerid{sub}~\ocwlowerid{s}~\ocwlowerid{beg}~(\ocwlowerid{i}~-~\ocwlowerid{beg})~]$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{s}.[\ocwlowerid{i}]~\equiv~\verb!';'!~\lor{}~\ocwlowerid{s}.[\ocwlowerid{i}]~\equiv~\verb!'&'!~$\ocwkw{then}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{next\_i}~=~\ocwlowerid{succ}~\ocwlowerid{i}~$\ocwkw{in}~\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Bytes.}\ocwlowerid{sub}~\ocwlowerid{s}~\ocwlowerid{beg}~(\ocwlowerid{i}~-~\ocwlowerid{beg})~::~\ocwlowerid{get\_assoc}~\ocwlowerid{next\_i}~\ocwlowerid{next\_i}~]$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$\ocwlowerid{get\_assoc}~\ocwlowerid{beg}~(\ocwlowerid{succ}~\ocwlowerid{i})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{separate}~\ocwlowerid{i}~\ocwlowerid{s}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{i}~=~\ocwupperid{Bytes.}\ocwlowerid{length}~\ocwlowerid{s}~$\ocwkw{then}~$(\ocwlowerid{s},~$\ocwstring{""}$)$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~\ocwkw{if}~$\ocwlowerid{s}.[\ocwlowerid{i}]~\equiv~\verb!'='!~$\ocwkw{then}\ocweol
\ocwindent{3.00em}
$(\ocwupperid{Bytes.}\ocwlowerid{sub}~\ocwlowerid{s}~0~\ocwlowerid{i},~\ocwupperid{Bytes.}\ocwlowerid{sub}~\ocwlowerid{s}~(\ocwlowerid{succ}~\ocwlowerid{i})~(\ocwupperid{Bytes.}\ocwlowerid{length}~\ocwlowerid{s}~-~\ocwlowerid{succ}~\ocwlowerid{i}))$\ocweol
\ocwindent{2.00em}
\ocwkw{else}~$\ocwlowerid{separate}~(\ocwlowerid{succ}~\ocwlowerid{i})~\ocwlowerid{s}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{map}~(\ocwlowerid{separate}~0)~(\ocwlowerid{get\_assoc}~0~0)$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
ddr end 
\ocweol
\label{cgi.ml:3011}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{get}~\ocwlowerid{key}~\ocwlowerid{alist}~\ocwlowerid{default}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{List.}\ocwlowerid{assoc}~\ocwlowerid{key}~\ocwlowerid{alist}~$\ocwkw{with}~$[~\ocwupperid{Not\_found}~\rightarrow{}~\ocwlowerid{default}~]~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{decoded\_get}~\ocwlowerid{key}~\ocwlowerid{default}~\ocwlowerid{alist}~=~\ocwlowerid{decode\_url}~(\ocwlowerid{get}~\ocwlowerid{key}~\ocwlowerid{alist}~\ocwlowerid{default})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{query\_string\_env\_var}~=~$\ocwstring{"QUERY\_STRING"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{query\_string}~()~=$\ocweol
\ocwindent{1.00em}
\ocwkw{try}~$\ocwupperid{Sys.}\ocwlowerid{getenv}~\ocwlowerid{query\_string\_env\_var}~$\ocwkw{with}~$[~\ocwupperid{Not\_found}~\rightarrow{}~$\ocwstring{""}~$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{url\_encode}~\ocwlowerid{s}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{hexa\_str}~\ocwlowerid{c}~=~\ocwupperid{Printf.}\ocwlowerid{sprintf}~$\ocwstring{"\%.2X"}~$(\ocwupperid{Char.}\ocwlowerid{code}~\ocwlowerid{c})~$\ocwkw{in}\medskip

\ocwendcode{}\ocwindent{1.00em}
Reference: RFC 3986 appendix A 
\ocweol
\label{cgi.ml:3431}%
\medskip
\ocwbegincode{}\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{url\_encode}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
\ocwbc{} Unreserved characters \ocwec{}\ocweol
\ocwindent{2.00em}
$[~\verb!'a'!~..~\verb!'z'!~\mid{}~\verb!'A'!~..~\verb!'Z'!~\mid{}~\verb!'0'!~..~\verb!'9'!~\mid{}~\verb!'-'!~\mid{}~\verb!'.'!~\mid{}~\verb!'_'!~\mid{}~\verb!'~'!~$\ocwkw{as}~$\ocwlowerid{c}~\rightarrow{}$\ocweol
\ocwindent{3.00em}
$\ocwupperid{String.}\ocwlowerid{make}~1~\ocwlowerid{c}$\ocweol
\ocwindent{2.00em}
\ocwbc{} Special case of the space character \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\verb!' '!~\rightarrow{}~$\ocwstring{"+"}\ocweol
\ocwindent{2.00em}
\ocwbc{} Reserved characters \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{c}~\rightarrow{}~$\ocwstring{"\%"}~\^{}~$\ocwlowerid{hexa\_str}~\ocwlowerid{c}$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{char\_of\_string}~\ocwlowerid{s}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwupperid{String.}\ocwlowerid{length}~\ocwlowerid{s}~=~1~$\ocwkw{then}~$\ocwlowerid{s}.[0]~$\ocwkw{else}~$\ocwlowerid{failwith}~$\ocwstring{"char\_of\_string"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{subst}~\ocwlowerid{s}~=~\ocwlowerid{s}~|\ensuremath{>}~\ocwupperid{Str.}\ocwlowerid{matched\_string}~|\ensuremath{>}~\ocwlowerid{char\_of\_string}~|\ensuremath{>}~\ocwlowerid{url\_encode}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{any\_char}~=~\ocwupperid{Str.}\ocwlowerid{regexp}~$\ocwstring{".\symbol{92}\symbol{92}|\symbol{92}n"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{Str.}\ocwlowerid{global\_substitute}~\ocwlowerid{any\_char}~\ocwlowerid{subst}~\ocwlowerid{s}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{query\_of\_env}~\ocwlowerid{env}~=$\ocweol
\ocwindent{1.00em}
$\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{"\&"}~$(\ocwupperid{List.}\ocwlowerid{map}~($\ocwkw{fun}~$(\ocwlowerid{k},~\ocwlowerid{v})~\rightarrow{}~\ocwlowerid{k}~$\^{}~\ocwstring{"="}~\^{}~$\ocwlowerid{url\_encode}~\ocwlowerid{v})~\ocwlowerid{env})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{url}~?\ocwlowerid{query}~?\ocwlowerid{fragment}~\ocwlowerid{path}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{opt\_part}~\ocwlowerid{prefix}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{None}~\rightarrow{}~$\ocwstring{""}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Some}~\ocwlowerid{part}~\rightarrow{}~\ocwlowerid{prefix}~$\^{}~$\ocwlowerid{part}$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{query\_part}~=~\ocwlowerid{opt\_part}~$\ocwstring{"?"}~$\ocwlowerid{query}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{fragment\_part}~=~\ocwlowerid{opt\_part}~$\ocwstring{"\#"}~$\ocwlowerid{fragment}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{path}~$\^{}~$\ocwlowerid{query\_part}~$\^{}~$\ocwlowerid{fragment\_part}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Morpho_html.ml}
\ocwmodule{Morpho\_html}
\label{morpho_html.ml:0}%
This module contains various service utilities for CGI programs 
\ocweol
\label{morpho_html.ml:727}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Multilingual};~$\ocwbc{} Roma Deva \ocwec{}\medskip

\label{morpho_html.ml:798}%
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Out\_chan}~=~$\ocwkw{struct}~$\ocwlowerid{value}~\ocwlowerid{chan}~=~\ocwupperid{Web.}\ocwlowerid{output\_channel};~$\ocwkw{end};\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Morpho}~=~\ocwupperid{Morpho.Morpho\_out}~\ocwupperid{Out\_chan};$\medskip

\ocwendcode{}\ocwindent{0.00em}
This loads dynamically the MW exceptions database 
\ocweol
\label{morpho_html.ml:962}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{mw\_defining\_page}~\ocwlowerid{s}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{mw\_exceptions}~=~$\ocweol
\ocwindent{2.00em}
\ocwkw{try}~$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwlowerid{public\_mw\_exc\_file}~:~\ocwupperid{Deco.}\ocwlowerid{deco}~$\ocwbt{int}$)~$\ocweol
\ocwindent{2.00em}
\ocwkw{with}~$[~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"mw\_exceptions"}~$]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwupperid{Chapters.}\ocwlowerid{mw\_defining\_page\_exc}~\ocwlowerid{s}~\ocwlowerid{mw\_exceptions}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Absolute url on local site \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{url}~\ocwlowerid{s}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{page},\ocwlowerid{pref})~=~$\ocwkw{match}~$\ocwlowerid{lexicon\_toggle.}\ocwlowerid{val}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"SH"}~$\rightarrow{}~(\ocwlowerid{web\_dico\_url}~$\^{}~$\ocwupperid{Chapters.}\ocwlowerid{sh\_defining\_page}~\ocwlowerid{s},$\ocwstring{""}$)~$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"MW"}~$\rightarrow{}~(\ocwlowerid{mw\_dico\_url}~$\^{}~$\ocwlowerid{mw\_defining\_page}~\ocwlowerid{s},$\ocwstring{"H\_"}$)~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"Unknown\ocwvspace{}lexicon"}\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{page}~$\^{}~\ocwstring{"\#"}~\^{}~$\ocwlowerid{pref}~$\^{}~$\ocwupperid{Encode.}\ocwlowerid{anchor}~\ocwlowerid{s}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{url\_cache}~\ocwlowerid{s}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{mw\_dico\_url}~$\^{}~$\ocwlowerid{mw\_defining\_page}~\ocwlowerid{s}~$\^{}~\ocwstring{"\#"}~\^{}~$\ocwupperid{Encode.}\ocwlowerid{anchor}~\ocwlowerid{s}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Romanisation of Sanskrit \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_roma}~\ocwlowerid{s}~=~\ocwlowerid{italics}~(\ocwupperid{Transduction.}\ocwlowerid{skt\_to\_html}~\ocwlowerid{s})$\ocweol
\ocwindent{0.00em}
\ocwbc{} Function \ocwbegindcode{}$\ocwlowerid{skt\_roma}$\ocwenddcode{} differs from \ocwbegindcode{}$\ocwupperid{Encode}.\ocwlowerid{skt\_to\_roma}$\ocwenddcode{} 
   because it does not go through encoding \ocwbegindcode{}$\ocwlowerid{s}$\ocwenddcode{} as a word,
   and the complications of dealing with possible hiatus. \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_red}~\ocwlowerid{s}~=~\ocwlowerid{html\_red}~(\ocwlowerid{skt\_roma}~\ocwlowerid{s})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_anchor}~\ocwlowerid{cached}~\ocwlowerid{font}~\ocwlowerid{form}~=~$\ocwbc{} for Declension Conjugation \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{s}~=~$\ocwkw{match}~$\ocwlowerid{font}~$\ocwkw{with}\ocweol
\ocwindent{5.00em}
$[~\ocwupperid{Deva}~\rightarrow{}~\ocwlowerid{deva20\_blue\_center}~(\ocwupperid{Encode.}\ocwlowerid{skt\_raw\_strip\_to\_deva}~\ocwlowerid{form})$\ocweol
\ocwindent{5.00em}
$\mid{}~\ocwupperid{Roma}~\rightarrow{}~\ocwlowerid{skt\_roma}~\ocwlowerid{form}~$\ocwbc{} no stripping in Roma \ocwec{}\ocweol
\ocwindent{5.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{url\_function}~=~$\ocwkw{if}~$\ocwlowerid{cached}~$\ocwkw{then}~$\ocwlowerid{url\_cache}~$\ocwkw{else}~$\ocwlowerid{url}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{anchor}~\ocwupperid{Navy\_}~(\ocwlowerid{url\_function}~\ocwlowerid{form})~\ocwlowerid{s}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_anchor\_R}~\ocwlowerid{cached}~=~\ocwlowerid{skt\_anchor}~\ocwlowerid{cached}~\ocwupperid{Roma}~$\ocwbc{} for Declension, Indexer \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{skt\_anchor\_R2}~\ocwlowerid{s}~\ocwlowerid{s'}~=~\ocwlowerid{anchor}~\ocwupperid{Navy\_}~(\ocwlowerid{url}~\ocwlowerid{s})~(\ocwlowerid{skt\_roma}~\ocwlowerid{s'})~$\ocwbc{} for Indexer \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{no\_hom}~\ocwlowerid{entry}~=~$\ocwbc{} low-level string hacking \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$(\ocwupperid{String.}\ocwlowerid{sub}~\ocwlowerid{entry}~((\ocwupperid{String.}\ocwlowerid{length}~\ocwlowerid{entry})-1)~1)~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"1"}$\mid{}$\ocwstring{"2"}$\mid{}$\ocwstring{"3"}$\mid{}$\ocwstring{"4"}$\mid{}$\ocwstring{"5"}$\mid{}$\ocwstring{"6"}$\mid{}$\ocwstring{"7"}$\mid{}$\ocwstring{"8"}$\mid{}$\ocwstring{"9"}~$\rightarrow{}~\ocwupperid{False}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Used for printing MW in indexing mode \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Note the difference between word and entry, word is the normalized form 
   of entry. We need entry to link to the MW page, where it is unnormalized \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_anchor\_M}~\ocwlowerid{word}~\ocwlowerid{entry}~\ocwlowerid{page}~\ocwlowerid{cache}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{anchor\_used}~=~$\ocwkw{if}~$\ocwlowerid{cache}~$\ocwkw{then}~$\ocwlowerid{anchor\_graph}~$\ocwkw{else}~$\ocwlowerid{anchor}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{anc}~=~\ocwlowerid{mw\_dico\_url}~$\^{}~$\ocwlowerid{page}~$\^{}~\ocwstring{"\#"}~\^{}~$\ocwlowerid{entry}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{anchor\_mw}~=~\ocwlowerid{anchor\_used}~\ocwupperid{Navy\_}~\ocwlowerid{anc}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{vocable}~=~$\ocwkw{if}~$\ocwlowerid{no\_hom}~\ocwlowerid{entry}~$\ocwkw{then}~$\ocwlowerid{word}~$\ocweol
\ocwindent{8.00em}
\ocwkw{else}~\ocwkw{let}~$\ocwlowerid{pos}~=~(\ocwupperid{String.}\ocwlowerid{length}~\ocwlowerid{entry})-1~$\ocwkw{in}~\ocweol
\ocwindent{10.50em}
$\ocwlowerid{word}~$\^{}~\ocwstring{"\#"}~\^{}~$(\ocwupperid{String.}\ocwlowerid{sub}~\ocwlowerid{entry}~\ocwlowerid{pos}~1)~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{anchor\_mw}~(\ocwlowerid{skt\_roma}~\ocwlowerid{vocable})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{skt\_graph\_anchor\_R}~\ocwlowerid{cache}~\ocwlowerid{form}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{s}~=~\ocwlowerid{skt\_roma}~\ocwlowerid{form}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{url\_function}~=~$\ocwkw{if}~$\ocwlowerid{cache}~$\ocwkw{then}~$\ocwlowerid{url\_cache}~$\ocwkw{else}~$\ocwlowerid{url}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{anchor\_graph}~\ocwupperid{Navy\_}~(\ocwlowerid{url\_function}~\ocwlowerid{form})~\ocwlowerid{s}~$\ocweol
\ocwindent{0.00em}
;\medskip

\label{morpho_html.ml:3360}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_stem}~\ocwlowerid{w}~=~\ocwlowerid{ps}~(\ocwupperid{Canon.}\ocwlowerid{uniromcode}~\ocwlowerid{w})~$\ocwbc{} w in lexicon or not \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_chunk}~\ocwlowerid{w}~=~\ocwlowerid{ps}~(\ocwupperid{Canon.}\ocwlowerid{uniromcode}~\ocwlowerid{w})$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_entry}~\ocwlowerid{w}~=~\ocwlowerid{ps}~(\ocwlowerid{skt\_anchor\_R}~\ocwupperid{False}~(\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{w}))~$\ocwbc{} w in lexicon \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_ext\_entry}~\ocwlowerid{ps}~\ocwlowerid{w}~=~\ocwlowerid{ps}~(\ocwlowerid{skt\_anchor\_R}~\ocwupperid{False}~(\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{w}))~$\ocwbc{} idem \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_cache}~\ocwlowerid{w}~=~\ocwlowerid{ps}~(\ocwlowerid{skt\_anchor\_R}~\ocwupperid{True}~(\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{w}))$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_graph\_entry}~\ocwlowerid{w}~=~\ocwlowerid{ps}~(\ocwlowerid{skt\_graph\_anchor\_R}~\ocwupperid{False}~(\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{w}))$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_graph\_cache}~\ocwlowerid{w}~=~\ocwlowerid{ps}~(\ocwlowerid{skt\_graph\_anchor\_R}~\ocwupperid{True}~(\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{w}))$\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
Used in \ocwbegindcode{}$\ocwupperid{Indexer}$\ocwenddcode{} and \ocwbegindcode{}$\ocwupperid{Lemmatizer}$\ocwenddcode{} 
\ocweol
\label{morpho_html.ml:3883}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_inflected}~\ocwlowerid{gen}~\ocwlowerid{word}~\ocwlowerid{inverse}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwupperid{Morpho.}\ocwlowerid{print\_inv\_morpho}~\ocwlowerid{print\_entry}~\ocwlowerid{print\_stem}~\ocwlowerid{print\_chunk}~\ocwlowerid{word}~(0,0)~$\ocweol
\ocwindent{14.00em}
$\ocwlowerid{gen}~\ocwlowerid{inverse}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Used in \ocwbegindcode{}$\ocwupperid{Lexer}.\ocwlowerid{print\_morph}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_inflected\_link}~\ocwlowerid{pvs}~\ocwlowerid{cached}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{print\_fun}~=~$\ocwkw{if}~$\ocwlowerid{cached}~$\ocwkw{then}~$\ocwlowerid{print\_cache}~$\ocwkw{else}~$\ocwlowerid{print\_entry}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwupperid{Morpho.}\ocwlowerid{print\_inv\_morpho\_link}~\ocwlowerid{pvs}~\ocwlowerid{print\_fun}~\ocwlowerid{print\_stem}~\ocwlowerid{print\_chunk}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Variant for compound tags used in \ocwbegindcode{}$\ocwupperid{Lexer}.\ocwlowerid{print\_morph\_tad}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_inflected\_link\_tad}~\ocwlowerid{pvs}~\ocwlowerid{cached}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{print\_fun}~=~$\ocwkw{if}~$\ocwlowerid{cached}~$\ocwkw{then}~$\ocwlowerid{print\_cache}~$\ocwkw{else}~$\ocwlowerid{print\_entry}~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwupperid{Morpho.}\ocwlowerid{print\_inv\_morpho\_link\_tad}~\ocwlowerid{pvs}~\ocwlowerid{print\_fun}~\ocwlowerid{print\_stem}~\ocwlowerid{print\_chunk}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Used in \ocwbegindcode{}$\ocwupperid{Interface}$\ocwenddcode{} to print the lemmas \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_graph\_link}~\ocwlowerid{pvs}~\ocwlowerid{cached}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{print\_fun}~=~$\ocwkw{if}~$\ocwlowerid{cached}~$\ocwkw{then}~$\ocwlowerid{print\_graph\_cache}~$\ocwkw{else}~$\ocwlowerid{print\_graph\_entry}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{Morpho.}\ocwlowerid{print\_inv\_morpho\_link}~\ocwlowerid{pvs}~\ocwlowerid{print\_fun}~\ocwlowerid{print\_stem}~\ocwlowerid{print\_chunk}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Used in \ocwbegindcode{}$\ocwupperid{Interface}$\ocwenddcode{} to print the lemmas for taddhitaantas \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_graph\_link\_tad}~\ocwlowerid{pvs}~\ocwlowerid{cached}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{print\_fun}~=~$\ocwkw{if}~$\ocwlowerid{cached}~$\ocwkw{then}~$\ocwlowerid{print\_graph\_cache}~$\ocwkw{else}~$\ocwlowerid{print\_graph\_entry}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{Morpho.}\ocwlowerid{print\_inv\_morpho\_link\_tad}~\ocwlowerid{pvs}~\ocwlowerid{print\_fun}~\ocwlowerid{print\_stem}~\ocwlowerid{print\_chunk}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Final visarga form for display: final s and r are replaced by visarga.
   There is some information loss here, since -ar and -a.h do not have the 
   same behaviour with external sandhi, eg punar-api, antar-a'nga, antar-gata, 
   etc. For this reason the morphological tables do not keep forms in terminal 
   sandhi, and distinguish forms ended in -as and -ar.
   It should not be applied to stems, only to padas \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{visargify}~\ocwlowerid{rw}~=~\ocwupperid{Word.}\ocwlowerid{mirror}$\ocweol
\ocwindent{1.00em}
$($\ocwkw{match}~$\ocwlowerid{rw}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~[~48~$\ocwbc{} s \ocwec{}~::~$\ocwlowerid{r}~]~\mid{}~[~43~$\ocwbc{} r \ocwec{}~::~$\ocwlowerid{r}~]~\rightarrow{}~[~16~$\ocwbc{} .h \ocwec{}~::~$\ocwlowerid{r}~]~$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{rw}$\ocweol
\ocwindent{3.00em}
$])$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{final}~\ocwlowerid{w}~=~\ocwlowerid{visargify}~(\ocwupperid{Word.}\ocwlowerid{mirror}~\ocwlowerid{w})~$\ocwbc{} Declension, Conjugation \ocwec{}\ocweol
\ocwindent{0.00em}
;~\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_final}~\ocwlowerid{rw}~=~\ocwlowerid{print\_chunk}~(\ocwlowerid{visargify}~\ocwlowerid{rw})~$\ocwbc{} Interface \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{hdecode}~\ocwlowerid{word}~=~\ocwupperid{Transduction.}\ocwlowerid{skt\_to\_html}~(\ocwupperid{Canon.}\ocwlowerid{decode}~\ocwlowerid{word})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{html\_blue\_off}~\ocwlowerid{offset}~\ocwlowerid{text}~=~$\ocweol
\ocwindent{1.00em}
\ocwbc{} Temporary use of title attribute for XHTML 1.0 Strict offset recording, \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} should be replaced by data-offset in future HTML 5 compliance. \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} This is only needed for the SL annotator interface. \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwbc{} It has the unpleasant side effect of showing offsets on mouse over. \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{offset\_attr}~\ocwlowerid{offset}~=~($\ocwstring{"title"},$\ocwlowerid{string\_of\_int}~\ocwlowerid{offset})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$(\ocwlowerid{elt\_begin\_attrs}~[~\ocwlowerid{offset\_attr}~\ocwlowerid{offset}~]~$\ocwstring{"span"}~$\ocwupperid{Blue\_})~$\^{}~$\ocwlowerid{text}~$\^{}~$\ocwlowerid{span\_end}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} indicates offset of segment in attribute \ocwstring{"title"} of \ocwbegindcode{}$\ocwupperid{Blue\_}$\ocwenddcode{} span \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{blue\_word\_off}~\ocwlowerid{word}~\ocwlowerid{offset}~=~$\ocwbc{} deprecated \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{html\_blue\_off}~\ocwlowerid{offset}~(\ocwlowerid{emph}~(\ocwlowerid{hdecode}~\ocwlowerid{word}))$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_sandhi}~\ocwlowerid{u}~\ocwlowerid{v}~\ocwlowerid{w}~=~$\ocwkw{do}~\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{html\_magenta}~(\ocwlowerid{hdecode}~(\ocwlowerid{visargify}~\ocwlowerid{u})))~$\ocwbc{} visarga form \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{html\_green}~$\ocwstring{"|"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{html\_magenta}~(\ocwlowerid{hdecode}~\ocwlowerid{v}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{html\_blue}~$\ocwstring{"\ocwvspace{}\&rarr;\ocwvspace{}"}$)~$\ocwbc{} -> \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{html\_red}~(\ocwlowerid{hdecode}~\ocwlowerid{w}))$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_signifiant}~\ocwlowerid{rword}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{word}~=~\ocwlowerid{visargify}~\ocwlowerid{rword}~$\ocwkw{in}~\ocwbc{} visarga form : final s and r visarged \ocwec{}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{ps}~(\ocwlowerid{html\_blue}~(\ocwlowerid{hdecode}~\ocwlowerid{word}))~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} used in \ocwbegindcode{}$\ocwupperid{Lexer}.\ocwlowerid{print\_segment}$\ocwenddcode{} with offset indication \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_signifiant\_off}~\ocwlowerid{rword}~\ocwlowerid{offset}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{word}~=~\ocwlowerid{visargify}~\ocwlowerid{rword}~$\ocwkw{in}~\ocwbc{} visarga form : final s and r visarged \ocwec{}~\ocweol
\ocwindent{1.00em}
$\ocwlowerid{ps}~(\ocwlowerid{blue\_word\_off}~\ocwlowerid{word}~\ocwlowerid{offset})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} used in \ocwbegindcode{}$\ocwupperid{Lexer}.\ocwlowerid{print\_proj}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_signifiant\_yellow}~\ocwlowerid{rword}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~\ocwlowerid{th\_begin}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{table\_begin\_style}~(\ocwlowerid{background}~\ocwupperid{Yellow})~[~\ocwlowerid{padding5}~])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{td\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_signifiant}~\ocwlowerid{rword}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{td\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{table\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~\ocwlowerid{th\_end}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Chapters.ml}
\ocwmodule{Chapters}
\label{chapters.ml:0}%
module Chapter = struct 
\ocweol
\ocwindent{0.00em}
This module ensures that each individual HTML page of the DICO site
   is not too big, by slicing them into small chapters determined by prefixes
   of the vocables they define. 
\ocweol
\label{chapters.ml:835}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{chapters}~=~$\ocwbt{list}~$\ocwupperid{Word.}\ocwlowerid{word}~$\ocwbc{} chapter boundaries \ocwec{}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
The chapter mechanism - slicing Dico into moderate size html pages 
\ocweol
\label{chapters.ml:967}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~(\ocwlowerid{dico\_chapters}~:~\ocwlowerid{chapters})~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwupperid{Encode.}\ocwlowerid{code\_string}$\ocweol
\ocwindent{1.00em}
\ocwbc{} \ocwstring{"a"}  in  1.html \ocwec{}\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"ad"}~\ocwbc{} 2.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"anu"}~\ocwbc{} 3.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ap"}~\ocwbc{} 4.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"abh"}~\ocwbc{} 5.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ar"}~\ocwbc{} 6.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"av"}~\ocwbc{} 7.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ast"}~\ocwbc{} 8.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"aa"}~\ocwbc{} 9.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"aam"}~\ocwbc{} 10.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"i"}~\ocwbc{} 11.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ii"}~\ocwbc{} 12.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"u"}~\ocwbc{} 13.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ut"}~\ocwbc{} 14.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"up"}~\ocwbc{} 15.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"u.s"}~\ocwbc{} 16.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{".r"}~\ocwbc{} 17.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"k"}~\ocwbc{} 18.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"kan"}~\ocwbc{} 19.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"kaa"}~\ocwbc{} 20.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"kaay"}~\ocwbc{} 21.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"k.r"}~\ocwbc{} 22.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"k.s"}~\ocwbc{} 23.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"g"}~\ocwbc{} 24.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"g.r"}~\ocwbc{} 25.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"c"}~\ocwbc{} 26.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"j"}~\ocwbc{} 27.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"jh"}~\ocwbc{} 28.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"taa"}~\ocwbc{} 29.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"t.r"}~\ocwbc{} 30.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"d"}~\ocwbc{} 31.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"di"}~\ocwbc{} 32.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"dev"}~\ocwbc{} 33.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"dh"}~\ocwbc{} 34.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"naa"}~\ocwbc{} 35.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ni"}~\ocwbc{} 36.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"nii"}~\ocwbc{} 37.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"p"}~\ocwbc{} 38.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"par"}~\ocwbc{} 39.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"paa"}~\ocwbc{} 40.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"pi"}~\ocwbc{} 41.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"po"}~\ocwbc{} 42.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"prat"}~\ocwbc{} 43.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"prab"}~\ocwbc{} 44.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"praa"}~\ocwbc{} 45.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"bal"}~\ocwbc{} 46.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"bh"}~\ocwbc{} 47.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"bhe"}~\ocwbc{} 48.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"man"}~\ocwbc{} 49.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"mar"}~\ocwbc{} 50.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"mi"}~\ocwbc{} 51.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"muu"}~\ocwbc{} 52.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"y"}~\ocwbc{} 53.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"r"}~\ocwbc{} 54.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ro"}~\ocwbc{} 55.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"lam"}~\ocwbc{} 56.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"v"}~\ocwbc{} 57.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vaa"}~\ocwbc{} 58.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vi"}~\ocwbc{} 59.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vip"}~\ocwbc{} 60.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vi.s"}~\ocwbc{} 61.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"v.r"}~\ocwbc{} 62.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"z"}~\ocwbc{} 63.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"zu"}~\ocwbc{} 64.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{".s"}~\ocwbc{} 65.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"s"}~\ocwbc{} 66.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"san"}~\ocwbc{} 67.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sap"}~\ocwbc{} 68.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sar"}~\ocwbc{} 69.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sii"}~\ocwbc{} 70.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sur"}~\ocwbc{} 71.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sn"}~\ocwbc{} 72.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"h"}~\ocwbc{} 73.html \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~(\ocwlowerid{mw\_chapters}~:~\ocwlowerid{chapters})~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwupperid{Encode.}\ocwlowerid{code\_string}$\ocweol
\ocwindent{1.00em}
$[~$\ocwstring{"agni"}~\ocwbc{} 2.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"acira"}~\ocwbc{} 3.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"atikandaka"}~\ocwbc{} 4.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"adeya"}~\ocwbc{} 5.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"adhyaavap"}~\ocwbc{} 6.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"anaarambha.na"}~\ocwbc{} 7.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"anunii"}~\ocwbc{} 8.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"anu.sa.n.da"}~\ocwbc{} 9.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"anti"}~\ocwbc{} 10.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"apatrap"}~\ocwbc{} 11.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"apaas"}~\ocwbc{} 12.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"abuddha"}~\ocwbc{} 13.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"abhiprastu"}~\ocwbc{} 14.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"abhisa.mnam"}~\ocwbc{} 15.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"abhra"}~\ocwbc{} 16.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ambhi.nii"}~\ocwbc{} 17.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"aruza"}~\ocwbc{} 18.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"arvaac"}~\ocwbc{} 19.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"avatap"}~\ocwbc{} 20.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"avas.rj"}~\ocwbc{} 21.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"avo.sa"}~\ocwbc{} 22.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"azvanta"}~\ocwbc{} 23.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"asukha"}~\ocwbc{} 24.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ahe"}~\ocwbc{} 25.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"aa"}~\ocwbc{} 26.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"aacchid"}~\ocwbc{} 27.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"aaditeya"}~\ocwbc{} 28.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"aapaali"}~\ocwbc{} 29.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"aara.t.ta"}~\ocwbc{} 30.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"aav.r"}~\ocwbc{} 31.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"aahitu.n.dika"}~\ocwbc{} 32.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"i"}~\ocwbc{} 33.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"i.s"}~\ocwbc{} 34.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ii"}~\ocwbc{} 35.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"u"}~\ocwbc{} 36.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"uttama"}~\ocwbc{} 37.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"utpat"}~\ocwbc{} 38.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"udak"}~\ocwbc{} 39.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"udyam"}~\ocwbc{} 40.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"upajan"}~\ocwbc{} 41.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"uparuc"}~\ocwbc{} 42.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"upaacar"}~\ocwbc{} 43.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ulkaa"}~\ocwbc{} 44.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"uu"}~\ocwbc{} 45.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{".r"}~\ocwbc{} 46.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{".rr"}~\ocwbc{} 47.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{".l"}~\ocwbc{} 48.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{".lr"}~\ocwbc{} 49.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"e"}~\ocwbc{} 50.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"et.r"}~\ocwbc{} 51.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ai"}~\ocwbc{} 52.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"o"}~\ocwbc{} 53.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"au"}~\ocwbc{} 54.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"k"}~\ocwbc{} 55.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ka.n.th"}~\ocwbc{} 56.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"kapi"}~\ocwbc{} 57.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"karakaayu"}~\ocwbc{} 58.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"karma.sa"}~\ocwbc{} 59.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"kazcana"}~\ocwbc{} 60.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"kaaniita"}~\ocwbc{} 61.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"kaartsna"}~\ocwbc{} 62.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"kaaz"}~\ocwbc{} 63.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"kiim"}~\ocwbc{} 64.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ku.na"}~\ocwbc{} 65.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"kuyoga"}~\ocwbc{} 66.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"kuu.t"}~\ocwbc{} 67.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"k.rp"}~\ocwbc{} 68.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"kela"}~\ocwbc{} 69.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ko.s.na"}~\ocwbc{} 70.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"kra.s.tavya"}~\ocwbc{} 71.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"k.santavya"}~\ocwbc{} 72.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"k.sud"}~\ocwbc{} 73.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"kh"}~\ocwbc{} 74.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"khav"}~\ocwbc{} 75.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"g"}~\ocwbc{} 76.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"gandharva"}~\ocwbc{} 77.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"gav"}~\ocwbc{} 78.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"giita"}~\ocwbc{} 79.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"guh"}~\ocwbc{} 80.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"go"}~\ocwbc{} 81.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"godha"}~\ocwbc{} 82.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"graama"}~\ocwbc{} 83.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"gh"}~\ocwbc{} 84.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"f"}~\ocwbc{} 85.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"c"}~\ocwbc{} 86.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"catas.r"}~\ocwbc{} 87.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"candhana"}~\ocwbc{} 88.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"caara"}~\ocwbc{} 89.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"citka.nakantha"}~\ocwbc{} 90.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"caitra"}~\ocwbc{} 91.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ch"}~\ocwbc{} 92.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"j"}~\ocwbc{} 93.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"jam"}~\ocwbc{} 94.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"jala.daa"}~\ocwbc{} 95.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"jina"}~\ocwbc{} 96.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"j\~{}naa"}~\ocwbc{} 97.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"jh"}~\ocwbc{} 98.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"\~{}n"}~\ocwbc{} 99.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{".t"}~\ocwbc{} 100.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{".th"}~\ocwbc{} 101.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{".d"}~\ocwbc{} 102.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{".dh"}~\ocwbc{} 103.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{".n"}~\ocwbc{} 104.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"t"}~\ocwbc{} 105.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"tanaka"}~\ocwbc{} 106.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"tavas"}~\ocwbc{} 107.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"taavac"}~\ocwbc{} 108.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"tuk"}~\ocwbc{} 109.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"t.r.naafku"}~\ocwbc{} 110.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"tri"}~\ocwbc{} 111.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"trifkh"}~\ocwbc{} 112.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"th"}~\ocwbc{} 113.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"d"}~\ocwbc{} 114.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"dandaza"}~\ocwbc{} 115.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"dahara"}~\ocwbc{} 116.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"dina"}~\ocwbc{} 117.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"diirgha"}~\ocwbc{} 118.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"dur"}~\ocwbc{} 119.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"durdhar.sa"}~\ocwbc{} 120.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"duraaka"}~\ocwbc{} 121.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"devajana"}~\ocwbc{} 122.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"deva.ta"}~\ocwbc{} 123.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"dyuka"}~\ocwbc{} 124.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"dvaa.mdvika"}~\ocwbc{} 125.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"dvai"}~\ocwbc{} 126.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"dh"}~\ocwbc{} 127.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"dhari.ni"}~\ocwbc{} 128.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"dharka.ta"}~\ocwbc{} 129.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"dhuu"}~\ocwbc{} 130.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"dhva\~{}nj"}~\ocwbc{} 131.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"n"}~\ocwbc{} 132.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"nad"}~\ocwbc{} 133.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"narda.taka"}~\ocwbc{} 134.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"naagammaa"}~\ocwbc{} 135.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"naarifga"}~\ocwbc{} 136.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ni.h"}~\ocwbc{} 137.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"niryuktika"}~\ocwbc{} 138.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"niguh"}~\ocwbc{} 139.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"nimitta"}~\ocwbc{} 140.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"niryat"}~\ocwbc{} 141.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ni.skira"}~\ocwbc{} 142.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"niilafgu"}~\ocwbc{} 143.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"naivaki"}~\ocwbc{} 144.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"p"}~\ocwbc{} 145.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"pa\~{}nc"}~\ocwbc{} 146.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"pa.t"}~\ocwbc{} 147.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"pad"}~\ocwbc{} 148.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"payora"}~\ocwbc{} 149.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"paraacar"}~\ocwbc{} 150.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"paridih"}~\ocwbc{} 151.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"parividhaav"}~\ocwbc{} 152.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"par.n"}~\ocwbc{} 153.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"pavaru"}~\ocwbc{} 154.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"paa.daliipura"}~\ocwbc{} 155.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"paapacaka"}~\ocwbc{} 156.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"paava.s.turikeya"}~\ocwbc{} 157.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"pipi.svat"}~\ocwbc{} 158.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"pu.n.dariika"}~\ocwbc{} 159.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"pura\~{}njara"}~\ocwbc{} 160.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"pu.skaletra"}~\ocwbc{} 161.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"puul"}~\ocwbc{} 162.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"painya"}~\ocwbc{} 163.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"prak.rrt"}~\ocwbc{} 164.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"pra.nij"}~\ocwbc{} 165.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"pratika"}~\ocwbc{} 166.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"prativid"}~\ocwbc{} 167.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"pratyabhiprasthaa"}~\ocwbc{} 168.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"pradhuu"}~\ocwbc{} 169.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"pramii"}~\ocwbc{} 170.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"pravical"}~\ocwbc{} 171.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"prasah"}~\ocwbc{} 172.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"praa.mzu"}~\ocwbc{} 173.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"praatikaa"}~\ocwbc{} 174.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"priitu"}~\ocwbc{} 175.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ph"}~\ocwbc{} 176.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"b"}~\ocwbc{} 177.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"balaasa"}~\ocwbc{} 178.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"bahiinara"}~\ocwbc{} 179.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"bid"}~\ocwbc{} 180.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"b.rh"}~\ocwbc{} 181.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"brahman"}~\ocwbc{} 182.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"braadhnaayanya"}~\ocwbc{} 183.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"bh"}~\ocwbc{} 184.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"bhand"}~\ocwbc{} 185.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"bhaziraa"}~\ocwbc{} 186.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"bhaava"}~\ocwbc{} 187.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"bhiilabhuu.sa.naa"}~\ocwbc{} 188.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"bhuu"}~\ocwbc{} 189.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"bhuu.hkhaara"}~\ocwbc{} 190.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"bhraj"}~\ocwbc{} 191.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"m"}~\ocwbc{} 192.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ma.nittha"}~\ocwbc{} 193.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"madhu"}~\ocwbc{} 194.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"madhva"}~\ocwbc{} 195.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"manauu"}~\ocwbc{} 196.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"marb"}~\ocwbc{} 197.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"mah"}~\ocwbc{} 198.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"mahaaprabhaava"}~\ocwbc{} 199.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"mahaazairii.sa"}~\ocwbc{} 200.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"maa.msp.r.s.ta"}~\ocwbc{} 201.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"maanava"}~\ocwbc{} 202.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"maas"}~\ocwbc{} 203.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"muku.ta"}~\ocwbc{} 204.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"mummuni"}~\ocwbc{} 205.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"m.r"}~\ocwbc{} 206.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"m.r.saalaka"}~\ocwbc{} 207.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"moci"}~\ocwbc{} 208.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"y"}~\ocwbc{} 209.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"yata"}~\ocwbc{} 210.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"yam"}~\ocwbc{} 211.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"yaak.rtka"}~\ocwbc{} 212.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"yuvan"}~\ocwbc{} 213.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"r"}~\ocwbc{} 214.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ra.t"}~\ocwbc{} 215.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ram"}~\ocwbc{} 216.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"rasna"}~\ocwbc{} 217.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"raajakineya"}~\ocwbc{} 218.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"raayaana"}~\ocwbc{} 219.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ruddha"}~\ocwbc{} 220.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ro.nii"}~\ocwbc{} 221.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"l"}~\ocwbc{} 222.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"lataa"}~\ocwbc{} 223.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"laalii"}~\ocwbc{} 224.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"lok"}~\ocwbc{} 225.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"v"}~\ocwbc{} 226.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"va\~{}ncati"}~\ocwbc{} 227.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vanara"}~\ocwbc{} 228.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"varola"}~\ocwbc{} 229.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"valbh"}~\ocwbc{} 230.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vask"}~\ocwbc{} 231.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vaaca"}~\ocwbc{} 232.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vaayu"}~\ocwbc{} 233.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vaalguda"}~\ocwbc{} 234.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vi"}~\ocwbc{} 235.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vi.mza"}~\ocwbc{} 236.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vicitra"}~\ocwbc{} 237.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vid"}~\ocwbc{} 238.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vidhaav"}~\ocwbc{} 239.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vipadumaka"}~\ocwbc{} 240.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vimala"}~\ocwbc{} 241.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vilinaatha"}~\ocwbc{} 242.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vizii"}~\ocwbc{} 243.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vizvi"}~\ocwbc{} 244.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vi.sayaka"}~\ocwbc{} 245.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vi.spanda"}~\ocwbc{} 246.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"viir"}~\ocwbc{} 247.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"v.rddha"}~\ocwbc{} 248.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ve.n.tha"}~\ocwbc{} 249.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"veza"}~\ocwbc{} 250.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vaimaatra"}~\ocwbc{} 251.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vya\~{}nj"}~\ocwbc{} 252.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vyah"}~\ocwbc{} 253.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"vy.r"}~\ocwbc{} 254.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"z"}~\ocwbc{} 255.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"zata"}~\ocwbc{} 256.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"zabd"}~\ocwbc{} 257.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"zaraketu"}~\ocwbc{} 258.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"zazamaana"}~\ocwbc{} 259.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"zaa.mtanava"}~\ocwbc{} 260.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"zaaha"}~\ocwbc{} 261.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"zivaga.na"}~\ocwbc{} 262.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ziita"}~\ocwbc{} 263.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"zu.n.d"}~\ocwbc{} 264.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"zuurta"}~\ocwbc{} 265.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"zai.siri"}~\ocwbc{} 266.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"zyai"}~\ocwbc{} 267.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"zraama"}~\ocwbc{} 268.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"zriikajaaka"}~\ocwbc{} 269.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"zvabhr"}~\ocwbc{} 270.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{".s"}~\ocwbc{} 271.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"s"}~\ocwbc{} 272.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sa.mzu.s"}~\ocwbc{} 273.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sa.msthaa"}~\ocwbc{} 274.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sakalakala"}~\ocwbc{} 275.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sa.mgha.t"}~\ocwbc{} 276.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"satii"}~\ocwbc{} 277.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"satak.san"}~\ocwbc{} 278.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sa.mtap"}~\ocwbc{} 279.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sapak.sa"}~\ocwbc{} 280.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sabhaaj"}~\ocwbc{} 281.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"samave"}~\ocwbc{} 282.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"samifg"}~\ocwbc{} 283.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sam.r"}~\ocwbc{} 284.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"samphe.ta"}~\ocwbc{} 285.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"saragh"}~\ocwbc{} 286.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sarva"}~\ocwbc{} 287.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sarvasuuk.sma"}~\ocwbc{} 288.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sazakala"}~\ocwbc{} 289.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sahama"}~\ocwbc{} 290.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"saa.mjiiviiputra"}~\ocwbc{} 291.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"saamanii"}~\ocwbc{} 292.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"saar.sapa"}~\ocwbc{} 293.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sidgu.n.da"}~\ocwbc{} 294.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"siila"}~\ocwbc{} 295.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sucakra"}~\ocwbc{} 296.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sund"}~\ocwbc{} 297.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"suma"}~\ocwbc{} 298.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sur"}~\ocwbc{} 299.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"su.sa.msad"}~\ocwbc{} 300.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"suutr"}~\ocwbc{} 301.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"setu"}~\ocwbc{} 302.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sodara"}~\ocwbc{} 303.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sora"}~\ocwbc{} 304.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"skandha"}~\ocwbc{} 305.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"stha"}~\ocwbc{} 306.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"snaayu"}~\ocwbc{} 307.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"sm.rta"}~\ocwbc{} 308.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"svasvadha"}~\ocwbc{} 309.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"svanuruupa"}~\ocwbc{} 310.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"svaakta"}~\ocwbc{} 311.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"h"}~\ocwbc{} 312.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"hari"}~\ocwbc{} 313.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"hala"}~\ocwbc{} 314.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"hi.ms"}~\ocwbc{} 315.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"huu"}~\ocwbc{} 316.html \ocwec{}\ocweol
\ocwindent{1.00em}
;~\ocwstring{"ho.dha"}~\ocwbc{} 317.html \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\medskip

\label{chapters.ml:12044}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{look\_up\_chap}~\ocwlowerid{w}~\ocwlowerid{n}~=~$\ocweol
\ocwindent{0.00em}
\ocwbc{}  let v = match w with \ocwbegindcode{}~[~0~$(\times{}~-~\times{})~::~\ocwlowerid{stem}~]~\rightarrow{}~\ocwlowerid{stem}~\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{w}~$\ocwenddcode{} in \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{look\_up}~\ocwlowerid{n}~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{where}~$\ocwkw{rec}~$\ocwlowerid{look\_up}~\ocwlowerid{n}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[\,]~\rightarrow{}~\ocwlowerid{n}~$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{frontier}~::~\ocwlowerid{l}~]~\rightarrow{}~$\ocwkw{if}~$\ocwupperid{Order.}\ocwlowerid{lexico}~\ocwlowerid{frontier}~\ocwlowerid{w}~$\ocwkw{then}~$\ocwlowerid{look\_up}~(\ocwlowerid{n}+1)~\ocwlowerid{l}~$\ocwkw{else}~$\ocwlowerid{n}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Enter in this table associations between a defined form and its defining 
   entry, whenever there is a chapter boundary in between. 
   In a future version this table ought to be mechanically built. \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{vocable}~\ocwlowerid{s}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{entry}~=~$\ocwkw{fun}~\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"Dyaus"}~$\rightarrow{}~$\ocwstring{"div"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{s}$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
$\ocwupperid{Encode.}\ocwlowerid{code\_skt\_ref}~(\ocwlowerid{entry}~\ocwlowerid{s})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{dico\_chapter}~\ocwlowerid{s}~=~$\ocwbc{} defining chapter of Sanskrit word form \ocwbegindcode{}$\ocwlowerid{s}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{lower}~=~$\ocwkw{fun}~\ocweol
\ocwindent{2.00em}
$[~[~0~::~\ocwlowerid{w}~]~\rightarrow{}~\ocwlowerid{w}~$\ocwbc{} remove initial hyphen of suffixes \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{w}~]~\rightarrow{}~[~($\ocwkw{if}~$\ocwlowerid{c}>100~$\ocwkw{then}~$\ocwlowerid{c}-100~$\ocwkw{else}~$\ocwlowerid{c})~::~\ocwlowerid{w}~]~$\ocwbc{} remove capital \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~[\,]~\rightarrow{}~[\,]$\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{defining\_word}~=~\ocwlowerid{lower}~(\ocwlowerid{vocable}~\ocwlowerid{s})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{look\_up\_chap}~\ocwlowerid{defining\_word}~1~\ocwlowerid{dico\_chapters}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{cypher}~=~\ocwlowerid{string\_of\_int}~$\ocwbc{} no cyphering so far \ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{dico\_page}~\ocwlowerid{chapter}~=~$\ocwbc{} each chapter in its own page \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{cypher}~\ocwlowerid{chapter}~$\^{}~\ocwstring{".html"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Used in \ocwbegindcode{}$\ocwupperid{Morpho\_html}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sh\_defining\_page}~\ocwlowerid{s}~=~\ocwlowerid{dico\_page}~(\ocwlowerid{dico\_chapter}~\ocwlowerid{s})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{mw\_defining\_page\_exc}~\ocwlowerid{s}~\ocwlowerid{mw\_exceptions}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{exc\_page}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~(\ocwupperid{Encode.}\ocwlowerid{rev\_code\_string}~\ocwlowerid{s})~\ocwlowerid{mw\_exceptions}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{file\_name}~=~$\ocwkw{match}~$\ocwlowerid{exc\_page}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{initial}~=~$\ocwkw{fun}\ocweol
\ocwindent{3.50em}
$[~[~0~::~\ocwlowerid{w}~]~\rightarrow{}~\ocwlowerid{w}~$\ocwbc{} remove initial hyphen of suffixes \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~[~\ocwlowerid{c}~::~\ocwlowerid{w}~]~\rightarrow{}~[~($\ocwkw{if}~$\ocwlowerid{c}>100~$\ocwkw{then}~$\ocwlowerid{c}-100~$\ocwkw{else}~$\ocwlowerid{c})~::~\ocwlowerid{w}~]~$\ocwbc{} remove capital \ocwec{}\ocweol
\ocwindent{3.50em}
$\mid{}~[\,]~\rightarrow{}~[\,]$\ocweol
\ocwindent{3.50em}
$]~$\ocwkw{in}~\ocwkw{let}~$\ocwlowerid{defining\_word}~=~\ocwlowerid{initial}~(\ocwlowerid{vocable}~\ocwlowerid{s})~$\ocwkw{in}\ocweol
\ocwindent{6.00em}
$\ocwlowerid{look\_up\_chap}~\ocwlowerid{defining\_word}~1~\ocwlowerid{mw\_chapters}$\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{n}~]~\rightarrow{}~\ocwlowerid{n}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{failwith}~$\ocwstring{"mw\_defining\_page"}\ocweol
\ocwindent{2.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$(\ocwlowerid{cypher}~\ocwlowerid{file\_name})~$\^{}~\ocwstring{".html"}\ocweol
\ocwindent{0.00em}
;\medskip

\ocwendcode{}\ocwindent{0.00em}
end; 
\ocweol
\typeout{OcamlWeb file Morpho_scl.ml}
\ocwmodule{Morpho\_scl}
\label{morpho_scl.ml:0}%
Prints lists of inflected forms in XML for use by external Web services. 
\ocweol
\ocwindent{0.00em}
Adapted from \ocwbegindcode{}$\ocwupperid{Morpho\_xml}$\ocwenddcode{} 
\ocweol
\ocwindent{0.00em}
Uses WX for transliteration output. 
\ocweol
\label{morpho_scl.ml:809}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Skt\_morph};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Morphology};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{inflected}$\ocwenddcode{} and its constructors \ocwbegindcode{}$\ocwupperid{Noun\_form}$\ocwenddcode{}, ... \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Naming};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{look\_up\_homo}~\ocwlowerid{homo\_undo}~\ocwlowerid{unique\_kridantas}~\ocwlowerid{lexical\_kridantas}$\ocwenddcode{} \ocwec{}\medskip

\label{morpho_scl.ml:978}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{ps}~=~\ocwlowerid{print\_string}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{pr\_scl\_gana}~\ocwlowerid{k}~=~\ocwlowerid{ps}~(\ocwlowerid{string\_of\_int}~\ocwlowerid{k})~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_scl\_number}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Singular}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}sg/\ensuremath{>}"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Dual}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}du/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Plural}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}pl/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_scl\_gender}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Mas}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}m/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Neu}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}n/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Fem}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}f/\ensuremath{>}"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Deictic}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}d/\ensuremath{>}"}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_scl\_case}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Nom}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}nom/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Acc}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}acc/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ins}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}ins/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Dat}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}dat/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Abl}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}abl/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Gen}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}gen/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Loc}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}loc/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Voc}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}voc/\ensuremath{>}"}~\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_scl\_person}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{First}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}fst/\ensuremath{>}"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Second}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}snd/\ensuremath{>}"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Third}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}thd/\ensuremath{>}"}~\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_scl\_voice}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Active}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}ac/\ensuremath{>}"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Middle}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}md/\ensuremath{>}"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Passive}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}ps/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$]~$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_scl\_pr\_mode}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Present}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}pr\ocwvspace{}gana="}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Imperative}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}imp\ocwvspace{}gana="}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Optative}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}opt\ocwvspace{}gana="}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Imperfect}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}impft\ocwvspace{}gana="}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_scl\_pr\_mode\_ps}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Present}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}prps/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Imperative}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}impps/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Optative}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}optps/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Imperfect}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}impftps/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_scl\_tense}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Future}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}fut/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Perfect}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}pft/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Aorist}~\ocwlowerid{k}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}aor\ocwvspace{}gana="};~$\ocwlowerid{pr\_scl\_gana}~\ocwlowerid{k};~\ocwlowerid{ps}~$\ocwstring{"/\ensuremath{>}"}~\}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Injunctive}~\ocwlowerid{k}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}inj\ocwvspace{}gana="};~$\ocwlowerid{pr\_scl\_gana}~\ocwlowerid{k};~\ocwlowerid{ps}~$\ocwstring{"/\ensuremath{>}"}~\}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Conditional}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}cond/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Benedictive}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}ben/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_scl\_paradigm}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Conjug}~\ocwlowerid{t}~\ocwlowerid{v}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{print\_scl\_tense}~\ocwlowerid{t};~\ocwlowerid{print\_scl\_voice}~\ocwlowerid{v}~\}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Presenta}~\ocwlowerid{k}~\ocwlowerid{pr}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{print\_scl\_pr\_mode}~\ocwlowerid{pr};~\ocwlowerid{pr\_scl\_gana}~\ocwlowerid{k};~$\ocweol
\ocwindent{13.00em}
$\ocwlowerid{ps}~$\ocwstring{"/\ensuremath{>}\ensuremath{<}ac/\ensuremath{>}"}~\}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Presentm}~\ocwlowerid{k}~\ocwlowerid{pr}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{print\_scl\_pr\_mode}~\ocwlowerid{pr};~\ocwlowerid{pr\_scl\_gana}~\ocwlowerid{k};~$\ocweol
\ocwindent{13.00em}
$\ocwlowerid{ps}~$\ocwstring{"/\ensuremath{>}\ensuremath{<}md/\ensuremath{>}"}~\}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Presentp}~\ocwlowerid{pr}~\rightarrow{}~\ocwlowerid{print\_scl\_pr\_mode\_ps}~\ocwlowerid{pr}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Perfut}~\ocwlowerid{v}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}perfut/\ensuremath{>}"}~\ocwbc{} TODO: mark voice \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_scl\_conjugation}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Primary}~\rightarrow{}~()$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Causative}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}ca/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Intensive}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}int/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Desiderative}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}des/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_scl\_nominal}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Ppp}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}pp/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pppa}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}ppa/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppra}~\ocwlowerid{k}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}ppr\ocwvspace{}gana="};~$\ocwlowerid{pr\_scl\_gana}~\ocwlowerid{k};~\ocwlowerid{ps}~$\ocwstring{"/\ensuremath{>}"};\ocweol
\ocwindent{10.00em}
$\ocwlowerid{print\_scl\_voice}~\ocwupperid{Active}~\}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pprm}~\ocwlowerid{k}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}ppr\ocwvspace{}gana="};~$\ocwlowerid{pr\_scl\_gana}~\ocwlowerid{k};~\ocwlowerid{ps}~$\ocwstring{"/\ensuremath{>}"};\ocweol
\ocwindent{10.00em}
$\ocwlowerid{print\_scl\_voice}~\ocwupperid{Middle}~\}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pprp}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}ppr/\ensuremath{>}"};~$\ocwlowerid{print\_scl\_voice}~\ocwupperid{Passive}~\}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppfta}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}ppf/\ensuremath{>}"};~$\ocwlowerid{print\_scl\_voice}~\ocwupperid{Active}~\}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ppftm}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}ppf/\ensuremath{>}"};~$\ocwlowerid{print\_scl\_voice}~\ocwupperid{Middle}~\}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfuta}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}pfu/\ensuremath{>}"};~$\ocwlowerid{print\_scl\_voice}~\ocwupperid{Active}~\}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfutm}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}pfu/\ensuremath{>}"};~$\ocwlowerid{print\_scl\_voice}~\ocwupperid{Middle}~\}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Pfutp}~\ocwlowerid{k}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}pfp/\ensuremath{>}"};~$\ocwlowerid{pr\_scl\_gana}~\ocwlowerid{k}~\}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}act/\ensuremath{>}"}~\ocwbc{} action verbal nouns \ocwec{}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_scl\_invar}~=~$\ocwkw{fun}~\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Infi}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}inf/\ensuremath{>}"}~\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Absoya}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}abs/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Perpft}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}perpft/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_scl\_kind}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Part}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}part/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Prep}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}prep/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Conj}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}conj/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Abs}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}abs/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Adv}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}adv/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}und/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_scl\_finite}~(\ocwlowerid{c},\ocwlowerid{p})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{do}~\{~$\ocwlowerid{print\_scl\_conjugation}~\ocwlowerid{c};~\ocwlowerid{print\_scl\_paradigm}~\ocwlowerid{p}~\}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_scl\_verbal}~(\ocwlowerid{c},\ocwlowerid{n})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{do}~\{~$\ocwlowerid{print\_scl\_conjugation}~\ocwlowerid{c};~\ocwlowerid{print\_scl\_nominal}~\ocwlowerid{n}~\}$\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{print\_scl\_modal}~(\ocwlowerid{c},\ocwlowerid{i})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{do}~\{~$\ocwlowerid{print\_scl\_conjugation}~\ocwlowerid{c};~\ocwlowerid{print\_scl\_invar}~\ocwlowerid{i}~\}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_scl\_morph}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Noun\_form}~\ocwlowerid{g}~\ocwlowerid{n}~\ocwlowerid{c}~$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Part\_form}~\ocwlowerid{\_}~\ocwlowerid{g}~\ocwlowerid{n}~\ocwlowerid{c}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{print\_scl\_case}~\ocwlowerid{c}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{print\_scl\_number}~\ocwlowerid{n}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{print\_scl\_gender}~\ocwlowerid{g}$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Bare\_stem}~\mid{}~\ocwupperid{Avyayai\_form}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}iic/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Verb\_form}~\ocwlowerid{f}~\ocwlowerid{n}~\ocwlowerid{p}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwlowerid{print\_scl\_finite}~\ocwlowerid{f}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{print\_scl\_number}~\ocwlowerid{n}$\ocweol
\ocwindent{3.00em}
;~$\ocwlowerid{print\_scl\_person}~\ocwlowerid{p}$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind\_form}~\ocwlowerid{k}~\rightarrow{}~\ocwlowerid{print\_scl\_kind}~\ocwlowerid{k}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Avyayaf\_form}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}avya/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Abs\_root}~\ocwlowerid{c}~\rightarrow{}~$\ocwkw{do}~\{~$\ocwlowerid{print\_scl\_conjugation}~\ocwlowerid{c};~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}abs/\ensuremath{>}"}~\}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Auxi\_form}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}iiv/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Ind\_verb}~\ocwlowerid{m}~\rightarrow{}~\ocwlowerid{print\_scl\_modal}~\ocwlowerid{m}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{PV}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}pv/\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Unanalysed}~\rightarrow{}~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}unknown/\ensuremath{>}"}~\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_scl\_morphs}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{choice}~()~=~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}/choice\ensuremath{>}\ensuremath{<}choice\ensuremath{>}"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{List2.}\ocwlowerid{process\_list\_sep}~\ocwlowerid{print\_scl\_morph}~\ocwlowerid{choice}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_inv\_morpho\_scl}~\ocwlowerid{pe}~\ocwlowerid{form}~\ocwlowerid{generative}~(\ocwlowerid{delta},\ocwlowerid{morphs})~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{stem}~=~\ocwupperid{Word.}\ocwlowerid{patch}~\ocwlowerid{delta}~\ocwlowerid{form}~$\ocwkw{in}~\ocwkw{do}~\ocwbc{} stem may have homo index \ocwec{}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}morpho\_infl\ensuremath{>}\ensuremath{<}choice\ensuremath{>}"}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{print\_scl\_morphs}~\ocwlowerid{morphs}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}/choice\ensuremath{>}\ensuremath{<}/morpho\_infl\ensuremath{>}"}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}morpho\_gen\ensuremath{>}"}\ocweol
\ocwindent{2.00em}
;~\ocwkw{if}~$\ocwlowerid{generative}~$\ocwkw{then}~\ocwbc{} interpret stem as unique name \ocwec{}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$(\ocwlowerid{homo},\ocwlowerid{bare\_stem})~=~\ocwlowerid{homo\_undo}~\ocwlowerid{stem}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{krid\_infos}~=~\ocwupperid{Deco.}\ocwlowerid{assoc}~\ocwlowerid{bare\_stem}~\ocwlowerid{unique\_kridantas}~$\ocwkw{in}~\ocweol
\ocwindent{4.00em}
\ocwkw{try}~\ocwkw{let}~$(\ocwlowerid{verbal},\ocwlowerid{root})~=~\ocwlowerid{look\_up\_homo}~\ocwlowerid{homo}~\ocwlowerid{krid\_infos}~$\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{4.00em}
\{~$\ocwlowerid{pe}~\ocwlowerid{bare\_stem}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}krid\ensuremath{>}"};~$\ocwlowerid{print\_scl\_verbal}~\ocwlowerid{verbal}$\ocweol
\ocwindent{4.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}/krid\ensuremath{>}\ensuremath{<}root\ensuremath{>}"};~$\ocwlowerid{pe}~\ocwlowerid{root};~\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}/root\ensuremath{>}"}\ocweol
\ocwindent{4.00em}
\}~\ocwkw{with}~$[~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{pe}~\ocwlowerid{bare\_stem}~]$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~$\ocwlowerid{pe}~\ocwlowerid{stem}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"\ensuremath{<}/morpho\_gen\ensuremath{>}"}\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{3.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_scl\_entry}~\ocwlowerid{w}~=~$\ocwbc{} ps offline in WX notation for UoH interface \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{ps}~($\ocwstring{"\ensuremath{<}entry\ocwvspace{}wx=\symbol{92}""}~\^{}~$\ocwupperid{Canon.}\ocwlowerid{decode\_WX}~\ocwlowerid{w}~$\^{}~\ocwstring{"\symbol{92}"/\ensuremath{>}"}$)$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_inv\_morpho\_scl}~\ocwlowerid{pvs}~\ocwlowerid{form}~=~$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{pv}~=~$\ocwkw{if}~$\ocwupperid{Phonetics.}\ocwlowerid{phantomatic}~\ocwlowerid{form}~$\ocwkw{then}~$[~2~]~$\ocwbc{} aa- \ocwec{}~\ocweol
\ocwindent{5.50em}
\ocwkw{else}~$\ocwlowerid{pvs}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{encaps}~\ocwlowerid{e}~=~$\ocwkw{if}~$\ocwlowerid{pv}~=~[\,]~$\ocwkw{then}~$\ocwlowerid{print\_scl\_entry}~\ocwlowerid{e}$\ocweol
\ocwindent{8.50em}
\ocwkw{else}~\ocwkw{do}~\{~$\ocwlowerid{ps}~(\ocwupperid{Canon.}\ocwlowerid{decode\_WX}~\ocwlowerid{pvs}~$\^{}~\ocwstring{"\symbol{45}"}$);~\ocwlowerid{print\_scl\_entry}~\ocwlowerid{e}~\}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{print\_inv\_morpho\_scl}~\ocwlowerid{encaps}~\ocwlowerid{form}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Used in \ocwbegindcode{}$\ocwupperid{Lexer}.\ocwlowerid{print\_scl\_morph}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_scl\_inflected}~\ocwlowerid{pvs}~=~$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{print\_inv\_morpho\_scl}~\ocwlowerid{pvs}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Mk_index_page.ml}
\ocwmodule{Mk\_index\_page}
\label{mk_index_page.ml:0}%
This stand-alone program produces the page \ocwbegindcode{}$\ocwlowerid{indexer\_page}.\ocwlowerid{html}$\ocwenddcode{} used as
   index interface to the Sanskrit Heritage dictionary. 
\ocweol
\label{mk_index_page.ml:792}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps pl abort etc. \ocwec{}\medskip

\label{mk_index_page.ml:837}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{deva}~=~(\ocwupperid{Paths.}\ocwlowerid{default\_display\_font}=$\ocwstring{"deva"}$)~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_query}~\ocwlowerid{lang}~\ocwlowerid{cgi}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{cgi\_begin}~\ocwlowerid{cgi}~$\ocwstring{"convert"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_lexicon\_select}~(\ocwlowerid{lexicon\_of}~\ocwlowerid{lang})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{0.00em}
\ocwbc{}\ocwbegindcode{}~;~$\ocwlowerid{ps}~$\ocwstring{"Output\ocwvspace{}font\ocwvspace{}for\ocwvspace{}inflexion\ocwvspace{}tool"}
~;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"font"}~$\ocwupperid{Paths}.\ocwlowerid{default\_display\_font})~
~;~\ocwlowerid{pl}~(\ocwlowerid{option\_select\_default}~$\ocwstring{"font"}~
~[~$($\ocwstring{"\ocwvspace{}Roman"},\ocwstring{"roma"},$\lnot{}~\ocwlowerid{deva})~(\times{}~\ocwlowerid{default}~\ocwlowerid{roma}~-~\ocwupperid{Computer}~\times{})
~;~($\ocwstring{"\ocwvspace{}Devanagari"},\ocwstring{"deva"},$\ocwlowerid{deva})~(\times{}~\ocwlowerid{default}~\ocwlowerid{deva}~-~\ocwupperid{Simputer}~\times{})~
~])
~;~\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocwenddcode{} TODO: switch to specific version of dictionaries \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{text\_input}~$\ocwstring{"focus"}~\ocwstring{"q"}$)~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_transliteration\_switch}~$\ocwstring{"trans"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{submit\_input}~$\ocwstring{"Search"}$)~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{reset\_input}~$\ocwstring{"Reset"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{cgi\_end}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_query\_dummy}~\ocwlowerid{lang}~\ocwlowerid{cgi}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{cgi\_begin}~\ocwlowerid{cgi}~$\ocwstring{"convert"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"lex"}~$(\ocwlowerid{lexicon\_of}~\ocwlowerid{lang}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{text\_input}~$\ocwstring{"unused"}~\ocwstring{"q"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"ASCII"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{submit\_input}~$\ocwstring{"Search"}$)~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{reset\_input}~$\ocwstring{"Reset"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{cgi\_end}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_query\_lemma}~\ocwlowerid{lang}~\ocwlowerid{cgi}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{cgi\_begin}~\ocwlowerid{cgi}~$\ocwstring{"convert1"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"lex"}~$(\ocwlowerid{lexicon\_of}~\ocwlowerid{lang}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{text\_input}~$\ocwstring{"focus1"}~\ocwstring{"q"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_transliteration\_switch}~$\ocwstring{"trans1"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{option\_select\_default}~$\ocwstring{"c"}~\ocweol
\ocwindent{4.00em}
$[~($\ocwstring{"\ocwvspace{}Noun\ocwvspace{}"},\ocwstring{"Noun"},$\ocwupperid{True})~$\ocwbc{} default Noun \ocwec{}\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Pron\ocwvspace{}"},\ocwstring{"Pron"},$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Verb\ocwvspace{}"},\ocwstring{"Verb"},$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Part\ocwvspace{}"},\ocwstring{"Part"},$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Inde\ocwvspace{}"},\ocwstring{"Inde"},$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Absya\ocwvspace{}"},\ocwstring{"Absya"},$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Abstvaa\ocwvspace{}"},\ocwstring{"Abstvaa"},$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Voca\ocwvspace{}"},\ocwstring{"Voca"},$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Iic\ocwvspace{}"}~,\ocwstring{"Iic"},~$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Ifc\ocwvspace{}"}~,\ocwstring{"Ifc"},~$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Iiv\ocwvspace{}"}~,\ocwstring{"Iiv"},~$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Piic\ocwvspace{}"},\ocwstring{"Piic"},$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{submit\_input}~$\ocwstring{"Search"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{reset\_input}~$\ocwstring{"Reset"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{cgi\_end}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{indexer}~\ocwlowerid{lang}~=~$\ocwkw{do}~\ocwbc{} Not yet in xhtml validated form \ocwec{}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{open\_html\_file}~(\ocwlowerid{indexer\_page}~\ocwlowerid{lang})~\ocwlowerid{heritage\_dictionary\_title}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{body\_begin}~(\ocwlowerid{background}~\ocwupperid{Chamois}))$\ocweol
\ocwindent{2.00em}
\ocwbc{} will be closed by \ocwbegindcode{}$\ocwlowerid{close\_html\_file}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_title}~(\ocwupperid{Some}~\ocwlowerid{lang})~(\ocwlowerid{dico\_title}~\ocwlowerid{lang})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_begin}~$\ocwbc{} closed at the end \ocwec{}\ocweol
\ocwindent{2.50em}
\ocwbc{} Sankskit index section \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_index\_help}~\ocwlowerid{lang}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_query}~\ocwlowerid{lang}~\ocwlowerid{index\_cgi}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_paragraph}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{hr}$\ocweol
\ocwindent{2.50em}
\ocwbc{} Sankskrit made easy section (Sanskrit for dummies) \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{anchor\_def}~$\ocwstring{"easy"}~\ocwstring{""}$)~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{dummy\_title\_en}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_dummy\_help\_en}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_query\_dummy}~\ocwlowerid{lang}~\ocwlowerid{dummy\_cgi}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_paragraph}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{hr}$\ocweol
\ocwindent{2.50em}
\ocwbc{} Stemmer section \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{stem\_title\_en}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{anchor\_def}~$\ocwstring{"stemmer"}~\ocwstring{""}$)~$\ocwbc{} for access from dock link \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_stemmer\_help\_en}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_query\_lemma}~\ocwlowerid{lang}~\ocwlowerid{lemmatizer\_cgi}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{close\_html\_file}~\ocwlowerid{lang}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{indexer}~\ocwupperid{French}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{indexer}~\ocwupperid{English}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Mk_grammar_page.ml}
\ocwmodule{Mk\_grammar\_page}
\label{mk_grammar_page.ml:0}%
This program produces the page grammar.html (Grammarian interface) 
\ocweol
\label{mk_grammar_page.ml:734}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps pl abort etc. \ocwec{}\medskip

\label{mk_grammar_page.ml:779}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{title}~=~\ocwlowerid{h1\_title}~$\ocwstring{"The\ocwvspace{}Sanskrit\ocwvspace{}Grammarian"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{subtitle\_d}~=~\ocwlowerid{h1\_title}~$\ocwstring{"Declension"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{subtitle\_c}~=~\ocwlowerid{h1\_title}~$\ocwstring{"Conjugation"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{meta\_title}~=~\ocwlowerid{title}~$\ocwstring{"Sanskrit\ocwvspace{}Grammarian\ocwvspace{}Query"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{deva}~=~(\ocwupperid{Paths.}\ocwlowerid{default\_display\_font}=$\ocwstring{"deva"}$)~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_declension\_help}~\ocwlowerid{lang}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{narrow\_screen}~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{par\_begin}~\ocwupperid{G2})$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"Submit\ocwvspace{}stem\ocwvspace{}and\ocwvspace{}gender\ocwvspace{}for\ocwvspace{}declension:"}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"(Use\ocwvspace{}Any\ocwvspace{}for\ocwvspace{}deictic\ocwvspace{}pronouns\ocwvspace{}and\ocwvspace{}numbers)"}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{par\_end}~$\ocwbc{} G2 \ocwec{}\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_conjugation\_help}~\ocwlowerid{lang}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{narrow\_screen}~$\ocwkw{then}~$()~$\ocwkw{else}~\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{ps}~(\ocwlowerid{par\_begin}~\ocwupperid{G2})$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"Submit\ocwvspace{}root\ocwvspace{}and\ocwvspace{}present\ocwvspace{}class"}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"(Use\ocwvspace{}0\ocwvspace{}for\ocwvspace{}secondary\ocwvspace{}conjugations)"}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{par\_end}~$\ocwbc{} G2 \ocwec{}\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_output\_font}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"Output\ocwvspace{}font\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{option\_select\_default}~$\ocwstring{"font"}~\ocweol
\ocwindent{4.00em}
$[~($\ocwstring{"\ocwvspace{}Roman"},\ocwstring{"roma"},$\lnot{}~\ocwlowerid{deva})~$\ocwbc{} default roma - Computer \ocwec{}\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Devanagari"},\ocwstring{"deva"},$\ocwlowerid{deva})~$\ocwbc{} default deva - Simputer \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{submit\_input}~$\ocwstring{"Send"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{reset\_input}~$\ocwstring{"Reset"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{cgi\_end}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{grammarian}~\ocwlowerid{lang}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{open\_html\_file}~(\ocwlowerid{grammar\_page}~\ocwlowerid{lang})~\ocwlowerid{meta\_title}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{body\_begin}~(\ocwlowerid{background}~\ocwupperid{Chamois}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_title}~(\ocwupperid{Some}~\ocwlowerid{lang})~\ocwlowerid{title}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{subtitle\_d}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_declension\_help}~\ocwlowerid{lang}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{cgi\_begin}~\ocwlowerid{decls\_cgi}~$\ocwstring{"convert"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"lex"}~$(\ocwlowerid{lexicon\_of}~\ocwlowerid{lang}))$\ocweol
\ocwindent{0.00em}
\ocwbc{}\ocwbegindcode{}~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"v"}~$(\ocwupperid{Install}.\ocwlowerid{stamp}))$\ocwenddcode{} OBS \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{text\_input}~$\ocwstring{"focus"}~\ocwstring{"q"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_transliteration\_switch}~$\ocwstring{"trans"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"Gender\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{option\_select\_default}~$\ocwstring{"g"}~\ocweol
\ocwindent{4.00em}
$[~($\ocwstring{"\ocwvspace{}Mas\ocwvspace{}"},\ocwstring{"Mas"},$\ocwupperid{True})~$\ocwbc{} default Mas \ocwec{}\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Fem\ocwvspace{}"},\ocwstring{"Fem"},$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Neu\ocwvspace{}"},\ocwstring{"Neu"},$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Any\ocwvspace{}"},\ocwstring{"Any"},$\ocwupperid{False})~$\ocwbc{} deictic pronouns and numbers \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_output\_font}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{subtitle\_c}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{xml\_empty\_with\_att}~$\ocwstring{"a"}~$[~($\ocwstring{"name"},\ocwstring{"roots"}$)~])~$\ocwbc{} for portal ref \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_conjugation\_help}~\ocwlowerid{lang}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{cgi\_begin}~\ocwlowerid{conjs\_cgi}~$\ocwstring{"convert1"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"lex"}~$(\ocwlowerid{lexicon\_of}~\ocwlowerid{lang}))$\ocweol
\ocwindent{0.00em}
\ocwbc{}\ocwbegindcode{}~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"v"}~$(\ocwupperid{Install}.\ocwlowerid{stamp}))$\ocwenddcode{} OBS \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{text\_input}~$\ocwstring{"focus1"}~\ocwstring{"q"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_transliteration\_switch}~$\ocwstring{"trans1"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"Present\ocwvspace{}class\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{option\_select\_default}~$\ocwstring{"c"}~\ocwbc{} gana = present class \ocwec{}\ocweol
\ocwindent{4.00em}
$[~($\ocwstring{"\ocwvspace{}1\ocwvspace{}"},~\ocwstring{"1"},~$\ocwupperid{True})~$\ocwbc{} default 1 \ocwec{}\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}2\ocwvspace{}"},~\ocwstring{"2"},~$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}3\ocwvspace{}"},~\ocwstring{"3"},~$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}4\ocwvspace{}"},~\ocwstring{"4"},~$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}5\ocwvspace{}"},~\ocwstring{"5"},~$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}6\ocwvspace{}"},~\ocwstring{"6"},~$\ocwupperid{False})$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}7\ocwvspace{}"},~\ocwstring{"7"},~$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}8\ocwvspace{}"},~\ocwstring{"8"},~$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}9\ocwvspace{}"},~\ocwstring{"9"},~$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}10"},~\ocwstring{"10"},~$\ocwupperid{False})~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}11"},~\ocwstring{"11"},~$\ocwupperid{False})~$\ocwbc{} denominative verbs \ocwec{}\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}0"},~\ocwstring{"0"},~$\ocwupperid{False})~$\ocwbc{} secondary conjugations \ocwec{}\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_output\_font}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{close\_html\_file}~\ocwlowerid{lang}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{grammarian}~\ocwupperid{French}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{grammarian}~\ocwupperid{English}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Mk_reader_page.ml}
\ocwmodule{Mk\_reader\_page}
\label{mk_reader_page.ml:0}%
This program creates the page \ocwbegindcode{}$\ocwlowerid{reader\_page}$\ocwenddcode{} (Sanskrit Reader Interface) 
   invoking the CGI sktreader alias reader. Invoked without language argument,
   it is itself the CGI \ocwbegindcode{}$\ocwlowerid{skt\_heritage}$\ocwenddcode{} invokable separately. 
\ocweol
\label{mk_reader_page.ml:879}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps pl abort etc. \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Cgi};~$\ocwbc{} \ocwbegindcode{}$\ocwlowerid{create\_env}~\ocwlowerid{get}$\ocwenddcode{} \ocwec{}\medskip

\label{mk_reader_page.ml:958}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{back\_ground}~=~\ocwlowerid{background}~\ocwupperid{Chamois}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{out\_mode}~=~$\ocwbt{ref}~$\ocwupperid{None}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{set\_cho}~()~=~\ocwupperid{Arg.}\ocwlowerid{parse}~$\ocweol
\ocwindent{1.00em}
$[~($\ocwstring{"\symbol{45}fr"},~$\ocwupperid{Arg.Unit}~($\ocwkw{fun}~$()~\rightarrow{}~\ocwlowerid{out\_mode.}\ocwlowerid{val}:=\ocwupperid{Some}~\ocwupperid{French}),~$\ocwstring{"French"}$)$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{"\symbol{45}en"},~$\ocwupperid{Arg.Unit}~($\ocwkw{fun}~$()~\rightarrow{}~\ocwlowerid{out\_mode.}\ocwlowerid{val}:=\ocwupperid{Some}~\ocwupperid{English}),~$\ocwstring{"English"}$)$\ocweol
\ocwindent{1.00em}
;~$($\ocwstring{""},~$\ocwupperid{Arg.Unit}~($\ocwkw{fun}~$()~\rightarrow{}~\ocwlowerid{out\_mode.}\ocwlowerid{val}:=\ocwupperid{None}),~$\ocwstring{"cgi\ocwvspace{}output\ocwvspace{}on\ocwvspace{}stdout"}$)$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{1.00em}
$($\ocwkw{fun}~$\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{raise}~(\ocwupperid{Arg.Bad}~\ocwlowerid{s}))~$\ocweol
\ocwindent{1.00em}
\ocwstring{"Usage:\ocwvspace{}mk\_reader\_page\ocwvspace{}\symbol{45}en\ocwvspace{}or\ocwvspace{}mk\_reader\_page\ocwvspace{}\symbol{45}fr\ocwvspace{}or\ocwvspace{}mk\_reader\_page"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{print\_cache\_policy}~\ocwlowerid{cache\_active}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{ps}~$\ocwstring{"\ocwvspace{}Cache\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$\ocwlowerid{options}~=~$\ocweol
\ocwindent{3.00em}
$[~($\ocwstring{"\ocwvspace{}On\ocwvspace{}"},\ocwstring{"t"},$\ocwlowerid{cache\_active}=$\ocwstring{"t"}$)~$\ocwbc{} Cache active \ocwec{}\ocweol
\ocwindent{3.00em}
;~$($\ocwstring{"\ocwvspace{}Off\ocwvspace{}"},\ocwstring{"f"},$\ocwlowerid{cache\_active}=$\ocwstring{"f"}$)~$\ocwbc{} Ignore cache \ocwec{}\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{pl}~(\ocwlowerid{option\_select\_default}~$\ocwstring{"cache"}~$\ocwlowerid{options})$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{reader\_input\_area\_default}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{text\_area}~$\ocwstring{"text"}~1~$\ocwlowerid{screen\_char\_length}~$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{reader\_input\_area}~=~\ocwlowerid{reader\_input\_area\_default}~$\ocwstring{""}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{reader\_page}~()~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{set\_cho}~()$\ocweol
\ocwindent{1.00em}
;~\ocwkw{let}~$(\ocwlowerid{lang},\ocwlowerid{query})~=~$\ocwkw{match}~$\ocwlowerid{out\_mode.}\ocwlowerid{val}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Some}~\ocwlowerid{lang}~\rightarrow{}~$\ocwkw{do}~\ocweol
\ocwindent{3.50em}
\{~$\ocwlowerid{open\_html\_file}~(\ocwlowerid{reader\_page}~\ocwlowerid{lang})~\ocwlowerid{reader\_meta\_title};~(\ocwlowerid{lang},$\ocwstring{""}$)~\}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{None}~\rightarrow{}~$\ocwkw{do}\ocweol
\ocwindent{3.50em}
\{~$\ocwlowerid{reader\_prelude}~$\ocwstring{""};~$(\ocwlowerid{default\_language},~\ocwupperid{Sys.}\ocwlowerid{getenv}~$\ocwstring{"QUERY\_STRING"}$)~\}$\ocweol
\ocwindent{3.00em}
$]~$\ocwkw{in}~\ocwkw{try}~\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{env}~=~\ocwlowerid{create\_env}~\ocwlowerid{query}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{url\_encoded\_input}~=~\ocwlowerid{get}~$\ocwstring{"text"}~$\ocwlowerid{env}~$\ocwstring{""}~\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_mode}~=~\ocwlowerid{get}~$\ocwstring{"mode"}~$\ocwlowerid{env}~$\ocwstring{"g"}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{url\_encoded\_topic}~=~\ocwlowerid{get}~$\ocwstring{"topic"}~$\ocwlowerid{env}~$\ocwstring{""}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{st}~=~\ocwlowerid{get}~$\ocwstring{"st"}~$\ocwlowerid{env}~$\ocwstring{"t"}~\ocwbc{} default vaakya rather than isolated pada \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{cp}~=~\ocwlowerid{get}~$\ocwstring{"cp"}~$\ocwlowerid{env}~\ocwlowerid{default\_mode}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{us}~=~\ocwlowerid{get}~$\ocwstring{"us"}~$\ocwlowerid{env}~$\ocwstring{"f"}~\ocwbc{} default input sandhied \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{cache\_active}~=~\ocwlowerid{get}~$\ocwstring{"cache"}~$\ocwlowerid{env}~\ocwlowerid{cache\_active.}\ocwlowerid{val}$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{translit}~=~\ocwlowerid{get}~$\ocwstring{"t"}~$\ocwlowerid{env}~\ocwupperid{Paths.}\ocwlowerid{default\_transliteration}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwbc{} Contextual information from past discourse \ocwec{}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{topic\_mark}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_topic}~$\ocweol
\ocwindent{2.00em}
\ocwkw{and}~$\ocwlowerid{text}~=~\ocwlowerid{decode\_url}~\ocwlowerid{url\_encoded\_input}~$\ocwkw{in}\medskip

\ocwendcode{}\ocwindent{2.00em}
Corpus parameters 
\ocweol
\label{mk_reader_page.ml:2725}%
\medskip
\ocwbegincode{}\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{corpus\_permission}~=~\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Params.}\ocwlowerid{corpus\_permission}~$\ocwstring{""}~$\ocwlowerid{env}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{corpus\_dir}~=~\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Params.}\ocwlowerid{corpus\_dir}~$\ocwstring{""}~$\ocwlowerid{env}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{sentence\_no}~=~\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Params.}\ocwlowerid{sentence\_no}~$\ocwstring{""}~$\ocwlowerid{env}~$\ocwkw{in}~\ocwkw{do}\medskip

\label{mk_reader_page.ml:2940}%
\ocwindent{1.00em}
\{~$\ocwlowerid{pl}~(\ocwlowerid{body\_begin}~\ocwlowerid{back\_ground})~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_title}~(\ocwupperid{Some}~\ocwlowerid{lang})~\ocwlowerid{reader\_title}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{h3\_begin}~\ocwupperid{C3}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwupperid{Web\_corpus}.(\ocwlowerid{permission\_of\_string}~\ocwlowerid{corpus\_permission}~=~\ocwupperid{Annotator})~$\ocwkw{then}\ocweol
\ocwindent{3.00em}
\ocwstring{"Corpus\ocwvspace{}annotator\ocwvspace{}permission\ocwvspace{}\symbol{45}\ocwvspace{}"}~\^{}~$\ocwlowerid{corpus\_dir}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{2.00em}
\ocwkw{else}\ocweol
\ocwindent{3.00em}
$()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{h3\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_begin}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{cgi\_reader\_begin}~\ocwlowerid{reader\_cgi}~$\ocwstring{"convert"}$)~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_lexicon\_select}~(\ocwlowerid{lexicon\_of}~\ocwlowerid{lang})$\ocweol
\ocwindent{1.00em}
;~\ocwkw{if}~$\ocwlowerid{cache\_allowed}~$\ocwkw{then}~$\ocwlowerid{print\_cache\_policy}~\ocwlowerid{cache\_active}~$\ocwkw{else}~$()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~$\ocwstring{"Text\ocwvspace{}"}~\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{option\_select\_default}~$\ocwstring{"st"}~\ocweol
\ocwindent{4.00em}
$[~($\ocwstring{"\ocwvspace{}Sentence\ocwvspace{}"},\ocwstring{"t"},$\ocwlowerid{st}=$\ocwstring{"t"}$)~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}\ocwvspace{}\ocwvspace{}Word\ocwvspace{}\ocwvspace{}\ocwvspace{}"},\ocwstring{"f"},$\ocwlowerid{st}=$\ocwstring{"f"}$)~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~$\ocwstring{"\ocwvspace{}Format\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{option\_select\_default}~$\ocwstring{"us"}~\ocweol
\ocwindent{4.00em}
$[~($\ocwstring{"\ocwvspace{}Unsandhied\ocwvspace{}"},\ocwstring{"t"},$\ocwlowerid{us}=$\ocwstring{"t"}$)~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}\ocwvspace{}Sandhied\ocwvspace{}\ocwvspace{}"},\ocwstring{"f"},$\ocwlowerid{us}=$\ocwstring{"f"}$)~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~$\ocwstring{"\ocwvspace{}Parser\ocwvspace{}strength\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{option\_select\_default}~$\ocwstring{"cp"}\ocweol
\ocwindent{4.00em}
$[~($\ocwstring{"\ocwvspace{}\ocwvspace{}Full\ocwvspace{}\ocwvspace{}"},\ocwstring{"t"},$\ocwlowerid{cp}=$\ocwstring{"t"}$)~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Simple\ocwvspace{}"},\ocwstring{"f"},$\ocwlowerid{cp}=$\ocwstring{"f"}$)$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{reader\_input\_area\_default}~\ocwlowerid{text})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~$\ocwstring{"Input\ocwvspace{}convention\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{ps}~(\ocwlowerid{transliteration\_switch\_default}~\ocwlowerid{translit}~$\ocwstring{"trans"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~$\ocwstring{"\ocwvspace{}Optional\ocwvspace{}topic\ocwvspace{}"}~\ocwbc{} For the moment assumed singular \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{option\_select\_default}~$\ocwstring{"topic"}\ocweol
\ocwindent{4.00em}
$[~($\ocwstring{"\ocwvspace{}Masculine\ocwvspace{}"},\ocwstring{"m"},$\ocwlowerid{topic\_mark}=$\ocwstring{"m"}$)~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}Feminine\ocwvspace{}\ocwvspace{}"},\ocwstring{"f"},$\ocwlowerid{topic\_mark}=$\ocwstring{"f"}$)~$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}\ocwvspace{}Neuter\ocwvspace{}\ocwvspace{}\ocwvspace{}"},\ocwstring{"n"},$\ocwlowerid{topic\_mark}=$\ocwstring{"n"}$)$\ocweol
\ocwindent{4.00em}
;~$($\ocwstring{"\ocwvspace{}\ocwvspace{}\ocwvspace{}Void\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}"},\ocwstring{""}~,$\ocwlowerid{topic\_mark}=$\ocwstring{""}$)~$\ocweol
\ocwindent{4.00em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~$\ocwstring{"\ocwvspace{}Mode\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{option\_select\_default\_id}~$\ocwstring{"mode\_id"}~\ocwstring{"mode"}\ocweol
\ocwindent{4.00em}
$(\ocwlowerid{interaction\_modes\_default}~\ocwlowerid{url\_encoded\_mode}))$\medskip

\ocwendcode{}\ocwindent{1.00em}
Corpus parameters 
\ocweol
\label{mk_reader_page.ml:4473}%
\medskip
\ocwbegincode{}\ocwindent{1.00em}
;~$\ocwlowerid{hidden\_input}~\ocwupperid{Params.}\ocwlowerid{corpus\_permission}~\ocwlowerid{corpus\_permission}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{hidden\_input}~\ocwupperid{Params.}\ocwlowerid{corpus\_dir}~\ocwlowerid{corpus\_dir}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{hidden\_input}~\ocwupperid{Params.}\ocwlowerid{sentence\_no}~\ocwlowerid{sentence\_no}~|\ensuremath{>}~\ocwlowerid{pl}$\medskip

\label{mk_reader_page.ml:4646}%
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{submit\_input}~$\ocwstring{"Read"}$)~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{reset\_input}~$\ocwstring{"Reset"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{cgi\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_end}~$\ocweol
\ocwindent{1.00em}
;~\ocwkw{match}~$\ocwlowerid{out\_mode.}\ocwlowerid{val}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Some}~\ocwlowerid{lang}~\rightarrow{}~\ocwlowerid{close\_html\_file}~\ocwlowerid{lang}~\ocwupperid{True}~$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{None}~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{do}~\{~$\ocwlowerid{close\_page\_with\_margin}~();~\ocwlowerid{page\_end}~\ocwlowerid{default\_language}~\ocwupperid{True}~\}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{2.00em}
\ocwkw{with}~\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Sys\_error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{sys\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Stream.Error}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{stream\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} file pb \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Exit}~$\ocwbc{} Sanskrit \ocwec{}~$\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~$\ocwstring{"Wrong\ocwvspace{}character\ocwvspace{}in\ocwvspace{}input"}~\ocwstring{""}~\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Invalid\_argument}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} sub \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Failure}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{End\_of\_file}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"EOF"}~\ocwbc{} EOF \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Not\_found}~\rightarrow{}~$\ocwkw{let}~$\ocwlowerid{s}~=~$\ocwstring{"You\ocwvspace{}must\ocwvspace{}choose\ocwvspace{}a\ocwvspace{}parsing\ocwvspace{}option"}~\ocwkw{in}\ocweol
\ocwindent{14.50em}
$\ocwlowerid{abort}~\ocwlowerid{lang}~$\ocwstring{"Unset\ocwvspace{}button\ocwvspace{}in\ocwvspace{}form\ocwvspace{}\symbol{45}\ocwvspace{}"}~$\ocwlowerid{s}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Control.Fatal}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{s}~$\ocwbc{} anomaly \ocwec{}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Control.Anomaly}~\ocwlowerid{s}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~($\ocwstring{"Anomaly:\ocwvspace{}"}~\^{}~$\ocwlowerid{s})$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{lang}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"Unexpected\ocwvspace{}anomaly"}~\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{0.50em}
\}\ocweol
\ocwindent{0.00em}
;\medskip

\label{mk_reader_page.ml:5780}%
\ocwindent{0.00em}
$\ocwlowerid{reader\_page}~()$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwendcode{}\typeout{OcamlWeb file Mk_sandhi_page.ml}
\ocwmodule{Mk\_sandhi\_page}
\label{mk_sandhi_page.ml:0}%
This stand-alone program produces the page \ocwbegindcode{}$\ocwlowerid{sandhi\_page}.\ocwlowerid{html}$\ocwenddcode{} used as
   sandhi computation interface to the Sandhi Engine. 
\ocweol
\label{mk_sandhi_page.ml:790}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};~$\ocwbc{} ps pl abort etc. \ocwec{}\medskip

\label{mk_sandhi_page.ml:835}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{title}~=~\ocwlowerid{h1\_title}~$\ocwstring{"The\ocwvspace{}Sandhi\ocwvspace{}Engine"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{meta\_title}~=~\ocwlowerid{title}~$\ocwstring{"Sanskrit\ocwvspace{}Sandhi\ocwvspace{}Engine"}\ocweol
\ocwindent{0.00em}
\ocwkw{and}~$\ocwlowerid{back\_ground}~=~\ocwlowerid{background}~\ocwupperid{Chamois}$\ocweol
\ocwindent{1.00em}
\ocwbc{}\ocwbegindcode{}~$\ocwlowerid{obs}~$\ocwkw{if}~$\ocwlowerid{narrow\_screen}~$\ocwkw{then}~$\ocwlowerid{background}~\ocwupperid{Chamois}~$\ocwkw{else}~$\ocwupperid{Pict\_geo}~$\ocwenddcode{}\ocwec{}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sandhier}~\ocwlowerid{lang}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{open\_html\_file}~(\ocwlowerid{sandhi\_page}~\ocwlowerid{lang})~\ocwlowerid{meta\_title}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{body\_begin}~\ocwlowerid{back\_ground})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_title}~\ocwupperid{None}~\ocwlowerid{title}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_begin}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{cgi\_begin}~\ocwlowerid{sandhier\_cgi}~$\ocwstring{"convert2"}$)$\ocweol
\ocwindent{2.00em}
\ocwbc{} following necessary to transmit the lexicon choice of the session \ocwec{}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{hidden\_input}~$\ocwstring{"lex"}~$(\ocwlowerid{lexicon\_of}~\ocwlowerid{lang}))$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{text\_input}~$\ocwstring{"focus1"}~\ocwstring{"l"}$)~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{text\_input}~$\ocwstring{"focus2"}~\ocwstring{"r"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{print\_transliteration\_switch}~$\ocwstring{"trans"}\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{option\_select\_default}~$\ocwstring{"k"}~\ocweol
\ocwindent{4.50em}
$[~($\ocwstring{"\ocwvspace{}External\ocwvspace{}"},\ocwstring{"external"},$\ocwupperid{True})~$\ocwbc{} default external \ocwec{}\ocweol
\ocwindent{4.50em}
;~$($\ocwstring{"\ocwvspace{}Internal\ocwvspace{}"},\ocwstring{"internal"},$\ocwupperid{False})~$\ocweol
\ocwindent{4.50em}
$])$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{submit\_input}~$\ocwstring{"Send"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~(\ocwlowerid{reset\_input}~$\ocwstring{"Reset"}$)$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{cgi\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{html\_break}~$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{pl}~\ocwlowerid{center\_end}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{close\_html\_file}~\ocwlowerid{lang}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{sandhier}~\ocwupperid{French}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{sandhier}~\ocwupperid{English}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Mk_corpus_page.ml}
\ocwmodule{Mk\_corpus\_page}
\label{mk_corpus_page.ml:0}%
This program produces the pages corpus.html (Corpus interface).  
\ocweol
\label{mk_corpus_page.ml:690}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};$\medskip

\label{mk_corpus_page.ml:712}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{permission\_selection}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{selection}~\ocwlowerid{permissions}~=$\ocweol
\ocwindent{3.00em}
$\ocwupperid{List.}\ocwlowerid{map}~\ocwlowerid{select}~\ocwlowerid{permissions}~$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{where}~\ocwlowerid{select}~\ocwlowerid{permission}~=$\ocweol
\ocwindent{4.00em}
\ocwkw{let}~$\ocwlowerid{permission\_str}~=~\ocwupperid{Web\_corpus.}\ocwlowerid{string\_of\_permission}~\ocwlowerid{permission}~$\ocwkw{in}\ocweol
\ocwindent{4.00em}
$(\ocwupperid{String.}\ocwlowerid{capitalize}~\ocwlowerid{permission\_str},~\ocwlowerid{permission\_str},~$\ocweol
\ocwindent{4.50em}
$\ocwlowerid{permission}~=~\ocwupperid{Web\_corpus.Reader})~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{read\_only\_permissions}~=~[~\ocwupperid{Web\_corpus.Reader}~]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{other\_permissions}~=~\ocwupperid{Web\_corpus}.[~\ocwupperid{Annotator};~\ocwupperid{Manager}~]~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{all\_permissions}~=~\ocwlowerid{read\_only\_permissions}~@~\ocwlowerid{other\_permissions}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{selection}~($\ocwkw{if}~$\ocwlowerid{corpus\_read\_only}~$\ocwkw{then}~$\ocwlowerid{read\_only\_permissions}~$\ocwkw{else}~$\ocwlowerid{all\_permissions})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{make}~\ocwlowerid{lang}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{title\_str}~=~$\ocwstring{"Sanskrit\ocwvspace{}Corpus"}~\ocwkw{in}~\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{open\_html\_file}~(\ocwlowerid{corpus\_page}~\ocwlowerid{lang})~(\ocwlowerid{title}~\ocwlowerid{title\_str})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{body\_begin}~\ocwupperid{Chamois\_back}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{open\_page\_with\_margin}~15$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{h1\_title}~\ocwlowerid{title\_str}~|\ensuremath{>}~\ocwlowerid{print\_title}~(\ocwupperid{Some}~\ocwlowerid{lang})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{center\_begin}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{cgi\_begin}~\ocwlowerid{corpus\_manager\_cgi}~$\ocwstring{""}~\^{}\ocweol
\ocwindent{2.00em}
\ocwstring{"Capacity:\ocwvspace{}"}~\^{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{option\_select\_default}~\ocwupperid{Params.}\ocwlowerid{corpus\_permission}~\ocwlowerid{permission\_selection}~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{submit\_input}~$\ocwstring{"OK"}~\^{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{cgi\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{center\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{close\_page\_with\_margin}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{close\_html\_file}~\ocwlowerid{lang}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{main}~=~$\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{make}~\ocwupperid{English}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{make}~\ocwupperid{French}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Corpus.mli}
\ocwinterface{Corpus}
\label{corpus.mli:0}%
Operations on the corpus tree 
\ocweol
\label{corpus.mli:655}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Section}~:~$\ocwkw{sig}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{label}~:~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Analyzer}~:~$\ocwkw{sig}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}~=~[~\ocwupperid{Graph}~]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{path}~:~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{relocatable\_path}~:~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Analysis}~:~$\ocwkw{sig}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{make}~:~\ocwupperid{Analyzer.}\ocwlowerid{t}~\rightarrow{}~\ocwupperid{Html.}\ocwlowerid{language}~\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~\ocwupperid{Num.}\ocwlowerid{num}~\rightarrow{}~\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{analyzer}~:~\ocwlowerid{t}~\rightarrow{}~\ocwupperid{Analyzer.}\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{lang}~:~\ocwlowerid{t}~\rightarrow{}~\ocwupperid{Html.}\ocwlowerid{language}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{checkpoints}~:~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{nb\_sols}~:~\ocwlowerid{t}~\rightarrow{}~\ocwupperid{Num.}\ocwlowerid{num}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Encoding}~:~$\ocwkw{sig}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}~=~[~\ocwupperid{Velthuis}~\mid{}~\ocwupperid{WX}~\mid{}~\ocwupperid{KH}~\mid{}~\ocwupperid{SLP1}~\mid{}~\ocwupperid{Devanagari}~\mid{}~\ocwupperid{IAST}~]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{to\_string}~:~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{of\_string}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{encode}~:~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{decode}~:~\ocwlowerid{t}~\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Sentence}~:~$\ocwkw{sig}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{make}~:~$\ocwbt{int}~$\rightarrow{}~$\ocwbt{list}~$\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~$\ocwbt{bool}~$\rightarrow{}~\ocwupperid{Analysis.}\ocwlowerid{t}~\rightarrow{}~\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{id}~:~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{int}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{text}~:~\ocwupperid{Encoding.}\ocwlowerid{t}~\rightarrow{}~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{analysis}~:~\ocwlowerid{t}~\rightarrow{}~\ocwupperid{Analysis.}\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~\ocwkw{type}~$\ocwupperid{Location}~=~$\ocwkw{sig}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{path}~:~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~\ocwkw{type}~$\ocwupperid{S}~=~$\ocwkw{sig}\ocweol
\ocwindent{1.00em}
\ocwbc{} Contents of a corpus subdirectory: either it is empty (constructor
     \ocwbegindcode{}$\ocwupperid{Empty}$\ocwenddcode{}), otherwise we are on leaves of the tree (constructor
     \ocwbegindcode{}$\ocwupperid{Sentences}$\ocwenddcode{}) or on branches (constructor \ocwbegindcode{}$\ocwupperid{Sections}$\ocwenddcode{}).  \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{contents}~=$\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Empty}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Sections}~$\ocwkw{of}~\ocwbt{list}~$\ocwupperid{Section.}\ocwlowerid{t}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Sentences}~$\ocwkw{of}~\ocwbt{list}~$\ocwupperid{Sentence.}\ocwlowerid{t}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwbc{} List the contents of the given corpus subdirectory.  Note that the
     returned elements are sorted according to \ocwbegindcode{}$\ocwupperid{Section}.\ocwlowerid{compare}$\ocwenddcode{} or
     \ocwbegindcode{}$\ocwupperid{Sentence}.\ocwlowerid{compare}$\ocwenddcode{} depending on the case.  Raise \ocwbegindcode{}$\ocwupperid{Sys\_error}$\ocwenddcode{} when
     an operating system error occurs.  \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{contents}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{contents}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwbc{} Exception raised by \ocwbegindcode{}$\ocwlowerid{save\_sentence}$\ocwenddcode{} when the sentence to be saved
     already exists.  \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{exception}~$\ocwupperid{Sentence\_already\_exists}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwbc{} Raise \ocwbegindcode{}$\ocwupperid{Sentence\_already\_exists}$\ocwenddcode{} if the sentence to be saved already
     exists and \ocwbegindcode{}$\ocwlowerid{force}$\ocwenddcode{} is \ocwbegindcode{}$\ocwupperid{False}$\ocwenddcode{} and \ocwbegindcode{}$\ocwupperid{Sys\_error}$\ocwenddcode{} when an operating
     system error occurs.  \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{save\_sentence}~:$\ocweol
\ocwindent{2.00em}
\ocwbt{bool}~$\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{int}~$\rightarrow{}~$\ocwbt{list}~$\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~$\ocwbt{bool}~$\rightarrow{}~\ocwupperid{Analysis.}\ocwlowerid{t}~\rightarrow{}~$\ocwbt{unit}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwkw{exception}~$\ocwupperid{Section\_already\_exists}~$\ocwkw{of}~\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwbc{} Raise \ocwbegindcode{}$\ocwupperid{Section\_already\_exists}$\ocwenddcode{} if the given corpus directory
     already exists and \ocwbegindcode{}$\ocwupperid{Unix}.\ocwupperid{Unix\_error}$\ocwenddcode{} when an operating system error
     occurs.  \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{mkdir}~:~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{unit}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwkw{exception}~$\ocwupperid{No\_such\_sentence}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwbc{} Raise \ocwbegindcode{}$\ocwupperid{No\_such\_sentence}$\ocwenddcode{} if the requested sentence does not
     exist.  \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{sentence}~:~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{int}~$\rightarrow{}~\ocwupperid{Sentence.}\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{permission}~=~[~\ocwupperid{Reader}~\mid{}~\ocwupperid{Annotator}~\mid{}~\ocwupperid{Manager}~]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{default\_permission}~:~\ocwlowerid{permission}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{string\_of\_permission}~:~\ocwlowerid{permission}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{permission\_of\_string}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{permission}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{url}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{permission}~\rightarrow{}~\ocwupperid{Sentence.}\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{relocatable\_url}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{permission}~\rightarrow{}~\ocwupperid{Sentence.}\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwbc{} \ocwbegindcode{}$\ocwlowerid{citation}~\ocwlowerid{subdir}~\ocwlowerid{id}~$\ocwenddcode{}] returns an URL to the analysis
     of the sentence whose number is \ocwbegindcode{}$\ocwlowerid{id}$\ocwenddcode{} in the corpus
     subdirectory \ocwbegindcode{}$\ocwlowerid{subdir}$\ocwenddcode{}. Raise \ocwbegindcode{}$\ocwupperid{Failure}~$\ocwstring{"citation"}\ocwenddcode{} if an
     error occurs.  \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{citation}~:~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{int}~$\rightarrow{}~$\ocwbt{string}~\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Make}~(\ocwupperid{Loc}~:~\ocwupperid{Location})~:~\ocwupperid{S}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Corpus.ml}
\ocwmodule{Corpus}
\label{corpus.ml:0}%
\label{corpus.ml:619}%
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Section}~:~$\ocwkw{sig}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{make}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{label}~:~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{compare}~:~\ocwlowerid{t}~\rightarrow{}~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{int}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}~=~\ocwkw{struct}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}~=~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{make}~\ocwlowerid{h}~=~\ocwlowerid{h}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{label}~\ocwlowerid{h}~=~\ocwlowerid{h}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{compare}~\ocwlowerid{h}~\ocwlowerid{h'}~=~\ocwupperid{String.}\ocwlowerid{compare}~(\ocwlowerid{label}~\ocwlowerid{h})~(\ocwlowerid{label}~\ocwlowerid{h'})$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Analyzer}~:~$\ocwkw{sig}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}~=~[~\ocwupperid{Graph}~]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{path}~:~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{relocatable\_path}~:~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}~=~\ocwkw{struct}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}~=~[~\ocwupperid{Graph}~]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{path}~=~$\ocwkw{fun}~$[~\ocwupperid{Graph}~\rightarrow{}~\ocwupperid{Paths}.(\ocwlowerid{cgi\_dir\_url}~$\^{}~$\ocwlowerid{cgi\_graph})~]$\ocweol
\ocwindent{1.00em}
\ocwkw{and}~$\ocwlowerid{relocatable\_path}~=~$\ocwkw{fun}~$[~\ocwupperid{Graph}~\rightarrow{}~$\ocwstring{"!CGIGRAPH"}~$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Analysis}~:~$\ocwkw{sig}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{make}~:$\ocweol
\ocwindent{2.00em}
$\ocwupperid{Analyzer.}\ocwlowerid{t}~\rightarrow{}~\ocwupperid{Html.}\ocwlowerid{language}~\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~\ocwupperid{Num.}\ocwlowerid{num}~\rightarrow{}~\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{analyzer}~:~\ocwlowerid{t}~\rightarrow{}~\ocwupperid{Analyzer.}\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{lang}~:~\ocwlowerid{t}~\rightarrow{}~\ocwupperid{Html.}\ocwlowerid{language}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{checkpoints}~:~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{nb\_sols}~:~\ocwlowerid{t}~\rightarrow{}~\ocwupperid{Num.}\ocwlowerid{num}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}~=~\ocwkw{struct}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}~=$\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{analyzer}~:~\ocwupperid{Analyzer.}\ocwlowerid{t}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{lang}~:~\ocwupperid{Html.}\ocwlowerid{language}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{checkpoints}~:~$\ocwbt{string}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{nb\_sols}~:~\ocwupperid{Num.}\ocwlowerid{num}$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{make}~\ocwlowerid{analyzer}~\ocwlowerid{lang}~\ocwlowerid{checkpoints}~\ocwlowerid{nb\_sols}~=$\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{analyzer}~;~\ocwlowerid{lang};~\ocwlowerid{checkpoints};~\ocwlowerid{nb\_sols}~\}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{analyzer}~\ocwlowerid{a}~=~\ocwlowerid{a.}\ocwlowerid{analyzer}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{lang}~\ocwlowerid{a}~=~\ocwlowerid{a.}\ocwlowerid{lang}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{checkpoints}~\ocwlowerid{a}~=~\ocwlowerid{a.}\ocwlowerid{checkpoints}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{nb\_sols}~\ocwlowerid{a}~=~\ocwlowerid{a.}\ocwlowerid{nb\_sols}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Encoding}~:~$\ocwkw{sig}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}~=~[~\ocwupperid{Velthuis}~\mid{}~\ocwupperid{WX}~\mid{}~\ocwupperid{KH}~\mid{}~\ocwupperid{SLP1}~\mid{}~\ocwupperid{Devanagari}~\mid{}~\ocwupperid{IAST}~]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{to\_string}~:~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{of\_string}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{encode}~:~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{decode}~:~\ocwlowerid{t}~\rightarrow{}~\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}~=~\ocwkw{struct}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}~=~[~\ocwupperid{Velthuis}~\mid{}~\ocwupperid{WX}~\mid{}~\ocwupperid{KH}~\mid{}~\ocwupperid{SLP1}~\mid{}~\ocwupperid{Devanagari}~\mid{}~\ocwupperid{IAST}~]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{to\_string}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Velthuis}~\rightarrow{}~$\ocwstring{"VH"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{WX}~\rightarrow{}~$\ocwstring{"WX"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{KH}~\rightarrow{}~$\ocwstring{"KH"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{SLP1}~\rightarrow{}~$\ocwstring{"SL"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Devanagari}~\rightarrow{}~$\ocwstring{"deva"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{IAST}~\rightarrow{}~$\ocwstring{"roma"}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{of\_string}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~$\ocwstring{"VH"}~$\rightarrow{}~\ocwupperid{Velthuis}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"WX"}~$\rightarrow{}~\ocwupperid{WX}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"KH"}~$\rightarrow{}~\ocwupperid{KH}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"SL"}~$\rightarrow{}~\ocwupperid{SLP1}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"deva"}~$\rightarrow{}~\ocwupperid{Devanagari}$\ocweol
\ocwindent{2.00em}
$\mid{}~$\ocwstring{"roma"}~$\rightarrow{}~\ocwupperid{IAST}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Velthuis}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{encode}~\ocwlowerid{encoding}~=~\ocwlowerid{encoding}~|\ensuremath{>}~\ocwlowerid{to\_string}~|\ensuremath{>}~\ocwupperid{Encode.}\ocwlowerid{switch\_code}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{decode}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Velthuis}~\mid{}~\ocwupperid{WX}~\mid{}~\ocwupperid{KH}~\mid{}~\ocwupperid{SLP1}~$\ocwkw{as}~$\ocwlowerid{encoding}~\rightarrow{}$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{encoding}~|\ensuremath{>}~\ocwlowerid{to\_string}~|\ensuremath{>}~\ocwupperid{Canon.}\ocwlowerid{switch\_decode}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Devanagari}~\rightarrow{}~\ocwupperid{Canon.}\ocwlowerid{unidevcode}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{IAST}~\rightarrow{}~\ocwupperid{Canon.}\ocwlowerid{uniromcode}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} What about metadata (date, author, history...) ?  \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Sentence}~:~$\ocwkw{sig}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{make}~:~$\ocwbt{int}~$\rightarrow{}~$\ocwbt{list}~$\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~$\ocwbt{bool}~$\rightarrow{}~\ocwupperid{Analysis.}\ocwlowerid{t}~\rightarrow{}~\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{id}~:~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{int}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{text}~:~\ocwupperid{Encoding.}\ocwlowerid{t}~\rightarrow{}~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{analysis}~:~\ocwlowerid{t}~\rightarrow{}~\ocwupperid{Analysis.}\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{compare}~:~\ocwlowerid{t}~\rightarrow{}~\ocwlowerid{t}~\rightarrow{}~$\ocwbt{int}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}~=~\ocwkw{struct}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{t}~=$\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{id}~:~$\ocwbt{int}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{text}~:~$\ocwbt{list}~$\ocwupperid{Word.}\ocwlowerid{word}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{unsandhied}~:~$\ocwbt{bool}\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{analysis}~:~\ocwupperid{Analysis.}\ocwlowerid{t}$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{make}~\ocwlowerid{id}~\ocwlowerid{text}~\ocwlowerid{unsandhied}~\ocwlowerid{analysis}~=$\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{id}~=~\ocwlowerid{id}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{text}~=~\ocwlowerid{text}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{unsandhied}~=~\ocwlowerid{unsandhied}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{analysis}~=~\ocwlowerid{analysis}$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{id}~\ocwlowerid{s}~=~\ocwlowerid{s.}\ocwlowerid{id}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{text}~\ocwlowerid{encoding}~\ocwlowerid{s}~=$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{s.}\ocwlowerid{text}~|\ensuremath{>}~\ocwupperid{List.}\ocwlowerid{map}~(\ocwupperid{Encoding.}\ocwlowerid{decode}~\ocwlowerid{encoding})~|\ensuremath{>}~\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{"\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{unsandhied}~\ocwlowerid{s}~=~\ocwlowerid{s.}\ocwlowerid{unsandhied}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{analysis}~\ocwlowerid{s}~=~\ocwlowerid{s.}\ocwlowerid{analysis}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{compare}~\ocwlowerid{s}~\ocwlowerid{s'}~=~\ocwlowerid{compare}~(\ocwlowerid{id}~\ocwlowerid{s})~(\ocwlowerid{id}~\ocwlowerid{s'})$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~\ocwkw{type}~$\ocwupperid{Location}~=~$\ocwkw{sig}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{path}~:~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~\ocwkw{type}~$\ocwupperid{S}~=~$\ocwkw{sig}\ocweol
\ocwindent{1.00em}
\ocwbc{} Contents of a corpus subdirectory: either we are on leaves of the
     tree (constructor \ocwbegindcode{}$\ocwupperid{Sentences}$\ocwenddcode{}) or on branches (constructor
     \ocwbegindcode{}$\ocwupperid{Sections}$\ocwenddcode{}).  \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{contents}~=$\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Empty}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Sections}~$\ocwkw{of}~\ocwbt{list}~$\ocwupperid{Section.}\ocwlowerid{t}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Sentences}~$\ocwkw{of}~\ocwbt{list}~$\ocwupperid{Sentence.}\ocwlowerid{t}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwbc{} List the contents of the given corpus subdirectory.  Note that the
     returned elements are sorted according to \ocwbegindcode{}$\ocwupperid{Section}.\ocwlowerid{compare}$\ocwenddcode{} or
     \ocwbegindcode{}$\ocwupperid{Sentence}.\ocwlowerid{compare}$\ocwenddcode{} depending on the case.  \ocwec{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{contents}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{contents}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwkw{exception}~$\ocwupperid{Sentence\_already\_exists}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{save\_sentence}~:$\ocweol
\ocwindent{2.00em}
\ocwbt{bool}~$\rightarrow{}~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{int}~$\rightarrow{}~$\ocwbt{list}~$\ocwupperid{Word.}\ocwlowerid{word}~\rightarrow{}~$\ocwbt{bool}~$\rightarrow{}~\ocwupperid{Analysis.}\ocwlowerid{t}~\rightarrow{}~$\ocwbt{unit}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwkw{exception}~$\ocwupperid{Section\_already\_exists}~$\ocwkw{of}~\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{mkdir}~:~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{unit}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwkw{exception}~$\ocwupperid{No\_such\_sentence}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{sentence}~:~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{int}~$\rightarrow{}~\ocwupperid{Sentence.}\ocwlowerid{t}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{permission}~=~[~\ocwupperid{Reader}~\mid{}~\ocwupperid{Annotator}~\mid{}~\ocwupperid{Manager}~]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{default\_permission}~:~\ocwlowerid{permission}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{string\_of\_permission}~:~\ocwlowerid{permission}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{permission\_of\_string}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{permission}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{url}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{permission}~\rightarrow{}~\ocwupperid{Sentence.}\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{relocatable\_url}~:~$\ocwbt{string}~$\rightarrow{}~\ocwlowerid{permission}~\rightarrow{}~\ocwupperid{Sentence.}\ocwlowerid{t}~\rightarrow{}~$\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{citation}~:~$\ocwbt{string}~$\rightarrow{}~$\ocwbt{int}~$\rightarrow{}~$\ocwbt{string}~\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{module}~$\ocwupperid{Make}~(\ocwupperid{Loc}~:~\ocwupperid{Location})~:~\ocwupperid{S}~=~$\ocwkw{struct}\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{contents}~=$\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Empty}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Sections}~$\ocwkw{of}~\ocwbt{list}~$\ocwupperid{Section.}\ocwlowerid{t}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Sentences}~$\ocwkw{of}~\ocwbt{list}~$\ocwupperid{Sentence.}\ocwlowerid{t}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~(~/$\^{}~$)~=~\ocwupperid{Filename.}\ocwlowerid{concat}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~(~$\~{}/~$)~\ocwlowerid{file}~=~\ocwupperid{Loc.}\ocwlowerid{path}~/$\^{}~$\ocwlowerid{file}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{sentence\_ext}~=~$\ocwstring{"rem"}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{sentence\_file}~\ocwlowerid{subdir}~\ocwlowerid{id}~=$\ocweol
\ocwindent{2.00em}
\~{}/$\ocwlowerid{subdir}~/$\^{}~$\ocwupperid{Printf.}\ocwlowerid{sprintf}~$\ocwstring{"\%d.\%s"}~$\ocwlowerid{id}~\ocwlowerid{sentence\_ext}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwkw{exception}~$\ocwupperid{No\_such\_sentence}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{sentence}~\ocwlowerid{subdir}~\ocwlowerid{id}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{file}~=~\ocwlowerid{sentence\_file}~\ocwlowerid{subdir}~\ocwlowerid{id}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwupperid{Sys.}\ocwlowerid{file\_exists}~\ocwlowerid{file}~$\ocwkw{then}~$(\ocwupperid{Gen.}\ocwlowerid{gobble}~\ocwlowerid{file}~:~\ocwupperid{Sentence.}\ocwlowerid{t})~$\ocweol
\ocwindent{14.00em}
\ocwkw{else}~$\ocwlowerid{raise}~\ocwupperid{No\_such\_sentence}~$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{contents}~\ocwlowerid{subdir}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{subdir}~=~$\~{}/$\ocwlowerid{subdir}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwupperid{Dir.}\ocwlowerid{subdirs}~\ocwlowerid{subdir}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{sentences}~=$\ocweol
\ocwindent{4.00em}
$\ocwlowerid{subdir}$\ocweol
\ocwindent{4.00em}
|\ensuremath{>}~$\ocwupperid{Dir.}\ocwlowerid{files\_with\_ext}~\ocwlowerid{sentence\_ext}$\ocweol
\ocwindent{4.00em}
|\ensuremath{>}~$\ocwupperid{List.}\ocwlowerid{map}~($\ocwkw{fun}~$\ocwlowerid{x}~\rightarrow{}~(\ocwupperid{Gen.}\ocwlowerid{gobble}~(\ocwlowerid{subdir}~/$\^{}~$\ocwlowerid{x})~:~\ocwupperid{Sentence.}\ocwlowerid{t}))$\ocweol
\ocwindent{4.00em}
|\ensuremath{>}~$\ocwupperid{List.}\ocwlowerid{sort}~\ocwupperid{Sentence.}\ocwlowerid{compare}$\ocweol
\ocwindent{3.00em}
\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwlowerid{sentences}~$\ocwkw{with}~$[~[\,]~\rightarrow{}~\ocwupperid{Empty}~\mid{}~\ocwlowerid{sentences}~\rightarrow{}~\ocwupperid{Sentences}~\ocwlowerid{sentences}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{subdirs}~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{sections}~=$\ocweol
\ocwindent{4.00em}
$\ocwlowerid{subdirs}$\ocweol
\ocwindent{4.00em}
|\ensuremath{>}~$\ocwupperid{List.}\ocwlowerid{map}~\ocwupperid{Section.}\ocwlowerid{make}$\ocweol
\ocwindent{4.00em}
|\ensuremath{>}~$\ocwupperid{List.}\ocwlowerid{sort}~\ocwupperid{Section.}\ocwlowerid{compare}$\ocweol
\ocwindent{3.00em}
\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwupperid{Sections}~\ocwlowerid{sections}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{metadata\_file}~\ocwlowerid{dir}~\ocwlowerid{id}~=~$\~{}/$\ocwlowerid{dir}~/$\^{}~\ocwstring{"."}~\^{}~$\ocwlowerid{string\_of\_int}~\ocwlowerid{id}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwkw{exception}~$\ocwupperid{Sentence\_already\_exists}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{save\_sentence}~\ocwlowerid{force}~\ocwlowerid{dir}~\ocwlowerid{id}~\ocwlowerid{text}~\ocwlowerid{unsandhied}~\ocwlowerid{analysis}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{file}~=~\ocwlowerid{sentence\_file}~\ocwlowerid{dir}~\ocwlowerid{id}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{sentence}~=~\ocwupperid{Sentence.}\ocwlowerid{make}~\ocwlowerid{id}~\ocwlowerid{text}~\ocwlowerid{unsandhied}~\ocwlowerid{analysis}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\lnot{}~\ocwlowerid{force}~\land{}~\ocwupperid{Sys.}\ocwlowerid{file\_exists}~\ocwlowerid{file}~$\ocwkw{then}~$\ocwlowerid{raise}~\ocwupperid{Sentence\_already\_exists}~$\ocweol
\ocwindent{20.50em}
\ocwkw{else}~$\ocwupperid{Gen.}\ocwlowerid{dump}~\ocwlowerid{sentence}~\ocwlowerid{file}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwkw{exception}~$\ocwupperid{Section\_already\_exists}~$\ocwkw{of}~\ocwbt{string}\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{mkdir}~\ocwlowerid{dirname}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{try}~$\ocwupperid{Unix.}\ocwlowerid{mkdir}~$\~{}/$\ocwlowerid{dirname}~\ocwoctconst{755}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Unix.Unix\_error}~(\ocwupperid{Unix.EEXIST},~\ocwlowerid{\_},~\ocwlowerid{\_})~\rightarrow{}$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{raise}~(\ocwupperid{Section\_already\_exists}~(\ocwupperid{Filename.}\ocwlowerid{basename}~\ocwlowerid{dirname}))~$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
\ocwkw{type}~$\ocwlowerid{permission}~=~[~\ocwupperid{Reader}~\mid{}~\ocwupperid{Annotator}~\mid{}~\ocwupperid{Manager}~]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{default\_permission}~=~\ocwupperid{Reader}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{string\_of\_permission}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Reader}~\rightarrow{}~$\ocwstring{"reader"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Annotator}~\rightarrow{}~$\ocwstring{"annotator"}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Manager}~\rightarrow{}~$\ocwstring{"manager"}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{restrict\_permission}~\ocwlowerid{perm}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwupperid{Html.}\ocwlowerid{target}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Html.Server}~\rightarrow{}~\ocwupperid{Reader}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Html.Simputer}~\mid{}~\ocwupperid{Html.Computer}~\mid{}~\ocwupperid{Html.Station}~\rightarrow{}~\ocwlowerid{perm}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{permission\_of\_string}~\ocwlowerid{s}~=~\ocwlowerid{s}~|\ensuremath{>}~\ocwlowerid{to\_perm}~|\ensuremath{>}~\ocwlowerid{restrict\_permission}$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{where}~\ocwlowerid{to\_perm}~=~$\ocwkw{fun}\ocweol
\ocwindent{3.00em}
$[~$\ocwstring{"annotator"}~$\rightarrow{}~\ocwupperid{Annotator}$\ocweol
\ocwindent{3.00em}
$\mid{}~$\ocwstring{"manager"}~$\rightarrow{}~\ocwupperid{Manager}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{Reader}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{url}~\ocwlowerid{dir}~\ocwlowerid{permission}~\ocwlowerid{sentence}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{analysis}~=~\ocwupperid{Sentence.}\ocwlowerid{analysis}~\ocwlowerid{sentence}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{encoding}~=~\ocwupperid{Encoding.}\ocwlowerid{of\_string}~\ocwupperid{Paths.}\ocwlowerid{default\_transliteration}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{env}~=$\ocweol
\ocwindent{3.00em}
$[~(\ocwupperid{Params.}\ocwlowerid{corpus\_permission},~\ocwlowerid{string\_of\_permission}~\ocwlowerid{permission})$\ocweol
\ocwindent{3.00em}
;~$($\ocwstring{"text"},~$\ocwupperid{Sentence.}\ocwlowerid{text}~\ocwlowerid{encoding}~\ocwlowerid{sentence})$\ocweol
\ocwindent{3.00em}
;~$($\ocwstring{"cpts"},~$\ocwupperid{Analysis.}\ocwlowerid{checkpoints}~\ocwlowerid{analysis})$\ocweol
\ocwindent{3.00em}
;~$(\ocwupperid{Params.}\ocwlowerid{corpus\_dir},~\ocwlowerid{dir})$\ocweol
\ocwindent{3.00em}
;~$(\ocwupperid{Params.}\ocwlowerid{sentence\_no},~\ocwlowerid{sentence}~|\ensuremath{>}~\ocwupperid{Sentence.}\ocwlowerid{id}~|\ensuremath{>}~\ocwlowerid{string\_of\_int})$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{path}~=$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{analysis}$\ocweol
\ocwindent{3.00em}
|\ensuremath{>}~$\ocwupperid{Analysis.}\ocwlowerid{analyzer}$\ocweol
\ocwindent{3.00em}
|\ensuremath{>}~$\ocwupperid{Analyzer.}\ocwlowerid{path}$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwupperid{Cgi.}\ocwlowerid{url}~\ocwlowerid{path}~$\~{}$\ocwlowerid{query}:(\ocwupperid{Cgi.}\ocwlowerid{query\_of\_env}~\ocwlowerid{env})$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{1.00em}
$\ocwlowerid{value}~\ocwlowerid{relocatable\_url}~\ocwlowerid{dir}~\ocwlowerid{permission}~\ocwlowerid{sentence}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{analysis}~=~\ocwupperid{Sentence.}\ocwlowerid{analysis}~\ocwlowerid{sentence}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{env}~=$\ocweol
\ocwindent{3.00em}
$[~(\ocwupperid{Params.}\ocwlowerid{corpus\_permission},~\ocwlowerid{string\_of\_permission}~\ocwlowerid{permission})$\ocweol
\ocwindent{3.00em}
;~$($\ocwstring{"text"},~$\ocwupperid{Sentence.}\ocwlowerid{text}~\ocwupperid{Encoding.Velthuis}~\ocwlowerid{sentence})$\ocweol
\ocwindent{3.00em}
;~$($\ocwstring{"t"},~$\ocwupperid{Encoding}.(\ocwlowerid{to\_string}~\ocwupperid{Velthuis}))$\ocweol
\ocwindent{3.00em}
;~$($\ocwstring{"cpts"},~$\ocwupperid{Analysis.}\ocwlowerid{checkpoints}~\ocwlowerid{analysis})$\ocweol
\ocwindent{3.00em}
;~$(\ocwupperid{Params.}\ocwlowerid{corpus\_dir},~\ocwlowerid{dir})$\ocweol
\ocwindent{3.00em}
;~$(\ocwupperid{Params.}\ocwlowerid{sentence\_no},~\ocwlowerid{sentence}~|\ensuremath{>}~\ocwupperid{Sentence.}\ocwlowerid{id}~|\ensuremath{>}~\ocwlowerid{string\_of\_int})$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{path}~=$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{analysis}$\ocweol
\ocwindent{3.00em}
|\ensuremath{>}~$\ocwupperid{Analysis.}\ocwlowerid{analyzer}$\ocweol
\ocwindent{3.00em}
|\ensuremath{>}~$\ocwupperid{Analyzer.}\ocwlowerid{relocatable\_path}$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwupperid{Cgi.}\ocwlowerid{url}~\ocwlowerid{path}~$\~{}$\ocwlowerid{query}:(\ocwupperid{Cgi.}\ocwlowerid{query\_of\_env}~\ocwlowerid{env})$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{citation}~\ocwlowerid{subdir}~\ocwlowerid{id}~=$\ocweol
\ocwindent{1.50em}
$\ocwlowerid{relocatable\_url}~\ocwlowerid{subdir}~\ocwupperid{Reader}~(\ocwlowerid{sentence}~\ocwlowerid{subdir}~\ocwlowerid{id})$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwkw{end}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Web_corpus.mli}
\ocwinterface{Web\_corpus}
\label{web_corpus.mli:0}%
\label{web_corpus.mli:619}%
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{include}~$\ocwupperid{Corpus.S}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Web_corpus.ml}
\ocwmodule{Web\_corpus}
\label{web_corpus.ml:0}%
\label{web_corpus.ml:619}%
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{include}~$\ocwupperid{Corpus.Make}~($\ocwkw{struct}~$\ocwlowerid{value}~\ocwlowerid{path}~=~\ocwupperid{Paths.}\ocwlowerid{public\_skt\_dir}~$\^{}~\ocwstring{"CORPUS"};~\ocwkw{end}$)$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Corpus_manager.mli}
\ocwinterface{Corpus\_manager}
\label{corpus_manager.mli:0}%
Generation of corpus manager's pages 
\ocweol
\ocwindent{0.00em}
Generate the page displaying a view of the given corpus subdirectory.
   The output channel is as always either \ocwbegindcode{}$\ocwlowerid{stdout}$\ocwenddcode{} for CGI output or
   a static HTML file (according to the "magic switch"
   \ocwbegindcode{}$\ocwupperid{Web}.\ocwlowerid{output\_channel}$\ocwenddcode{}). NB: No error handling is done by this function.  
\ocweol
\label{corpus_manager.mli:937}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{mk\_page}~:~$\ocwbt{string}~$\rightarrow{}~\ocwupperid{Web\_corpus.}\ocwlowerid{permission}~\rightarrow{}~$\ocwbt{unit}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Corpus_manager.ml}
\ocwmodule{Corpus\_manager}
\label{corpus_manager.ml:0}%
\label{corpus_manager.ml:619}%
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};$\medskip

\ocwendcode{}\ocwindent{0.00em}
Utilities 
\ocweol
\ocwindent{0.00em}
Type representing interval of missing integers in a sorted list.  
\ocweol
\label{corpus_manager.ml:761}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{type}~$\ocwlowerid{gap}~=~\{~\ocwlowerid{start}~:~$\ocwbt{int};~$\ocwlowerid{stop}~:~$\ocwbt{int}~\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} The following functions assume that the given list is sorted in
   increasing order and represents a subset of positive integers. 
   In particular, the lowest bound of a gap is at least \ocwbegindcode{}1\ocwenddcode{} and the
   greatest at most \ocwbegindcode{}$\ocwlowerid{max\_int}$\ocwenddcode{}). We call \ocwstring{"group"} a list of consecutive
   integers.  \ocwec{}\medskip

\label{corpus_manager.ml:1092}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{max\_gap}~=~\{~\ocwlowerid{start}~=~1;~\ocwlowerid{stop}~=~\ocwlowerid{max\_int}~\}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{string\_of\_gap}~\ocwlowerid{gap}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{gap.}\ocwlowerid{stop}~=~\ocwlowerid{max\_int}~$\ocwkw{then}\ocweol
\ocwindent{2.00em}
$\ocwupperid{Printf.}\ocwlowerid{sprintf}~$\ocwstring{"\ensuremath{>}\ocwvspace{}\%d"}~$(\ocwlowerid{gap.}\ocwlowerid{start}~-~1)$\ocweol
\ocwindent{1.00em}
\ocwkw{else}\ocweol
\ocwindent{2.00em}
$\ocwupperid{Printf.}\ocwlowerid{sprintf}~$\ocwstring{"\%d\ocwvspace{}\symbol{45}\ocwvspace{}\%d"}~$\ocwlowerid{gap.}\ocwlowerid{start}~\ocwlowerid{gap.}\ocwlowerid{stop}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Return a triple \ocwbegindcode{}$(\ocwlowerid{g},~\ocwlowerid{gap},~\ocwlowerid{rest})$\ocwenddcode{} where \ocwbegindcode{}$\ocwlowerid{g}$\ocwenddcode{} is the first group of the
   given list, \ocwbegindcode{}$\ocwlowerid{gap}$\ocwenddcode{} the gap to the next group and \ocwbegindcode{}$\ocwlowerid{rest}$\ocwenddcode{} the given
   list without its first group.  \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~$\ocwkw{rec}~$\ocwlowerid{first\_group}~=~$\ocwkw{fun}\ocweol
\ocwindent{1.00em}
$[~[~\ocwlowerid{x}~::~([~\ocwlowerid{y}~::~\ocwlowerid{\_}~]~$\ocwkw{as}~$\ocwlowerid{t})~]~\rightarrow{}$\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwlowerid{y}~=~\ocwlowerid{x}~+~1~$\ocwkw{then}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$(\ocwlowerid{group},~\ocwlowerid{gap},~\ocwlowerid{rest})~=~\ocwlowerid{first\_group}~\ocwlowerid{t}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$([~\ocwlowerid{x}~::~\ocwlowerid{group}~],~\ocwlowerid{gap},~\ocwlowerid{rest})$\ocweol
\ocwindent{2.00em}
\ocwkw{else}\ocweol
\ocwindent{3.00em}
$([~\ocwlowerid{x}~],~\{~\ocwlowerid{start}~=~\ocwlowerid{x}~+~1;~\ocwlowerid{stop}~=~\ocwlowerid{y}~-~1~\},~\ocwlowerid{t})$\ocweol
\ocwindent{1.00em}
$\mid{}~[\,]~\rightarrow{}~([\,],~\ocwlowerid{max\_gap},~[\,])$\ocweol
\ocwindent{1.00em}
$\mid{}~[~\ocwlowerid{x}~]~$\ocwkw{as}~$\ocwlowerid{l}~\rightarrow{}$\ocweol
\ocwindent{2.00em}
$(\ocwlowerid{l},~\{~\ocwlowerid{start}~=~\ocwlowerid{x}~+~1;~\ocwlowerid{stop}~=~\ocwlowerid{max\_int}~\},~[\,])$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{groups\_with\_gaps}~\ocwlowerid{l}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{aux}~\ocwlowerid{l}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$(\ocwlowerid{group},~\ocwlowerid{gap},~\ocwlowerid{rest})~=~\ocwlowerid{first\_group}~\ocwlowerid{l}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{group\_gap}~=~(\ocwlowerid{group},~\ocwlowerid{gap})~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwlowerid{rest}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~[~\ocwlowerid{group\_gap}~]$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~[~\ocwlowerid{group\_gap}~::~\ocwlowerid{aux}~\ocwlowerid{rest}~]$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{aux}~\ocwlowerid{l}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_init\_gap}~\ocwlowerid{groups}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{init\_gap}~=~$\ocwkw{fun}\ocweol
\ocwindent{2.00em}
$[~[~([~\ocwlowerid{x}~::~\ocwlowerid{\_}~],~\ocwlowerid{\_})~::~\ocwlowerid{\_}~]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwlowerid{x}~\not=~1~$\ocwkw{then}~$\ocwupperid{Some}~\{~\ocwlowerid{start}~=~1;~\ocwlowerid{stop}~=~\ocwlowerid{x}~-~1~\}~$\ocwkw{else}~$\ocwupperid{None}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwupperid{None}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{init\_gap}~\ocwlowerid{groups}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{None}~\rightarrow{}~\ocwlowerid{groups}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Some}~\ocwlowerid{gap}~\rightarrow{}~[~([\,],~\ocwlowerid{gap})~::~\ocwlowerid{groups}~]$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{}*****************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Page generation \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}*****************\ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{big}~\ocwlowerid{text}~=~\ocwlowerid{div}~\ocwupperid{Latin16}~\ocwlowerid{text}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{link}~\ocwlowerid{permission}~\ocwlowerid{dir}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{url}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{query}~=$\ocweol
\ocwindent{3.00em}
$\ocwupperid{Cgi.}\ocwlowerid{query\_of\_env}$\ocweol
\ocwindent{4.00em}
$[~(\ocwupperid{Params.}\ocwlowerid{corpus\_dir},~\ocwlowerid{dir})$\ocweol
\ocwindent{4.00em}
;~$(\ocwupperid{Params.}\ocwlowerid{corpus\_permission},~\ocwupperid{Web\_corpus.}\ocwlowerid{string\_of\_permission}~\ocwlowerid{permission})$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwupperid{Cgi.}\ocwlowerid{url}~\ocwlowerid{corpus\_manager\_cgi}~$\~{}$\ocwlowerid{query}~|\ensuremath{>}~\ocwlowerid{escape}$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{label}~=~\ocwupperid{Filename.}\ocwlowerid{basename}~\ocwlowerid{dir}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{anchor\_ref}~\ocwlowerid{url}~\ocwlowerid{label}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{uplinks}~\ocwlowerid{dir}~\ocwlowerid{permission}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{aux}~\ocwlowerid{dir}~=$\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$\ocwlowerid{updirs}~=~\ocwupperid{Dir.}\ocwlowerid{split}~\ocwlowerid{dir}~$\ocwkw{in}\ocweol
\ocwindent{1.50em}
\ocwkw{let}~$\ocwlowerid{updirs}~=$\ocweol
\ocwindent{2.50em}
$\ocwupperid{List.}\ocwlowerid{mapi}~($\ocwkw{fun}~$\ocwlowerid{i}~\ocwlowerid{x}~\rightarrow{}$\ocweol
\ocwindent{4.50em}
$\ocwupperid{String.}\ocwlowerid{concat}~\ocwupperid{Filename.}\ocwlowerid{dir\_sep}~(\ocwupperid{List2.}\ocwlowerid{take\_prefix}~(\ocwlowerid{i}~+~1)~\ocwlowerid{updirs})$\ocweol
\ocwindent{3.50em}
$)~\ocwlowerid{updirs}$\ocweol
\ocwindent{1.50em}
\ocwkw{in}\ocweol
\ocwindent{1.50em}
$\ocwupperid{List.}\ocwlowerid{map}~(\ocwlowerid{link}~\ocwlowerid{permission})~\ocwlowerid{updirs}$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{uplinks\_str}~=$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{dir}$\ocweol
\ocwindent{2.00em}
|\ensuremath{>}~$\ocwlowerid{aux}$\ocweol
\ocwindent{2.00em}
|\ensuremath{>}~$\ocwupperid{String.}\ocwlowerid{concat}~$\ocwstring{"\ocwvspace{}/\ocwvspace{}"}\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{final\_sep}~=~$\ocwkw{if}~$\ocwlowerid{uplinks\_str}~\not=~$\ocwstring{""}~\ocwkw{then}~\ocwstring{"\ocwvspace{}/\ocwvspace{}"}~\ocwkw{else}~\ocwstring{""}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{uplinks\_str}~$\^{}~$\ocwlowerid{final\_sep}$\medskip

\label{corpus_manager.ml:3147}%
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{} Display sentences with format \ocwstring{"sentence\ocwvspace{}||\ocwvspace{}sentno"} like in citations
   file.  \ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{sentence\_links}~\ocwlowerid{dir}~\ocwlowerid{permission}~\ocwlowerid{sentences}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{to\_anchor\_ref}~\ocwlowerid{sentence}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{font}~=~\ocwupperid{Multilingual.}\ocwlowerid{font\_of\_string}~\ocwupperid{Paths.}\ocwlowerid{default\_display\_font}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{encoding}~=$\ocweol
\ocwindent{4.00em}
\ocwkw{match}~$\ocwlowerid{font}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Multilingual.Deva}~\rightarrow{}~\ocwupperid{Corpus.Encoding.Devanagari}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Multilingual.Roma}~\rightarrow{}~\ocwupperid{Corpus.Encoding.IAST}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{text}~=~\ocwupperid{Corpus.Sentence.}\ocwlowerid{text}~\ocwlowerid{encoding}~\ocwlowerid{sentence}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{display}~=$\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwlowerid{font}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Multilingual.Deva}~\rightarrow{}~\ocwlowerid{deva16\_blue}$\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Multilingual.Roma}~\rightarrow{}~\ocwlowerid{span}~\ocwupperid{Trans16}$\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{text}$\ocweol
\ocwindent{2.00em}
|\ensuremath{>}~$\ocwlowerid{anchor\_ref}~(\ocwlowerid{sentence}~|\ensuremath{>}~\ocwupperid{Web\_corpus.}\ocwlowerid{url}~\ocwlowerid{dir}~\ocwlowerid{permission}~|\ensuremath{>}~\ocwlowerid{escape})$\ocweol
\ocwindent{2.00em}
|\ensuremath{>}~$\ocwlowerid{display}$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{map}~\ocwlowerid{to\_anchor\_ref}~\ocwlowerid{sentences}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{section\_selection}~\ocwlowerid{dir}~\ocwlowerid{sections}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{options}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{prefixes}~=$\ocweol
\ocwindent{3.00em}
$\ocwupperid{List.}\ocwlowerid{map}~($\ocwkw{fun}~$\ocwlowerid{x}~\rightarrow{}~\ocwupperid{Filename.}\ocwlowerid{concat}~\ocwlowerid{dir}~\ocwlowerid{x})~\ocwlowerid{sections}$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwupperid{List.}\ocwlowerid{combine}~\ocwlowerid{prefixes}~\ocwlowerid{sections}$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{option\_select\_label}~\ocwupperid{Params.}\ocwlowerid{corpus\_dir}~\ocwlowerid{options}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{add\_sentence\_form}~\ocwlowerid{dir}~\ocwlowerid{permission}~\ocwlowerid{gap}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{cgi\_begin}~(\ocwlowerid{cgi\_bin}~$\ocwstring{"skt\_heritage"}$)~$\ocwstring{""}~\^{}\ocweol
\ocwindent{1.00em}
\ocwstring{"Add\ocwvspace{}sentence:\ocwvspace{}"}~\^{}~$\ocwlowerid{uplinks}~\ocwlowerid{dir}~\ocwlowerid{permission}~$\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{hidden\_input}~\ocwupperid{Params.}\ocwlowerid{corpus\_dir}~\ocwlowerid{dir}~$\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{hidden\_input}~\ocwupperid{Params.}\ocwlowerid{corpus\_permission}~(\ocwupperid{Web\_corpus.}\ocwlowerid{string\_of\_permission}~\ocwlowerid{permission})~$\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{int\_input}~\ocwupperid{Params.}\ocwlowerid{sentence\_no}$\ocweol
\ocwindent{2.00em}
\~{}$\ocwlowerid{step}:1$\ocweol
\ocwindent{2.00em}
\~{}$\ocwlowerid{min}:\ocwlowerid{gap.}\ocwlowerid{start}$\ocweol
\ocwindent{2.00em}
\~{}$\ocwlowerid{max}:\ocwlowerid{gap.}\ocwlowerid{stop}$\ocweol
\ocwindent{2.00em}
\~{}\ocwkw{val}:$\ocwlowerid{gap.}\ocwlowerid{start}$\ocweol
\ocwindent{2.00em}
\~{}$\ocwlowerid{id}:\ocwupperid{Params.}\ocwlowerid{sentence\_no}~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{submit\_input}~$\ocwstring{"Add"}\ocweol
\ocwindent{1.00em}
\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{cgi\_end}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{htmlify\_group}~\ocwlowerid{dir}~\ocwlowerid{permission}~(\ocwlowerid{group},~\ocwlowerid{gap})~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$(\ocwlowerid{ol},~\ocwlowerid{group\_id})~=$\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwlowerid{group}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~[\,]~\rightarrow{}~($\ocwstring{""},~\ocwstring{""}$)$\ocweol
\ocwindent{2.00em}
$\mid{}~[~\ocwlowerid{h}~::~\ocwlowerid{\_}~]~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{id}~=~\ocwupperid{Corpus.Sentence.}\ocwlowerid{id}~\ocwlowerid{h}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{group\_id}~=~\ocwlowerid{string\_of\_int}~\ocwlowerid{id}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{ol}~$\~{}$\ocwlowerid{li\_id\_prefix}:$\ocwstring{""}~\~{}$\ocwlowerid{start}:\ocwlowerid{id}~(\ocwlowerid{sentence\_links}~\ocwlowerid{dir}~\ocwlowerid{permission}~\ocwlowerid{group}),$\ocweol
\ocwindent{3.50em}
$\ocwlowerid{group\_id})$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{div\_id}~=~$\ocwstring{"group"}~\^{}~$\ocwlowerid{group\_id}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{add\_sentence\_form}~=$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{button}$\ocweol
\ocwindent{3.00em}
\~{}$\ocwlowerid{id}:$\ocwstring{"add\_sentence"}\ocweol
\ocwindent{3.00em}
\~{}$\ocwlowerid{onclick}:\{~\ocwlowerid{js\_funid}~=~$\ocwstring{"hideShowElement"}~;~$\ocwlowerid{js\_funargs}~=~[~\ocwlowerid{div\_id}~]~\}$\ocweol
\ocwindent{3.00em}
$(\ocwlowerid{string\_of\_gap}~\ocwlowerid{gap})~$\^{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{elt\_begin\_attrs}~[~($\ocwstring{"id"},~$\ocwlowerid{div\_id})~]~$\ocwstring{"div"}~$\ocwupperid{Hidden\_}~$\^{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{html\_paragraph}~$\^{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{add\_sentence\_form}~\ocwlowerid{dir}~\ocwlowerid{permission}~\ocwlowerid{gap}~$\^{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{div\_end}$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{ol}~$\^{}~\ocwkw{if}~$\ocwlowerid{permission}~=~\ocwupperid{Web\_corpus.Annotator}~$\ocwkw{then}~$\ocwlowerid{add\_sentence\_form}~$\ocwkw{else}~\ocwstring{""}\medskip

\label{corpus_manager.ml:5281}%
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{group\_sentences}~\ocwlowerid{dir}~\ocwlowerid{sentences}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{ids}~=~\ocwupperid{List.}\ocwlowerid{map}~\ocwupperid{Corpus.Sentence.}\ocwlowerid{id}~\ocwlowerid{sentences}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{dict}~=~\ocwupperid{List.}\ocwlowerid{combine}~\ocwlowerid{ids}~\ocwlowerid{sentences}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{groups}~=~\ocwlowerid{ids}~|\ensuremath{>}~\ocwlowerid{groups\_with\_gaps}~|\ensuremath{>}~\ocwlowerid{add\_init\_gap}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{List.}\ocwlowerid{map}~($\ocwkw{fun}~$(\ocwlowerid{x},~\ocwlowerid{y})~\rightarrow{}~(\ocwupperid{List.}\ocwlowerid{map}~($\ocwkw{fun}~$\ocwlowerid{x}~\rightarrow{}~\ocwupperid{List.}\ocwlowerid{assoc}~\ocwlowerid{x}~\ocwlowerid{dict})~\ocwlowerid{x},~\ocwlowerid{y}))~\ocwlowerid{groups}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{new\_section\_form}~\ocwlowerid{dir}~\ocwlowerid{permission}~=$\ocweol
\ocwindent{1.00em}
$\ocwlowerid{cgi\_begin}~\ocwlowerid{mkdir\_corpus\_cgi}~$\ocwstring{""}~\^{}\ocweol
\ocwindent{1.00em}
\ocwstring{"New\ocwvspace{}section:\ocwvspace{}"}~\^{}~$\ocwlowerid{uplinks}~\ocwlowerid{dir}~\ocwlowerid{permission}~$\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{hidden\_input}~\ocwupperid{Mkdir\_corpus\_params.}\ocwlowerid{parent\_dir}~\ocwlowerid{dir}~$\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{hidden\_input}~\ocwupperid{Mkdir\_corpus\_params.}\ocwlowerid{permission}~(\ocwupperid{Web\_corpus.}\ocwlowerid{string\_of\_permission}~\ocwlowerid{permission})~$\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{text\_input}~$\ocwstring{"new\_section"}~$\ocwupperid{Mkdir\_corpus\_params.}\ocwlowerid{dirname}~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{submit\_input}~$\ocwstring{"Create"}\ocweol
\ocwindent{1.00em}
\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{cgi\_end}$\ocweol
\ocwindent{1.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{section\_selection\_form}~\ocwlowerid{dir}~\ocwlowerid{permission}~\ocwlowerid{sections}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{selection\_prompt}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{submit\_button\_label}~=~\ocwupperid{Web\_corpus}.($\ocweol
\ocwindent{3.00em}
\ocwkw{match}~$\ocwlowerid{permission}~$\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{Reader}~\rightarrow{}~$\ocwstring{"Read"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Annotator}~\rightarrow{}~$\ocwstring{"Annotate"}\ocweol
\ocwindent{3.00em}
$\mid{}~\ocwupperid{Manager}~\rightarrow{}~$\ocwstring{"Manage"}\ocweol
\ocwindent{3.00em}
$]$\ocweol
\ocwindent{2.00em}
$)$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{uplinks}~\ocwlowerid{dir}~\ocwlowerid{permission}~$\^{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{section\_selection}~\ocwlowerid{dir}~(\ocwupperid{List.}\ocwlowerid{map}~\ocwupperid{Corpus.Section.}\ocwlowerid{label}~\ocwlowerid{sections})~$\^{}~\ocwstring{"\ocwvspace{}"}~\^{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{submit\_input}~\ocwlowerid{submit\_button\_label}$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{cgi\_begin}~\ocwlowerid{corpus\_manager\_cgi}~$\ocwstring{""}~\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{big}~($\ocweol
\ocwindent{2.00em}
$\ocwlowerid{selection\_prompt}~$\^{}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{hidden\_input}~\ocwupperid{Params.}\ocwlowerid{corpus\_permission}~(\ocwupperid{Web\_corpus.}\ocwlowerid{string\_of\_permission}~\ocwlowerid{permission})$\ocweol
\ocwindent{1.00em}
$)~$\^{}\ocweol
\ocwindent{1.00em}
$\ocwlowerid{cgi\_end}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{body}~\ocwlowerid{dir}~\ocwlowerid{permission}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwupperid{Web\_corpus.}\ocwlowerid{contents}~\ocwlowerid{dir}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Web\_corpus.Empty}~\rightarrow{}$\ocweol
\ocwindent{2.00em}
\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{uplinks}~\ocwlowerid{dir}~\ocwlowerid{permission}~|\ensuremath{>}~\ocwlowerid{big}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{open\_page\_with\_margin}~30$\ocweol
\ocwindent{2.00em}
;~\ocwkw{match}~$\ocwlowerid{permission}~$\ocwkw{with}\ocweol
\ocwindent{4.00em}
$[~\ocwupperid{Web\_corpus.Reader}~\rightarrow{}~$\ocwstring{"Empty\ocwvspace{}corpus"}\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Web\_corpus.Annotator}~\rightarrow{}~\ocwlowerid{add\_sentence\_form}~\ocwlowerid{dir}~\ocwlowerid{permission}~\ocwlowerid{max\_gap}$\ocweol
\ocwindent{4.00em}
$\mid{}~\ocwupperid{Web\_corpus.Manager}~\rightarrow{}~\ocwlowerid{new\_section\_form}~\ocwlowerid{dir}~\ocwlowerid{permission}$\ocweol
\ocwindent{4.00em}
$]$\ocweol
\ocwindent{3.00em}
|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{close\_page\_with\_margin}~()$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Web\_corpus.Sentences}~\ocwlowerid{sentences}~\rightarrow{}$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{groups}~=~\ocwlowerid{group\_sentences}~\ocwlowerid{dir}~\ocwlowerid{sentences}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{uplinks}~\ocwlowerid{dir}~\ocwlowerid{permission}~|\ensuremath{>}~\ocwlowerid{big}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{open\_page\_with\_margin}~30$\ocweol
\ocwindent{2.00em}
;~\ocwkw{if}~$\ocwlowerid{permission}~=~\ocwupperid{Web\_corpus.Manager}~$\ocwkw{then}\ocweol
\ocwindent{4.00em}
\ocwstring{"No\ocwvspace{}action\ocwvspace{}available."}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{3.00em}
\ocwkw{else}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{groups}~|\ensuremath{>}~\ocwupperid{List.}\ocwlowerid{map}~(\ocwlowerid{htmlify\_group}~\ocwlowerid{dir}~\ocwlowerid{permission})~|\ensuremath{>}~\ocwupperid{List.}\ocwlowerid{iter}~\ocwlowerid{pl}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{close\_page\_with\_margin}~()$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Web\_corpus.Sections}~\ocwlowerid{sections}~\rightarrow{}$\ocweol
\ocwindent{2.00em}
\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwlowerid{center\_begin}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{section\_selection\_form}~\ocwlowerid{dir}~\ocwlowerid{permission}~\ocwlowerid{sections}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{html\_break}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{2.00em}
;~\ocwkw{if}~$\ocwlowerid{permission}~=~\ocwupperid{Web\_corpus.Manager}~$\ocwkw{then}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{new\_section\_form}~\ocwlowerid{dir}~\ocwlowerid{permission}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{3.00em}
\ocwkw{else}~$()$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{center\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{mk\_page}~\ocwlowerid{dir}~\ocwlowerid{permission}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{title\_str}~=$\ocweol
\ocwindent{2.00em}
\ocwstring{"Sanskrit\ocwvspace{}Corpus\ocwvspace{}"}~\^{}\ocweol
\ocwindent{2.00em}
$(\ocwlowerid{permission}~|\ensuremath{>}~\ocwupperid{Web\_corpus.}\ocwlowerid{string\_of\_permission}~|\ensuremath{>}~\ocwupperid{String.}\ocwlowerid{capitalize})$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{clickable\_title}~=$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{query}~=$\ocweol
\ocwindent{3.00em}
$\ocwupperid{Cgi.}\ocwlowerid{query\_of\_env}~[~(\ocwupperid{Params.}\ocwlowerid{corpus\_permission},~\ocwupperid{Web\_corpus.}\ocwlowerid{string\_of\_permission}~\ocwlowerid{permission})~]$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{title\_str}$\ocweol
\ocwindent{2.00em}
|\ensuremath{>}~$\ocwlowerid{anchor\_ref}~(\ocwupperid{Cgi.}\ocwlowerid{url}~\ocwlowerid{corpus\_manager\_cgi}~$\~{}$\ocwlowerid{query})$\ocweol
\ocwindent{2.00em}
|\ensuremath{>}~$\ocwlowerid{h1\_title}$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{maybe\_http\_header}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_begin}~(\ocwlowerid{title}~\ocwlowerid{title\_str})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{body\_begin}~\ocwupperid{Chamois\_back}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{open\_page\_with\_margin}~15$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{clickable\_title}~|\ensuremath{>}~\ocwlowerid{print\_title}~(\ocwupperid{Some}~\ocwlowerid{default\_language})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{body}~\ocwlowerid{dir}~\ocwlowerid{permission}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{close\_page\_with\_margin}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_end}~\ocwlowerid{default\_language}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Corpus_manager_cgi.ml}
\ocwmodule{Corpus\_manager\_cgi}
\label{corpus_manager_cgi.ml:0}%
CGI script \ocwbegindcode{}$\ocwlowerid{manager}$\ocwenddcode{} for corpus management, i.e. for listing and
   adding sentences of the corpus.  
\ocweol
\label{corpus_manager_cgi.ml:726}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{main}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{env}~=~\ocwupperid{Cgi.}\ocwlowerid{create\_env}~(\ocwupperid{Cgi.}\ocwlowerid{query\_string}~())~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{corpdir}~=~\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Params.}\ocwlowerid{corpus\_dir}~$\ocwstring{""}~$\ocwlowerid{env}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{permission}~=$\ocweol
\ocwindent{2.00em}
$\ocwupperid{Web\_corpus.}\ocwlowerid{permission\_of\_string}~(\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Params.}\ocwlowerid{corpus\_permission}~$\ocwstring{""}~$\ocwlowerid{env})$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{try}\ocweol
\ocwindent{2.00em}
$\ocwupperid{Corpus\_manager.}\ocwlowerid{mk\_page}~\ocwlowerid{corpdir}~\ocwlowerid{permission}$\ocweol
\ocwindent{1.00em}
\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Sys\_error}~\ocwlowerid{msg}~\rightarrow{}~\ocwupperid{Web.}\ocwlowerid{abort}~\ocwupperid{Html.}\ocwlowerid{default\_language}~\ocwupperid{Control.}\ocwlowerid{sys\_err\_mess}~\ocwlowerid{msg}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}$\ocweol
\ocwindent{2.00em}
$\ocwupperid{Web.}\ocwlowerid{abort}~\ocwupperid{Html.}\ocwlowerid{default\_language}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}$\ocweol
\ocwindent{3.00em}
\ocwstring{"Unexpected\ocwvspace{}anomaly"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Save_corpus_params.mli}
\ocwinterface{Save\_corpus\_params}
\label{save_corpus_params.mli:0}%
\label{save_corpus_params.mli:619}%
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{state}~:~$\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{force}~:~$\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{nb\_sols}~:~$\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Save_corpus_params.ml}
\ocwmodule{Save\_corpus\_params}
\label{save_corpus_params.ml:0}%
\label{save_corpus_params.ml:619}%
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{state}~=~$\ocwstring{"state"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{force}~=~$\ocwstring{"force"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{nb\_sols}~=~$\ocwstring{"nbsols"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Save_corpus_cgi.ml}
\ocwmodule{Save\_corpus\_cgi}
\label{save_corpus_cgi.ml:0}%
CGI script \ocwbegindcode{}$\ocwlowerid{save\_corpus}$\ocwenddcode{} for saving a sentence into the corpus.  
\ocweol
\label{save_corpus_cgi.ml:690}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Html};$\ocweol
\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};$\medskip

\label{save_corpus_cgi.ml:712}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{confirmation\_page}~\ocwlowerid{query}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{title\_str}~=~$\ocwstring{"Sanskrit\ocwvspace{}Corpus"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{env}~=~\ocwupperid{Cgi.}\ocwlowerid{create\_env}~\ocwlowerid{query}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{corpdir}~=~\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Params.}\ocwlowerid{corpus\_dir}~$\ocwstring{""}~$\ocwlowerid{env}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{corppermission}~=~\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Params.}\ocwlowerid{corpus\_permission}~$\ocwstring{""}~$\ocwlowerid{env}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{sentno}~=~\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Params.}\ocwlowerid{sentence\_no}~$\ocwstring{""}~$\ocwlowerid{env}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{confirmation\_msg}~=$\ocweol
\ocwindent{2.00em}
$\ocwupperid{Printf.}\ocwlowerid{sprintf}~$\ocwstring{"Confirm\ocwvspace{}changes\ocwvspace{}for\ocwvspace{}sentence\ocwvspace{}no.\ocwvspace{}\%s\ocwvspace{}of\ocwvspace{}\%s\ocwvspace{}?"}~$\ocwlowerid{sentno}~\ocwlowerid{corpdir}$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{specific\_url}~\ocwlowerid{path}~=~\ocwupperid{Cgi.}\ocwlowerid{url}~\ocwlowerid{path}~$\~{}$\ocwlowerid{fragment}:\ocwlowerid{sentno}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{maybe\_http\_header}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_begin}~(\ocwlowerid{title}~\ocwlowerid{title\_str})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{body\_begin}~\ocwupperid{Chamois\_back}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{open\_page\_with\_margin}~15$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{h1\_title}~\ocwlowerid{title\_str}~|\ensuremath{>}~\ocwlowerid{print\_title}~(\ocwupperid{Some}~\ocwlowerid{default\_language})$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{center\_begin}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{div}~\ocwupperid{Latin16}~\ocwlowerid{confirmation\_msg}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_break}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{cgi\_begin}~(\ocwlowerid{specific\_url}~\ocwlowerid{save\_corpus\_cgi})~$\ocwstring{""}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{hidden\_input}~\ocwupperid{Save\_corpus\_params.}\ocwlowerid{state}~(\ocwlowerid{escape}~\ocwlowerid{query})~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{hidden\_input}~\ocwupperid{Save\_corpus\_params.}\ocwlowerid{force}~(\ocwlowerid{string\_of\_bool}~\ocwupperid{True})~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{submit\_input}~$\ocwstring{"Yes"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{cgi\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{html\_break}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{cgi\_begin}~(\ocwlowerid{specific\_url}~\ocwlowerid{corpus\_manager\_cgi})~$\ocwstring{""}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{hidden\_input}~\ocwupperid{Params.}\ocwlowerid{corpus\_dir}~\ocwlowerid{corpdir}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{hidden\_input}~\ocwupperid{Params.}\ocwlowerid{corpus\_permission}~\ocwlowerid{corppermission}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{submit\_input}~$\ocwstring{"No"}~|\ensuremath{>}~$\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{cgi\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{center\_end}~|\ensuremath{>}~\ocwlowerid{pl}$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{close\_page\_with\_margin}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{page\_end}~\ocwlowerid{default\_language}~\ocwupperid{True}$\ocweol
\ocwindent{1.00em}
\}\medskip

\label{save_corpus_cgi.ml:2014}%
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{analysis\_of\_env}~\ocwlowerid{env}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{lang}~=$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{env}$\ocweol
\ocwindent{2.00em}
|\ensuremath{>}~$\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~$\ocwstring{"lex"}~$\ocwupperid{Paths.}\ocwlowerid{default\_lexicon}$\ocweol
\ocwindent{2.00em}
|\ensuremath{>}~$\ocwupperid{Html.}\ocwlowerid{language\_of}$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{cpts}~=$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{env}$\ocweol
\ocwindent{2.00em}
|\ensuremath{>}~$\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~$\ocwstring{"cpts"}~\ocwstring{""}\ocweol
\ocwindent{2.00em}
\ocwbc{} \ocwbegindcode{}|\ensuremath{>}~$\ocwupperid{Checkpoints}.\ocwlowerid{parse\_cpts}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{nb\_sols}~=$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{env}$\ocweol
\ocwindent{2.00em}
|\ensuremath{>}~$\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Save\_corpus\_params.}\ocwlowerid{nb\_sols}~$\ocwstring{"0"}\ocweol
\ocwindent{2.00em}
|\ensuremath{>}~$\ocwupperid{Num.}\ocwlowerid{num\_of\_string}$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{Corpus.Analysis.}\ocwlowerid{make}~\ocwupperid{Corpus.Analyzer.Graph}~\ocwlowerid{lang}~\ocwlowerid{cpts}~\ocwlowerid{nb\_sols}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{error\_page}~=~\ocwlowerid{error\_page}~$\ocwstring{"Corpus\ocwvspace{}Manager"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{}*************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Entry point \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}*************\ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{main}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{query}~=~\ocwupperid{Cgi.}\ocwlowerid{query\_string}~()~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{env}~=~\ocwupperid{Cgi.}\ocwlowerid{create\_env}~\ocwlowerid{query}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{query}~=~\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Save\_corpus\_params.}\ocwlowerid{state}~$\ocwstring{""}~$\ocwlowerid{env}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{try}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{force}~=$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{env}$\ocweol
\ocwindent{3.00em}
|\ensuremath{>}~$\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Save\_corpus\_params.}\ocwlowerid{force}~(\ocwlowerid{string\_of\_bool}~\ocwupperid{False})$\ocweol
\ocwindent{3.00em}
|\ensuremath{>}~$\ocwlowerid{bool\_of\_string}$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{env}~=~\ocwupperid{Cgi.}\ocwlowerid{create\_env}~\ocwlowerid{query}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{corpdir}~=~\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Params.}\ocwlowerid{corpus\_dir}~$\ocwstring{""}~$\ocwlowerid{env}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{sentno}~=$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{env}$\ocweol
\ocwindent{3.00em}
|\ensuremath{>}~$\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Params.}\ocwlowerid{sentence\_no}~$\ocwstring{""}\ocweol
\ocwindent{3.00em}
|\ensuremath{>}~$\ocwlowerid{float\_of\_string}$\ocweol
\ocwindent{3.00em}
|\ensuremath{>}~$\ocwlowerid{int\_of\_float}$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{text}~=~\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~$\ocwstring{"text"}~\ocwstring{""}~$\ocwlowerid{env}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{unsandhied}~=~\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~$\ocwstring{"us"}~\ocwstring{"f"}~$\ocwlowerid{env}~=~$\ocwstring{"t"}~\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{permission}~=$\ocweol
\ocwindent{3.00em}
$\ocwupperid{Web\_corpus.}\ocwlowerid{permission\_of\_string}~(\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Params.}\ocwlowerid{corpus\_permission}~$\ocwstring{""}~$\ocwlowerid{env})$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{match}~$\ocwlowerid{permission}~$\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Web\_corpus.Annotator}~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{read\_skt}~=$\ocweol
\ocwindent{4.00em}
\ocwkw{if}~$\ocwlowerid{unsandhied}~$\ocwkw{then}~$\ocwupperid{Sanskrit.}\ocwlowerid{read\_raw\_sanskrit}~$\ocwkw{else}\ocweol
\ocwindent{5.00em}
$\ocwupperid{Sanskrit.}\ocwlowerid{read\_sanskrit}$\ocweol
\ocwindent{3.00em}
\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{encode}~=$\ocweol
\ocwindent{4.00em}
$\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~$\ocwstring{"t"}~$\ocwupperid{Paths.}\ocwlowerid{default\_transliteration}~\ocwlowerid{env}$\ocweol
\ocwindent{4.00em}
|\ensuremath{>}~$\ocwupperid{Corpus.Encoding.}\ocwlowerid{of\_string}$\ocweol
\ocwindent{4.00em}
|\ensuremath{>}~$\ocwupperid{Corpus.Encoding.}\ocwlowerid{encode}$\ocweol
\ocwindent{3.00em}
\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwupperid{Web\_corpus.}\ocwlowerid{save\_sentence}~\ocwlowerid{force}~\ocwlowerid{corpdir}~\ocwlowerid{sentno}$\ocweol
\ocwindent{5.00em}
$(\ocwlowerid{read\_skt}~\ocwlowerid{encode}~\ocwlowerid{text})~\ocwlowerid{unsandhied}~(\ocwlowerid{analysis\_of\_env}~\ocwlowerid{env})$\ocweol
\ocwindent{3.00em}
;~$\ocwupperid{Corpus\_manager.}\ocwlowerid{mk\_page}~\ocwlowerid{corpdir}~\ocwlowerid{permission}$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Web\_corpus.Reader}~\mid{}~\ocwupperid{Web\_corpus.Manager}~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{expected\_permission}~=~\ocwupperid{Web\_corpus}.(\ocwlowerid{string\_of\_permission}~\ocwupperid{Annotator})~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{current\_permission}~=~\ocwupperid{Web\_corpus.}\ocwlowerid{string\_of\_permission}~\ocwlowerid{permission}~$\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{invalid\_corpus\_permission\_page}~\ocwlowerid{expected\_permission}~\ocwlowerid{current\_permission}$\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Web\_corpus.Sentence\_already\_exists}~\rightarrow{}~\ocwlowerid{confirmation\_page}~\ocwlowerid{query}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Sys\_error}~\ocwlowerid{msg}~\rightarrow{}~\ocwlowerid{error\_page}~\ocwupperid{Control.}\ocwlowerid{sys\_err\_mess}~\ocwlowerid{msg}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Failure}~\ocwlowerid{msg}~\rightarrow{}~\ocwlowerid{error\_page}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~\ocwlowerid{msg}$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}~\ocwlowerid{abort}~\ocwlowerid{default\_language}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"Unexpected\ocwvspace{}anomaly"}\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Mkdir_corpus_params.mli}
\ocwinterface{Mkdir\_corpus\_params}
\label{mkdir_corpus_params.mli:0}%
\label{mkdir_corpus_params.mli:619}%
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{dirname}~:~$\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{parent\_dir}~:~$\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{permission}~:~$\ocwbt{string}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Mkdir_corpus_params.ml}
\ocwmodule{Mkdir\_corpus\_params}
\label{mkdir_corpus_params.ml:0}%
\label{mkdir_corpus_params.ml:619}%
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{dirname}~=~$\ocwstring{"dirname"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{parent\_dir}~=~\ocwupperid{Params.}\ocwlowerid{corpus\_dir}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{permission}~=~\ocwupperid{Params.}\ocwlowerid{corpus\_permission}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Mkdir_corpus_cgi.ml}
\ocwmodule{Mkdir\_corpus\_cgi}
\label{mkdir_corpus_cgi.ml:0}%
CGI script \ocwbegindcode{}$\ocwlowerid{mkdir\_corpus}$\ocwenddcode{} for creating a new corpus subdirectory.  
\ocweol
\label{mkdir_corpus_cgi.ml:692}%
\medskip
\ocwbegincode{}\ocwindent{0.00em}
\ocwkw{open}~$\ocwupperid{Web};$\medskip

\label{mkdir_corpus_cgi.ml:703}%
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{main}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{query}~=~\ocwupperid{Cgi.}\ocwlowerid{query\_string}~()~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{env}~=~\ocwupperid{Cgi.}\ocwlowerid{create\_env}~\ocwlowerid{query}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{dirname}~=~\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Mkdir\_corpus\_params.}\ocwlowerid{dirname}~$\ocwstring{""}~$\ocwlowerid{env}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{parent\_dir}~=~\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Mkdir\_corpus\_params.}\ocwlowerid{parent\_dir}~$\ocwstring{""}~$\ocwlowerid{env}~$\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{permission}~=$\ocweol
\ocwindent{2.00em}
$\ocwupperid{Cgi.}\ocwlowerid{decoded\_get}~\ocwupperid{Mkdir\_corpus\_params.}\ocwlowerid{permission}~$\ocwstring{""}~$\ocwlowerid{env}$\ocweol
\ocwindent{2.00em}
|\ensuremath{>}~$\ocwupperid{Web\_corpus.}\ocwlowerid{permission\_of\_string}$\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{error\_page}~=~\ocwlowerid{error\_page}~$\ocwstring{"Corpus\ocwvspace{}Manager"}~\ocwkw{in}\ocweol
\ocwindent{1.00em}
\ocwkw{match}~$\ocwlowerid{permission}~$\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwupperid{Web\_corpus.Manager}~\rightarrow{}$\ocweol
\ocwindent{2.00em}
\ocwkw{try}\ocweol
\ocwindent{3.00em}
\ocwkw{do}\ocweol
\ocwindent{3.00em}
\{~$\ocwupperid{Web\_corpus.}\ocwlowerid{mkdir}~(\ocwupperid{Filename.}\ocwlowerid{concat}~\ocwlowerid{parent\_dir}~\ocwlowerid{dirname})$\ocweol
\ocwindent{3.00em}
;~$\ocwupperid{Corpus\_manager.}\ocwlowerid{mk\_page}~\ocwlowerid{parent\_dir}~\ocwlowerid{permission}$\ocweol
\ocwindent{3.00em}
\}\ocweol
\ocwindent{2.00em}
\ocwkw{with}\ocweol
\ocwindent{2.00em}
$[~\ocwupperid{Web\_corpus.Section\_already\_exists}~\ocwlowerid{abbrev}~\rightarrow{}$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{error\_page}~$\ocwstring{"Already\ocwvspace{}existing\ocwvspace{}section\ocwvspace{}"}~$\ocwlowerid{abbrev}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwupperid{Unix.Unix\_error}~(\ocwlowerid{err},~\ocwlowerid{func},~\ocwlowerid{arg})~\rightarrow{}$\ocweol
\ocwindent{3.00em}
\ocwkw{let}~$\ocwlowerid{submsg}~=$\ocweol
\ocwindent{4.00em}
$\ocwupperid{Printf.}\ocwlowerid{sprintf}~$\ocwstring{"'\%s'\ocwvspace{}failed\ocwvspace{}on\ocwvspace{}'\%s':\ocwvspace{}\%s"}\ocweol
\ocwindent{5.00em}
$\ocwlowerid{func}~\ocwlowerid{arg}~(\ocwupperid{Unix.}\ocwlowerid{error\_message}~\ocwlowerid{err})$\ocweol
\ocwindent{3.00em}
\ocwkw{in}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{error\_page}~\ocwupperid{Control.}\ocwlowerid{sys\_err\_mess}~\ocwlowerid{submsg}$\ocweol
\ocwindent{2.00em}
$\mid{}~\ocwlowerid{\_}~\rightarrow{}$\ocweol
\ocwindent{3.00em}
$\ocwlowerid{abort}~\ocwupperid{Html.}\ocwlowerid{default\_language}~\ocwupperid{Control.}\ocwlowerid{fatal\_err\_mess}~$\ocwstring{"Unexpected\ocwvspace{}anomaly"}\ocweol
\ocwindent{2.00em}
$]$\ocweol
\ocwindent{1.00em}
$\mid{}~\ocwupperid{Web\_corpus.Reader}~\mid{}~\ocwupperid{Web\_corpus.Annotator}~\rightarrow{}$\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{expected\_permission}~=~\ocwupperid{Web\_corpus}.(\ocwlowerid{string\_of\_permission}~\ocwupperid{Manager})~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{current\_permission}~=~\ocwupperid{Web\_corpus.}\ocwlowerid{string\_of\_permission}~\ocwlowerid{permission}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{invalid\_corpus\_permission\_page}~\ocwlowerid{expected\_permission}~\ocwlowerid{current\_permission}$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}\typeout{OcamlWeb file Mk_corpus.ml}
\ocwmodule{Mk\_corpus}
\label{mk_corpus.ml:0}%
\label{mk_corpus.ml:619}%
\ocwbegincode{}\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{abort}~\ocwlowerid{report\_error}~\ocwlowerid{status}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{do}\ocweol
\ocwindent{1.00em}
\{~$\ocwlowerid{report\_error}~()$\ocweol
\ocwindent{1.00em}
;~$\ocwlowerid{exit}~\ocwlowerid{status}$\ocweol
\ocwindent{1.00em}
\}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{citation\_regexp}~=~\ocwupperid{Str.}\ocwlowerid{regexp}~$\ocwstring{"\symbol{92}\symbol{92}\symbol{92}\symbol{92}citation\{\symbol{92}\symbol{92}(.*\symbol{92}\symbol{92})\}"}\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{extract\_citation}~\ocwlowerid{state}~\ocwlowerid{save\_sentence}~\ocwlowerid{line}~\ocwlowerid{line\_no}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{try}\ocweol
\ocwindent{2.00em}
\ocwkw{if}~$\ocwupperid{Str.}\ocwlowerid{string\_match}~\ocwlowerid{citation\_regexp}~\ocwlowerid{line}~0~$\ocwkw{then}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{save\_sentence}~[~($\ocwstring{"text"},~$\ocwupperid{Str.}\ocwlowerid{matched\_group}~1~\ocwlowerid{line})~::~\ocwlowerid{state}~]$\ocweol
\ocwindent{2.00em}
\ocwkw{else}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{raise}~\ocwupperid{Exit}$\ocweol
\ocwindent{1.00em}
\ocwkw{with}\ocweol
\ocwindent{1.00em}
$[~\ocwlowerid{\_}~\rightarrow{}$\ocweol
\ocwindent{2.00em}
$\ocwlowerid{abort}~($\ocwkw{fun}~$()~\rightarrow{}$\ocweol
\ocwindent{4.00em}
$\ocwupperid{Printf.}\ocwlowerid{eprintf}$\ocweol
\ocwindent{5.00em}
\ocwstring{"Line\ocwvspace{}\%d:\ocwvspace{}\symbol{92}\endgraf
\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}Wrong\ocwvspace{}input\ocwvspace{}format\ocwvspace{}(expect\ocwvspace{}one\ocwvspace{}citation\ocwvspace{}macro\ocwvspace{}per\ocwvspace{}line)\symbol{92}n"}~$\ocwlowerid{line\_no}$\ocweol
\ocwindent{3.00em}
$)~1$\ocweol
\ocwindent{1.00em}
$]$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{populate\_corpus}~\ocwlowerid{dirname}~\ocwlowerid{file}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{if}~$\ocwlowerid{dirname.}\ocwlowerid{val}~\not=~$\ocwstring{""}~\ocwkw{then}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{ch}~=~\ocwlowerid{open\_in}~\ocwlowerid{file}~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$(\ocwlowerid{corpus\_location},~\ocwlowerid{dirname})~=$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwupperid{Filename.}\ocwlowerid{is\_relative}~\ocwlowerid{dirname.}\ocwlowerid{val}~$\ocwkw{then}\ocweol
\ocwindent{4.00em}
$($\ocwstring{""},~$\ocwlowerid{dirname.}\ocwlowerid{val})$\ocweol
\ocwindent{3.00em}
\ocwkw{else}\ocweol
\ocwindent{4.00em}
$(\ocwupperid{Filename.}\ocwlowerid{dirname}~\ocwlowerid{dirname.}\ocwlowerid{val},~\ocwupperid{Filename.}\ocwlowerid{basename}~\ocwlowerid{dirname.}\ocwlowerid{val})$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~\ocwkw{module}~$\ocwupperid{Corp}~=~\ocwupperid{Corpus.Make}~($\ocwkw{struct}~$\ocwlowerid{value}~\ocwlowerid{path}~=~\ocwlowerid{corpus\_location};~$\ocwkw{end}$)~$\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~$\ocwlowerid{dirname}~=$\ocweol
\ocwindent{3.00em}
\ocwkw{if}~$\ocwupperid{Filename.}\ocwlowerid{check\_suffix}~\ocwlowerid{dirname}~\ocwupperid{Filename.}\ocwlowerid{dir\_sep}~$\ocwkw{then}\ocweol
\ocwindent{4.00em}
$\ocwupperid{Filename.}\ocwlowerid{chop\_suffix}~\ocwlowerid{dirname}~\ocwupperid{Filename.}\ocwlowerid{dir\_sep}$\ocweol
\ocwindent{3.00em}
\ocwkw{else}\ocweol
\ocwindent{4.00em}
$\ocwlowerid{dirname}$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{let}~\ocwkw{rec}~$\ocwlowerid{aux}~\ocwlowerid{i}~=$\ocweol
\ocwindent{3.00em}
\ocwkw{try}\ocweol
\ocwindent{4.00em}
\ocwbc{} \ocwbegindcode{}\ocwkw{let}~$\ocwlowerid{line}~=~\ocwlowerid{input\_line}~\ocwlowerid{ch}~$\ocwkw{in}~
~\ocwkw{let}~$\ocwlowerid{state}~=~
~[~(\ocwupperid{Params}.\ocwlowerid{corpus\_dir},~\ocwlowerid{dirname})~
~;~(\ocwupperid{Params}.\ocwlowerid{sentence\_no},~\ocwlowerid{string\_of\_int}~\ocwlowerid{i})~
~;~($\ocwstring{"t"},~$\ocwupperid{Paths}.\ocwlowerid{default\_transliteration})
~]~$\ocwkw{in}\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{3.00em}
$\ocwlowerid{failwith}~$\ocwstring{"TODO"}\ocweol
\ocwindent{4.00em}
\ocwbc{} \ocwbegindcode{}\ocwkw{do}~
~\{~$\ocwlowerid{extract\_citation}~\ocwlowerid{state}~(\ocwupperid{Corp}.\ocwlowerid{save\_sentence}~\ocwupperid{True}~\ocwupperid{Web}.\ocwlowerid{graph\_cgi})~\ocwlowerid{line}~\ocwlowerid{i}~
~;~\ocwlowerid{aux}~(\ocwlowerid{i}~+~1)
~\}$\ocwenddcode{} \ocwec{}\ocweol
\ocwindent{3.00em}
\ocwkw{with}\ocweol
\ocwindent{3.00em}
$[~\ocwupperid{End\_of\_file}~\rightarrow{}~()~]$\ocweol
\ocwindent{2.00em}
\ocwkw{in}\ocweol
\ocwindent{2.00em}
\ocwkw{do}\ocweol
\ocwindent{2.00em}
\{~$\ocwupperid{Corp.}\ocwlowerid{mkdir}~\ocwlowerid{dirname}$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{aux}~1$\ocweol
\ocwindent{2.00em}
;~$\ocwlowerid{close\_in}~\ocwlowerid{ch}$\ocweol
\ocwindent{2.00em}
\}\ocweol
\ocwindent{1.00em}
\ocwkw{else}\ocweol
\ocwindent{2.00em}
$\ocwlowerid{abort}~($\ocwkw{fun}~$()~\rightarrow{}$\ocweol
\ocwindent{4.00em}
$\ocwupperid{Printf.}\ocwlowerid{eprintf}$\ocweol
\ocwindent{5.00em}
\ocwstring{"Please\ocwvspace{}specify\ocwvspace{}the\ocwvspace{}destination\ocwvspace{}directory.\ocwvspace{}\ocwvspace{}\symbol{92}\endgraf
\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}\ocwvspace{}See\ocwvspace{}\%s\ocwvspace{}\symbol{45}\symbol{45}help.\symbol{92}n"}~$(\ocwupperid{Filename.}\ocwlowerid{basename}~\ocwupperid{Sys.}\ocwlowerid{argv}.(0))$\ocweol
\ocwindent{3.00em}
$)~1$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocwindent{0.00em}
\ocwbc{}*************\ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{} Entry point \ocwec{}\ocweol
\ocwindent{0.00em}
\ocwbc{}*************\ocwec{}\ocweol
\ocwindent{0.00em}
$\ocwlowerid{value}~\ocwlowerid{main}~=$\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{dirname}~=~$\ocwbt{ref}~\ocwstring{""}~\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{opts}~=~$\ocweol
\ocwindent{2.00em}
$\ocwupperid{Arg.}\ocwlowerid{align}~$\ocweol
\ocwindent{3.00em}
$[~($\ocwstring{"\symbol{45}d"},~$\ocwupperid{Arg.Set\_string}~\ocwlowerid{dirname},~$\ocweol
\ocwindent{4.50em}
\ocwstring{"\ocwvspace{}Specify\ocwvspace{}the\ocwvspace{}destination\ocwvspace{}directory"}$)~]~$\ocweol
\ocwindent{1.00em}
\ocwkw{in}~\ocweol
\ocwindent{1.00em}
\ocwkw{let}~$\ocwlowerid{usage\_msg}~=$\ocweol
\ocwindent{2.00em}
$\ocwupperid{Filename.}\ocwlowerid{basename}~\ocwupperid{Sys.}\ocwlowerid{argv}.(0)~$\^{}~\ocwstring{"\ocwvspace{}\symbol{45}d\ocwvspace{}\ensuremath{<}dest\_dir\ensuremath{>}\ocwvspace{}\ensuremath{<}citation\_file\ensuremath{>}"}\ocweol
\ocwindent{1.00em}
\ocwkw{in}\ocweol
\ocwindent{1.00em}
$\ocwupperid{Arg.}\ocwlowerid{parse}~\ocwlowerid{opts}~(\ocwlowerid{populate\_corpus}~\ocwlowerid{dirname})~\ocwlowerid{usage\_msg}$\ocweol
\ocwindent{0.00em}
;\ocweol
\ocweol
\ocwendcode{}

\ocwbeginindex{}
\ocwrefindexentry{$\ocwupperid{Auto}$ (module)}{auto.mli:0}{}{\ref{auto.mli:0}}{}
\ocwrefindexentry{$\ocwupperid{Automaton}$ (module)}{automaton.ml:0}{}{\ref{automaton.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Bank\_lexer}$ (module)}{bank_lexer.ml:0}{}{\ref{bank_lexer.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Canon}$ (module)}{canon.ml:0}{}{\ref{canon.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Cgi}$ (module)}{cgi.ml:0}{}{\ref{cgi.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Chapters}$ (module)}{chapters.ml:0}{}{\ref{chapters.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Checkpoints}$ (module)}{checkpoints.ml:0}{}{\ref{checkpoints.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Conjugation}$ (module)}{conjugation.ml:0}{}{\ref{conjugation.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Conj\_infos}$ (module)}{conj_infos.mli:0}{}{\ref{conj_infos.mli:0}}{}
\ocwrefindexentry{$\ocwupperid{Constraints}$ (module)}{constraints.mli:0,constraints.ml:0}{}{\ref{constraints.mli:0}, \ref{constraints.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Control}$ (module)}{control.ml:0}{}{\ref{control.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Corpus}$ (module)}{corpus.mli:0,corpus.ml:0}{}{\ref{corpus.mli:0}, \ref{corpus.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Corpus\_manager}$ (module)}{corpus_manager.mli:0,corpus_manager.ml:0}{}{\ref{corpus_manager.mli:0}, \ref{corpus_manager.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Corpus\_manager\_cgi}$ (module)}{corpus_manager_cgi.ml:0}{}{\ref{corpus_manager_cgi.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Css}$ (module)}{css.ml:0}{}{\ref{css.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Date}$ (module)}{date.ml:0}{}{\ref{date.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Declension}$ (module)}{declension.ml:0}{}{\ref{declension.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Dir}$ (module)}{dir.mli:0,dir.ml:0}{}{\ref{dir.mli:0}, \ref{dir.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Dispatcher}$ (module)}{dispatcher.mli:0,dispatcher.ml:0}{}{\ref{dispatcher.mli:0}, \ref{dispatcher.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Encode}$ (module)}{encode.ml:0}{}{\ref{encode.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Graph\_segmenter}$ (module)}{graph_segmenter.ml:0}{}{\ref{graph_segmenter.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Html}$ (module)}{html.ml:0}{}{\ref{html.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Index}$ (module)}{index.ml:0}{}{\ref{index.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Indexer}$ (module)}{indexer.ml:0}{}{\ref{indexer.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Indexerd}$ (module)}{indexerd.ml:0}{}{\ref{indexerd.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Inflected}$ (module)}{inflected.mli:0,inflected.ml:0}{}{\ref{inflected.mli:0}, \ref{inflected.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Interface}$ (module)}{interface.mli:0,interface.ml:0}{}{\ref{interface.mli:0}, \ref{interface.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Int\_sandhi}$ (module)}{int_sandhi.ml:0}{}{\ref{int_sandhi.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Lemmatizer}$ (module)}{lemmatizer.ml:0}{}{\ref{lemmatizer.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Lexer}$ (module)}{lexer.mli:0,lexer.ml:0}{}{\ref{lexer.mli:0}, \ref{lexer.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Load\_morphs}$ (module)}{load_morphs.ml:0}{}{\ref{load_morphs.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Load\_transducers}$ (module)}{load_transducers.ml:0}{}{\ref{load_transducers.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Mkdir\_corpus\_cgi}$ (module)}{mkdir_corpus_cgi.ml:0}{}{\ref{mkdir_corpus_cgi.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Mkdir\_corpus\_params}$ (module)}{mkdir_corpus_params.mli:0,mkdir_corpus_params.ml:0}{}{\ref{mkdir_corpus_params.mli:0}, \ref{mkdir_corpus_params.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Mk\_corpus}$ (module)}{mk_corpus.ml:0}{}{\ref{mk_corpus.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Mk\_corpus\_page}$ (module)}{mk_corpus_page.ml:0}{}{\ref{mk_corpus_page.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Mk\_grammar\_page}$ (module)}{mk_grammar_page.ml:0}{}{\ref{mk_grammar_page.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Mk\_index\_page}$ (module)}{mk_index_page.ml:0}{}{\ref{mk_index_page.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Mk\_reader\_page}$ (module)}{mk_reader_page.ml:0}{}{\ref{mk_reader_page.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Mk\_sandhi\_page}$ (module)}{mk_sandhi_page.ml:0}{}{\ref{mk_sandhi_page.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Morpho}$ (module)}{morpho.ml:0}{}{\ref{morpho.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Morphology}$ (module)}{morphology.mli:0}{}{\ref{morphology.mli:0}}{}
\ocwrefindexentry{$\ocwupperid{Morpho\_html}$ (module)}{morpho_html.ml:0}{}{\ref{morpho_html.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Morpho\_scl}$ (module)}{morpho_scl.ml:0}{}{\ref{morpho_scl.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Morpho\_string}$ (module)}{morpho_string.ml:0}{}{\ref{morpho_string.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Multilingual}$ (module)}{multilingual.ml:0}{}{\ref{multilingual.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Naming}$ (module)}{naming.ml:0}{}{\ref{naming.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Nouns}$ (module)}{nouns.mli:0,nouns.ml:0}{}{\ref{nouns.mli:0}, \ref{nouns.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Order}$ (module)}{order.ml:0}{}{\ref{order.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Pada}$ (module)}{pada.ml:0}{}{\ref{pada.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Padapatha}$ (module)}{padapatha.ml:0}{}{\ref{padapatha.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Params}$ (module)}{params.mli:0,params.ml:0}{mkdir_corpus_params.ml:619}{\ref{params.mli:0}, \ref{params.ml:0}}{\ref{mkdir_corpus_params.ml:619}}
\ocwrefindexentry{$\ocwupperid{Paraphrase}$ (module)}{paraphrase.mli:0,paraphrase.ml:0}{}{\ref{paraphrase.mli:0}, \ref{paraphrase.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Parser}$ (module)}{parser.ml:0}{}{\ref{parser.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Parts}$ (module)}{parts.ml:0}{}{\ref{parts.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Paths}$ (module)}{paths.ml:0}{}{\ref{paths.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Phases}$ (module)}{phases.ml:0}{}{\ref{phases.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Phonetics}$ (module)}{phonetics.ml:0}{}{\ref{phonetics.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Rank}$ (module)}{rank.ml:0}{}{\ref{rank.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Reader}$ (module)}{reader.ml:0}{}{\ref{reader.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Regression}$ (module)}{regression.ml:0}{}{\ref{regression.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Reset\_caches}$ (module)}{reset_caches.ml:0}{}{\ref{reset_caches.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Sandhi}$ (module)}{sandhi.ml:0}{}{\ref{sandhi.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Sandhier}$ (module)}{sandhier.ml:0}{}{\ref{sandhier.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Sanskrit}$ (module)}{sanskrit.mli:0,sanskrit.ml:0}{}{\ref{sanskrit.mli:0}, \ref{sanskrit.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Save\_corpus\_cgi}$ (module)}{save_corpus_cgi.ml:0}{}{\ref{save_corpus_cgi.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Save\_corpus\_params}$ (module)}{save_corpus_params.mli:0,save_corpus_params.ml:0}{}{\ref{save_corpus_params.mli:0}, \ref{save_corpus_params.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Scl\_parser}$ (module)}{scl_parser.ml:0}{}{\ref{scl_parser.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Segmenter}$ (module)}{segmenter.ml:0}{}{\ref{segmenter.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Skt\_lexer}$ (module)}{skt_lexer.ml:0}{}{\ref{skt_lexer.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Skt\_morph}$ (module)}{skt_morph.mli:0}{}{\ref{skt_morph.mli:0}}{}
\ocwrefindexentry{$\ocwupperid{Test\_stamp}$ (module)}{test_stamp.ml:0}{}{\ref{test_stamp.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Transduction}$ (module)}{transduction.ml:0}{}{\ref{transduction.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{User\_aid}$ (module)}{user_aid.ml:0}{}{\ref{user_aid.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Verbs}$ (module)}{verbs.mli:0,verbs.ml:0}{}{\ref{verbs.mli:0}, \ref{verbs.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Version}$ (module)}{version.ml:0}{}{\ref{version.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Web}$ (module)}{web.ml:0}{}{\ref{web.ml:0}}{}
\ocwrefindexentry{$\ocwupperid{Web\_corpus}$ (module)}{web_corpus.mli:0,web_corpus.ml:0}{}{\ref{web_corpus.mli:0}, \ref{web_corpus.ml:0}}{}


\ocwendindex{}
\end{document}
