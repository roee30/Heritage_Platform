*********************************************************
* Installation of the Sanskrit Heritage Engine/Platform *
*********************************************************

0. Generalities

This library is developed on Unix/Linux, whereas the end products (Sanskrit 
dictionary and Web site) are multi-platform.
UNIX tools such as make, tar, sed and gcc are assumed to exist.
We also assume that python has been installed.

Installation assumes prior installation of Objective Caml available
from site http://ocaml.org. The latest distribution version
4.02 ought to be used, available in http://ocaml.org/releases/4.02.html

The proper sequence of commands is:
./configure
make world.opt
sudo make install

Then install Camlp4 from GitHub, in the 4.02 branch, available from
https://github.com/ocaml/camlp4/releases; take for instance 4.02+6. 
This should be installed by:
./configure
make all
sudo make install

The following instructions assume installation under some version of the 
Unix operating system, such as FreeBSD, Linux or MacOSX. 
They may also apply under to versions of Windows under the Cigwin emulator, 
but this has not been tested. 

This software is distributed in two possible packages:
A. Sanskrit Engine: permits execution of the Web services with fixed linguistic 
resources distributed under the form of compiled databanks. 
The gzipped tar file (46Mb) of current distribution version 2.96 may be 
downloaded from URL:
http://sanskrit.inria.fr/DISTRIB/SktEngine.2.96.tar.gz

B. Sanskrit Platform: this full distribution contains all sources, including
the Sanskrit Heritage Dictionary and all relevant software. 
This distribution is currently reserved to the team of developers. 

Untarring the distribution tar file creates 
a directory such as SktEngine.2.96, containing version 2.96 of the Sanskrit 
Engine. You may rename this directory at will. We assume in the following 
that its absolute path is called Main. Similarly for a full distribution
such as SktPlatform.2.96.

1. Installation of the SKT Engine

This means installing a mirror Web site with SKT Engine functionalities.

1.1 Customization

First the user should define a configuration file config.txt in the
directory SETUP. He should imitate the format of examples such as
config.amrita.txt (local host) and config.sanskrit.txt (public server). 

We assume that the installer is logged on the HTTP server, or at least
on a machine of the same architecture and system, and that he has proper
access rights. Let "Main" be the installation directory 
(normally the parent of the SETUP directory where resides
this README file). Let "host" be your hostname or any label of your choosing.
Go to subdirectory SETUP, and edit file config.txt
for customization, as follows. 

PLATFORM is a customization parameter of the HTTP server platform
and of the HTML client browser target. Currently it can take values:
* 'Computer' or 'Server' for Internet server
* 'Station' for client user on localhost

TRANSLIT should indicate the default input transliteration scheme. Currently are 
supported:
'VH' Velthuis' scheme with Huet's additions
'KH' Kyoto-Harvard
'SL' Sanskrit Library (SLP1)
'WX' from Univ. of Hyderabad
But you may also input Unicode strings (encoded in format UTF-8) if you choose:
'DN' Devanagari
'RN' Indic romanization with diacritics according to the IAST standard. 

LEXICON indicates the reference default lexicon: 
'SH' for the Sanskrit Heritage dictionary in French 
'MW' for the Monier-Williams Sanskrit-English dictionary.

DISPLAY is the default font for Sanskrit text output: 
'roma' for romanisation, 
or 'deva' for devanagarii.

SERVERHOST should be the domain name (or IP address) of the target HTTP server.
REMOTESERVERHOST should be the domain name (or IP address) of the target HTTP 
server as seen from Internet (whereas SERVERHOST may be 127.0.0.1 for localhost).
EXTERNALSERVERHOST should be the domain name (or IP address) of an external 
Web service invoked for experiments (ignore)
EXTERNALINVOCATION is the cgi invocation of the external Web service (ignore)
SERVERPUBLICDIR should be the absolute path on the server file system of the data
to be used by its cgi-bin executables - it should be allowed as readable from 
all. The fields of the configuration file relevant to the Apache server
should be consistent with its own configuration. In case of doubt, look
for Apache's configuration file, called httpd.conf. The directory where
HTML documents are found is named DocumentRoot. A good practice is
to declare SERVERPUBLICDIR as a subdirectory of DocumentRoot (created in
super-user mode). Thus, if DocumentRoot is /var/www/html, as in many Linux
installations, declare SERVERPUBLICDIR as /var/www/html/SktEngine. 

SKTDIRURL should be its local url on the server - typically a relative address 
in the httpd area such as /SktEngine/
or possibly a readable sub-directory of user's xxx public_html directory  
such as /~xxx/skt/.
CGIDIR should be the absolute path on the server file system of its CGI 
executables, typically on Linux /var/www/cgi-bin/ (or some other directory 
indicated as possibly containing cgis in Apache's configuration file).
CGIEXT is the extension of cgi executables, if needed.

Parameter MOUSEACTION controls the morphology printing of the
interface segments. It may be 'CLICK' or 'OVER'.

Parameters SCLURL, SCLINSTALLDIR, OUTPUTFONT and TEMPAREA should be ignored, 
they concern experimental integration of University 
of Hyderabad software.
OUTPUTFONT is the default font used in the printing of dependency graphs by this 
software: 'ROMAN' for romanized font, 'DEV' for devanagarii.

COUNTER is the localisation message on the site entry page.
ZEN should be left at the standard url for Zen downloading.
RESOURCES is the local path to the distribution directory for morphological resources.
PORTAL should be left to portal.html.

When the config file is ready, store it in directory SETUP/CONFIGS as config.xxx.txt 
with xxx the name of your site, and in directory SETUP execute the command
ln -s CONFIGS/config.xxx.txt config
Then execute in directory Main the command
./configure 

The localization is complete. More complex localizations may be obtained by changes of
the MMakefile in directory SETUP, which is the Makefile source template. 
For instance, if you want to change the standard names of the cgis generated as 
Sanskrit engine tools, you have to read the following.

The various cgi-bin executables will be installed (by make releasecgi)
in CGIDIR under names declared as respectively
CGIINDEX, CGIINDEXD, CGIDECL, CGICONJ, CGILEMMA, CGIREADER, CGIPARSER, CGITAGGER and CGISANDHI.

The various linguistic resources are installed by command 
make releasedata. 

The complete installation is achieved by command
make full_release.

If Apache is not currently running on your station, you should initialise
it with "sudo httpd -k start", and consider putting this command
in the scheduling initialisation file of your operating system (crontable).

Subsequent releases to the same server, as well as updates when any change 
is done to the
master make file SETUP/MMakefile, should only use the command ./configure. 

1.2 Installation of the Zen toolkit

The ZEN toolkit is an independent Ocaml library, distributed under the
LGPL open source license, from site http://yquem.inria.fr/~huet/ZEN.
It should be installed at path Main/ZEN. 
For convenience, a copy of its current distribution is included with this
distribution, and may be activated by running
        make ZEN
This will compile and install the Zen library.

1.3 Installation proper of Heritage Engine
        make 
This compiles the various cgi-bin executables.

At this point, make sure that the directory $(SERVERPUBLICDIR) exists on the
server, with subdirectories ZEN, ML, DATA, DATA/XML, and IMAGES. You may need
proper privilege to write in these directories.

For the first installation on a given server, you must execute first:
        sudo make cold

For subsequent updates, you only need to execute:
        sudo make install
This installs the executables and their data on the server. 

This concludes the installation of the SKT Engine.
Try the web site by browsing http://$(SERVERHOST)/$(SKTDIRURL)index.html

N.B. You may run into security problems preventing you from running the CGI services.
This may be due to security concerns, with an overly cautious configuration
of Apache. This may be corrected by editing Apache's configuration,
a complex and risky operation. Another route is to install the software
with XAMPP, an open-source lightweight Apache distribution that makes 
it easier for developers to install a local web server. 

2. Installation of the full Sanskrit Heritage Platform.

This requires a distribution tarball of the full Sanskrit Heritage Platform, including
sources of the Sanskrit Heritage Dictionary. The distribution directory
is similar to above, except that there are more modules in directory ML,
and there is a source file Heritage.e containing the lexicographic database.

After proper customization:

        ./configure 
        make all

This should produce the dictionary under the various formats. 
If "Double definitions" gets printed, it is normal, this is just a warning.
However, if "Undefined references" gets printed, it means an inconsistency
in the data base Dico, resulting in missing links in the web site.
The file "STAT/undefs.txt" should be inspected to find the inconsistencies.

If this step has been successful, you may now install the Sanskrit Platform
Web site as above:
        sudo make install
______________

If you successfully install this package, please notify
Gerard.Huet@inria.fr
to whom all queries and anomalies should be reported.


